;; -*- coding: utf-8 -*-
(("Security Announcements - Discuss the Elastic Stack" "Topics in the 'Security Announcements' category Security announcements for the Elastic stack." "https://discuss.elastic.co/c/announcements/security-announcements/31" (26402 61847 478415 767000) feed 0 nil nil ((title nil "Security Announcements - Discuss the Elastic Stack") (link nil "https://discuss.elastic.co/c/announcements/security-announcements/31") (description nil "Topics in the 'Security Announcements' category Security announcements for the Elastic stack.") (lastBuildDate nil "Thu, 05 Sep 2024 19:19:30 +0000") (link ((href . "https://discuss.elastic.co/c/announcements/security-announcements/31.rss") (rel . "self") (type . "application/rss+xml"))) (item nil (title nil "Kibana 8.15.1 Security Update (ESA-2024-27, ESA-2024-28)") (creator nil "ismisepaul") (category nil "Security Announcements") (description nil "
            <p><strong>Kibana arbitrary code execution via YAML deserialization in Amazon Bedrock Connector (ESA-2024-27)</strong></p>
<p>A deserialization issue in Kibana can lead to arbitrary code execution when Kibana attempts to parse a YAML document containing a crafted payload.</p>
<p>This issue only affects users that use <a href=\"https://www.elastic.co/guide/en/security/current/ai-for-security.html\">Elastic Security’s built-in AI tools</a> and have configured an <a href=\"https://www.elastic.co/guide/en/security/current/assistant-connect-to-bedrock.html\">Amazon Bedrock connector</a>.</p>
<p><strong>Affected Versions:</strong><br>
Kibana version 8.15.0.</p>
<p><strong>Solutions and Mitigations:</strong><br>
Users should upgrade to version 8.15.1.</p>
<p><strong>For Users that Cannot Upgrade:</strong><br>
Customers who cannot upgrade to 8.15.1 and must stay on 8.15.0 can disable the integration assistant by setting <code>xpack.integration_assistant.enabled: false</code> in their <code>kibana.yml</code> configuration file.</p>
<p><strong>Severity:</strong> CVSSv3.1: 9.9 (Critical) - CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H</p>
<p><strong>CVE ID:</strong> CVE-2024-37288</p>
<hr>
<p><strong>Kibana arbitrary code execution via YAML deserialization (ESA-2024-28)</strong></p>
<p>A deserialization issue in Kibana can lead to arbitrary code execution when Kibana attempts to parse a YAML document containing a crafted payload.</p>
<p>A successful attack requires a malicious user to have a combination of both specific <a href=\"https://www.elastic.co/guide/en/elasticsearch/reference/current/defining-roles.html#roles-indices-priv\">Elasticsearch indices privileges</a> and <a href=\"https://www.elastic.co/guide/en/fleet/current/fleet-roles-and-privileges.html\">Kibana privileges</a> assigned to them.</p>
<p>The following Elasticsearch indices permissions are required</p>
<ul>
<li><code>write</code> privilege on the system indices <code>.kibana_ingest*</code></li>
<li>The <code>allow_restricted_indices</code> flag is set to <code>true</code></li>
</ul>
<p>Any of the following Kibana privileges are additionally required</p>
<ul>
<li>Under <code>Fleet</code> the <code>All</code> privilege is granted</li>
<li>Under <code>Integration</code> the <code>Read</code> or <code>All</code> privilege is granted</li>
<li>Access to the <code>fleet-setup</code> privilege is gained through the Fleet Server’s service account token</li>
</ul>
<p><strong>Affected Versions:</strong><br>
Kibana versions 8.10.0 to 8.15.0.</p>
<p><strong>Solutions and Mitigations:</strong><br>
Users should upgrade to version 8.15.1.</p>
<p><strong>CVSS v3.1:</strong> 9.1 (Critical) - CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:C/C:H/I:H/A:H</p>
<p><strong>CVE ID:</strong> CVE-2024-37285</p>
            <p><small>1 post - 1 participant</small></p>
            <p><a href=\"https://discuss.elastic.co/t/kibana-8-15-1-security-update-esa-2024-27-esa-2024-28/366119\">Read full topic</a></p>
          ") (link nil "https://discuss.elastic.co/t/kibana-8-15-1-security-update-esa-2024-27-esa-2024-28/366119") (pubDate nil "Thu, 05 Sep 2024 19:19:30 +0000") (topicPinned nil "No") (topicClosed nil "No") (topicArchived nil "No") (guid ((isPermaLink . "false")) "discuss.elastic.co-topic-366119") (source ((url . "https://discuss.elastic.co/t/kibana-8-15-1-security-update-esa-2024-27-esa-2024-28/366119.rss")) "Kibana 8.15.1 Security Update (ESA-2024-27, ESA-2024-28)")) (item nil (title nil "APM Server 8.14.0 Security Update (ESA-2024-09)") (creator nil "ismisepaul") (category nil "Security Announcements") (description nil "
            <p><strong>APM Server - Uncontrolled Resource Consumption through HTTP/2 endpoints - CVE-2023-45288 (ESA-2024-09)</strong></p>
<p>On April 4, 2024, the Go Project announced CVE-2023-45288, which can lead to CPU exhaustion as an attacker can cause an HTTP/2 endpoint to read arbitrary amounts of header data.</p>
<p>In an on-prem deployment APM Server has been found vulnerable if exposed directly to HTTP traffic.</p>
<p>This vulnerability cannot be exploited on Elastic Cloud because the service is behind the Elastic Cloud proxy.</p>
<p><strong>Affected Versions:</strong></p>
<ul>
<li>APM Server versions up to, but not including, 8.14.0</li>
<li>APM Server versions up to, but not including, 7.17.21</li>
</ul>
<p><strong>Solutions and Mitigations:</strong><br>
Users should upgrade to version 8.14.0</p>
<p><strong>Severity: CVSSv3.1</strong> 5.3 (Medium) <a href=\"https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L\">CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L</a></p>
<p><strong>CVE ID:</strong> CVE-2023-45288</p>
            <p><small>1 post - 1 participant</small></p>
            <p><a href=\"https://discuss.elastic.co/t/apm-server-8-14-0-security-update-esa-2024-09/364946\">Read full topic</a></p>
          ") (link nil "https://discuss.elastic.co/t/apm-server-8-14-0-security-update-esa-2024-09/364946") (pubDate nil "Thu, 15 Aug 2024 09:54:42 +0000") (topicPinned nil "No") (topicClosed nil "No") (topicArchived nil "No") (guid ((isPermaLink . "false")) "discuss.elastic.co-topic-364946") (source ((url . "https://discuss.elastic.co/t/apm-server-8-14-0-security-update-esa-2024-09/364946.rss")) "APM Server 8.14.0 Security Update (ESA-2024-09)")) (item nil (title nil "Elastic Agent 8.15.0 Security Update (ESA-2024-23)") (creator nil "ismisepaul") (category nil "Security Announcements") (description nil "
            <p><strong>Elastic Agent Insertion of Sensitive Information into Log File  (ESA-2024-23)</strong></p>
<p>An issue was discovered whereby Elastic Agent will leak secrets from the agent policy <code>elastic-agent.yml</code> only when the log level is configured to <code>debug</code>. By default the log level is set to <code>info</code>, where no leak occurs.</p>
<p><strong>Affected Versions:</strong><br>
Elastic Agent &gt;= 8.6.0 and &lt; 8.15.0</p>
<p><strong>Solutions and Mitigations:</strong><br>
The issue is resolved in version 8.15.0.</p>
<p><strong>Elastic Cloud</strong><br>
The following mitigations have been performed by Elastic:</p>
<ul>
<li>An investigation has revealed that no Elastic Cloud customers are affected.</li>
<li>As a preventative measure we have deployed an ingest processor to redact the component field before it is logged in our monitoring environment.</li>
</ul>
<p><strong>Self-Managed</strong><br>
Users who are running Elastic Agent &gt;= 8.6.0 and &lt; 8.15.0 should upgrade to Elastic Agent 8.15.0.</p>
<p>Users should review the logging level applied to their Elastic Agents to determine if they might be affected. If it has been determined that the logging level has been set to <code>debug</code> then the affected logs should be reviewed for any potential sensitive data by filtering for <code>log.level: debug AND components: *</code> within Elasticsearch, and if deemed necessary, follow up actions should include;</p>
<ul>
<li>Purging sensitive data from logs</li>
<li>Rotating any potentially exposed credentials</li>
</ul>
<p><strong>For Users that Cannot Upgrade</strong></p>
<p>Users running Elastic Agent &gt;= 8.6.0 and &lt; 8.15.0 should avoid setting the logging level to <code>debug</code>.</p>
<p>If the logging level for Elastic Agent &gt;= 8.6.0 and &lt; 8.15.0 has been set to <code>debug</code>, users should follow the guidance under “Self-Managed” above. Additionally, users can create an <a href=\"https://www.elastic.co/guide/en/elasticsearch/reference/current/processors.html\">ingest processor</a> to redact the component field before it’s logged to the monitoring environment. Example below</p>
<pre><code class=\"lang-auto\">{
  \"description\": \"Ingest processor for esa-2024-23\",
  \"processors\": [
    {
      \"remove\": {
        \"if\" : \"ctx.log?.level == 'debug'\",
        \"field\": \"components\"
      }
    }
  ]
}

</code></pre>
<p><strong>Severity:</strong> CVSSv4.0: 6.5 (Medium) - <a href=\"https://www.first.org/cvss/calculator/4.0#CVSS:4.0/AV:N/AC:L/AT:N/PR:L/UI:N/VC:N/VI:N/VA:N/SC:H/SI:H/SA:H\">CVSS:4.0/AV:N/AC:L/AT:N/PR:L/UI:N/VC:N/VI:N/VA:N/SC:H/SI:H/SA:H</a></p>
<p><strong>CVE ID:</strong> CVE-2024-37283</p>
            <p><small>1 post - 1 participant</small></p>
            <p><a href=\"https://discuss.elastic.co/t/elastic-agent-8-15-0-security-update-esa-2024-23/364635\">Read full topic</a></p>
          ") (link nil "https://discuss.elastic.co/t/elastic-agent-8-15-0-security-update-esa-2024-23/364635") (pubDate nil "Thu, 08 Aug 2024 23:33:32 +0000") (topicPinned nil "No") (topicClosed nil "No") (topicArchived nil "No") (guid ((isPermaLink . "false")) "discuss.elastic.co-topic-364635") (source ((url . "https://discuss.elastic.co/t/elastic-agent-8-15-0-security-update-esa-2024-23/364635.rss")) "Elastic Agent 8.15.0 Security Update (ESA-2024-23)")) (item nil (title nil "Kibana 8.14.2 / 7.17.23 Security Update (ESA-2024-22)") (creator nil "rodrigo_silva") (category nil "Security Announcements") (description nil "
            <h1><a name=\"p-1389349-kibana-arbitrary-code-execution-via-prototype-pollution-esa-2024-22-1\" class=\"anchor\" href=\"https://discuss.elastic.co#p-1389349-kibana-arbitrary-code-execution-via-prototype-pollution-esa-2024-22-1\"></a>Kibana arbitrary code execution via prototype pollution (ESA-2024-22)</h1>
<p>A flaw allowing arbitrary code execution was discovered in Kibana. An attacker with access to ML and Alerting connector features, as well as write access to internal ML indices can trigger a prototype pollution vulnerability, ultimately leading to arbitrary code execution.</p>
<p>This issue affects self-managed Kibana installations on host Operating Systems.</p>
<p>This issue affects self-managed Kibana instances running the Kibana Docker image, but the RCE is limited within the container. Further exploitation such as container escape is prevented by seccomp-bpf.</p>
<p>This issue affects Kibana instances running on Elastic Cloud but the RCE is limited within the Kibana Docker container. Further exploitation such as container escape is prevented by seccomp-bpf and AppArmor profiles.</p>
<p>This issue affects Kibana instances running on Elastic Cloud Enterprise (ECE) but the code execution is limited within the Kibana Docker container. Further exploitation such as container escape is prevented by seccomp-bpf and AppArmor profiles.</p>
<p>This issue affects Kibana instances running on Elastic Cloud on Kubernetes (ECK) but the code execution is limited within the Kibana Docker container. Further exploitation such as container escape can be prevented by seccomp-bpf when configured and supported (Kubernetes v1.19 and later).</p>
<h2><a name=\"p-1389349-affected-versions-2\" class=\"anchor\" href=\"https://discuss.elastic.co#p-1389349-affected-versions-2\"></a>Affected Versions:</h2>
<p>Kibana 8.x versions prior to 8.14.2 and Kibana 7.x versions from 7.7.0 prior to 7.17.23</p>
<h2><a name=\"p-1389349-affected-configurations-3\" class=\"anchor\" href=\"https://discuss.elastic.co#p-1389349-affected-configurations-3\"></a>Affected Configurations:</h2>
<p>This exploit requires a threat actor to have all of the following priveleges: write access to the .ml-anomalies* hidden indices, read access to the Machine Learning feature, and read access to the Actions &amp; Connectors feature.<br>
Write access to the .ml-anomalies* hidden indices isn't provided by default, is not recommended, nor is it explicitly or implicitly required for any user functionality.</p>
<h2><a name=\"p-1389349-solutions-and-mitigations-4\" class=\"anchor\" href=\"https://discuss.elastic.co#p-1389349-solutions-and-mitigations-4\"></a>Solutions and Mitigations:</h2>
<p>Users should upgrade to version 8.14.2 and 7.17.23.</p>
<h3><a name=\"p-1389349-for-users-that-cannot-upgrade-5\" class=\"anchor\" href=\"https://discuss.elastic.co#p-1389349-for-users-that-cannot-upgrade-5\"></a>For Users that cannot upgrade:</h3>
<p>If an upgrade is not possible, we advise customers to first ensure Elasticsearch and Kibana user privileges are properly secured. Further mitigations can be applied by disabling Connector Actions and Machine Learning capabilities if this functionality is not required. Details are as follows:</p>
<h4><a name=\"p-1389349-h-1-securing-elasticsearch-user-privileges-6\" class=\"anchor\" href=\"https://discuss.elastic.co#p-1389349-h-1-securing-elasticsearch-user-privileges-6\"></a>1. Securing Elasticsearch user privileges</h4>
<p>Customers are advised to ensure that users have not been granted Elasticsearch index privileges to write ML result indices (<code>.ml-anomalies*</code>). Ensure this has not been explicitly granted.</p>
<p><code>GET _security/role</code></p>
<p>Check role definitions for customer-created roles. Ensure index privileges have not been granted to <code>.ml-anomalies*</code> (or equivalent matching wildcard) for any customer role that would allow writing data (all, write, create_doc, create, index, etc).</p>
<p>Note: Users with superuser privileges have full index privileges. Ensure superuser access is controlled.</p>
<h4><a name=\"p-1389349-h-2-securing-kibana-user-privileges-7\" class=\"anchor\" href=\"https://discuss.elastic.co#p-1389349-h-2-securing-kibana-user-privileges-7\"></a>2. Securing Kibana user privileges</h4>
<p>Kibana user privileges can be further secured to limit access to ML and connector action capabilities.</p>
<p>Users that do not require access to ML or manage Kibana Alerting Rules must have either of the following Kibana privileges set to “None”:</p>
<p>Machine Learning: None</p>
<p>Management / Actions and Connectors: None</p>
<p>Note: Users with superuser privileges will still be able to access machine learning capabilities in Kibana. In 7.x, users with <code>manage_ml</code> or <code>monitor_ml</code> Elasticsearch cluster privileges or <code>machine_learning_admin</code> or <code>machine_learning_user</code> built-in roles are able to access machine learning capabilities in Kibana.</p>
<h3><a name=\"p-1389349-further-mitigations-can-be-applied-via-8\" class=\"anchor\" href=\"https://discuss.elastic.co#p-1389349-further-mitigations-can-be-applied-via-8\"></a>Further mitigations can be applied via:</h3>
<h4><a name=\"p-1389349-h-3-disabling-connector-actions-9\" class=\"anchor\" href=\"https://discuss.elastic.co#p-1389349-h-3-disabling-connector-actions-9\"></a>3. Disabling Connector Actions</h4>
<p>All email connector actions can be disabled. This will prevent emails from being sent for alerting rule notifications, and an alternate notification action would be required. This must be set on all Kibana nodes and applied after a node restart.</p>
<p>In 7.7+ and 8.x, Connector action can be disabled in kibana.yml. This must be applied to all Kibana nodes. <strong>Note: <em>Do not apply</em> this yml setting to clusters of version 7.6 and below - this will prevent Kibana from starting.</strong></p>
<p>A full list of action types is available in the documentation:<br>
<a href=\"https://www.elastic.co/guide/en/kibana/7.17/alert-action-settings-kb.html\">https://www.elastic.co/guide/en/kibana/7.17/alert-action-settings-kb.html</a><br>
<a href=\"https://www.elastic.co/guide/en/kibana/8.15/alert-action-settings-kb.html\">https://www.elastic.co/guide/en/kibana/8.15/alert-action-settings-kb.html</a></p>
<pre><code class=\"lang-auto\">// kibana.yml
// To only allow specific named connector actions, supply an named list and exclude email
// Also delete any pre-configured email connectors, if specified
xpack.actions.enabledActionTypes: [ \".s​​erver-log\", \".index\", \".other-tbc\" ]
</code></pre>
<p>Any existing Alerting Rule that used an email action for its notifications would continue running but would not be able to send email notifications. Errors would be logged due to the disabled email connector. An alternate connector action would be required for notifications.</p>
<h4><a name=\"p-1389349-h-4-disabling-ml-10\" class=\"anchor\" href=\"https://discuss.elastic.co#p-1389349-h-4-disabling-ml-10\"></a>4. Disabling ML</h4>
<p>Machine learning capabilities can be disabled. This will prevent machine learning jobs from running.</p>
<p>In 6.x, 7.x, 8.x, machine learning functionality can be disabled entirely by setting the following in elasticsearch.yml. This must be applied to all Elasticsearch nodes and is applied upon a node restart.</p>
<p><a href=\"https://www.elastic.co/guide/en/elasticsearch/reference/8.14/ml-settings.html\">https://www.elastic.co/guide/en/elasticsearch/reference/8.14/ml-settings.html</a><br>
<a href=\"https://www.elastic.co/guide/en/elasticsearch/reference/7.17/ml-settings.html\">https://www.elastic.co/guide/en/elasticsearch/reference/7.17/ml-settings.html</a><br>
<a href=\"https://www.elastic.co/guide/en/elasticsearch/reference/6.8/ml-settings.html\">https://www.elastic.co/guide/en/elasticsearch/reference/6.8/ml-settings.html</a></p>
<pre><code class=\"lang-auto\">// elasticsearch.yml
xpack.ml.enabled: false
</code></pre>
<p>In 6.x and 7.x, machine learning in Kibana functionality can be disabled in Kibana only, by setting the following in kibana.yml. Machine learning functionality will continue to be available in Elasticsearch and accessible via Elasticsearch APIs, and all Kibana ML functionality will be disabled. Choose this option if you want to continue accessing ML functionality via Elasticsearch APIs only. This must be set on all Kibana nodes and is applied upon a node restart.</p>
<p><a href=\"https://www.elastic.co/guide/en/kibana/7.17/ml-settings-kb.html\">https://www.elastic.co/guide/en/kibana/7.17/ml-settings-kb.html</a><br>
<a href=\"https://www.elastic.co/guide/en/kibana/6.8/ml-settings-kb.html\">https://www.elastic.co/guide/en/kibana/6.8/ml-settings-kb.html</a></p>
<pre><code class=\"lang-auto\">// kibana.yml
xpack.ml.enabled: false
</code></pre>
<h3><a name=\"p-1389349-severity-11\" class=\"anchor\" href=\"https://discuss.elastic.co#p-1389349-severity-11\"></a>Severity:</h3>
<p>CVSSv3.1: 9.1(Critical) - <a href=\"https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:C/C:H/I:H/A:H\">CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:C/C:H/I:H/A:H</a></p>
<p>***Updated Aug 13, 2024 11:45:01 UTC : CVSS Severity Rating has been updated after re-analysis of the issue. Privileges Required was revised to High from the initial assessment Privileges Required Low.</p>
<h3><a name=\"p-1389349-cve-id-12\" class=\"anchor\" href=\"https://discuss.elastic.co#p-1389349-cve-id-12\"></a>CVE ID:</h3>
<p>CVE-2024-37287</p>
            <p><small>7 posts - 2 participants</small></p>
            <p><a href=\"https://discuss.elastic.co/t/kibana-8-14-2-7-17-23-security-update-esa-2024-22/364424\">Read full topic</a></p>
          ") (link nil "https://discuss.elastic.co/t/kibana-8-14-2-7-17-23-security-update-esa-2024-22/364424") (pubDate nil "Mon, 05 Aug 2024 22:23:02 +0000") (topicPinned nil "No") (topicClosed nil "No") (topicArchived nil "No") (guid ((isPermaLink . "false")) "discuss.elastic.co-topic-364424") (source ((url . "https://discuss.elastic.co/t/kibana-8-14-2-7-17-23-security-update-esa-2024-22/364424.rss")) "Kibana 8.14.2 / 7.17.23 Security Update (ESA-2024-22)")) (item nil (title nil "APM Server 8.14.0 Security Update (ESA-2024-19)") (creator nil "rodrigo_silva") (category nil "Security Announcements") (description nil "
            <h3><a name=\"apm-server-insertion-of-sensitive-information-into-log-file-esa-2024-19-1\" class=\"anchor\" href=\"https://discuss.elastic.co#apm-server-insertion-of-sensitive-information-into-log-file-esa-2024-19-1\"></a>APM Server Insertion of Sensitive Information into Log File (ESA-2024-19)</h3>
<p>APM server logs contain document body from a partially failed bulk index request. For example, in case of unavailable_shards_exception for a specific document, since the ES response line contains the document body, and that APM server logs the ES response line on error, the document is effectively logged.</p>
<p><strong>Affected Versions:</strong><br>
APM Server versions before 8.14.0</p>
<p><strong>Solutions and Mitigations:</strong><br>
The issue is resolved in version 8.14.0.</p>
<p><strong>Reviewing Logs for Sensitive Information</strong><br>
Users can search for instances of these documents and determine whether any sensitive information has been leaked in APM Server logs by searching for the following string</p>
<p>​​<code>message: \"unavailable_shards_exception\"</code> and <code>message: \"source\"</code></p>
<p><strong>Severity:</strong> CVSSv3: 5.7(Medium) - <a href=\"https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:A/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N\">AV:A/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N</a></p>
<p><strong>CVE ID:</strong> CVE-2024-37286</p>
            <p><small>1 post - 1 participant</small></p>
            <p><a href=\"https://discuss.elastic.co/t/apm-server-8-14-0-security-update-esa-2024-19/364289\">Read full topic</a></p>
          ") (link nil "https://discuss.elastic.co/t/apm-server-8-14-0-security-update-esa-2024-19/364289") (pubDate nil "Fri, 02 Aug 2024 20:20:04 +0000") (topicPinned nil "No") (topicClosed nil "No") (topicArchived nil "No") (guid ((isPermaLink . "false")) "discuss.elastic.co-topic-364289") (source ((url . "https://discuss.elastic.co/t/apm-server-8-14-0-security-update-esa-2024-19/364289.rss")) "APM Server 8.14.0 Security Update (ESA-2024-19)")) (item nil (title nil "Elasticsearch 8.13.0/7.17.23 Security Update (ESA-2024-12)") (creator nil "Bryan_Garcia") (category nil "Security Announcements") (description nil "
            <p>Elasticsearch elasticsearch-certutil csr fails to encrypt private key (ESA-2024-12)</p>
<p>It was discovered by Elastic engineering that when elasticsearch-certutil CLI tool is used with the csr option in order to create a new Certificate Signing Requests, the associated private key that is generated is stored on disk unencrypted even if the --pass parameter is passed in the command invocation.</p>
<p>Affected Versions:</p>
<p>Elasticsearch versions before 7.17.23 and before 8.13.0</p>
<p>Solutions and Mitigations:</p>
<p>The issue is resolved in version 7.17.23 and 8.13.0</p>
<p>Severity: CVSSv3: 4.9(Medium) - <a href=\"https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:N/A:N\">CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:N/A:N</a></p>
<p>CVE ID: CVE-2024-23444</p>
            <p><small>1 post - 1 participant</small></p>
            <p><a href=\"https://discuss.elastic.co/t/elasticsearch-8-13-0-7-17-23-security-update-esa-2024-12/364157\">Read full topic</a></p>
          ") (link nil "https://discuss.elastic.co/t/elasticsearch-8-13-0-7-17-23-security-update-esa-2024-12/364157") (pubDate nil "Wed, 31 Jul 2024 17:12:52 +0000") (topicPinned nil "No") (topicClosed nil "No") (topicArchived nil "No") (guid ((isPermaLink . "false")) "discuss.elastic.co-topic-364157") (source ((url . "https://discuss.elastic.co/t/elasticsearch-8-13-0-7-17-23-security-update-esa-2024-12/364157.rss")) "Elasticsearch 8.13.0/7.17.23 Security Update (ESA-2024-12)")) (item nil (title nil "Kibana 7.17.23/8.14.0 Security Update (ESA-2024-16)") (creator nil "Bryan_Garcia") (category nil "Security Announcements") (description nil "
            <p>Kibana Denial of Service issue (ESA-2024-16)</p>
<p>An issue was discovered in Kibana where a user with Viewer role could cause a Kibana instance to crash by sending a large number of maliciously crafted requests to a specific endpoint.</p>
<p>Affected Versions:<br>
Kibana 8.x versions prior to 8.14.0 and Kibana 7.x versions prior to 7.17.23</p>
<p>Solutions and Mitigations:<br>
The issue is resolved in version 8.14.0 and 7.17.23.</p>
<p>Severity: CVSSv3: 6.5(Medium) - AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H/CR:M/IR:M/AR:M<br>
CVE ID: CVE-2024-37281</p>
            <p><small>1 post - 1 participant</small></p>
            <p><a href=\"https://discuss.elastic.co/t/kibana-7-17-23-8-14-0-security-update-esa-2024-16/364094\">Read full topic</a></p>
          ") (link nil "https://discuss.elastic.co/t/kibana-7-17-23-8-14-0-security-update-esa-2024-16/364094") (pubDate nil "Tue, 30 Jul 2024 21:22:31 +0000") (topicPinned nil "No") (topicClosed nil "No") (topicArchived nil "No") (guid ((isPermaLink . "false")) "discuss.elastic.co-topic-364094") (source ((url . "https://discuss.elastic.co/t/kibana-7-17-23-8-14-0-security-update-esa-2024-16/364094.rss")) "Kibana 7.17.23/8.14.0 Security Update (ESA-2024-16)")) (item nil (title nil "Elastic Cloud Enterprise 3.7.2 Security Update (ESA-2024-18)") (creator nil "ikakavas") (category nil "Security Announcements") (description nil "
            <h3><a name=\"ece-improper-authorization-esa-2024-18-1\" class=\"anchor\" href=\"https://discuss.elastic.co#ece-improper-authorization-esa-2024-18-1\"></a>ECE Improper Authorization (ESA-2024-18)</h3>
<p>It was identified that under certain specific preconditions, an <a href=\"https://www.elastic.co/guide/en/cloud-enterprise/current/ece-restful-api-authentication.html#ece-api-keys\">API key</a> that was originally created with a specific privileges could be subsequently used to create new API keys that have elevated privileges.</p>
<h3><a name=\"affected-versions-2\" class=\"anchor\" href=\"https://discuss.elastic.co#affected-versions-2\"></a>Affected Versions:</h3>
<p>ECE versions after 3.0.0 and before 3.7.2</p>
<h3><a name=\"solutions-and-mitigations-3\" class=\"anchor\" href=\"https://discuss.elastic.co#solutions-and-mitigations-3\"></a>Solutions and Mitigations:</h3>
<p>Users should upgrade to version 3.7.2.</p>
<p><strong>Severity:</strong> CVSSv3: 8.1(High) - <a href=\"https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H\">CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H</a></p>
<p><strong>CVE ID:</strong> CVE-2024-37282</p>
            <p><small>1 post - 1 participant</small></p>
            <p><a href=\"https://discuss.elastic.co/t/elastic-cloud-enterprise-3-7-2-security-update-esa-2024-18/362181\">Read full topic</a></p>
          ") (link nil "https://discuss.elastic.co/t/elastic-cloud-enterprise-3-7-2-security-update-esa-2024-18/362181") (pubDate nil "Fri, 28 Jun 2024 04:54:13 +0000") (topicPinned nil "No") (topicClosed nil "No") (topicArchived nil "No") (guid ((isPermaLink . "false")) "discuss.elastic.co-topic-362181") (source ((url . "https://discuss.elastic.co/t/elastic-cloud-enterprise-3-7-2-security-update-esa-2024-18/362181.rss")) "Elastic Cloud Enterprise 3.7.2 Security Update (ESA-2024-18)")) (item nil (title nil "Kibana 7.17.22 / 8.14.0 Security Update (ESA-2024-17)") (creator nil "Bryan_Garcia") (category nil "Security Announcements") (description nil "
            <p><strong>Kibana RCE due to chromium type confusion (ESA-2024-17)</strong></p>
<p>On March 26, 2024, a type confusion vulnerability was found in WebAssembly in Google Chrome version prior to 123.0.6312.86 which allows a remote attacker to execute arbitrary code via a crafted HTML page.</p>
<p>Kibana includes a bundled version of headless Chromium that is only used for Kibana’s reporting capabilities and which is affected by this vulnerability. An exploit for Kibana has not been identified, however as a resolution, the bundled version of Chromium is updated in this release.</p>
<p>This issue affects on-premises Kibana installations on host Operating Systems where <a href=\"https://www.elastic.co/guide/en/kibana/current/reporting-production-considerations.html#reporting-chromium-sandbox\">Chromium sandbox is disabled </a> (only CentOS, Debian, RHEL).</p>
<p>This issue affects Kibana instances running using the Kibana Docker image when the Chromium sandbox is explicitly disabled as suggested by the documentation. Further exploitation such as container escape is prevented by seccomp-bpf.</p>
<p>This issue affects Kibana instances running on Elastic Cloud but the RCE is limited within the Kibana Docker container. Further exploitation such as container escape is prevented by seccomp-bpf and AppArmor profiles.</p>
<p>This issue affects Kibana instances running on Elastic Cloud Enterprise (ECE) but the RCE is limited within the Kibana Docker container. Further exploitation such as container escape is prevented by seccomp-bpf and AppArmor profiles.</p>
<p>This issue affects Kibana instances running on Elastic Cloud on Kubernetes (ECK) but the RCE is limited within the Kibana Docker container. Further exploitation such as container escape can be prevented by seccomp-bpf when configured and supported (Kubernetes v1.19 and later).</p>
<p><strong>Affected Versions:</strong><br>
Kibana version 7.17.21 and Kibana 8.13.x versions prior to 8.14.0.</p>
<p><strong>Solutions and Mitigations:</strong><br>
Users should upgrade to versions 7.17.22 and 8.14.0</p>
<p>For users that cannot upgrade, users can disable Kibana reporting functionality completely in the kibana.yml file with the following setting: xpack.reporting.enabled: false<br>
If users rely on CSV reports may want an option to only disable the screenshot-based reports. The setting for that is:<br>
xpack.reporting.pdf.enabled: false<br>
xpack.reporting.png.enabled: false</p>
<p><strong>Severity:</strong> CVSSv3: 9.9 (Critical) - AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H/CR:M/IR:M/AR:M</p>
<p><strong>CVE ID:</strong> CVE-2024-2887</p>
            <p><small>1 post - 1 participant</small></p>
            <p><a href=\"https://discuss.elastic.co/t/kibana-7-17-22-8-14-0-security-update-esa-2024-17/361508\">Read full topic</a></p>
          ") (link nil "https://discuss.elastic.co/t/kibana-7-17-22-8-14-0-security-update-esa-2024-17/361508") (pubDate nil "Fri, 14 Jun 2024 15:27:57 +0000") (topicPinned nil "No") (topicClosed nil "No") (topicArchived nil "No") (guid ((isPermaLink . "false")) "discuss.elastic.co-topic-361508") (source ((url . "https://discuss.elastic.co/t/kibana-7-17-22-8-14-0-security-update-esa-2024-17/361508.rss")) "Kibana 7.17.22 / 8.14.0 Security Update (ESA-2024-17)")) (item nil (title nil "Kibana 8.14.0/7.17.22 Security Update (ESA-2024-10)") (creator nil "rodrigo_silva") (category nil "Security Announcements") (description nil "
            <p><strong>Kibana open redirect issue (ESA-2024-10).</strong></p>
<p>An open redirect issue was discovered in Kibana that could lead to a user being redirected to an arbitrary website if they use a maliciously crafted Kibana URL.</p>
<p><strong>Affected Versions:</strong><br>
Kibana Versions before 7.17.22 and before 8.14.0.</p>
<p><strong>Solutions and Mitigations:</strong><br>
The issue is resolved in versions 7.17.22 and 8.14.0.</p>
<p><strong>Severity:</strong> CVSSv3: 6.1(Medium) - AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N</p>
<p><strong>CVE ID:</strong> CVE-2024-23442</p>
            <p><small>1 post - 1 participant</small></p>
            <p><a href=\"https://discuss.elastic.co/t/kibana-8-14-0-7-17-22-security-update-esa-2024-10/361502\">Read full topic</a></p>
          ") (link nil "https://discuss.elastic.co/t/kibana-8-14-0-7-17-22-security-update-esa-2024-10/361502") (pubDate nil "Fri, 14 Jun 2024 14:09:17 +0000") (topicPinned nil "No") (topicClosed nil "No") (topicArchived nil "No") (guid ((isPermaLink . "false")) "discuss.elastic.co-topic-361502") (source ((url . "https://discuss.elastic.co/t/kibana-8-14-0-7-17-22-security-update-esa-2024-10/361502.rss")) "Kibana 8.14.0/7.17.22 Security Update (ESA-2024-10)")) (item nil (title nil "Kibana 8.14.0/7.17.22 Security Update (ESA-2024-11)") (creator nil "ikakavas") (category nil "Security Announcements") (description nil "
            <h2><a name=\"kibana-uncontrolled-resource-consumption-esa-2024-11-1\" class=\"anchor\" href=\"https://discuss.elastic.co#kibana-uncontrolled-resource-consumption-esa-2024-11-1\"></a>Kibana uncontrolled resource consumption (ESA-2024-11)</h2>
<p>A high-privileged user, allowed to create <a href=\"https://www.elastic.co/guide/en/kibana/current/osquery.html#osquery-schedule-query\">custom osquery packs</a> could affect the availability of Kibana by uploading a maliciously crafted osquery pack.</p>
<h3><a name=\"affected-versions-2\" class=\"anchor\" href=\"https://discuss.elastic.co#affected-versions-2\"></a>Affected Versions:</h3>
<p>Kibana versions before 7.17.22 and before 8.14.0</p>
<h3><a name=\"solutions-and-mitigations-3\" class=\"anchor\" href=\"https://discuss.elastic.co#solutions-and-mitigations-3\"></a>Solutions and Mitigations:</h3>
<p>The issue is resolved in version 7.17.22 and 8.14.0</p>
<p><strong>Severity</strong>: CVSSv3.1: 4.9(Medium) - <a href=\"https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:N/I:N/A:H\">CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:N/I:N/A:H</a></p>
<p><strong>CVE ID:</strong> CVE-2024-23443</p>
            <p><small>1 post - 1 participant</small></p>
            <p><a href=\"https://discuss.elastic.co/t/kibana-8-14-0-7-17-22-security-update-esa-2024-11/361460\">Read full topic</a></p>
          ") (link nil "https://discuss.elastic.co/t/kibana-8-14-0-7-17-22-security-update-esa-2024-11/361460") (pubDate nil "Fri, 14 Jun 2024 04:47:49 +0000") (topicPinned nil "No") (topicClosed nil "No") (topicArchived nil "No") (guid ((isPermaLink . "false")) "discuss.elastic.co-topic-361460") (source ((url . "https://discuss.elastic.co/t/kibana-8-14-0-7-17-22-security-update-esa-2024-11/361460.rss")) "Kibana 8.14.0/7.17.22 Security Update (ESA-2024-11)")) (item nil (title nil "Elasticsearch 8.14.0 Security Update (ESA-2024-14)") (creator nil "rodrigo_silva") (category nil "Security Announcements") (description nil "
            <p><strong>Elasticsearch StackOverflow vulnerability (ESA-2024-14)</strong></p>
<p>A flaw was discovered in Elasticsearch, affecting document ingestion when an index template contains a dynamic field mapping of “passthrough” type. Under certain circumstances, ingesting documents in this index would cause a StackOverflow exception to be thrown and ultimately lead to a Denial of Service. Note that passthrough fields is an experimental feature.</p>
<p><strong>Affected Versions:</strong><br>
Elasticsearch version 8.13.1 through 8.13.4.</p>
<p><strong>Solutions and Mitigations:</strong><br>
The issue is resolved in Elasticsearch 8.14.0.</p>
<p><strong>Severity:</strong> CVSSv3: 4.9(Medium) - AV:N/AC:L/PR:H/UI:N/S:U/C:N/I:N/A:H</p>
<p><strong>CVE ID:</strong> CVE-2024-37280</p>
            <p><small>1 post - 1 participant</small></p>
            <p><a href=\"https://discuss.elastic.co/t/elasticsearch-8-14-0-security-update-esa-2024-14/361007\">Read full topic</a></p>
          ") (link nil "https://discuss.elastic.co/t/elasticsearch-8-14-0-security-update-esa-2024-14/361007") (pubDate nil "Fri, 07 Jun 2024 04:06:51 +0000") (topicPinned nil "No") (topicClosed nil "No") (topicArchived nil "No") (guid ((isPermaLink . "false")) "discuss.elastic.co-topic-361007") (source ((url . "https://discuss.elastic.co/t/elasticsearch-8-14-0-security-update-esa-2024-14/361007.rss")) "Elasticsearch 8.14.0 Security Update (ESA-2024-14)")) (item nil (title nil "Elasticsearch 8.14.0 Security Update (ESA-2024-13)") (creator nil "ikakavas") (category nil "Security Announcements") (description nil "
            <h3><a name=\"elasticsearch-remote-cluster-search-cross-cluster-api-key-insufficient-restrictions-esa-2024-13-1\" class=\"anchor\" href=\"https://discuss.elastic.co#elasticsearch-remote-cluster-search-cross-cluster-api-key-insufficient-restrictions-esa-2024-13-1\"></a>Elasticsearch Remote Cluster Search Cross Cluster API Key insufficient restrictions (ESA-2024-13)</h3>
<p>It was identified that if a <a href=\"https://www.elastic.co/guide/en/elasticsearch/reference/8.14/security-api-create-cross-cluster-api-key.html#security-api-create-cross-cluster-api-key-request-body\">cross-cluster API key</a> restricts search for a given index using the <code>query</code> or the <code>field_security</code> parameter, and the same cross-cluster API key also grants replication for the same index, the search restrictions are not enforced during cross cluster search operations and search results may include documents and terms that should not be returned.</p>
<p>This issue only affects the <a href=\"https://www.elastic.co/guide/en/elasticsearch/reference/8.14/remote-clusters.html#remote-clusters-security-models\">API key based security model for remote clusters</a> that was previously a beta feature and is released as GA with 8.14.0</p>
<p>We would like to thank René Kalff for bringing this issue to our attention.</p>
<h3><a name=\"affected-versions-2\" class=\"anchor\" href=\"https://discuss.elastic.co#affected-versions-2\"></a>Affected Versions:</h3>
<p>Elasticsearch version on or after 8.10.0 and before 8.14.0</p>
<h3><a name=\"solutions-and-mitigations-3\" class=\"anchor\" href=\"https://discuss.elastic.co#solutions-and-mitigations-3\"></a>Solutions and Mitigations:</h3>
<p>The issue is resolved in version 8.14.0.</p>
<p><strong>Severity</strong>: CVSSv3: 6.5(Medium) - <a href=\"https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N\">CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N</a></p>
<p><strong>CVE ID</strong>: CVE-2024-23445</p>
            <p><small>1 post - 1 participant</small></p>
            <p><a href=\"https://discuss.elastic.co/t/elasticsearch-8-14-0-security-update-esa-2024-13/360898\">Read full topic</a></p>
          ") (link nil "https://discuss.elastic.co/t/elasticsearch-8-14-0-security-update-esa-2024-13/360898") (pubDate nil "Thu, 06 Jun 2024 03:32:51 +0000") (topicPinned nil "No") (topicClosed nil "No") (topicArchived nil "No") (guid ((isPermaLink . "false")) "discuss.elastic.co-topic-360898") (source ((url . "https://discuss.elastic.co/t/elasticsearch-8-14-0-security-update-esa-2024-13/360898.rss")) "Elasticsearch 8.14.0 Security Update (ESA-2024-13)")) (item nil (title nil "Elastic Cloud Enterprise 3.7.1 Security Update (ESA-2024-08)") (creator nil "rodrigo_silva") (category nil "Security Announcements") (description nil "
            <p><strong>Elastic Cloud Enterprise - Uncontrolled Resource Consumption through HTTP/2 endpoints - CVE-2023-45288 (ESA-2024-08)</strong></p>
<p>On April 4, 2024, the Go Project announced CVE-2023-45288, which can lead to CPU exhaustion as an attacker can cause an HTTP/2 endpoint to read arbitrary amounts of header data.</p>
<p>In the case of Elastic Cloud Enterprise (ECE) it enables attackers to significantly increase the CPU usage of the proxy component within Elastic Cloud Enterprise. This heightened CPU usage can lead to a noticeable slowdown in the system's ability to respond to requests for provisioned deployments, and in severe cases, it may prevent the proxy from responding to such requests entirely.</p>
<p><strong>Affected Versions:</strong><br>
Elastic Cloud Enterprise versions up to, but not including, 3.7.1</p>
<p><strong>Solutions and Mitigations:</strong><br>
Users should upgrade to version 3.7.1</p>
<p><strong>Severity:</strong> 5.3 (Medium) <a href=\"https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L\">CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L</a></p>
<p><strong>CVE ID:</strong> CVE-2023-45288</p>
            <p><small>1 post - 1 participant</small></p>
            <p><a href=\"https://discuss.elastic.co/t/elastic-cloud-enterprise-3-7-1-security-update-esa-2024-08/360888\">Read full topic</a></p>
          ") (link nil "https://discuss.elastic.co/t/elastic-cloud-enterprise-3-7-1-security-update-esa-2024-08/360888") (pubDate nil "Wed, 05 Jun 2024 20:57:45 +0000") (topicPinned nil "No") (topicClosed nil "No") (topicArchived nil "No") (guid ((isPermaLink . "false")) "discuss.elastic.co-topic-360888") (source ((url . "https://discuss.elastic.co/t/elastic-cloud-enterprise-3-7-1-security-update-esa-2024-08/360888.rss")) "Elastic Cloud Enterprise 3.7.1 Security Update (ESA-2024-08)")) (item nil (title nil "Kibana 8.14.0 Security Update (ESA-2024-15)") (creator nil "rodrigo_silva") (category nil "Security Announcements") (description nil "
            <p><strong>Kibana Broken Access Control issue (ESA-2024-15)</strong></p>
<p>A flaw was discovered in Kibana, allowing <code>view-only</code> users of alerting to use the <code>run_soon</code> API making the alerting rule run continuously, potentially affecting the system availability if the alerting rule is running complex queries.</p>
<p><strong>Affected Versions:</strong><br>
Kibana versions 8.6.3 through 8.13.4.</p>
<p><strong>Solutions and Mitigations:</strong><br>
The issue is resolved in version 8.14.0.</p>
<p><strong>Severity:</strong> CVSSv3: 4.3(Medium) - AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:L</p>
<p><strong>CVE ID:</strong> CVE-2024-37279</p>
            <p><small>1 post - 1 participant</small></p>
            <p><a href=\"https://discuss.elastic.co/t/kibana-8-14-0-security-update-esa-2024-15/360887\">Read full topic</a></p>
          ") (link nil "https://discuss.elastic.co/t/kibana-8-14-0-security-update-esa-2024-15/360887") (pubDate nil "Wed, 05 Jun 2024 20:45:39 +0000") (topicPinned nil "No") (topicClosed nil "No") (topicArchived nil "No") (guid ((isPermaLink . "false")) "discuss.elastic.co-topic-360887") (source ((url . "https://discuss.elastic.co/t/kibana-8-14-0-security-update-esa-2024-15/360887.rss")) "Kibana 8.14.0 Security Update (ESA-2024-15)")) (item nil (title nil "Elastic Security Statement for CVE-2024-3094, xz versions 5.6.0 and 5.6.1") (creator nil "ismisepaul") (category nil "Security Announcements") (description nil "
            <p><strong>Elastic Products are not affected by this issue.</strong></p>
<p>On March 29th, 2024, Elastic became aware of the <a href=\"https://www.elastic.co/security-labs/500ms-to-midnight\">malicious code planted in the xz package</a>.</p>
<p>Elastic has performed an investigation to identify any Elastic Products which may be impacted by this issue and we have concluded that no Elastic products use the versions of xz affected by this vulnerability. Therefore, Elastic Products are not affected by this issue.</p>
<p>Reference Links:</p>
<ul>
<li><a href=\"https://www.openwall.com/lists/oss-security/2024/03/29/4\" class=\"inline-onebox\">oss-security - backdoor in upstream xz/liblzma leading to ssh server compromise</a></li>
<li><a href=\"https://www.elastic.co/security-labs/500ms-to-midnight\" class=\"inline-onebox\">500ms to midnight: XZ / liblzma backdoor — Elastic Security Labs</a></li>
<li><a href=\"https://www.redhat.com/en/blog/urgent-security-alert-fedora-41-and-rawhide-users\" class=\"inline-onebox\">Urgent security alert for Fedora 41 and Fedora Rawhide users</a></li>
<li><a href=\"https://lists.debian.org/debian-security-announce/2024/msg00057.html\" class=\"inline-onebox\">[SECURITY] [DSA 5649-1] xz-utils security update</a></li>
<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2024-3094\" class=\"inline-onebox\">NVD - CVE-2024-3094</a></li>
</ul>
            <p><small>1 post - 1 participant</small></p>
            <p><a href=\"https://discuss.elastic.co/t/elastic-security-statement-for-cve-2024-3094-xz-versions-5-6-0-and-5-6-1/357894\">Read full topic</a></p>
          ") (link nil "https://discuss.elastic.co/t/elastic-security-statement-for-cve-2024-3094-xz-versions-5-6-0-and-5-6-1/357894") (pubDate nil "Mon, 22 Apr 2024 09:19:38 +0000") (topicPinned nil "No") (topicClosed nil "No") (topicArchived nil "No") (guid ((isPermaLink . "false")) "discuss.elastic.co-topic-357894") (source ((url . "https://discuss.elastic.co/t/elastic-security-statement-for-cve-2024-3094-xz-versions-5-6-0-and-5-6-1/357894.rss")) "Elastic Security Statement for CVE-2024-3094, xz versions 5.6.0 and 5.6.1")) (item nil (title nil "Elasticsearch 8.11.1 Security Update (ESA-2024-05)") (creator nil "ismisepaul") (category nil "Security Announcements") (description nil "
            <p><strong>Elasticsearch Uncaught Exception (ESA-2024-05)</strong></p>
<p>An uncaught exception in Elasticsearch &gt;= 8.4.0 and &lt; 8.11.1 occurs when an encrypted PDF is passed to an <a href=\"https://www.elastic.co/guide/en/elasticsearch/reference/current/attachment.html\">attachment processor</a> through the REST API. The Elasticsearch ingest node that attempts to parse the PDF file will crash. This does not happen with password-protected PDF files or with unencrypted PDF files.</p>
<p><strong>Affected Versions:</strong><br>
Affects versions &gt;= 8.4.0 and &lt; 8.11.1</p>
<p><strong>Solutions and Mitigations:</strong><br>
The issue is resolved in version 8.11.1.</p>
<p>This requires the attachment processor to be enabled. Users unable to upgrade can ensure that the <a href=\"https://www.elastic.co/guide/en/elasticsearch/reference/current/attachment.html\">attachment processor</a> is disabled.</p>
<p><strong>Severity:</strong> CVSSv3: 4.3(Medium) - <a href=\"https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:L\">CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:L</a></p>
<p><strong>CVE ID:</strong> CVE-2024-23449</p>
            <p><small>1 post - 1 participant</small></p>
            <p><a href=\"https://discuss.elastic.co/t/elasticsearch-8-11-1-security-update-esa-2024-05/356458\">Read full topic</a></p>
          ") (link nil "https://discuss.elastic.co/t/elasticsearch-8-11-1-security-update-esa-2024-05/356458") (pubDate nil "Fri, 29 Mar 2024 11:12:33 +0000") (topicPinned nil "No") (topicClosed nil "No") (topicArchived nil "No") (guid ((isPermaLink . "false")) "discuss.elastic.co-topic-356458") (source ((url . "https://discuss.elastic.co/t/elasticsearch-8-11-1-security-update-esa-2024-05/356458.rss")) "Elasticsearch 8.11.1 Security Update (ESA-2024-05)")) (item nil (title nil "Elasticsearch 8.13.0 Security Update (ESA-2024-07)") (creator nil "ismisepaul") (category nil "Security Announcements") (description nil "
            <p><strong>Elasticsearch Improper Authorization in the Remote Cluster Security API key based security model (ESA-2024-07)</strong></p>
<p>It was identified by the Elastic engineering team that the API key based security model for <a href=\"https://www.elastic.co/guide/en/elasticsearch/reference/current/remote-clusters.html#remote-clusters-security-models\">Remote Cluster Security</a>, which is currently in Beta, is affected by an improper authorization issue. A malicious user with a valid API key for a remote cluster configured to use new Remote Cluster Security could read arbitrary documents from any index on the remote cluster, if they use the Elasticsearch custom transport protocol to issue requests with the target index ID, the shard ID and the document ID. None of Elasticsearch REST API endpoints are affected by this issue.</p>
<p><strong>Affected Versions:</strong><br>
Elasticsearch versions on or after <code>8.10.0</code> and before <code>8.13.0</code></p>
<p><strong>Solutions and Mitigations:</strong><br>
The issue is resolved in version <code>8.13.0</code></p>
<p><strong>Severity:</strong> CVSSv3: 4.4(Medium) - <a href=\"https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:U/C:H/I:N/A:N\">CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:U/C:H/I:N/A:N</a></p>
<p><strong>CVE ID:</strong> CVE-2024-23451</p>
            <p><small>1 post - 1 participant</small></p>
            <p><a href=\"https://discuss.elastic.co/t/elasticsearch-8-13-0-security-update-esa-2024-07/356315\">Read full topic</a></p>
          ") (link nil "https://discuss.elastic.co/t/elasticsearch-8-13-0-security-update-esa-2024-07/356315") (pubDate nil "Wed, 27 Mar 2024 16:53:56 +0000") (topicPinned nil "No") (topicClosed nil "No") (topicArchived nil "No") (guid ((isPermaLink . "false")) "discuss.elastic.co-topic-356315") (source ((url . "https://discuss.elastic.co/t/elasticsearch-8-13-0-security-update-esa-2024-07/356315.rss")) "Elasticsearch 8.13.0 Security Update (ESA-2024-07)")) (item nil (title nil "Elasticsearch 8.13.0 / 7.17.19 Security Update (ESA-2024-06)") (creator nil "rodrigo_silva") (category nil "Security Announcements") (description nil "
            <p><strong>Elasticsearch Uncontrolled Resource Consumption vulnerability (ESA-2024-06)</strong></p>
<p>A flaw was discovered in Elasticsearch, where processing a document in a deeply nested pipeline on an ingest node could cause the Elasticsearch node to crash.</p>
<p><strong>Affected Versions:</strong><br>
Elasticsearch versions on or after 7.0.0 and before 7.17.19<br>
Elasticsearch versions on or after 8.0.0 and before 8.13.0</p>
<p><strong>Solutions and Mitigations:</strong><br>
The issue is resolved in versions 8.13.0 and 7.17.19.</p>
<p><strong>Severity</strong>: CVSSv3: 4.9(Medium) <a href=\"https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:L/PR:H/UI:N/S:U/C:N/I:N/A:H\">CVSS:3.0/AV:N/AC:L/PR:H/UI:N/S:U/C:N/I:N/A:H</a></p>
<p><strong>CVE ID</strong>: CVE-2024-23450</p>
            <p><small>1 post - 1 participant</small></p>
            <p><a href=\"https://discuss.elastic.co/t/elasticsearch-8-13-0-7-17-19-security-update-esa-2024-06/356314\">Read full topic</a></p>
          ") (link nil "https://discuss.elastic.co/t/elasticsearch-8-13-0-7-17-19-security-update-esa-2024-06/356314") (pubDate nil "Wed, 27 Mar 2024 16:53:36 +0000") (topicPinned nil "No") (topicClosed nil "No") (topicArchived nil "No") (guid ((isPermaLink . "false")) "discuss.elastic.co-topic-356314") (source ((url . "https://discuss.elastic.co/t/elasticsearch-8-13-0-7-17-19-security-update-esa-2024-06/356314.rss")) "Elasticsearch 8.13.0 / 7.17.19 Security Update (ESA-2024-06)")) (item nil (title nil "Kibana 8.12.1, 7.17.18 Security Update (ESA-2024-04)") (creator nil "rodrigo_silva") (category nil "Security Announcements") (description nil "
            <p><strong>Kibana heap buffer overflow vulnerability (ESA-2024-04)</strong></p>
<p>This issue requires authenticated access to Kibana.</p>
<p>On Dec 21, 2023, Google Chrome announced <a href=\"https://nvd.nist.gov/vuln/detail/CVE-2023-7024\">CVE-2023-7024</a>, described as “Heap buffer overflow in WebRTC in Google Chrome prior to 120.0.6099.129 allowed a remote attacker to potentially exploit heap corruption via a crafted HTML page”. Kibana includes a bundled version of headless Chromium that is only used for Kibana’s reporting capabilities and which is affected by this vulnerability.</p>
<p>This issue affects on-premises Kibana installations on host Operating Systems where <a href=\"https://www.elastic.co/guide/en/kibana/current/reporting-production-considerations.html#reporting-chromium-sandbox\">Chromium sandbox is disabled</a> (only CentOS, Debian, RHEL).</p>
<p>This issue affects Kibana instances running using the Kibana Docker image when the Chromium sandbox is explicitly disabled as suggested by the documentation. Further exploitation such as container escape is prevented by seccomp-bpf.</p>
<p>This issue affects Kibana instances running on Elastic Cloud but the RCE is limited within the Kibana Docker container. Further exploitation such as container escape is prevented by seccomp-bpf and AppArmor profiles.</p>
<p>This issue affects Kibana instances running on Elastic Cloud Enterprise (ECE) but the RCE is limited within the Kibana Docker container. Further exploitation such as container escape is prevented by seccomp-bpf and AppArmor profiles.</p>
<p>This issue affects Kibana instances running on Elastic Cloud on Kubernetes (ECK) but the RCE is limited within the Kibana Docker container. Further exploitation such as container escape can be prevented by seccomp-bpf when configured and supported (Kubernetes v1.19 and later).</p>
<p><strong>Affected Versions:</strong><br>
Kibana versions up to 7.17.17 and up to version 8.12.0.</p>
<p><strong>Solutions and Mitigations:</strong><br>
Users should upgrade to version 8.12.1 or 7.17.18</p>
<p>If you are unable to upgrade, you can disable Kibana reporting functionality completely in the <code>kibana.yml</code> file with the following setting: <code>xpack.reporting.enabled: false</code></p>
<p><strong>Severity:</strong> CVSSv3: 9.9(Critical) - <a href=\"https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H\">CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H</a></p>
<p><strong>CVE ID:</strong> <a href=\"https://nvd.nist.gov/vuln/detail/CVE-2023-7024\">CVE-2023-7024</a></p>
            <p><small>1 post - 1 participant</small></p>
            <p><a href=\"https://discuss.elastic.co/t/kibana-8-12-1-7-17-18-security-update-esa-2024-04/352805\">Read full topic</a></p>
          ") (link nil "https://discuss.elastic.co/t/kibana-8-12-1-7-17-18-security-update-esa-2024-04/352805") (pubDate nil "Wed, 07 Feb 2024 22:07:29 +0000") (topicPinned nil "No") (topicClosed nil "No") (topicArchived nil "No") (guid ((isPermaLink . "false")) "discuss.elastic.co-topic-352805") (source ((url . "https://discuss.elastic.co/t/kibana-8-12-1-7-17-18-security-update-esa-2024-04/352805.rss")) "Kibana 8.12.1, 7.17.18 Security Update (ESA-2024-04)")) (item nil (title nil "APM Server 8.12.1 Security Update (ESA-2024-03)") (creator nil "rodrigo_silva") (category nil "Security Announcements") (description nil "
            <p><strong>APM Server Insertion of Sensitive Information into Log File (ESA-2024-03)</strong></p>
<p>An issue was discovered whereby APM Server could log at ERROR level, a response from Elasticsearch indicating that indexing the document failed and that response would contain parts of the original document. Depending on the nature of the document that the APM Server attempted to ingest, this could lead to the insertion of sensitive or private information in the APM Server logs.</p>
<p><strong>Affected Versions:</strong><br>
APM Server versions before 8.12.1</p>
<p><strong>Solutions and Mitigations:</strong><br>
The issue is resolved in version 8.12.1.</p>
<p><strong>Reviewing Logs for Sensitive Information</strong><br>
Users can search for instances of these documents and determine whether any sensitive information has been leaked in APM Server logs by searching for the following string</p>
<p><code>Preview of field's value:</code></p>
<p><strong>Severity:</strong> CVSSv3: 5.7(Medium) - <a href=\"https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:A/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N\">AV:A/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N</a></p>
<p><strong>CVE ID:</strong> CVE-2024-23448</p>
            <p><small>1 post - 1 participant</small></p>
            <p><a href=\"https://discuss.elastic.co/t/apm-server-8-12-1-security-update-esa-2024-03/352688\">Read full topic</a></p>
          ") (link nil "https://discuss.elastic.co/t/apm-server-8-12-1-security-update-esa-2024-03/352688") (pubDate nil "Tue, 06 Feb 2024 22:35:37 +0000") (topicPinned nil "No") (topicClosed nil "No") (topicArchived nil "No") (guid ((isPermaLink . "false")) "discuss.elastic.co-topic-352688") (source ((url . "https://discuss.elastic.co/t/apm-server-8-12-1-security-update-esa-2024-03/352688.rss")) "APM Server 8.12.1 Security Update (ESA-2024-03)")) (item nil (title nil "Elastic Network Drive Connector 8.12.1 Security Update (ESA-2024-02)") (creator nil "rodrigo_silva") (category nil "Security Announcements") (description nil "
            <p><strong>Elastic Network Drive Connector Improper Access Control (ESA-2024-02)</strong></p>
<p>An issue was discovered in the Windows Network Drive Connector when using Document Level Security to assign permissions to a file, with explicit allow write and deny read.</p>
<p>Although the document is not accessible to the user in Network Drive it is visible in search applications to the user.</p>
<p><strong>Affected Versions:</strong><br>
Elastic Network Drive Connector before 8.12.1.</p>
<p><strong>Solutions and Mitigations:</strong><br>
The issue is resolved in Elastic Network Drive Connector v8.12.1 and above</p>
<p><strong>CVSSv3:</strong> 5.3 (Medium) - <a href=\"https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:N/A:N\">CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:N/A:N </a></p>
<p><strong>CVE ID:</strong> CVE-2024-23447</p>
            <p><small>1 post - 1 participant</small></p>
            <p><a href=\"https://discuss.elastic.co/t/elastic-network-drive-connector-8-12-1-security-update-esa-2024-02/352687\">Read full topic</a></p>
          ") (link nil "https://discuss.elastic.co/t/elastic-network-drive-connector-8-12-1-security-update-esa-2024-02/352687") (pubDate nil "Tue, 06 Feb 2024 22:23:09 +0000") (topicPinned nil "No") (topicClosed nil "No") (topicArchived nil "No") (guid ((isPermaLink . "false")) "discuss.elastic.co-topic-352687") (source ((url . "https://discuss.elastic.co/t/elastic-network-drive-connector-8-12-1-security-update-esa-2024-02/352687.rss")) "Elastic Network Drive Connector 8.12.1 Security Update (ESA-2024-02)")) (item nil (title nil "Kibana 8.12.1 Security Update (ESA-2024-01)") (creator nil "rodrigo_silva") (category nil "Security Announcements") (description nil "
            <p><strong>Kibana Broken Access Control issue (ESA-2024-01)</strong></p>
<p>An issue was discovered by Elastic, whereby the Detection Engine Search <a href=\"https://www.elastic.co/guide/en/security/current/signals-api-overview.html\">API</a> does not respect Document-level security (DLS) or Field-level security (FLS) when querying the .alerts-security.alerts-{space_id} indices. Users who are authorized to call this API may obtain unauthorized access to documents if their roles are configured with DLS or FLS against the aforementioned index.</p>
<p><strong>Affected Versions:</strong><br>
Kibana 8.x versions prior to 8.12.1</p>
<p><strong>Affected Configurations:</strong><br>
This issue only affects users that have assigned a role with DLS or FLS configured, users using KPI or group by feature on the alerts page or API users accessing the route directly.</p>
<p><strong>Solutions and Mitigations:</strong><br>
The issue is resolved in version 8.12.1</p>
<p><strong>Severity:</strong> CVSSv3: 6.5 (Medium) - <a href=\"https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N&amp;version=3.1\">AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N</a></p>
<p><strong>CVE ID:</strong> CVE-2024-23446</p>
            <p><small>1 post - 1 participant</small></p>
            <p><a href=\"https://discuss.elastic.co/t/kibana-8-12-1-security-update-esa-2024-01/352686\">Read full topic</a></p>
          ") (link nil "https://discuss.elastic.co/t/kibana-8-12-1-security-update-esa-2024-01/352686") (pubDate nil "Tue, 06 Feb 2024 22:13:13 +0000") (topicPinned nil "No") (topicClosed nil "No") (topicArchived nil "No") (guid ((isPermaLink . "false")) "discuss.elastic.co-topic-352686") (source ((url . "https://discuss.elastic.co/t/kibana-8-12-1-security-update-esa-2024-01/352686.rss")) "Kibana 8.12.1 Security Update (ESA-2024-01)")) (item nil (title nil "Kibana 8.11.2, 7.17.16 Security Update (ESA-2023-27)") (creator nil "ikakavas") (category nil "Security Announcements") (description nil "
            <h1><a name=\"kibana-insertion-of-sensitive-information-into-log-file-esa-2023-27-1\" class=\"anchor\" href=\"https://discuss.elastic.co#kibana-insertion-of-sensitive-information-into-log-file-esa-2023-27-1\"></a>Kibana Insertion of Sensitive Information into Log File (ESA-2023-27)</h1>
<p>An issue was discovered by Elastic whereby sensitive information may be recorded in Kibana logs in the event of an error or in the event where <a href=\"https://www.elastic.co/guide/en/kibana/current/logging-configuration.html#log-level\">debug level logging is enabled in Kibana</a>. Elastic has released Kibana 8.11.2 which resolves this issue. The messages recorded in the log may contain:</p>
<ul>
<li>Account credentials for the <a href=\"https://www.elastic.co/guide/en/elasticsearch/reference/current/built-in-users.html\"><code>kibana_system</code></a> user, API Keys, and credentials of Kibana end-users.</li>
<li>Elastic Security package policy objects which can contain private keys, bearer token, and sessions of 3rd-party integrations.</li>
<li>Authorization headers, client secrets, local file paths, and stack traces</li>
</ul>
<p>The issue may occur in any Kibana instance running an affected version (which are listed below) that could potentially receive an unexpected error when communicating to Elasticsearch causing it to include sensitive data into Kibana error logs. It could also occur under specific circumstances when <a href=\"https://www.elastic.co/guide/en/kibana/current/logging-configuration.html#log-level\">debug level logging is enabled in Kibana</a>.</p>
<p><strong>Note:</strong> It was found that the fix for ESA-2023-25 in Kibana 8.11.1 for a similar issue was incomplete.</p>
<h2><a name=\"affected-versions-2\" class=\"anchor\" href=\"https://discuss.elastic.co#affected-versions-2\"></a>Affected Versions:</h2>
<p>Kibana versions on or after 7.13.0 and before 7.17.16.<br>
Kibana versions on or after 8.0.0 and before 8.11.2.</p>
<h2><a name=\"solutions-and-mitigations-3\" class=\"anchor\" href=\"https://discuss.elastic.co#solutions-and-mitigations-3\"></a>Solutions and Mitigations:</h2>
<p>The issue is resolved in Kibana 8.11.2 and 7.17.16</p>
<h3><a name=\"elastic-cloud-4\" class=\"anchor\" href=\"https://discuss.elastic.co#elastic-cloud-4\"></a>Elastic Cloud</h3>
<p>The following mitigations have been implemented in Elastic Cloud:</p>
<ul>
<li>We have purged sensitive data that was logged from our monitoring environment.</li>
<li>We have adjusted the rulesets of our redaction solution so that no new instances of sensitive information are logged in our monitoring environment and in customer’s monitoring clusters.</li>
</ul>
<p>For Elastic Cloud customers with <strong>self-managed monitoring clusters</strong>, affected logs should be reviewed for any potentially sensitive data and if deemed necessary, follow up actions such as purging sensitive data from logs and rotating any potentially exposed credentials should be performed.</p>
<p>As additional mitigation, Elastic Cloud customers on affected versions of Kibana are advised to upgrade to 8.11.3.</p>
<h3><a name=\"self-managed-5\" class=\"anchor\" href=\"https://discuss.elastic.co#self-managed-5\"></a>Self-Managed</h3>
<p>Users on affected versions of Kibana in self-managed, ECE, or ECK, are advised to upgrade to 8.11.2 or later.</p>
<p>Affected logs should be reviewed for any potentially sensitive data and if deemed necessary,  follow up actions such as purging sensitive data from logs and rotating any potentially exposed credentials should be performed.</p>
<p>For users that cannot upgrade, see the section <em>Preventing Ingest of Sensitive Information</em> for mitigation actions that can be applied.</p>
<h2><a name=\"reviewing-logs-for-sensitive-information-6\" class=\"anchor\" href=\"https://discuss.elastic.co#reviewing-logs-for-sensitive-information-6\"></a>Reviewing Logs for Sensitive Information</h2>
<p>This section describes how to review logs to identify instances of potentially sensitive information in your logs.</p>
<h3><a name=\"elastic-cloud-customers-with-self-managed-monitoring-clusters-7\" class=\"anchor\" href=\"https://discuss.elastic.co#elastic-cloud-customers-with-self-managed-monitoring-clusters-7\"></a>Elastic Cloud customers with self-managed monitoring clusters</h3>
<p>Affected log lines can be identified with the use of the queries described in <em>Appendix A. Search Queries.</em>  against the data views that <a href=\"https://www.elastic.co/guide/en/cloud/current/ec-enable-logging-and-monitoring.html#ec-access-kibana-monitoring\">contain Kibana logs on the monitoring cluster</a></p>
<h3><a name=\"self-managed-with-elastic-stack-monitoring-8\" class=\"anchor\" href=\"https://discuss.elastic.co#self-managed-with-elastic-stack-monitoring-8\"></a>Self-Managed with Elastic Stack Monitoring</h3>
<p>If you are using <a href=\"https://www.elastic.co/guide/en/kibana/current/configuring-monitoring.html\">Elastic Stack to ingest Kibana logs</a>, affected log lines can be identified with the use of the queries that are defined in <em>Appendix A. Search Queries</em> against the data views that contain Kibana logs on the monitoring cluster:</p>
<ul>
<li>If <a href=\"https://www.elastic.co/guide/en/kibana/current/monitoring-elastic-agent.html\">Elastic Agent Collection</a> is configured: <code>logs-kibana.*-default</code></li>
<li>If <a href=\"https://www.elastic.co/guide/en/kibana/current/monitoring-metricbeat.html\">Filebeat Collection</a> is configured: <code>filebeat-{version}</code> , where <code>{version}</code> is the installed Kibana version.</li>
</ul>
<h3><a name=\"self-managed-without-elastic-stack-monitoring-9\" class=\"anchor\" href=\"https://discuss.elastic.co#self-managed-without-elastic-stack-monitoring-9\"></a>Self-Managed without Elastic Stack Monitoring</h3>
<p>If you are not ingesting Kibana logs in the Elastic Stack, you can search the log files on disk for occurrences where the following terms are present:</p>
<ul>
<li>“MaxListenersExceededWarning”, “IncomingMessage”</li>
<li>Any of the following message substrings
<ul>
<li>\"policy info exists as\"</li>
<li>\"package policy exists as\"</li>
<li>\"policy responses exists as\"</li>
<li>\"endpoint metadata exists as\"</li>
<li>\"Trusted Apps\"</li>
<li>\"EP Exceptions\"</li>
<li>\"EP Event Filters\"</li>
<li>\"Value List Meta Data\"</li>
<li>\"Timeline Events\"</li>
</ul>
</li>
<li>\"Preview of field's value\", \"--token\", (\"plugins.securitySolution.ruleExecution\" or  \"plugins.ruleRegistry”)</li>
<li>“error thrown getting the access token”</li>
<li>Any of the following fields
<ul>
<li>\"kibana.usageCounters.results.meta.meta.request.options.headers.authorization\"</li>
<li>\"kibana.usageCounters.results.meta.meta.request.options.headers.X-Elastic-App-Auth\"</li>
<li>\"kibana.usageCounters.results.meta.meta.request.options.headers.x-elastic-app-auth\"</li>
<li>\"kibana.usageCounters.results.meta.meta.request.options.headers.es-client-authentication\"</li>
<li>\"kibana.usageCounters.results.meta.meta.request.options.headers.ES-Client-Authentication\"</li>
<li>\"kibana.usageCounters.results.meta.meta.request.params.headers.authorization\"</li>
<li>\"kibana.usageCounters.results.meta.meta.request.params.headers.X-Elastic-App-Auth\"</li>
<li>\"kibana.usageCounters.results.meta.meta.request.params.headers.x-elastic-app-auth\"</li>
<li>\"kibana.usageCounters.results.meta.meta.request.params.headers.es-client-authentication\"</li>
<li>\"kibana.usageCounters.results.meta.meta.request.params.headers.ES-Client-Authentication\"</li>
<li>\"http.request.headers.authorization\"</li>
<li>\"http.request.headers.x-elastic-app-auth\"</li>
<li>\"http.request.headers.X-Elastic-App-Auth\"</li>
<li>\"http.request.headers.es-client-authentication\"</li>
<li>\"http.request.headers.ES-Client-Authentication\"</li>
<li>\"error.cause.meta.meta.request.options.headers.authorization\"</li>
<li>\"error.cause.meta.meta.request.options.headers.x-elastic-app-auth\"</li>
<li>\"error.cause.meta.meta.request.options.headers.X-Elastic-App-Auth\"</li>
<li>\"error.cause.meta.meta.request.options.headers.es-client-authentication\"</li>
<li>\"error.cause.meta.meta.request.options.headers.ES-Client-Authentication\"</li>
<li>\"meta.meta.request.params.headers.authorization\"</li>
<li>\"meta.meta.request.params.headers.x-elastic-app-auth\"</li>
<li>\"meta.meta.request.params.headers.X-Elastic-App-Auth\"</li>
<li>\"meta.meta.request.params.headers.es-client-authentication\"</li>
<li>\"meta.meta.request.params.headers.ES-Client-Authentication\"</li>
<li>\"meta.meta.request.options.headers.authorization\"</li>
<li>\"meta.meta.request.options.headers.x-elastic-app-auth\"</li>
<li>\"meta.meta.request.options.headers.X-Elastic-App-Auth\"</li>
<li>\"meta.meta.request.options.headers.es-client-authentication\"</li>
<li>\"meta.meta.request.options.headers.ES-Client-Authentication\"</li>
<li>\"left.error.meta.meta.request.params.headers.authorization\"</li>
<li>\"left.error.meta.meta.request.params.headers.x-elastic-app-auth\"</li>
<li>\"left.error.meta.meta.request.params.headers.X-Elastic-App-Auth\"</li>
<li>\"left.error.meta.meta.request.params.headers.es-client-authentication\"</li>
<li>\"left.error.meta.meta.request.params.headers.ES-Client-Authentication\"</li>
<li>\"left.error.meta.meta.request.options.headers.authorization\"</li>
<li>\"left.error.meta.meta.request.options.headers.x-elastic-app-auth\"</li>
<li>\"left.error.meta.meta.request.options.headers.X-Elastic-App-Auth\"</li>
<li>\"left.error.meta.meta.request.options.headers.es-client-authentication\"</li>
<li>\"left.error.meta.meta.request.options.headers.ES-Client-Authentication\"</li>
<li>\"error.originalError.meta.meta.request.params.headers.authorization\"</li>
<li>\"error.originalError.meta.meta.request.params.headers.x-elastic-app-auth\"</li>
<li>\"error.originalError.meta.meta.request.params.headers.X-Elastic-App-Auth\"</li>
<li>\"error.originalError.meta.meta.request.params.headers.es-client-authentication\"</li>
<li>\"error.originalError.meta.meta.request.params.headers.ES-Client-Authentication\"</li>
<li>\"error.originalError.meta.meta.request.options.headers.authorization\"</li>
<li>\"error.originalError.meta.meta.request.options.headers.x-elastic-app-auth\"</li>
<li>\"error.originalError.meta.meta.request.options.headers.X-Elastic-App-Auth\"</li>
<li>\"error.originalError.meta.meta.request.options.headers.es-client-authentication\"</li>
<li>\"error.originalError.meta.meta.request.options.headers.ES-Client-Authentication\"</li>
<li>\"error.meta.meta.request.params.headers.authorization\"</li>
<li>\"error.meta.meta.request.params.headers.x-elastic-app-auth\"</li>
<li>\"error.meta.meta.request.params.headers.X-Elastic-App-Auth\"</li>
<li>\"error.meta.meta.request.params.headers.es-client-authentication\"</li>
<li>\"error.meta.meta.request.params.headers.ES-Client-Authentication\"</li>
<li>\"error.meta.meta.request.options.headers.authorization\"</li>
<li>\"error.meta.meta.request.options.headers.x-elastic-app-auth\"</li>
<li>\"error.meta.meta.request.options.headers.X-Elastic-App-Auth\"</li>
<li>\"error.meta.meta.request.options.headers.es-client-authentication\"</li>
<li>\"error.meta.meta.request.options.headers.ES-Client-Authentication\"</li>
<li>\"error.meta.meta.meta.request.params.headers.authorization\"</li>
<li>\"error.meta.meta.meta.request.params.headers.x-elastic-app-auth\"</li>
<li>\"error.meta.meta.meta.request.params.headers.X-Elastic-App-Auth\"</li>
<li>\"error.meta.meta.meta.request.params.headers.es-client-authentication\"</li>
<li>\"error.meta.meta.meta.request.params.headers.ES-Client-Authentication\"</li>
<li>\"error.meta.meta.meta.request.options.headers.authorization\"</li>
<li>\"error.meta.meta.meta.request.options.headers.x-elastic-app-auth\"</li>
<li>\"error.meta.meta.meta.request.options.headers.X-Elastic-App-Auth\"</li>
<li>\"error.meta.meta.meta.request.options.headers.es-client-authentication\"</li>
<li>\"error.meta.meta.meta.request.options.headers.ES-Client-Authentication\"</li>
<li>\"error.cause.meta.meta.request.params.headers.authorization\"</li>
<li>\"error.cause.meta.meta.request.params.headers.x-elastic-app-auth\"</li>
<li>\"error.cause.meta.meta.request.params.headers.X-Elastic-App-Auth\"</li>
<li>\"error.cause.meta.meta.request.params.headers.es-client-authentication\"</li>
<li>\"error.cause.meta.meta.request.params.headers.ES-Client-Authentication\"</li>
</ul>
</li>
</ul>
<h3><a name=\"ece-10\" class=\"anchor\" href=\"https://discuss.elastic.co#ece-10\"></a>ECE</h3>
<p>On ECE, affected log lines can be identified with the use of the queries that are defined in <em>Appendix A. Search Queries</em> against the <code>cluster-logs-*</code> indices in the <a href=\"https://www.elastic.co/guide/en/cloud-enterprise/current/ece-monitoring-ece-access.html\">logging and metrics cluster</a>.</p>
<h3><a name=\"eck-11\" class=\"anchor\" href=\"https://discuss.elastic.co#eck-11\"></a>ECK</h3>
<p>If <a href=\"https://www.elastic.co/guide/en/cloud-on-k8s/master/k8s-stack-monitoring.html\">Stack Monitoring is enabled</a>, affected log lines can be identified with the use of the queries that are defined in <em>Appendix A. Search Queries</em> against the data views that contain Kibana logs on the monitoring cluster:</p>
<ul>
<li>If <a href=\"https://www.elastic.co/guide/en/kibana/current/monitoring-elastic-agent.html\">Elastic Agent Collection</a> is configured: <code>logs-kibana.*-default</code></li>
<li>If <a href=\"https://www.elastic.co/guide/en/kibana/current/monitoring-metricbeat.html\">Filebeat Collection</a> is configured: <code>filebeat-{version}</code> , where <code>{version}</code> is the installed Kibana version.</li>
</ul>
<h2><a name=\"remediating-sensitive-information-12\" class=\"anchor\" href=\"https://discuss.elastic.co#remediating-sensitive-information-12\"></a>Remediating Sensitive Information</h2>
<p>If the review reveals that credentials have been included in the logs, the following remediation actions are recommended</p>
<div class=\"md-table\">
<table>
<thead>
<tr>
<th>Installation Type</th>
<th>Remediation Actions</th>
</tr>
</thead>
<tbody>
<tr>
<td>Elastic Cloud</td>
<td><code>found-internal-kibana4-server credentials</code> credentials are being rotated by Elastic. End user credentials can be changed using the Management &gt; Users UI in Kibana or the <a href=\"https://www.elastic.co/guide/en/elasticsearch/reference/current/security-api-change-password.html\">Change Password API</a>.</td>
</tr>
<tr>
<td>Archive Docker RPM/DEB</td>
<td>kibana_system credentials can be rotated <a href=\"https://www.elastic.co/guide/en/elasticsearch/reference/current/change-passwords-native-users.html\">using one of the available methods</a> if a native user is used. If service account tokens are used, you need to <a href=\"https://www.elastic.co/guide/en/elasticsearch/reference/8.9/security-api-delete-service-token.html\">delete the logged token</a> and <a href=\"https://www.elastic.co/guide/en/elasticsearch/reference/8.9/security-api-create-service-token.html\">create a new token</a> <br><br>End user credentials can be changed using the Management &gt; Users UI in Kibana or the <a href=\"https://www.elastic.co/guide/en/elasticsearch/reference/current/security-api-change-password.html\">Change Password API</a>.</td>
</tr>
<tr>
<td>ECE</td>
<td><code>found-internal-kibana4-server</code> credentials can be rotated using advanced editor: <br>1. Go to advanced editor<br>2. Find \".resources.kibana[0].plan.cluster_topology[0].kibana.system_settings\" <br>3. Set \"elasticsearch_password\" to a random string <br>4. submit <br><br>End user credentials can be changed using the Management &gt; Users UI in Kibana or the <a href=\"https://www.elastic.co/guide/en/elasticsearch/reference/current/security-api-change-password.html\">Change Password API</a>.</td>
</tr>
<tr>
<td>ECK</td>
<td>Kibana system user credentials <a href=\"https://www.elastic.co/guide/en/cloud-on-k8s/current/k8s-rotate-credentials.html\">can be rotated</a> by either of the following options: <br> - Delete <code>$KIBANA_NAME-kibana-user</code> secret in the Kibana K8s namespace and restart the ECK operator. <br>- Delete <code>$KIBANA_NAME-kibana-user</code> and <code>$NAMESPACE-$KIBANA_NAME-kibana-user</code> secrets in the Kibana K8s namespace <br><br> End user credentials can be changed using the Management &gt; Users UI in Kibana or the <a href=\"https://www.elastic.co/guide/en/elasticsearch/reference/current/security-api-change-password.html\">Change Password API</a>.</td>
</tr>
</tbody>
</table>
</div><h2><a name=\"preventing-ingest-of-sensitive-information-in-logs-13\" class=\"anchor\" href=\"https://discuss.elastic.co#preventing-ingest-of-sensitive-information-in-logs-13\"></a>Preventing Ingest of Sensitive Information in Logs</h2>
<p>For users that cannot upgrade, the following mitigation actions can be applied to prevent ingestion of sensitive information into an elasticsearch logging cluster.</p>
<p>The following mitigations are for customers who have enabled the monitoring features for their clusters as outlined in this <a href=\"https://www.elastic.co/guide/en/kibana/current/configuring-monitoring.html\">guide</a>.</p>
<p>If you are using <a href=\"https://www.elastic.co/guide/en/kibana/current/configuring-monitoring.html\">Elastic Stack to ingest Kibana logs</a>, use ECE, or <a href=\"https://www.elastic.co/guide/en/cloud-on-k8s/master/k8s-stack-monitoring.html\">use ECK with stack monitoring enabled</a> , you can use an <a href=\"https://www.elastic.co/guide/en/elasticsearch/reference/current/ingest.html\">Ingest Pipeline</a> to redact sensitive information from being ingested in a logging cluster.</p>
<ol>
<li>Create the remediation pipeline:</li>
</ol>
<pre><code class=\"lang-auto\">PUT _ingest/pipeline/redact-esa–2023-27
{
 \"description\": \"Prevent Insertion of Sensitive Information into Log File (ESA-2023-27)\",
 \"processors\": [
    {
      \"set\": {
        \"description\": \"Redact credentials in MaxListenersExceededWarning errors message field\",
        \"if\": \"ctx.message != null &amp;&amp; ctx.message.startsWith('MaxListenersExceededWarning') &amp;&amp; ctx.message.contains('IncomingMessage')\",
        \"field\": \"message\",
        \"value\": \"MaxListenersExceededWarning: Possible EventEmitter memory leak detected. There are aborted listeners added to [IncomingMessage]. Use emitter.setMaxListeners() to increase limit\",
        \"ignore_empty_value\": true
      }
    },
    {
      \"set\": {
        \"description\": \"Redact credentials in MaxListenersExceededWarning errors event.original field\",
        \"if\": \"ctx.event.original != null &amp;&amp; ctx.event.original.startsWith('MaxListenersExceededWarning') &amp;&amp; ctx.event.original.contains('IncomingMessage')\",
        \"field\": \"event.original\",
        \"value\": \"MaxListenersExceededWarning: Possible EventEmitter memory leak detected. There are aborted listeners added to [IncomingMessage]. Use emitter.setMaxListeners() to increase limit\",
        \"ignore_empty_value\": true
      }
    },
   {
     \"remove\": {
       \"description\": \"Kibana log record metadata with sensitive HTTP headers\",
       \"field\": [
         \"http.request.headers.authorization\",
         \"http.request.headers.x-elastic-app-auth\",
         \"http.request.headers.X-Elastic-App-Auth\",
         \"http.request.headers.es-client-authentication\",
         \"http.request.headers.ES-Client-Authentication\",
         \"error.cause.meta.meta.request.options.headers.authorization\",
         \"error.cause.meta.meta.request.options.headers.x-elastic-app-auth\",
         \"error.cause.meta.meta.request.options.headers.X-Elastic-App-Auth\",
         \"error.cause.meta.meta.request.options.headers.es-client-authentication\",
         \"error.cause.meta.meta.request.options.headers.ES-Client-Authentication\",
         \"meta.meta.request.params.headers.authorization\",
         \"meta.meta.request.params.headers.x-elastic-app-auth\",
         \"meta.meta.request.params.headers.X-Elastic-App-Auth\",
         \"meta.meta.request.params.headers.es-client-authentication\",
         \"meta.meta.request.params.headers.ES-Client-Authentication\",
         \"meta.meta.request.options.headers.authorization\",
         \"meta.meta.request.options.headers.x-elastic-app-auth\",
         \"meta.meta.request.options.headers.X-Elastic-App-Auth\",
         \"meta.meta.request.options.headers.es-client-authentication\",
         \"meta.meta.request.options.headers.ES-Client-Authentication\",
         \"left.error.meta.meta.request.params.headers.authorization\",
         \"left.error.meta.meta.request.params.headers.x-elastic-app-auth\",
         \"left.error.meta.meta.request.params.headers.X-Elastic-App-Auth\",
         \"left.error.meta.meta.request.params.headers.es-client-authentication\",
         \"left.error.meta.meta.request.params.headers.ES-Client-Authentication\",
         \"left.error.meta.meta.request.options.headers.authorization\",
         \"left.error.meta.meta.request.options.headers.x-elastic-app-auth\",
         \"left.error.meta.meta.request.options.headers.X-Elastic-App-Auth\",
         \"left.error.meta.meta.request.options.headers.es-client-authentication\",
         \"left.error.meta.meta.request.options.headers.ES-Client-Authentication\",
         \"error.originalError.meta.meta.request.params.headers.authorization\",
         \"error.originalError.meta.meta.request.params.headers.x-elastic-app-auth\",
         \"error.originalError.meta.meta.request.params.headers.X-Elastic-App-Auth\",
         \"error.originalError.meta.meta.request.params.headers.es-client-authentication\",
         \"error.originalError.meta.meta.request.params.headers.ES-Client-Authentication\",
         \"error.originalError.meta.meta.request.options.headers.authorization\",
         \"error.originalError.meta.meta.request.options.headers.x-elastic-app-auth\",
         \"error.originalError.meta.meta.request.options.headers.X-Elastic-App-Auth\",
         \"error.originalError.meta.meta.request.options.headers.es-client-authentication\",
         \"error.originalError.meta.meta.request.options.headers.ES-Client-Authentication\",
         \"error.meta.meta.request.params.headers.authorization\",
         \"error.meta.meta.request.params.headers.x-elastic-app-auth\",
         \"error.meta.meta.request.params.headers.X-Elastic-App-Auth\",
         \"error.meta.meta.request.params.headers.es-client-authentication\",
         \"error.meta.meta.request.params.headers.ES-Client-Authentication\",
         \"error.meta.meta.request.options.headers.authorization\",
         \"error.meta.meta.request.options.headers.x-elastic-app-auth\",
         \"error.meta.meta.request.options.headers.X-Elastic-App-Auth\",
         \"error.meta.meta.request.options.headers.es-client-authentication\",
         \"error.meta.meta.request.options.headers.ES-Client-Authentication\",
         \"error.meta.meta.meta.request.params.headers.authorization\",
         \"error.meta.meta.meta.request.params.headers.x-elastic-app-auth\",
         \"error.meta.meta.meta.request.params.headers.X-Elastic-App-Auth\",
         \"error.meta.meta.meta.request.params.headers.es-client-authentication\",
         \"error.meta.meta.meta.request.params.headers.ES-Client-Authentication\",
         \"error.meta.meta.meta.request.options.headers.authorization\",
         \"error.meta.meta.meta.request.options.headers.x-elastic-app-auth\",
         \"error.meta.meta.meta.request.options.headers.X-Elastic-App-Auth\",
         \"error.meta.meta.meta.request.options.headers.es-client-authentication\",
         \"error.meta.meta.meta.request.options.headers.ES-Client-Authentication\",
         \"error.cause.meta.meta.request.params.headers.authorization\",
         \"error.cause.meta.meta.request.params.headers.x-elastic-app-auth\",
         \"error.cause.meta.meta.request.params.headers.X-Elastic-App-Auth\",
         \"error.cause.meta.meta.request.params.headers.es-client-authentication\",
         \"error.cause.meta.meta.request.params.headers.ES-Client-Authentication\"
       ],
       \"ignore_missing\": true
     }
   },
    {
      \"foreach\": {
        \"field\": \"kibana.usageCounters.results\",
        \"processor\": {
          \"remove\": {
            \"field\": [
              \"_ingest._value.meta.meta.request.options.headers.authorization\",
              \"_ingest._value.meta.meta.request.options.headers.X-Elastic-App-Auth\",
              \"_ingest._value.meta.meta.request.options.headers.x-elastic-app-auth\",
              \"_ingest._value.meta.meta.request.options.headers.es-client-authentication\",
              \"_ingest._value.meta.meta.request.options.headers.ES-Client-Authentication\",
              \"_ingest._value.meta.meta.request.params.headers.authorization\",
              \"_ingest._value.meta.meta.request.params.headers.X-Elastic-App-Auth\",
              \"_ingest._value.meta.meta.request.params.headers.x-elastic-app-auth\",
              \"_ingest._value.meta.meta.request.params.headers.es-client-authentication\",
              \"_ingest._value.meta.meta.request.params.headers.ES-Client-Authentication\"
            ],
            \"ignore_missing\": true
          }
        },
        \"ignore_missing\": true
      }
    },
   {
     \"dot_expander\": {
       \"description\": \"Expand 'event.original'\",
       \"field\": \"event.original\"
     }
   },
   {
     \"set\": {
       \"field\": \"message\",
       \"value\": \"policy info exists as [redacted]\",
       \"if\": \"ctx.message != null &amp;&amp; ctx.message.toLowerCase().contains('policy info exists as')\"
     }
   },
   {
     \"set\": {
       \"field\": \"event.original\",
       \"value\": \"policy info exists as [redacted]\",
       \"if\": \"ctx.event.original != null &amp;&amp; ctx.event.original.toLowerCase().contains('policy info exists as')\"
     }
   },
   {
     \"set\": {
       \"field\": \"message\",
       \"value\": \"package policy exists as [redacted]\",
       \"if\": \"ctx.message != null &amp;&amp; ctx.message.toLowerCase().contains('package policy exists as')\"
     }
   },
   {
     \"set\": {
       \"field\": \"event.original\",
       \"value\": \"package policy exists as [redacted]\",
       \"if\": \"ctx.event.original != null &amp;&amp; ctx.event.original.toLowerCase().contains('package policy exists as')\"
     }
   },
   {
     \"set\": {
       \"field\": \"message\",
       \"value\": \"policy responses exists as [redacted]\",
       \"if\": \"ctx.message != null &amp;&amp; ctx.message.toLowerCase().contains('policy responses exists as')\"
     }
   },
   {
     \"set\": {
       \"field\": \"event.original\",
       \"value\": \"policy responses exists as [redacted]\",
       \"if\": \"ctx.event.original != null &amp;&amp; ctx.event.original.toLowerCase().contains('policy responses exists as')\"
     }
   },
   {
     \"set\": {
       \"field\": \"message\",
       \"value\": \"endpoint metadata exists as [redacted]\",
       \"if\": \"ctx.message != null &amp;&amp; ctx.message.toLowerCase().contains('endpoint metadata exists as')\"
     }
   },
   {
     \"set\": {
       \"field\": \"event.original\",
       \"value\": \"endpoint metadata exists as [redacted]\",
       \"if\": \"ctx.event.original != null &amp;&amp; ctx.event.original.toLowerCase().contains('endpoint metadata exists as')\"
     }
   },
   {
     \"set\": {
       \"field\": \"message\",
       \"value\": \"Trusted Apps: [redacted]\",
       \"if\": \"ctx.message != null &amp;&amp; ctx.message.toLowerCase().contains('trusted apps:')\"
     }
   },
   {
     \"set\": {
       \"field\": \"event.original\",
       \"value\": \"Trusted Apps: [redacted]\",
       \"if\": \"ctx.event.original != null &amp;&amp; ctx.event.original.toLowerCase().contains('trusted apps:')\"
     }
   },
   {
     \"set\": {
       \"field\": \"message\",
       \"value\": \"EP Exceptions: [redacted]\",
       \"if\": \"ctx.message != null &amp;&amp; ctx.message.toLowerCase().contains('ep exceptions:')\"
     }
   },
   {
     \"set\": {
       \"field\": \"event.original\",
       \"value\": \"EP Exceptions: [redacted]\",
       \"if\": \"ctx.event.original != null &amp;&amp; ctx.event.original.toLowerCase().contains('ep exceptions:')\"
     }
   },
   {
     \"set\": {
       \"field\": \"message\",
       \"value\": \"EP Event Filters: [redacted]\",
       \"if\": \"ctx.message != null &amp;&amp; ctx.message.toLowerCase().contains('ep event filters:')\"
     }
   },
   {
     \"set\": {
       \"field\": \"event.original\",
       \"value\": \"EP Event Filters: [redacted]\",
       \"if\": \"ctx.event.original != null &amp;&amp; ctx.event.original.toLowerCase().contains('ep event filters:')\"
     }
   },
   {
     \"set\": {
       \"field\": \"message\",
       \"value\": \"Value List Meta Data: [redacted]\",
       \"if\": \"ctx.message != null &amp;&amp; ctx.message.toLowerCase().contains('value list meta data:')\"
     }
   },
   {
     \"set\": {
       \"field\": \"event.original\",
       \"value\": \"Value List Meta Data: [redacted]\",
       \"if\": \"ctx.event.original != null &amp;&amp; ctx.event.original.toLowerCase().contains('value list meta data:')\"
     }
   },
   {
     \"set\": {
       \"field\": \"message\",
       \"value\": \"Timeline Events: [redacted]\",
       \"if\": \"ctx.message != null &amp;&amp; ctx.message.toLowerCase().contains('timeline events:')\"
     }
   },
   {
     \"set\": {
       \"field\": \"event.original\",
       \"value\": \"Timeline Events: [redacted]\",
       \"if\": \"ctx.event.original != null &amp;&amp; ctx.event.original.toLowerCase().contains('timeline events:')\"
     }
   },
   {
     \"set\": {
       \"field\": \"message\",
       \"value\": \"Error decoding JSON: [redacted]\",
       \"if\": \"ctx.message != null &amp;&amp; ctx.error != null &amp;&amp; ctx.error.message != null &amp;&amp; ctx.error.message.toLowerCase().contains('error decoding json') &amp;&amp; ctx.message.toLowerCase().contains('plugins.securitysolution.telemetry_events')\"
     }
   },
   {
     \"set\": {
       \"field\": \"event.original\",
       \"value\": \"Error decoding JSON: [redacted]\",
       \"if\": \"ctx.event.original != null &amp;&amp; ctx.error != null &amp;&amp; ctx.error.message != null &amp;&amp; ctx.error.message.toLowerCase().contains('error decoding json') &amp;&amp; ctx.event.original.toLowerCase().contains('plugins.securitysolution.telemetry_events')\"
     }
   },
   {
     \"set\": {
       \"description\": \"Redacting sensitive info from errors in message field\",
       \"field\": \"message\",
       \"value\": \"error thrown getting the access token [redacted]\",
       \"if\": \"ctx.message != null &amp;&amp; ctx.message.toLowerCase().contains('error thrown getting the access token')\"
     }
   },
   {
     \"set\": {
       \"description\": \"Redacting sensitive info from errors in event.original field\",
       \"field\": \"event.original\",
       \"value\": \"error thrown getting the access token [redacted]\",
       \"if\": \"ctx.event.original != null &amp;&amp; ctx.event.original.toLowerCase().contains('error thrown getting the access token')\"
     }
   },
   {
     \"set\": {
       \"description\": \"Redacting sensitive info from message field in Security Solution RuleExecution or RuleRegistry docs\",
       \"field\": \"message\",
       \"value\": \"[redacted]\",
       \"if\": \"ctx.log.logger != null &amp;&amp; ctx.message != null &amp;&amp; (ctx.log.logger.toLowerCase() == 'plugins.securitySolution.ruleexecution' || ctx.log.logger.toLowerCase() == 'plugins.ruleregistry') &amp;&amp; ctx.message.toLowerCase().contains('preview of field\\\\'s value')\"
     }
   },
   {
     \"set\": {
       \"description\": \"Redacting sensitive info from event.original field in Security Solution RuleExecution or RuleRegistry docs\",
       \"field\": \"event.original\",
       \"value\": \"[redacted]\",
       \"if\": \"ctx.log.logger != null &amp;&amp; ctx.event.original != null &amp;&amp; (ctx.log.logger.toLowerCase() == 'plugins.securitySolution.ruleexecution' || ctx.log.logger.toLowerCase() == 'plugins.ruleregistry') &amp;&amp; ctx.event.original.toLowerCase().contains('preview of field\\\\'s value')\"
     }
   },
   {
     \"set\": {
       \"description\": \"Redacting sensitive info from error.stack_trace field in Security Solution RuleExecution or RuleRegistry docs\",
       \"field\": \"error.stack_trace\",
       \"value\": \"[redacted]\",
       \"if\": \"ctx.log.logger != null &amp;&amp; ctx.error != null &amp;&amp; ctx.error.stack_trace != null &amp;&amp; (ctx.log.logger.toLowerCase() == 'plugins.securitySolution.ruleexecution' || ctx.log.logger.toLowerCase() == 'plugins.ruleregistry') &amp;&amp; ctx.error.stack_trace.toLowerCase().contains('preview of field\\\\'s value')\"
     }
   },
   {
     \"set\": {
       \"description\": \"Redacting sensitive info from error.message field in Security Solution RuleExecution or RuleRegistry docs\",
       \"field\": \"error.message\",
       \"value\": \"[redacted]\",
       \"if\": \"ctx.log.logger != null &amp;&amp; ctx.error != null &amp;&amp; ctx.error.message != null &amp;&amp; (ctx.log.logger.toLowerCase() == 'plugins.securitySolution.ruleexecution' || ctx.log.logger.toLowerCase() == 'plugins.ruleregistry') &amp;&amp; ctx.error.message.toLowerCase().contains('preview of field\\\\'s value')\"
     }
   }
 ]
}
</code></pre>
<ol start=\"2\">
<li>
<p>Identify the indexes or datastreams that your Kibana logs are being ingested into.</p>
</li>
<li>
<p>Identify whether these indices have a default pipeline configured by checking for the index.default_pipeline setting on the indices themselves and the templates.<br>
a. If the indices DO NOT configure a default pipeline:</p>
<ul>
<li>Configure the template to add the <code>index.default_pipeline</code> setting pointing to the example <code>redact-esa-2023-27</code> pipeline.</li>
<li>Update the settings of any existing indices to use <code>index.default_pipeline: redact-esa-2023-27</code>.</li>
</ul>
<p>b. If the indices DO configure a default pipeline:</p>
<ul>
<li>Identify the name of the pipeline from the setting.</li>
<li><code>GET /_ingest/pipeline/{pipeline_name}</code></li>
<li>Add the processor <code>redact-esa-2023-27</code> as an additional <a href=\"https://www.elastic.co/guide/en/elasticsearch/reference/current/pipeline-processor.html\">pipeline processor</a> to the body of the default pipeline</li>
<li>Use <a href=\"https://www.elastic.co/guide/en/elasticsearch/reference/current/put-pipeline-api.html\">PUT _ingest/pipeline API</a> to update the default pipeline to the new configuration</li>
</ul>
<pre><code class=\"lang-auto\">...
{
  \"pipeline\": {
    \"name\": \"redact-esa-2023-27\"
  }
}
…
</code></pre>
</li>
</ol>
<p>The instructions above give API usage examples. Custom pipelines can also be edited using the Ingest Pipelines UI. See <a href=\"https://www.elastic.co/guide/en/fleet/8.11/data-streams-pipeline-tutorial.html\" class=\"inline-onebox\">Tutorial: Transform data with custom ingest pipelines | Fleet and Elastic Agent Guide [8.11] | Elastic</a></p>
<h3><a name=\"self-managed-without-elastic-stack-monitoring-14\" class=\"anchor\" href=\"https://discuss.elastic.co#self-managed-without-elastic-stack-monitoring-14\"></a>Self-Managed without Elastic Stack Monitoring</h3>
<p>If you are not ingesting Kibana logs in the Elastic Stack, you should limit access to the directory where Kibana log files are stored.</p>
<h3><a name=\"ece-logging-cluster-instructions-15\" class=\"anchor\" href=\"https://discuss.elastic.co#ece-logging-cluster-instructions-15\"></a>ECE logging cluster instructions</h3>
<p>This assumes the above ingest pipeline (<code>redact-esa–2023-27</code>) has been created in the logging cluster as described above.</p>
<p>By default the ECE logging cluster ships with a single template for the <code>cluster-logs-*</code> indices and:</p>
<ul>
<li>It does not have a “settings.default_pipeline”</li>
<li>There are no other templates with <code>“GET”</code></li>
</ul>
<p>You should confirm this remains the case for you (<code>“GET _template/cluster-logs-*”</code>, look for <code>“default_pipeline”</code>) and (<code>“GET _template/”</code>, compare the <code>“index_patterns”</code> fields) respectively, and contact support if there are.</p>
<p>Otherwise, you will then create an overlapping template just specifying the ingest pipeline:</p>
<pre><code class=\"lang-auto\">PUT _template/cluster-logs-esa–2023-27-redaction
{
  \"index_patterns\" : [\"cluster-logs-*\"],
  \"order\" : 99,
  \"settings\": {\"default_pipeline\": \"redact-esa–2023-27\"}
}
</code></pre>
<p>The next time the index rolls over, the message field will be replaced by <code>“[redacted]”</code> for offending messages. You should then redact sensitive information from already ingested logs as described below.</p>
<h2><a name=\"redacting-sensitive-information-already-ingested-in-logs-16\" class=\"anchor\" href=\"https://discuss.elastic.co#redacting-sensitive-information-already-ingested-in-logs-16\"></a>Redacting Sensitive Information already ingested in logs</h2>
<p>The same Ingest Pipeline can be used in conjunction with the <a href=\"https://www.elastic.co/guide/en/elasticsearch/reference/current/docs-update-by-query.html\">Update By Query API</a> in order to redact already recorded sensitive information in logs. This is applicable for all deployments which includes: Elastic Cloud customers with self-managed monitoring clusters, Self-Managed, ECE, ECK.</p>
<p>Repeat the following Updaye By Queries for all Kibana logging indices that contain sensitive information.</p>
<h3><a name=\"update-query-1-17\" class=\"anchor\" href=\"https://discuss.elastic.co#update-query-1-17\"></a>Update Query <span class=\"hashtag-raw\">#1</span></h3>
<pre><code class=\"lang-auto\">POST /&lt;insert_indices_patterns_here&gt;/_update_by_query?pipeline=redact-esa–2023-27&amp;pretty=true&amp;allow_no_indices=false&amp;wait_for_completion=false&amp;expand_wildcards=all&amp;conflicts=proceed
{
  \"query\": {
    \"bool\": {
      \"must\": [
        {\"match\": {\"message\": \"MaxListenersExceededWarning\"}},
        {\"match\": {\"message\": \"IncomingMessage\"}}
      ],
   \"must_not\" : [
      { \"term\": { \"_tier\": { \"value\": \"data_frozen\" } } }
   ]
    }
  }
}
</code></pre>
<p>##<span class=\"hashtag-raw\">#Update</span> Query <span class=\"hashtag-raw\">#2</span></p>
<pre><code class=\"lang-auto\">POST /&lt;insert_indices_patterns_here&gt;/_update_by_query?pipeline=redact-esa–2023-27&amp;pretty=true&amp;allow_no_indices=false&amp;wait_for_completion=false&amp;expand_wildcards=all&amp;conflicts=proceed
{
  \"query\": {
    \"bool\": {
    \"must_not\" : [
      { \"term\": { \"_tier\": { \"value\": \"data_frozen\" } } }
   ],
      \"should\": [
        { \"exists\": { \"field\": \"kibana.usageCounters.results.meta.meta.request.options.headers.authorization\"}},
        { \"exists\": { \"field\": \"kibana.usageCounters.results.meta.meta.request.options.headers.X-Elastic-App-Auth\"}},
        { \"exists\": { \"field\": \"kibana.usageCounters.results.meta.meta.request.options.headers.x-elastic-app-auth\"}},
        { \"exists\": { \"field\": \"kibana.usageCounters.results.meta.meta.request.options.headers.es-client-authentication\"}},
        { \"exists\": { \"field\": \"kibana.usageCounters.results.meta.meta.request.options.headers.ES-Client-Authentication\"}},
        { \"exists\": { \"field\": \"kibana.usageCounters.results.meta.meta.request.params.headers.authorization\"}},
        { \"exists\": { \"field\": \"kibana.usageCounters.results.meta.meta.request.params.headers.X-Elastic-App-Auth\"}},
        { \"exists\": { \"field\": \"kibana.usageCounters.results.meta.meta.request.params.headers.x-elastic-app-auth\"}},
        { \"exists\": { \"field\": \"kibana.usageCounters.results.meta.meta.request.params.headers.es-client-authentication\"}},
        { \"exists\": { \"field\": \"kibana.usageCounters.results.meta.meta.request.params.headers.ES-Client-Authentication\"}}
      ],
      \"minimum_should_match\": 1
    }
  }
}
</code></pre>
<h3><a name=\"update-query-3-18\" class=\"anchor\" href=\"https://discuss.elastic.co#update-query-3-18\"></a>Update Query <span class=\"hashtag-raw\">#3</span></h3>
<pre><code class=\"lang-auto\">POST /&lt;insert_indices_patterns_here&gt;/_update_by_query?pipeline=redact-esa–2023-27&amp;pretty=true&amp;allow_no_indices=false&amp;wait_for_completion=false&amp;expand_wildcards=all&amp;conflicts=proceed
{
  \"query\": {
    \"bool\": {
         \"must_not\" : [
      { \"term\": { \"_tier\": { \"value\": \"data_frozen\" } } }
   ],
      \"should\": [
        { \"match\": { \"message\": \"policy info exists as\"}},
        { \"match\": { \"message\": \"package policy exists as\"}},
        { \"match\": { \"message\": \"policy responses exists as\"}},
        { \"match\": { \"message\": \"endpoint metadata exists as\"}},
        { \"match\": { \"message\": \"trusted apps:\"}},
        { \"match\": { \"message\": \"ep exceptions:\"}},
        { \"match\": { \"message\": \"ep event filters:\"}},
        { \"match\": { \"message\": \"value list meta data:\"}},
        { \"match\": { \"message\": \"timeline events:\"}}
      ],
      \"minimum_should_match\": 1
    }
  }
}
</code></pre>
<h3><a name=\"update-query-4-19\" class=\"anchor\" href=\"https://discuss.elastic.co#update-query-4-19\"></a>Update Query <span class=\"hashtag-raw\">#4</span></h3>
<pre><code class=\"lang-auto\">POST /&lt;insert_indices_patterns_here&gt;/_update_by_query?pipeline=redact-esa–2023-27&amp;pretty=true&amp;allow_no_indices=false&amp;wait_for_completion=false&amp;expand_wildcards=all&amp;conflicts=proceed
{
  \"query\": {
    \"bool\": {
    \"must_not\" : [
      { \"term\": { \"_tier\": { \"value\": \"data_frozen\" } } }
   ],
      \"must\": [
        {\"match\": {\"message\": \"Preview of field's value\"}},
        {\"match\": {\"message\": \"--token\"}}
      ],
      \"should\": [
        {\"match\": {\"log.logger\": \"plugins.securitySolution.ruleExecution\"}},
        {\"match\": {\"log.logger\": \"plugins.ruleRegistry\"}}
      ],
      \"minimum_should_match\": 1
    }
  }
}
</code></pre>
<h3><a name=\"update-query-5-20\" class=\"anchor\" href=\"https://discuss.elastic.co#update-query-5-20\"></a>Update Query <span class=\"hashtag-raw\">#5</span></h3>
<pre><code class=\"lang-auto\">POST /&lt;insert_indices_patterns_here&gt;/_update_by_query?pipeline=redact-esa–2023-27&amp;pretty=true&amp;allow_no_indices=false&amp;wait_for_completion=false&amp;expand_wildcards=all&amp;conflicts=proceed
{
  \"query\": {
    \"bool\": {
     \"must_not\" : [
      { \"term\": { \"_tier\": { \"value\": \"data_frozen\" } } }
   ],
      \"must\": [
        {\"match_phrase\": {\"message\": \"error thrown getting the access token\"}}
      ]
    }
  }
}
</code></pre>
<h3><a name=\"update-query-6-21\" class=\"anchor\" href=\"https://discuss.elastic.co#update-query-6-21\"></a>Update Query <span class=\"hashtag-raw\">#6</span></h3>
<pre><code class=\"lang-auto\">POST /&lt;insert_indices_patterns_here&gt;/_update_by_query?pipeline=redact-esa–2023-27&amp;pretty=true&amp;allow_no_indices=false&amp;wait_for_completion=false&amp;expand_wildcards=all&amp;conflicts=proceed
{
  \"query\": {
    \"bool\": {
     \"must_not\" : [
      { \"term\": { \"_tier\": { \"value\": \"data_frozen\" } } }
   ],
      \"should\": [
        {\"exists\": {\"field\": \"http.request.headers.authorization\"}},
        {\"exists\": {\"field\": \"http.request.headers.x-elastic-app-auth\"}},
        {\"exists\": {\"field\": \"http.request.headers.X-Elastic-App-Auth\"}},
        {\"exists\": {\"field\": \"http.request.headers.es-client-authentication\"}},
        {\"exists\": {\"field\": \"http.request.headers.ES-Client-Authentication\"}},
        {\"exists\": {\"field\": \"error.cause.meta.meta.request.options.headers.authorization\"}},
        {\"exists\": {\"field\": \"error.cause.meta.meta.request.options.headers.x-elastic-app-auth\"}},
        {\"exists\": {\"field\": \"error.cause.meta.meta.request.options.headers.X-Elastic-App-Auth\"}},
        {\"exists\": {\"field\": \"error.cause.meta.meta.request.options.headers.es-client-authentication\"}},
        {\"exists\": {\"field\": \"error.cause.meta.meta.request.options.headers.ES-Client-Authentication\"}},
        {\"exists\": {\"field\": \"meta.meta.request.params.headers.authorization\"}},
        {\"exists\": {\"field\": \"meta.meta.request.params.headers.x-elastic-app-auth\"}},
        {\"exists\": {\"field\": \"meta.meta.request.params.headers.X-Elastic-App-Auth\"}},
        {\"exists\": {\"field\": \"meta.meta.request.params.headers.es-client-authentication\"}},
        {\"exists\": {\"field\": \"meta.meta.request.params.headers.ES-Client-Authentication\"}},
        {\"exists\": {\"field\": \"meta.meta.request.options.headers.authorization\"}},
        {\"exists\": {\"field\": \"meta.meta.request.options.headers.x-elastic-app-auth\"}},
        {\"exists\": {\"field\": \"meta.meta.request.options.headers.X-Elastic-App-Auth\"}},
        {\"exists\": {\"field\": \"meta.meta.request.options.headers.es-client-authentication\"}},
        {\"exists\": {\"field\": \"meta.meta.request.options.headers.ES-Client-Authentication\"}},
        {\"exists\": {\"field\": \"left.error.meta.meta.request.params.headers.authorization\"}},
        {\"exists\": {\"field\": \"left.error.meta.meta.request.params.headers.x-elastic-app-auth\"}},
        {\"exists\": {\"field\": \"left.error.meta.meta.request.params.headers.X-Elastic-App-Auth\"}},
        {\"exists\": {\"field\": \"left.error.meta.meta.request.params.headers.es-client-authentication\"}},
        {\"exists\": {\"field\": \"left.error.meta.meta.request.params.headers.ES-Client-Authentication\"}},
        {\"exists\": {\"field\": \"left.error.meta.meta.request.options.headers.authorization\"}},
        {\"exists\": {\"field\": \"left.error.meta.meta.request.options.headers.x-elastic-app-auth\"}},
        {\"exists\": {\"field\": \"left.error.meta.meta.request.options.headers.X-Elastic-App-Auth\"}},
        {\"exists\": {\"field\": \"left.error.meta.meta.request.options.headers.es-client-authentication\"}},
        {\"exists\": {\"field\": \"left.error.meta.meta.request.options.headers.ES-Client-Authentication\"}},
        {\"exists\": {\"field\": \"error.originalError.meta.meta.request.params.headers.authorization\"}},
        {\"exists\": {\"field\": \"error.originalError.meta.meta.request.params.headers.x-elastic-app-auth\"}},
        {\"exists\": {\"field\": \"error.originalError.meta.meta.request.params.headers.X-Elastic-App-Auth\"}},
        {\"exists\": {\"field\": \"error.originalError.meta.meta.request.params.headers.es-client-authentication\"}},
        {\"exists\": {\"field\": \"error.originalError.meta.meta.request.params.headers.ES-Client-Authentication\"}},
        {\"exists\": {\"field\": \"error.originalError.meta.meta.request.options.headers.authorization\"}},
        {\"exists\": {\"field\": \"error.originalError.meta.meta.request.options.headers.x-elastic-app-auth\"}},
        {\"exists\": {\"field\": \"error.originalError.meta.meta.request.options.headers.X-Elastic-App-Auth\"}},
        {\"exists\": {\"field\": \"error.originalError.meta.meta.request.options.headers.es-client-authentication\"}},
        {\"exists\": {\"field\": \"error.originalError.meta.meta.request.options.headers.ES-Client-Authentication\"}},
        {\"exists\": {\"field\": \"error.meta.meta.request.params.headers.authorization\"}},
        {\"exists\": {\"field\": \"error.meta.meta.request.params.headers.x-elastic-app-auth\"}},
        {\"exists\": {\"field\": \"error.meta.meta.request.params.headers.X-Elastic-App-Auth\"}},
        {\"exists\": {\"field\": \"error.meta.meta.request.params.headers.es-client-authentication\"}},
        {\"exists\": {\"field\": \"error.meta.meta.request.params.headers.ES-Client-Authentication\"}},
        {\"exists\": {\"field\": \"error.meta.meta.request.options.headers.authorization\"}},
        {\"exists\": {\"field\": \"error.meta.meta.request.options.headers.x-elastic-app-auth\"}},
        {\"exists\": {\"field\": \"error.meta.meta.request.options.headers.X-Elastic-App-Auth\"}},
        {\"exists\": {\"field\": \"error.meta.meta.request.options.headers.es-client-authentication\"}},
        {\"exists\": {\"field\": \"error.meta.meta.request.options.headers.ES-Client-Authentication\"}},
        {\"exists\": {\"field\": \"error.meta.meta.meta.request.params.headers.authorization\"}},
        {\"exists\": {\"field\": \"error.meta.meta.meta.request.params.headers.x-elastic-app-auth\"}},
        {\"exists\": {\"field\": \"error.meta.meta.meta.request.params.headers.X-Elastic-App-Auth\"}},
        {\"exists\": {\"field\": \"error.meta.meta.meta.request.params.headers.es-client-authentication\"}},
        {\"exists\": {\"field\": \"error.meta.meta.meta.request.params.headers.ES-Client-Authentication\"}},
        {\"exists\": {\"field\": \"error.meta.meta.meta.request.options.headers.authorization\"}},
        {\"exists\": {\"field\": \"error.meta.meta.meta.request.options.headers.x-elastic-app-auth\"}},
        {\"exists\": {\"field\": \"error.meta.meta.meta.request.options.headers.X-Elastic-App-Auth\"}},
        {\"exists\": {\"field\": \"error.meta.meta.meta.request.options.headers.es-client-authentication\"}},
        {\"exists\": {\"field\": \"error.meta.meta.meta.request.options.headers.ES-Client-Authentication\"}},
        {\"exists\": {\"field\": \"error.cause.meta.meta.request.params.headers.authorization\"}},
        {\"exists\": {\"field\": \"error.cause.meta.meta.request.params.headers.x-elastic-app-auth\"}},
        {\"exists\": {\"field\": \"error.cause.meta.meta.request.params.headers.X-Elastic-App-Auth\"}},
        {\"exists\": {\"field\": \"error.cause.meta.meta.request.params.headers.es-client-authentication\"}},
        {\"exists\": {\"field\": \"error.cause.meta.meta.request.params.headers.ES-Client-Authentication\"}}
      ],
      \"minimum_should_match\": 1
    }
  }
}
</code></pre>
<p>To check that the update_by_query task completes successfully:</p>
<pre><code class=\"lang-auto\">GET /_tasks/{taskId from above request}
</code></pre>
<p>—</p>
<p><strong>Severity:</strong> CVSSv3.1, 8.0 (High) <a href=\"https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:A/AC:H/PR:L/UI:N/S:C/C:H/I:H/A:H\">AV:A/AC:H/PR:L/UI:N/S:C/C:H/I:H/A:H</a><br>
<strong>CVE ID:</strong> CVE-2023-46675</p>
<h2><a name=\"appendix-22\" class=\"anchor\" href=\"https://discuss.elastic.co#appendix-22\"></a>Appendix</h2>
<h3><a name=\"a-search-queries-23\" class=\"anchor\" href=\"https://discuss.elastic.co#a-search-queries-23\"></a>A. Search Queries</h3>
<pre><code class=\"lang-auto\">GET /&lt;insert_indices_patterns_here&gt;/_search
{
  \"query\": {
    \"bool\": {
      \"must\": [
        {\"match\": {\"message\": \"MaxListenersExceededWarning\"}},
        {\"match\": {\"message\": \"IncomingMessage\"}}
      ]
    }
  }
}
</code></pre>
<pre><code class=\"lang-auto\">GET /&lt;insert_indices_patterns_here&gt;/_search 
{
  \"query\": {
    \"bool\": { 
      \"should\": [
        { \"exists\": { \"field\": \"kibana.usageCounters.results.meta.meta.request.options.headers.authorization\"}},
        { \"exists\": { \"field\": \"kibana.usageCounters.results.meta.meta.request.options.headers.X-Elastic-App-Auth\"}},
        { \"exists\": { \"field\": \"kibana.usageCounters.results.meta.meta.request.options.headers.x-elastic-app-auth\"}},
        { \"exists\": { \"field\": \"kibana.usageCounters.results.meta.meta.request.options.headers.es-client-authentication\"}},
        { \"exists\": { \"field\": \"kibana.usageCounters.results.meta.meta.request.options.headers.ES-Client-Authentication\"}},
        { \"exists\": { \"field\": \"kibana.usageCounters.results.meta.meta.request.params.headers.authorization\"}},
        { \"exists\": { \"field\": \"kibana.usageCounters.results.meta.meta.request.params.headers.X-Elastic-App-Auth\"}},
        { \"exists\": { \"field\": \"kibana.usageCounters.results.meta.meta.request.params.headers.x-elastic-app-auth\"}},
        { \"exists\": { \"field\": \"kibana.usageCounters.results.meta.meta.request.params.headers.es-client-authentication\"}},
        { \"exists\": { \"field\": \"kibana.usageCounters.results.meta.meta.request.params.headers.ES-Client-Authentication\"}}
      ],
      \"minimum_should_match\": 1
    }
  }
}
</code></pre>
<pre><code class=\"lang-auto\">GET /&lt;insert_indices_patterns_here&gt;/_search
{
  \"query\": {
    \"bool\": {
      \"should\": [
        { \"match\": { \"message\": \"policy info exists as\"}},
        { \"match\": { \"message\": \"package policy exists as\"}},
        { \"match\": { \"message\": \"policy responses exists as\"}},
        { \"match\": { \"message\": \"endpoint metadata exists as\"}},
        { \"match\": { \"message\": \"trusted apps:\"}},
        { \"match\": { \"message\": \"ep exceptions:\"}},
        { \"match\": { \"message\": \"ep event filters:\"}},
        { \"match\": { \"message\": \"value list meta data:\"}},
        { \"match\": { \"message\": \"timeline events:\"}}
      ],
      \"minimum_should_match\": 1
    }
  }
}
</code></pre>
<pre><code class=\"lang-auto\">GET /&lt;insert_indices_patterns_here&gt;/_search
{
  \"query\": {
    \"bool\": {
      \"must\": [
        {\"match\": {\"message\": \"Preview of field's value\"}},
        {\"match\": {\"message\": \"--token\"}}
      ],
      \"should\": [
        {\"match\": {\"log.logger\": \"plugins.securitySolution.ruleExecution\"}},
        {\"match\": {\"log.logger\": \"plugins.ruleRegistry\"}}
      ],
      \"minimum_should_match\": 1
    }
  }
}
</code></pre>
<pre><code class=\"lang-auto\">GET /&lt;insert_indices_patterns_here&gt;/_search
{
  \"query\": {
    \"bool\": {
      \"must\": [
        {\"match\": {
          \"log.logger\": \"plugins.actions.email\"
        }},
        {\"match\": {
          \"message\": \"token\"
        }}
      ]
    }
  }
}
</code></pre>
<pre><code class=\"lang-auto\">GET /&lt;insert_indices_patterns_here&gt;/_search
{
  \"query\": {
    \"bool\": {
      \"should\": [
        {\"exists\": {\"field\": \"http.request.headers.authorization\"}},
        {\"exists\": {\"field\": \"http.request.headers.x-elastic-app-auth\"}},
        {\"exists\": {\"field\": \"http.request.headers.X-Elastic-App-Auth\"}},
        {\"exists\": {\"field\": \"http.request.headers.es-client-authentication\"}},
        {\"exists\": {\"field\": \"http.request.headers.ES-Client-Authentication\"}},
        {\"exists\": {\"field\": \"error.cause.meta.meta.request.options.headers.authorization\"}},
        {\"exists\": {\"field\": \"error.cause.meta.meta.request.options.headers.x-elastic-app-auth\"}},
        {\"exists\": {\"field\": \"error.cause.meta.meta.request.options.headers.X-Elastic-App-Auth\"}},
        {\"exists\": {\"field\": \"error.cause.meta.meta.request.options.headers.es-client-authentication\"}},
        {\"exists\": {\"field\": \"error.cause.meta.meta.request.options.headers.ES-Client-Authentication\"}},
        {\"exists\": {\"field\": \"meta.meta.request.params.headers.authorization\"}},
        {\"exists\": {\"field\": \"meta.meta.request.params.headers.x-elastic-app-auth\"}},
        {\"exists\": {\"field\": \"meta.meta.request.params.headers.X-Elastic-App-Auth\"}},
        {\"exists\": {\"field\": \"meta.meta.request.params.headers.es-client-authentication\"}},
        {\"exists\": {\"field\": \"meta.meta.request.params.headers.ES-Client-Authentication\"}},
        {\"exists\": {\"field\": \"meta.meta.request.options.headers.authorization\"}},
        {\"exists\": {\"field\": \"meta.meta.request.options.headers.x-elastic-app-auth\"}},
        {\"exists\": {\"field\": \"meta.meta.request.options.headers.X-Elastic-App-Auth\"}},
        {\"exists\": {\"field\": \"meta.meta.request.options.headers.es-client-authentication\"}},
        {\"exists\": {\"field\": \"meta.meta.request.options.headers.ES-Client-Authentication\"}},
        {\"exists\": {\"field\": \"left.error.meta.meta.request.params.headers.authorization\"}},
        {\"exists\": {\"field\": \"left.error.meta.meta.request.params.headers.x-elastic-app-auth\"}},
        {\"exists\": {\"field\": \"left.error.meta.meta.request.params.headers.X-Elastic-App-Auth\"}},
        {\"exists\": {\"field\": \"left.error.meta.meta.request.params.headers.es-client-authentication\"}},
        {\"exists\": {\"field\": \"left.error.meta.meta.request.params.headers.ES-Client-Authentication\"}},
        {\"exists\": {\"field\": \"left.error.meta.meta.request.options.headers.authorization\"}},
        {\"exists\": {\"field\": \"left.error.meta.meta.request.options.headers.x-elastic-app-auth\"}},
        {\"exists\": {\"field\": \"left.error.meta.meta.request.options.headers.X-Elastic-App-Auth\"}},
        {\"exists\": {\"field\": \"left.error.meta.meta.request.options.headers.es-client-authentication\"}},
        {\"exists\": {\"field\": \"left.error.meta.meta.request.options.headers.ES-Client-Authentication\"}},
        {\"exists\": {\"field\": \"error.originalError.meta.meta.request.params.headers.authorization\"}},
        {\"exists\": {\"field\": \"error.originalError.meta.meta.request.params.headers.x-elastic-app-auth\"}},
        {\"exists\": {\"field\": \"error.originalError.meta.meta.request.params.headers.X-Elastic-App-Auth\"}},
        {\"exists\": {\"field\": \"error.originalError.meta.meta.request.params.headers.es-client-authentication\"}},
        {\"exists\": {\"field\": \"error.originalError.meta.meta.request.params.headers.ES-Client-Authentication\"}},
        {\"exists\": {\"field\": \"error.originalError.meta.meta.request.options.headers.authorization\"}},
        {\"exists\": {\"field\": \"error.originalError.meta.meta.request.options.headers.x-elastic-app-auth\"}},
        {\"exists\": {\"field\": \"error.originalError.meta.meta.request.options.headers.X-Elastic-App-Auth\"}},
        {\"exists\": {\"field\": \"error.originalError.meta.meta.request.options.headers.es-client-authentication\"}},
        {\"exists\": {\"field\": \"error.originalError.meta.meta.request.options.headers.ES-Client-Authentication\"}},
        {\"exists\": {\"field\": \"error.meta.meta.request.params.headers.authorization\"}},
        {\"exists\": {\"field\": \"error.meta.meta.request.params.headers.x-elastic-app-auth\"}},
        {\"exists\": {\"field\": \"error.meta.meta.request.params.headers.X-Elastic-App-Auth\"}},
        {\"exists\": {\"field\": \"error.meta.meta.request.params.headers.es-client-authentication\"}},
        {\"exists\": {\"field\": \"error.meta.meta.request.params.headers.ES-Client-Authentication\"}},
        {\"exists\": {\"field\": \"error.meta.meta.request.options.headers.authorization\"}},
        {\"exists\": {\"field\": \"error.meta.meta.request.options.headers.x-elastic-app-auth\"}},
        {\"exists\": {\"field\": \"error.meta.meta.request.options.headers.X-Elastic-App-Auth\"}},
        {\"exists\": {\"field\": \"error.meta.meta.request.options.headers.es-client-authentication\"}},
        {\"exists\": {\"field\": \"error.meta.meta.request.options.headers.ES-Client-Authentication\"}},
        {\"exists\": {\"field\": \"error.meta.meta.meta.request.params.headers.authorization\"}},
        {\"exists\": {\"field\": \"error.meta.meta.meta.request.params.headers.x-elastic-app-auth\"}},
        {\"exists\": {\"field\": \"error.meta.meta.meta.request.params.headers.X-Elastic-App-Auth\"}},
        {\"exists\": {\"field\": \"error.meta.meta.meta.request.params.headers.es-client-authentication\"}},
        {\"exists\": {\"field\": \"error.meta.meta.meta.request.params.headers.ES-Client-Authentication\"}},
        {\"exists\": {\"field\": \"error.meta.meta.meta.request.options.headers.authorization\"}},
        {\"exists\": {\"field\": \"error.meta.meta.meta.request.options.headers.x-elastic-app-auth\"}},
        {\"exists\": {\"field\": \"error.meta.meta.meta.request.options.headers.X-Elastic-App-Auth\"}},
        {\"exists\": {\"field\": \"error.meta.meta.meta.request.options.headers.es-client-authentication\"}},
        {\"exists\": {\"field\": \"error.meta.meta.meta.request.options.headers.ES-Client-Authentication\"}},
        {\"exists\": {\"field\": \"error.cause.meta.meta.request.params.headers.authorization\"}},
        {\"exists\": {\"field\": \"error.cause.meta.meta.request.params.headers.x-elastic-app-auth\"}},
        {\"exists\": {\"field\": \"error.cause.meta.meta.request.params.headers.X-Elastic-App-Auth\"}},
        {\"exists\": {\"field\": \"error.cause.meta.meta.request.params.headers.es-client-authentication\"}},
        {\"exists\": {\"field\": \"error.cause.meta.meta.request.params.headers.ES-Client-Authentication\"}}
      ],
      \"minimum_should_match\": 1
    }
  }
}
</code></pre>
            <p><small>2 posts - 1 participant</small></p>
            <p><a href=\"https://discuss.elastic.co/t/kibana-8-11-2-7-17-16-security-update-esa-2023-27/349182\">Read full topic</a></p>
          ") (link nil "https://discuss.elastic.co/t/kibana-8-11-2-7-17-16-security-update-esa-2023-27/349182") (pubDate nil "Tue, 12 Dec 2023 17:23:12 +0000") (topicPinned nil "No") (topicClosed nil "No") (topicArchived nil "No") (guid ((isPermaLink . "false")) "discuss.elastic.co-topic-349182") (source ((url . "https://discuss.elastic.co/t/kibana-8-11-2-7-17-16-security-update-esa-2023-27/349182.rss")) "Kibana 8.11.2, 7.17.16 Security Update (ESA-2023-27)")) (item nil (title nil "Enterprise Search 8.11.2 / 7.17.16 Security Update (ESA-2023-31)") (creator nil "rodrigo_silva") (category nil "Security Announcements") (description nil "
            <h1><a name=\"enterprise-search-insertion-of-sensitive-information-into-log-file-esa-2023-31-1\" class=\"anchor\" href=\"https://discuss.elastic.co#enterprise-search-insertion-of-sensitive-information-into-log-file-esa-2023-31-1\"></a>Enterprise Search Insertion of Sensitive Information into Log File (ESA-2023-31)</h1>
<p>An issue was discovered by Elastic whereby the <a href=\"https://www.elastic.co/guide/en/app-search/current/documents.html#documents-create\">Documents API</a> of App Search logged the raw contents of indexed documents at <code>INFO</code> log level. Depending on the contents of such documents, this could lead to the insertion of sensitive or private information in the App Search logs. Elastic has released 8.11.2 and 7.17.16 that resolves this issue by changing the log level at which these are logged to <code>DEBUG</code>, which is disabled by default.</p>
<p><strong>Affected Versions:</strong><br>
Enterprise Search versions on or after 7.0.0 and before 7.17.16.<br>
Enterprise Search versions on or after 8.0.0 and before 8.11.2.</p>
<p><strong>Affected Configurations:</strong><br>
Only users that directly utilize the <a href=\"https://www.elastic.co/guide/en/app-search/current/documents.html#documents-create\">Documents API</a> are affected by this issue, if the documents that they are ingesting via this API contain sensitive or private information.</p>
<p><strong>Solutions and Mitigations:</strong><br>
The issue is resolved in versions 7.17.16 and versions 8.11.2.</p>
<p>Customers on versions before 7.17.16 and 8.11.2 that cannot upgrade can prohibit document contents from being logged by setting <a href=\"https://www.elastic.co/guide/en/enterprise-search/current/configuration.html#configuration-settings-logging\">log_level</a> to <code>WARN</code> or higher in their Enterprise Search configuration. Refer to <a href=\"https://www.elastic.co/guide/en/enterprise-search/current/configuration.html#configuration-configure\">our documentation</a> for applying this setting on Elastic Cloud, ECE or self managed clusters.</p>
<p><strong>Severity:</strong><br>
CVSSv3.1: 6.8(Medium) - <a href=\"https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:A/AC:L/PR:L/UI:N/S:C/C:H/I:N/A:N\">AV:A/AC:L/PR:L/UI:N/S:C/C:H/I:N/A:N</a><br>
CVE ID: CVE-2023-49923</p>
            <p><small>2 posts - 2 participants</small></p>
            <p><a href=\"https://discuss.elastic.co/t/enterprise-search-8-11-2-7-17-16-security-update-esa-2023-31/349181\">Read full topic</a></p>
          ") (link nil "https://discuss.elastic.co/t/enterprise-search-8-11-2-7-17-16-security-update-esa-2023-31/349181") (pubDate nil "Tue, 12 Dec 2023 17:06:41 +0000") (topicPinned nil "No") (topicClosed nil "Yes") (topicArchived nil "No") (guid ((isPermaLink . "false")) "discuss.elastic.co-topic-349181") (source ((url . "https://discuss.elastic.co/t/enterprise-search-8-11-2-7-17-16-security-update-esa-2023-31/349181.rss")) "Enterprise Search 8.11.2 / 7.17.16 Security Update (ESA-2023-31)")))) ("Kibana 8.15.1 Security Update (ESA-2024-27, ESA-2024-28)" "<p><strong>Kibana arbitrary code execution via YAML deserialization in Amazon Bedrock Connector (ESA-2024-27)</strong></p>
<p>A deserialization issue in Kibana can lead to arbitrary code execution when Kibana attempts to parse a YAML document containing a crafted payload.</p>
<p>This issue only affects users that use <a href=\"https://www.elastic.co/guide/en/security/current/ai-for-security.html\">Elastic Security’s built-in AI tools</a> and have configured an <a href=\"https://www.elastic.co/guide/en/security/current/assistant-connect-to-bedrock.html\">Amazon Bedrock connector</a>.</p>
<p><strong>Affected Versions:</strong><br>
Kibana version 8.15.0.</p>
<p><strong>Solutions and Mitigations:</strong><br>
Users should upgrade to version 8.15.1.</p>
<p><strong>For Users that Cannot Upgrade:</strong><br>
Customers who cannot upgrade to 8.15.1 and must stay on 8.15.0 can disable the integration assistant by setting <code>xpack.integration_assistant.enabled: false</code> in their <code>kibana.yml</code> configuration file.</p>
<p><strong>Severity:</strong> CVSSv3.1: 9.9 (Critical) - CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H</p>
<p><strong>CVE ID:</strong> CVE-2024-37288</p>
<hr>
<p><strong>Kibana arbitrary code execution via YAML deserialization (ESA-2024-28)</strong></p>
<p>A deserialization issue in Kibana can lead to arbitrary code execution when Kibana attempts to parse a YAML document containing a crafted payload.</p>
<p>A successful attack requires a malicious user to have a combination of both specific <a href=\"https://www.elastic.co/guide/en/elasticsearch/reference/current/defining-roles.html#roles-indices-priv\">Elasticsearch indices privileges</a> and <a href=\"https://www.elastic.co/guide/en/fleet/current/fleet-roles-and-privileges.html\">Kibana privileges</a> assigned to them.</p>
<p>The following Elasticsearch indices permissions are required</p>
<ul>
<li><code>write</code> privilege on the system indices <code>.kibana_ingest*</code></li>
<li>The <code>allow_restricted_indices</code> flag is set to <code>true</code></li>
</ul>
<p>Any of the following Kibana privileges are additionally required</p>
<ul>
<li>Under <code>Fleet</code> the <code>All</code> privilege is granted</li>
<li>Under <code>Integration</code> the <code>Read</code> or <code>All</code> privilege is granted</li>
<li>Access to the <code>fleet-setup</code> privilege is gained through the Fleet Server’s service account token</li>
</ul>
<p><strong>Affected Versions:</strong><br>
Kibana versions 8.10.0 to 8.15.0.</p>
<p><strong>Solutions and Mitigations:</strong><br>
Users should upgrade to version 8.15.1.</p>
<p><strong>CVSS v3.1:</strong> 9.1 (Critical) - CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:C/C:H/I:H/A:H</p>
<p><strong>CVE ID:</strong> CVE-2024-37285</p>
            <p><small>1 post - 1 participant</small></p>
            <p><a href=\"https://discuss.elastic.co/t/kibana-8-15-1-security-update-esa-2024-27-esa-2024-28/366119\">Read full topic</a></p>" "https://discuss.elastic.co/t/kibana-8-15-1-security-update-esa-2024-27-esa-2024-28/366119" (26330 1090) new 1 nil nil ((title nil "Kibana 8.15.1 Security Update (ESA-2024-27, ESA-2024-28)") (creator nil "ismisepaul") (category nil "Security Announcements") (description nil "
            <p><strong>Kibana arbitrary code execution via YAML deserialization in Amazon Bedrock Connector (ESA-2024-27)</strong></p>
<p>A deserialization issue in Kibana can lead to arbitrary code execution when Kibana attempts to parse a YAML document containing a crafted payload.</p>
<p>This issue only affects users that use <a href=\"https://www.elastic.co/guide/en/security/current/ai-for-security.html\">Elastic Security’s built-in AI tools</a> and have configured an <a href=\"https://www.elastic.co/guide/en/security/current/assistant-connect-to-bedrock.html\">Amazon Bedrock connector</a>.</p>
<p><strong>Affected Versions:</strong><br>
Kibana version 8.15.0.</p>
<p><strong>Solutions and Mitigations:</strong><br>
Users should upgrade to version 8.15.1.</p>
<p><strong>For Users that Cannot Upgrade:</strong><br>
Customers who cannot upgrade to 8.15.1 and must stay on 8.15.0 can disable the integration assistant by setting <code>xpack.integration_assistant.enabled: false</code> in their <code>kibana.yml</code> configuration file.</p>
<p><strong>Severity:</strong> CVSSv3.1: 9.9 (Critical) - CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H</p>
<p><strong>CVE ID:</strong> CVE-2024-37288</p>
<hr>
<p><strong>Kibana arbitrary code execution via YAML deserialization (ESA-2024-28)</strong></p>
<p>A deserialization issue in Kibana can lead to arbitrary code execution when Kibana attempts to parse a YAML document containing a crafted payload.</p>
<p>A successful attack requires a malicious user to have a combination of both specific <a href=\"https://www.elastic.co/guide/en/elasticsearch/reference/current/defining-roles.html#roles-indices-priv\">Elasticsearch indices privileges</a> and <a href=\"https://www.elastic.co/guide/en/fleet/current/fleet-roles-and-privileges.html\">Kibana privileges</a> assigned to them.</p>
<p>The following Elasticsearch indices permissions are required</p>
<ul>
<li><code>write</code> privilege on the system indices <code>.kibana_ingest*</code></li>
<li>The <code>allow_restricted_indices</code> flag is set to <code>true</code></li>
</ul>
<p>Any of the following Kibana privileges are additionally required</p>
<ul>
<li>Under <code>Fleet</code> the <code>All</code> privilege is granted</li>
<li>Under <code>Integration</code> the <code>Read</code> or <code>All</code> privilege is granted</li>
<li>Access to the <code>fleet-setup</code> privilege is gained through the Fleet Server’s service account token</li>
</ul>
<p><strong>Affected Versions:</strong><br>
Kibana versions 8.10.0 to 8.15.0.</p>
<p><strong>Solutions and Mitigations:</strong><br>
Users should upgrade to version 8.15.1.</p>
<p><strong>CVSS v3.1:</strong> 9.1 (Critical) - CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:C/C:H/I:H/A:H</p>
<p><strong>CVE ID:</strong> CVE-2024-37285</p>
            <p><small>1 post - 1 participant</small></p>
            <p><a href=\"https://discuss.elastic.co/t/kibana-8-15-1-security-update-esa-2024-27-esa-2024-28/366119\">Read full topic</a></p>
          ") (link nil "https://discuss.elastic.co/t/kibana-8-15-1-security-update-esa-2024-27-esa-2024-28/366119") (pubDate nil "Thu, 05 Sep 2024 19:19:30 +0000") (topicPinned nil "No") (topicClosed nil "No") (topicArchived nil "No") (guid ((isPermaLink . "false")) "discuss.elastic.co-topic-366119") (source ((url . "https://discuss.elastic.co/t/kibana-8-15-1-security-update-esa-2024-27-esa-2024-28/366119.rss")) "Kibana 8.15.1 Security Update (ESA-2024-27, ESA-2024-28)"))) ("APM Server 8.14.0 Security Update (ESA-2024-09)" "<p><strong>APM Server - Uncontrolled Resource Consumption through HTTP/2 endpoints - CVE-2023-45288 (ESA-2024-09)</strong></p>
<p>On April 4, 2024, the Go Project announced CVE-2023-45288, which can lead to CPU exhaustion as an attacker can cause an HTTP/2 endpoint to read arbitrary amounts of header data.</p>
<p>In an on-prem deployment APM Server has been found vulnerable if exposed directly to HTTP traffic.</p>
<p>This vulnerability cannot be exploited on Elastic Cloud because the service is behind the Elastic Cloud proxy.</p>
<p><strong>Affected Versions:</strong></p>
<ul>
<li>APM Server versions up to, but not including, 8.14.0</li>
<li>APM Server versions up to, but not including, 7.17.21</li>
</ul>
<p><strong>Solutions and Mitigations:</strong><br>
Users should upgrade to version 8.14.0</p>
<p><strong>Severity: CVSSv3.1</strong> 5.3 (Medium) <a href=\"https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L\">CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L</a></p>
<p><strong>CVE ID:</strong> CVE-2023-45288</p>
            <p><small>1 post - 1 participant</small></p>
            <p><a href=\"https://discuss.elastic.co/t/apm-server-8-14-0-security-update-esa-2024-09/364946\">Read full topic</a></p>" "https://discuss.elastic.co/t/apm-server-8-14-0-security-update-esa-2024-09/364946" (26301 53346) new 2 nil nil ((title nil "APM Server 8.14.0 Security Update (ESA-2024-09)") (creator nil "ismisepaul") (category nil "Security Announcements") (description nil "
            <p><strong>APM Server - Uncontrolled Resource Consumption through HTTP/2 endpoints - CVE-2023-45288 (ESA-2024-09)</strong></p>
<p>On April 4, 2024, the Go Project announced CVE-2023-45288, which can lead to CPU exhaustion as an attacker can cause an HTTP/2 endpoint to read arbitrary amounts of header data.</p>
<p>In an on-prem deployment APM Server has been found vulnerable if exposed directly to HTTP traffic.</p>
<p>This vulnerability cannot be exploited on Elastic Cloud because the service is behind the Elastic Cloud proxy.</p>
<p><strong>Affected Versions:</strong></p>
<ul>
<li>APM Server versions up to, but not including, 8.14.0</li>
<li>APM Server versions up to, but not including, 7.17.21</li>
</ul>
<p><strong>Solutions and Mitigations:</strong><br>
Users should upgrade to version 8.14.0</p>
<p><strong>Severity: CVSSv3.1</strong> 5.3 (Medium) <a href=\"https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L\">CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L</a></p>
<p><strong>CVE ID:</strong> CVE-2023-45288</p>
            <p><small>1 post - 1 participant</small></p>
            <p><a href=\"https://discuss.elastic.co/t/apm-server-8-14-0-security-update-esa-2024-09/364946\">Read full topic</a></p>
          ") (link nil "https://discuss.elastic.co/t/apm-server-8-14-0-security-update-esa-2024-09/364946") (pubDate nil "Thu, 15 Aug 2024 09:54:42 +0000") (topicPinned nil "No") (topicClosed nil "No") (topicArchived nil "No") (guid ((isPermaLink . "false")) "discuss.elastic.co-topic-364946") (source ((url . "https://discuss.elastic.co/t/apm-server-8-14-0-security-update-esa-2024-09/364946.rss")) "APM Server 8.14.0 Security Update (ESA-2024-09)"))) ("Elastic Agent 8.15.0 Security Update (ESA-2024-23)" "<p><strong>Elastic Agent Insertion of Sensitive Information into Log File  (ESA-2024-23)</strong></p>
<p>An issue was discovered whereby Elastic Agent will leak secrets from the agent policy <code>elastic-agent.yml</code> only when the log level is configured to <code>debug</code>. By default the log level is set to <code>info</code>, where no leak occurs.</p>
<p><strong>Affected Versions:</strong><br>
Elastic Agent &gt;= 8.6.0 and &lt; 8.15.0</p>
<p><strong>Solutions and Mitigations:</strong><br>
The issue is resolved in version 8.15.0.</p>
<p><strong>Elastic Cloud</strong><br>
The following mitigations have been performed by Elastic:</p>
<ul>
<li>An investigation has revealed that no Elastic Cloud customers are affected.</li>
<li>As a preventative measure we have deployed an ingest processor to redact the component field before it is logged in our monitoring environment.</li>
</ul>
<p><strong>Self-Managed</strong><br>
Users who are running Elastic Agent &gt;= 8.6.0 and &lt; 8.15.0 should upgrade to Elastic Agent 8.15.0.</p>
<p>Users should review the logging level applied to their Elastic Agents to determine if they might be affected. If it has been determined that the logging level has been set to <code>debug</code> then the affected logs should be reviewed for any potential sensitive data by filtering for <code>log.level: debug AND components: *</code> within Elasticsearch, and if deemed necessary, follow up actions should include;</p>
<ul>
<li>Purging sensitive data from logs</li>
<li>Rotating any potentially exposed credentials</li>
</ul>
<p><strong>For Users that Cannot Upgrade</strong></p>
<p>Users running Elastic Agent &gt;= 8.6.0 and &lt; 8.15.0 should avoid setting the logging level to <code>debug</code>.</p>
<p>If the logging level for Elastic Agent &gt;= 8.6.0 and &lt; 8.15.0 has been set to <code>debug</code>, users should follow the guidance under “Self-Managed” above. Additionally, users can create an <a href=\"https://www.elastic.co/guide/en/elasticsearch/reference/current/processors.html\">ingest processor</a> to redact the component field before it’s logged to the monitoring environment. Example below</p>
<pre><code class=\"lang-auto\">{
  \"description\": \"Ingest processor for esa-2024-23\",
  \"processors\": [
    {
      \"remove\": {
        \"if\" : \"ctx.log?.level == 'debug'\",
        \"field\": \"components\"
      }
    }
  ]
}

</code></pre>
<p><strong>Severity:</strong> CVSSv4.0: 6.5 (Medium) - <a href=\"https://www.first.org/cvss/calculator/4.0#CVSS:4.0/AV:N/AC:L/AT:N/PR:L/UI:N/VC:N/VI:N/VA:N/SC:H/SI:H/SA:H\">CVSS:4.0/AV:N/AC:L/AT:N/PR:L/UI:N/VC:N/VI:N/VA:N/SC:H/SI:H/SA:H</a></p>
<p><strong>CVE ID:</strong> CVE-2024-37283</p>
            <p><small>1 post - 1 participant</small></p>
            <p><a href=\"https://discuss.elastic.co/t/elastic-agent-8-15-0-security-update-esa-2024-23/364635\">Read full topic</a></p>" "https://discuss.elastic.co/t/elastic-agent-8-15-0-security-update-esa-2024-23/364635" (26293 21964) new 3 nil nil ((title nil "Elastic Agent 8.15.0 Security Update (ESA-2024-23)") (creator nil "ismisepaul") (category nil "Security Announcements") (description nil "
            <p><strong>Elastic Agent Insertion of Sensitive Information into Log File  (ESA-2024-23)</strong></p>
<p>An issue was discovered whereby Elastic Agent will leak secrets from the agent policy <code>elastic-agent.yml</code> only when the log level is configured to <code>debug</code>. By default the log level is set to <code>info</code>, where no leak occurs.</p>
<p><strong>Affected Versions:</strong><br>
Elastic Agent &gt;= 8.6.0 and &lt; 8.15.0</p>
<p><strong>Solutions and Mitigations:</strong><br>
The issue is resolved in version 8.15.0.</p>
<p><strong>Elastic Cloud</strong><br>
The following mitigations have been performed by Elastic:</p>
<ul>
<li>An investigation has revealed that no Elastic Cloud customers are affected.</li>
<li>As a preventative measure we have deployed an ingest processor to redact the component field before it is logged in our monitoring environment.</li>
</ul>
<p><strong>Self-Managed</strong><br>
Users who are running Elastic Agent &gt;= 8.6.0 and &lt; 8.15.0 should upgrade to Elastic Agent 8.15.0.</p>
<p>Users should review the logging level applied to their Elastic Agents to determine if they might be affected. If it has been determined that the logging level has been set to <code>debug</code> then the affected logs should be reviewed for any potential sensitive data by filtering for <code>log.level: debug AND components: *</code> within Elasticsearch, and if deemed necessary, follow up actions should include;</p>
<ul>
<li>Purging sensitive data from logs</li>
<li>Rotating any potentially exposed credentials</li>
</ul>
<p><strong>For Users that Cannot Upgrade</strong></p>
<p>Users running Elastic Agent &gt;= 8.6.0 and &lt; 8.15.0 should avoid setting the logging level to <code>debug</code>.</p>
<p>If the logging level for Elastic Agent &gt;= 8.6.0 and &lt; 8.15.0 has been set to <code>debug</code>, users should follow the guidance under “Self-Managed” above. Additionally, users can create an <a href=\"https://www.elastic.co/guide/en/elasticsearch/reference/current/processors.html\">ingest processor</a> to redact the component field before it’s logged to the monitoring environment. Example below</p>
<pre><code class=\"lang-auto\">{
  \"description\": \"Ingest processor for esa-2024-23\",
  \"processors\": [
    {
      \"remove\": {
        \"if\" : \"ctx.log?.level == 'debug'\",
        \"field\": \"components\"
      }
    }
  ]
}

</code></pre>
<p><strong>Severity:</strong> CVSSv4.0: 6.5 (Medium) - <a href=\"https://www.first.org/cvss/calculator/4.0#CVSS:4.0/AV:N/AC:L/AT:N/PR:L/UI:N/VC:N/VI:N/VA:N/SC:H/SI:H/SA:H\">CVSS:4.0/AV:N/AC:L/AT:N/PR:L/UI:N/VC:N/VI:N/VA:N/SC:H/SI:H/SA:H</a></p>
<p><strong>CVE ID:</strong> CVE-2024-37283</p>
            <p><small>1 post - 1 participant</small></p>
            <p><a href=\"https://discuss.elastic.co/t/elastic-agent-8-15-0-security-update-esa-2024-23/364635\">Read full topic</a></p>
          ") (link nil "https://discuss.elastic.co/t/elastic-agent-8-15-0-security-update-esa-2024-23/364635") (pubDate nil "Thu, 08 Aug 2024 23:33:32 +0000") (topicPinned nil "No") (topicClosed nil "No") (topicArchived nil "No") (guid ((isPermaLink . "false")) "discuss.elastic.co-topic-364635") (source ((url . "https://discuss.elastic.co/t/elastic-agent-8-15-0-security-update-esa-2024-23/364635.rss")) "Elastic Agent 8.15.0 Security Update (ESA-2024-23)"))) ("Kibana 8.14.2 / 7.17.23 Security Update (ESA-2024-22)" "<h1><a name=\"p-1389349-kibana-arbitrary-code-execution-via-prototype-pollution-esa-2024-22-1\" class=\"anchor\" href=\"https://discuss.elastic.co#p-1389349-kibana-arbitrary-code-execution-via-prototype-pollution-esa-2024-22-1\"></a>Kibana arbitrary code execution via prototype pollution (ESA-2024-22)</h1>
<p>A flaw allowing arbitrary code execution was discovered in Kibana. An attacker with access to ML and Alerting connector features, as well as write access to internal ML indices can trigger a prototype pollution vulnerability, ultimately leading to arbitrary code execution.</p>
<p>This issue affects self-managed Kibana installations on host Operating Systems.</p>
<p>This issue affects self-managed Kibana instances running the Kibana Docker image, but the RCE is limited within the container. Further exploitation such as container escape is prevented by seccomp-bpf.</p>
<p>This issue affects Kibana instances running on Elastic Cloud but the RCE is limited within the Kibana Docker container. Further exploitation such as container escape is prevented by seccomp-bpf and AppArmor profiles.</p>
<p>This issue affects Kibana instances running on Elastic Cloud Enterprise (ECE) but the code execution is limited within the Kibana Docker container. Further exploitation such as container escape is prevented by seccomp-bpf and AppArmor profiles.</p>
<p>This issue affects Kibana instances running on Elastic Cloud on Kubernetes (ECK) but the code execution is limited within the Kibana Docker container. Further exploitation such as container escape can be prevented by seccomp-bpf when configured and supported (Kubernetes v1.19 and later).</p>
<h2><a name=\"p-1389349-affected-versions-2\" class=\"anchor\" href=\"https://discuss.elastic.co#p-1389349-affected-versions-2\"></a>Affected Versions:</h2>
<p>Kibana 8.x versions prior to 8.14.2 and Kibana 7.x versions from 7.7.0 prior to 7.17.23</p>
<h2><a name=\"p-1389349-affected-configurations-3\" class=\"anchor\" href=\"https://discuss.elastic.co#p-1389349-affected-configurations-3\"></a>Affected Configurations:</h2>
<p>This exploit requires a threat actor to have all of the following priveleges: write access to the .ml-anomalies* hidden indices, read access to the Machine Learning feature, and read access to the Actions &amp; Connectors feature.<br>
Write access to the .ml-anomalies* hidden indices isn't provided by default, is not recommended, nor is it explicitly or implicitly required for any user functionality.</p>
<h2><a name=\"p-1389349-solutions-and-mitigations-4\" class=\"anchor\" href=\"https://discuss.elastic.co#p-1389349-solutions-and-mitigations-4\"></a>Solutions and Mitigations:</h2>
<p>Users should upgrade to version 8.14.2 and 7.17.23.</p>
<h3><a name=\"p-1389349-for-users-that-cannot-upgrade-5\" class=\"anchor\" href=\"https://discuss.elastic.co#p-1389349-for-users-that-cannot-upgrade-5\"></a>For Users that cannot upgrade:</h3>
<p>If an upgrade is not possible, we advise customers to first ensure Elasticsearch and Kibana user privileges are properly secured. Further mitigations can be applied by disabling Connector Actions and Machine Learning capabilities if this functionality is not required. Details are as follows:</p>
<h4><a name=\"p-1389349-h-1-securing-elasticsearch-user-privileges-6\" class=\"anchor\" href=\"https://discuss.elastic.co#p-1389349-h-1-securing-elasticsearch-user-privileges-6\"></a>1. Securing Elasticsearch user privileges</h4>
<p>Customers are advised to ensure that users have not been granted Elasticsearch index privileges to write ML result indices (<code>.ml-anomalies*</code>). Ensure this has not been explicitly granted.</p>
<p><code>GET _security/role</code></p>
<p>Check role definitions for customer-created roles. Ensure index privileges have not been granted to <code>.ml-anomalies*</code> (or equivalent matching wildcard) for any customer role that would allow writing data (all, write, create_doc, create, index, etc).</p>
<p>Note: Users with superuser privileges have full index privileges. Ensure superuser access is controlled.</p>
<h4><a name=\"p-1389349-h-2-securing-kibana-user-privileges-7\" class=\"anchor\" href=\"https://discuss.elastic.co#p-1389349-h-2-securing-kibana-user-privileges-7\"></a>2. Securing Kibana user privileges</h4>
<p>Kibana user privileges can be further secured to limit access to ML and connector action capabilities.</p>
<p>Users that do not require access to ML or manage Kibana Alerting Rules must have either of the following Kibana privileges set to “None”:</p>
<p>Machine Learning: None</p>
<p>Management / Actions and Connectors: None</p>
<p>Note: Users with superuser privileges will still be able to access machine learning capabilities in Kibana. In 7.x, users with <code>manage_ml</code> or <code>monitor_ml</code> Elasticsearch cluster privileges or <code>machine_learning_admin</code> or <code>machine_learning_user</code> built-in roles are able to access machine learning capabilities in Kibana.</p>
<h3><a name=\"p-1389349-further-mitigations-can-be-applied-via-8\" class=\"anchor\" href=\"https://discuss.elastic.co#p-1389349-further-mitigations-can-be-applied-via-8\"></a>Further mitigations can be applied via:</h3>
<h4><a name=\"p-1389349-h-3-disabling-connector-actions-9\" class=\"anchor\" href=\"https://discuss.elastic.co#p-1389349-h-3-disabling-connector-actions-9\"></a>3. Disabling Connector Actions</h4>
<p>All email connector actions can be disabled. This will prevent emails from being sent for alerting rule notifications, and an alternate notification action would be required. This must be set on all Kibana nodes and applied after a node restart.</p>
<p>In 7.7+ and 8.x, Connector action can be disabled in kibana.yml. This must be applied to all Kibana nodes. <strong>Note: <em>Do not apply</em> this yml setting to clusters of version 7.6 and below - this will prevent Kibana from starting.</strong></p>
<p>A full list of action types is available in the documentation:<br>
<a href=\"https://www.elastic.co/guide/en/kibana/7.17/alert-action-settings-kb.html\">https://www.elastic.co/guide/en/kibana/7.17/alert-action-settings-kb.html</a><br>
<a href=\"https://www.elastic.co/guide/en/kibana/8.15/alert-action-settings-kb.html\">https://www.elastic.co/guide/en/kibana/8.15/alert-action-settings-kb.html</a></p>
<pre><code class=\"lang-auto\">// kibana.yml
// To only allow specific named connector actions, supply an named list and exclude email
// Also delete any pre-configured email connectors, if specified
xpack.actions.enabledActionTypes: [ \".s​​erver-log\", \".index\", \".other-tbc\" ]
</code></pre>
<p>Any existing Alerting Rule that used an email action for its notifications would continue running but would not be able to send email notifications. Errors would be logged due to the disabled email connector. An alternate connector action would be required for notifications.</p>
<h4><a name=\"p-1389349-h-4-disabling-ml-10\" class=\"anchor\" href=\"https://discuss.elastic.co#p-1389349-h-4-disabling-ml-10\"></a>4. Disabling ML</h4>
<p>Machine learning capabilities can be disabled. This will prevent machine learning jobs from running.</p>
<p>In 6.x, 7.x, 8.x, machine learning functionality can be disabled entirely by setting the following in elasticsearch.yml. This must be applied to all Elasticsearch nodes and is applied upon a node restart.</p>
<p><a href=\"https://www.elastic.co/guide/en/elasticsearch/reference/8.14/ml-settings.html\">https://www.elastic.co/guide/en/elasticsearch/reference/8.14/ml-settings.html</a><br>
<a href=\"https://www.elastic.co/guide/en/elasticsearch/reference/7.17/ml-settings.html\">https://www.elastic.co/guide/en/elasticsearch/reference/7.17/ml-settings.html</a><br>
<a href=\"https://www.elastic.co/guide/en/elasticsearch/reference/6.8/ml-settings.html\">https://www.elastic.co/guide/en/elasticsearch/reference/6.8/ml-settings.html</a></p>
<pre><code class=\"lang-auto\">// elasticsearch.yml
xpack.ml.enabled: false
</code></pre>
<p>In 6.x and 7.x, machine learning in Kibana functionality can be disabled in Kibana only, by setting the following in kibana.yml. Machine learning functionality will continue to be available in Elasticsearch and accessible via Elasticsearch APIs, and all Kibana ML functionality will be disabled. Choose this option if you want to continue accessing ML functionality via Elasticsearch APIs only. This must be set on all Kibana nodes and is applied upon a node restart.</p>
<p><a href=\"https://www.elastic.co/guide/en/kibana/7.17/ml-settings-kb.html\">https://www.elastic.co/guide/en/kibana/7.17/ml-settings-kb.html</a><br>
<a href=\"https://www.elastic.co/guide/en/kibana/6.8/ml-settings-kb.html\">https://www.elastic.co/guide/en/kibana/6.8/ml-settings-kb.html</a></p>
<pre><code class=\"lang-auto\">// kibana.yml
xpack.ml.enabled: false
</code></pre>
<h3><a name=\"p-1389349-severity-11\" class=\"anchor\" href=\"https://discuss.elastic.co#p-1389349-severity-11\"></a>Severity:</h3>
<p>CVSSv3.1: 9.1(Critical) - <a href=\"https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:C/C:H/I:H/A:H\">CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:C/C:H/I:H/A:H</a></p>
<p>***Updated Aug 13, 2024 11:45:01 UTC : CVSS Severity Rating has been updated after re-analysis of the issue. Privileges Required was revised to High from the initial assessment Privileges Required Low.</p>
<h3><a name=\"p-1389349-cve-id-12\" class=\"anchor\" href=\"https://discuss.elastic.co#p-1389349-cve-id-12\"></a>CVE ID:</h3>
<p>CVE-2024-37287</p>
            <p><small>7 posts - 2 participants</small></p>
            <p><a href=\"https://discuss.elastic.co/t/kibana-8-14-2-7-17-23-security-update-esa-2024-22/364424\">Read full topic</a></p>" "https://discuss.elastic.co/t/kibana-8-14-2-7-17-23-security-update-esa-2024-22/364424" (26289 20678) new 4 nil nil ((title nil "Kibana 8.14.2 / 7.17.23 Security Update (ESA-2024-22)") (creator nil "rodrigo_silva") (category nil "Security Announcements") (description nil "
            <h1><a name=\"p-1389349-kibana-arbitrary-code-execution-via-prototype-pollution-esa-2024-22-1\" class=\"anchor\" href=\"https://discuss.elastic.co#p-1389349-kibana-arbitrary-code-execution-via-prototype-pollution-esa-2024-22-1\"></a>Kibana arbitrary code execution via prototype pollution (ESA-2024-22)</h1>
<p>A flaw allowing arbitrary code execution was discovered in Kibana. An attacker with access to ML and Alerting connector features, as well as write access to internal ML indices can trigger a prototype pollution vulnerability, ultimately leading to arbitrary code execution.</p>
<p>This issue affects self-managed Kibana installations on host Operating Systems.</p>
<p>This issue affects self-managed Kibana instances running the Kibana Docker image, but the RCE is limited within the container. Further exploitation such as container escape is prevented by seccomp-bpf.</p>
<p>This issue affects Kibana instances running on Elastic Cloud but the RCE is limited within the Kibana Docker container. Further exploitation such as container escape is prevented by seccomp-bpf and AppArmor profiles.</p>
<p>This issue affects Kibana instances running on Elastic Cloud Enterprise (ECE) but the code execution is limited within the Kibana Docker container. Further exploitation such as container escape is prevented by seccomp-bpf and AppArmor profiles.</p>
<p>This issue affects Kibana instances running on Elastic Cloud on Kubernetes (ECK) but the code execution is limited within the Kibana Docker container. Further exploitation such as container escape can be prevented by seccomp-bpf when configured and supported (Kubernetes v1.19 and later).</p>
<h2><a name=\"p-1389349-affected-versions-2\" class=\"anchor\" href=\"https://discuss.elastic.co#p-1389349-affected-versions-2\"></a>Affected Versions:</h2>
<p>Kibana 8.x versions prior to 8.14.2 and Kibana 7.x versions from 7.7.0 prior to 7.17.23</p>
<h2><a name=\"p-1389349-affected-configurations-3\" class=\"anchor\" href=\"https://discuss.elastic.co#p-1389349-affected-configurations-3\"></a>Affected Configurations:</h2>
<p>This exploit requires a threat actor to have all of the following priveleges: write access to the .ml-anomalies* hidden indices, read access to the Machine Learning feature, and read access to the Actions &amp; Connectors feature.<br>
Write access to the .ml-anomalies* hidden indices isn't provided by default, is not recommended, nor is it explicitly or implicitly required for any user functionality.</p>
<h2><a name=\"p-1389349-solutions-and-mitigations-4\" class=\"anchor\" href=\"https://discuss.elastic.co#p-1389349-solutions-and-mitigations-4\"></a>Solutions and Mitigations:</h2>
<p>Users should upgrade to version 8.14.2 and 7.17.23.</p>
<h3><a name=\"p-1389349-for-users-that-cannot-upgrade-5\" class=\"anchor\" href=\"https://discuss.elastic.co#p-1389349-for-users-that-cannot-upgrade-5\"></a>For Users that cannot upgrade:</h3>
<p>If an upgrade is not possible, we advise customers to first ensure Elasticsearch and Kibana user privileges are properly secured. Further mitigations can be applied by disabling Connector Actions and Machine Learning capabilities if this functionality is not required. Details are as follows:</p>
<h4><a name=\"p-1389349-h-1-securing-elasticsearch-user-privileges-6\" class=\"anchor\" href=\"https://discuss.elastic.co#p-1389349-h-1-securing-elasticsearch-user-privileges-6\"></a>1. Securing Elasticsearch user privileges</h4>
<p>Customers are advised to ensure that users have not been granted Elasticsearch index privileges to write ML result indices (<code>.ml-anomalies*</code>). Ensure this has not been explicitly granted.</p>
<p><code>GET _security/role</code></p>
<p>Check role definitions for customer-created roles. Ensure index privileges have not been granted to <code>.ml-anomalies*</code> (or equivalent matching wildcard) for any customer role that would allow writing data (all, write, create_doc, create, index, etc).</p>
<p>Note: Users with superuser privileges have full index privileges. Ensure superuser access is controlled.</p>
<h4><a name=\"p-1389349-h-2-securing-kibana-user-privileges-7\" class=\"anchor\" href=\"https://discuss.elastic.co#p-1389349-h-2-securing-kibana-user-privileges-7\"></a>2. Securing Kibana user privileges</h4>
<p>Kibana user privileges can be further secured to limit access to ML and connector action capabilities.</p>
<p>Users that do not require access to ML or manage Kibana Alerting Rules must have either of the following Kibana privileges set to “None”:</p>
<p>Machine Learning: None</p>
<p>Management / Actions and Connectors: None</p>
<p>Note: Users with superuser privileges will still be able to access machine learning capabilities in Kibana. In 7.x, users with <code>manage_ml</code> or <code>monitor_ml</code> Elasticsearch cluster privileges or <code>machine_learning_admin</code> or <code>machine_learning_user</code> built-in roles are able to access machine learning capabilities in Kibana.</p>
<h3><a name=\"p-1389349-further-mitigations-can-be-applied-via-8\" class=\"anchor\" href=\"https://discuss.elastic.co#p-1389349-further-mitigations-can-be-applied-via-8\"></a>Further mitigations can be applied via:</h3>
<h4><a name=\"p-1389349-h-3-disabling-connector-actions-9\" class=\"anchor\" href=\"https://discuss.elastic.co#p-1389349-h-3-disabling-connector-actions-9\"></a>3. Disabling Connector Actions</h4>
<p>All email connector actions can be disabled. This will prevent emails from being sent for alerting rule notifications, and an alternate notification action would be required. This must be set on all Kibana nodes and applied after a node restart.</p>
<p>In 7.7+ and 8.x, Connector action can be disabled in kibana.yml. This must be applied to all Kibana nodes. <strong>Note: <em>Do not apply</em> this yml setting to clusters of version 7.6 and below - this will prevent Kibana from starting.</strong></p>
<p>A full list of action types is available in the documentation:<br>
<a href=\"https://www.elastic.co/guide/en/kibana/7.17/alert-action-settings-kb.html\">https://www.elastic.co/guide/en/kibana/7.17/alert-action-settings-kb.html</a><br>
<a href=\"https://www.elastic.co/guide/en/kibana/8.15/alert-action-settings-kb.html\">https://www.elastic.co/guide/en/kibana/8.15/alert-action-settings-kb.html</a></p>
<pre><code class=\"lang-auto\">// kibana.yml
// To only allow specific named connector actions, supply an named list and exclude email
// Also delete any pre-configured email connectors, if specified
xpack.actions.enabledActionTypes: [ \".s​​erver-log\", \".index\", \".other-tbc\" ]
</code></pre>
<p>Any existing Alerting Rule that used an email action for its notifications would continue running but would not be able to send email notifications. Errors would be logged due to the disabled email connector. An alternate connector action would be required for notifications.</p>
<h4><a name=\"p-1389349-h-4-disabling-ml-10\" class=\"anchor\" href=\"https://discuss.elastic.co#p-1389349-h-4-disabling-ml-10\"></a>4. Disabling ML</h4>
<p>Machine learning capabilities can be disabled. This will prevent machine learning jobs from running.</p>
<p>In 6.x, 7.x, 8.x, machine learning functionality can be disabled entirely by setting the following in elasticsearch.yml. This must be applied to all Elasticsearch nodes and is applied upon a node restart.</p>
<p><a href=\"https://www.elastic.co/guide/en/elasticsearch/reference/8.14/ml-settings.html\">https://www.elastic.co/guide/en/elasticsearch/reference/8.14/ml-settings.html</a><br>
<a href=\"https://www.elastic.co/guide/en/elasticsearch/reference/7.17/ml-settings.html\">https://www.elastic.co/guide/en/elasticsearch/reference/7.17/ml-settings.html</a><br>
<a href=\"https://www.elastic.co/guide/en/elasticsearch/reference/6.8/ml-settings.html\">https://www.elastic.co/guide/en/elasticsearch/reference/6.8/ml-settings.html</a></p>
<pre><code class=\"lang-auto\">// elasticsearch.yml
xpack.ml.enabled: false
</code></pre>
<p>In 6.x and 7.x, machine learning in Kibana functionality can be disabled in Kibana only, by setting the following in kibana.yml. Machine learning functionality will continue to be available in Elasticsearch and accessible via Elasticsearch APIs, and all Kibana ML functionality will be disabled. Choose this option if you want to continue accessing ML functionality via Elasticsearch APIs only. This must be set on all Kibana nodes and is applied upon a node restart.</p>
<p><a href=\"https://www.elastic.co/guide/en/kibana/7.17/ml-settings-kb.html\">https://www.elastic.co/guide/en/kibana/7.17/ml-settings-kb.html</a><br>
<a href=\"https://www.elastic.co/guide/en/kibana/6.8/ml-settings-kb.html\">https://www.elastic.co/guide/en/kibana/6.8/ml-settings-kb.html</a></p>
<pre><code class=\"lang-auto\">// kibana.yml
xpack.ml.enabled: false
</code></pre>
<h3><a name=\"p-1389349-severity-11\" class=\"anchor\" href=\"https://discuss.elastic.co#p-1389349-severity-11\"></a>Severity:</h3>
<p>CVSSv3.1: 9.1(Critical) - <a href=\"https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:C/C:H/I:H/A:H\">CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:C/C:H/I:H/A:H</a></p>
<p>***Updated Aug 13, 2024 11:45:01 UTC : CVSS Severity Rating has been updated after re-analysis of the issue. Privileges Required was revised to High from the initial assessment Privileges Required Low.</p>
<h3><a name=\"p-1389349-cve-id-12\" class=\"anchor\" href=\"https://discuss.elastic.co#p-1389349-cve-id-12\"></a>CVE ID:</h3>
<p>CVE-2024-37287</p>
            <p><small>7 posts - 2 participants</small></p>
            <p><a href=\"https://discuss.elastic.co/t/kibana-8-14-2-7-17-23-security-update-esa-2024-22/364424\">Read full topic</a></p>
          ") (link nil "https://discuss.elastic.co/t/kibana-8-14-2-7-17-23-security-update-esa-2024-22/364424") (pubDate nil "Mon, 05 Aug 2024 22:23:02 +0000") (topicPinned nil "No") (topicClosed nil "No") (topicArchived nil "No") (guid ((isPermaLink . "false")) "discuss.elastic.co-topic-364424") (source ((url . "https://discuss.elastic.co/t/kibana-8-14-2-7-17-23-security-update-esa-2024-22/364424.rss")) "Kibana 8.14.2 / 7.17.23 Security Update (ESA-2024-22)"))) ("APM Server 8.14.0 Security Update (ESA-2024-19)" "<h3><a name=\"apm-server-insertion-of-sensitive-information-into-log-file-esa-2024-19-1\" class=\"anchor\" href=\"https://discuss.elastic.co#apm-server-insertion-of-sensitive-information-into-log-file-esa-2024-19-1\"></a>APM Server Insertion of Sensitive Information into Log File (ESA-2024-19)</h3>
<p>APM server logs contain document body from a partially failed bulk index request. For example, in case of unavailable_shards_exception for a specific document, since the ES response line contains the document body, and that APM server logs the ES response line on error, the document is effectively logged.</p>
<p><strong>Affected Versions:</strong><br>
APM Server versions before 8.14.0</p>
<p><strong>Solutions and Mitigations:</strong><br>
The issue is resolved in version 8.14.0.</p>
<p><strong>Reviewing Logs for Sensitive Information</strong><br>
Users can search for instances of these documents and determine whether any sensitive information has been leaked in APM Server logs by searching for the following string</p>
<p>​​<code>message: \"unavailable_shards_exception\"</code> and <code>message: \"source\"</code></p>
<p><strong>Severity:</strong> CVSSv3: 5.7(Medium) - <a href=\"https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:A/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N\">AV:A/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N</a></p>
<p><strong>CVE ID:</strong> CVE-2024-37286</p>
            <p><small>1 post - 1 participant</small></p>
            <p><a href=\"https://discuss.elastic.co/t/apm-server-8-14-0-security-update-esa-2024-19/364289\">Read full topic</a></p>" "https://discuss.elastic.co/t/apm-server-8-14-0-security-update-esa-2024-19/364289" (26285 16244) new 5 nil nil ((title nil "APM Server 8.14.0 Security Update (ESA-2024-19)") (creator nil "rodrigo_silva") (category nil "Security Announcements") (description nil "
            <h3><a name=\"apm-server-insertion-of-sensitive-information-into-log-file-esa-2024-19-1\" class=\"anchor\" href=\"https://discuss.elastic.co#apm-server-insertion-of-sensitive-information-into-log-file-esa-2024-19-1\"></a>APM Server Insertion of Sensitive Information into Log File (ESA-2024-19)</h3>
<p>APM server logs contain document body from a partially failed bulk index request. For example, in case of unavailable_shards_exception for a specific document, since the ES response line contains the document body, and that APM server logs the ES response line on error, the document is effectively logged.</p>
<p><strong>Affected Versions:</strong><br>
APM Server versions before 8.14.0</p>
<p><strong>Solutions and Mitigations:</strong><br>
The issue is resolved in version 8.14.0.</p>
<p><strong>Reviewing Logs for Sensitive Information</strong><br>
Users can search for instances of these documents and determine whether any sensitive information has been leaked in APM Server logs by searching for the following string</p>
<p>​​<code>message: \"unavailable_shards_exception\"</code> and <code>message: \"source\"</code></p>
<p><strong>Severity:</strong> CVSSv3: 5.7(Medium) - <a href=\"https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:A/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N\">AV:A/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N</a></p>
<p><strong>CVE ID:</strong> CVE-2024-37286</p>
            <p><small>1 post - 1 participant</small></p>
            <p><a href=\"https://discuss.elastic.co/t/apm-server-8-14-0-security-update-esa-2024-19/364289\">Read full topic</a></p>
          ") (link nil "https://discuss.elastic.co/t/apm-server-8-14-0-security-update-esa-2024-19/364289") (pubDate nil "Fri, 02 Aug 2024 20:20:04 +0000") (topicPinned nil "No") (topicClosed nil "No") (topicArchived nil "No") (guid ((isPermaLink . "false")) "discuss.elastic.co-topic-364289") (source ((url . "https://discuss.elastic.co/t/apm-server-8-14-0-security-update-esa-2024-19/364289.rss")) "APM Server 8.14.0 Security Update (ESA-2024-19)"))) ("Elasticsearch 8.13.0/7.17.23 Security Update (ESA-2024-12)" "<p>Elasticsearch elasticsearch-certutil csr fails to encrypt private key (ESA-2024-12)</p>
<p>It was discovered by Elastic engineering that when elasticsearch-certutil CLI tool is used with the csr option in order to create a new Certificate Signing Requests, the associated private key that is generated is stored on disk unencrypted even if the --pass parameter is passed in the command invocation.</p>
<p>Affected Versions:</p>
<p>Elasticsearch versions before 7.17.23 and before 8.13.0</p>
<p>Solutions and Mitigations:</p>
<p>The issue is resolved in version 7.17.23 and 8.13.0</p>
<p>Severity: CVSSv3: 4.9(Medium) - <a href=\"https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:N/A:N\">CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:N/A:N</a></p>
<p>CVE ID: CVE-2024-23444</p>
            <p><small>1 post - 1 participant</small></p>
            <p><a href=\"https://discuss.elastic.co/t/elasticsearch-8-13-0-7-17-23-security-update-esa-2024-12/364157\">Read full topic</a></p>" "https://discuss.elastic.co/t/elasticsearch-8-13-0-7-17-23-security-update-esa-2024-12/364157" (26282 28820) new 6 nil nil ((title nil "Elasticsearch 8.13.0/7.17.23 Security Update (ESA-2024-12)") (creator nil "Bryan_Garcia") (category nil "Security Announcements") (description nil "
            <p>Elasticsearch elasticsearch-certutil csr fails to encrypt private key (ESA-2024-12)</p>
<p>It was discovered by Elastic engineering that when elasticsearch-certutil CLI tool is used with the csr option in order to create a new Certificate Signing Requests, the associated private key that is generated is stored on disk unencrypted even if the --pass parameter is passed in the command invocation.</p>
<p>Affected Versions:</p>
<p>Elasticsearch versions before 7.17.23 and before 8.13.0</p>
<p>Solutions and Mitigations:</p>
<p>The issue is resolved in version 7.17.23 and 8.13.0</p>
<p>Severity: CVSSv3: 4.9(Medium) - <a href=\"https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:N/A:N\">CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:N/A:N</a></p>
<p>CVE ID: CVE-2024-23444</p>
            <p><small>1 post - 1 participant</small></p>
            <p><a href=\"https://discuss.elastic.co/t/elasticsearch-8-13-0-7-17-23-security-update-esa-2024-12/364157\">Read full topic</a></p>
          ") (link nil "https://discuss.elastic.co/t/elasticsearch-8-13-0-7-17-23-security-update-esa-2024-12/364157") (pubDate nil "Wed, 31 Jul 2024 17:12:52 +0000") (topicPinned nil "No") (topicClosed nil "No") (topicArchived nil "No") (guid ((isPermaLink . "false")) "discuss.elastic.co-topic-364157") (source ((url . "https://discuss.elastic.co/t/elasticsearch-8-13-0-7-17-23-security-update-esa-2024-12/364157.rss")) "Elasticsearch 8.13.0/7.17.23 Security Update (ESA-2024-12)"))) ("Kibana 7.17.23/8.14.0 Security Update (ESA-2024-16)" "<p>Kibana Denial of Service issue (ESA-2024-16)</p>
<p>An issue was discovered in Kibana where a user with Viewer role could cause a Kibana instance to crash by sending a large number of maliciously crafted requests to a specific endpoint.</p>
<p>Affected Versions:<br>
Kibana 8.x versions prior to 8.14.0 and Kibana 7.x versions prior to 7.17.23</p>
<p>Solutions and Mitigations:<br>
The issue is resolved in version 8.14.0 and 7.17.23.</p>
<p>Severity: CVSSv3: 6.5(Medium) - AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H/CR:M/IR:M/AR:M<br>
CVE ID: CVE-2024-37281</p>
            <p><small>1 post - 1 participant</small></p>
            <p><a href=\"https://discuss.elastic.co/t/kibana-7-17-23-8-14-0-security-update-esa-2024-16/364094\">Read full topic</a></p>" "https://discuss.elastic.co/t/kibana-7-17-23-8-14-0-security-update-esa-2024-16/364094" (26281 22935) new 7 nil nil ((title nil "Kibana 7.17.23/8.14.0 Security Update (ESA-2024-16)") (creator nil "Bryan_Garcia") (category nil "Security Announcements") (description nil "
            <p>Kibana Denial of Service issue (ESA-2024-16)</p>
<p>An issue was discovered in Kibana where a user with Viewer role could cause a Kibana instance to crash by sending a large number of maliciously crafted requests to a specific endpoint.</p>
<p>Affected Versions:<br>
Kibana 8.x versions prior to 8.14.0 and Kibana 7.x versions prior to 7.17.23</p>
<p>Solutions and Mitigations:<br>
The issue is resolved in version 8.14.0 and 7.17.23.</p>
<p>Severity: CVSSv3: 6.5(Medium) - AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H/CR:M/IR:M/AR:M<br>
CVE ID: CVE-2024-37281</p>
            <p><small>1 post - 1 participant</small></p>
            <p><a href=\"https://discuss.elastic.co/t/kibana-7-17-23-8-14-0-security-update-esa-2024-16/364094\">Read full topic</a></p>
          ") (link nil "https://discuss.elastic.co/t/kibana-7-17-23-8-14-0-security-update-esa-2024-16/364094") (pubDate nil "Tue, 30 Jul 2024 21:22:31 +0000") (topicPinned nil "No") (topicClosed nil "No") (topicArchived nil "No") (guid ((isPermaLink . "false")) "discuss.elastic.co-topic-364094") (source ((url . "https://discuss.elastic.co/t/kibana-7-17-23-8-14-0-security-update-esa-2024-16/364094.rss")) "Kibana 7.17.23/8.14.0 Security Update (ESA-2024-16)"))) ("Elastic Cloud Enterprise 3.7.2 Security Update (ESA-2024-18)" "<h3><a name=\"ece-improper-authorization-esa-2024-18-1\" class=\"anchor\" href=\"https://discuss.elastic.co#ece-improper-authorization-esa-2024-18-1\"></a>ECE Improper Authorization (ESA-2024-18)</h3>
<p>It was identified that under certain specific preconditions, an <a href=\"https://www.elastic.co/guide/en/cloud-enterprise/current/ece-restful-api-authentication.html#ece-api-keys\">API key</a> that was originally created with a specific privileges could be subsequently used to create new API keys that have elevated privileges.</p>
<h3><a name=\"affected-versions-2\" class=\"anchor\" href=\"https://discuss.elastic.co#affected-versions-2\"></a>Affected Versions:</h3>
<p>ECE versions after 3.0.0 and before 3.7.2</p>
<h3><a name=\"solutions-and-mitigations-3\" class=\"anchor\" href=\"https://discuss.elastic.co#solutions-and-mitigations-3\"></a>Solutions and Mitigations:</h3>
<p>Users should upgrade to version 3.7.2.</p>
<p><strong>Severity:</strong> CVSSv3: 8.1(High) - <a href=\"https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H\">CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H</a></p>
<p><strong>CVE ID:</strong> CVE-2024-37282</p>
            <p><small>1 post - 1 participant</small></p>
            <p><a href=\"https://discuss.elastic.co/t/elastic-cloud-enterprise-3-7-2-security-update-esa-2024-18/362181\">Read full topic</a></p>" "https://discuss.elastic.co/t/elastic-cloud-enterprise-3-7-2-security-update-esa-2024-18/362181" (26238 16885) new 8 nil nil ((title nil "Elastic Cloud Enterprise 3.7.2 Security Update (ESA-2024-18)") (creator nil "ikakavas") (category nil "Security Announcements") (description nil "
            <h3><a name=\"ece-improper-authorization-esa-2024-18-1\" class=\"anchor\" href=\"https://discuss.elastic.co#ece-improper-authorization-esa-2024-18-1\"></a>ECE Improper Authorization (ESA-2024-18)</h3>
<p>It was identified that under certain specific preconditions, an <a href=\"https://www.elastic.co/guide/en/cloud-enterprise/current/ece-restful-api-authentication.html#ece-api-keys\">API key</a> that was originally created with a specific privileges could be subsequently used to create new API keys that have elevated privileges.</p>
<h3><a name=\"affected-versions-2\" class=\"anchor\" href=\"https://discuss.elastic.co#affected-versions-2\"></a>Affected Versions:</h3>
<p>ECE versions after 3.0.0 and before 3.7.2</p>
<h3><a name=\"solutions-and-mitigations-3\" class=\"anchor\" href=\"https://discuss.elastic.co#solutions-and-mitigations-3\"></a>Solutions and Mitigations:</h3>
<p>Users should upgrade to version 3.7.2.</p>
<p><strong>Severity:</strong> CVSSv3: 8.1(High) - <a href=\"https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H\">CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H</a></p>
<p><strong>CVE ID:</strong> CVE-2024-37282</p>
            <p><small>1 post - 1 participant</small></p>
            <p><a href=\"https://discuss.elastic.co/t/elastic-cloud-enterprise-3-7-2-security-update-esa-2024-18/362181\">Read full topic</a></p>
          ") (link nil "https://discuss.elastic.co/t/elastic-cloud-enterprise-3-7-2-security-update-esa-2024-18/362181") (pubDate nil "Fri, 28 Jun 2024 04:54:13 +0000") (topicPinned nil "No") (topicClosed nil "No") (topicArchived nil "No") (guid ((isPermaLink . "false")) "discuss.elastic.co-topic-362181") (source ((url . "https://discuss.elastic.co/t/elastic-cloud-enterprise-3-7-2-security-update-esa-2024-18/362181.rss")) "Elastic Cloud Enterprise 3.7.2 Security Update (ESA-2024-18)"))) ("Kibana 7.17.22 / 8.14.0 Security Update (ESA-2024-17)" "<p><strong>Kibana RCE due to chromium type confusion (ESA-2024-17)</strong></p>
<p>On March 26, 2024, a type confusion vulnerability was found in WebAssembly in Google Chrome version prior to 123.0.6312.86 which allows a remote attacker to execute arbitrary code via a crafted HTML page.</p>
<p>Kibana includes a bundled version of headless Chromium that is only used for Kibana’s reporting capabilities and which is affected by this vulnerability. An exploit for Kibana has not been identified, however as a resolution, the bundled version of Chromium is updated in this release.</p>
<p>This issue affects on-premises Kibana installations on host Operating Systems where <a href=\"https://www.elastic.co/guide/en/kibana/current/reporting-production-considerations.html#reporting-chromium-sandbox\">Chromium sandbox is disabled </a> (only CentOS, Debian, RHEL).</p>
<p>This issue affects Kibana instances running using the Kibana Docker image when the Chromium sandbox is explicitly disabled as suggested by the documentation. Further exploitation such as container escape is prevented by seccomp-bpf.</p>
<p>This issue affects Kibana instances running on Elastic Cloud but the RCE is limited within the Kibana Docker container. Further exploitation such as container escape is prevented by seccomp-bpf and AppArmor profiles.</p>
<p>This issue affects Kibana instances running on Elastic Cloud Enterprise (ECE) but the RCE is limited within the Kibana Docker container. Further exploitation such as container escape is prevented by seccomp-bpf and AppArmor profiles.</p>
<p>This issue affects Kibana instances running on Elastic Cloud on Kubernetes (ECK) but the RCE is limited within the Kibana Docker container. Further exploitation such as container escape can be prevented by seccomp-bpf when configured and supported (Kubernetes v1.19 and later).</p>
<p><strong>Affected Versions:</strong><br>
Kibana version 7.17.21 and Kibana 8.13.x versions prior to 8.14.0.</p>
<p><strong>Solutions and Mitigations:</strong><br>
Users should upgrade to versions 7.17.22 and 8.14.0</p>
<p>For users that cannot upgrade, users can disable Kibana reporting functionality completely in the kibana.yml file with the following setting: xpack.reporting.enabled: false<br>
If users rely on CSV reports may want an option to only disable the screenshot-based reports. The setting for that is:<br>
xpack.reporting.pdf.enabled: false<br>
xpack.reporting.png.enabled: false</p>
<p><strong>Severity:</strong> CVSSv3: 9.9 (Critical) - AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H/CR:M/IR:M/AR:M</p>
<p><strong>CVE ID:</strong> CVE-2024-2887</p>
            <p><small>1 post - 1 participant</small></p>
            <p><a href=\"https://discuss.elastic.co/t/kibana-7-17-22-8-14-0-security-update-esa-2024-17/361508\">Read full topic</a></p>" "https://discuss.elastic.co/t/kibana-7-17-22-8-14-0-security-update-esa-2024-17/361508" (26220 24957) new 9 nil nil ((title nil "Kibana 7.17.22 / 8.14.0 Security Update (ESA-2024-17)") (creator nil "Bryan_Garcia") (category nil "Security Announcements") (description nil "
            <p><strong>Kibana RCE due to chromium type confusion (ESA-2024-17)</strong></p>
<p>On March 26, 2024, a type confusion vulnerability was found in WebAssembly in Google Chrome version prior to 123.0.6312.86 which allows a remote attacker to execute arbitrary code via a crafted HTML page.</p>
<p>Kibana includes a bundled version of headless Chromium that is only used for Kibana’s reporting capabilities and which is affected by this vulnerability. An exploit for Kibana has not been identified, however as a resolution, the bundled version of Chromium is updated in this release.</p>
<p>This issue affects on-premises Kibana installations on host Operating Systems where <a href=\"https://www.elastic.co/guide/en/kibana/current/reporting-production-considerations.html#reporting-chromium-sandbox\">Chromium sandbox is disabled </a> (only CentOS, Debian, RHEL).</p>
<p>This issue affects Kibana instances running using the Kibana Docker image when the Chromium sandbox is explicitly disabled as suggested by the documentation. Further exploitation such as container escape is prevented by seccomp-bpf.</p>
<p>This issue affects Kibana instances running on Elastic Cloud but the RCE is limited within the Kibana Docker container. Further exploitation such as container escape is prevented by seccomp-bpf and AppArmor profiles.</p>
<p>This issue affects Kibana instances running on Elastic Cloud Enterprise (ECE) but the RCE is limited within the Kibana Docker container. Further exploitation such as container escape is prevented by seccomp-bpf and AppArmor profiles.</p>
<p>This issue affects Kibana instances running on Elastic Cloud on Kubernetes (ECK) but the RCE is limited within the Kibana Docker container. Further exploitation such as container escape can be prevented by seccomp-bpf when configured and supported (Kubernetes v1.19 and later).</p>
<p><strong>Affected Versions:</strong><br>
Kibana version 7.17.21 and Kibana 8.13.x versions prior to 8.14.0.</p>
<p><strong>Solutions and Mitigations:</strong><br>
Users should upgrade to versions 7.17.22 and 8.14.0</p>
<p>For users that cannot upgrade, users can disable Kibana reporting functionality completely in the kibana.yml file with the following setting: xpack.reporting.enabled: false<br>
If users rely on CSV reports may want an option to only disable the screenshot-based reports. The setting for that is:<br>
xpack.reporting.pdf.enabled: false<br>
xpack.reporting.png.enabled: false</p>
<p><strong>Severity:</strong> CVSSv3: 9.9 (Critical) - AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H/CR:M/IR:M/AR:M</p>
<p><strong>CVE ID:</strong> CVE-2024-2887</p>
            <p><small>1 post - 1 participant</small></p>
            <p><a href=\"https://discuss.elastic.co/t/kibana-7-17-22-8-14-0-security-update-esa-2024-17/361508\">Read full topic</a></p>
          ") (link nil "https://discuss.elastic.co/t/kibana-7-17-22-8-14-0-security-update-esa-2024-17/361508") (pubDate nil "Fri, 14 Jun 2024 15:27:57 +0000") (topicPinned nil "No") (topicClosed nil "No") (topicArchived nil "No") (guid ((isPermaLink . "false")) "discuss.elastic.co-topic-361508") (source ((url . "https://discuss.elastic.co/t/kibana-7-17-22-8-14-0-security-update-esa-2024-17/361508.rss")) "Kibana 7.17.22 / 8.14.0 Security Update (ESA-2024-17)"))) ("Kibana 8.14.0/7.17.22 Security Update (ESA-2024-10)" "<p><strong>Kibana open redirect issue (ESA-2024-10).</strong></p>
<p>An open redirect issue was discovered in Kibana that could lead to a user being redirected to an arbitrary website if they use a maliciously crafted Kibana URL.</p>
<p><strong>Affected Versions:</strong><br>
Kibana Versions before 7.17.22 and before 8.14.0.</p>
<p><strong>Solutions and Mitigations:</strong><br>
The issue is resolved in versions 7.17.22 and 8.14.0.</p>
<p><strong>Severity:</strong> CVSSv3: 6.1(Medium) - AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N</p>
<p><strong>CVE ID:</strong> CVE-2024-23442</p>
            <p><small>1 post - 1 participant</small></p>
            <p><a href=\"https://discuss.elastic.co/t/kibana-8-14-0-7-17-22-security-update-esa-2024-10/361502\">Read full topic</a></p>" "https://discuss.elastic.co/t/kibana-8-14-0-7-17-22-security-update-esa-2024-10/361502" (26220 20237) new 10 nil nil ((title nil "Kibana 8.14.0/7.17.22 Security Update (ESA-2024-10)") (creator nil "rodrigo_silva") (category nil "Security Announcements") (description nil "
            <p><strong>Kibana open redirect issue (ESA-2024-10).</strong></p>
<p>An open redirect issue was discovered in Kibana that could lead to a user being redirected to an arbitrary website if they use a maliciously crafted Kibana URL.</p>
<p><strong>Affected Versions:</strong><br>
Kibana Versions before 7.17.22 and before 8.14.0.</p>
<p><strong>Solutions and Mitigations:</strong><br>
The issue is resolved in versions 7.17.22 and 8.14.0.</p>
<p><strong>Severity:</strong> CVSSv3: 6.1(Medium) - AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N</p>
<p><strong>CVE ID:</strong> CVE-2024-23442</p>
            <p><small>1 post - 1 participant</small></p>
            <p><a href=\"https://discuss.elastic.co/t/kibana-8-14-0-7-17-22-security-update-esa-2024-10/361502\">Read full topic</a></p>
          ") (link nil "https://discuss.elastic.co/t/kibana-8-14-0-7-17-22-security-update-esa-2024-10/361502") (pubDate nil "Fri, 14 Jun 2024 14:09:17 +0000") (topicPinned nil "No") (topicClosed nil "No") (topicArchived nil "No") (guid ((isPermaLink . "false")) "discuss.elastic.co-topic-361502") (source ((url . "https://discuss.elastic.co/t/kibana-8-14-0-7-17-22-security-update-esa-2024-10/361502.rss")) "Kibana 8.14.0/7.17.22 Security Update (ESA-2024-10)"))) ("Kibana 8.14.0/7.17.22 Security Update (ESA-2024-11)" "<h2><a name=\"kibana-uncontrolled-resource-consumption-esa-2024-11-1\" class=\"anchor\" href=\"https://discuss.elastic.co#kibana-uncontrolled-resource-consumption-esa-2024-11-1\"></a>Kibana uncontrolled resource consumption (ESA-2024-11)</h2>
<p>A high-privileged user, allowed to create <a href=\"https://www.elastic.co/guide/en/kibana/current/osquery.html#osquery-schedule-query\">custom osquery packs</a> could affect the availability of Kibana by uploading a maliciously crafted osquery pack.</p>
<h3><a name=\"affected-versions-2\" class=\"anchor\" href=\"https://discuss.elastic.co#affected-versions-2\"></a>Affected Versions:</h3>
<p>Kibana versions before 7.17.22 and before 8.14.0</p>
<h3><a name=\"solutions-and-mitigations-3\" class=\"anchor\" href=\"https://discuss.elastic.co#solutions-and-mitigations-3\"></a>Solutions and Mitigations:</h3>
<p>The issue is resolved in version 7.17.22 and 8.14.0</p>
<p><strong>Severity</strong>: CVSSv3.1: 4.9(Medium) - <a href=\"https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:N/I:N/A:H\">CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:N/I:N/A:H</a></p>
<p><strong>CVE ID:</strong> CVE-2024-23443</p>
            <p><small>1 post - 1 participant</small></p>
            <p><a href=\"https://discuss.elastic.co/t/kibana-8-14-0-7-17-22-security-update-esa-2024-11/361460\">Read full topic</a></p>" "https://discuss.elastic.co/t/kibana-8-14-0-7-17-22-security-update-esa-2024-11/361460" (26219 52085) new 11 nil nil ((title nil "Kibana 8.14.0/7.17.22 Security Update (ESA-2024-11)") (creator nil "ikakavas") (category nil "Security Announcements") (description nil "
            <h2><a name=\"kibana-uncontrolled-resource-consumption-esa-2024-11-1\" class=\"anchor\" href=\"https://discuss.elastic.co#kibana-uncontrolled-resource-consumption-esa-2024-11-1\"></a>Kibana uncontrolled resource consumption (ESA-2024-11)</h2>
<p>A high-privileged user, allowed to create <a href=\"https://www.elastic.co/guide/en/kibana/current/osquery.html#osquery-schedule-query\">custom osquery packs</a> could affect the availability of Kibana by uploading a maliciously crafted osquery pack.</p>
<h3><a name=\"affected-versions-2\" class=\"anchor\" href=\"https://discuss.elastic.co#affected-versions-2\"></a>Affected Versions:</h3>
<p>Kibana versions before 7.17.22 and before 8.14.0</p>
<h3><a name=\"solutions-and-mitigations-3\" class=\"anchor\" href=\"https://discuss.elastic.co#solutions-and-mitigations-3\"></a>Solutions and Mitigations:</h3>
<p>The issue is resolved in version 7.17.22 and 8.14.0</p>
<p><strong>Severity</strong>: CVSSv3.1: 4.9(Medium) - <a href=\"https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:N/I:N/A:H\">CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:N/I:N/A:H</a></p>
<p><strong>CVE ID:</strong> CVE-2024-23443</p>
            <p><small>1 post - 1 participant</small></p>
            <p><a href=\"https://discuss.elastic.co/t/kibana-8-14-0-7-17-22-security-update-esa-2024-11/361460\">Read full topic</a></p>
          ") (link nil "https://discuss.elastic.co/t/kibana-8-14-0-7-17-22-security-update-esa-2024-11/361460") (pubDate nil "Fri, 14 Jun 2024 04:47:49 +0000") (topicPinned nil "No") (topicClosed nil "No") (topicArchived nil "No") (guid ((isPermaLink . "false")) "discuss.elastic.co-topic-361460") (source ((url . "https://discuss.elastic.co/t/kibana-8-14-0-7-17-22-security-update-esa-2024-11/361460.rss")) "Kibana 8.14.0/7.17.22 Security Update (ESA-2024-11)"))) ("Elasticsearch 8.14.0 Security Update (ESA-2024-14)" "<p><strong>Elasticsearch StackOverflow vulnerability (ESA-2024-14)</strong></p>
<p>A flaw was discovered in Elasticsearch, affecting document ingestion when an index template contains a dynamic field mapping of “passthrough” type. Under certain circumstances, ingesting documents in this index would cause a StackOverflow exception to be thrown and ultimately lead to a Denial of Service. Note that passthrough fields is an experimental feature.</p>
<p><strong>Affected Versions:</strong><br>
Elasticsearch version 8.13.1 through 8.13.4.</p>
<p><strong>Solutions and Mitigations:</strong><br>
The issue is resolved in Elasticsearch 8.14.0.</p>
<p><strong>Severity:</strong> CVSSv3: 4.9(Medium) - AV:N/AC:L/PR:H/UI:N/S:U/C:N/I:N/A:H</p>
<p><strong>CVE ID:</strong> CVE-2024-37280</p>
            <p><small>1 post - 1 participant</small></p>
            <p><a href=\"https://discuss.elastic.co/t/elasticsearch-8-14-0-security-update-esa-2024-14/361007\">Read full topic</a></p>" "https://discuss.elastic.co/t/elasticsearch-8-14-0-security-update-esa-2024-14/361007" (26210 34651) new 12 nil nil ((title nil "Elasticsearch 8.14.0 Security Update (ESA-2024-14)") (creator nil "rodrigo_silva") (category nil "Security Announcements") (description nil "
            <p><strong>Elasticsearch StackOverflow vulnerability (ESA-2024-14)</strong></p>
<p>A flaw was discovered in Elasticsearch, affecting document ingestion when an index template contains a dynamic field mapping of “passthrough” type. Under certain circumstances, ingesting documents in this index would cause a StackOverflow exception to be thrown and ultimately lead to a Denial of Service. Note that passthrough fields is an experimental feature.</p>
<p><strong>Affected Versions:</strong><br>
Elasticsearch version 8.13.1 through 8.13.4.</p>
<p><strong>Solutions and Mitigations:</strong><br>
The issue is resolved in Elasticsearch 8.14.0.</p>
<p><strong>Severity:</strong> CVSSv3: 4.9(Medium) - AV:N/AC:L/PR:H/UI:N/S:U/C:N/I:N/A:H</p>
<p><strong>CVE ID:</strong> CVE-2024-37280</p>
            <p><small>1 post - 1 participant</small></p>
            <p><a href=\"https://discuss.elastic.co/t/elasticsearch-8-14-0-security-update-esa-2024-14/361007\">Read full topic</a></p>
          ") (link nil "https://discuss.elastic.co/t/elasticsearch-8-14-0-security-update-esa-2024-14/361007") (pubDate nil "Fri, 07 Jun 2024 04:06:51 +0000") (topicPinned nil "No") (topicClosed nil "No") (topicArchived nil "No") (guid ((isPermaLink . "false")) "discuss.elastic.co-topic-361007") (source ((url . "https://discuss.elastic.co/t/elasticsearch-8-14-0-security-update-esa-2024-14/361007.rss")) "Elasticsearch 8.14.0 Security Update (ESA-2024-14)"))) ("Elasticsearch 8.14.0 Security Update (ESA-2024-13)" "<h3><a name=\"elasticsearch-remote-cluster-search-cross-cluster-api-key-insufficient-restrictions-esa-2024-13-1\" class=\"anchor\" href=\"https://discuss.elastic.co#elasticsearch-remote-cluster-search-cross-cluster-api-key-insufficient-restrictions-esa-2024-13-1\"></a>Elasticsearch Remote Cluster Search Cross Cluster API Key insufficient restrictions (ESA-2024-13)</h3>
<p>It was identified that if a <a href=\"https://www.elastic.co/guide/en/elasticsearch/reference/8.14/security-api-create-cross-cluster-api-key.html#security-api-create-cross-cluster-api-key-request-body\">cross-cluster API key</a> restricts search for a given index using the <code>query</code> or the <code>field_security</code> parameter, and the same cross-cluster API key also grants replication for the same index, the search restrictions are not enforced during cross cluster search operations and search results may include documents and terms that should not be returned.</p>
<p>This issue only affects the <a href=\"https://www.elastic.co/guide/en/elasticsearch/reference/8.14/remote-clusters.html#remote-clusters-security-models\">API key based security model for remote clusters</a> that was previously a beta feature and is released as GA with 8.14.0</p>
<p>We would like to thank René Kalff for bringing this issue to our attention.</p>
<h3><a name=\"affected-versions-2\" class=\"anchor\" href=\"https://discuss.elastic.co#affected-versions-2\"></a>Affected Versions:</h3>
<p>Elasticsearch version on or after 8.10.0 and before 8.14.0</p>
<h3><a name=\"solutions-and-mitigations-3\" class=\"anchor\" href=\"https://discuss.elastic.co#solutions-and-mitigations-3\"></a>Solutions and Mitigations:</h3>
<p>The issue is resolved in version 8.14.0.</p>
<p><strong>Severity</strong>: CVSSv3: 6.5(Medium) - <a href=\"https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N\">CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N</a></p>
<p><strong>CVE ID</strong>: CVE-2024-23445</p>
            <p><small>1 post - 1 participant</small></p>
            <p><a href=\"https://discuss.elastic.co/t/elasticsearch-8-14-0-security-update-esa-2024-13/360898\">Read full topic</a></p>" "https://discuss.elastic.co/t/elasticsearch-8-14-0-security-update-esa-2024-13/360898" (26209 11747) new 13 nil nil ((title nil "Elasticsearch 8.14.0 Security Update (ESA-2024-13)") (creator nil "ikakavas") (category nil "Security Announcements") (description nil "
            <h3><a name=\"elasticsearch-remote-cluster-search-cross-cluster-api-key-insufficient-restrictions-esa-2024-13-1\" class=\"anchor\" href=\"https://discuss.elastic.co#elasticsearch-remote-cluster-search-cross-cluster-api-key-insufficient-restrictions-esa-2024-13-1\"></a>Elasticsearch Remote Cluster Search Cross Cluster API Key insufficient restrictions (ESA-2024-13)</h3>
<p>It was identified that if a <a href=\"https://www.elastic.co/guide/en/elasticsearch/reference/8.14/security-api-create-cross-cluster-api-key.html#security-api-create-cross-cluster-api-key-request-body\">cross-cluster API key</a> restricts search for a given index using the <code>query</code> or the <code>field_security</code> parameter, and the same cross-cluster API key also grants replication for the same index, the search restrictions are not enforced during cross cluster search operations and search results may include documents and terms that should not be returned.</p>
<p>This issue only affects the <a href=\"https://www.elastic.co/guide/en/elasticsearch/reference/8.14/remote-clusters.html#remote-clusters-security-models\">API key based security model for remote clusters</a> that was previously a beta feature and is released as GA with 8.14.0</p>
<p>We would like to thank René Kalff for bringing this issue to our attention.</p>
<h3><a name=\"affected-versions-2\" class=\"anchor\" href=\"https://discuss.elastic.co#affected-versions-2\"></a>Affected Versions:</h3>
<p>Elasticsearch version on or after 8.10.0 and before 8.14.0</p>
<h3><a name=\"solutions-and-mitigations-3\" class=\"anchor\" href=\"https://discuss.elastic.co#solutions-and-mitigations-3\"></a>Solutions and Mitigations:</h3>
<p>The issue is resolved in version 8.14.0.</p>
<p><strong>Severity</strong>: CVSSv3: 6.5(Medium) - <a href=\"https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N\">CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N</a></p>
<p><strong>CVE ID</strong>: CVE-2024-23445</p>
            <p><small>1 post - 1 participant</small></p>
            <p><a href=\"https://discuss.elastic.co/t/elasticsearch-8-14-0-security-update-esa-2024-13/360898\">Read full topic</a></p>
          ") (link nil "https://discuss.elastic.co/t/elasticsearch-8-14-0-security-update-esa-2024-13/360898") (pubDate nil "Thu, 06 Jun 2024 03:32:51 +0000") (topicPinned nil "No") (topicClosed nil "No") (topicArchived nil "No") (guid ((isPermaLink . "false")) "discuss.elastic.co-topic-360898") (source ((url . "https://discuss.elastic.co/t/elasticsearch-8-14-0-security-update-esa-2024-13/360898.rss")) "Elasticsearch 8.14.0 Security Update (ESA-2024-13)"))) ("Elastic Cloud Enterprise 3.7.1 Security Update (ESA-2024-08)" "<p><strong>Elastic Cloud Enterprise - Uncontrolled Resource Consumption through HTTP/2 endpoints - CVE-2023-45288 (ESA-2024-08)</strong></p>
<p>On April 4, 2024, the Go Project announced CVE-2023-45288, which can lead to CPU exhaustion as an attacker can cause an HTTP/2 endpoint to read arbitrary amounts of header data.</p>
<p>In the case of Elastic Cloud Enterprise (ECE) it enables attackers to significantly increase the CPU usage of the proxy component within Elastic Cloud Enterprise. This heightened CPU usage can lead to a noticeable slowdown in the system's ability to respond to requests for provisioned deployments, and in severe cases, it may prevent the proxy from responding to such requests entirely.</p>
<p><strong>Affected Versions:</strong><br>
Elastic Cloud Enterprise versions up to, but not including, 3.7.1</p>
<p><strong>Solutions and Mitigations:</strong><br>
Users should upgrade to version 3.7.1</p>
<p><strong>Severity:</strong> 5.3 (Medium) <a href=\"https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L\">CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L</a></p>
<p><strong>CVE ID:</strong> CVE-2023-45288</p>
            <p><small>1 post - 1 participant</small></p>
            <p><a href=\"https://discuss.elastic.co/t/elastic-cloud-enterprise-3-7-1-security-update-esa-2024-08/360888\">Read full topic</a></p>" "https://discuss.elastic.co/t/elastic-cloud-enterprise-3-7-1-security-update-esa-2024-08/360888" (26208 53577) new 14 nil nil ((title nil "Elastic Cloud Enterprise 3.7.1 Security Update (ESA-2024-08)") (creator nil "rodrigo_silva") (category nil "Security Announcements") (description nil "
            <p><strong>Elastic Cloud Enterprise - Uncontrolled Resource Consumption through HTTP/2 endpoints - CVE-2023-45288 (ESA-2024-08)</strong></p>
<p>On April 4, 2024, the Go Project announced CVE-2023-45288, which can lead to CPU exhaustion as an attacker can cause an HTTP/2 endpoint to read arbitrary amounts of header data.</p>
<p>In the case of Elastic Cloud Enterprise (ECE) it enables attackers to significantly increase the CPU usage of the proxy component within Elastic Cloud Enterprise. This heightened CPU usage can lead to a noticeable slowdown in the system's ability to respond to requests for provisioned deployments, and in severe cases, it may prevent the proxy from responding to such requests entirely.</p>
<p><strong>Affected Versions:</strong><br>
Elastic Cloud Enterprise versions up to, but not including, 3.7.1</p>
<p><strong>Solutions and Mitigations:</strong><br>
Users should upgrade to version 3.7.1</p>
<p><strong>Severity:</strong> 5.3 (Medium) <a href=\"https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L\">CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L</a></p>
<p><strong>CVE ID:</strong> CVE-2023-45288</p>
            <p><small>1 post - 1 participant</small></p>
            <p><a href=\"https://discuss.elastic.co/t/elastic-cloud-enterprise-3-7-1-security-update-esa-2024-08/360888\">Read full topic</a></p>
          ") (link nil "https://discuss.elastic.co/t/elastic-cloud-enterprise-3-7-1-security-update-esa-2024-08/360888") (pubDate nil "Wed, 05 Jun 2024 20:57:45 +0000") (topicPinned nil "No") (topicClosed nil "No") (topicArchived nil "No") (guid ((isPermaLink . "false")) "discuss.elastic.co-topic-360888") (source ((url . "https://discuss.elastic.co/t/elastic-cloud-enterprise-3-7-1-security-update-esa-2024-08/360888.rss")) "Elastic Cloud Enterprise 3.7.1 Security Update (ESA-2024-08)"))) ("Kibana 8.14.0 Security Update (ESA-2024-15)" "<p><strong>Kibana Broken Access Control issue (ESA-2024-15)</strong></p>
<p>A flaw was discovered in Kibana, allowing <code>view-only</code> users of alerting to use the <code>run_soon</code> API making the alerting rule run continuously, potentially affecting the system availability if the alerting rule is running complex queries.</p>
<p><strong>Affected Versions:</strong><br>
Kibana versions 8.6.3 through 8.13.4.</p>
<p><strong>Solutions and Mitigations:</strong><br>
The issue is resolved in version 8.14.0.</p>
<p><strong>Severity:</strong> CVSSv3: 4.3(Medium) - AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:L</p>
<p><strong>CVE ID:</strong> CVE-2024-37279</p>
            <p><small>1 post - 1 participant</small></p>
            <p><a href=\"https://discuss.elastic.co/t/kibana-8-14-0-security-update-esa-2024-15/360887\">Read full topic</a></p>" "https://discuss.elastic.co/t/kibana-8-14-0-security-update-esa-2024-15/360887" (26208 52851) new 15 nil nil ((title nil "Kibana 8.14.0 Security Update (ESA-2024-15)") (creator nil "rodrigo_silva") (category nil "Security Announcements") (description nil "
            <p><strong>Kibana Broken Access Control issue (ESA-2024-15)</strong></p>
<p>A flaw was discovered in Kibana, allowing <code>view-only</code> users of alerting to use the <code>run_soon</code> API making the alerting rule run continuously, potentially affecting the system availability if the alerting rule is running complex queries.</p>
<p><strong>Affected Versions:</strong><br>
Kibana versions 8.6.3 through 8.13.4.</p>
<p><strong>Solutions and Mitigations:</strong><br>
The issue is resolved in version 8.14.0.</p>
<p><strong>Severity:</strong> CVSSv3: 4.3(Medium) - AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:L</p>
<p><strong>CVE ID:</strong> CVE-2024-37279</p>
            <p><small>1 post - 1 participant</small></p>
            <p><a href=\"https://discuss.elastic.co/t/kibana-8-14-0-security-update-esa-2024-15/360887\">Read full topic</a></p>
          ") (link nil "https://discuss.elastic.co/t/kibana-8-14-0-security-update-esa-2024-15/360887") (pubDate nil "Wed, 05 Jun 2024 20:45:39 +0000") (topicPinned nil "No") (topicClosed nil "No") (topicArchived nil "No") (guid ((isPermaLink . "false")) "discuss.elastic.co-topic-360887") (source ((url . "https://discuss.elastic.co/t/kibana-8-14-0-security-update-esa-2024-15/360887.rss")) "Kibana 8.14.0 Security Update (ESA-2024-15)"))) ("Elastic Security Statement for CVE-2024-3094, xz versions 5.6.0 and 5.6.1" "<p><strong>Elastic Products are not affected by this issue.</strong></p>
<p>On March 29th, 2024, Elastic became aware of the <a href=\"https://www.elastic.co/security-labs/500ms-to-midnight\">malicious code planted in the xz package</a>.</p>
<p>Elastic has performed an investigation to identify any Elastic Products which may be impacted by this issue and we have concluded that no Elastic products use the versions of xz affected by this vulnerability. Therefore, Elastic Products are not affected by this issue.</p>
<p>Reference Links:</p>
<ul>
<li><a href=\"https://www.openwall.com/lists/oss-security/2024/03/29/4\" class=\"inline-onebox\">oss-security - backdoor in upstream xz/liblzma leading to ssh server compromise</a></li>
<li><a href=\"https://www.elastic.co/security-labs/500ms-to-midnight\" class=\"inline-onebox\">500ms to midnight: XZ / liblzma backdoor — Elastic Security Labs</a></li>
<li><a href=\"https://www.redhat.com/en/blog/urgent-security-alert-fedora-41-and-rawhide-users\" class=\"inline-onebox\">Urgent security alert for Fedora 41 and Fedora Rawhide users</a></li>
<li><a href=\"https://lists.debian.org/debian-security-announce/2024/msg00057.html\" class=\"inline-onebox\">[SECURITY] [DSA 5649-1] xz-utils security update</a></li>
<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2024-3094\" class=\"inline-onebox\">NVD - CVE-2024-3094</a></li>
</ul>
            <p><small>1 post - 1 participant</small></p>
            <p><a href=\"https://discuss.elastic.co/t/elastic-security-statement-for-cve-2024-3094-xz-versions-5-6-0-and-5-6-1/357894\">Read full topic</a></p>" "https://discuss.elastic.co/t/elastic-security-statement-for-cve-2024-3094-xz-versions-5-6-0-and-5-6-1/357894" (26150 11178) new 16 nil nil ((title nil "Elastic Security Statement for CVE-2024-3094, xz versions 5.6.0 and 5.6.1") (creator nil "ismisepaul") (category nil "Security Announcements") (description nil "
            <p><strong>Elastic Products are not affected by this issue.</strong></p>
<p>On March 29th, 2024, Elastic became aware of the <a href=\"https://www.elastic.co/security-labs/500ms-to-midnight\">malicious code planted in the xz package</a>.</p>
<p>Elastic has performed an investigation to identify any Elastic Products which may be impacted by this issue and we have concluded that no Elastic products use the versions of xz affected by this vulnerability. Therefore, Elastic Products are not affected by this issue.</p>
<p>Reference Links:</p>
<ul>
<li><a href=\"https://www.openwall.com/lists/oss-security/2024/03/29/4\" class=\"inline-onebox\">oss-security - backdoor in upstream xz/liblzma leading to ssh server compromise</a></li>
<li><a href=\"https://www.elastic.co/security-labs/500ms-to-midnight\" class=\"inline-onebox\">500ms to midnight: XZ / liblzma backdoor — Elastic Security Labs</a></li>
<li><a href=\"https://www.redhat.com/en/blog/urgent-security-alert-fedora-41-and-rawhide-users\" class=\"inline-onebox\">Urgent security alert for Fedora 41 and Fedora Rawhide users</a></li>
<li><a href=\"https://lists.debian.org/debian-security-announce/2024/msg00057.html\" class=\"inline-onebox\">[SECURITY] [DSA 5649-1] xz-utils security update</a></li>
<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2024-3094\" class=\"inline-onebox\">NVD - CVE-2024-3094</a></li>
</ul>
            <p><small>1 post - 1 participant</small></p>
            <p><a href=\"https://discuss.elastic.co/t/elastic-security-statement-for-cve-2024-3094-xz-versions-5-6-0-and-5-6-1/357894\">Read full topic</a></p>
          ") (link nil "https://discuss.elastic.co/t/elastic-security-statement-for-cve-2024-3094-xz-versions-5-6-0-and-5-6-1/357894") (pubDate nil "Mon, 22 Apr 2024 09:19:38 +0000") (topicPinned nil "No") (topicClosed nil "No") (topicArchived nil "No") (guid ((isPermaLink . "false")) "discuss.elastic.co-topic-357894") (source ((url . "https://discuss.elastic.co/t/elastic-security-statement-for-cve-2024-3094-xz-versions-5-6-0-and-5-6-1/357894.rss")) "Elastic Security Statement for CVE-2024-3094, xz versions 5.6.0 and 5.6.1"))) ("Elasticsearch 8.11.1 Security Update (ESA-2024-05)" "<p><strong>Elasticsearch Uncaught Exception (ESA-2024-05)</strong></p>
<p>An uncaught exception in Elasticsearch &gt;= 8.4.0 and &lt; 8.11.1 occurs when an encrypted PDF is passed to an <a href=\"https://www.elastic.co/guide/en/elasticsearch/reference/current/attachment.html\">attachment processor</a> through the REST API. The Elasticsearch ingest node that attempts to parse the PDF file will crash. This does not happen with password-protected PDF files or with unencrypted PDF files.</p>
<p><strong>Affected Versions:</strong><br>
Affects versions &gt;= 8.4.0 and &lt; 8.11.1</p>
<p><strong>Solutions and Mitigations:</strong><br>
The issue is resolved in version 8.11.1.</p>
<p>This requires the attachment processor to be enabled. Users unable to upgrade can ensure that the <a href=\"https://www.elastic.co/guide/en/elasticsearch/reference/current/attachment.html\">attachment processor</a> is disabled.</p>
<p><strong>Severity:</strong> CVSSv3: 4.3(Medium) - <a href=\"https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:L\">CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:L</a></p>
<p><strong>CVE ID:</strong> CVE-2024-23449</p>
            <p><small>1 post - 1 participant</small></p>
            <p><a href=\"https://discuss.elastic.co/t/elasticsearch-8-11-1-security-update-esa-2024-05/356458\">Read full topic</a></p>" "https://discuss.elastic.co/t/elasticsearch-8-11-1-security-update-esa-2024-05/356458" (26118 41505) new 17 nil nil ((title nil "Elasticsearch 8.11.1 Security Update (ESA-2024-05)") (creator nil "ismisepaul") (category nil "Security Announcements") (description nil "
            <p><strong>Elasticsearch Uncaught Exception (ESA-2024-05)</strong></p>
<p>An uncaught exception in Elasticsearch &gt;= 8.4.0 and &lt; 8.11.1 occurs when an encrypted PDF is passed to an <a href=\"https://www.elastic.co/guide/en/elasticsearch/reference/current/attachment.html\">attachment processor</a> through the REST API. The Elasticsearch ingest node that attempts to parse the PDF file will crash. This does not happen with password-protected PDF files or with unencrypted PDF files.</p>
<p><strong>Affected Versions:</strong><br>
Affects versions &gt;= 8.4.0 and &lt; 8.11.1</p>
<p><strong>Solutions and Mitigations:</strong><br>
The issue is resolved in version 8.11.1.</p>
<p>This requires the attachment processor to be enabled. Users unable to upgrade can ensure that the <a href=\"https://www.elastic.co/guide/en/elasticsearch/reference/current/attachment.html\">attachment processor</a> is disabled.</p>
<p><strong>Severity:</strong> CVSSv3: 4.3(Medium) - <a href=\"https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:L\">CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:L</a></p>
<p><strong>CVE ID:</strong> CVE-2024-23449</p>
            <p><small>1 post - 1 participant</small></p>
            <p><a href=\"https://discuss.elastic.co/t/elasticsearch-8-11-1-security-update-esa-2024-05/356458\">Read full topic</a></p>
          ") (link nil "https://discuss.elastic.co/t/elasticsearch-8-11-1-security-update-esa-2024-05/356458") (pubDate nil "Fri, 29 Mar 2024 11:12:33 +0000") (topicPinned nil "No") (topicClosed nil "No") (topicArchived nil "No") (guid ((isPermaLink . "false")) "discuss.elastic.co-topic-356458") (source ((url . "https://discuss.elastic.co/t/elasticsearch-8-11-1-security-update-esa-2024-05/356458.rss")) "Elasticsearch 8.11.1 Security Update (ESA-2024-05)"))) ("Elasticsearch 8.13.0 Security Update (ESA-2024-07)" "<p><strong>Elasticsearch Improper Authorization in the Remote Cluster Security API key based security model (ESA-2024-07)</strong></p>
<p>It was identified by the Elastic engineering team that the API key based security model for <a href=\"https://www.elastic.co/guide/en/elasticsearch/reference/current/remote-clusters.html#remote-clusters-security-models\">Remote Cluster Security</a>, which is currently in Beta, is affected by an improper authorization issue. A malicious user with a valid API key for a remote cluster configured to use new Remote Cluster Security could read arbitrary documents from any index on the remote cluster, if they use the Elasticsearch custom transport protocol to issue requests with the target index ID, the shard ID and the document ID. None of Elasticsearch REST API endpoints are affected by this issue.</p>
<p><strong>Affected Versions:</strong><br>
Elasticsearch versions on or after <code>8.10.0</code> and before <code>8.13.0</code></p>
<p><strong>Solutions and Mitigations:</strong><br>
The issue is resolved in version <code>8.13.0</code></p>
<p><strong>Severity:</strong> CVSSv3: 4.4(Medium) - <a href=\"https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:U/C:H/I:N/A:N\">CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:U/C:H/I:N/A:N</a></p>
<p><strong>CVE ID:</strong> CVE-2024-23451</p>
            <p><small>1 post - 1 participant</small></p>
            <p><a href=\"https://discuss.elastic.co/t/elasticsearch-8-13-0-security-update-esa-2024-07/356315\">Read full topic</a></p>" "https://discuss.elastic.co/t/elasticsearch-8-13-0-security-update-esa-2024-07/356315" (26116 20260) new 18 nil nil ((title nil "Elasticsearch 8.13.0 Security Update (ESA-2024-07)") (creator nil "ismisepaul") (category nil "Security Announcements") (description nil "
            <p><strong>Elasticsearch Improper Authorization in the Remote Cluster Security API key based security model (ESA-2024-07)</strong></p>
<p>It was identified by the Elastic engineering team that the API key based security model for <a href=\"https://www.elastic.co/guide/en/elasticsearch/reference/current/remote-clusters.html#remote-clusters-security-models\">Remote Cluster Security</a>, which is currently in Beta, is affected by an improper authorization issue. A malicious user with a valid API key for a remote cluster configured to use new Remote Cluster Security could read arbitrary documents from any index on the remote cluster, if they use the Elasticsearch custom transport protocol to issue requests with the target index ID, the shard ID and the document ID. None of Elasticsearch REST API endpoints are affected by this issue.</p>
<p><strong>Affected Versions:</strong><br>
Elasticsearch versions on or after <code>8.10.0</code> and before <code>8.13.0</code></p>
<p><strong>Solutions and Mitigations:</strong><br>
The issue is resolved in version <code>8.13.0</code></p>
<p><strong>Severity:</strong> CVSSv3: 4.4(Medium) - <a href=\"https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:U/C:H/I:N/A:N\">CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:U/C:H/I:N/A:N</a></p>
<p><strong>CVE ID:</strong> CVE-2024-23451</p>
            <p><small>1 post - 1 participant</small></p>
            <p><a href=\"https://discuss.elastic.co/t/elasticsearch-8-13-0-security-update-esa-2024-07/356315\">Read full topic</a></p>
          ") (link nil "https://discuss.elastic.co/t/elasticsearch-8-13-0-security-update-esa-2024-07/356315") (pubDate nil "Wed, 27 Mar 2024 16:53:56 +0000") (topicPinned nil "No") (topicClosed nil "No") (topicArchived nil "No") (guid ((isPermaLink . "false")) "discuss.elastic.co-topic-356315") (source ((url . "https://discuss.elastic.co/t/elasticsearch-8-13-0-security-update-esa-2024-07/356315.rss")) "Elasticsearch 8.13.0 Security Update (ESA-2024-07)"))) ("Elasticsearch 8.13.0 / 7.17.19 Security Update (ESA-2024-06)" "<p><strong>Elasticsearch Uncontrolled Resource Consumption vulnerability (ESA-2024-06)</strong></p>
<p>A flaw was discovered in Elasticsearch, where processing a document in a deeply nested pipeline on an ingest node could cause the Elasticsearch node to crash.</p>
<p><strong>Affected Versions:</strong><br>
Elasticsearch versions on or after 7.0.0 and before 7.17.19<br>
Elasticsearch versions on or after 8.0.0 and before 8.13.0</p>
<p><strong>Solutions and Mitigations:</strong><br>
The issue is resolved in versions 8.13.0 and 7.17.19.</p>
<p><strong>Severity</strong>: CVSSv3: 4.9(Medium) <a href=\"https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:L/PR:H/UI:N/S:U/C:N/I:N/A:H\">CVSS:3.0/AV:N/AC:L/PR:H/UI:N/S:U/C:N/I:N/A:H</a></p>
<p><strong>CVE ID</strong>: CVE-2024-23450</p>
            <p><small>1 post - 1 participant</small></p>
            <p><a href=\"https://discuss.elastic.co/t/elasticsearch-8-13-0-7-17-19-security-update-esa-2024-06/356314\">Read full topic</a></p>" "https://discuss.elastic.co/t/elasticsearch-8-13-0-7-17-19-security-update-esa-2024-06/356314" (26116 20240) new 19 nil nil ((title nil "Elasticsearch 8.13.0 / 7.17.19 Security Update (ESA-2024-06)") (creator nil "rodrigo_silva") (category nil "Security Announcements") (description nil "
            <p><strong>Elasticsearch Uncontrolled Resource Consumption vulnerability (ESA-2024-06)</strong></p>
<p>A flaw was discovered in Elasticsearch, where processing a document in a deeply nested pipeline on an ingest node could cause the Elasticsearch node to crash.</p>
<p><strong>Affected Versions:</strong><br>
Elasticsearch versions on or after 7.0.0 and before 7.17.19<br>
Elasticsearch versions on or after 8.0.0 and before 8.13.0</p>
<p><strong>Solutions and Mitigations:</strong><br>
The issue is resolved in versions 8.13.0 and 7.17.19.</p>
<p><strong>Severity</strong>: CVSSv3: 4.9(Medium) <a href=\"https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:L/PR:H/UI:N/S:U/C:N/I:N/A:H\">CVSS:3.0/AV:N/AC:L/PR:H/UI:N/S:U/C:N/I:N/A:H</a></p>
<p><strong>CVE ID</strong>: CVE-2024-23450</p>
            <p><small>1 post - 1 participant</small></p>
            <p><a href=\"https://discuss.elastic.co/t/elasticsearch-8-13-0-7-17-19-security-update-esa-2024-06/356314\">Read full topic</a></p>
          ") (link nil "https://discuss.elastic.co/t/elasticsearch-8-13-0-7-17-19-security-update-esa-2024-06/356314") (pubDate nil "Wed, 27 Mar 2024 16:53:36 +0000") (topicPinned nil "No") (topicClosed nil "No") (topicArchived nil "No") (guid ((isPermaLink . "false")) "discuss.elastic.co-topic-356314") (source ((url . "https://discuss.elastic.co/t/elasticsearch-8-13-0-7-17-19-security-update-esa-2024-06/356314.rss")) "Elasticsearch 8.13.0 / 7.17.19 Security Update (ESA-2024-06)"))) ("Kibana 8.12.1, 7.17.18 Security Update (ESA-2024-04)" "<p><strong>Kibana heap buffer overflow vulnerability (ESA-2024-04)</strong></p>
<p>This issue requires authenticated access to Kibana.</p>
<p>On Dec 21, 2023, Google Chrome announced <a href=\"https://nvd.nist.gov/vuln/detail/CVE-2023-7024\">CVE-2023-7024</a>, described as “Heap buffer overflow in WebRTC in Google Chrome prior to 120.0.6099.129 allowed a remote attacker to potentially exploit heap corruption via a crafted HTML page”. Kibana includes a bundled version of headless Chromium that is only used for Kibana’s reporting capabilities and which is affected by this vulnerability.</p>
<p>This issue affects on-premises Kibana installations on host Operating Systems where <a href=\"https://www.elastic.co/guide/en/kibana/current/reporting-production-considerations.html#reporting-chromium-sandbox\">Chromium sandbox is disabled</a> (only CentOS, Debian, RHEL).</p>
<p>This issue affects Kibana instances running using the Kibana Docker image when the Chromium sandbox is explicitly disabled as suggested by the documentation. Further exploitation such as container escape is prevented by seccomp-bpf.</p>
<p>This issue affects Kibana instances running on Elastic Cloud but the RCE is limited within the Kibana Docker container. Further exploitation such as container escape is prevented by seccomp-bpf and AppArmor profiles.</p>
<p>This issue affects Kibana instances running on Elastic Cloud Enterprise (ECE) but the RCE is limited within the Kibana Docker container. Further exploitation such as container escape is prevented by seccomp-bpf and AppArmor profiles.</p>
<p>This issue affects Kibana instances running on Elastic Cloud on Kubernetes (ECK) but the RCE is limited within the Kibana Docker container. Further exploitation such as container escape can be prevented by seccomp-bpf when configured and supported (Kubernetes v1.19 and later).</p>
<p><strong>Affected Versions:</strong><br>
Kibana versions up to 7.17.17 and up to version 8.12.0.</p>
<p><strong>Solutions and Mitigations:</strong><br>
Users should upgrade to version 8.12.1 or 7.17.18</p>
<p>If you are unable to upgrade, you can disable Kibana reporting functionality completely in the <code>kibana.yml</code> file with the following setting: <code>xpack.reporting.enabled: false</code></p>
<p><strong>Severity:</strong> CVSSv3: 9.9(Critical) - <a href=\"https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H\">CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H</a></p>
<p><strong>CVE ID:</strong> <a href=\"https://nvd.nist.gov/vuln/detail/CVE-2023-7024\">CVE-2023-7024</a></p>
            <p><small>1 post - 1 participant</small></p>
            <p><a href=\"https://discuss.elastic.co/t/kibana-8-12-1-7-17-18-security-update-esa-2024-04/352805\">Read full topic</a></p>" "https://discuss.elastic.co/t/kibana-8-12-1-7-17-18-security-update-esa-2024-04/352805" (26051 65313) new 20 nil nil ((title nil "Kibana 8.12.1, 7.17.18 Security Update (ESA-2024-04)") (creator nil "rodrigo_silva") (category nil "Security Announcements") (description nil "
            <p><strong>Kibana heap buffer overflow vulnerability (ESA-2024-04)</strong></p>
<p>This issue requires authenticated access to Kibana.</p>
<p>On Dec 21, 2023, Google Chrome announced <a href=\"https://nvd.nist.gov/vuln/detail/CVE-2023-7024\">CVE-2023-7024</a>, described as “Heap buffer overflow in WebRTC in Google Chrome prior to 120.0.6099.129 allowed a remote attacker to potentially exploit heap corruption via a crafted HTML page”. Kibana includes a bundled version of headless Chromium that is only used for Kibana’s reporting capabilities and which is affected by this vulnerability.</p>
<p>This issue affects on-premises Kibana installations on host Operating Systems where <a href=\"https://www.elastic.co/guide/en/kibana/current/reporting-production-considerations.html#reporting-chromium-sandbox\">Chromium sandbox is disabled</a> (only CentOS, Debian, RHEL).</p>
<p>This issue affects Kibana instances running using the Kibana Docker image when the Chromium sandbox is explicitly disabled as suggested by the documentation. Further exploitation such as container escape is prevented by seccomp-bpf.</p>
<p>This issue affects Kibana instances running on Elastic Cloud but the RCE is limited within the Kibana Docker container. Further exploitation such as container escape is prevented by seccomp-bpf and AppArmor profiles.</p>
<p>This issue affects Kibana instances running on Elastic Cloud Enterprise (ECE) but the RCE is limited within the Kibana Docker container. Further exploitation such as container escape is prevented by seccomp-bpf and AppArmor profiles.</p>
<p>This issue affects Kibana instances running on Elastic Cloud on Kubernetes (ECK) but the RCE is limited within the Kibana Docker container. Further exploitation such as container escape can be prevented by seccomp-bpf when configured and supported (Kubernetes v1.19 and later).</p>
<p><strong>Affected Versions:</strong><br>
Kibana versions up to 7.17.17 and up to version 8.12.0.</p>
<p><strong>Solutions and Mitigations:</strong><br>
Users should upgrade to version 8.12.1 or 7.17.18</p>
<p>If you are unable to upgrade, you can disable Kibana reporting functionality completely in the <code>kibana.yml</code> file with the following setting: <code>xpack.reporting.enabled: false</code></p>
<p><strong>Severity:</strong> CVSSv3: 9.9(Critical) - <a href=\"https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H\">CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H</a></p>
<p><strong>CVE ID:</strong> <a href=\"https://nvd.nist.gov/vuln/detail/CVE-2023-7024\">CVE-2023-7024</a></p>
            <p><small>1 post - 1 participant</small></p>
            <p><a href=\"https://discuss.elastic.co/t/kibana-8-12-1-7-17-18-security-update-esa-2024-04/352805\">Read full topic</a></p>
          ") (link nil "https://discuss.elastic.co/t/kibana-8-12-1-7-17-18-security-update-esa-2024-04/352805") (pubDate nil "Wed, 07 Feb 2024 22:07:29 +0000") (topicPinned nil "No") (topicClosed nil "No") (topicArchived nil "No") (guid ((isPermaLink . "false")) "discuss.elastic.co-topic-352805") (source ((url . "https://discuss.elastic.co/t/kibana-8-12-1-7-17-18-security-update-esa-2024-04/352805.rss")) "Kibana 8.12.1, 7.17.18 Security Update (ESA-2024-04)"))) ("APM Server 8.12.1 Security Update (ESA-2024-03)" "<p><strong>APM Server Insertion of Sensitive Information into Log File (ESA-2024-03)</strong></p>
<p>An issue was discovered whereby APM Server could log at ERROR level, a response from Elasticsearch indicating that indexing the document failed and that response would contain parts of the original document. Depending on the nature of the document that the APM Server attempted to ingest, this could lead to the insertion of sensitive or private information in the APM Server logs.</p>
<p><strong>Affected Versions:</strong><br>
APM Server versions before 8.12.1</p>
<p><strong>Solutions and Mitigations:</strong><br>
The issue is resolved in version 8.12.1.</p>
<p><strong>Reviewing Logs for Sensitive Information</strong><br>
Users can search for instances of these documents and determine whether any sensitive information has been leaked in APM Server logs by searching for the following string</p>
<p><code>Preview of field's value:</code></p>
<p><strong>Severity:</strong> CVSSv3: 5.7(Medium) - <a href=\"https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:A/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N\">AV:A/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N</a></p>
<p><strong>CVE ID:</strong> CVE-2024-23448</p>
            <p><small>1 post - 1 participant</small></p>
            <p><a href=\"https://discuss.elastic.co/t/apm-server-8-12-1-security-update-esa-2024-03/352688\">Read full topic</a></p>" "https://discuss.elastic.co/t/apm-server-8-12-1-security-update-esa-2024-03/352688" (26050 46137) new 21 nil nil ((title nil "APM Server 8.12.1 Security Update (ESA-2024-03)") (creator nil "rodrigo_silva") (category nil "Security Announcements") (description nil "
            <p><strong>APM Server Insertion of Sensitive Information into Log File (ESA-2024-03)</strong></p>
<p>An issue was discovered whereby APM Server could log at ERROR level, a response from Elasticsearch indicating that indexing the document failed and that response would contain parts of the original document. Depending on the nature of the document that the APM Server attempted to ingest, this could lead to the insertion of sensitive or private information in the APM Server logs.</p>
<p><strong>Affected Versions:</strong><br>
APM Server versions before 8.12.1</p>
<p><strong>Solutions and Mitigations:</strong><br>
The issue is resolved in version 8.12.1.</p>
<p><strong>Reviewing Logs for Sensitive Information</strong><br>
Users can search for instances of these documents and determine whether any sensitive information has been leaked in APM Server logs by searching for the following string</p>
<p><code>Preview of field's value:</code></p>
<p><strong>Severity:</strong> CVSSv3: 5.7(Medium) - <a href=\"https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:A/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N\">AV:A/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N</a></p>
<p><strong>CVE ID:</strong> CVE-2024-23448</p>
            <p><small>1 post - 1 participant</small></p>
            <p><a href=\"https://discuss.elastic.co/t/apm-server-8-12-1-security-update-esa-2024-03/352688\">Read full topic</a></p>
          ") (link nil "https://discuss.elastic.co/t/apm-server-8-12-1-security-update-esa-2024-03/352688") (pubDate nil "Tue, 06 Feb 2024 22:35:37 +0000") (topicPinned nil "No") (topicClosed nil "No") (topicArchived nil "No") (guid ((isPermaLink . "false")) "discuss.elastic.co-topic-352688") (source ((url . "https://discuss.elastic.co/t/apm-server-8-12-1-security-update-esa-2024-03/352688.rss")) "APM Server 8.12.1 Security Update (ESA-2024-03)"))) ("Elastic Network Drive Connector 8.12.1 Security Update (ESA-2024-02)" "<p><strong>Elastic Network Drive Connector Improper Access Control (ESA-2024-02)</strong></p>
<p>An issue was discovered in the Windows Network Drive Connector when using Document Level Security to assign permissions to a file, with explicit allow write and deny read.</p>
<p>Although the document is not accessible to the user in Network Drive it is visible in search applications to the user.</p>
<p><strong>Affected Versions:</strong><br>
Elastic Network Drive Connector before 8.12.1.</p>
<p><strong>Solutions and Mitigations:</strong><br>
The issue is resolved in Elastic Network Drive Connector v8.12.1 and above</p>
<p><strong>CVSSv3:</strong> 5.3 (Medium) - <a href=\"https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:N/A:N\">CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:N/A:N </a></p>
<p><strong>CVE ID:</strong> CVE-2024-23447</p>
            <p><small>1 post - 1 participant</small></p>
            <p><a href=\"https://discuss.elastic.co/t/elastic-network-drive-connector-8-12-1-security-update-esa-2024-02/352687\">Read full topic</a></p>" "https://discuss.elastic.co/t/elastic-network-drive-connector-8-12-1-security-update-esa-2024-02/352687" (26050 45389) new 22 nil nil ((title nil "Elastic Network Drive Connector 8.12.1 Security Update (ESA-2024-02)") (creator nil "rodrigo_silva") (category nil "Security Announcements") (description nil "
            <p><strong>Elastic Network Drive Connector Improper Access Control (ESA-2024-02)</strong></p>
<p>An issue was discovered in the Windows Network Drive Connector when using Document Level Security to assign permissions to a file, with explicit allow write and deny read.</p>
<p>Although the document is not accessible to the user in Network Drive it is visible in search applications to the user.</p>
<p><strong>Affected Versions:</strong><br>
Elastic Network Drive Connector before 8.12.1.</p>
<p><strong>Solutions and Mitigations:</strong><br>
The issue is resolved in Elastic Network Drive Connector v8.12.1 and above</p>
<p><strong>CVSSv3:</strong> 5.3 (Medium) - <a href=\"https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:N/A:N\">CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:N/A:N </a></p>
<p><strong>CVE ID:</strong> CVE-2024-23447</p>
            <p><small>1 post - 1 participant</small></p>
            <p><a href=\"https://discuss.elastic.co/t/elastic-network-drive-connector-8-12-1-security-update-esa-2024-02/352687\">Read full topic</a></p>
          ") (link nil "https://discuss.elastic.co/t/elastic-network-drive-connector-8-12-1-security-update-esa-2024-02/352687") (pubDate nil "Tue, 06 Feb 2024 22:23:09 +0000") (topicPinned nil "No") (topicClosed nil "No") (topicArchived nil "No") (guid ((isPermaLink . "false")) "discuss.elastic.co-topic-352687") (source ((url . "https://discuss.elastic.co/t/elastic-network-drive-connector-8-12-1-security-update-esa-2024-02/352687.rss")) "Elastic Network Drive Connector 8.12.1 Security Update (ESA-2024-02)"))) ("Kibana 8.12.1 Security Update (ESA-2024-01)" "<p><strong>Kibana Broken Access Control issue (ESA-2024-01)</strong></p>
<p>An issue was discovered by Elastic, whereby the Detection Engine Search <a href=\"https://www.elastic.co/guide/en/security/current/signals-api-overview.html\">API</a> does not respect Document-level security (DLS) or Field-level security (FLS) when querying the .alerts-security.alerts-{space_id} indices. Users who are authorized to call this API may obtain unauthorized access to documents if their roles are configured with DLS or FLS against the aforementioned index.</p>
<p><strong>Affected Versions:</strong><br>
Kibana 8.x versions prior to 8.12.1</p>
<p><strong>Affected Configurations:</strong><br>
This issue only affects users that have assigned a role with DLS or FLS configured, users using KPI or group by feature on the alerts page or API users accessing the route directly.</p>
<p><strong>Solutions and Mitigations:</strong><br>
The issue is resolved in version 8.12.1</p>
<p><strong>Severity:</strong> CVSSv3: 6.5 (Medium) - <a href=\"https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N&amp;version=3.1\">AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N</a></p>
<p><strong>CVE ID:</strong> CVE-2024-23446</p>
            <p><small>1 post - 1 participant</small></p>
            <p><a href=\"https://discuss.elastic.co/t/kibana-8-12-1-security-update-esa-2024-01/352686\">Read full topic</a></p>" "https://discuss.elastic.co/t/kibana-8-12-1-security-update-esa-2024-01/352686" (26050 44793) new 23 nil nil ((title nil "Kibana 8.12.1 Security Update (ESA-2024-01)") (creator nil "rodrigo_silva") (category nil "Security Announcements") (description nil "
            <p><strong>Kibana Broken Access Control issue (ESA-2024-01)</strong></p>
<p>An issue was discovered by Elastic, whereby the Detection Engine Search <a href=\"https://www.elastic.co/guide/en/security/current/signals-api-overview.html\">API</a> does not respect Document-level security (DLS) or Field-level security (FLS) when querying the .alerts-security.alerts-{space_id} indices. Users who are authorized to call this API may obtain unauthorized access to documents if their roles are configured with DLS or FLS against the aforementioned index.</p>
<p><strong>Affected Versions:</strong><br>
Kibana 8.x versions prior to 8.12.1</p>
<p><strong>Affected Configurations:</strong><br>
This issue only affects users that have assigned a role with DLS or FLS configured, users using KPI or group by feature on the alerts page or API users accessing the route directly.</p>
<p><strong>Solutions and Mitigations:</strong><br>
The issue is resolved in version 8.12.1</p>
<p><strong>Severity:</strong> CVSSv3: 6.5 (Medium) - <a href=\"https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N&amp;version=3.1\">AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N</a></p>
<p><strong>CVE ID:</strong> CVE-2024-23446</p>
            <p><small>1 post - 1 participant</small></p>
            <p><a href=\"https://discuss.elastic.co/t/kibana-8-12-1-security-update-esa-2024-01/352686\">Read full topic</a></p>
          ") (link nil "https://discuss.elastic.co/t/kibana-8-12-1-security-update-esa-2024-01/352686") (pubDate nil "Tue, 06 Feb 2024 22:13:13 +0000") (topicPinned nil "No") (topicClosed nil "No") (topicArchived nil "No") (guid ((isPermaLink . "false")) "discuss.elastic.co-topic-352686") (source ((url . "https://discuss.elastic.co/t/kibana-8-12-1-security-update-esa-2024-01/352686.rss")) "Kibana 8.12.1 Security Update (ESA-2024-01)"))) ("Kibana 8.11.2, 7.17.16 Security Update (ESA-2023-27)" "<h1><a name=\"kibana-insertion-of-sensitive-information-into-log-file-esa-2023-27-1\" class=\"anchor\" href=\"https://discuss.elastic.co#kibana-insertion-of-sensitive-information-into-log-file-esa-2023-27-1\"></a>Kibana Insertion of Sensitive Information into Log File (ESA-2023-27)</h1>
<p>An issue was discovered by Elastic whereby sensitive information may be recorded in Kibana logs in the event of an error or in the event where <a href=\"https://www.elastic.co/guide/en/kibana/current/logging-configuration.html#log-level\">debug level logging is enabled in Kibana</a>. Elastic has released Kibana 8.11.2 which resolves this issue. The messages recorded in the log may contain:</p>
<ul>
<li>Account credentials for the <a href=\"https://www.elastic.co/guide/en/elasticsearch/reference/current/built-in-users.html\"><code>kibana_system</code></a> user, API Keys, and credentials of Kibana end-users.</li>
<li>Elastic Security package policy objects which can contain private keys, bearer token, and sessions of 3rd-party integrations.</li>
<li>Authorization headers, client secrets, local file paths, and stack traces</li>
</ul>
<p>The issue may occur in any Kibana instance running an affected version (which are listed below) that could potentially receive an unexpected error when communicating to Elasticsearch causing it to include sensitive data into Kibana error logs. It could also occur under specific circumstances when <a href=\"https://www.elastic.co/guide/en/kibana/current/logging-configuration.html#log-level\">debug level logging is enabled in Kibana</a>.</p>
<p><strong>Note:</strong> It was found that the fix for ESA-2023-25 in Kibana 8.11.1 for a similar issue was incomplete.</p>
<h2><a name=\"affected-versions-2\" class=\"anchor\" href=\"https://discuss.elastic.co#affected-versions-2\"></a>Affected Versions:</h2>
<p>Kibana versions on or after 7.13.0 and before 7.17.16.<br>
Kibana versions on or after 8.0.0 and before 8.11.2.</p>
<h2><a name=\"solutions-and-mitigations-3\" class=\"anchor\" href=\"https://discuss.elastic.co#solutions-and-mitigations-3\"></a>Solutions and Mitigations:</h2>
<p>The issue is resolved in Kibana 8.11.2 and 7.17.16</p>
<h3><a name=\"elastic-cloud-4\" class=\"anchor\" href=\"https://discuss.elastic.co#elastic-cloud-4\"></a>Elastic Cloud</h3>
<p>The following mitigations have been implemented in Elastic Cloud:</p>
<ul>
<li>We have purged sensitive data that was logged from our monitoring environment.</li>
<li>We have adjusted the rulesets of our redaction solution so that no new instances of sensitive information are logged in our monitoring environment and in customer’s monitoring clusters.</li>
</ul>
<p>For Elastic Cloud customers with <strong>self-managed monitoring clusters</strong>, affected logs should be reviewed for any potentially sensitive data and if deemed necessary, follow up actions such as purging sensitive data from logs and rotating any potentially exposed credentials should be performed.</p>
<p>As additional mitigation, Elastic Cloud customers on affected versions of Kibana are advised to upgrade to 8.11.3.</p>
<h3><a name=\"self-managed-5\" class=\"anchor\" href=\"https://discuss.elastic.co#self-managed-5\"></a>Self-Managed</h3>
<p>Users on affected versions of Kibana in self-managed, ECE, or ECK, are advised to upgrade to 8.11.2 or later.</p>
<p>Affected logs should be reviewed for any potentially sensitive data and if deemed necessary,  follow up actions such as purging sensitive data from logs and rotating any potentially exposed credentials should be performed.</p>
<p>For users that cannot upgrade, see the section <em>Preventing Ingest of Sensitive Information</em> for mitigation actions that can be applied.</p>
<h2><a name=\"reviewing-logs-for-sensitive-information-6\" class=\"anchor\" href=\"https://discuss.elastic.co#reviewing-logs-for-sensitive-information-6\"></a>Reviewing Logs for Sensitive Information</h2>
<p>This section describes how to review logs to identify instances of potentially sensitive information in your logs.</p>
<h3><a name=\"elastic-cloud-customers-with-self-managed-monitoring-clusters-7\" class=\"anchor\" href=\"https://discuss.elastic.co#elastic-cloud-customers-with-self-managed-monitoring-clusters-7\"></a>Elastic Cloud customers with self-managed monitoring clusters</h3>
<p>Affected log lines can be identified with the use of the queries described in <em>Appendix A. Search Queries.</em>  against the data views that <a href=\"https://www.elastic.co/guide/en/cloud/current/ec-enable-logging-and-monitoring.html#ec-access-kibana-monitoring\">contain Kibana logs on the monitoring cluster</a></p>
<h3><a name=\"self-managed-with-elastic-stack-monitoring-8\" class=\"anchor\" href=\"https://discuss.elastic.co#self-managed-with-elastic-stack-monitoring-8\"></a>Self-Managed with Elastic Stack Monitoring</h3>
<p>If you are using <a href=\"https://www.elastic.co/guide/en/kibana/current/configuring-monitoring.html\">Elastic Stack to ingest Kibana logs</a>, affected log lines can be identified with the use of the queries that are defined in <em>Appendix A. Search Queries</em> against the data views that contain Kibana logs on the monitoring cluster:</p>
<ul>
<li>If <a href=\"https://www.elastic.co/guide/en/kibana/current/monitoring-elastic-agent.html\">Elastic Agent Collection</a> is configured: <code>logs-kibana.*-default</code></li>
<li>If <a href=\"https://www.elastic.co/guide/en/kibana/current/monitoring-metricbeat.html\">Filebeat Collection</a> is configured: <code>filebeat-{version}</code> , where <code>{version}</code> is the installed Kibana version.</li>
</ul>
<h3><a name=\"self-managed-without-elastic-stack-monitoring-9\" class=\"anchor\" href=\"https://discuss.elastic.co#self-managed-without-elastic-stack-monitoring-9\"></a>Self-Managed without Elastic Stack Monitoring</h3>
<p>If you are not ingesting Kibana logs in the Elastic Stack, you can search the log files on disk for occurrences where the following terms are present:</p>
<ul>
<li>“MaxListenersExceededWarning”, “IncomingMessage”</li>
<li>Any of the following message substrings
<ul>
<li>\"policy info exists as\"</li>
<li>\"package policy exists as\"</li>
<li>\"policy responses exists as\"</li>
<li>\"endpoint metadata exists as\"</li>
<li>\"Trusted Apps\"</li>
<li>\"EP Exceptions\"</li>
<li>\"EP Event Filters\"</li>
<li>\"Value List Meta Data\"</li>
<li>\"Timeline Events\"</li>
</ul>
</li>
<li>\"Preview of field's value\", \"--token\", (\"plugins.securitySolution.ruleExecution\" or  \"plugins.ruleRegistry”)</li>
<li>“error thrown getting the access token”</li>
<li>Any of the following fields
<ul>
<li>\"kibana.usageCounters.results.meta.meta.request.options.headers.authorization\"</li>
<li>\"kibana.usageCounters.results.meta.meta.request.options.headers.X-Elastic-App-Auth\"</li>
<li>\"kibana.usageCounters.results.meta.meta.request.options.headers.x-elastic-app-auth\"</li>
<li>\"kibana.usageCounters.results.meta.meta.request.options.headers.es-client-authentication\"</li>
<li>\"kibana.usageCounters.results.meta.meta.request.options.headers.ES-Client-Authentication\"</li>
<li>\"kibana.usageCounters.results.meta.meta.request.params.headers.authorization\"</li>
<li>\"kibana.usageCounters.results.meta.meta.request.params.headers.X-Elastic-App-Auth\"</li>
<li>\"kibana.usageCounters.results.meta.meta.request.params.headers.x-elastic-app-auth\"</li>
<li>\"kibana.usageCounters.results.meta.meta.request.params.headers.es-client-authentication\"</li>
<li>\"kibana.usageCounters.results.meta.meta.request.params.headers.ES-Client-Authentication\"</li>
<li>\"http.request.headers.authorization\"</li>
<li>\"http.request.headers.x-elastic-app-auth\"</li>
<li>\"http.request.headers.X-Elastic-App-Auth\"</li>
<li>\"http.request.headers.es-client-authentication\"</li>
<li>\"http.request.headers.ES-Client-Authentication\"</li>
<li>\"error.cause.meta.meta.request.options.headers.authorization\"</li>
<li>\"error.cause.meta.meta.request.options.headers.x-elastic-app-auth\"</li>
<li>\"error.cause.meta.meta.request.options.headers.X-Elastic-App-Auth\"</li>
<li>\"error.cause.meta.meta.request.options.headers.es-client-authentication\"</li>
<li>\"error.cause.meta.meta.request.options.headers.ES-Client-Authentication\"</li>
<li>\"meta.meta.request.params.headers.authorization\"</li>
<li>\"meta.meta.request.params.headers.x-elastic-app-auth\"</li>
<li>\"meta.meta.request.params.headers.X-Elastic-App-Auth\"</li>
<li>\"meta.meta.request.params.headers.es-client-authentication\"</li>
<li>\"meta.meta.request.params.headers.ES-Client-Authentication\"</li>
<li>\"meta.meta.request.options.headers.authorization\"</li>
<li>\"meta.meta.request.options.headers.x-elastic-app-auth\"</li>
<li>\"meta.meta.request.options.headers.X-Elastic-App-Auth\"</li>
<li>\"meta.meta.request.options.headers.es-client-authentication\"</li>
<li>\"meta.meta.request.options.headers.ES-Client-Authentication\"</li>
<li>\"left.error.meta.meta.request.params.headers.authorization\"</li>
<li>\"left.error.meta.meta.request.params.headers.x-elastic-app-auth\"</li>
<li>\"left.error.meta.meta.request.params.headers.X-Elastic-App-Auth\"</li>
<li>\"left.error.meta.meta.request.params.headers.es-client-authentication\"</li>
<li>\"left.error.meta.meta.request.params.headers.ES-Client-Authentication\"</li>
<li>\"left.error.meta.meta.request.options.headers.authorization\"</li>
<li>\"left.error.meta.meta.request.options.headers.x-elastic-app-auth\"</li>
<li>\"left.error.meta.meta.request.options.headers.X-Elastic-App-Auth\"</li>
<li>\"left.error.meta.meta.request.options.headers.es-client-authentication\"</li>
<li>\"left.error.meta.meta.request.options.headers.ES-Client-Authentication\"</li>
<li>\"error.originalError.meta.meta.request.params.headers.authorization\"</li>
<li>\"error.originalError.meta.meta.request.params.headers.x-elastic-app-auth\"</li>
<li>\"error.originalError.meta.meta.request.params.headers.X-Elastic-App-Auth\"</li>
<li>\"error.originalError.meta.meta.request.params.headers.es-client-authentication\"</li>
<li>\"error.originalError.meta.meta.request.params.headers.ES-Client-Authentication\"</li>
<li>\"error.originalError.meta.meta.request.options.headers.authorization\"</li>
<li>\"error.originalError.meta.meta.request.options.headers.x-elastic-app-auth\"</li>
<li>\"error.originalError.meta.meta.request.options.headers.X-Elastic-App-Auth\"</li>
<li>\"error.originalError.meta.meta.request.options.headers.es-client-authentication\"</li>
<li>\"error.originalError.meta.meta.request.options.headers.ES-Client-Authentication\"</li>
<li>\"error.meta.meta.request.params.headers.authorization\"</li>
<li>\"error.meta.meta.request.params.headers.x-elastic-app-auth\"</li>
<li>\"error.meta.meta.request.params.headers.X-Elastic-App-Auth\"</li>
<li>\"error.meta.meta.request.params.headers.es-client-authentication\"</li>
<li>\"error.meta.meta.request.params.headers.ES-Client-Authentication\"</li>
<li>\"error.meta.meta.request.options.headers.authorization\"</li>
<li>\"error.meta.meta.request.options.headers.x-elastic-app-auth\"</li>
<li>\"error.meta.meta.request.options.headers.X-Elastic-App-Auth\"</li>
<li>\"error.meta.meta.request.options.headers.es-client-authentication\"</li>
<li>\"error.meta.meta.request.options.headers.ES-Client-Authentication\"</li>
<li>\"error.meta.meta.meta.request.params.headers.authorization\"</li>
<li>\"error.meta.meta.meta.request.params.headers.x-elastic-app-auth\"</li>
<li>\"error.meta.meta.meta.request.params.headers.X-Elastic-App-Auth\"</li>
<li>\"error.meta.meta.meta.request.params.headers.es-client-authentication\"</li>
<li>\"error.meta.meta.meta.request.params.headers.ES-Client-Authentication\"</li>
<li>\"error.meta.meta.meta.request.options.headers.authorization\"</li>
<li>\"error.meta.meta.meta.request.options.headers.x-elastic-app-auth\"</li>
<li>\"error.meta.meta.meta.request.options.headers.X-Elastic-App-Auth\"</li>
<li>\"error.meta.meta.meta.request.options.headers.es-client-authentication\"</li>
<li>\"error.meta.meta.meta.request.options.headers.ES-Client-Authentication\"</li>
<li>\"error.cause.meta.meta.request.params.headers.authorization\"</li>
<li>\"error.cause.meta.meta.request.params.headers.x-elastic-app-auth\"</li>
<li>\"error.cause.meta.meta.request.params.headers.X-Elastic-App-Auth\"</li>
<li>\"error.cause.meta.meta.request.params.headers.es-client-authentication\"</li>
<li>\"error.cause.meta.meta.request.params.headers.ES-Client-Authentication\"</li>
</ul>
</li>
</ul>
<h3><a name=\"ece-10\" class=\"anchor\" href=\"https://discuss.elastic.co#ece-10\"></a>ECE</h3>
<p>On ECE, affected log lines can be identified with the use of the queries that are defined in <em>Appendix A. Search Queries</em> against the <code>cluster-logs-*</code> indices in the <a href=\"https://www.elastic.co/guide/en/cloud-enterprise/current/ece-monitoring-ece-access.html\">logging and metrics cluster</a>.</p>
<h3><a name=\"eck-11\" class=\"anchor\" href=\"https://discuss.elastic.co#eck-11\"></a>ECK</h3>
<p>If <a href=\"https://www.elastic.co/guide/en/cloud-on-k8s/master/k8s-stack-monitoring.html\">Stack Monitoring is enabled</a>, affected log lines can be identified with the use of the queries that are defined in <em>Appendix A. Search Queries</em> against the data views that contain Kibana logs on the monitoring cluster:</p>
<ul>
<li>If <a href=\"https://www.elastic.co/guide/en/kibana/current/monitoring-elastic-agent.html\">Elastic Agent Collection</a> is configured: <code>logs-kibana.*-default</code></li>
<li>If <a href=\"https://www.elastic.co/guide/en/kibana/current/monitoring-metricbeat.html\">Filebeat Collection</a> is configured: <code>filebeat-{version}</code> , where <code>{version}</code> is the installed Kibana version.</li>
</ul>
<h2><a name=\"remediating-sensitive-information-12\" class=\"anchor\" href=\"https://discuss.elastic.co#remediating-sensitive-information-12\"></a>Remediating Sensitive Information</h2>
<p>If the review reveals that credentials have been included in the logs, the following remediation actions are recommended</p>
<div class=\"md-table\">
<table>
<thead>
<tr>
<th>Installation Type</th>
<th>Remediation Actions</th>
</tr>
</thead>
<tbody>
<tr>
<td>Elastic Cloud</td>
<td><code>found-internal-kibana4-server credentials</code> credentials are being rotated by Elastic. End user credentials can be changed using the Management &gt; Users UI in Kibana or the <a href=\"https://www.elastic.co/guide/en/elasticsearch/reference/current/security-api-change-password.html\">Change Password API</a>.</td>
</tr>
<tr>
<td>Archive Docker RPM/DEB</td>
<td>kibana_system credentials can be rotated <a href=\"https://www.elastic.co/guide/en/elasticsearch/reference/current/change-passwords-native-users.html\">using one of the available methods</a> if a native user is used. If service account tokens are used, you need to <a href=\"https://www.elastic.co/guide/en/elasticsearch/reference/8.9/security-api-delete-service-token.html\">delete the logged token</a> and <a href=\"https://www.elastic.co/guide/en/elasticsearch/reference/8.9/security-api-create-service-token.html\">create a new token</a> <br><br>End user credentials can be changed using the Management &gt; Users UI in Kibana or the <a href=\"https://www.elastic.co/guide/en/elasticsearch/reference/current/security-api-change-password.html\">Change Password API</a>.</td>
</tr>
<tr>
<td>ECE</td>
<td><code>found-internal-kibana4-server</code> credentials can be rotated using advanced editor: <br>1. Go to advanced editor<br>2. Find \".resources.kibana[0].plan.cluster_topology[0].kibana.system_settings\" <br>3. Set \"elasticsearch_password\" to a random string <br>4. submit <br><br>End user credentials can be changed using the Management &gt; Users UI in Kibana or the <a href=\"https://www.elastic.co/guide/en/elasticsearch/reference/current/security-api-change-password.html\">Change Password API</a>.</td>
</tr>
<tr>
<td>ECK</td>
<td>Kibana system user credentials <a href=\"https://www.elastic.co/guide/en/cloud-on-k8s/current/k8s-rotate-credentials.html\">can be rotated</a> by either of the following options: <br> - Delete <code>$KIBANA_NAME-kibana-user</code> secret in the Kibana K8s namespace and restart the ECK operator. <br>- Delete <code>$KIBANA_NAME-kibana-user</code> and <code>$NAMESPACE-$KIBANA_NAME-kibana-user</code> secrets in the Kibana K8s namespace <br><br> End user credentials can be changed using the Management &gt; Users UI in Kibana or the <a href=\"https://www.elastic.co/guide/en/elasticsearch/reference/current/security-api-change-password.html\">Change Password API</a>.</td>
</tr>
</tbody>
</table>
</div><h2><a name=\"preventing-ingest-of-sensitive-information-in-logs-13\" class=\"anchor\" href=\"https://discuss.elastic.co#preventing-ingest-of-sensitive-information-in-logs-13\"></a>Preventing Ingest of Sensitive Information in Logs</h2>
<p>For users that cannot upgrade, the following mitigation actions can be applied to prevent ingestion of sensitive information into an elasticsearch logging cluster.</p>
<p>The following mitigations are for customers who have enabled the monitoring features for their clusters as outlined in this <a href=\"https://www.elastic.co/guide/en/kibana/current/configuring-monitoring.html\">guide</a>.</p>
<p>If you are using <a href=\"https://www.elastic.co/guide/en/kibana/current/configuring-monitoring.html\">Elastic Stack to ingest Kibana logs</a>, use ECE, or <a href=\"https://www.elastic.co/guide/en/cloud-on-k8s/master/k8s-stack-monitoring.html\">use ECK with stack monitoring enabled</a> , you can use an <a href=\"https://www.elastic.co/guide/en/elasticsearch/reference/current/ingest.html\">Ingest Pipeline</a> to redact sensitive information from being ingested in a logging cluster.</p>
<ol>
<li>Create the remediation pipeline:</li>
</ol>
<pre><code class=\"lang-auto\">PUT _ingest/pipeline/redact-esa–2023-27
{
 \"description\": \"Prevent Insertion of Sensitive Information into Log File (ESA-2023-27)\",
 \"processors\": [
    {
      \"set\": {
        \"description\": \"Redact credentials in MaxListenersExceededWarning errors message field\",
        \"if\": \"ctx.message != null &amp;&amp; ctx.message.startsWith('MaxListenersExceededWarning') &amp;&amp; ctx.message.contains('IncomingMessage')\",
        \"field\": \"message\",
        \"value\": \"MaxListenersExceededWarning: Possible EventEmitter memory leak detected. There are aborted listeners added to [IncomingMessage]. Use emitter.setMaxListeners() to increase limit\",
        \"ignore_empty_value\": true
      }
    },
    {
      \"set\": {
        \"description\": \"Redact credentials in MaxListenersExceededWarning errors event.original field\",
        \"if\": \"ctx.event.original != null &amp;&amp; ctx.event.original.startsWith('MaxListenersExceededWarning') &amp;&amp; ctx.event.original.contains('IncomingMessage')\",
        \"field\": \"event.original\",
        \"value\": \"MaxListenersExceededWarning: Possible EventEmitter memory leak detected. There are aborted listeners added to [IncomingMessage]. Use emitter.setMaxListeners() to increase limit\",
        \"ignore_empty_value\": true
      }
    },
   {
     \"remove\": {
       \"description\": \"Kibana log record metadata with sensitive HTTP headers\",
       \"field\": [
         \"http.request.headers.authorization\",
         \"http.request.headers.x-elastic-app-auth\",
         \"http.request.headers.X-Elastic-App-Auth\",
         \"http.request.headers.es-client-authentication\",
         \"http.request.headers.ES-Client-Authentication\",
         \"error.cause.meta.meta.request.options.headers.authorization\",
         \"error.cause.meta.meta.request.options.headers.x-elastic-app-auth\",
         \"error.cause.meta.meta.request.options.headers.X-Elastic-App-Auth\",
         \"error.cause.meta.meta.request.options.headers.es-client-authentication\",
         \"error.cause.meta.meta.request.options.headers.ES-Client-Authentication\",
         \"meta.meta.request.params.headers.authorization\",
         \"meta.meta.request.params.headers.x-elastic-app-auth\",
         \"meta.meta.request.params.headers.X-Elastic-App-Auth\",
         \"meta.meta.request.params.headers.es-client-authentication\",
         \"meta.meta.request.params.headers.ES-Client-Authentication\",
         \"meta.meta.request.options.headers.authorization\",
         \"meta.meta.request.options.headers.x-elastic-app-auth\",
         \"meta.meta.request.options.headers.X-Elastic-App-Auth\",
         \"meta.meta.request.options.headers.es-client-authentication\",
         \"meta.meta.request.options.headers.ES-Client-Authentication\",
         \"left.error.meta.meta.request.params.headers.authorization\",
         \"left.error.meta.meta.request.params.headers.x-elastic-app-auth\",
         \"left.error.meta.meta.request.params.headers.X-Elastic-App-Auth\",
         \"left.error.meta.meta.request.params.headers.es-client-authentication\",
         \"left.error.meta.meta.request.params.headers.ES-Client-Authentication\",
         \"left.error.meta.meta.request.options.headers.authorization\",
         \"left.error.meta.meta.request.options.headers.x-elastic-app-auth\",
         \"left.error.meta.meta.request.options.headers.X-Elastic-App-Auth\",
         \"left.error.meta.meta.request.options.headers.es-client-authentication\",
         \"left.error.meta.meta.request.options.headers.ES-Client-Authentication\",
         \"error.originalError.meta.meta.request.params.headers.authorization\",
         \"error.originalError.meta.meta.request.params.headers.x-elastic-app-auth\",
         \"error.originalError.meta.meta.request.params.headers.X-Elastic-App-Auth\",
         \"error.originalError.meta.meta.request.params.headers.es-client-authentication\",
         \"error.originalError.meta.meta.request.params.headers.ES-Client-Authentication\",
         \"error.originalError.meta.meta.request.options.headers.authorization\",
         \"error.originalError.meta.meta.request.options.headers.x-elastic-app-auth\",
         \"error.originalError.meta.meta.request.options.headers.X-Elastic-App-Auth\",
         \"error.originalError.meta.meta.request.options.headers.es-client-authentication\",
         \"error.originalError.meta.meta.request.options.headers.ES-Client-Authentication\",
         \"error.meta.meta.request.params.headers.authorization\",
         \"error.meta.meta.request.params.headers.x-elastic-app-auth\",
         \"error.meta.meta.request.params.headers.X-Elastic-App-Auth\",
         \"error.meta.meta.request.params.headers.es-client-authentication\",
         \"error.meta.meta.request.params.headers.ES-Client-Authentication\",
         \"error.meta.meta.request.options.headers.authorization\",
         \"error.meta.meta.request.options.headers.x-elastic-app-auth\",
         \"error.meta.meta.request.options.headers.X-Elastic-App-Auth\",
         \"error.meta.meta.request.options.headers.es-client-authentication\",
         \"error.meta.meta.request.options.headers.ES-Client-Authentication\",
         \"error.meta.meta.meta.request.params.headers.authorization\",
         \"error.meta.meta.meta.request.params.headers.x-elastic-app-auth\",
         \"error.meta.meta.meta.request.params.headers.X-Elastic-App-Auth\",
         \"error.meta.meta.meta.request.params.headers.es-client-authentication\",
         \"error.meta.meta.meta.request.params.headers.ES-Client-Authentication\",
         \"error.meta.meta.meta.request.options.headers.authorization\",
         \"error.meta.meta.meta.request.options.headers.x-elastic-app-auth\",
         \"error.meta.meta.meta.request.options.headers.X-Elastic-App-Auth\",
         \"error.meta.meta.meta.request.options.headers.es-client-authentication\",
         \"error.meta.meta.meta.request.options.headers.ES-Client-Authentication\",
         \"error.cause.meta.meta.request.params.headers.authorization\",
         \"error.cause.meta.meta.request.params.headers.x-elastic-app-auth\",
         \"error.cause.meta.meta.request.params.headers.X-Elastic-App-Auth\",
         \"error.cause.meta.meta.request.params.headers.es-client-authentication\",
         \"error.cause.meta.meta.request.params.headers.ES-Client-Authentication\"
       ],
       \"ignore_missing\": true
     }
   },
    {
      \"foreach\": {
        \"field\": \"kibana.usageCounters.results\",
        \"processor\": {
          \"remove\": {
            \"field\": [
              \"_ingest._value.meta.meta.request.options.headers.authorization\",
              \"_ingest._value.meta.meta.request.options.headers.X-Elastic-App-Auth\",
              \"_ingest._value.meta.meta.request.options.headers.x-elastic-app-auth\",
              \"_ingest._value.meta.meta.request.options.headers.es-client-authentication\",
              \"_ingest._value.meta.meta.request.options.headers.ES-Client-Authentication\",
              \"_ingest._value.meta.meta.request.params.headers.authorization\",
              \"_ingest._value.meta.meta.request.params.headers.X-Elastic-App-Auth\",
              \"_ingest._value.meta.meta.request.params.headers.x-elastic-app-auth\",
              \"_ingest._value.meta.meta.request.params.headers.es-client-authentication\",
              \"_ingest._value.meta.meta.request.params.headers.ES-Client-Authentication\"
            ],
            \"ignore_missing\": true
          }
        },
        \"ignore_missing\": true
      }
    },
   {
     \"dot_expander\": {
       \"description\": \"Expand 'event.original'\",
       \"field\": \"event.original\"
     }
   },
   {
     \"set\": {
       \"field\": \"message\",
       \"value\": \"policy info exists as [redacted]\",
       \"if\": \"ctx.message != null &amp;&amp; ctx.message.toLowerCase().contains('policy info exists as')\"
     }
   },
   {
     \"set\": {
       \"field\": \"event.original\",
       \"value\": \"policy info exists as [redacted]\",
       \"if\": \"ctx.event.original != null &amp;&amp; ctx.event.original.toLowerCase().contains('policy info exists as')\"
     }
   },
   {
     \"set\": {
       \"field\": \"message\",
       \"value\": \"package policy exists as [redacted]\",
       \"if\": \"ctx.message != null &amp;&amp; ctx.message.toLowerCase().contains('package policy exists as')\"
     }
   },
   {
     \"set\": {
       \"field\": \"event.original\",
       \"value\": \"package policy exists as [redacted]\",
       \"if\": \"ctx.event.original != null &amp;&amp; ctx.event.original.toLowerCase().contains('package policy exists as')\"
     }
   },
   {
     \"set\": {
       \"field\": \"message\",
       \"value\": \"policy responses exists as [redacted]\",
       \"if\": \"ctx.message != null &amp;&amp; ctx.message.toLowerCase().contains('policy responses exists as')\"
     }
   },
   {
     \"set\": {
       \"field\": \"event.original\",
       \"value\": \"policy responses exists as [redacted]\",
       \"if\": \"ctx.event.original != null &amp;&amp; ctx.event.original.toLowerCase().contains('policy responses exists as')\"
     }
   },
   {
     \"set\": {
       \"field\": \"message\",
       \"value\": \"endpoint metadata exists as [redacted]\",
       \"if\": \"ctx.message != null &amp;&amp; ctx.message.toLowerCase().contains('endpoint metadata exists as')\"
     }
   },
   {
     \"set\": {
       \"field\": \"event.original\",
       \"value\": \"endpoint metadata exists as [redacted]\",
       \"if\": \"ctx.event.original != null &amp;&amp; ctx.event.original.toLowerCase().contains('endpoint metadata exists as')\"
     }
   },
   {
     \"set\": {
       \"field\": \"message\",
       \"value\": \"Trusted Apps: [redacted]\",
       \"if\": \"ctx.message != null &amp;&amp; ctx.message.toLowerCase().contains('trusted apps:')\"
     }
   },
   {
     \"set\": {
       \"field\": \"event.original\",
       \"value\": \"Trusted Apps: [redacted]\",
       \"if\": \"ctx.event.original != null &amp;&amp; ctx.event.original.toLowerCase().contains('trusted apps:')\"
     }
   },
   {
     \"set\": {
       \"field\": \"message\",
       \"value\": \"EP Exceptions: [redacted]\",
       \"if\": \"ctx.message != null &amp;&amp; ctx.message.toLowerCase().contains('ep exceptions:')\"
     }
   },
   {
     \"set\": {
       \"field\": \"event.original\",
       \"value\": \"EP Exceptions: [redacted]\",
       \"if\": \"ctx.event.original != null &amp;&amp; ctx.event.original.toLowerCase().contains('ep exceptions:')\"
     }
   },
   {
     \"set\": {
       \"field\": \"message\",
       \"value\": \"EP Event Filters: [redacted]\",
       \"if\": \"ctx.message != null &amp;&amp; ctx.message.toLowerCase().contains('ep event filters:')\"
     }
   },
   {
     \"set\": {
       \"field\": \"event.original\",
       \"value\": \"EP Event Filters: [redacted]\",
       \"if\": \"ctx.event.original != null &amp;&amp; ctx.event.original.toLowerCase().contains('ep event filters:')\"
     }
   },
   {
     \"set\": {
       \"field\": \"message\",
       \"value\": \"Value List Meta Data: [redacted]\",
       \"if\": \"ctx.message != null &amp;&amp; ctx.message.toLowerCase().contains('value list meta data:')\"
     }
   },
   {
     \"set\": {
       \"field\": \"event.original\",
       \"value\": \"Value List Meta Data: [redacted]\",
       \"if\": \"ctx.event.original != null &amp;&amp; ctx.event.original.toLowerCase().contains('value list meta data:')\"
     }
   },
   {
     \"set\": {
       \"field\": \"message\",
       \"value\": \"Timeline Events: [redacted]\",
       \"if\": \"ctx.message != null &amp;&amp; ctx.message.toLowerCase().contains('timeline events:')\"
     }
   },
   {
     \"set\": {
       \"field\": \"event.original\",
       \"value\": \"Timeline Events: [redacted]\",
       \"if\": \"ctx.event.original != null &amp;&amp; ctx.event.original.toLowerCase().contains('timeline events:')\"
     }
   },
   {
     \"set\": {
       \"field\": \"message\",
       \"value\": \"Error decoding JSON: [redacted]\",
       \"if\": \"ctx.message != null &amp;&amp; ctx.error != null &amp;&amp; ctx.error.message != null &amp;&amp; ctx.error.message.toLowerCase().contains('error decoding json') &amp;&amp; ctx.message.toLowerCase().contains('plugins.securitysolution.telemetry_events')\"
     }
   },
   {
     \"set\": {
       \"field\": \"event.original\",
       \"value\": \"Error decoding JSON: [redacted]\",
       \"if\": \"ctx.event.original != null &amp;&amp; ctx.error != null &amp;&amp; ctx.error.message != null &amp;&amp; ctx.error.message.toLowerCase().contains('error decoding json') &amp;&amp; ctx.event.original.toLowerCase().contains('plugins.securitysolution.telemetry_events')\"
     }
   },
   {
     \"set\": {
       \"description\": \"Redacting sensitive info from errors in message field\",
       \"field\": \"message\",
       \"value\": \"error thrown getting the access token [redacted]\",
       \"if\": \"ctx.message != null &amp;&amp; ctx.message.toLowerCase().contains('error thrown getting the access token')\"
     }
   },
   {
     \"set\": {
       \"description\": \"Redacting sensitive info from errors in event.original field\",
       \"field\": \"event.original\",
       \"value\": \"error thrown getting the access token [redacted]\",
       \"if\": \"ctx.event.original != null &amp;&amp; ctx.event.original.toLowerCase().contains('error thrown getting the access token')\"
     }
   },
   {
     \"set\": {
       \"description\": \"Redacting sensitive info from message field in Security Solution RuleExecution or RuleRegistry docs\",
       \"field\": \"message\",
       \"value\": \"[redacted]\",
       \"if\": \"ctx.log.logger != null &amp;&amp; ctx.message != null &amp;&amp; (ctx.log.logger.toLowerCase() == 'plugins.securitySolution.ruleexecution' || ctx.log.logger.toLowerCase() == 'plugins.ruleregistry') &amp;&amp; ctx.message.toLowerCase().contains('preview of field\\\\'s value')\"
     }
   },
   {
     \"set\": {
       \"description\": \"Redacting sensitive info from event.original field in Security Solution RuleExecution or RuleRegistry docs\",
       \"field\": \"event.original\",
       \"value\": \"[redacted]\",
       \"if\": \"ctx.log.logger != null &amp;&amp; ctx.event.original != null &amp;&amp; (ctx.log.logger.toLowerCase() == 'plugins.securitySolution.ruleexecution' || ctx.log.logger.toLowerCase() == 'plugins.ruleregistry') &amp;&amp; ctx.event.original.toLowerCase().contains('preview of field\\\\'s value')\"
     }
   },
   {
     \"set\": {
       \"description\": \"Redacting sensitive info from error.stack_trace field in Security Solution RuleExecution or RuleRegistry docs\",
       \"field\": \"error.stack_trace\",
       \"value\": \"[redacted]\",
       \"if\": \"ctx.log.logger != null &amp;&amp; ctx.error != null &amp;&amp; ctx.error.stack_trace != null &amp;&amp; (ctx.log.logger.toLowerCase() == 'plugins.securitySolution.ruleexecution' || ctx.log.logger.toLowerCase() == 'plugins.ruleregistry') &amp;&amp; ctx.error.stack_trace.toLowerCase().contains('preview of field\\\\'s value')\"
     }
   },
   {
     \"set\": {
       \"description\": \"Redacting sensitive info from error.message field in Security Solution RuleExecution or RuleRegistry docs\",
       \"field\": \"error.message\",
       \"value\": \"[redacted]\",
       \"if\": \"ctx.log.logger != null &amp;&amp; ctx.error != null &amp;&amp; ctx.error.message != null &amp;&amp; (ctx.log.logger.toLowerCase() == 'plugins.securitySolution.ruleexecution' || ctx.log.logger.toLowerCase() == 'plugins.ruleregistry') &amp;&amp; ctx.error.message.toLowerCase().contains('preview of field\\\\'s value')\"
     }
   }
 ]
}
</code></pre>
<ol start=\"2\">
<li>
<p>Identify the indexes or datastreams that your Kibana logs are being ingested into.</p>
</li>
<li>
<p>Identify whether these indices have a default pipeline configured by checking for the index.default_pipeline setting on the indices themselves and the templates.<br>
a. If the indices DO NOT configure a default pipeline:</p>
<ul>
<li>Configure the template to add the <code>index.default_pipeline</code> setting pointing to the example <code>redact-esa-2023-27</code> pipeline.</li>
<li>Update the settings of any existing indices to use <code>index.default_pipeline: redact-esa-2023-27</code>.</li>
</ul>
<p>b. If the indices DO configure a default pipeline:</p>
<ul>
<li>Identify the name of the pipeline from the setting.</li>
<li><code>GET /_ingest/pipeline/{pipeline_name}</code></li>
<li>Add the processor <code>redact-esa-2023-27</code> as an additional <a href=\"https://www.elastic.co/guide/en/elasticsearch/reference/current/pipeline-processor.html\">pipeline processor</a> to the body of the default pipeline</li>
<li>Use <a href=\"https://www.elastic.co/guide/en/elasticsearch/reference/current/put-pipeline-api.html\">PUT _ingest/pipeline API</a> to update the default pipeline to the new configuration</li>
</ul>
<pre><code class=\"lang-auto\">...
{
  \"pipeline\": {
    \"name\": \"redact-esa-2023-27\"
  }
}
…
</code></pre>
</li>
</ol>
<p>The instructions above give API usage examples. Custom pipelines can also be edited using the Ingest Pipelines UI. See <a href=\"https://www.elastic.co/guide/en/fleet/8.11/data-streams-pipeline-tutorial.html\" class=\"inline-onebox\">Tutorial: Transform data with custom ingest pipelines | Fleet and Elastic Agent Guide [8.11] | Elastic</a></p>
<h3><a name=\"self-managed-without-elastic-stack-monitoring-14\" class=\"anchor\" href=\"https://discuss.elastic.co#self-managed-without-elastic-stack-monitoring-14\"></a>Self-Managed without Elastic Stack Monitoring</h3>
<p>If you are not ingesting Kibana logs in the Elastic Stack, you should limit access to the directory where Kibana log files are stored.</p>
<h3><a name=\"ece-logging-cluster-instructions-15\" class=\"anchor\" href=\"https://discuss.elastic.co#ece-logging-cluster-instructions-15\"></a>ECE logging cluster instructions</h3>
<p>This assumes the above ingest pipeline (<code>redact-esa–2023-27</code>) has been created in the logging cluster as described above.</p>
<p>By default the ECE logging cluster ships with a single template for the <code>cluster-logs-*</code> indices and:</p>
<ul>
<li>It does not have a “settings.default_pipeline”</li>
<li>There are no other templates with <code>“GET”</code></li>
</ul>
<p>You should confirm this remains the case for you (<code>“GET _template/cluster-logs-*”</code>, look for <code>“default_pipeline”</code>) and (<code>“GET _template/”</code>, compare the <code>“index_patterns”</code> fields) respectively, and contact support if there are.</p>
<p>Otherwise, you will then create an overlapping template just specifying the ingest pipeline:</p>
<pre><code class=\"lang-auto\">PUT _template/cluster-logs-esa–2023-27-redaction
{
  \"index_patterns\" : [\"cluster-logs-*\"],
  \"order\" : 99,
  \"settings\": {\"default_pipeline\": \"redact-esa–2023-27\"}
}
</code></pre>
<p>The next time the index rolls over, the message field will be replaced by <code>“[redacted]”</code> for offending messages. You should then redact sensitive information from already ingested logs as described below.</p>
<h2><a name=\"redacting-sensitive-information-already-ingested-in-logs-16\" class=\"anchor\" href=\"https://discuss.elastic.co#redacting-sensitive-information-already-ingested-in-logs-16\"></a>Redacting Sensitive Information already ingested in logs</h2>
<p>The same Ingest Pipeline can be used in conjunction with the <a href=\"https://www.elastic.co/guide/en/elasticsearch/reference/current/docs-update-by-query.html\">Update By Query API</a> in order to redact already recorded sensitive information in logs. This is applicable for all deployments which includes: Elastic Cloud customers with self-managed monitoring clusters, Self-Managed, ECE, ECK.</p>
<p>Repeat the following Updaye By Queries for all Kibana logging indices that contain sensitive information.</p>
<h3><a name=\"update-query-1-17\" class=\"anchor\" href=\"https://discuss.elastic.co#update-query-1-17\"></a>Update Query <span class=\"hashtag-raw\">#1</span></h3>
<pre><code class=\"lang-auto\">POST /&lt;insert_indices_patterns_here&gt;/_update_by_query?pipeline=redact-esa–2023-27&amp;pretty=true&amp;allow_no_indices=false&amp;wait_for_completion=false&amp;expand_wildcards=all&amp;conflicts=proceed
{
  \"query\": {
    \"bool\": {
      \"must\": [
        {\"match\": {\"message\": \"MaxListenersExceededWarning\"}},
        {\"match\": {\"message\": \"IncomingMessage\"}}
      ],
   \"must_not\" : [
      { \"term\": { \"_tier\": { \"value\": \"data_frozen\" } } }
   ]
    }
  }
}
</code></pre>
<p>##<span class=\"hashtag-raw\">#Update</span> Query <span class=\"hashtag-raw\">#2</span></p>
<pre><code class=\"lang-auto\">POST /&lt;insert_indices_patterns_here&gt;/_update_by_query?pipeline=redact-esa–2023-27&amp;pretty=true&amp;allow_no_indices=false&amp;wait_for_completion=false&amp;expand_wildcards=all&amp;conflicts=proceed
{
  \"query\": {
    \"bool\": {
    \"must_not\" : [
      { \"term\": { \"_tier\": { \"value\": \"data_frozen\" } } }
   ],
      \"should\": [
        { \"exists\": { \"field\": \"kibana.usageCounters.results.meta.meta.request.options.headers.authorization\"}},
        { \"exists\": { \"field\": \"kibana.usageCounters.results.meta.meta.request.options.headers.X-Elastic-App-Auth\"}},
        { \"exists\": { \"field\": \"kibana.usageCounters.results.meta.meta.request.options.headers.x-elastic-app-auth\"}},
        { \"exists\": { \"field\": \"kibana.usageCounters.results.meta.meta.request.options.headers.es-client-authentication\"}},
        { \"exists\": { \"field\": \"kibana.usageCounters.results.meta.meta.request.options.headers.ES-Client-Authentication\"}},
        { \"exists\": { \"field\": \"kibana.usageCounters.results.meta.meta.request.params.headers.authorization\"}},
        { \"exists\": { \"field\": \"kibana.usageCounters.results.meta.meta.request.params.headers.X-Elastic-App-Auth\"}},
        { \"exists\": { \"field\": \"kibana.usageCounters.results.meta.meta.request.params.headers.x-elastic-app-auth\"}},
        { \"exists\": { \"field\": \"kibana.usageCounters.results.meta.meta.request.params.headers.es-client-authentication\"}},
        { \"exists\": { \"field\": \"kibana.usageCounters.results.meta.meta.request.params.headers.ES-Client-Authentication\"}}
      ],
      \"minimum_should_match\": 1
    }
  }
}
</code></pre>
<h3><a name=\"update-query-3-18\" class=\"anchor\" href=\"https://discuss.elastic.co#update-query-3-18\"></a>Update Query <span class=\"hashtag-raw\">#3</span></h3>
<pre><code class=\"lang-auto\">POST /&lt;insert_indices_patterns_here&gt;/_update_by_query?pipeline=redact-esa–2023-27&amp;pretty=true&amp;allow_no_indices=false&amp;wait_for_completion=false&amp;expand_wildcards=all&amp;conflicts=proceed
{
  \"query\": {
    \"bool\": {
         \"must_not\" : [
      { \"term\": { \"_tier\": { \"value\": \"data_frozen\" } } }
   ],
      \"should\": [
        { \"match\": { \"message\": \"policy info exists as\"}},
        { \"match\": { \"message\": \"package policy exists as\"}},
        { \"match\": { \"message\": \"policy responses exists as\"}},
        { \"match\": { \"message\": \"endpoint metadata exists as\"}},
        { \"match\": { \"message\": \"trusted apps:\"}},
        { \"match\": { \"message\": \"ep exceptions:\"}},
        { \"match\": { \"message\": \"ep event filters:\"}},
        { \"match\": { \"message\": \"value list meta data:\"}},
        { \"match\": { \"message\": \"timeline events:\"}}
      ],
      \"minimum_should_match\": 1
    }
  }
}
</code></pre>
<h3><a name=\"update-query-4-19\" class=\"anchor\" href=\"https://discuss.elastic.co#update-query-4-19\"></a>Update Query <span class=\"hashtag-raw\">#4</span></h3>
<pre><code class=\"lang-auto\">POST /&lt;insert_indices_patterns_here&gt;/_update_by_query?pipeline=redact-esa–2023-27&amp;pretty=true&amp;allow_no_indices=false&amp;wait_for_completion=false&amp;expand_wildcards=all&amp;conflicts=proceed
{
  \"query\": {
    \"bool\": {
    \"must_not\" : [
      { \"term\": { \"_tier\": { \"value\": \"data_frozen\" } } }
   ],
      \"must\": [
        {\"match\": {\"message\": \"Preview of field's value\"}},
        {\"match\": {\"message\": \"--token\"}}
      ],
      \"should\": [
        {\"match\": {\"log.logger\": \"plugins.securitySolution.ruleExecution\"}},
        {\"match\": {\"log.logger\": \"plugins.ruleRegistry\"}}
      ],
      \"minimum_should_match\": 1
    }
  }
}
</code></pre>
<h3><a name=\"update-query-5-20\" class=\"anchor\" href=\"https://discuss.elastic.co#update-query-5-20\"></a>Update Query <span class=\"hashtag-raw\">#5</span></h3>
<pre><code class=\"lang-auto\">POST /&lt;insert_indices_patterns_here&gt;/_update_by_query?pipeline=redact-esa–2023-27&amp;pretty=true&amp;allow_no_indices=false&amp;wait_for_completion=false&amp;expand_wildcards=all&amp;conflicts=proceed
{
  \"query\": {
    \"bool\": {
     \"must_not\" : [
      { \"term\": { \"_tier\": { \"value\": \"data_frozen\" } } }
   ],
      \"must\": [
        {\"match_phrase\": {\"message\": \"error thrown getting the access token\"}}
      ]
    }
  }
}
</code></pre>
<h3><a name=\"update-query-6-21\" class=\"anchor\" href=\"https://discuss.elastic.co#update-query-6-21\"></a>Update Query <span class=\"hashtag-raw\">#6</span></h3>
<pre><code class=\"lang-auto\">POST /&lt;insert_indices_patterns_here&gt;/_update_by_query?pipeline=redact-esa–2023-27&amp;pretty=true&amp;allow_no_indices=false&amp;wait_for_completion=false&amp;expand_wildcards=all&amp;conflicts=proceed
{
  \"query\": {
    \"bool\": {
     \"must_not\" : [
      { \"term\": { \"_tier\": { \"value\": \"data_frozen\" } } }
   ],
      \"should\": [
        {\"exists\": {\"field\": \"http.request.headers.authorization\"}},
        {\"exists\": {\"field\": \"http.request.headers.x-elastic-app-auth\"}},
        {\"exists\": {\"field\": \"http.request.headers.X-Elastic-App-Auth\"}},
        {\"exists\": {\"field\": \"http.request.headers.es-client-authentication\"}},
        {\"exists\": {\"field\": \"http.request.headers.ES-Client-Authentication\"}},
        {\"exists\": {\"field\": \"error.cause.meta.meta.request.options.headers.authorization\"}},
        {\"exists\": {\"field\": \"error.cause.meta.meta.request.options.headers.x-elastic-app-auth\"}},
        {\"exists\": {\"field\": \"error.cause.meta.meta.request.options.headers.X-Elastic-App-Auth\"}},
        {\"exists\": {\"field\": \"error.cause.meta.meta.request.options.headers.es-client-authentication\"}},
        {\"exists\": {\"field\": \"error.cause.meta.meta.request.options.headers.ES-Client-Authentication\"}},
        {\"exists\": {\"field\": \"meta.meta.request.params.headers.authorization\"}},
        {\"exists\": {\"field\": \"meta.meta.request.params.headers.x-elastic-app-auth\"}},
        {\"exists\": {\"field\": \"meta.meta.request.params.headers.X-Elastic-App-Auth\"}},
        {\"exists\": {\"field\": \"meta.meta.request.params.headers.es-client-authentication\"}},
        {\"exists\": {\"field\": \"meta.meta.request.params.headers.ES-Client-Authentication\"}},
        {\"exists\": {\"field\": \"meta.meta.request.options.headers.authorization\"}},
        {\"exists\": {\"field\": \"meta.meta.request.options.headers.x-elastic-app-auth\"}},
        {\"exists\": {\"field\": \"meta.meta.request.options.headers.X-Elastic-App-Auth\"}},
        {\"exists\": {\"field\": \"meta.meta.request.options.headers.es-client-authentication\"}},
        {\"exists\": {\"field\": \"meta.meta.request.options.headers.ES-Client-Authentication\"}},
        {\"exists\": {\"field\": \"left.error.meta.meta.request.params.headers.authorization\"}},
        {\"exists\": {\"field\": \"left.error.meta.meta.request.params.headers.x-elastic-app-auth\"}},
        {\"exists\": {\"field\": \"left.error.meta.meta.request.params.headers.X-Elastic-App-Auth\"}},
        {\"exists\": {\"field\": \"left.error.meta.meta.request.params.headers.es-client-authentication\"}},
        {\"exists\": {\"field\": \"left.error.meta.meta.request.params.headers.ES-Client-Authentication\"}},
        {\"exists\": {\"field\": \"left.error.meta.meta.request.options.headers.authorization\"}},
        {\"exists\": {\"field\": \"left.error.meta.meta.request.options.headers.x-elastic-app-auth\"}},
        {\"exists\": {\"field\": \"left.error.meta.meta.request.options.headers.X-Elastic-App-Auth\"}},
        {\"exists\": {\"field\": \"left.error.meta.meta.request.options.headers.es-client-authentication\"}},
        {\"exists\": {\"field\": \"left.error.meta.meta.request.options.headers.ES-Client-Authentication\"}},
        {\"exists\": {\"field\": \"error.originalError.meta.meta.request.params.headers.authorization\"}},
        {\"exists\": {\"field\": \"error.originalError.meta.meta.request.params.headers.x-elastic-app-auth\"}},
        {\"exists\": {\"field\": \"error.originalError.meta.meta.request.params.headers.X-Elastic-App-Auth\"}},
        {\"exists\": {\"field\": \"error.originalError.meta.meta.request.params.headers.es-client-authentication\"}},
        {\"exists\": {\"field\": \"error.originalError.meta.meta.request.params.headers.ES-Client-Authentication\"}},
        {\"exists\": {\"field\": \"error.originalError.meta.meta.request.options.headers.authorization\"}},
        {\"exists\": {\"field\": \"error.originalError.meta.meta.request.options.headers.x-elastic-app-auth\"}},
        {\"exists\": {\"field\": \"error.originalError.meta.meta.request.options.headers.X-Elastic-App-Auth\"}},
        {\"exists\": {\"field\": \"error.originalError.meta.meta.request.options.headers.es-client-authentication\"}},
        {\"exists\": {\"field\": \"error.originalError.meta.meta.request.options.headers.ES-Client-Authentication\"}},
        {\"exists\": {\"field\": \"error.meta.meta.request.params.headers.authorization\"}},
        {\"exists\": {\"field\": \"error.meta.meta.request.params.headers.x-elastic-app-auth\"}},
        {\"exists\": {\"field\": \"error.meta.meta.request.params.headers.X-Elastic-App-Auth\"}},
        {\"exists\": {\"field\": \"error.meta.meta.request.params.headers.es-client-authentication\"}},
        {\"exists\": {\"field\": \"error.meta.meta.request.params.headers.ES-Client-Authentication\"}},
        {\"exists\": {\"field\": \"error.meta.meta.request.options.headers.authorization\"}},
        {\"exists\": {\"field\": \"error.meta.meta.request.options.headers.x-elastic-app-auth\"}},
        {\"exists\": {\"field\": \"error.meta.meta.request.options.headers.X-Elastic-App-Auth\"}},
        {\"exists\": {\"field\": \"error.meta.meta.request.options.headers.es-client-authentication\"}},
        {\"exists\": {\"field\": \"error.meta.meta.request.options.headers.ES-Client-Authentication\"}},
        {\"exists\": {\"field\": \"error.meta.meta.meta.request.params.headers.authorization\"}},
        {\"exists\": {\"field\": \"error.meta.meta.meta.request.params.headers.x-elastic-app-auth\"}},
        {\"exists\": {\"field\": \"error.meta.meta.meta.request.params.headers.X-Elastic-App-Auth\"}},
        {\"exists\": {\"field\": \"error.meta.meta.meta.request.params.headers.es-client-authentication\"}},
        {\"exists\": {\"field\": \"error.meta.meta.meta.request.params.headers.ES-Client-Authentication\"}},
        {\"exists\": {\"field\": \"error.meta.meta.meta.request.options.headers.authorization\"}},
        {\"exists\": {\"field\": \"error.meta.meta.meta.request.options.headers.x-elastic-app-auth\"}},
        {\"exists\": {\"field\": \"error.meta.meta.meta.request.options.headers.X-Elastic-App-Auth\"}},
        {\"exists\": {\"field\": \"error.meta.meta.meta.request.options.headers.es-client-authentication\"}},
        {\"exists\": {\"field\": \"error.meta.meta.meta.request.options.headers.ES-Client-Authentication\"}},
        {\"exists\": {\"field\": \"error.cause.meta.meta.request.params.headers.authorization\"}},
        {\"exists\": {\"field\": \"error.cause.meta.meta.request.params.headers.x-elastic-app-auth\"}},
        {\"exists\": {\"field\": \"error.cause.meta.meta.request.params.headers.X-Elastic-App-Auth\"}},
        {\"exists\": {\"field\": \"error.cause.meta.meta.request.params.headers.es-client-authentication\"}},
        {\"exists\": {\"field\": \"error.cause.meta.meta.request.params.headers.ES-Client-Authentication\"}}
      ],
      \"minimum_should_match\": 1
    }
  }
}
</code></pre>
<p>To check that the update_by_query task completes successfully:</p>
<pre><code class=\"lang-auto\">GET /_tasks/{taskId from above request}
</code></pre>
<p>—</p>
<p><strong>Severity:</strong> CVSSv3.1, 8.0 (High) <a href=\"https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:A/AC:H/PR:L/UI:N/S:C/C:H/I:H/A:H\">AV:A/AC:H/PR:L/UI:N/S:C/C:H/I:H/A:H</a><br>
<strong>CVE ID:</strong> CVE-2023-46675</p>
<h2><a name=\"appendix-22\" class=\"anchor\" href=\"https://discuss.elastic.co#appendix-22\"></a>Appendix</h2>
<h3><a name=\"a-search-queries-23\" class=\"anchor\" href=\"https://discuss.elastic.co#a-search-queries-23\"></a>A. Search Queries</h3>
<pre><code class=\"lang-auto\">GET /&lt;insert_indices_patterns_here&gt;/_search
{
  \"query\": {
    \"bool\": {
      \"must\": [
        {\"match\": {\"message\": \"MaxListenersExceededWarning\"}},
        {\"match\": {\"message\": \"IncomingMessage\"}}
      ]
    }
  }
}
</code></pre>
<pre><code class=\"lang-auto\">GET /&lt;insert_indices_patterns_here&gt;/_search 
{
  \"query\": {
    \"bool\": { 
      \"should\": [
        { \"exists\": { \"field\": \"kibana.usageCounters.results.meta.meta.request.options.headers.authorization\"}},
        { \"exists\": { \"field\": \"kibana.usageCounters.results.meta.meta.request.options.headers.X-Elastic-App-Auth\"}},
        { \"exists\": { \"field\": \"kibana.usageCounters.results.meta.meta.request.options.headers.x-elastic-app-auth\"}},
        { \"exists\": { \"field\": \"kibana.usageCounters.results.meta.meta.request.options.headers.es-client-authentication\"}},
        { \"exists\": { \"field\": \"kibana.usageCounters.results.meta.meta.request.options.headers.ES-Client-Authentication\"}},
        { \"exists\": { \"field\": \"kibana.usageCounters.results.meta.meta.request.params.headers.authorization\"}},
        { \"exists\": { \"field\": \"kibana.usageCounters.results.meta.meta.request.params.headers.X-Elastic-App-Auth\"}},
        { \"exists\": { \"field\": \"kibana.usageCounters.results.meta.meta.request.params.headers.x-elastic-app-auth\"}},
        { \"exists\": { \"field\": \"kibana.usageCounters.results.meta.meta.request.params.headers.es-client-authentication\"}},
        { \"exists\": { \"field\": \"kibana.usageCounters.results.meta.meta.request.params.headers.ES-Client-Authentication\"}}
      ],
      \"minimum_should_match\": 1
    }
  }
}
</code></pre>
<pre><code class=\"lang-auto\">GET /&lt;insert_indices_patterns_here&gt;/_search
{
  \"query\": {
    \"bool\": {
      \"should\": [
        { \"match\": { \"message\": \"policy info exists as\"}},
        { \"match\": { \"message\": \"package policy exists as\"}},
        { \"match\": { \"message\": \"policy responses exists as\"}},
        { \"match\": { \"message\": \"endpoint metadata exists as\"}},
        { \"match\": { \"message\": \"trusted apps:\"}},
        { \"match\": { \"message\": \"ep exceptions:\"}},
        { \"match\": { \"message\": \"ep event filters:\"}},
        { \"match\": { \"message\": \"value list meta data:\"}},
        { \"match\": { \"message\": \"timeline events:\"}}
      ],
      \"minimum_should_match\": 1
    }
  }
}
</code></pre>
<pre><code class=\"lang-auto\">GET /&lt;insert_indices_patterns_here&gt;/_search
{
  \"query\": {
    \"bool\": {
      \"must\": [
        {\"match\": {\"message\": \"Preview of field's value\"}},
        {\"match\": {\"message\": \"--token\"}}
      ],
      \"should\": [
        {\"match\": {\"log.logger\": \"plugins.securitySolution.ruleExecution\"}},
        {\"match\": {\"log.logger\": \"plugins.ruleRegistry\"}}
      ],
      \"minimum_should_match\": 1
    }
  }
}
</code></pre>
<pre><code class=\"lang-auto\">GET /&lt;insert_indices_patterns_here&gt;/_search
{
  \"query\": {
    \"bool\": {
      \"must\": [
        {\"match\": {
          \"log.logger\": \"plugins.actions.email\"
        }},
        {\"match\": {
          \"message\": \"token\"
        }}
      ]
    }
  }
}
</code></pre>
<pre><code class=\"lang-auto\">GET /&lt;insert_indices_patterns_here&gt;/_search
{
  \"query\": {
    \"bool\": {
      \"should\": [
        {\"exists\": {\"field\": \"http.request.headers.authorization\"}},
        {\"exists\": {\"field\": \"http.request.headers.x-elastic-app-auth\"}},
        {\"exists\": {\"field\": \"http.request.headers.X-Elastic-App-Auth\"}},
        {\"exists\": {\"field\": \"http.request.headers.es-client-authentication\"}},
        {\"exists\": {\"field\": \"http.request.headers.ES-Client-Authentication\"}},
        {\"exists\": {\"field\": \"error.cause.meta.meta.request.options.headers.authorization\"}},
        {\"exists\": {\"field\": \"error.cause.meta.meta.request.options.headers.x-elastic-app-auth\"}},
        {\"exists\": {\"field\": \"error.cause.meta.meta.request.options.headers.X-Elastic-App-Auth\"}},
        {\"exists\": {\"field\": \"error.cause.meta.meta.request.options.headers.es-client-authentication\"}},
        {\"exists\": {\"field\": \"error.cause.meta.meta.request.options.headers.ES-Client-Authentication\"}},
        {\"exists\": {\"field\": \"meta.meta.request.params.headers.authorization\"}},
        {\"exists\": {\"field\": \"meta.meta.request.params.headers.x-elastic-app-auth\"}},
        {\"exists\": {\"field\": \"meta.meta.request.params.headers.X-Elastic-App-Auth\"}},
        {\"exists\": {\"field\": \"meta.meta.request.params.headers.es-client-authentication\"}},
        {\"exists\": {\"field\": \"meta.meta.request.params.headers.ES-Client-Authentication\"}},
        {\"exists\": {\"field\": \"meta.meta.request.options.headers.authorization\"}},
        {\"exists\": {\"field\": \"meta.meta.request.options.headers.x-elastic-app-auth\"}},
        {\"exists\": {\"field\": \"meta.meta.request.options.headers.X-Elastic-App-Auth\"}},
        {\"exists\": {\"field\": \"meta.meta.request.options.headers.es-client-authentication\"}},
        {\"exists\": {\"field\": \"meta.meta.request.options.headers.ES-Client-Authentication\"}},
        {\"exists\": {\"field\": \"left.error.meta.meta.request.params.headers.authorization\"}},
        {\"exists\": {\"field\": \"left.error.meta.meta.request.params.headers.x-elastic-app-auth\"}},
        {\"exists\": {\"field\": \"left.error.meta.meta.request.params.headers.X-Elastic-App-Auth\"}},
        {\"exists\": {\"field\": \"left.error.meta.meta.request.params.headers.es-client-authentication\"}},
        {\"exists\": {\"field\": \"left.error.meta.meta.request.params.headers.ES-Client-Authentication\"}},
        {\"exists\": {\"field\": \"left.error.meta.meta.request.options.headers.authorization\"}},
        {\"exists\": {\"field\": \"left.error.meta.meta.request.options.headers.x-elastic-app-auth\"}},
        {\"exists\": {\"field\": \"left.error.meta.meta.request.options.headers.X-Elastic-App-Auth\"}},
        {\"exists\": {\"field\": \"left.error.meta.meta.request.options.headers.es-client-authentication\"}},
        {\"exists\": {\"field\": \"left.error.meta.meta.request.options.headers.ES-Client-Authentication\"}},
        {\"exists\": {\"field\": \"error.originalError.meta.meta.request.params.headers.authorization\"}},
        {\"exists\": {\"field\": \"error.originalError.meta.meta.request.params.headers.x-elastic-app-auth\"}},
        {\"exists\": {\"field\": \"error.originalError.meta.meta.request.params.headers.X-Elastic-App-Auth\"}},
        {\"exists\": {\"field\": \"error.originalError.meta.meta.request.params.headers.es-client-authentication\"}},
        {\"exists\": {\"field\": \"error.originalError.meta.meta.request.params.headers.ES-Client-Authentication\"}},
        {\"exists\": {\"field\": \"error.originalError.meta.meta.request.options.headers.authorization\"}},
        {\"exists\": {\"field\": \"error.originalError.meta.meta.request.options.headers.x-elastic-app-auth\"}},
        {\"exists\": {\"field\": \"error.originalError.meta.meta.request.options.headers.X-Elastic-App-Auth\"}},
        {\"exists\": {\"field\": \"error.originalError.meta.meta.request.options.headers.es-client-authentication\"}},
        {\"exists\": {\"field\": \"error.originalError.meta.meta.request.options.headers.ES-Client-Authentication\"}},
        {\"exists\": {\"field\": \"error.meta.meta.request.params.headers.authorization\"}},
        {\"exists\": {\"field\": \"error.meta.meta.request.params.headers.x-elastic-app-auth\"}},
        {\"exists\": {\"field\": \"error.meta.meta.request.params.headers.X-Elastic-App-Auth\"}},
        {\"exists\": {\"field\": \"error.meta.meta.request.params.headers.es-client-authentication\"}},
        {\"exists\": {\"field\": \"error.meta.meta.request.params.headers.ES-Client-Authentication\"}},
        {\"exists\": {\"field\": \"error.meta.meta.request.options.headers.authorization\"}},
        {\"exists\": {\"field\": \"error.meta.meta.request.options.headers.x-elastic-app-auth\"}},
        {\"exists\": {\"field\": \"error.meta.meta.request.options.headers.X-Elastic-App-Auth\"}},
        {\"exists\": {\"field\": \"error.meta.meta.request.options.headers.es-client-authentication\"}},
        {\"exists\": {\"field\": \"error.meta.meta.request.options.headers.ES-Client-Authentication\"}},
        {\"exists\": {\"field\": \"error.meta.meta.meta.request.params.headers.authorization\"}},
        {\"exists\": {\"field\": \"error.meta.meta.meta.request.params.headers.x-elastic-app-auth\"}},
        {\"exists\": {\"field\": \"error.meta.meta.meta.request.params.headers.X-Elastic-App-Auth\"}},
        {\"exists\": {\"field\": \"error.meta.meta.meta.request.params.headers.es-client-authentication\"}},
        {\"exists\": {\"field\": \"error.meta.meta.meta.request.params.headers.ES-Client-Authentication\"}},
        {\"exists\": {\"field\": \"error.meta.meta.meta.request.options.headers.authorization\"}},
        {\"exists\": {\"field\": \"error.meta.meta.meta.request.options.headers.x-elastic-app-auth\"}},
        {\"exists\": {\"field\": \"error.meta.meta.meta.request.options.headers.X-Elastic-App-Auth\"}},
        {\"exists\": {\"field\": \"error.meta.meta.meta.request.options.headers.es-client-authentication\"}},
        {\"exists\": {\"field\": \"error.meta.meta.meta.request.options.headers.ES-Client-Authentication\"}},
        {\"exists\": {\"field\": \"error.cause.meta.meta.request.params.headers.authorization\"}},
        {\"exists\": {\"field\": \"error.cause.meta.meta.request.params.headers.x-elastic-app-auth\"}},
        {\"exists\": {\"field\": \"error.cause.meta.meta.request.params.headers.X-Elastic-App-Auth\"}},
        {\"exists\": {\"field\": \"error.cause.meta.meta.request.params.headers.es-client-authentication\"}},
        {\"exists\": {\"field\": \"error.cause.meta.meta.request.params.headers.ES-Client-Authentication\"}}
      ],
      \"minimum_should_match\": 1
    }
  }
}
</code></pre>
            <p><small>2 posts - 1 participant</small></p>
            <p><a href=\"https://discuss.elastic.co/t/kibana-8-11-2-7-17-16-security-update-esa-2023-27/349182\">Read full topic</a></p>" "https://discuss.elastic.co/t/kibana-8-11-2-7-17-16-security-update-esa-2023-27/349182" (25976 38656) new 24 nil nil ((title nil "Kibana 8.11.2, 7.17.16 Security Update (ESA-2023-27)") (creator nil "ikakavas") (category nil "Security Announcements") (description nil "
            <h1><a name=\"kibana-insertion-of-sensitive-information-into-log-file-esa-2023-27-1\" class=\"anchor\" href=\"https://discuss.elastic.co#kibana-insertion-of-sensitive-information-into-log-file-esa-2023-27-1\"></a>Kibana Insertion of Sensitive Information into Log File (ESA-2023-27)</h1>
<p>An issue was discovered by Elastic whereby sensitive information may be recorded in Kibana logs in the event of an error or in the event where <a href=\"https://www.elastic.co/guide/en/kibana/current/logging-configuration.html#log-level\">debug level logging is enabled in Kibana</a>. Elastic has released Kibana 8.11.2 which resolves this issue. The messages recorded in the log may contain:</p>
<ul>
<li>Account credentials for the <a href=\"https://www.elastic.co/guide/en/elasticsearch/reference/current/built-in-users.html\"><code>kibana_system</code></a> user, API Keys, and credentials of Kibana end-users.</li>
<li>Elastic Security package policy objects which can contain private keys, bearer token, and sessions of 3rd-party integrations.</li>
<li>Authorization headers, client secrets, local file paths, and stack traces</li>
</ul>
<p>The issue may occur in any Kibana instance running an affected version (which are listed below) that could potentially receive an unexpected error when communicating to Elasticsearch causing it to include sensitive data into Kibana error logs. It could also occur under specific circumstances when <a href=\"https://www.elastic.co/guide/en/kibana/current/logging-configuration.html#log-level\">debug level logging is enabled in Kibana</a>.</p>
<p><strong>Note:</strong> It was found that the fix for ESA-2023-25 in Kibana 8.11.1 for a similar issue was incomplete.</p>
<h2><a name=\"affected-versions-2\" class=\"anchor\" href=\"https://discuss.elastic.co#affected-versions-2\"></a>Affected Versions:</h2>
<p>Kibana versions on or after 7.13.0 and before 7.17.16.<br>
Kibana versions on or after 8.0.0 and before 8.11.2.</p>
<h2><a name=\"solutions-and-mitigations-3\" class=\"anchor\" href=\"https://discuss.elastic.co#solutions-and-mitigations-3\"></a>Solutions and Mitigations:</h2>
<p>The issue is resolved in Kibana 8.11.2 and 7.17.16</p>
<h3><a name=\"elastic-cloud-4\" class=\"anchor\" href=\"https://discuss.elastic.co#elastic-cloud-4\"></a>Elastic Cloud</h3>
<p>The following mitigations have been implemented in Elastic Cloud:</p>
<ul>
<li>We have purged sensitive data that was logged from our monitoring environment.</li>
<li>We have adjusted the rulesets of our redaction solution so that no new instances of sensitive information are logged in our monitoring environment and in customer’s monitoring clusters.</li>
</ul>
<p>For Elastic Cloud customers with <strong>self-managed monitoring clusters</strong>, affected logs should be reviewed for any potentially sensitive data and if deemed necessary, follow up actions such as purging sensitive data from logs and rotating any potentially exposed credentials should be performed.</p>
<p>As additional mitigation, Elastic Cloud customers on affected versions of Kibana are advised to upgrade to 8.11.3.</p>
<h3><a name=\"self-managed-5\" class=\"anchor\" href=\"https://discuss.elastic.co#self-managed-5\"></a>Self-Managed</h3>
<p>Users on affected versions of Kibana in self-managed, ECE, or ECK, are advised to upgrade to 8.11.2 or later.</p>
<p>Affected logs should be reviewed for any potentially sensitive data and if deemed necessary,  follow up actions such as purging sensitive data from logs and rotating any potentially exposed credentials should be performed.</p>
<p>For users that cannot upgrade, see the section <em>Preventing Ingest of Sensitive Information</em> for mitigation actions that can be applied.</p>
<h2><a name=\"reviewing-logs-for-sensitive-information-6\" class=\"anchor\" href=\"https://discuss.elastic.co#reviewing-logs-for-sensitive-information-6\"></a>Reviewing Logs for Sensitive Information</h2>
<p>This section describes how to review logs to identify instances of potentially sensitive information in your logs.</p>
<h3><a name=\"elastic-cloud-customers-with-self-managed-monitoring-clusters-7\" class=\"anchor\" href=\"https://discuss.elastic.co#elastic-cloud-customers-with-self-managed-monitoring-clusters-7\"></a>Elastic Cloud customers with self-managed monitoring clusters</h3>
<p>Affected log lines can be identified with the use of the queries described in <em>Appendix A. Search Queries.</em>  against the data views that <a href=\"https://www.elastic.co/guide/en/cloud/current/ec-enable-logging-and-monitoring.html#ec-access-kibana-monitoring\">contain Kibana logs on the monitoring cluster</a></p>
<h3><a name=\"self-managed-with-elastic-stack-monitoring-8\" class=\"anchor\" href=\"https://discuss.elastic.co#self-managed-with-elastic-stack-monitoring-8\"></a>Self-Managed with Elastic Stack Monitoring</h3>
<p>If you are using <a href=\"https://www.elastic.co/guide/en/kibana/current/configuring-monitoring.html\">Elastic Stack to ingest Kibana logs</a>, affected log lines can be identified with the use of the queries that are defined in <em>Appendix A. Search Queries</em> against the data views that contain Kibana logs on the monitoring cluster:</p>
<ul>
<li>If <a href=\"https://www.elastic.co/guide/en/kibana/current/monitoring-elastic-agent.html\">Elastic Agent Collection</a> is configured: <code>logs-kibana.*-default</code></li>
<li>If <a href=\"https://www.elastic.co/guide/en/kibana/current/monitoring-metricbeat.html\">Filebeat Collection</a> is configured: <code>filebeat-{version}</code> , where <code>{version}</code> is the installed Kibana version.</li>
</ul>
<h3><a name=\"self-managed-without-elastic-stack-monitoring-9\" class=\"anchor\" href=\"https://discuss.elastic.co#self-managed-without-elastic-stack-monitoring-9\"></a>Self-Managed without Elastic Stack Monitoring</h3>
<p>If you are not ingesting Kibana logs in the Elastic Stack, you can search the log files on disk for occurrences where the following terms are present:</p>
<ul>
<li>“MaxListenersExceededWarning”, “IncomingMessage”</li>
<li>Any of the following message substrings
<ul>
<li>\"policy info exists as\"</li>
<li>\"package policy exists as\"</li>
<li>\"policy responses exists as\"</li>
<li>\"endpoint metadata exists as\"</li>
<li>\"Trusted Apps\"</li>
<li>\"EP Exceptions\"</li>
<li>\"EP Event Filters\"</li>
<li>\"Value List Meta Data\"</li>
<li>\"Timeline Events\"</li>
</ul>
</li>
<li>\"Preview of field's value\", \"--token\", (\"plugins.securitySolution.ruleExecution\" or  \"plugins.ruleRegistry”)</li>
<li>“error thrown getting the access token”</li>
<li>Any of the following fields
<ul>
<li>\"kibana.usageCounters.results.meta.meta.request.options.headers.authorization\"</li>
<li>\"kibana.usageCounters.results.meta.meta.request.options.headers.X-Elastic-App-Auth\"</li>
<li>\"kibana.usageCounters.results.meta.meta.request.options.headers.x-elastic-app-auth\"</li>
<li>\"kibana.usageCounters.results.meta.meta.request.options.headers.es-client-authentication\"</li>
<li>\"kibana.usageCounters.results.meta.meta.request.options.headers.ES-Client-Authentication\"</li>
<li>\"kibana.usageCounters.results.meta.meta.request.params.headers.authorization\"</li>
<li>\"kibana.usageCounters.results.meta.meta.request.params.headers.X-Elastic-App-Auth\"</li>
<li>\"kibana.usageCounters.results.meta.meta.request.params.headers.x-elastic-app-auth\"</li>
<li>\"kibana.usageCounters.results.meta.meta.request.params.headers.es-client-authentication\"</li>
<li>\"kibana.usageCounters.results.meta.meta.request.params.headers.ES-Client-Authentication\"</li>
<li>\"http.request.headers.authorization\"</li>
<li>\"http.request.headers.x-elastic-app-auth\"</li>
<li>\"http.request.headers.X-Elastic-App-Auth\"</li>
<li>\"http.request.headers.es-client-authentication\"</li>
<li>\"http.request.headers.ES-Client-Authentication\"</li>
<li>\"error.cause.meta.meta.request.options.headers.authorization\"</li>
<li>\"error.cause.meta.meta.request.options.headers.x-elastic-app-auth\"</li>
<li>\"error.cause.meta.meta.request.options.headers.X-Elastic-App-Auth\"</li>
<li>\"error.cause.meta.meta.request.options.headers.es-client-authentication\"</li>
<li>\"error.cause.meta.meta.request.options.headers.ES-Client-Authentication\"</li>
<li>\"meta.meta.request.params.headers.authorization\"</li>
<li>\"meta.meta.request.params.headers.x-elastic-app-auth\"</li>
<li>\"meta.meta.request.params.headers.X-Elastic-App-Auth\"</li>
<li>\"meta.meta.request.params.headers.es-client-authentication\"</li>
<li>\"meta.meta.request.params.headers.ES-Client-Authentication\"</li>
<li>\"meta.meta.request.options.headers.authorization\"</li>
<li>\"meta.meta.request.options.headers.x-elastic-app-auth\"</li>
<li>\"meta.meta.request.options.headers.X-Elastic-App-Auth\"</li>
<li>\"meta.meta.request.options.headers.es-client-authentication\"</li>
<li>\"meta.meta.request.options.headers.ES-Client-Authentication\"</li>
<li>\"left.error.meta.meta.request.params.headers.authorization\"</li>
<li>\"left.error.meta.meta.request.params.headers.x-elastic-app-auth\"</li>
<li>\"left.error.meta.meta.request.params.headers.X-Elastic-App-Auth\"</li>
<li>\"left.error.meta.meta.request.params.headers.es-client-authentication\"</li>
<li>\"left.error.meta.meta.request.params.headers.ES-Client-Authentication\"</li>
<li>\"left.error.meta.meta.request.options.headers.authorization\"</li>
<li>\"left.error.meta.meta.request.options.headers.x-elastic-app-auth\"</li>
<li>\"left.error.meta.meta.request.options.headers.X-Elastic-App-Auth\"</li>
<li>\"left.error.meta.meta.request.options.headers.es-client-authentication\"</li>
<li>\"left.error.meta.meta.request.options.headers.ES-Client-Authentication\"</li>
<li>\"error.originalError.meta.meta.request.params.headers.authorization\"</li>
<li>\"error.originalError.meta.meta.request.params.headers.x-elastic-app-auth\"</li>
<li>\"error.originalError.meta.meta.request.params.headers.X-Elastic-App-Auth\"</li>
<li>\"error.originalError.meta.meta.request.params.headers.es-client-authentication\"</li>
<li>\"error.originalError.meta.meta.request.params.headers.ES-Client-Authentication\"</li>
<li>\"error.originalError.meta.meta.request.options.headers.authorization\"</li>
<li>\"error.originalError.meta.meta.request.options.headers.x-elastic-app-auth\"</li>
<li>\"error.originalError.meta.meta.request.options.headers.X-Elastic-App-Auth\"</li>
<li>\"error.originalError.meta.meta.request.options.headers.es-client-authentication\"</li>
<li>\"error.originalError.meta.meta.request.options.headers.ES-Client-Authentication\"</li>
<li>\"error.meta.meta.request.params.headers.authorization\"</li>
<li>\"error.meta.meta.request.params.headers.x-elastic-app-auth\"</li>
<li>\"error.meta.meta.request.params.headers.X-Elastic-App-Auth\"</li>
<li>\"error.meta.meta.request.params.headers.es-client-authentication\"</li>
<li>\"error.meta.meta.request.params.headers.ES-Client-Authentication\"</li>
<li>\"error.meta.meta.request.options.headers.authorization\"</li>
<li>\"error.meta.meta.request.options.headers.x-elastic-app-auth\"</li>
<li>\"error.meta.meta.request.options.headers.X-Elastic-App-Auth\"</li>
<li>\"error.meta.meta.request.options.headers.es-client-authentication\"</li>
<li>\"error.meta.meta.request.options.headers.ES-Client-Authentication\"</li>
<li>\"error.meta.meta.meta.request.params.headers.authorization\"</li>
<li>\"error.meta.meta.meta.request.params.headers.x-elastic-app-auth\"</li>
<li>\"error.meta.meta.meta.request.params.headers.X-Elastic-App-Auth\"</li>
<li>\"error.meta.meta.meta.request.params.headers.es-client-authentication\"</li>
<li>\"error.meta.meta.meta.request.params.headers.ES-Client-Authentication\"</li>
<li>\"error.meta.meta.meta.request.options.headers.authorization\"</li>
<li>\"error.meta.meta.meta.request.options.headers.x-elastic-app-auth\"</li>
<li>\"error.meta.meta.meta.request.options.headers.X-Elastic-App-Auth\"</li>
<li>\"error.meta.meta.meta.request.options.headers.es-client-authentication\"</li>
<li>\"error.meta.meta.meta.request.options.headers.ES-Client-Authentication\"</li>
<li>\"error.cause.meta.meta.request.params.headers.authorization\"</li>
<li>\"error.cause.meta.meta.request.params.headers.x-elastic-app-auth\"</li>
<li>\"error.cause.meta.meta.request.params.headers.X-Elastic-App-Auth\"</li>
<li>\"error.cause.meta.meta.request.params.headers.es-client-authentication\"</li>
<li>\"error.cause.meta.meta.request.params.headers.ES-Client-Authentication\"</li>
</ul>
</li>
</ul>
<h3><a name=\"ece-10\" class=\"anchor\" href=\"https://discuss.elastic.co#ece-10\"></a>ECE</h3>
<p>On ECE, affected log lines can be identified with the use of the queries that are defined in <em>Appendix A. Search Queries</em> against the <code>cluster-logs-*</code> indices in the <a href=\"https://www.elastic.co/guide/en/cloud-enterprise/current/ece-monitoring-ece-access.html\">logging and metrics cluster</a>.</p>
<h3><a name=\"eck-11\" class=\"anchor\" href=\"https://discuss.elastic.co#eck-11\"></a>ECK</h3>
<p>If <a href=\"https://www.elastic.co/guide/en/cloud-on-k8s/master/k8s-stack-monitoring.html\">Stack Monitoring is enabled</a>, affected log lines can be identified with the use of the queries that are defined in <em>Appendix A. Search Queries</em> against the data views that contain Kibana logs on the monitoring cluster:</p>
<ul>
<li>If <a href=\"https://www.elastic.co/guide/en/kibana/current/monitoring-elastic-agent.html\">Elastic Agent Collection</a> is configured: <code>logs-kibana.*-default</code></li>
<li>If <a href=\"https://www.elastic.co/guide/en/kibana/current/monitoring-metricbeat.html\">Filebeat Collection</a> is configured: <code>filebeat-{version}</code> , where <code>{version}</code> is the installed Kibana version.</li>
</ul>
<h2><a name=\"remediating-sensitive-information-12\" class=\"anchor\" href=\"https://discuss.elastic.co#remediating-sensitive-information-12\"></a>Remediating Sensitive Information</h2>
<p>If the review reveals that credentials have been included in the logs, the following remediation actions are recommended</p>
<div class=\"md-table\">
<table>
<thead>
<tr>
<th>Installation Type</th>
<th>Remediation Actions</th>
</tr>
</thead>
<tbody>
<tr>
<td>Elastic Cloud</td>
<td><code>found-internal-kibana4-server credentials</code> credentials are being rotated by Elastic. End user credentials can be changed using the Management &gt; Users UI in Kibana or the <a href=\"https://www.elastic.co/guide/en/elasticsearch/reference/current/security-api-change-password.html\">Change Password API</a>.</td>
</tr>
<tr>
<td>Archive Docker RPM/DEB</td>
<td>kibana_system credentials can be rotated <a href=\"https://www.elastic.co/guide/en/elasticsearch/reference/current/change-passwords-native-users.html\">using one of the available methods</a> if a native user is used. If service account tokens are used, you need to <a href=\"https://www.elastic.co/guide/en/elasticsearch/reference/8.9/security-api-delete-service-token.html\">delete the logged token</a> and <a href=\"https://www.elastic.co/guide/en/elasticsearch/reference/8.9/security-api-create-service-token.html\">create a new token</a> <br><br>End user credentials can be changed using the Management &gt; Users UI in Kibana or the <a href=\"https://www.elastic.co/guide/en/elasticsearch/reference/current/security-api-change-password.html\">Change Password API</a>.</td>
</tr>
<tr>
<td>ECE</td>
<td><code>found-internal-kibana4-server</code> credentials can be rotated using advanced editor: <br>1. Go to advanced editor<br>2. Find \".resources.kibana[0].plan.cluster_topology[0].kibana.system_settings\" <br>3. Set \"elasticsearch_password\" to a random string <br>4. submit <br><br>End user credentials can be changed using the Management &gt; Users UI in Kibana or the <a href=\"https://www.elastic.co/guide/en/elasticsearch/reference/current/security-api-change-password.html\">Change Password API</a>.</td>
</tr>
<tr>
<td>ECK</td>
<td>Kibana system user credentials <a href=\"https://www.elastic.co/guide/en/cloud-on-k8s/current/k8s-rotate-credentials.html\">can be rotated</a> by either of the following options: <br> - Delete <code>$KIBANA_NAME-kibana-user</code> secret in the Kibana K8s namespace and restart the ECK operator. <br>- Delete <code>$KIBANA_NAME-kibana-user</code> and <code>$NAMESPACE-$KIBANA_NAME-kibana-user</code> secrets in the Kibana K8s namespace <br><br> End user credentials can be changed using the Management &gt; Users UI in Kibana or the <a href=\"https://www.elastic.co/guide/en/elasticsearch/reference/current/security-api-change-password.html\">Change Password API</a>.</td>
</tr>
</tbody>
</table>
</div><h2><a name=\"preventing-ingest-of-sensitive-information-in-logs-13\" class=\"anchor\" href=\"https://discuss.elastic.co#preventing-ingest-of-sensitive-information-in-logs-13\"></a>Preventing Ingest of Sensitive Information in Logs</h2>
<p>For users that cannot upgrade, the following mitigation actions can be applied to prevent ingestion of sensitive information into an elasticsearch logging cluster.</p>
<p>The following mitigations are for customers who have enabled the monitoring features for their clusters as outlined in this <a href=\"https://www.elastic.co/guide/en/kibana/current/configuring-monitoring.html\">guide</a>.</p>
<p>If you are using <a href=\"https://www.elastic.co/guide/en/kibana/current/configuring-monitoring.html\">Elastic Stack to ingest Kibana logs</a>, use ECE, or <a href=\"https://www.elastic.co/guide/en/cloud-on-k8s/master/k8s-stack-monitoring.html\">use ECK with stack monitoring enabled</a> , you can use an <a href=\"https://www.elastic.co/guide/en/elasticsearch/reference/current/ingest.html\">Ingest Pipeline</a> to redact sensitive information from being ingested in a logging cluster.</p>
<ol>
<li>Create the remediation pipeline:</li>
</ol>
<pre><code class=\"lang-auto\">PUT _ingest/pipeline/redact-esa–2023-27
{
 \"description\": \"Prevent Insertion of Sensitive Information into Log File (ESA-2023-27)\",
 \"processors\": [
    {
      \"set\": {
        \"description\": \"Redact credentials in MaxListenersExceededWarning errors message field\",
        \"if\": \"ctx.message != null &amp;&amp; ctx.message.startsWith('MaxListenersExceededWarning') &amp;&amp; ctx.message.contains('IncomingMessage')\",
        \"field\": \"message\",
        \"value\": \"MaxListenersExceededWarning: Possible EventEmitter memory leak detected. There are aborted listeners added to [IncomingMessage]. Use emitter.setMaxListeners() to increase limit\",
        \"ignore_empty_value\": true
      }
    },
    {
      \"set\": {
        \"description\": \"Redact credentials in MaxListenersExceededWarning errors event.original field\",
        \"if\": \"ctx.event.original != null &amp;&amp; ctx.event.original.startsWith('MaxListenersExceededWarning') &amp;&amp; ctx.event.original.contains('IncomingMessage')\",
        \"field\": \"event.original\",
        \"value\": \"MaxListenersExceededWarning: Possible EventEmitter memory leak detected. There are aborted listeners added to [IncomingMessage]. Use emitter.setMaxListeners() to increase limit\",
        \"ignore_empty_value\": true
      }
    },
   {
     \"remove\": {
       \"description\": \"Kibana log record metadata with sensitive HTTP headers\",
       \"field\": [
         \"http.request.headers.authorization\",
         \"http.request.headers.x-elastic-app-auth\",
         \"http.request.headers.X-Elastic-App-Auth\",
         \"http.request.headers.es-client-authentication\",
         \"http.request.headers.ES-Client-Authentication\",
         \"error.cause.meta.meta.request.options.headers.authorization\",
         \"error.cause.meta.meta.request.options.headers.x-elastic-app-auth\",
         \"error.cause.meta.meta.request.options.headers.X-Elastic-App-Auth\",
         \"error.cause.meta.meta.request.options.headers.es-client-authentication\",
         \"error.cause.meta.meta.request.options.headers.ES-Client-Authentication\",
         \"meta.meta.request.params.headers.authorization\",
         \"meta.meta.request.params.headers.x-elastic-app-auth\",
         \"meta.meta.request.params.headers.X-Elastic-App-Auth\",
         \"meta.meta.request.params.headers.es-client-authentication\",
         \"meta.meta.request.params.headers.ES-Client-Authentication\",
         \"meta.meta.request.options.headers.authorization\",
         \"meta.meta.request.options.headers.x-elastic-app-auth\",
         \"meta.meta.request.options.headers.X-Elastic-App-Auth\",
         \"meta.meta.request.options.headers.es-client-authentication\",
         \"meta.meta.request.options.headers.ES-Client-Authentication\",
         \"left.error.meta.meta.request.params.headers.authorization\",
         \"left.error.meta.meta.request.params.headers.x-elastic-app-auth\",
         \"left.error.meta.meta.request.params.headers.X-Elastic-App-Auth\",
         \"left.error.meta.meta.request.params.headers.es-client-authentication\",
         \"left.error.meta.meta.request.params.headers.ES-Client-Authentication\",
         \"left.error.meta.meta.request.options.headers.authorization\",
         \"left.error.meta.meta.request.options.headers.x-elastic-app-auth\",
         \"left.error.meta.meta.request.options.headers.X-Elastic-App-Auth\",
         \"left.error.meta.meta.request.options.headers.es-client-authentication\",
         \"left.error.meta.meta.request.options.headers.ES-Client-Authentication\",
         \"error.originalError.meta.meta.request.params.headers.authorization\",
         \"error.originalError.meta.meta.request.params.headers.x-elastic-app-auth\",
         \"error.originalError.meta.meta.request.params.headers.X-Elastic-App-Auth\",
         \"error.originalError.meta.meta.request.params.headers.es-client-authentication\",
         \"error.originalError.meta.meta.request.params.headers.ES-Client-Authentication\",
         \"error.originalError.meta.meta.request.options.headers.authorization\",
         \"error.originalError.meta.meta.request.options.headers.x-elastic-app-auth\",
         \"error.originalError.meta.meta.request.options.headers.X-Elastic-App-Auth\",
         \"error.originalError.meta.meta.request.options.headers.es-client-authentication\",
         \"error.originalError.meta.meta.request.options.headers.ES-Client-Authentication\",
         \"error.meta.meta.request.params.headers.authorization\",
         \"error.meta.meta.request.params.headers.x-elastic-app-auth\",
         \"error.meta.meta.request.params.headers.X-Elastic-App-Auth\",
         \"error.meta.meta.request.params.headers.es-client-authentication\",
         \"error.meta.meta.request.params.headers.ES-Client-Authentication\",
         \"error.meta.meta.request.options.headers.authorization\",
         \"error.meta.meta.request.options.headers.x-elastic-app-auth\",
         \"error.meta.meta.request.options.headers.X-Elastic-App-Auth\",
         \"error.meta.meta.request.options.headers.es-client-authentication\",
         \"error.meta.meta.request.options.headers.ES-Client-Authentication\",
         \"error.meta.meta.meta.request.params.headers.authorization\",
         \"error.meta.meta.meta.request.params.headers.x-elastic-app-auth\",
         \"error.meta.meta.meta.request.params.headers.X-Elastic-App-Auth\",
         \"error.meta.meta.meta.request.params.headers.es-client-authentication\",
         \"error.meta.meta.meta.request.params.headers.ES-Client-Authentication\",
         \"error.meta.meta.meta.request.options.headers.authorization\",
         \"error.meta.meta.meta.request.options.headers.x-elastic-app-auth\",
         \"error.meta.meta.meta.request.options.headers.X-Elastic-App-Auth\",
         \"error.meta.meta.meta.request.options.headers.es-client-authentication\",
         \"error.meta.meta.meta.request.options.headers.ES-Client-Authentication\",
         \"error.cause.meta.meta.request.params.headers.authorization\",
         \"error.cause.meta.meta.request.params.headers.x-elastic-app-auth\",
         \"error.cause.meta.meta.request.params.headers.X-Elastic-App-Auth\",
         \"error.cause.meta.meta.request.params.headers.es-client-authentication\",
         \"error.cause.meta.meta.request.params.headers.ES-Client-Authentication\"
       ],
       \"ignore_missing\": true
     }
   },
    {
      \"foreach\": {
        \"field\": \"kibana.usageCounters.results\",
        \"processor\": {
          \"remove\": {
            \"field\": [
              \"_ingest._value.meta.meta.request.options.headers.authorization\",
              \"_ingest._value.meta.meta.request.options.headers.X-Elastic-App-Auth\",
              \"_ingest._value.meta.meta.request.options.headers.x-elastic-app-auth\",
              \"_ingest._value.meta.meta.request.options.headers.es-client-authentication\",
              \"_ingest._value.meta.meta.request.options.headers.ES-Client-Authentication\",
              \"_ingest._value.meta.meta.request.params.headers.authorization\",
              \"_ingest._value.meta.meta.request.params.headers.X-Elastic-App-Auth\",
              \"_ingest._value.meta.meta.request.params.headers.x-elastic-app-auth\",
              \"_ingest._value.meta.meta.request.params.headers.es-client-authentication\",
              \"_ingest._value.meta.meta.request.params.headers.ES-Client-Authentication\"
            ],
            \"ignore_missing\": true
          }
        },
        \"ignore_missing\": true
      }
    },
   {
     \"dot_expander\": {
       \"description\": \"Expand 'event.original'\",
       \"field\": \"event.original\"
     }
   },
   {
     \"set\": {
       \"field\": \"message\",
       \"value\": \"policy info exists as [redacted]\",
       \"if\": \"ctx.message != null &amp;&amp; ctx.message.toLowerCase().contains('policy info exists as')\"
     }
   },
   {
     \"set\": {
       \"field\": \"event.original\",
       \"value\": \"policy info exists as [redacted]\",
       \"if\": \"ctx.event.original != null &amp;&amp; ctx.event.original.toLowerCase().contains('policy info exists as')\"
     }
   },
   {
     \"set\": {
       \"field\": \"message\",
       \"value\": \"package policy exists as [redacted]\",
       \"if\": \"ctx.message != null &amp;&amp; ctx.message.toLowerCase().contains('package policy exists as')\"
     }
   },
   {
     \"set\": {
       \"field\": \"event.original\",
       \"value\": \"package policy exists as [redacted]\",
       \"if\": \"ctx.event.original != null &amp;&amp; ctx.event.original.toLowerCase().contains('package policy exists as')\"
     }
   },
   {
     \"set\": {
       \"field\": \"message\",
       \"value\": \"policy responses exists as [redacted]\",
       \"if\": \"ctx.message != null &amp;&amp; ctx.message.toLowerCase().contains('policy responses exists as')\"
     }
   },
   {
     \"set\": {
       \"field\": \"event.original\",
       \"value\": \"policy responses exists as [redacted]\",
       \"if\": \"ctx.event.original != null &amp;&amp; ctx.event.original.toLowerCase().contains('policy responses exists as')\"
     }
   },
   {
     \"set\": {
       \"field\": \"message\",
       \"value\": \"endpoint metadata exists as [redacted]\",
       \"if\": \"ctx.message != null &amp;&amp; ctx.message.toLowerCase().contains('endpoint metadata exists as')\"
     }
   },
   {
     \"set\": {
       \"field\": \"event.original\",
       \"value\": \"endpoint metadata exists as [redacted]\",
       \"if\": \"ctx.event.original != null &amp;&amp; ctx.event.original.toLowerCase().contains('endpoint metadata exists as')\"
     }
   },
   {
     \"set\": {
       \"field\": \"message\",
       \"value\": \"Trusted Apps: [redacted]\",
       \"if\": \"ctx.message != null &amp;&amp; ctx.message.toLowerCase().contains('trusted apps:')\"
     }
   },
   {
     \"set\": {
       \"field\": \"event.original\",
       \"value\": \"Trusted Apps: [redacted]\",
       \"if\": \"ctx.event.original != null &amp;&amp; ctx.event.original.toLowerCase().contains('trusted apps:')\"
     }
   },
   {
     \"set\": {
       \"field\": \"message\",
       \"value\": \"EP Exceptions: [redacted]\",
       \"if\": \"ctx.message != null &amp;&amp; ctx.message.toLowerCase().contains('ep exceptions:')\"
     }
   },
   {
     \"set\": {
       \"field\": \"event.original\",
       \"value\": \"EP Exceptions: [redacted]\",
       \"if\": \"ctx.event.original != null &amp;&amp; ctx.event.original.toLowerCase().contains('ep exceptions:')\"
     }
   },
   {
     \"set\": {
       \"field\": \"message\",
       \"value\": \"EP Event Filters: [redacted]\",
       \"if\": \"ctx.message != null &amp;&amp; ctx.message.toLowerCase().contains('ep event filters:')\"
     }
   },
   {
     \"set\": {
       \"field\": \"event.original\",
       \"value\": \"EP Event Filters: [redacted]\",
       \"if\": \"ctx.event.original != null &amp;&amp; ctx.event.original.toLowerCase().contains('ep event filters:')\"
     }
   },
   {
     \"set\": {
       \"field\": \"message\",
       \"value\": \"Value List Meta Data: [redacted]\",
       \"if\": \"ctx.message != null &amp;&amp; ctx.message.toLowerCase().contains('value list meta data:')\"
     }
   },
   {
     \"set\": {
       \"field\": \"event.original\",
       \"value\": \"Value List Meta Data: [redacted]\",
       \"if\": \"ctx.event.original != null &amp;&amp; ctx.event.original.toLowerCase().contains('value list meta data:')\"
     }
   },
   {
     \"set\": {
       \"field\": \"message\",
       \"value\": \"Timeline Events: [redacted]\",
       \"if\": \"ctx.message != null &amp;&amp; ctx.message.toLowerCase().contains('timeline events:')\"
     }
   },
   {
     \"set\": {
       \"field\": \"event.original\",
       \"value\": \"Timeline Events: [redacted]\",
       \"if\": \"ctx.event.original != null &amp;&amp; ctx.event.original.toLowerCase().contains('timeline events:')\"
     }
   },
   {
     \"set\": {
       \"field\": \"message\",
       \"value\": \"Error decoding JSON: [redacted]\",
       \"if\": \"ctx.message != null &amp;&amp; ctx.error != null &amp;&amp; ctx.error.message != null &amp;&amp; ctx.error.message.toLowerCase().contains('error decoding json') &amp;&amp; ctx.message.toLowerCase().contains('plugins.securitysolution.telemetry_events')\"
     }
   },
   {
     \"set\": {
       \"field\": \"event.original\",
       \"value\": \"Error decoding JSON: [redacted]\",
       \"if\": \"ctx.event.original != null &amp;&amp; ctx.error != null &amp;&amp; ctx.error.message != null &amp;&amp; ctx.error.message.toLowerCase().contains('error decoding json') &amp;&amp; ctx.event.original.toLowerCase().contains('plugins.securitysolution.telemetry_events')\"
     }
   },
   {
     \"set\": {
       \"description\": \"Redacting sensitive info from errors in message field\",
       \"field\": \"message\",
       \"value\": \"error thrown getting the access token [redacted]\",
       \"if\": \"ctx.message != null &amp;&amp; ctx.message.toLowerCase().contains('error thrown getting the access token')\"
     }
   },
   {
     \"set\": {
       \"description\": \"Redacting sensitive info from errors in event.original field\",
       \"field\": \"event.original\",
       \"value\": \"error thrown getting the access token [redacted]\",
       \"if\": \"ctx.event.original != null &amp;&amp; ctx.event.original.toLowerCase().contains('error thrown getting the access token')\"
     }
   },
   {
     \"set\": {
       \"description\": \"Redacting sensitive info from message field in Security Solution RuleExecution or RuleRegistry docs\",
       \"field\": \"message\",
       \"value\": \"[redacted]\",
       \"if\": \"ctx.log.logger != null &amp;&amp; ctx.message != null &amp;&amp; (ctx.log.logger.toLowerCase() == 'plugins.securitySolution.ruleexecution' || ctx.log.logger.toLowerCase() == 'plugins.ruleregistry') &amp;&amp; ctx.message.toLowerCase().contains('preview of field\\\\'s value')\"
     }
   },
   {
     \"set\": {
       \"description\": \"Redacting sensitive info from event.original field in Security Solution RuleExecution or RuleRegistry docs\",
       \"field\": \"event.original\",
       \"value\": \"[redacted]\",
       \"if\": \"ctx.log.logger != null &amp;&amp; ctx.event.original != null &amp;&amp; (ctx.log.logger.toLowerCase() == 'plugins.securitySolution.ruleexecution' || ctx.log.logger.toLowerCase() == 'plugins.ruleregistry') &amp;&amp; ctx.event.original.toLowerCase().contains('preview of field\\\\'s value')\"
     }
   },
   {
     \"set\": {
       \"description\": \"Redacting sensitive info from error.stack_trace field in Security Solution RuleExecution or RuleRegistry docs\",
       \"field\": \"error.stack_trace\",
       \"value\": \"[redacted]\",
       \"if\": \"ctx.log.logger != null &amp;&amp; ctx.error != null &amp;&amp; ctx.error.stack_trace != null &amp;&amp; (ctx.log.logger.toLowerCase() == 'plugins.securitySolution.ruleexecution' || ctx.log.logger.toLowerCase() == 'plugins.ruleregistry') &amp;&amp; ctx.error.stack_trace.toLowerCase().contains('preview of field\\\\'s value')\"
     }
   },
   {
     \"set\": {
       \"description\": \"Redacting sensitive info from error.message field in Security Solution RuleExecution or RuleRegistry docs\",
       \"field\": \"error.message\",
       \"value\": \"[redacted]\",
       \"if\": \"ctx.log.logger != null &amp;&amp; ctx.error != null &amp;&amp; ctx.error.message != null &amp;&amp; (ctx.log.logger.toLowerCase() == 'plugins.securitySolution.ruleexecution' || ctx.log.logger.toLowerCase() == 'plugins.ruleregistry') &amp;&amp; ctx.error.message.toLowerCase().contains('preview of field\\\\'s value')\"
     }
   }
 ]
}
</code></pre>
<ol start=\"2\">
<li>
<p>Identify the indexes or datastreams that your Kibana logs are being ingested into.</p>
</li>
<li>
<p>Identify whether these indices have a default pipeline configured by checking for the index.default_pipeline setting on the indices themselves and the templates.<br>
a. If the indices DO NOT configure a default pipeline:</p>
<ul>
<li>Configure the template to add the <code>index.default_pipeline</code> setting pointing to the example <code>redact-esa-2023-27</code> pipeline.</li>
<li>Update the settings of any existing indices to use <code>index.default_pipeline: redact-esa-2023-27</code>.</li>
</ul>
<p>b. If the indices DO configure a default pipeline:</p>
<ul>
<li>Identify the name of the pipeline from the setting.</li>
<li><code>GET /_ingest/pipeline/{pipeline_name}</code></li>
<li>Add the processor <code>redact-esa-2023-27</code> as an additional <a href=\"https://www.elastic.co/guide/en/elasticsearch/reference/current/pipeline-processor.html\">pipeline processor</a> to the body of the default pipeline</li>
<li>Use <a href=\"https://www.elastic.co/guide/en/elasticsearch/reference/current/put-pipeline-api.html\">PUT _ingest/pipeline API</a> to update the default pipeline to the new configuration</li>
</ul>
<pre><code class=\"lang-auto\">...
{
  \"pipeline\": {
    \"name\": \"redact-esa-2023-27\"
  }
}
…
</code></pre>
</li>
</ol>
<p>The instructions above give API usage examples. Custom pipelines can also be edited using the Ingest Pipelines UI. See <a href=\"https://www.elastic.co/guide/en/fleet/8.11/data-streams-pipeline-tutorial.html\" class=\"inline-onebox\">Tutorial: Transform data with custom ingest pipelines | Fleet and Elastic Agent Guide [8.11] | Elastic</a></p>
<h3><a name=\"self-managed-without-elastic-stack-monitoring-14\" class=\"anchor\" href=\"https://discuss.elastic.co#self-managed-without-elastic-stack-monitoring-14\"></a>Self-Managed without Elastic Stack Monitoring</h3>
<p>If you are not ingesting Kibana logs in the Elastic Stack, you should limit access to the directory where Kibana log files are stored.</p>
<h3><a name=\"ece-logging-cluster-instructions-15\" class=\"anchor\" href=\"https://discuss.elastic.co#ece-logging-cluster-instructions-15\"></a>ECE logging cluster instructions</h3>
<p>This assumes the above ingest pipeline (<code>redact-esa–2023-27</code>) has been created in the logging cluster as described above.</p>
<p>By default the ECE logging cluster ships with a single template for the <code>cluster-logs-*</code> indices and:</p>
<ul>
<li>It does not have a “settings.default_pipeline”</li>
<li>There are no other templates with <code>“GET”</code></li>
</ul>
<p>You should confirm this remains the case for you (<code>“GET _template/cluster-logs-*”</code>, look for <code>“default_pipeline”</code>) and (<code>“GET _template/”</code>, compare the <code>“index_patterns”</code> fields) respectively, and contact support if there are.</p>
<p>Otherwise, you will then create an overlapping template just specifying the ingest pipeline:</p>
<pre><code class=\"lang-auto\">PUT _template/cluster-logs-esa–2023-27-redaction
{
  \"index_patterns\" : [\"cluster-logs-*\"],
  \"order\" : 99,
  \"settings\": {\"default_pipeline\": \"redact-esa–2023-27\"}
}
</code></pre>
<p>The next time the index rolls over, the message field will be replaced by <code>“[redacted]”</code> for offending messages. You should then redact sensitive information from already ingested logs as described below.</p>
<h2><a name=\"redacting-sensitive-information-already-ingested-in-logs-16\" class=\"anchor\" href=\"https://discuss.elastic.co#redacting-sensitive-information-already-ingested-in-logs-16\"></a>Redacting Sensitive Information already ingested in logs</h2>
<p>The same Ingest Pipeline can be used in conjunction with the <a href=\"https://www.elastic.co/guide/en/elasticsearch/reference/current/docs-update-by-query.html\">Update By Query API</a> in order to redact already recorded sensitive information in logs. This is applicable for all deployments which includes: Elastic Cloud customers with self-managed monitoring clusters, Self-Managed, ECE, ECK.</p>
<p>Repeat the following Updaye By Queries for all Kibana logging indices that contain sensitive information.</p>
<h3><a name=\"update-query-1-17\" class=\"anchor\" href=\"https://discuss.elastic.co#update-query-1-17\"></a>Update Query <span class=\"hashtag-raw\">#1</span></h3>
<pre><code class=\"lang-auto\">POST /&lt;insert_indices_patterns_here&gt;/_update_by_query?pipeline=redact-esa–2023-27&amp;pretty=true&amp;allow_no_indices=false&amp;wait_for_completion=false&amp;expand_wildcards=all&amp;conflicts=proceed
{
  \"query\": {
    \"bool\": {
      \"must\": [
        {\"match\": {\"message\": \"MaxListenersExceededWarning\"}},
        {\"match\": {\"message\": \"IncomingMessage\"}}
      ],
   \"must_not\" : [
      { \"term\": { \"_tier\": { \"value\": \"data_frozen\" } } }
   ]
    }
  }
}
</code></pre>
<p>##<span class=\"hashtag-raw\">#Update</span> Query <span class=\"hashtag-raw\">#2</span></p>
<pre><code class=\"lang-auto\">POST /&lt;insert_indices_patterns_here&gt;/_update_by_query?pipeline=redact-esa–2023-27&amp;pretty=true&amp;allow_no_indices=false&amp;wait_for_completion=false&amp;expand_wildcards=all&amp;conflicts=proceed
{
  \"query\": {
    \"bool\": {
    \"must_not\" : [
      { \"term\": { \"_tier\": { \"value\": \"data_frozen\" } } }
   ],
      \"should\": [
        { \"exists\": { \"field\": \"kibana.usageCounters.results.meta.meta.request.options.headers.authorization\"}},
        { \"exists\": { \"field\": \"kibana.usageCounters.results.meta.meta.request.options.headers.X-Elastic-App-Auth\"}},
        { \"exists\": { \"field\": \"kibana.usageCounters.results.meta.meta.request.options.headers.x-elastic-app-auth\"}},
        { \"exists\": { \"field\": \"kibana.usageCounters.results.meta.meta.request.options.headers.es-client-authentication\"}},
        { \"exists\": { \"field\": \"kibana.usageCounters.results.meta.meta.request.options.headers.ES-Client-Authentication\"}},
        { \"exists\": { \"field\": \"kibana.usageCounters.results.meta.meta.request.params.headers.authorization\"}},
        { \"exists\": { \"field\": \"kibana.usageCounters.results.meta.meta.request.params.headers.X-Elastic-App-Auth\"}},
        { \"exists\": { \"field\": \"kibana.usageCounters.results.meta.meta.request.params.headers.x-elastic-app-auth\"}},
        { \"exists\": { \"field\": \"kibana.usageCounters.results.meta.meta.request.params.headers.es-client-authentication\"}},
        { \"exists\": { \"field\": \"kibana.usageCounters.results.meta.meta.request.params.headers.ES-Client-Authentication\"}}
      ],
      \"minimum_should_match\": 1
    }
  }
}
</code></pre>
<h3><a name=\"update-query-3-18\" class=\"anchor\" href=\"https://discuss.elastic.co#update-query-3-18\"></a>Update Query <span class=\"hashtag-raw\">#3</span></h3>
<pre><code class=\"lang-auto\">POST /&lt;insert_indices_patterns_here&gt;/_update_by_query?pipeline=redact-esa–2023-27&amp;pretty=true&amp;allow_no_indices=false&amp;wait_for_completion=false&amp;expand_wildcards=all&amp;conflicts=proceed
{
  \"query\": {
    \"bool\": {
         \"must_not\" : [
      { \"term\": { \"_tier\": { \"value\": \"data_frozen\" } } }
   ],
      \"should\": [
        { \"match\": { \"message\": \"policy info exists as\"}},
        { \"match\": { \"message\": \"package policy exists as\"}},
        { \"match\": { \"message\": \"policy responses exists as\"}},
        { \"match\": { \"message\": \"endpoint metadata exists as\"}},
        { \"match\": { \"message\": \"trusted apps:\"}},
        { \"match\": { \"message\": \"ep exceptions:\"}},
        { \"match\": { \"message\": \"ep event filters:\"}},
        { \"match\": { \"message\": \"value list meta data:\"}},
        { \"match\": { \"message\": \"timeline events:\"}}
      ],
      \"minimum_should_match\": 1
    }
  }
}
</code></pre>
<h3><a name=\"update-query-4-19\" class=\"anchor\" href=\"https://discuss.elastic.co#update-query-4-19\"></a>Update Query <span class=\"hashtag-raw\">#4</span></h3>
<pre><code class=\"lang-auto\">POST /&lt;insert_indices_patterns_here&gt;/_update_by_query?pipeline=redact-esa–2023-27&amp;pretty=true&amp;allow_no_indices=false&amp;wait_for_completion=false&amp;expand_wildcards=all&amp;conflicts=proceed
{
  \"query\": {
    \"bool\": {
    \"must_not\" : [
      { \"term\": { \"_tier\": { \"value\": \"data_frozen\" } } }
   ],
      \"must\": [
        {\"match\": {\"message\": \"Preview of field's value\"}},
        {\"match\": {\"message\": \"--token\"}}
      ],
      \"should\": [
        {\"match\": {\"log.logger\": \"plugins.securitySolution.ruleExecution\"}},
        {\"match\": {\"log.logger\": \"plugins.ruleRegistry\"}}
      ],
      \"minimum_should_match\": 1
    }
  }
}
</code></pre>
<h3><a name=\"update-query-5-20\" class=\"anchor\" href=\"https://discuss.elastic.co#update-query-5-20\"></a>Update Query <span class=\"hashtag-raw\">#5</span></h3>
<pre><code class=\"lang-auto\">POST /&lt;insert_indices_patterns_here&gt;/_update_by_query?pipeline=redact-esa–2023-27&amp;pretty=true&amp;allow_no_indices=false&amp;wait_for_completion=false&amp;expand_wildcards=all&amp;conflicts=proceed
{
  \"query\": {
    \"bool\": {
     \"must_not\" : [
      { \"term\": { \"_tier\": { \"value\": \"data_frozen\" } } }
   ],
      \"must\": [
        {\"match_phrase\": {\"message\": \"error thrown getting the access token\"}}
      ]
    }
  }
}
</code></pre>
<h3><a name=\"update-query-6-21\" class=\"anchor\" href=\"https://discuss.elastic.co#update-query-6-21\"></a>Update Query <span class=\"hashtag-raw\">#6</span></h3>
<pre><code class=\"lang-auto\">POST /&lt;insert_indices_patterns_here&gt;/_update_by_query?pipeline=redact-esa–2023-27&amp;pretty=true&amp;allow_no_indices=false&amp;wait_for_completion=false&amp;expand_wildcards=all&amp;conflicts=proceed
{
  \"query\": {
    \"bool\": {
     \"must_not\" : [
      { \"term\": { \"_tier\": { \"value\": \"data_frozen\" } } }
   ],
      \"should\": [
        {\"exists\": {\"field\": \"http.request.headers.authorization\"}},
        {\"exists\": {\"field\": \"http.request.headers.x-elastic-app-auth\"}},
        {\"exists\": {\"field\": \"http.request.headers.X-Elastic-App-Auth\"}},
        {\"exists\": {\"field\": \"http.request.headers.es-client-authentication\"}},
        {\"exists\": {\"field\": \"http.request.headers.ES-Client-Authentication\"}},
        {\"exists\": {\"field\": \"error.cause.meta.meta.request.options.headers.authorization\"}},
        {\"exists\": {\"field\": \"error.cause.meta.meta.request.options.headers.x-elastic-app-auth\"}},
        {\"exists\": {\"field\": \"error.cause.meta.meta.request.options.headers.X-Elastic-App-Auth\"}},
        {\"exists\": {\"field\": \"error.cause.meta.meta.request.options.headers.es-client-authentication\"}},
        {\"exists\": {\"field\": \"error.cause.meta.meta.request.options.headers.ES-Client-Authentication\"}},
        {\"exists\": {\"field\": \"meta.meta.request.params.headers.authorization\"}},
        {\"exists\": {\"field\": \"meta.meta.request.params.headers.x-elastic-app-auth\"}},
        {\"exists\": {\"field\": \"meta.meta.request.params.headers.X-Elastic-App-Auth\"}},
        {\"exists\": {\"field\": \"meta.meta.request.params.headers.es-client-authentication\"}},
        {\"exists\": {\"field\": \"meta.meta.request.params.headers.ES-Client-Authentication\"}},
        {\"exists\": {\"field\": \"meta.meta.request.options.headers.authorization\"}},
        {\"exists\": {\"field\": \"meta.meta.request.options.headers.x-elastic-app-auth\"}},
        {\"exists\": {\"field\": \"meta.meta.request.options.headers.X-Elastic-App-Auth\"}},
        {\"exists\": {\"field\": \"meta.meta.request.options.headers.es-client-authentication\"}},
        {\"exists\": {\"field\": \"meta.meta.request.options.headers.ES-Client-Authentication\"}},
        {\"exists\": {\"field\": \"left.error.meta.meta.request.params.headers.authorization\"}},
        {\"exists\": {\"field\": \"left.error.meta.meta.request.params.headers.x-elastic-app-auth\"}},
        {\"exists\": {\"field\": \"left.error.meta.meta.request.params.headers.X-Elastic-App-Auth\"}},
        {\"exists\": {\"field\": \"left.error.meta.meta.request.params.headers.es-client-authentication\"}},
        {\"exists\": {\"field\": \"left.error.meta.meta.request.params.headers.ES-Client-Authentication\"}},
        {\"exists\": {\"field\": \"left.error.meta.meta.request.options.headers.authorization\"}},
        {\"exists\": {\"field\": \"left.error.meta.meta.request.options.headers.x-elastic-app-auth\"}},
        {\"exists\": {\"field\": \"left.error.meta.meta.request.options.headers.X-Elastic-App-Auth\"}},
        {\"exists\": {\"field\": \"left.error.meta.meta.request.options.headers.es-client-authentication\"}},
        {\"exists\": {\"field\": \"left.error.meta.meta.request.options.headers.ES-Client-Authentication\"}},
        {\"exists\": {\"field\": \"error.originalError.meta.meta.request.params.headers.authorization\"}},
        {\"exists\": {\"field\": \"error.originalError.meta.meta.request.params.headers.x-elastic-app-auth\"}},
        {\"exists\": {\"field\": \"error.originalError.meta.meta.request.params.headers.X-Elastic-App-Auth\"}},
        {\"exists\": {\"field\": \"error.originalError.meta.meta.request.params.headers.es-client-authentication\"}},
        {\"exists\": {\"field\": \"error.originalError.meta.meta.request.params.headers.ES-Client-Authentication\"}},
        {\"exists\": {\"field\": \"error.originalError.meta.meta.request.options.headers.authorization\"}},
        {\"exists\": {\"field\": \"error.originalError.meta.meta.request.options.headers.x-elastic-app-auth\"}},
        {\"exists\": {\"field\": \"error.originalError.meta.meta.request.options.headers.X-Elastic-App-Auth\"}},
        {\"exists\": {\"field\": \"error.originalError.meta.meta.request.options.headers.es-client-authentication\"}},
        {\"exists\": {\"field\": \"error.originalError.meta.meta.request.options.headers.ES-Client-Authentication\"}},
        {\"exists\": {\"field\": \"error.meta.meta.request.params.headers.authorization\"}},
        {\"exists\": {\"field\": \"error.meta.meta.request.params.headers.x-elastic-app-auth\"}},
        {\"exists\": {\"field\": \"error.meta.meta.request.params.headers.X-Elastic-App-Auth\"}},
        {\"exists\": {\"field\": \"error.meta.meta.request.params.headers.es-client-authentication\"}},
        {\"exists\": {\"field\": \"error.meta.meta.request.params.headers.ES-Client-Authentication\"}},
        {\"exists\": {\"field\": \"error.meta.meta.request.options.headers.authorization\"}},
        {\"exists\": {\"field\": \"error.meta.meta.request.options.headers.x-elastic-app-auth\"}},
        {\"exists\": {\"field\": \"error.meta.meta.request.options.headers.X-Elastic-App-Auth\"}},
        {\"exists\": {\"field\": \"error.meta.meta.request.options.headers.es-client-authentication\"}},
        {\"exists\": {\"field\": \"error.meta.meta.request.options.headers.ES-Client-Authentication\"}},
        {\"exists\": {\"field\": \"error.meta.meta.meta.request.params.headers.authorization\"}},
        {\"exists\": {\"field\": \"error.meta.meta.meta.request.params.headers.x-elastic-app-auth\"}},
        {\"exists\": {\"field\": \"error.meta.meta.meta.request.params.headers.X-Elastic-App-Auth\"}},
        {\"exists\": {\"field\": \"error.meta.meta.meta.request.params.headers.es-client-authentication\"}},
        {\"exists\": {\"field\": \"error.meta.meta.meta.request.params.headers.ES-Client-Authentication\"}},
        {\"exists\": {\"field\": \"error.meta.meta.meta.request.options.headers.authorization\"}},
        {\"exists\": {\"field\": \"error.meta.meta.meta.request.options.headers.x-elastic-app-auth\"}},
        {\"exists\": {\"field\": \"error.meta.meta.meta.request.options.headers.X-Elastic-App-Auth\"}},
        {\"exists\": {\"field\": \"error.meta.meta.meta.request.options.headers.es-client-authentication\"}},
        {\"exists\": {\"field\": \"error.meta.meta.meta.request.options.headers.ES-Client-Authentication\"}},
        {\"exists\": {\"field\": \"error.cause.meta.meta.request.params.headers.authorization\"}},
        {\"exists\": {\"field\": \"error.cause.meta.meta.request.params.headers.x-elastic-app-auth\"}},
        {\"exists\": {\"field\": \"error.cause.meta.meta.request.params.headers.X-Elastic-App-Auth\"}},
        {\"exists\": {\"field\": \"error.cause.meta.meta.request.params.headers.es-client-authentication\"}},
        {\"exists\": {\"field\": \"error.cause.meta.meta.request.params.headers.ES-Client-Authentication\"}}
      ],
      \"minimum_should_match\": 1
    }
  }
}
</code></pre>
<p>To check that the update_by_query task completes successfully:</p>
<pre><code class=\"lang-auto\">GET /_tasks/{taskId from above request}
</code></pre>
<p>—</p>
<p><strong>Severity:</strong> CVSSv3.1, 8.0 (High) <a href=\"https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:A/AC:H/PR:L/UI:N/S:C/C:H/I:H/A:H\">AV:A/AC:H/PR:L/UI:N/S:C/C:H/I:H/A:H</a><br>
<strong>CVE ID:</strong> CVE-2023-46675</p>
<h2><a name=\"appendix-22\" class=\"anchor\" href=\"https://discuss.elastic.co#appendix-22\"></a>Appendix</h2>
<h3><a name=\"a-search-queries-23\" class=\"anchor\" href=\"https://discuss.elastic.co#a-search-queries-23\"></a>A. Search Queries</h3>
<pre><code class=\"lang-auto\">GET /&lt;insert_indices_patterns_here&gt;/_search
{
  \"query\": {
    \"bool\": {
      \"must\": [
        {\"match\": {\"message\": \"MaxListenersExceededWarning\"}},
        {\"match\": {\"message\": \"IncomingMessage\"}}
      ]
    }
  }
}
</code></pre>
<pre><code class=\"lang-auto\">GET /&lt;insert_indices_patterns_here&gt;/_search 
{
  \"query\": {
    \"bool\": { 
      \"should\": [
        { \"exists\": { \"field\": \"kibana.usageCounters.results.meta.meta.request.options.headers.authorization\"}},
        { \"exists\": { \"field\": \"kibana.usageCounters.results.meta.meta.request.options.headers.X-Elastic-App-Auth\"}},
        { \"exists\": { \"field\": \"kibana.usageCounters.results.meta.meta.request.options.headers.x-elastic-app-auth\"}},
        { \"exists\": { \"field\": \"kibana.usageCounters.results.meta.meta.request.options.headers.es-client-authentication\"}},
        { \"exists\": { \"field\": \"kibana.usageCounters.results.meta.meta.request.options.headers.ES-Client-Authentication\"}},
        { \"exists\": { \"field\": \"kibana.usageCounters.results.meta.meta.request.params.headers.authorization\"}},
        { \"exists\": { \"field\": \"kibana.usageCounters.results.meta.meta.request.params.headers.X-Elastic-App-Auth\"}},
        { \"exists\": { \"field\": \"kibana.usageCounters.results.meta.meta.request.params.headers.x-elastic-app-auth\"}},
        { \"exists\": { \"field\": \"kibana.usageCounters.results.meta.meta.request.params.headers.es-client-authentication\"}},
        { \"exists\": { \"field\": \"kibana.usageCounters.results.meta.meta.request.params.headers.ES-Client-Authentication\"}}
      ],
      \"minimum_should_match\": 1
    }
  }
}
</code></pre>
<pre><code class=\"lang-auto\">GET /&lt;insert_indices_patterns_here&gt;/_search
{
  \"query\": {
    \"bool\": {
      \"should\": [
        { \"match\": { \"message\": \"policy info exists as\"}},
        { \"match\": { \"message\": \"package policy exists as\"}},
        { \"match\": { \"message\": \"policy responses exists as\"}},
        { \"match\": { \"message\": \"endpoint metadata exists as\"}},
        { \"match\": { \"message\": \"trusted apps:\"}},
        { \"match\": { \"message\": \"ep exceptions:\"}},
        { \"match\": { \"message\": \"ep event filters:\"}},
        { \"match\": { \"message\": \"value list meta data:\"}},
        { \"match\": { \"message\": \"timeline events:\"}}
      ],
      \"minimum_should_match\": 1
    }
  }
}
</code></pre>
<pre><code class=\"lang-auto\">GET /&lt;insert_indices_patterns_here&gt;/_search
{
  \"query\": {
    \"bool\": {
      \"must\": [
        {\"match\": {\"message\": \"Preview of field's value\"}},
        {\"match\": {\"message\": \"--token\"}}
      ],
      \"should\": [
        {\"match\": {\"log.logger\": \"plugins.securitySolution.ruleExecution\"}},
        {\"match\": {\"log.logger\": \"plugins.ruleRegistry\"}}
      ],
      \"minimum_should_match\": 1
    }
  }
}
</code></pre>
<pre><code class=\"lang-auto\">GET /&lt;insert_indices_patterns_here&gt;/_search
{
  \"query\": {
    \"bool\": {
      \"must\": [
        {\"match\": {
          \"log.logger\": \"plugins.actions.email\"
        }},
        {\"match\": {
          \"message\": \"token\"
        }}
      ]
    }
  }
}
</code></pre>
<pre><code class=\"lang-auto\">GET /&lt;insert_indices_patterns_here&gt;/_search
{
  \"query\": {
    \"bool\": {
      \"should\": [
        {\"exists\": {\"field\": \"http.request.headers.authorization\"}},
        {\"exists\": {\"field\": \"http.request.headers.x-elastic-app-auth\"}},
        {\"exists\": {\"field\": \"http.request.headers.X-Elastic-App-Auth\"}},
        {\"exists\": {\"field\": \"http.request.headers.es-client-authentication\"}},
        {\"exists\": {\"field\": \"http.request.headers.ES-Client-Authentication\"}},
        {\"exists\": {\"field\": \"error.cause.meta.meta.request.options.headers.authorization\"}},
        {\"exists\": {\"field\": \"error.cause.meta.meta.request.options.headers.x-elastic-app-auth\"}},
        {\"exists\": {\"field\": \"error.cause.meta.meta.request.options.headers.X-Elastic-App-Auth\"}},
        {\"exists\": {\"field\": \"error.cause.meta.meta.request.options.headers.es-client-authentication\"}},
        {\"exists\": {\"field\": \"error.cause.meta.meta.request.options.headers.ES-Client-Authentication\"}},
        {\"exists\": {\"field\": \"meta.meta.request.params.headers.authorization\"}},
        {\"exists\": {\"field\": \"meta.meta.request.params.headers.x-elastic-app-auth\"}},
        {\"exists\": {\"field\": \"meta.meta.request.params.headers.X-Elastic-App-Auth\"}},
        {\"exists\": {\"field\": \"meta.meta.request.params.headers.es-client-authentication\"}},
        {\"exists\": {\"field\": \"meta.meta.request.params.headers.ES-Client-Authentication\"}},
        {\"exists\": {\"field\": \"meta.meta.request.options.headers.authorization\"}},
        {\"exists\": {\"field\": \"meta.meta.request.options.headers.x-elastic-app-auth\"}},
        {\"exists\": {\"field\": \"meta.meta.request.options.headers.X-Elastic-App-Auth\"}},
        {\"exists\": {\"field\": \"meta.meta.request.options.headers.es-client-authentication\"}},
        {\"exists\": {\"field\": \"meta.meta.request.options.headers.ES-Client-Authentication\"}},
        {\"exists\": {\"field\": \"left.error.meta.meta.request.params.headers.authorization\"}},
        {\"exists\": {\"field\": \"left.error.meta.meta.request.params.headers.x-elastic-app-auth\"}},
        {\"exists\": {\"field\": \"left.error.meta.meta.request.params.headers.X-Elastic-App-Auth\"}},
        {\"exists\": {\"field\": \"left.error.meta.meta.request.params.headers.es-client-authentication\"}},
        {\"exists\": {\"field\": \"left.error.meta.meta.request.params.headers.ES-Client-Authentication\"}},
        {\"exists\": {\"field\": \"left.error.meta.meta.request.options.headers.authorization\"}},
        {\"exists\": {\"field\": \"left.error.meta.meta.request.options.headers.x-elastic-app-auth\"}},
        {\"exists\": {\"field\": \"left.error.meta.meta.request.options.headers.X-Elastic-App-Auth\"}},
        {\"exists\": {\"field\": \"left.error.meta.meta.request.options.headers.es-client-authentication\"}},
        {\"exists\": {\"field\": \"left.error.meta.meta.request.options.headers.ES-Client-Authentication\"}},
        {\"exists\": {\"field\": \"error.originalError.meta.meta.request.params.headers.authorization\"}},
        {\"exists\": {\"field\": \"error.originalError.meta.meta.request.params.headers.x-elastic-app-auth\"}},
        {\"exists\": {\"field\": \"error.originalError.meta.meta.request.params.headers.X-Elastic-App-Auth\"}},
        {\"exists\": {\"field\": \"error.originalError.meta.meta.request.params.headers.es-client-authentication\"}},
        {\"exists\": {\"field\": \"error.originalError.meta.meta.request.params.headers.ES-Client-Authentication\"}},
        {\"exists\": {\"field\": \"error.originalError.meta.meta.request.options.headers.authorization\"}},
        {\"exists\": {\"field\": \"error.originalError.meta.meta.request.options.headers.x-elastic-app-auth\"}},
        {\"exists\": {\"field\": \"error.originalError.meta.meta.request.options.headers.X-Elastic-App-Auth\"}},
        {\"exists\": {\"field\": \"error.originalError.meta.meta.request.options.headers.es-client-authentication\"}},
        {\"exists\": {\"field\": \"error.originalError.meta.meta.request.options.headers.ES-Client-Authentication\"}},
        {\"exists\": {\"field\": \"error.meta.meta.request.params.headers.authorization\"}},
        {\"exists\": {\"field\": \"error.meta.meta.request.params.headers.x-elastic-app-auth\"}},
        {\"exists\": {\"field\": \"error.meta.meta.request.params.headers.X-Elastic-App-Auth\"}},
        {\"exists\": {\"field\": \"error.meta.meta.request.params.headers.es-client-authentication\"}},
        {\"exists\": {\"field\": \"error.meta.meta.request.params.headers.ES-Client-Authentication\"}},
        {\"exists\": {\"field\": \"error.meta.meta.request.options.headers.authorization\"}},
        {\"exists\": {\"field\": \"error.meta.meta.request.options.headers.x-elastic-app-auth\"}},
        {\"exists\": {\"field\": \"error.meta.meta.request.options.headers.X-Elastic-App-Auth\"}},
        {\"exists\": {\"field\": \"error.meta.meta.request.options.headers.es-client-authentication\"}},
        {\"exists\": {\"field\": \"error.meta.meta.request.options.headers.ES-Client-Authentication\"}},
        {\"exists\": {\"field\": \"error.meta.meta.meta.request.params.headers.authorization\"}},
        {\"exists\": {\"field\": \"error.meta.meta.meta.request.params.headers.x-elastic-app-auth\"}},
        {\"exists\": {\"field\": \"error.meta.meta.meta.request.params.headers.X-Elastic-App-Auth\"}},
        {\"exists\": {\"field\": \"error.meta.meta.meta.request.params.headers.es-client-authentication\"}},
        {\"exists\": {\"field\": \"error.meta.meta.meta.request.params.headers.ES-Client-Authentication\"}},
        {\"exists\": {\"field\": \"error.meta.meta.meta.request.options.headers.authorization\"}},
        {\"exists\": {\"field\": \"error.meta.meta.meta.request.options.headers.x-elastic-app-auth\"}},
        {\"exists\": {\"field\": \"error.meta.meta.meta.request.options.headers.X-Elastic-App-Auth\"}},
        {\"exists\": {\"field\": \"error.meta.meta.meta.request.options.headers.es-client-authentication\"}},
        {\"exists\": {\"field\": \"error.meta.meta.meta.request.options.headers.ES-Client-Authentication\"}},
        {\"exists\": {\"field\": \"error.cause.meta.meta.request.params.headers.authorization\"}},
        {\"exists\": {\"field\": \"error.cause.meta.meta.request.params.headers.x-elastic-app-auth\"}},
        {\"exists\": {\"field\": \"error.cause.meta.meta.request.params.headers.X-Elastic-App-Auth\"}},
        {\"exists\": {\"field\": \"error.cause.meta.meta.request.params.headers.es-client-authentication\"}},
        {\"exists\": {\"field\": \"error.cause.meta.meta.request.params.headers.ES-Client-Authentication\"}}
      ],
      \"minimum_should_match\": 1
    }
  }
}
</code></pre>
            <p><small>2 posts - 1 participant</small></p>
            <p><a href=\"https://discuss.elastic.co/t/kibana-8-11-2-7-17-16-security-update-esa-2023-27/349182\">Read full topic</a></p>
          ") (link nil "https://discuss.elastic.co/t/kibana-8-11-2-7-17-16-security-update-esa-2023-27/349182") (pubDate nil "Tue, 12 Dec 2023 17:23:12 +0000") (topicPinned nil "No") (topicClosed nil "No") (topicArchived nil "No") (guid ((isPermaLink . "false")) "discuss.elastic.co-topic-349182") (source ((url . "https://discuss.elastic.co/t/kibana-8-11-2-7-17-16-security-update-esa-2023-27/349182.rss")) "Kibana 8.11.2, 7.17.16 Security Update (ESA-2023-27)"))) ("Enterprise Search 8.11.2 / 7.17.16 Security Update (ESA-2023-31)" "<h1><a name=\"enterprise-search-insertion-of-sensitive-information-into-log-file-esa-2023-31-1\" class=\"anchor\" href=\"https://discuss.elastic.co#enterprise-search-insertion-of-sensitive-information-into-log-file-esa-2023-31-1\"></a>Enterprise Search Insertion of Sensitive Information into Log File (ESA-2023-31)</h1>
<p>An issue was discovered by Elastic whereby the <a href=\"https://www.elastic.co/guide/en/app-search/current/documents.html#documents-create\">Documents API</a> of App Search logged the raw contents of indexed documents at <code>INFO</code> log level. Depending on the contents of such documents, this could lead to the insertion of sensitive or private information in the App Search logs. Elastic has released 8.11.2 and 7.17.16 that resolves this issue by changing the log level at which these are logged to <code>DEBUG</code>, which is disabled by default.</p>
<p><strong>Affected Versions:</strong><br>
Enterprise Search versions on or after 7.0.0 and before 7.17.16.<br>
Enterprise Search versions on or after 8.0.0 and before 8.11.2.</p>
<p><strong>Affected Configurations:</strong><br>
Only users that directly utilize the <a href=\"https://www.elastic.co/guide/en/app-search/current/documents.html#documents-create\">Documents API</a> are affected by this issue, if the documents that they are ingesting via this API contain sensitive or private information.</p>
<p><strong>Solutions and Mitigations:</strong><br>
The issue is resolved in versions 7.17.16 and versions 8.11.2.</p>
<p>Customers on versions before 7.17.16 and 8.11.2 that cannot upgrade can prohibit document contents from being logged by setting <a href=\"https://www.elastic.co/guide/en/enterprise-search/current/configuration.html#configuration-settings-logging\">log_level</a> to <code>WARN</code> or higher in their Enterprise Search configuration. Refer to <a href=\"https://www.elastic.co/guide/en/enterprise-search/current/configuration.html#configuration-configure\">our documentation</a> for applying this setting on Elastic Cloud, ECE or self managed clusters.</p>
<p><strong>Severity:</strong><br>
CVSSv3.1: 6.8(Medium) - <a href=\"https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:A/AC:L/PR:L/UI:N/S:C/C:H/I:N/A:N\">AV:A/AC:L/PR:L/UI:N/S:C/C:H/I:N/A:N</a><br>
CVE ID: CVE-2023-49923</p>
            <p><small>2 posts - 2 participants</small></p>
            <p><a href=\"https://discuss.elastic.co/t/enterprise-search-8-11-2-7-17-16-security-update-esa-2023-31/349181\">Read full topic</a></p>" "https://discuss.elastic.co/t/enterprise-search-8-11-2-7-17-16-security-update-esa-2023-31/349181" (25976 37665) new 25 nil nil ((title nil "Enterprise Search 8.11.2 / 7.17.16 Security Update (ESA-2023-31)") (creator nil "rodrigo_silva") (category nil "Security Announcements") (description nil "
            <h1><a name=\"enterprise-search-insertion-of-sensitive-information-into-log-file-esa-2023-31-1\" class=\"anchor\" href=\"https://discuss.elastic.co#enterprise-search-insertion-of-sensitive-information-into-log-file-esa-2023-31-1\"></a>Enterprise Search Insertion of Sensitive Information into Log File (ESA-2023-31)</h1>
<p>An issue was discovered by Elastic whereby the <a href=\"https://www.elastic.co/guide/en/app-search/current/documents.html#documents-create\">Documents API</a> of App Search logged the raw contents of indexed documents at <code>INFO</code> log level. Depending on the contents of such documents, this could lead to the insertion of sensitive or private information in the App Search logs. Elastic has released 8.11.2 and 7.17.16 that resolves this issue by changing the log level at which these are logged to <code>DEBUG</code>, which is disabled by default.</p>
<p><strong>Affected Versions:</strong><br>
Enterprise Search versions on or after 7.0.0 and before 7.17.16.<br>
Enterprise Search versions on or after 8.0.0 and before 8.11.2.</p>
<p><strong>Affected Configurations:</strong><br>
Only users that directly utilize the <a href=\"https://www.elastic.co/guide/en/app-search/current/documents.html#documents-create\">Documents API</a> are affected by this issue, if the documents that they are ingesting via this API contain sensitive or private information.</p>
<p><strong>Solutions and Mitigations:</strong><br>
The issue is resolved in versions 7.17.16 and versions 8.11.2.</p>
<p>Customers on versions before 7.17.16 and 8.11.2 that cannot upgrade can prohibit document contents from being logged by setting <a href=\"https://www.elastic.co/guide/en/enterprise-search/current/configuration.html#configuration-settings-logging\">log_level</a> to <code>WARN</code> or higher in their Enterprise Search configuration. Refer to <a href=\"https://www.elastic.co/guide/en/enterprise-search/current/configuration.html#configuration-configure\">our documentation</a> for applying this setting on Elastic Cloud, ECE or self managed clusters.</p>
<p><strong>Severity:</strong><br>
CVSSv3.1: 6.8(Medium) - <a href=\"https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:A/AC:L/PR:L/UI:N/S:C/C:H/I:N/A:N\">AV:A/AC:L/PR:L/UI:N/S:C/C:H/I:N/A:N</a><br>
CVE ID: CVE-2023-49923</p>
            <p><small>2 posts - 2 participants</small></p>
            <p><a href=\"https://discuss.elastic.co/t/enterprise-search-8-11-2-7-17-16-security-update-esa-2023-31/349181\">Read full topic</a></p>
          ") (link nil "https://discuss.elastic.co/t/enterprise-search-8-11-2-7-17-16-security-update-esa-2023-31/349181") (pubDate nil "Tue, 12 Dec 2023 17:06:41 +0000") (topicPinned nil "No") (topicClosed nil "Yes") (topicArchived nil "No") (guid ((isPermaLink . "false")) "discuss.elastic.co-topic-349181") (source ((url . "https://discuss.elastic.co/t/enterprise-search-8-11-2-7-17-16-security-update-esa-2023-31/349181.rss")) "Enterprise Search 8.11.2 / 7.17.16 Security Update (ESA-2023-31)"))))